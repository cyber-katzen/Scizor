{"markdown": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n TrickBot Malware \\| CISA\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[Skip to main content](#main) \n\n\n\n\n\n\n\n\n\n\n\n\n![U.S. flag](/profiles/cisad8_gov/themes/custom/gesso/dist/images/us_flag_small.png)\n\n\n\n An official website of the United States government\n \n\n\n\n Here\u2019s how you know\n \n\n\n\n\n\n Here\u2019s how you know\n \n\n\n\n\n\n\n![Dot gov](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-dot-gov.svg)\n\n\n**Official websites use .gov** \n  \n\n A\n **.gov** \n website belongs to an official government organization in the United States.\n \n\n\n\n\n\n![HTTPS](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-https.svg)\n\n\n**Secure .gov websites use HTTPS** \n  \n\n A\n **lock** \n (\n \n\n\n Lock\n \n\n A locked padlock\n \n\n\n\n\n ) or\n **https://** \n means you\u2019ve safely connected to the .gov website. Share sensitive information only on official, secure websites.\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools \"Free Cyber Services\") \n[\\#protect2024](/protect2024) \n[Secure Our World](/node/18883) \n[Shields Up](/node/8056) \n[Report A Cyber Issue](/node/16591) \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[![CISA Logo Americas Cyber Defense Agency](/sites/default/files/images/SVG/header_logo_tagline_update.svg)](/)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[![CISA Logo](/sites/default/files/images/SVG/mobile_logo_wordmark.svg)](/)\n\n\n\n\n\n\n\n\n\n\n Search\n \n\n\n\n\n\n\n\n\n\n Menu\n \n\n\n\n\n\n\n\n\n\n\n\n\n![America's Cyber Defense Agency](/sites/default/files/images/SVG/header_tagline_mobile_update.svg)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Close\n \n\n\n\n\n* Topics\n \n\n\n\n[Topics](/topics) \n\n\n\n\n[Cybersecurity Best Practices](/topics/cybersecurity-best-practices)\n\n\n\n\n[Cyber Threats and Advisories](/topics/cyber-threats-and-advisories)\n\n\n\n\n[Critical Infrastructure Security and Resilience](/topics/critical-infrastructure-security-and-resilience)\n\n\n\n\n[Election Security](/topics/election-security)\n\n\n\n\n[Emergency Communications](/topics/emergency-communications)\n\n\n\n\n[Industrial Control Systems](/topics/industrial-control-systems)\n\n\n\n\n[Information and Communications Technology Supply Chain Security](/topics/information-communications-technology-supply-chain-security)\n\n\n\n\n[Partnerships and Collaboration](/topics/partnerships-and-collaboration)\n\n\n\n\n[Physical Security](/topics/physical-security)\n\n\n\n\n[Risk Management](/topics/risk-management)\n\n\n\n\n\n[How can we help?](/audiences) \n\n\n[Government](/topics/government) \n[Educational Institutions](/topics/educational-institutions) \n[Industry](/topics/industry) \n[State, Local, Tribal, and Territorial](/topics/state-local-tribal-and-territorial) \n[Individuals and Families](/topics/individuals-and-families) \n[Small and Medium Businesses](/topics/small-and-medium-businesses) \n[Find Help Locally](/audiences/find-help-locally) \n[Faith\\-Based Community](/audiences/faith-based-community) \n[Executives](/audiences/executives) \n[High\\-Risk Communities](/audiences/high-risk-communities)\n* [Spotlight](/spotlight)\n* Resources \\& Tools\n \n\n\n\n[Resources \\& Tools](/resources-tools) \n\n\n\n\n[All Resources \\& Tools](/resources-tools/all-resources-tools)\n\n\n\n\n[Services](/resources-tools/services)\n\n\n\n\n[Programs](/resources-tools/programs)\n\n\n\n\n[Resources](/resources-tools/resources)\n\n\n\n\n[Training](/resources-tools/training)\n\n\n\n\n[Groups](/resources-tools/groups)\n* News \\& Events\n \n\n\n\n[News \\& Events](/news-events) \n\n\n\n\n[News](/news-events/news)\n\n\n\n\n[Events](/news-events/events)\n\n\n\n\n[Cybersecurity Alerts \\& Advisories](/news-events/cybersecurity-advisories)\n\n\n\n\n[Directives](/news-events/directives)\n\n\n\n\n[Request a CISA Speaker](/news-events/request-speaker)\n\n\n\n\n[Congressional Testimony](/news-events/congressional-testimony)\n\n\n\n\n[CISA Conferences](/cisa-conferences)\n\n\n\n\n[CISA Live!](/cisa-live)\n* Careers\n \n\n\n\n[Careers](/careers) \n\n\n\n\n[Benefits \\& Perks](/careers/benefits-perks)\n\n\n\n\n[HireVue Applicant Reasonable Accommodations Process](/careers/hirevue-applicant-reasonable-accommodations-process)\n\n\n\n\n[Hiring](/general-recruitment-and-hiring-faqs)\n\n\n\n\n[Resume \\& Application Tips](/careers/resume-application-tips)\n\n\n\n\n[Students \\& Recent Graduates](/students-recent-graduates-employment-opportunities)\n\n\n\n\n[Veteran and Military Spouses](/careers/veteran-and-military-spouse-employment-opportunities)\n\n\n\n\n[Work @ CISA](/careers/work-cisa)\n* About\n \n\n\n\n[About](/about) \n\n\n\n\n[Culture](/about/culture)\n\n\n\n\n[Divisions \\& Offices](/about/divisions-offices)\n\n\n\n\n[Regions](/about/regions)\n\n\n\n\n[Leadership](/about/leadership)\n\n\n\n\n[Doing Business with CISA](/doing-business-cisa)\n\n\n\n\n[Site Links](/site-links)\n\n\n\n\n[Reporting Employee and Contractor Misconduct](/reporting-employee-and-contractor-misconduct)\n\n\n\n\n[CISA GitHub](/cisa-github)\n\n\n\n\n[CISA Central](/cisa-central)\n\n\n\n\n[2023 Year In Review](/about/2023YIR)\n\n\n\n\n[Contact Us](/about/contact-us)\n\n\n\n\n\n\n\n\n\n[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools \"Free Cyber Services\") \n[\\#protect2024](/protect2024) \n[Secure Our World](/node/18883) \n[Shields Up](/node/8056) \n[Report A Cyber Issue](/node/16591) \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Breadcrumb\n \n1. [Home](/)\n2. [News \\& Events](/news-events)\n3. [Cybersecurity Advisories](/news-events/cybersecurity-advisories)\n4. [Cybersecurity Advisory](/news-events/cybersecurity-advisories?f%5B0%5D=advisory_type%3A94)\n\n\n\n\n\n\n\n\n Share:\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Cybersecurity Advisory\n \nTrickBot Malware\n================\n\n\n\n\n\n Last Revised\n \n\n\n May 20, 2021\n \n\n\n\n\n Alert Code\n \n\n AA21\\-076A\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n### Summary\n\n\n\n\n*This Joint Cybersecurity Advisory uses the MITRE Adversarial Tactics, Techniques, and Common Knowledge (ATT\\&CK\u00ae) framework, Version 8\\. See the\n [ATT\\&CK for Enterprise](https://attack.mitre.org/versions/v8/techniques/enterprise/) \n for all referenced threat actor tactics and techniques.* \n\n\n\n\n The Cybersecurity and Infrastructure Security Agency (CISA) and Federal Bureau of Investigation (FBI) have observed continued targeting through spearphishing campaigns using TrickBot malware\u00a0in North America. A sophisticated group of cybercrime actors is luring victims, via phishing emails, with a traffic infringement phishing scheme to download TrickBot.\n \n\n\n\n TrickBot\u2014first identified in 2016\u2014is a Trojan developed and operated by a sophisticated group of cybercrime actors. Originally designed as a banking Trojan to steal financial data, TrickBot has evolved into highly modular, multi\\-stage malware that provides its operators a full suite of tools to conduct a myriad of illegal cyber activities.\n \n\n\n\n To secure against TrickBot, CISA and FBI recommend implementing the mitigation measures described in this Joint Cybersecurity Advisory, which include blocking suspicious Internet Protocol addresses, using antivirus software, and providing social engineering and phishing training to employees.\n \n\n\n\n[Click here](/sites/default/files/publications/AA21-076A-TrickBot_Malware_508_0.pdf) \n for a PDF version of this report.\n \n\n\n\n### Technical Details\n\n\n\n\n TrickBot is an advanced Trojan that malicious actors spread primarily by spearphishing campaigns using tailored emails that contain malicious attachments or links, which\u2014if enabled\u2014execute malware (\n *Phishing:* \n*Spearphishing Attachment* \n \\[\n [T1566\\.001](https://attack.mitre.org/versions/v8/techniques/T1566/001/) \n ],\n *Phishing: Spearphishing Link* \n \\[\n [T1566\\.002](https://attack.mitre.org/versions/v8/techniques/T1566/002) \n ]). CISA and FBI are aware of recent attacks that use phishing emails, claiming to contain proof of a traffic violation, to steal sensitive information. The phishing emails contain links that redirect to a website hosted on a compromised server that prompts the victim to click on photo proof of their traffic violation. (\n *User Execution: Malicious Link* \n \\[\n [T1204\\.001](https://attack.mitre.org/versions/v8/techniques/T1204/001/) \n ],\n *User Execution: Malicious File* \n \\[\n [T1204\\.002](https://attack.mitre.org/versions/v8/techniques/T1204/002/) \n ]). In clicking the photo, the victim unknowingly downloads a malicious JavaScript file that, when opened, automatically communicates with the malicious actor\u2019s command and control (C2\\) server to download TrickBot to the victim\u2019s system (\n *Command and Scripting Interpreter: JavaScript* \n \\[\n [T1059\\.007](https://attack.mitre.org/versions/v8/techniques/T1059/007/) \n ]).\n \n\n\n\n Attackers can use TrickBot to:\n \n\n\n* Drop other malware, such as Ryuk and Conti ransomware, or\n* Serve as an Emotet downloader (\n *Ingress Tool Transfer* \n \\[\n [T1105](https://attack.mitre.org/versions/v8/techniques/T1105/) \n ]).\\[\n [1](https://www.fireeye.com/blog/threat-research/2019/01/a-nasty-trick-from-credential-theft-malware-to-business-disruption.html) \n ]\n\n\n\n TrickBot uses person\\-in\\-the\\-browser attacks to steal information, such as login credentials (\n *Man in the Browser* \n \\[\n [T1185](https://attack.mitre.org/versions/v8/techniques/T1185/) \n ]). Additionally, some of TrickBot\u2019s modules spread the malware laterally across a network by abusing the Server Message Block (SMB) Protocol. TrickBot operators have a toolset capable of spanning the entirety of the MITRE ATT\\&CK framework, from actively or passively gathering information that can be used to support targeting (\n *Reconnaissance* \n \\[\n [TA0043](https://attack.mitre.org/tactics/TA0043/) \n ]), to trying to manipulate, interrupt, or destroy systems and data (\n *Impact* \n \\[\n [TA0040](https://attack.mitre.org/tactics/TA0040/) \n ]).\n \n\n\n\n TrickBot is capable of data exfiltration over a hardcoded C2 server, cryptomining, and host enumeration (e.g., reconnaissance of Unified Extensible Firmware Interface or Basic Input/Output System \\[UEFI/BIOS] firmware) (\n *Exfiltration Over C2 Channel* \n \\[\n [T1041](https://attack.mitre.org/versions/v8/techniques/T1041/) \n ],\n *Resource Hijacking* \n \\[\n [T1496](https://attack.mitre.org/versions/v8/techniques/T1496) \n ], System Information Discovery.\\[\n [2](https://eclypsium.com/2020/12/03/trickbot-now-offers-trickboot-persist-brick-profit/#background) \n ] For host enumeration, operators deliver TrickBot in modules containing a configuration file with specific tasks.\n \n\n\n\n Figure 1 lays out TrickBot\u2019s use of enterprise techniques.\n \n\n\n\n![]()\n\n\n\n\n*Figure 1: MITRE ATT\\&CK enterprise techniques used by TrickBot* \n\n\n\n\n\n\n\n### MITRE ATT\\&CK Techniques\n\n\n\n According to MITRE,\n *TrickBot* \n \\[\n [S0266](https://attack.mitre.org/software/S0266/) \n ] uses the ATT\\&CK techniques listed in table 1\\.\n \n\n\n\n*Table 1: TrickBot ATT\\&CK techniques for enterprise* \n\n\n\n\n*Initial Access* \n \\[\n [TA0001](https://attack.mitre.org/versions/v8/tactics/TA0001/) \n ]\n \n\n\n\n\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| Phishing: Spearphishing Attachment | [T1566\\.001](https://attack.mitre.org/versions/v8/techniques/T1566/001/) | TrickBot has used an email with an Excel sheet containing a malicious macro to deploy the malware. |\n| Phishing: Spearphishing Link | [T1566\\.002](https://attack.mitre.org/versions/v8/techniques/T1566/002) | TrickBot has been delivered via malicious links in phishing emails. |\n\n\n\n*Execution* \n \\[\n [TA0002](https://attack.mitre.org/versions/v8/tactics/TA0002/) \n ]\n \n\n\n\n\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| Scheduled Task/Job: Scheduled Task | [T1053\\.005](https://attack.mitre.org/versions/v8/techniques/T1053/005/) | TrickBot creates a scheduled task on the system that provides persistence. |\n| Command and Scripting Interpreter: Windows Command Shell | [T1059\\.003](https://attack.mitre.org/versions/v8/techniques/T1059/003/) | TrickBot has used macros in Excel documents to download and deploy the malware on the user\u2019s machine. |\n| Command and Scripting Interpreter: JavaScript/JScript | [T1059\\.007](https://attack.mitre.org/versions/v8/techniques/T1059/007/) | TrickBot victims unknowingly download a malicious JavaScript file that, when opened, automatically communicates with the malicious actor\u2019s C2 server to download TrickBot to the victim\u2019s system. |\n| Native API | [T1106](https://attack.mitre.org/versions/v8/techniques/T1106) | TrickBot uses the Windows Application Programming Interface (API) call, CreateProcessW(), to manage execution flow. |\n| User Execution: Malicious Link | [T1204\\.001](https://attack.mitre.org/versions/v8/techniques/T1204/001/) | TrickBot has sent spearphishing emails in an attempt to lure users to click on a malicious link. |\n| User Execution: Malicious File | [T1204\\.002](https://attack.mitre.org/versions/v8/techniques/T1204/002/) | TrickBot has attempted to get users to launch malicious documents to deliver its payload. |\n\n\n\n*Persistence* \n \\[\n [TA0003](https://attack.mitre.org/versions/v8/tactics/TA0003/) \n ]\n \n\n\n\n\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| Scheduled Task/Job: Scheduled Task | [T1053\\.005](https://attack.mitre.org/versions/v8/techniques/T1053/005/) | TrickBot creates a scheduled task on the system that provides persistence. |\n| Create or Modify System Process: Windows Service | [T1543\\.003](https://attack.mitre.org/versions/v8/techniques/T1543/003/) | TrickBot establishes persistence by creating an autostart service that allows it to run whenever the machine boots. |\n\n\n\n*Privilege Escalation* \n \\[\n [TA0004](https://attack.mitre.org/versions/v8/tactics/TA0004/) \n ]\n \n\n\n\n\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| Scheduled Task/Job: Scheduled Task | [T1053\\.005](https://attack.mitre.org/versions/v8/techniques/T1053/005/) | TrickBot creates a scheduled task on the system that provides persistence. |\n| Process Injection: Process Hollowing | [T1055\\.012](https://attack.mitre.org/versions/v8/techniques/T1055/012/) | TrickBot injects into the svchost.exe process. |\n| Create or Modify System Process: Windows Service | [T1543\\.003](https://attack.mitre.org/versions/v8/techniques/T1543/003/) | TrickBot establishes persistence by creating an autostart service that allows it to run whenever the machine boots. |\n\n\n\n*Defense Evasion* \n \\[\n [TA0005](https://attack.mitre.org/versions/v8/tactics/TA0005/) \n ]\n \n\n\n\n\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| Obfuscated Files or Information | [T1027](https://attack.mitre.org/versions/v8/techniques/T1027) | TrickBot uses non\\-descriptive names to hide functionality and uses an AES CBC (256 bits) encryption algorithm for its loader and configuration files. |\n| Obfuscated Files or Information: Software Packing | [T1027\\.002](https://attack.mitre.org/versions/v8/techniques/T1027/002/) | TrickBot leverages a custom packer to obfuscate its functionality. |\n| Masquerading | [T1036](https://attack.mitre.org/versions/v8/techniques/T1036) | The TrickBot downloader has used an icon to appear as a Microsoft Word document. |\n| Process Injection: Process Hollowing | [T1055\\.012](https://attack.mitre.org/versions/v8/techniques/T1055/012/) | TrickBot injects into the svchost.exe process. |\n| Modify Registry | [T1112](https://attack.mitre.org/versions/v8/techniques/T1112/) | TrickBot can modify registry entries. |\n| Deobfuscate/Decode Files or Information | [T1140](https://attack.mitre.org/versions/v8/techniques/T1140) | TrickBot decodes the configuration data and modules. |\n| Subvert Trust Controls: Code Signing | [T1553\\.002](https://attack.mitre.org/versions/v8/techniques/T1553/002/) | TrickBot has come with a signed downloader component. |\n| Impair Defenses: Disable or Modify Tools | [T1562\\.001](https://attack.mitre.org/versions/v8/techniques/T1562/001/) | TrickBot can disable Windows Defender. |\n\n\n\n*Credential Access* \n \\[\n [TA0006](https://attack.mitre.org/versions/v8/tactics/TA0006/) \n ]\n \n\n\n\n\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| Input Capture: Credential API Hooking | [T1056\\.004](https://attack.mitre.org/versions/v8/techniques/T1056/004/) | TrickBot has the ability to capture Remote Desktop Protocol credentials by capturing the CredEnumerateA API. |\n| Unsecured Credentials: Credentials in Files | [T1552\\.001](https://attack.mitre.org/versions/v8/techniques/T1552/001/) | TrickBot can obtain passwords stored in files from several applications such as Outlook, Filezilla, OpenSSH, OpenVPN and WinSCP. Additionally, it searches for the .vnc.lnk affix to steal VNC credentials. |\n| Unsecured Credentials: Credentials in Registry | [T1552\\.002](https://attack.mitre.org/versions/v8/techniques/T1552/002/) | TrickBot has retrieved PuTTY credentials by querying the Software\\\\SimonTatham\\\\Putty\\\\Sessions registry key. |\n| Credentials from Password Stores | [T1555](https://attack.mitre.org/versions/v8/techniques/T1555) | TrickBot can steal passwords from the KeePass open\\-source password manager. |\n| Credentials from Password Stores: Credentials from Web Browsers | [T1555\\.003](https://attack.mitre.org/versions/v8/techniques/T1555/003/) | TrickBot can obtain passwords stored in files from web browsers such as Chrome, Firefox, Internet Explorer, and Microsoft Edge, sometimes using esentutl. |\n\n\n\n*Discovery* \n \\[\n [TA0007](https://attack.mitre.org/versions/v8/tactics/TA0007/) \n ]\n \n\n\n\n\n| **Technique Tactic** | **ID** | **Use** |\n| --- | --- | --- |\n| System Service Discovery | [T1007](https://attack.mitre.org/versions/v8/techniques/T1007/) | TrickBot collects a list of install programs and services on the system\u2019s machine. |\n| System Network Configuration Discovery | [T1016](https://attack.mitre.org/versions/v8/techniques/T1016) | TrickBot obtains the IP address, location, and other relevant network information from the victim\u2019s machine. |\n| Remote System Discovery | [T1018](https://attack.mitre.org/versions/v8/techniques/T1018) | TrickBot can enumerate computers and network devices. |\n| System Owner/User Discovery | [T1033](https://attack.mitre.org/versions/v8/techniques/T1033) | TrickBot can identify the user and groups the user belongs to on a compromised host. |\n| Permission Groups Discovery | [T1069](https://attack.mitre.org/versions/v8/techniques/T1069) | TrickBot can identify the groups the user on a compromised host belongs to. |\n| System Information Discovery | [T1082](https://attack.mitre.org/versions/v8/techniques/T1082) | TrickBot gathers the OS version, machine name, CPU type, amount of RAM available from the victim\u2019s machine. |\n| File and Directory Discovery | [T1083](https://attack.mitre.org/versions/v8/techniques/T1083) | TrickBot searches the system for all of the following file extensions: .avi, .mov, .mkv, .mpeg, .mpeg4, .mp4, .mp3, .wav, .ogg, .jpeg, .jpg, .png, .bmp, .gif, .tiff, .ico, .xlsx, and .zip. It can also obtain browsing history, cookies, and plug\\-in information. |\n| Account Discovery: Local Account | [T1087\\.001](https://attack.mitre.org/versions/v8/techniques/T1087/001) | TrickBot collects the users of the system. |\n| Account Discovery: Email Account | [T1087\\.003](https://attack.mitre.org/versions/v8/techniques/T1087/003) | TrickBot collects email addresses from Outlook. |\n| Domain Trust Discovery | [T1482](https://attack.mitre.org/versions/v8/techniques/T1482) | TrickBot can gather information about domain trusts by utilizing Nltest. |\n\n\n\n*Lateral Movement* \n \\[\n [TA0008](https://attack.mitre.org/versions/v8/tactics/TA0008/) \n ]\n \n\n\n\n\n| **Technique Tactic** | **ID** | **Use** |\n| --- | --- | --- |\n| Lateral Tool Transfer | [T1570](https://attack.mitre.org/versions/v8/techniques/T1570) | Some TrickBot modules spread the malware laterally across a network by abusing the SMB Protocol. |\n\n\n\n*Collection* \n \\[\n [TA0009](https://attack.mitre.org/versions/v8/tactics/TA0009/) \n ]\n \n\n\n\n\n| **Technique Tactic** | **ID** | **Use** |\n| --- | --- | --- |\n| Data from Local System | [T1005](https://attack.mitre.org/versions/v8/techniques/T1005) | TrickBot collects local files and information from the victim\u2019s local machine. |\n| Input Capture:Credential API Hooking | [T1056\\.004](https://attack.mitre.org/versions/v8/techniques/T1056/004/) | TrickBot has the ability to capture Remote Desktop Protocol credentials by capturing the CredEnumerateA API. |\n| Person in the Browser | [T1185](https://attack.mitre.org/versions/v8/techniques/T1185) | TrickBot uses web injects and browser redirection to trick the user into providing their login credentials on a fake or modified webpage. |\n\n\n\n*Command and Control* \n \\[\n [TA0011](https://attack.mitre.org/versions/v8/tactics/TA0011/) \n ]\n \n\n\n\n\n| **Technique Tactic** | **ID** | **Use** |\n| --- | --- | --- |\n| Fallback Channels | [T1008](https://attack.mitre.org/versions/v8/techniques/T1008) | TrickBot can use secondary command and control (C2\\) servers for communication after establishing connectivity and relaying victim information to primary C2 servers. |\n| Application Layer Protocol: Web Protocols | [T1071\\.001](https://attack.mitre.org/versions/v8/techniques/T1071/001) | TrickBot uses HTTPS to communicate with its C2 servers, to get malware updates, modules that perform most of the malware logic and various configuration files. |\n| Ingress Tool Transfer | [T1105](https://attack.mitre.org/versions/v8/techniques/T1105) | TrickBot downloads several additional files and saves them to the victim's machine. |\n| Data Encoding: Standard Encoding | [T1132\\.001](https://attack.mitre.org/versions/v8/techniques/T1132/001) | TrickBot can Base64\\-encode C2 commands. |\n| Non\\-Standard Port | [T1571](https://attack.mitre.org/versions/v8/techniques/T1571) | Some TrickBot samples have used HTTP over ports 447 and 8082 for C2\\. |\n| Encrypted Channel: Symmetric Cryptography | [T1573\\.001](https://attack.mitre.org/versions/v8/techniques/T1573/001) | TrickBot uses a custom crypter leveraging Microsoft\u2019s CryptoAPI to encrypt C2 traffic. |\n\n\n\n*Exfiltration* \n \\[\n [TA0010](https://attack.mitre.org/versions/v8/tactics/TA0010/) \n ]\n \n\n\n\n\n| **Technique Tactic** | **ID** | **Use** |\n| --- | --- | --- |\n| Exfiltration Over C2 Channel | [T1041](https://attack.mitre.org/versions/v8/techniques/T1041) | TrickBot can send information about the compromised host to a hardcoded C2 server. |\n\n\n\n*Impact* \n \\[\n [TA0040](https://attack.mitre.org/versions/v8/tactics/TA0040/) \n ]\n \n\n\n\n\n| **Technique Tactic** | **ID** | **Use** |\n| --- | --- | --- |\n| Resource Hijacking | [T1496](https://attack.mitre.org/versions/v8/techniques/T1496) | TrickBot actors can leverage the resources of co\\-opted systems for cryptomining to validate transactions of cryptocurrency networks and earn virtual currency. |\n\n\n### Detection\n\n\n#### Signatures\n\n\n\n CISA developed the following snort signature for use in detecting network activity associated with TrickBot activity.\n \n\n\n\n\n\n\n\n alert tcp any \\[443,447] \\-\\> any any (msg:\"TRICKBOT:SSL/TLS Server X.509 Cert Field contains 'example.com' (Hex)\"; sid:1; rev:1; flow:established,from\\_server; ssl\\_state:server\\_hello; content:\"\\|0b\\|example.com\"; fast\\_pattern:only; content:\"Global Security\"; content:\"IT Department\"; pcre:\"/(?:\\\\x09\\\\x00\\\\xc0\\\\xb9\\\\x3b\\\\x93\\\\x72\\\\xa3\\\\xf6\\\\xd2\\|\\\\x00\\\\xe2\\\\x08\\\\xff\\\\xfb\\\\x7b\\\\x53\\\\x76\\\\x3d)/\"; classtype:bad\\-unknown; metadata:service ssl,service and\\-ports;)\n \n\n\n\n\n\n alert tcp any any \\-\\> any $HTTP\\_PORTS (msg:\"TRICKBOT\\_ANCHOR:HTTP URI GET contains '/anchor'\"; sid:1; rev:1; flow:established,to\\_server; content:\"/anchor\"; http\\_uri; fast\\_pattern:only; content:\"GET\"; nocase; http\\_method; pcre:\"/^\\\\/anchor\\_?.{3}\\\\/\\[\\\\w\\_\\-]\\+\\\\.\\[A\\-F0\\-9]\\+\\\\/?$/U\"; classtype:bad\\-unknown; priority:1; metadata:service http;)\n \n\n\n\n\n\n alert tcp any $SSL\\_PORTS \\-\\> any any (msg:\"TRICKBOT:SSL/TLS Server X.509 Cert Field contains 'C\\=XX, L\\=Default City, O\\=Default Company Ltd'\"; sid:1; rev:1; flow:established,from\\_server; ssl\\_state:server\\_hello; content:\"\\|31 0b 30 09 06 03 55 04 06 13 02\\|XX\"; nocase; content:\"\\|31 15 30 13 06 03 55 04 07 13 0c\\|Default City\"; nocase; content:\"\\|31 1c 30 1a 06 03 55 04 0a 13 13\\|Default Company Ltd\"; nocase; content:!\"\\|31 0c 30 0a 06 03 55 04 03\\|\"; classtype:bad\\-unknown; reference:url,www.virustotal.com/gui/file/e9600404ecc42cf86d38deedef94068db39b7a0fd06b3b8fb2d8a3c7002b650e/detection; metadata:service ssl;)\n \n\n\n\n\n\n alert tcp any any \\-\\> any $HTTP\\_PORTS (msg:\"TRICKBOT:HTTP Client Header contains 'boundary\\=Arasfjasu7'\"; sid:1; rev:1; flow:established,to\\_server; content:\"boundary\\=Arasfjasu7\\|0d 0a\\|\"; http\\_header; content:\"name\\=\\|22\\|proclist\\|22\\|\"; http\\_header; content:!\"Referer\"; content:!\"Accept\"; content:\"POST\"; http\\_method; classtype:bad\\-unknown; metadata:service http;)\n \n\n\n\n\n\n alert tcp any any \\-\\> any $HTTP\\_PORTS (msg:\"TRICKBOT:HTTP Client Header contains 'User\\-Agent\\|3a 20\\|WinHTTP loader/1\\.'\"; sid:1; rev:1; flow:established,to\\_server; content:\"User\\-Agent\\|3a 20\\|WinHTTP loader/1\\.\"; http\\_header; fast\\_pattern:only; content:\".png\\|20\\|HTTP/1\\.\"; pcre:\"/^Host\\\\x3a\\\\x20(?:\\\\d{1,3}\\\\.){3}\\\\d{1,3}(?:\\\\x3a\\\\d{2,5})?$/mH\"; content:!\"Accept\"; http\\_header; content:!\"Referer\\|3a 20\\|\"; http\\_header; classtype:bad\\-unknown; metadata:service http;)\n \n\n\n\n\n\n alert tcp any $HTTP\\_PORTS \\-\\> any any (msg:\"TRICKBOT:HTTP Server Header contains 'Server\\|3a 20\\|Cowboy'\"; sid:1; rev:1; flow:established,from\\_server; content:\"200\"; http\\_stat\\_code; content:\"Server\\|3a 20\\|Cowboy\\|0d 0a\\|\"; http\\_header; fast\\_pattern; content:\"content\\-length\\|3a 20\\|3\\|0d 0a\\|\"; http\\_header; file\\_data; content:\"/1/\"; depth:3; isdataat:!1,relative; classtype:bad\\-unknown; metadata:service http;)\n \n\n\n\n\n\n alert tcp any any \\-\\> any $HTTP\\_PORTS (msg:\"TRICKBOT:HTTP URI POST contains C2 Exfil\"; sid:1; rev:1; flow:established,to\\_server; content:\"Content\\-Type\\|3a 20\\|multipart/form\\-data\\|3b 20\\|boundary\\=\\-\\-\\-\\-\\-\\-Boundary\"; http\\_header; fast\\_pattern; content:\"User\\-Agent\\|3a 20\\|\"; http\\_header; distance:0; content:\"Content\\-Length\\|3a 20\\|\"; http\\_header; distance:0; content:\"POST\"; http\\_method; pcre:\"/^\\\\/\\[a\\-z]{3}\\\\d{3}\\\\/.\\+?\\\\.\\[A\\-F0\\-9]{32}\\\\/\\\\d{1,3}\\\\//U\"; pcre:\"/^Host\\\\x3a\\\\x20(?:\\\\d{1,3}\\\\.){3}\\\\d{1,3}$/mH\"; content:!\"Referer\\|3a\\|\"; http\\_header; classtype:bad\\-unknown; metadata:service http;)\n \n\n\n\n\n\n alert tcp any any \\-\\> any $HTTP\\_PORTS (msg:\"HTTP URI GET/POST contains '/56evcxv' (Trickbot)\"; sid:1; rev:1; flow:established,to\\_server; content:\"/56evcxv\"; http\\_uri; fast\\_pattern:only; classtype:bad\\-unknown; metadata:service http;)\n \n\n\n\n\n\n alert icmp any any \\-\\> any any (msg:\"TRICKBOT\\_ICMP\\_ANCHOR:ICMP traffic conatins 'hanc'\"; sid:1; rev:1; itype:8; content:\"hanc\"; offset:4; fast\\_pattern; classtype:bad\\-unknown;)\n \n\n\n\n\n\n alert tcp any any \\-\\> any $HTTP\\_PORTS (msg:\"HTTP Client Header contains POST with 'host\\|3a 20\\|\\*.onion.link' and 'data\\=' (Trickbot/Princess Ransomeware)\"; sid:1; rev:1; flow:established,to\\_server; content:\"POST\"; nocase; http\\_method; content:\"host\\|3a 20\\|\"; http\\_header; content:\".onion.link\"; nocase; http\\_header; distance:0; within:47; fast\\_pattern; file\\_data; content:\"data\\=\"; distance:0; within:5; classtype:bad\\-unknown; metadata:service http;)\n \n\n\n\n\n\n alert tcp any any \\-\\> any $HTTP\\_PORTS (msg:\"HTTP Client Header contains 'host\\|3a 20\\|tpsci.com' (trickbot)\"; sid:1; rev:1; flow:established,to\\_server; content:\"host\\|3a 20\\|tpsci.com\"; http\\_header; fast\\_pattern:only; classtype:bad\\-unknown; metadata:service http;)\n \n\n### Mitigations\n\n\n\n\n CISA and FBI recommend that network defenders\u2014in federal, state, local, tribal, territorial governments, and the private sector\u2014consider applying the following best practices to strengthen the security posture of their organization's systems. System owners and administrators should review any configuration changes prior to implementation to avoid negative impacts.\n \n\n\n* Provide social engineering and phishing training to employees.\n* Consider drafting or updating a policy addressing suspicious emails\u00a0 that specifies users must report all suspicious emails to the security and/or IT departments.\n* Mark external emails with a banner denoting the email is from an external source to assist users in detecting spoofed emails.\n* Implement Group Policy Object and firewall rules.\n* Implement an antivirus program and a formalized patch management process.\n* Implement filters at the email gateway and block suspicious IP addresses at the firewall.\n* Adhere to the principle of least privilege.\n* Implement a Domain\\-Based Message Authentication, Reporting \\& Conformance validation system.\n* Segment and segregate networks and functions.\n* Limit unnecessary lateral communications between network hoses, segments, and devices.\n* Consider using application allowlisting technology on all assets to ensure that only authorized software executes, and all unauthorized software is blocked from executing on assets. Ensure that such technology only allows authorized, digitally signed scripts to run on a system.\n* Enforce multi\\-factor authentication.\n* Enable a firewall on agency workstations configured to deny unsolicited connection requests.\n* Disable unnecessary services on agency workstations and servers.\n* Implement an Intrusion Detection System, if not already used, to detect C2 activity and other potentially malicious network activity\n* Monitor web traffic. Restrict user access to suspicious or risky sites.\n* Maintain situational awareness of the latest threats and implement appropriate access control lists.\n* Disable the use of SMBv1 across the network and require at least SMBv2 to harden systems against network propagation modules used by TrickBot.\n* Visit the MITRE ATT\\&CK Techniques pages (linked in table 1 above) for additional mitigation and detection strategies.\n* See CISA\u2019s Alert on\n [Technical Approaches to Uncovering and Remediating Malicious Activity](https://us-cert.cisa.gov/ncas/alerts/aa20-245a) \n for more information on addressing potential incidents and applying best practice incident response procedures.\n\n\n\n For additional information on malware incident prevention and handling, see the National Institute of Standards and Technology Special Publication 800\\-83,\n [Guide to Malware Incident Prevention and Handling for Desktops and Laptops](https://csrc.nist.gov/publications/detail/sp/800-83/rev-1/final) \n .\n \n\n\n### Resources\n\n\n* [CISA Fact Sheet: TrickBot Malware](/sites/default/files/publications/TrickBot_Fact_Sheet_508.pdf)\n* [MS\\-ISAC White Paper: Security Primer \u2013 TrickBot](https://www.cisecurity.org/white-papers/security-primer-trickbot/)\n* [United Kingdom National Cyber Security Centre Advisory: Ryuk Ransomware Targeting Organisations Globally](https://www.ncsc.gov.uk/news/ryuk-advisory)\n* [CISA and MS\\-ISAC Joint Alert AA20\\-280A: Emotet Malware](https://us-cert.cisa.gov/ncas/alerts/aa20-280a)\n* [MITRE ATT\\&CK for Enterprise](https://attack.mitre.org/matrices/enterprise/)\n\n\n\n### References\n\n\n\n\n[\\[1] FireEye Blog \\- A Nasty Trick: From Credential Theft Malware to Business Disruption](https://www.fireeye.com/blog/threat-research/2019/01/a-nasty-trick-from-credential-theft-malware-to-business-disruption.html) \n\n\n[\\[2] Eclypsium Blog \\- TrickBot Now Offers 'TrickBoot': Persist, Brick, Profit](https://eclypsium.com/2020/12/03/trickbot-now-offers-trickboot-persist-brick-profit/#background) \n\n\n### Revisions\n\n\n\n\n March 17, 2021: Initial Version\\|March 24, 2021: Added MITRE ATT\\&CK Technique T1592\\.003 used for reconnaissance\\|May 20, 2021: Added new MITRE ATT\\&CKs and updated Table 1\n \n\n\n\n\n\n\n\n\n\n\n This product is provided subject to this\n [Notification](/notification \"Follow link\") \n and this\n [Privacy \\& Use](/privacy-policy \"Follow link\") \n policy.\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPlease share your thoughts\n--------------------------\n\n\n\n We recently updated our anonymous\n [product survey](https://www.surveymonkey.com/r/CISA-cyber-survey?product=https://www.cisa.gov/news-events/cybersecurity-advisories/aa21-076a) \n ; we\u2019d welcome your feedback.\n \n\n\n\n\n\n\n\n\n\n\n\n\nRelated Advisories\n------------------\n\n\n\n\n\n\n\n\n\n\n Jul 11, 2024\n \n\n\n Cybersecurity Advisory \\| AA24\\-193A\n \n\n### [CISA Red Team\u2019s Operations Against a Federal Civilian Executive Branch Organization Highlights the Necessity of Defense\\-in\\-Depth](/news-events/cybersecurity-advisories/aa24-193a)\n\n\n\n\n\n\n\n\n\n\n\n Jul 08, 2024\n \n\n\n Cybersecurity Advisory \\| AA24\\-190A\n \n\n### [People\u2019s Republic of China (PRC) Ministry of State Security APT40 Tradecraft in Action](/news-events/cybersecurity-advisories/aa24-190a)\n\n\n\n\n\n\n\n\n\n\n\n May 10, 2024\n \n\n\n Cybersecurity Advisory \\| AA24\\-131A\n \n\n### [\\#StopRansomware: Black Basta](/news-events/cybersecurity-advisories/aa24-131a)\n\n\n\n\n\n\n\n\n\n\n\n Apr 18, 2024\n \n\n\n Cybersecurity Advisory \\| AA24\\-109A\n \n\n### [\\#StopRansomware: Akira Ransomware](/news-events/cybersecurity-advisories/aa24-109a)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[Return to top](#) \n\n\n\n\n* [Topics](/topics)\n* [Spotlight](/spotlight)\n* [Resources \\& Tools](/resources-tools)\n* [News \\& Events](/news-events)\n* [Careers](/careers)\n* [About](/about)\n\n\n\n\n\n\n\n\n[Cybersecurity \\& Infrastructure Security Agency](/ \"Go to the Cybersecurity & Infrastructure Security Agency homepage\")\n\n\n* [Facebook](https://www.facebook.com/CISA)\n* [Twitter](https://twitter.com/CISAgov)\n* [LinkedIn](https://www.linkedin.com/company/cybersecurity-and-infrastructure-security-agency)\n* [YouTube](https://www.youtube.com/@cisagov)\n* [Instagram](https://www.instagram.com/cisagov)\n* [RSS](/subscribe-updates-cisa)\n\n\n\n\n CISA Central\n \n[1\\-844\\-Say\\-CISA](tel:1-844-Say-CISA) \n[SayCISA@cisa.gov](mailto:SayCISA@cisa.gov) \n\n\n\n\n\n\n\n\n\n\n\n DHS Seal\n \n\n\n CISA.gov\n \n\n An official website of the U.S. Department of Homeland Security\n \n\n\n* [About CISA](/about \"About CISA\")\n* [Budget and Performance](https://www.dhs.gov/performance-financial-reports \"Budget and Performance\")\n* [DHS.gov](https://www.dhs.gov \"Department of Homeland Security\")\n* [Equal Opportunity \\& Accessibility](/oedia \"Equal Opportunity & Accessibility\")\n* [FOIA Requests](https://www.dhs.gov/foia \"FOIA Requests\")\n* [No FEAR Act](/no-fear-act \"No FEAR Act Reporting\")\n* [Office of Inspector General](https://www.oig.dhs.gov/ \"Office of Inspector General\")\n* [Privacy Policy](/privacy-policy \"Privacy Policy\")\n* [Subscribe](https://public.govdelivery.com/accounts/USDHSCISA/subscriber/new?topic_id=USDHSCISA_138 \"Subscribe to Email Updates\")\n* [The White House](https://www.whitehouse.gov/ \"The White House\")\n* [USA.gov](https://www.usa.gov/ \"USA.gov\")\n* [Website Feedback](/forms/feedback \"Website Feedback\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n", "cves": [], "techniques": ["T1059.003", "T1056.004", "T1053.005", "T1553.002", "T1204.002", "T1087.003", "T1059.007", "T1204.001", "T1555.003", "T1592.003", "T1087.001", "T1543.003", "T1132.001", "T1071.001", "T1573.001", "T1027.002", "T1562.001", "T1566.001", "T1566.002", "T1552.002", "T1055.012", "T1552.001"], "advisory": "aa21-076a", "title": "TrickBot Malware | CISA", "source": "cybersecurity-advisories", "id": "a0cd5c76d96d1f8d9c2a5d93d3fc9ae64c1052c20a92f047f0f1c72175b2fe95"}