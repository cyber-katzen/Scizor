{
  "markdown": " Siemens Nucleus RTOS TCP/IP Stack \\| CISA A A ( Lock ) or[\\#protect2024](/protect2024)  Search Menu Close[Faith\\-Based Community](/audiences/faith-based-community) [High\\-Risk Communities](/audiences/high-risk-communities)* Resources \\& Tools[Resources \\& Tools](/resources-tools) [All Resources \\& Tools](/resources-tools/all-resources-tools)* News \\& Events[News \\& Events](/news-events) [Cybersecurity Alerts \\& Advisories](/news-events/cybersecurity-advisories)[Benefits \\& Perks](/careers/benefits-perks)[Resume \\& Application Tips](/careers/resume-application-tips)[Students \\& Recent Graduates](/students-recent-graduates-employment-opportunities)[Divisions \\& Offices](/about/divisions-offices)[\\#protect2024](/protect2024) 2. [News \\& Events](/news-events) ICS AdvisorySiemens Nucleus RTOS TCP/IP Stack================================= Last Revised November 17, 2021 Alert Code ICSA\\-21\\-313\\-031\\. EXECUTIVE SUMMARY---------------------* **CVSS v3 9\\.8*** **ATTENTION:**  Exploitable remotely/low attack complexity* **Vendor:**  Siemens* **Equipment:**  Nucleus Net, Nucleus ReadyStart, Capital VSTAR* **Vulnerabilities:**  Type Confusion, Improper Validation of Specified Quantity in Input, Out\\-of\\-bounds Read, Improper Restriction of Operations within the Bounds of a Memory Buffer, Improper Null Termination, Buffer Access with Incorrect Length Value, Integer Underflow, Improper Handling of Inconsistent Structural Elements CISA is aware of a public report known as NUCLEUS:13 detailing vulnerabilities found in the TCP/IP stack and related services (FTP, TFTP) of the networking component (Nucleus NET) in the Nucleus Real\\-Time Operating System (RTOS). CISA is issuing this advisory to provide early notice of these reported vulnerabilities and identify baseline mitigations for reducing risks to these and other cybersecurity attacks.2\\. RISK EVALUATION------------------- Successful exploitation of these vulnerabilities could cause a denial\\-of\\-service condition, allow an information leakage, or remote code execution.3\\. TECHNICAL DETAILS---------------------### 3\\.1 AFFECTED PRODUCTS The following products and versions of the Nucleus RTOS are affected:* Capital VSTAR: All versions* Nucleus NET: All versions* Nucleus ReadyStart v3: All versions prior to v2017\\.02\\.4* Nucleus ReadyStart v4: All versions prior to v4\\.1\\.1* Nucleus Source Code: All versions### 3\\.2 VULNERABILITY OVERVIEW#### 3\\.2\\.1 [ACCESS OF RESOURCE USING INCOMPATIBLE TYPE (\u2018TYPE CONFUSION\u2019) CWE\\-843](https://cwe.mitre.org/data/definitions/843.html) ICMP echo packets with fake IP options allow sending ICMP echo reply messages to arbitrary hosts on the network.[CVE\\-2021\\-31344](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2021-31344)  has been assigned to this vulnerability. A CVSS v3 base score of 5\\.3 has been calculated; the CVSS vector string is ( [AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N)  ).#### 3\\.2\\.2 [IMPROPER VALIDATION OF SPECIFIED QUANTITY IN INPUT CWE\\-1284](https://cwe.mitre.org/data/definitions/1284.html) The total length of an UDP payload (set in the IP header) is unchecked. This may lead to various side effects, including information leak and denial\\-of\\-service conditions, depending on a user\\-defined application that runs on top of the UDP protocol.[CVE\\-2021\\-31345](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2021-31345)  has been assigned to this vulnerability. A CVSS v3 base score of 7\\.5 has been calculated; the CVSS vector string is ( [AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N)  ).#### 3\\.2\\.3 [IMPROPER VALIDATION OF SPECIFIED QUANTITY IN INPUT CWE\\-1284](https://cwe.mitre.org/data/definitions/1284.html) The total length of an ICMP payload (set in the IP header) is unchecked. This may lead to various side effects, including information leak and denial\\-of\\-service conditions, depending on the network buffer organization in memory.[CVE\\-2021\\-31346](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2021-31346)  has been assigned to this vulnerability. A CVSS v3 base score of 8\\.2 has been calculated; the CVSS vector string is ( [AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:H)  ).#### 3\\.2\\.4 [OUT\\-OF\\-BOUNDS READ CWE\\-125](https://cwe.mitre.org/data/definitions/125.html) When processing a DHCP OFFER message, the DHCP client application does not validate the length of the vendor option(s), leading to denial\\-of\\-service conditions.[CVE\\-2021\\-31881](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2021-31881)  has been assigned to this vulnerability. A CVSS v3 base score of 7\\.1 has been calculated; the CVSS vector string is ( [AV:A/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:H)  ).#### 3\\.2\\.5 [IMPROPER RESTRICTION OF OPERATIONS WITHIN THE BOUNDS OF A MEMORY BUFFER CWE\\-119](https://cwe.mitre.org/data/definitions/119.html) The DHCP client application does not validate the length of the domain name server IP option(s) (0x06\\) when processing DHCP ACK packets. This may lead to denial\\-of\\-service conditions.[CVE\\-2021\\-31882](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2021-31882)  has been assigned to this vulnerability. A CVSS v3 base score of 6\\.5 has been calculated; the CVSS vector string is ( [AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H)  ).#### 3\\.2\\.6 [IMPROPER RESTRICTION OF OPERATIONS WITHIN THE BOUNDS OF A MEMORY BUFFER CWE\\-119](https://cwe.mitre.org/data/definitions/119.html) When processing a DHCP ACK message, the DHCP client application does not validate the length of the vendor option(s), leading to denial\\-of\\-service conditions.[CVE\\-2021\\-31883](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2021-31883)  has been assigned to this vulnerability. A CVSS v3 base score of 7\\.1 has been calculated; the CVSS vector string is ( [AV:A/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:H)  ).#### 3\\.2\\.7 [IMPROPER NULL TERMINATION CWE\\-170](https://cwe.mitre.org/data/definitions/170.html) The DHCP client application assumes the data supplied with the \u201chostname\u201d DHCP option NULL is terminated. In cases when a global hostname variable is not defined, this may lead to out\\-of\\-bound reads, out\\-of\\-bounds writes, and denial\\-of\\-service conditions.[CVE\\-2021\\-31884](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2021-31884)  has been assigned to this vulnerability. A CVSS v3 base score of 8\\.8 has been calculated; the CVSS vector string is ( [AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  ).#### 3\\.2\\.8 [BUFFER ACCESS WITH INCORRECT LENGTH VALUE CWE\\-805](https://cwe.mitre.org/data/definitions/805.html) TFTP server application allows for reading the contents of the TFTP memory buffer via sending malformed TFTP commands.[CVE\\-2021\\-31885](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2021-31885)  has been assigned to this vulnerability. A CVSS v3 base score of 7\\.5 has been calculated; the CVSS vector string is ( [AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N)  ).#### 3\\.2\\.9 [IMPROPER NULL TERMINATION CWE\\-170](https://cwe.mitre.org/data/definitions/170.html) FTP server does not properly validate the length of the \u201cUSER\u201d command, leading to stack\\-based buffer overflows. This may result in denial\\-of\\-service conditions and remote code execution.[CVE\\-2021\\-31886](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2021-31886)  has been assigned to this vulnerability. A CVSS v3 base score of 9\\.8 has been calculated; the CVSS vector string is ( [AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  ).#### 3\\.2\\.10 [IMPROPER NULL TERMINATION CWE\\-170](https://cwe.mitre.org/data/definitions/170.html) FTP server does not properly validate the length of the \u201cPWD/XPWD\u201d command, leading to stack\\-based buffer overflows. This may result in denial\\-of\\-service conditions and remote code execution.[CVE\\-2021\\-31887](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2021-31887)  has been assigned to this vulnerability. A CVSS v3 base score of 8\\.8 has been calculated; the CVSS vector string is ( [AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)  ).#### 3\\.2\\.11 [IMPROPER NULL TERMINATION CWE\\-170](https://cwe.mitre.org/data/definitions/170.html) FTP server does not properly validate the length of the \u201cMKD/XMKD\u201d command, leading to stack\\-based buffer overflows. This may result in denial\\-of\\-service conditions and remote code execution.[CVE\\-2021\\-31888](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2021-31888)  has been assigned to this vulnerability. A CVSS v3 base score of 8\\.8 has been calculated; the CVSS vector string is ( [AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)  ).#### 3\\.2\\.12 [INTEGER UNDERFLOW (WRAP OR WRAPAROUND) CWE\\-191](https://cwe.mitre.org/data/definitions/191.html) Malformed TCP packets with a corrupted SACK option lead to information leaks and denial\\-of\\-service conditions.[CVE\\-2021\\-31889](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2021-31889)  has been assigned to this vulnerability. A CVSS v3 base score of 7\\.5 has been calculated; the CVSS vector string is ( [AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H)  ).#### 3\\.2\\.13 [IMPROPER HANDLING OF INCONSISTENT STRUCTURAL ELEMENTS CWE\\-240](https://cwe.mitre.org/data/definitions/240.html) The total length of a TCP payload (set in the IP header) is unchecked. This may lead to various side effects, including information leak and denial\\-of\\-service conditions, depending on the network buffer organization in memory.[CVE\\-2021\\-31890](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2021-31890)  has been assigned to this vulnerability. A CVSS v3 base score of 7\\.5 has been calculated; the CVSS vector string is ( [AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H)  ).### 3\\.3 BACKGROUND* **CRITICAL INFRASTRUCTURE SECTORS:**  Multiple* **COUNTRIES/AREAS DEPLOYED:**  Worldwide* **COMPANY HEADQUARTERS LOCATION:**  Germany### 3\\.4 RESEARCHER Daniel dos Santos, Stanislav Dashevskyi, and Amine Amri of Forescout Research Labs, and Uriel Malin and Tal Zohar of Medigate reported these vulnerabilities to CISA.4\\. MITIGATIONS--------------- Siemens has released updates for several of the affected products and recommends updating to the latest versions. Siemens recommends countermeasures for products where updates are not available. Siemens has not identified any additional specific workarounds or mitigations.* Capital VSTAR: [Contact Siemens Customer Support](https://support.industry.siemens.com/cs/start?lc=en-US)  to receive patch and update information.* Nucleus NET: Update to the latest version of Nucleus ReadyStart v3 or v4\\. [Contact Siemens Customer Support](https://support.industry.siemens.com/cs/start?lc=en-US)  or a Nucleus sales team for mitigation advice.* Nucleus ReadyStart v3: [Update to v2017\\.02\\.4 or later version](https://support.sw.siemens.com/en-US/product/1009925838/)  .* Nucleus ReadyStart v4: [Update to v4\\.1\\.1 or later version](https://support.sw.siemens.com/en-US/product/1336134128/)  .* Nucleus Source Code: [Contact Siemens Customer Support](https://support.industry.siemens.com/cs/start?lc=en-US)  to receive patch and update information. As a general security measure, Siemens recommends protecting network access to devices with appropriate mechanisms. In order to operate the devices in a protected IT environment, Siemens recommends configuring the environment according to [Siemens\u2019 operational guidelines for industrial security](https://www.siemens.com/cert/operational-guidelines-industrial-security)  and following the recommendations in the product manuals. For additional information, please refer to Siemens Security Advisory [SSA\\-044112](https://cert-portal.siemens.com/productcert/pdf/ssa-044112.pdf)  CISA recommends users take defensive measures to minimize the risk of exploitation of these vulnerabilities. Specifically, users should:* Minimize network exposure for all control system devices and/or systems, and ensure that they are [not accessible from the Internet](https://us-cert.cisa.gov/ics/alerts/ICS-ALERT-10-301-01)  .* Locate control system networks and remote devices behind firewalls, and isolate them from the business network.* When remote access is required, use secure methods, such as Virtual Private Networks (VPNs), recognizing VPNs may have vulnerabilities and should be updated to the most current version available. Also recognize VPN is only as secure as its connected devices. CISA reminds organizations to perform proper impact analysis and risk assessment prior to deploying defensive measures. CISA also provides a section for [control systems security recommended practices](https://us-cert.cisa.gov/ics/recommended-practices)  on the ICS webpage on [us\\-cert.cisa.gov](https://us-cert.cisa.gov/ics)  . Several recommended practices are available for reading and download, including [Improving Industrial Control Systems Cybersecurity with Defense\\-in\\-Depth Strategies](https://us-cert.cisa.gov/sites/default/files/recommended_practices/NCCIC_ICS-CERT_Defense_in_Depth_2016_S508C.pdf)  . Additional mitigation guidance and recommended practices are publicly available on the [ICS webpage on us\\-cert.cisa.gov](https://us-cert.cisa.gov/ics)  in the Technical Information Paper, [ICS\\-TIP\\-12\\-146\\-01B\\-\\-Targeted Cyber Intrusion Detection and Mitigation Strategies](https://us-cert.cisa.gov/ics/tips/ICS-TIP-12-146-01B)  . Organizations observing any suspected malicious activity should follow their established internal procedures and report their findings to CISA for tracking and correlation against other incidents. No known public exploits specifically target these vulnerabilities. This product is provided subject to this [Notification](/notification \"Follow link\")  and this [Privacy \\& Use](/privacy-policy \"Follow link\")  policy.Vendor------* Siemens-------------------------- [product survey](https://www.surveymonkey.com/r/CISA-cyber-survey?product=https://www.cisa.gov/news-events/ics-advisories/icsa-21-313-03)  ; Related Advisories------------------ Jul 18, 2024 ICS Advisory \\| ICSA\\-24\\-200\\-01### [Mitsubishi Electric MELSOFT MaiLab](/news-events/ics-advisories/icsa-24-200-01) Jul 18, 2024 ICS Advisory \\| ICSA\\-24\\-200\\-02### [Subnet Solutions PowerSYSTEM Center](/news-events/ics-advisories/icsa-24-200-02) Jul 16, 2024 ICS Advisory \\| ICSA\\-24\\-198\\-01### [Rockwell Automation Pavilion 8](/news-events/ics-advisories/icsa-24-198-01) Jul 11, 2024 ICS Advisory \\| ICSA\\-24\\-193\\-01### [Siemens Remote Connect Server](/news-events/ics-advisories/icsa-24-193-01)* [Resources \\& Tools](/resources-tools)* [News \\& Events](/news-events)[Cybersecurity \\& Infrastructure Security Agency](/ \"Go to the Cybersecurity & Infrastructure Security Agency homepage\")[1\\-844\\-Say\\-CISA](tel:1-844-Say-CISA) * [Equal Opportunity \\& Accessibility](/oedia \"Equal Opportunity & Accessibility\")",
  "cves": [
    "CVE-2021-31344",
    "CVE-2021-31888",
    "CVE-2021-31890",
    "CVE-2021-31882",
    "CVE-2021-31345",
    "CVE-2021-31885",
    "CVE-2021-31884",
    "CVE-2021-31883",
    "CVE-2021-31881",
    "CVE-2021-31887",
    "CVE-2021-31346",
    "CVE-2021-31889",
    "CVE-2021-31886"
  ],
  "techniques": [],
  "advisory": "icsa-21-313-03",
  "title": "Siemens Nucleus RTOS TCP/IP Stack | CISA",
  "source": "ics-advisories",
  "id": "cf21dff9f384b424ca2d8beaf68dc308c2d6d4732368d7cb687a303302aad198"
}