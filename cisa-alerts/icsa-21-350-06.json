{
  "markdown": "\n1. EXECUTIVE SUMMARY\n\nCVSS v3 8.8\nATTENTION: Exploitable remotely / Low attack complexity\nVendor: Siemens\nEquipment: Capital VSTAR\nVulnerabilities: Access of Resource Using Incompatible Type, Improper Validation of Specified Quantity in Input, Out-of-Bounds Read, Improper Restriction of Operations within the Bounds of a Memory Buffer, Improper Null Termination, Integer Underflow, Improper Handling of Inconsistent Structural Elements\n\n2\u00a0\u00a0 \u00a0UPDATE OR REPOSTED INFORMATION\nThis updated advisory is a follow-up to the original advisory titled \u201cICSA-21-350-06 Siemens Capital VSTAR\u201d that was published December 16, 2021, on the ICS webpage on cisa.gov/ICS.\n3. RISK EVALUATION\nSuccessful exploitation of these vulnerabilities could be leveraged by an attacker to initiate a crash, information leak, denial-of-service conditions, or remote code execution.\n4. TECHNICAL DETAILS\n4.1 AFFECTED PRODUCTS\nThe following versions of Capital VSTAR software platform are affected because of their use of Nucleus NET, the networking stack of Nucleus RTOS (real-time operating system):\n\nCapital VSTAR: All versions with enabled Ethernet options\n\n4.2 VULNERABILITY OVERVIEW\n4.2.1\u00a0\u00a0 \u00a0ACCESS OF RESOURCE USING INCOMPATIBLE TYPE CWE-843\nICMP echo packets with fake IP options allow sending ICMP echo reply messages to arbitrary hosts on the network.\nCVE-2021-31344 has been assigned to this vulnerability. A CVSS v3 base score of 5.3 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N).\n4.2.2\u00a0\u00a0 \u00a0IMPROPER VALIDATION OF SPECIFIED QUANTITY IN INPUT CWE-1248\nThe total length of an UDP payload (set in the IP header) is unchecked. This may lead to various side effects, including information leak and denial-of-service conditions, depending on a user-defined applications that runs on top of the UDP protocol.\nCVE-2021-31345 has been assigned to this vulnerability. A CVSS v3 base score of 7.5 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N).\n4.2.3\u00a0\u00a0 \u00a0IMPROPER VALIDATION OF SPECIFIED QUANTITY IN INPUT CWE-1248\nThe total length of an ICMP payload (set in the IP header) is unchecked. This may lead to various side effects, including information leak and denial-of-service conditions, depending on the network buffer organization in memory.\nCVE-2021-31346 has been assigned to this vulnerability. A CVSS v3 base score of 8.2 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:H).\n4.2.4\u00a0\u00a0 \u00a0OUT-OF-BOUNDS READ CWE-125\nWhen processing a DHCP OFFER message, the DHCP client application does not validate the length of the vendor option(s), leading to denial-of-service conditions.\nCVE-2021-31881 has been assigned to this vulnerability. A CVSS v3 base score of 7.1 has been calculated; the CVSS vector string is (AV:A/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:H).\n4.2.5\u00a0\u00a0 \u00a0IMPROPER RESTRICTION OF OPERATIONS WITHIN THE BOUNDS OF A MEMORY BUFFER CWE-119\nThe DHCP client application does not validate the length of the domain name server IP option(s) (0x06) when processing DHCP ACK packets. This may lead to denial-of-service conditions.\nCVE-2021-31882 has been assigned to this vulnerability. A CVSS v3 base score of 6.5 has been calculated; the CVSS vector string is (AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H).\n4.2.6\u00a0\u00a0 \u00a0IMPROPER RESTRICTION OF OPERATIONS WITHIN THE BOUNDS OF A MEMORY BUFFER CWE-119\nWhen processing a DHCP ACK message, the DHCP client application does not validate the length of the vendor option(s), leading to denial-of-service conditions.\nCVE-2021-31883 has been assigned to this vulnerability. A CVSS v3 base score of 7.1 has been calculated; the CVSS vector string is (AV:A/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:H).\n4.2.7\u00a0\u00a0 \u00a0IMPROPER NULL TERMINATION CWE-170\nThe DHCP client application assumes that the data supplied with the \u201cHostname\u201d DHCP option is NULL terminated. In cases when global hostname variable is not defined, this may lead to out-of-bound reads, writes, and denial-of-service conditions.\nCVE-2021-31884 has been assigned to this vulnerability. A CVSS v3 base score of 8.8 has been calculated; the CVSS vector string is (AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).\n--------- Begin Update A part 1 of 1 ---------\nSiemens has determined that Capital VSTAR is not affected by CVE-2021-31884.\n--------- End Update A part 1 of 1 ---------\n4.2.8\u00a0\u00a0 \u00a0INTEGER UNDERFLOW CWE-191\nMalformed TCP packets with a corrupted SACK option leads to information leaks and denial-of-service conditions.\nCVE-2021-31889 has been assigned to this vulnerability. A CVSS v3 base score of 7.5 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N).\n4.2.9\u00a0\u00a0 \u00a0IMPROPER HANDLING OF INCONSISTENT STRUCTURAL ELEMENTS CWE-240\nThe total length of an TCP payload (set in the IP header) is unchecked. This may lead to various side effects, including information leak and denial-of-service conditions, depending on the network buffer organization in memory.\nCVE-2021-31890 has been assigned to this vulnerability. A CVSS v3 base score of 7.5 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H).\n4.3 BACKGROUND\n\nCRITICAL INFRASTRUCTURE SECTORS: Critical Manufacturing\nCOUNTRIES/AREAS DEPLOYED: Worldwide\nCOMPANY HEADQUARTERS LOCATION: Germany\n\n4.4 RESEARCHER\nSiemens reported these vulnerabilities to CISA.\n5. MITIGATIONS\nSiemens has identified the following specific workarounds and mitigations that customers can apply to reduce the risk:\n\nCVE-2021-31344, CVE-2021-31345, CVE-2021-31346, CVE-2021-31889, CVE-2021-31890: Apply network segmentation and put the ECUs behind properly configured gateways/firewalls\nCVE-2021-31881, CVE-2021-31882, CVE-2021-31883, CVE-2021-31884: Disable DHCP client functionality, if feature not used, by deselecting the TcpIpIpV4General/TcpIpDhcpClientEnabled Pre-Compile configuration option\n\nAs a general security measure, Siemens strongly recommends protecting network access to devices with appropriate mechanisms. In order to operate the devices in a protected IT environment, Siemens recommends configuring the environment according to Siemens\u2019 operational guidelines for industrial security, and follow the recommendations in the product manuals.\nFor more information about this issue, please see Siemens security advisory SSA-620288\nFor further inquiries on security vulnerabilities in Siemens products and solutions, please contact Siemens ProductCERT.\nCISA recommends users take defensive measures to minimize the risk of exploitation of this vulnerability. Specifically, users should:\n\nMinimize network exposure for all control system devices and/or systems, and ensure they are not accessible from the Internet.\nLocate control system networks and remote devices behind firewalls and isolate them from the business network.\nWhen remote access is required, use secure methods, such as Virtual Private Networks (VPNs), recognizing VPNs may have vulnerabilities and should be updated to the most current version available. Also recognize VPN is only as secure as its connected devices.\n\nCISA reminds organizations to perform proper impact analysis and risk assessment prior to deploying defensive measures.\n\nCISA also provides a section for control systems security recommended practices on the ICS webpage on cisa.gov. Several recommended practices are available for reading and download, including Improving Industrial Control Systems Cybersecurity with Defense-in-Depth Strategies.\nAdditional mitigation guidance and recommended practices are publicly available on the ICS webpage on cisa.gov in the Technical Information Paper, ICS-TIP-12-146-01B--Targeted Cyber Intrusion Detection and Mitigation Strategies.\n\nOrganizations observing any suspected malicious activity should follow their established internal procedures and report their findings to CISA for tracking and correlation against other incidents.\nNo known public exploits specifically target these vulnerabilities. These vulnerabilities are exploitable remotely.\n",
  "cves": [
    "CVE-2021-31344",
    "CVE-2021-31345",
    "CVE-2021-31890",
    "CVE-2021-31884",
    "CVE-2021-31882",
    "CVE-2021-31889",
    "CVE-2021-31881",
    "CVE-2021-31883",
    "CVE-2021-31346"
  ],
  "techniques": [],
  "advisory": "icsa-21-350-06",
  "title": "Siemens Capital VSTAR (Update A) | CISA",
  "source": "ics-advisories",
  "id": "8df264ef0338886138954e243183127d02c8975e0bf66dbd19920fee91941657"
}