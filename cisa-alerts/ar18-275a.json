{
  "markdown": "\n\n\n\n\n\nNotification\n\nThis report is provided \"as is\" for informational purposes only. The Department of Homeland Security (DHS) does not provide any warranties of any kind regarding any information contained within. The DHS does not endorse any commercial product or service, referenced in this bulletin or otherwise.\nThis document is marked TLP:WHITE. Disclosure is not limited. Sources may use TLP:WHITE when information carries minimal or no foreseeable risk of misuse, in accordance with applicable rules and procedures for public release. Subject to standard copyright rules, TLP:WHITE information may be distributed without restriction. For more information on the Traffic Light Protocol, see http://www.us-cert.gov/tlp.\n\nSummary\n\nDescription\nThis report is a update to NCCIC report MAR-10201537.r1.v1, published Nov 8, 2018, and contains additional information related to two XCOFF executables identified in the original report as non-malicious:SHA256:10ac312c8dd02e417dd24d53c99525c29d74dcbc84730351ad7a4e0a4b1a0ebaca9ab48d293cc84092e8db8f0ca99cb155b30c61d32a1da7cd3687de454fe86cFurther analysis indicates these files are malicious. Once injected into the memory space of legitimate processes, these applications have the ability to modify ISO 8583 transaction data, an International Communications Protocol used for exchanging ATM card transaction requests and responses, resulting in fraudulent ATM withdrawals.Analysis of the remaining artifacts has not been modified, and includes the following:Three (3) additional XCOFF executable files, one of which may have been used to inject the malware described above into the memory space of a targeted server.One (1) ASCII Log file, possibly created by the use of the XCOFF injector (b3efec\u2026)Two (2) versions of a Themida packed proxy service module, both Windows executables: one 32-bit and one 64-bit. \u00a0\u00a0\u00a0This malware has the ability to modify local firewall settings & listen for Incoming traffic.One (1) Remote access Trojan (RAT), with the ability to modify firewall settings, accept remote commands, install proxy services, install & run additional malware payloads & exfiltrate data.One (1) 64-bit installer application; payload associated with this installer was not available for analysis.\nFor a downloadable copy of IOCs, see:\nMAR-10201537\nFiles (12)\n10ac312c8dd02e417dd24d53c99525c29d74dcbc84730351ad7a4e0a4b1a0eba (Lost_File.so)\n1f2cd2bc23556fb84a51467fedb89cbde7a5883f49e3cfd75a241a6f08a42d6d (Unpacked_dump_4a740227eeb82c20...)\n3a5ba44f140821849de2d82d5a137c3bb5a736130dddb86b296d94e6b421594c (Lost_File1_so_file)\n4a740227eeb82c20286d9c112ef95f0c1380d0e90ffb39fc75c8456db4f60756 (4f67f3e4a7509af1b2b1c6180a03b3...)\n820ca1903a30516263d630c7c08f2b95f7b65dffceb21129c51c9e21cf9551c6 (5cfa1c2cb430bec721063e3e2d144f...)\n9ddacbcd0700dc4b9babcd09ac1cebe23a0035099cb612e6c85ff4dffd087a26 (Unpacked_dump_820ca1903a305162...)\na9bc09a17d55fc790568ac864e3885434a43c33834551e027adb1896a463aafc (8efaabb7b1700686efedadb7949eba...)\nab88f12f0a30b4601dc26dbae57646efb77d5c6382fb25522c529437e5428629 (d0a8e0b685c2ea775a74389973fc92...)\nca9ab48d293cc84092e8db8f0ca99cb155b30c61d32a1da7cd3687de454fe86c (2.so)\nd465637518024262c063f4a82d799a4e40ff3381014972f24ea18bc23c3b27ee (Injection_API_executable_e)\ne03dc5f1447f243cf1f305c58d95000ef4e7dbcc5c4e91154daa5acd83fea9a8 (Injection_API_log_generating_s...)\nf3e521996c85c0cdb2bfb3a0fd91eb03e25ba6feef2ba3a1da844f1b17278dd2 (inject_api)\nIPs (1)\n75.99.63.27\n\nFindings\n\n820ca1903a30516263d630c7c08f2b95f7b65dffceb21129c51c9e21cf9551c6\nTags\nbackdoorproxytrojan\nDetails\n\n\n\nName\n5cfa1c2cb430bec721063e3e2d144feb\n\n\nSize\n1643616 bytes\n\n\nType\nPE32 executable (GUI) Intel 80386, for MS Windows\n\n\nMD5\n5cfa1c2cb430bec721063e3e2d144feb\n\n\nSHA1\nc1a9044f180dc7d0c87e256c4b9356463f2cb7c6\n\n\nSHA256\n820ca1903a30516263d630c7c08f2b95f7b65dffceb21129c51c9e21cf9551c6\n\n\nSHA512\na65e615203269b657e55fe842eca0542a4cd3bac80d3039d85dfb5fbbfdb5768bbabe2fc86f213fb1a759124a82780a1cfbb9fd8457f4923cefad73e9db6f6a4\n\n\nssdeep\n24576:LTxUZWB9BdhYaqJ+LkDWo+eIgV10M/w6weSx4y4Golx+Q/K:LVUZWTjoSkz+eIg/z/YxFasgK\n\n\nEntropy\n7.957226\n\n\n\nAntivirus\n\n\n\nAhnlab\nTrojan/Win32.Agent\n\n\nAntiy\nTrojan/Win32.BTSGeneric\n\n\nAvira\nBDS/RMS.ejnsf\n\n\nBitDefender\nTrojan.GenericKD.30382654\n\n\nCyren\nW32/Trojan.KBJG-8883\n\n\nESET\na variant of Win32/Packed.Themida.AOO trojan\n\n\nEmsisoft\nTrojan.GenericKD.30382654 (B)\n\n\nIkarus\nTrojan.Win32.Themida\n\n\nMcAfee\nTrojan-FPWN!5CFA1C2CB430\n\n\nMicrosoft Security Essentials\nTrojan:Win32/Cobfast\n\n\nNANOAV\nTrojan.Win32.RMS.ewarws\n\n\nNetGate\nTrojan.Win32.Malware\n\n\nSophos\nTroj/Agent-AZWN\n\n\nSymantec\nTrojan.Gen.2\n\n\nTrendMicro\nTrojanS.91189A95\n\n\nTrendMicro House Call\nTrojanS.91189A95\n\n\nVirusBlokAda\nBackdoor.RMS\n\n\nZillya!\nBackdoor.Agent.Win64.370\n\n\n\nYara Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nPE Metadata\n\n\n\nCompile Date\n2017-08-14 13:14:04-04:00\n\n\nImport Hash\nbaa93d47220682c04d92f7797d9224ce\n\n\n\nPE Sections\n\n\n\nMD5\nName\nRaw Size\nEntropy\n\n\n23041caef38d4991296ffbe42743c691\nheader\n4096\n0.825738\n\n\nda701d0e0ab6bfbddd747feebed96546\n\u00a0\n156672\n7.983417\n\n\nd41d8cd98f00b204e9800998ecf8427e\n.rsrc\n0\n0.000000\n\n\nefcb51d4d8a55d441d194e80899bb2b0\n.idata\n512\n1.308723\n\n\n231617ad2dc2a0c3f2d8e3241c57626f\n\u00a0\n512\n0.240445\n\n\n92a0680fea369ae11f900c1a92e5499c\ngvxlrmcr\n1474048\n7.954645\n\n\ncf68e5165e3b89c0ece9b4905abf861a\neolnwoiw\n512\n3.342017\n\n\n\nProcess List\n\n\n\nProcess\nPID\nPPID\n\n\n820ca1903a30516263d630c7c08f2b95f7b65dffceb21129c51c9e21cf9551c6.exe\n2104\n(2084)\n\n\nlsass.exe\n468\n(384)\n\n\n\nDescription\nThis application is a Themida packed 32-bit Windows executable. This application is designed to unpack and execute a service proxy module in memory (5c0a4f9e67ced69eaea17092444b2c1a).Analysis indicates that this proxy module is designed to accept command-line parameters to perform its functions. The module is designed to modify the Windows Firewall on the victim\u2019s machine to allow for incoming connections and to force the compromised system to function as a proxy server. The proxy module uses the following command to open the Windows Firewall port on the victim\u2019s machine in order to allow for incoming connections:--Begin firewall modification--\"netsh firewall add portopening TCP <port> RPCServer\"--End firewall modification--The malware is designed to listen to an open port for incoming traffic. The traffic may contain instructions to perform any of the following functions:\u00a0\u00a0\u00a0-Retrieve information about the logon sessions, drives installed, and operating system\u00a0\u00a0\u00a0-Search for files\u00a0\u00a0\u00a0-Execute process\u00a0\u00a0\u00a0-Terminate processes\u00a0\u00a0\u00a0-Delete files\u00a0\u00a0\u00a0-Execute command\u00a0\u00a0\u00a0-Download and upload files\u00a0\u00a0\u00a0-Read files and write files-Compress and decompress filesThis malware used the multi-protocol file transfer library \"libcurl 7.49.1\" for transferring data with a URL syntax. It supports the following network protocols:\u00a0\u00a0\u00a0-POP3\u00a0\u00a0\u00a0-SMTP\u00a0\u00a0\u00a0-IMAP\u00a0\u00a0\u00a0-LDAP\u00a0\u00a0\u00a0-DICT\u00a0\u00a0\u00a0-FTP\u00a0\u00a0\u00a0-HTTP\u00a0\u00a0\u00a0-HTTPS\n\n\n9ddacbcd0700dc4b9babcd09ac1cebe23a0035099cb612e6c85ff4dffd087a26\nTags\ntrojan\nDetails\n\n\n\nName\nUnpacked_dump_820ca1903a30516263d630c7c08f2b95f7b65dffceb21129c51c9e21cf9551c6.exe\n\n\nSize\n4247040 bytes\n\n\nType\nPE32 executable (GUI) Intel 80386, for MS Windows\n\n\nMD5\n5c0a4f9e67ced69eaea17092444b2c1a\n\n\nSHA1\n8462cb955a6c459036a3e27d59b1b8b6cc9acfd5\n\n\nSHA256\n9ddacbcd0700dc4b9babcd09ac1cebe23a0035099cb612e6c85ff4dffd087a26\n\n\nSHA512\n3a0f668d5ae4998ad6555adccbfcf837eabee2dcb2e36a3c9cad8efe0996a5a7ba238041b8f31b1e2feb36165daac0c6b5fe70e4df5339dce0aa0d031d455dec\n\n\nssdeep\n98304:mv9KZUELYbD09b2WBFs6BEroKso7aO7/Qs7K:mwZHs6BaoE71MEK\n\n\nEntropy\n6.823899\n\n\n\nAntivirus\n\n\n\nAhnlab\nTrojan/Win32.Agent\n\n\nAntiy\nTrojan/Win32.Casdet\n\n\nAvira\nTR/Casdet.kgzto\n\n\nBitDefender\nGen:Trojan.Heur.PT.@BW@bq9rd7j\n\n\nCyren\nW32/Trojan.JVPW-7331\n\n\nEmsisoft\nGen:Trojan.Heur.PT.@BW@bq9rd7j (B)\n\n\nIkarus\nTrojan.Win32.Casdet\n\n\nK7\nRiskware ( 0040eff71 )\n\n\nMcAfee\nTrojan-Themida\n\n\nMicrosoft Security Essentials\nTrojan:Win32/Cobfast\n\n\nNANOAV\nTrojan.Win32.PT.fjoljg\n\n\nQuick Heal\nTrojan.IGENERIC\n\n\nSophos\nTroj/Agent-AZXJ\n\n\nSymantec\nTrojan Horse\n\n\nTrendMicro\nBackdoo.9B86B81E\n\n\nTrendMicro House Call\nBackdoo.9B86B81E\n\n\nVirusBlokAda\nTrojan.Agentb\n\n\nZillya!\nTrojan.Agentb.Win32.20050\n\n\n\nYara Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nPE Metadata\n\n\n\nCompile Date\n2017-08-14 13:14:04-04:00\n\n\nImport Hash\nbaa93d47220682c04d92f7797d9224ce\n\n\n\nPE Sections\n\n\n\nMD5\nName\nRaw Size\nEntropy\n\n\n22f49b12cb818728d293ae43082d8949\nheader\n1024\n2.661805\n\n\n01c0e5316c7bba2ebdc00754a1d83f2a\n\u00a0\n311296\n6.307203\n\n\nd41d8cd98f00b204e9800998ecf8427e\n.rsrc\n0\n0.000000\n\n\n5e501430acba545b719c0887357226dd\n.idata\n1024\n0.778128\n\n\n37fabfab797e631603a696b7ac2296d7\n\u00a0\n2459136\n5.741823\n\n\nc10780e19363abda168c5861ce481635\ngvxlrmcr\n1474048\n7.954349\n\n\n671f4fb0c657d89c924064db6be0442e\neolnwoiw\n512\n3.326839\n\n\n\nDescription\nThis file is the unpacked version of 820ca1903a30516263d630c7c08f2b95f7b65dffceb21129c51c9e21cf9551c6.Displayed below are strings of interest for this unpacked proxy module:--Begin strings of interest--httplibcurl/7.49.1%s:%d%255[^:]:%d:%255s%255[^:]:%d<no protocol>%I64u-ALL_PROXYall_proxyhttp_proxy_proxyNO_PROXYno_proxy%s://%s%s%s:%hu%s%s%s;type=%c[%*45[0123456789abcdefABCDEF:.]%cftp@example.comanonymous%s%s%sUser-Agent: %sSet-Cookie:RELOADFLUSHSESSidentitysockssocks4socks4asocks5socks5hpop3POP3.smtpSMTP.IMAPIMAP.LDAPLDAP.DICTDICT.FTP./?]%[^%15[^:]://%[^/?]%[^file%15[^:]:%[^%s://%sFALSETRUE#HttpOnly_expiresmax-ageversiondomainpathhttponlysecure%1023[^;=] =%4999[^;%s%s%s%I64dunknown# Fatal libcurl error# Netscape HTTP Cookie File# https://curl.haxx.se/docs/http-cookies.html# This file was generated by libcurl! Edit at your own risk.none[%s %s %s]fromHeaderDatahost!0123456789abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ(nil)(nil).%ld0123456789%d.%d.%d.%dHTTP%sAuthorization: Basic %sProxy-%s:%sBasicAuthorization:Proxy-authorization:DigestNTLMHTTP/Expect: 100-continue100-continueExpect:ConnectionContent-LengthContent-Type:Host:If-Modified-Since: %sIf-Unmodified-Since: %sLast-Modified: %s%s, %02d %s %4d %02d:%02d:%02d GMTContent-Type: application/x-www-form-urlencodedContent-Length: 0Content-Length: %I64dContent-Length:%s%s%s%s=%sCookie:%s HTTP/%s%s%s%s%s%s%s%s%s%s%sftp://%s:%s@%sContent-Range: bytes %s/%I64dContent-Range: bytes %s%I64d/%I64dContent-Range: bytes 0-%I64d/%I64dContent-Range:Range: bytes=%sRange:Host: %s%s%s:%huHost: %s%s%sAccept: */*Accept:;type=ftp://Transfer-Encoding: chunkedchunkedTransfer-Encoding:Accept-Encoding: %sAccept-Encoding:Cookie:Referer: %sReferer:User-Agent:POSTHEADLocation:Proxy-authenticate:WWW-Authenticate:Last-Modified:Content-Encoding:x-gzipgzipdeflateConnection:closeProxy-Connection:keep-aliveServer:RTSP/%d.%d %3dHTTP %3dHTTP/%d.%d %d%hu.%hu.%hu.%huHTTP/1.%d %dCONNECT %s HTTP/%s%s%s%sHost: %s%s%s%s:%huCONNECT%s:%hudefaultmachinepasswordlogin_netrcHOMEc%c==%c%c%c=%c%c%c%capplication/xml.xmltext/html.htmltext/plain.txt.jpegimage/jpeg.jpgimage/gif.gif; filename=\"%s\"------------------------%08x%08x--%s----%s--Content-Type: %s--%sContent-Disposition: attachmentContent-Type: multipart/mixed; boundary=%sContent-Disposition: form-data; name=\"--%s%s; boundary=%sContent-Type: multipart/form-dataOut of memoryBad content-encoding foundWrite errorMalformed encoding foundIllegal or missing hexadecimal sequenceToo long hexadecimal number%02xauth-intauth%08x%08x%08x%08x%s, algorithm=\"%s\"%s, opaque=\"%s\"username=\"%s\", realm=\"%s\", nonce=\"%s\", uri=\"%s\", response=\"%s\"username=\"%s\", realm=\"%s\", nonce=\"%s\", uri=\"%s\", cnonce=\"%s\", nc=%08x, qop=%s, response=\"%s\"%s:%s:%08x:%s:%s:%sd41d8cd98f00b204e9800998ecf8427e%s:%s:%sMD5-sessalgorithmopaquerealmtruestalenonceNTLMSSPNTLMSSP%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%s%sNTLMSSP%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%cKGS!@#$%%c%c%c%cout of memory1.2.8internal error: deflate stream corruptrequested length does not fit in intdeflate 1.2.8 Copyright 1995-2013 Jean-loup Gailly and Mark Adler1.2.8--End strings of interest--\n\n\n4a740227eeb82c20286d9c112ef95f0c1380d0e90ffb39fc75c8456db4f60756\nTags\nbackdoorproxytrojan\nDetails\n\n\n\nName\n4f67f3e4a7509af1b2b1c6180a03b3e4\n\n\nSize\n2206296 bytes\n\n\nType\nPE32+ executable (console) x86-64, for MS Windows\n\n\nMD5\n4f67f3e4a7509af1b2b1c6180a03b3e4\n\n\nSHA1\n1c9a437ed876a0ce0e5374bd93acdfd9e9023f1f\n\n\nSHA256\n4a740227eeb82c20286d9c112ef95f0c1380d0e90ffb39fc75c8456db4f60756\n\n\nSHA512\naa310ce7bb649c7bac9295ec0e68c15d595a2bea79c4d0fb22cd13779deee02a04df2824f5583a8cc5f249659474feeb5f647b0a875fe2bc663d8e4c34275316\n\n\nssdeep\n49152:9ywn1c6Q+lkOpdHyjyDMXSfRndy7vdaCYzQ7cxTEhr2nvoBPVis8M:Ja6HtHk+nojUT6r2nvoB/\n\n\nEntropy\n7.956937\n\n\n\nAntivirus\n\n\n\nAhnlab\nTrojan/Win64.Agent\n\n\nAntiy\nTrojan/Win64.NukeSped\n\n\nBitDefender\nTrojan.Generic.22876704\n\n\nCyren\nW64/Trojan.LTPJ-3011\n\n\nESET\nWin64/NukeSped.AA trojan\n\n\nEmsisoft\nTrojan.Generic.22876704 (B)\n\n\nIkarus\nTrojan.Win64.Nukesped\n\n\nMcAfee\nTrojan-FPWN!4F67F3E4A750\n\n\nMicrosoft Security Essentials\nTrojan:Win64/NukeSped\n\n\nNANOAV\nTrojan.Win64.RMS.facjgp\n\n\nNetGate\nMalware.Generic\n\n\nQuick Heal\nTrojan.IGENERIC\n\n\nSophos\nTroj/NukeSped-H\n\n\nSymantec\nTrojan.Gen.2\n\n\nTrendMicro\nTrojan.C9DEC062\n\n\nTrendMicro House Call\nTrojan.C9DEC062\n\n\nVir.IT eXplorer\nBackdoor.Win32.RMS.EN\n\n\nVirusBlokAda\nTrojan.Win64.Agent\n\n\n\nYara Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nPE Metadata\n\n\n\nCompile Date\n2017-08-14 13:14:12-04:00\n\n\nImport Hash\nbaa93d47220682c04d92f7797d9224ce\n\n\n\nPE Sections\n\n\n\nMD5\nName\nRaw Size\nEntropy\n\n\n4bd1bcb9809fedb1d4f556b695fb95a6\nheader\n4096\n0.868689\n\n\n32f3f5b6711f8cb1c9655b615701f50d\n\u00a0\n184832\n7.922033\n\n\nd41d8cd98f00b204e9800998ecf8427e\n.rsrc\n0\n0.000000\n\n\n74c1d1ec299d8a058f22b61277ceea66\n.idata\n512\n1.297004\n\n\nf4facb792a8404ec46a8119da73d6ec4\n\u00a0\n512\n0.231158\n\n\n075fa8edf884d5a43ba9a96c4b20de25\ntwvngiow\n1994240\n7.960560\n\n\na1785d4faeedfebd99e0cc737f38f551\npavwhbmc\n512\n4.473835\n\n\n5af578a4785cc0683866fa19e262eb4d\n.pdataI\n14336\n5.546603\n\n\n\nProcess List\n\n\n\nProcess\nPID\nPPID\n\n\nlsass.exe\n468\n(384)\n\n\n4a740227eeb82c20286d9c112ef95f0c1380d0e90ffb39fc75c8456db4f60756.exe\n2120\n(2152)\n\n\n\nDescription\nThis application is a Themida packed 64-bit Windows executable. This application is designed to unpack and execute a service proxy module in memory (02959903cd988443e5ef519d556b34b0).Analysis indicates that this proxy module is designed to accept command-line parameters to perform its functions. The module is designed to modify the Windows Firewall on the victim\u2019s machine to allow for incoming connections and to force the compromised system to function as a proxy server.The proxy module uses the following command to open the Windows Firewall port on the victim\u2019s machine in order to allow for incoming connections:--Begin firewall modification--\"netsh firewall add portopening TCP <port> RPCServer\"--End firewall modification--The malware is designed to listen to an open port for incoming traffic. The traffic may contain instructions to perform any of the following functions:\u00a0\u00a0\u00a0-Retrieve information about the logon sessions, drives installed, and operating system\u00a0\u00a0\u00a0-Search for files\u00a0\u00a0\u00a0-Execute process\u00a0\u00a0\u00a0-Terminate processes\u00a0\u00a0\u00a0-Delete files\u00a0\u00a0\u00a0-Execute command\u00a0\u00a0\u00a0-Download and upload files\u00a0\u00a0\u00a0-Read files and write files-Compress and decompress filesThis malware used the multi-protocol file transfer library \"libcurl 7.49.1\" for transferring data with a URL syntax. It supports the following network protocols:\u00a0\u00a0\u00a0-POP3\u00a0\u00a0\u00a0-SMTP\u00a0\u00a0\u00a0-IMAP\u00a0\u00a0\u00a0-LDAP\u00a0\u00a0\u00a0-DICT\u00a0\u00a0\u00a0-FTP\u00a0\u00a0\u00a0-HTTP\u00a0\u00a0\u00a0-HTTPS\n\n\n1f2cd2bc23556fb84a51467fedb89cbde7a5883f49e3cfd75a241a6f08a42d6d\nTags\ntrojan\nDetails\n\n\n\nName\nUnpacked_dump_4a740227eeb82c20286d9c112ef95f0c1380d0e90ffb39fc75c8456db4f60756.exe\n\n\nSize\n5889536 bytes\n\n\nType\nPE32+ executable (console) x86-64, for MS Windows\n\n\nMD5\n02959903cd988443e5ef519d556b34b0\n\n\nSHA1\n18e346aa6ee6d3faeae21474f33f5a4601a99213\n\n\nSHA256\n1f2cd2bc23556fb84a51467fedb89cbde7a5883f49e3cfd75a241a6f08a42d6d\n\n\nSHA512\ncc20d9105f0f91c443a6b6c156bfccde81a1b7fa7a9267c156b9129dece9ddeba706d9d1c49da47d54387ade63e1fe2ecc79743f51de1cf92ee23603dba71761\n\n\nssdeep\n98304:s0Mu3F1FKHTTEB/oVHhOEVHtHk+nojUT6r2nvoB:sQ/F0TQ/oVBOEjHk+aUTXoB\n\n\nEntropy\n6.820153\n\n\n\nAntivirus\n\n\n\nAhnlab\nTrojan/Win64.Agent\n\n\nAntiy\nTrojan/Win64.NukeSped\n\n\nAvira\nTR/NukeSped.hpdmh\n\n\nBitDefender\nTrojan.GenericKD.31269196\n\n\nCyren\nW64/Trojan.KXMA-8070\n\n\nESET\na variant of Win64/NukeSped.AS trojan\n\n\nEmsisoft\nTrojan.GenericKD.31269196 (B)\n\n\nIkarus\nTrojan.Win64.Nukesped\n\n\nK7\nTrojan ( 0053e7091 )\n\n\nMcAfee\nTrojan-NukeSped\n\n\nMicrosoft Security Essentials\nTrojan:Win64/NukeSped\n\n\nQuick Heal\nTrojan.IGENERIC\n\n\nSophos\nTroj/Casdet-A\n\n\nSymantec\nTrojan Horse\n\n\nTACHYON\nTrojan/W64.Agent.5889536\n\n\nTrendMicro\nBackdoo.9E21C9BF\n\n\nTrendMicro House Call\nBackdoo.9E21C9BF\n\n\nVirusBlokAda\nTrojan.Win64.Agent\n\n\nZillya!\nTrojan.NukeSped.Win64.25\n\n\n\nYara Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nPE Metadata\n\n\n\nCompile Date\n2017-08-14 13:14:12-04:00\n\n\nImport Hash\nbaa93d47220682c04d92f7797d9224ce\n\n\n\nPE Sections\n\n\n\nMD5\nName\nRaw Size\nEntropy\n\n\na425d258e0ddf17fe412040b81d41aac\nheader\n1024\n2.802251\n\n\n9cfb80616de943facef57fabbece780a\n\u00a0\n374784\n6.195005\n\n\nd41d8cd98f00b204e9800998ecf8427e\n.rsrc\n0\n0.000000\n\n\n55e1897e20dbef5db7b4a718fd539ef7\n.idata\n1024\n0.797549\n\n\n83734ab1f8e17720271dc4b429ea0f6c\n\u00a0\n3503616\n5.733920\n\n\n18f194fd3ae2455d8e26aad2e0dd6685\ntwvngiow\n1994240\n7.960332\n\n\n5fa71bdf383d16a6b25955bff53efb90\npavwhbmc\n512\n4.459428\n\n\n5af578a4785cc0683866fa19e262eb4d\n.pdataI\n14336\n5.546603\n\n\n\nDescription\nThis file is the unpacked version of 4a740227eeb82c20286d9c112ef95f0c1380d0e90ffb39fc75c8456db4f60756.Displayed below are strings of interest for this unpacked proxy module:--Begin strings of interest--httplibcurl/7.49.1%s:%d%255[^:]:%d:%255s%255[^:]:%d<no protocol>%I64u-ALL_PROXYall_proxyhttp_proxy_proxyNO_PROXYno_proxy%s://%s%s%s:%hu%s%s%s;type=%c[%*45[0123456789abcdefABCDEF:.]%cftp@example.comanonymous%s%s%sUser-Agent: %sSet-Cookie:RELOADFLUSHSESSidentitysockssocks4socks4asocks5socks5hpop3POP3.smtpSMTP.IMAPIMAP.LDAPLDAP.DICTDICT.FTP./?]%[^%15[^:]://%[^/?]%[^file%15[^:]:%[^%s://%sFALSETRUE#HttpOnly_expiresmax-ageversiondomainpathhttponlysecure%1023[^;=] =%4999[^;%s%s%s%I64dunknown# Fatal libcurl error# Netscape HTTP Cookie File# https://curl.haxx.se/docs/http-cookies.html# This file was generated by libcurl! Edit at your own risk.none[%s %s %s]fromHeaderDatahost!0123456789abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ(nil)(nil).%ld0123456789%d.%d.%d.%dHTTP%sAuthorization: Basic %sProxy-%s:%sBasicAuthorization:Proxy-authorization:DigestNTLMHTTP/Expect: 100-continue100-continueExpect:ConnectionContent-LengthContent-Type:Host:If-Modified-Since: %sIf-Unmodified-Since: %sLast-Modified: %s%s, %02d %s %4d %02d:%02d:%02d GMTContent-Type: application/x-www-form-urlencodedContent-Length: 0Content-Length: %I64dContent-Length:%s%s%s%s=%sCookie:%s HTTP/%s%s%s%s%s%s%s%s%s%s%sftp://%s:%s@%sContent-Range: bytes %s/%I64dContent-Range: bytes %s%I64d/%I64dContent-Range: bytes 0-%I64d/%I64dContent-Range:Range: bytes=%sRange:Host: %s%s%s:%huHost: %s%s%sAccept: */*Accept:;type=ftp://Transfer-Encoding: chunkedchunkedTransfer-Encoding:Accept-Encoding: %sAccept-Encoding:Cookie:Referer: %sReferer:User-Agent:POSTHEADLocation:Proxy-authenticate:WWW-Authenticate:Last-Modified:Content-Encoding:x-gzipgzipdeflateConnection:closeProxy-Connection:keep-aliveServer:RTSP/%d.%d %3dHTTP %3dHTTP/%d.%d %d%hu.%hu.%hu.%huHTTP/1.%d %dCONNECT %s HTTP/%s%s%s%sHost: %s%s%s%s:%huCONNECT%s:%hudefaultmachinepasswordlogin_netrcHOMEc%c==%c%c%c=%c%c%c%capplication/xml.xmltext/html.htmltext/plain.txt.jpegimage/jpeg.jpgimage/gif.gif; filename=\"%s\"------------------------%08x%08x--%s----%s--Content-Type: %s--%sContent-Disposition: attachmentContent-Type: multipart/mixed; boundary=%sContent-Disposition: form-data; name=\"--%s%s; boundary=%sContent-Type: multipart/form-dataOut of memoryBad content-encoding foundWrite errorMalformed encoding foundIllegal or missing hexadecimal sequenceToo long hexadecimal number%02xauth-intauth%08x%08x%08x%08x%s, algorithm=\"%s\"%s, opaque=\"%s\"username=\"%s\", realm=\"%s\", nonce=\"%s\", uri=\"%s\", response=\"%s\"username=\"%s\", realm=\"%s\", nonce=\"%s\", uri=\"%s\", cnonce=\"%s\", nc=%08x, qop=%s, response=\"%s\"%s:%s:%08x:%s:%s:%sd41d8cd98f00b204e9800998ecf8427e%s:%s:%sMD5-sessalgorithmopaquerealmtruestalenonceNTLMSSPNTLMSSP%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%s%sNTLMSSP%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%cKGS!@#$%%c%c%c%cout of memory1.2.8internal error: deflate stream corruptrequested length does not fit in intdeflate 1.2.8 Copyright 1995-2013 Jean-loup Gailly and Mark Adler1.2.8--End strings of interest--\n\n\nab88f12f0a30b4601dc26dbae57646efb77d5c6382fb25522c529437e5428629\nTags\nremote-access-trojantrojan\nDetails\n\n\n\nName\nd0a8e0b685c2ea775a74389973fc92ca\n\n\nSize\n122880 bytes\n\n\nType\nPE32 executable (GUI) Intel 80386, for MS Windows\n\n\nMD5\nd0a8e0b685c2ea775a74389973fc92ca\n\n\nSHA1\nc752ad74cb99a836eec4b984dab03cb7e99eb974\n\n\nSHA256\nab88f12f0a30b4601dc26dbae57646efb77d5c6382fb25522c529437e5428629\n\n\nSHA512\n6ec195aa1ec3226252f4959c0abbe0db06645e5b3dea8351d2da8dfb87cce71ce1424159e325fa6a77bf2fe4f0a3181e1ed23f4eb17db6bdc119e4fec7273416\n\n\nssdeep\n3072:pNwZ4j/a2NlHbAoTL4592kHhEBZTWTBfg09ruXlN:pNwZ4zaibAoTL45oMEPWTBp9ruXl\n\n\nEntropy\n6.098281\n\n\n\nAntivirus\n\n\n\nAhnlab\nTrojan/Win32.Alreay\n\n\nAntiy\nTrojan[Banker]/Win32.Alreay\n\n\nBitDefender\nGen:Variant.Graftor.364318\n\n\nCyren\nW32/Heuristic-KPP!Eldorado\n\n\nESET\na variant of Win32/NukeSped.CK trojan\n\n\nEmsisoft\nGen:Variant.Graftor.364318 (B)\n\n\nIkarus\nTrojan.Win32.NukeSped\n\n\nK7\nRiskware ( 0040eff71 )\n\n\nMcAfee\nGeneric Trojan.aa\n\n\nMicrosoft Security Essentials\nTrojan:Win32/NukeSped\n\n\nNANOAV\nTrojan.Win32.Alreay.fipyuo\n\n\nNetGate\nTrojan.Win32.Malware\n\n\nQuick Heal\nTrojan.IGENERIC\n\n\nSophos\nTroj/Agent-AZXI\n\n\nSymantec\nTrojan.Gen\n\n\nTACHYON\nTrojan.Generic.18331628\n\n\nTrendMicro\nTrojan.3BCCD691\n\n\nTrendMicro House Call\nTrojan.3BCCD691\n\n\nVirusBlokAda\nTrojanBanker.Alreay\n\n\nZillya!\nTrojan.Agent.Win32.722146\n\n\n\nYara Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nPE Metadata\n\n\n\nCompile Date\n2016-03-19 14:03:05-04:00\n\n\nImport Hash\n4215312bc485628dca703e26b9c891d0\n\n\nCompany Name\nNone\n\n\nFile Description\nResource cache builder tool\n\n\nInternal Name\nmcbuilder.exe\n\n\nLegal Copyright\n\u24d2 Microsoft Corporation. All rights reserved.\n\n\nOriginal Filename\nNone\n\n\nProduct Name\nMicrosoft\u00ae Windows\u00ae Operating System\n\n\nProduct Version\n6.2.9200.16384\n\n\n\nPE Sections\n\n\n\nMD5\nName\nRaw Size\nEntropy\n\n\ne31fd661c75ca688e967a8cb3acaf667\nheader\n4096\n0.719150\n\n\nee501cdb0da38b6674f2156044a7c4fa\n.text\n81920\n6.357905\n\n\n01772205e022a2ffd1809a471bd44333\n.rdata\n20480\n6.533817\n\n\n6292ff91b59460d11cb00c8553b79b2d\n.data\n12288\n3.569966\n\n\nc8d0ecf5c22d5806a5af87953844408c\n.rsrc\n4096\n1.146235\n\n\n\nPackers/Compilers/Cryptors\n\n\n\nMicrosoft Visual C++ v6.0\n\n\n\nProcess List\n\n\n\nProcess\nPID\nPPID\n\n\nlsass.exe\n468\n(384)\n\n\nab88f12f0a30b4601dc26dbae57646efb77d5c6382fb25522c529437e5428629.exe\n2344\n(2104)\n\n\n\nRelationships\n\n\n\nab88f12f0a...\nContains\n75.99.63.27\n\n\n\nDescription\nThis application is a 32-bit Windows executable. This application is designed to execute as a service named \"helpsvcs.\" The application utilizes the Rivest Cipher 4 (RC4) encryption algorithm to encrypt configuration data and stores a four-byte data (unique identifier), RC4 key, and the encrypted configuration data into the following registry:--Begin registry key--hKey = HKEY_LOCAL_MACHINESubkey = \"SYSTEM\\CurrentControlSet\\Services\\Security\"ValueName = \"Data1\"ValueData = \"Encrypted configuration data\"hKey = HKEY_LOCAL_MACHINESubkey = \"SYSTEM\\CurrentControlSet\\Services\\PVS\\Security\"ValueName = \"Data1\"ValueData = \"Encrypted configuration data\"--End registry key--Displayed below is the RC4 key for encrypting and decrypting the configuration data:--Begin RC4 key--11 20 00 00 00 00 00 00 00 00 00 00 00 00 00 00--End RC4 key--Displayed below is the hard-coded configuration data, which contains command and control (C2) information:--Begin hard-coded configuration data--FF 04 00 02 00 00 00 04 FF 08 00 00 4B 63 3F 1B \u00a0\u00a0\u00a0 ===> 75.99.63.2700 00 00 00 FF 02 00 01 BB 01 FF 04 00 04 00 00 \u00a0\u00a0\u00a0 ===> port 44300 00 FF 04 00 03 3C 00 00 00 FF 04 00 05 00 0000 00 FF 04 00 08 01 00 00 00 FF 04 00 06 00 0000 00 FF 00 00 09 00 FF 00 00 0A 00 FF 00 00 0B00 FF 00 00 0C 00 FF 00 00 0D 00 FF 00 00 0E 00FF 04 00 07 00 00 00 00 FD--End hard-coded configuration data--Displayed below is the data stored in the registry including the four byte data (unique identifier), RC4 key, and the encrypted configuration data:--Begin configuration data--10 00 20 00 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0==> four bytes data (unique identifier)11 20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0===> RC4 keyFF 04 00 02 00 00 00 04 FF 08 00 00 4B 63 3F 1B \u00a0\u00a0\u00a0 ===> configuration00 00 00 00 FF 02 00 01 BB 01 FF 04 00 04 00 0000 00 FF 04 00 03 3C 00 00 00 FF 04 00 05 00 0000 00 FF 04 00 08 01 00 00 00 FF 04 00 06 00 0000 00 FF 00 00 09 00 FF 00 00 0A 00 FF 00 00 0B00 FF 00 00 0C 00 FF 00 00 0D 00 FF 00 00 0E 00FF 04 00 07 00 00 00 00 FD--End configuration data--The malware is designed to encrypt a payload from the remote operator using the following hard-coded RC4 key.--Begin hard-coded RC4 key--53 87 F2 11 30 3D B5 52 AD C8 28 09 E0 52 60 D0 6C C5 68 E2 70 77 3C 8F 12 C0 7B 13 D7 B3 9F 7C--End hard-coded RC4 key--The encrypted payload is installed into the following registry key:--Begin registry key--hKey = HKEY_LOCAL_MACHINESubkey = \"SYSTEM\\CurrentControlSet\\Services\\Security\"ValueName = \"Data0\"ValueData = \"Encrypted payload\"--End registry key--The malware uses the following command to open the Windows Firewall port on the victim\u2019s machine in order to allow incoming connections:--Begin firewall modification--\"netsh firewall add portopening TCP 443 \"Windows Firewall Remote Management\"\"--End firewall modification--The malware binds and listens on port 443 for incoming connections from a remote operator. No outbound connection was observed during analysis. Static analysis indicates that the malware is capable of providing remote command and control capabilities, including the ability to exfiltrate data, install and run secondary payloads, and provide proxy services on a compromised system. The malware utilizes the RC4 encryption algorithm to encrypt/decrypt a portion of its communications data to and from the remote operator.Following is a list of the types of data exfiltrated by the malware, to include the victim's system information and the malware data:\u00a0\u00a0\u00a0- network adapter information\u00a0\u00a0\u00a0- computer name\u00a0\u00a0\u00a0- username\u00a0\u00a0\u00a0- systems Internet Protocol (IP) address\u00a0\u00a0\u00a0- hard-coded value (00 00 00 04h)\u00a0\u00a0\u00a0- current directory of the malware\u00a0\u00a0\u00a0- %Current directory%\\malware.exe\u00a0\u00a0\u00a0- hard-coded value (01h)\u00a0\u00a0\u00a0- hard-coded value \"PVS\"\u00a0\u00a0\u00a0- the victim's operating system information\u00a0\u00a0\u00a0- installed drives information\u00a0\u00a0\u00a0- the current system timeDisplayed below are additional functions the malware performs based on specified commands from the remote operator:\u00a0\u00a0\u00a0-Retrieve information drives installed\u00a0\u00a0\u00a0-Search for files\u00a0\u00a0\u00a0-Execute processes\u00a0\u00a0\u00a0-Terminate processes\u00a0\u00a0\u00a0-Delete files\u00a0\u00a0\u00a0-Execute commands\u00a0\u00a0\u00a0-Download and upload files\u00a0\u00a0\u00a0-Read files and write files\u00a0\u00a0\u00a0-Compress and uncompress files\u00a0\u00a0\u00a0-Change the listening port for Remote Desktop via registry modification\n\n\na9bc09a17d55fc790568ac864e3885434a43c33834551e027adb1896a463aafc\nTags\ntrojan\nDetails\n\n\n\nName\n8efaabb7b1700686efedadb7949eba49\n\n\nSize\n105984 bytes\n\n\nType\nPE32+ executable (DLL) (GUI) x86-64, for MS Windows\n\n\nMD5\n8efaabb7b1700686efedadb7949eba49\n\n\nSHA1\n7b17d63694eee51010bcad143bc72e355e17cb50\n\n\nSHA256\na9bc09a17d55fc790568ac864e3885434a43c33834551e027adb1896a463aafc\n\n\nSHA512\nfce7a868b531f55b3f483dd66b3c029328ea18bf7586b00172e3c6735023631fa9091f4ac5d4d2f32da95045c18af7f433bbae1e989d68ae710beb676008512b\n\n\nssdeep\n3072:jpaydDE0X8ShTP3SkwsX7Uo+fcqVFn+v4hbHxW:j0yx8eTP3SNC7UbUqVLx\n\n\nEntropy\n6.150963\n\n\n\nAntivirus\n\n\n\nAhnlab\nMalware/Win64.Generic\n\n\nAntiy\nTrojan/Win64.NukeSped\n\n\nBitDefender\nTrojan.GenericKD.30902108\n\n\nCyren\nW64/Trojan.PRVF-4031\n\n\nESET\nWin64/NukeSped.AK trojan\n\n\nEmsisoft\nTrojan.GenericKD.30902108 (B)\n\n\nIkarus\nTrojan.Win64.Nukesped\n\n\nK7\nTrojan ( 0052a98d1 )\n\n\nMcAfee\nGeneric Trojan.aa\n\n\nMicrosoft Security Essentials\nTrojan:Win64/Cobfast\n\n\nQuick Heal\nTrojan.IGENERIC\n\n\nSophos\nTroj/Agent-AZWM\n\n\nSymantec\nTrojan.Gen.2\n\n\nTrendMicro\nTrojan.C9DEC062\n\n\nTrendMicro House Call\nTrojan.C9DEC062\n\n\nVirusBlokAda\nTrojan.Win64.Agent\n\n\nZillya!\nTrojan.GenericKD.Win64.495\n\n\n\nYara Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nPE Metadata\n\n\n\nCompile Date\n2015-01-07 21:49:56-05:00\n\n\nImport Hash\nf124895b94c3b1ec5baf7f21dc62122a\n\n\nCompany Name\nMicrosoft Corporation\n\n\nFile Description\nMicrosoft Neutral Natural Language Server Data and Code\n\n\nInternal Name\nNlsLexicons0002\n\n\nLegal Copyright\n\u00a9 Microsoft Corporation. All rights reserved.\n\n\nOriginal Filename\nNlsLexicons0002.dll\n\n\nProduct Name\nMicrosoft\u00ae Windows\u00ae Operating System\n\n\nProduct Version\n6.1.7600.16385\n\n\n\nPE Sections\n\n\n\nMD5\nName\nRaw Size\nEntropy\n\n\n7db95ed8565bbdbfc5ed4c5e80c68a4f\nheader\n1024\n2.598472\n\n\n387bb23a8901baa300e42ce92310530e\n.text\n71680\n6.521050\n\n\nf0411cd79ef1b71082f0817fe17fe1e6\n.rdata\n18432\n4.690004\n\n\n25afe34ab1b36cc1ee118c9165f8619c\n.data\n7680\n3.582928\n\n\n1bb7ba760f7f7cba0addd4a273b464f6\n.pdata\n4096\n4.606565\n\n\n922af695fe14a7f70f8e068dcadc0584\n.rsrc\n1536\n4.074927\n\n\n729c12997f9639810666bb171ea9241d\n.reloc\n1536\n2.990709\n\n\n\nProcess List\n\n\n\nProcess\nPID\nPPID\n\n\nlsass.exe\n468\n(384)\n\n\nrundll32.exe\n2204\n(1172)\n\n\n\nDescription\nThis application is a malicious 64-bit Windows Dynamic Link Library (DLL), designed to run as a Windows service under Windows \"svchost.exe.\" When executed, it searches and attempts to load and RC4-decrypt a payload from the following registry into memory:--Begin registry key--hKey = HKEY_LOCAL_MACHINESubkey = \"SYSTEM\\CurrentControlSet\\Services\\Security\"ValueName = \"Data0\"hKey = HKEY_LOCAL_MACHINESubkey = \"SYSTEM\\CurrentControlSet\\Services\\Security\"ValueName = \"Data2\"--End registry key--The binary that installs the encrypted payload in the registry was not available for analysis.\n\n\n75.99.63.27\nPorts\n\n443 TCP\n\nWhois\nDomain Name: optonline.netRegistry Domain ID: 4531660_DOMAIN_NET-VRSNRegistrar WHOIS Server: whois.godaddy.comRegistrar URL: http://www.godaddy.comUpdated Date: 2016-06-08T16:38:21ZCreation Date: 1996-10-07T04:00:00ZRegistrar Registration Expiration Date: 2018-10-06T04:00:00ZRegistrar: GoDaddy.com, LLCRegistrar IANA ID: 146Registrar Abuse Contact Email: abuse@godaddy.comRegistrar Abuse Contact Phone: +1.4806242505Domain Status: clientTransferProhibited http://www.icann.org/epp#clientTransferProhibitedDomain Status: clientUpdateProhibited http://www.icann.org/epp#clientUpdateProhibitedDomain Status: clientRenewProhibited http://www.icann.org/epp#clientRenewProhibitedDomain Status: clientDeleteProhibited http://www.icann.org/epp#clientDeleteProhibitedRegistrant Organization: Cablevision Systems CorporationRegistrant State/Province: New YorkRegistrant Country: USName Server: AUTHNS1.CV.NETName Server: AUTHNS1.CVNET.COMDNSSEC: signedDelegationURL of the ICANN WHOIS Data Problem Reporting System: http://wdprs.internic.net/>>> Last update of WHOIS database: 2018-05-22T21:00:00Z <<<\nRelationships\n\n\n\n75.99.63.27\nContained_Within\nab88f12f0a30b4601dc26dbae57646efb77d5c6382fb25522c529437e5428629\n\n\n\n\n\nd465637518024262c063f4a82d799a4e40ff3381014972f24ea18bc23c3b27ee\nTags\ntrojan\nDetails\n\n\n\nName\nInjection_API_executable_e\n\n\nSize\n89088 bytes\n\n\nType\n64-bit XCOFF executable or object module\n\n\nMD5\nb3efec620885e6cf5b60f72e66d908a9\n\n\nSHA1\n274b0bccb1bfc2731d86782de7babdeece379cf4\n\n\nSHA256\nd465637518024262c063f4a82d799a4e40ff3381014972f24ea18bc23c3b27ee\n\n\nSHA512\na36dab1a1bc194b8acc220b23a6e36438d43fc7ac06840daa3d010fddcd9c3168a6bf314ee13b58163967ab97a91224bfc6ba482466a9515de537d5d1fa6c5f9\n\n\nssdeep\n1536:CnM87WOrh1EEshNunXJzZst56iYTKg+T8v6paBLc0s7G8Y+s0nrTqG0s0nrTqB:CpW2h1mhpaBqTrverE\n\n\nEntropy\n5.052439\n\n\n\nAntivirus\n\n\n\nAntiy\nTrojan[inject]/Unix.FASTCash\n\n\nCyren\nTrojan.LKIM-2\n\n\nIkarus\nTrojan.Unix.FastCash\n\n\nMcAfee\nTrojan-FastCash\n\n\nMicrosoft Security Essentials\nTrojan:Unix/FastCash.A!dha\n\n\nSymantec\nTrojan.Fastcash\n\n\nTrendMicro\nTrojan.0A2906AC\n\n\nTrendMicro House Call\nTrojan.0A2906AC\n\n\nVirusBlokAda\nTrojan.Fastcash\n\n\n\nYara Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nProcess List\n\n\n\nProcess\nPID\nPPID\n\n\nlsass.exe\n496\n(384)\n\n\ncmd.exe\n2976\n(2944)\n\n\nrundll32.exe\n2456\n(2976)\n\n\nAcroRd32.exe\n2916\n(2456)\n\n\n\nRelationships\n\n\n\nd465637518...\nRelated_To\ne03dc5f1447f243cf1f305c58d95000ef4e7dbcc5c4e91154daa5acd83fea9a8\n\n\n\nDescription\nThis file is an AIX (Advanced Interactive Executive) executable, intended for a proprietary UNIX operating system developed by IBM. This application is designed to inject a library into a currently running process. Figure 1 contains a screenshot of strings of interest. The strings indicate the application is a command-line utility enabling an operator to easily conduct code injection on an IBM AIX platform. Analysis indicates this application logs it usage to a log file (Figure 2).\nScreenshots\n\n\nFigure 1 - \n\n \n\nFigure 2 - \n\n\n\n3a5ba44f140821849de2d82d5a137c3bb5a736130dddb86b296d94e6b421594c\nTags\ntrojan\nDetails\n\n\n\nName\nLost_File1_so_file\n\n\nSize\n114688 bytes\n\n\nType\n64-bit XCOFF executable or object module\n\n\nMD5\nd790997dd950bb39229dc5bd3c2047ff\n\n\nSHA1\n7e6407c28c55475aa81853fac984267058627877\n\n\nSHA256\n3a5ba44f140821849de2d82d5a137c3bb5a736130dddb86b296d94e6b421594c\n\n\nSHA512\nafdeec93ecb0f97cdf712e80597c3b8ec1e9cad58e1673f2f3ad7f096d49450759b1621dc533b7cdeb62ee5970233bfa820b72cc4b33b919afd49d84823feae9\n\n\nssdeep\n1536:lJhosJHev1QFf+Z/2kREPItM9arn4nwF8uHit2Ofut:jhZJtf+Z/tJtMErn4/k62Iut\n\n\nEntropy\n4.803161\n\n\n\nAntivirus\n\n\n\nAntiy\nTrojan/Generic.Generic\n\n\nCyren\nTrojan.VJAQ-8\n\n\nIkarus\nTrojan.Unix.FastCash\n\n\nMcAfee\nTrojan-FastCash\n\n\nMicrosoft Security Essentials\nTrojan:Unix/FastCash.B!dha\n\n\nSymantec\nTrojan.Fastcash\n\n\nTrendMicro\nTrojan.0A2906AC\n\n\nTrendMicro House Call\nTrojan.0A2906AC\n\n\nVirusBlokAda\nTrojan.Fastcash\n\n\n\nYara Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nProcess List\n\n\n\nProcess\nPID\nPPID\n\n\nlsass.exe\n496\n(384)\n\n\ncmd.exe\n2136\n(3040)\n\n\nrundll32.exe\n2728\n(2136)\n\n\nAcroRd32.exe\n2900\n(2728)\n\n\n\nDescription\nThis file is an AIX executable, intended for a proprietary UNIX operating system developed by IBM. This file is a library application designed to provide export functions, which allows an application to perform transactions on financial systems using the ISO8583 standard. A list of the ISO8583 functions is displayed in Figure 3 and Figure 4.\nScreenshots\n\n\nFigure 3 - \n\n \n\nFigure 4 - \n\n\n\ne03dc5f1447f243cf1f305c58d95000ef4e7dbcc5c4e91154daa5acd83fea9a8\nTags\ntrojan\nDetails\n\n\n\nName\nInjection_API_log_generating_script\n\n\nSize\n2337 bytes\n\n\nType\nASCII text\n\n\nMD5\n844eec0ff86c10f5f9b41648b066563b\n\n\nSHA1\n5d0fd2c5f58dcbc51e210894e8698bc14ccd30e2\n\n\nSHA256\ne03dc5f1447f243cf1f305c58d95000ef4e7dbcc5c4e91154daa5acd83fea9a8\n\n\nSHA512\n199dee05b602039e480f62963cb0ec3b96393e37bb78ff1475e6dfc5857e484924a476dbe73f02de96670ff488eb26f53ca9c600dd44390cf767a4aa510869a4\n\n\nssdeep\n48:H5rkj2hoPsGPWEA9oEro6mzsmPlaaCc8gN4ickx+nQZmZ7GA5hJLu:H5S0GPPA9hro6RClpCcxN4iDAmmZNhJS\n\n\nEntropy\n5.251062\n\n\n\nAntivirus\n\n\n\nAntiy\nTrojan[Log]/Unix.FASTCash\n\n\n\nYara Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nProcess List\n\n\n\nProcess\nPID\nPPID\n\n\nlsass.exe\n496\n(384)\n\n\ncmd.exe\n2940\n(2880)\n\n\nrundll32.exe\n2584\n(2940)\n\n\nAcroRd32.exe\n3004\n(2584)\n\n\n\nRelationships\n\n\n\ne03dc5f144...\nRelated_To\nd465637518024262c063f4a82d799a4e40ff3381014972f24ea18bc23c3b27ee\n\n\n\nDescription\nThe file appears to be a log file generated by the usage of the application Inject API executable_e (b3efec620885e6cf5b60f72e66d908a9). The data contained in the log file is displayed in Figure 5, 6 and 7.\nScreenshots\n\n\nFigure 5 - \n\n \n\nFigure 6 - \n\n \n\nFigure 7 - \n\n\n\nf3e521996c85c0cdb2bfb3a0fd91eb03e25ba6feef2ba3a1da844f1b17278dd2\nTags\ntrojan\nDetails\n\n\n\nName\ninject_api\n\n\nSize\n19328 bytes\n\n\nType\n64-bit XCOFF executable or object module\n\n\nMD5\n58bb2236e5aee39760d3e4fc6ee94a79\n\n\nSHA1\na74dd2f9723dfb74d0d7b15294622b6ccc0b9562\n\n\nSHA256\nf3e521996c85c0cdb2bfb3a0fd91eb03e25ba6feef2ba3a1da844f1b17278dd2\n\n\nSHA512\n9b67496127d26b47aa8857b1bcbcc43848c09bdf9369f1008a17257e099fbd23e1896d3abf98cab228e6538d3da741c96d6072cfffd7b9614df795b05de8cca0\n\n\nssdeep\n192:EPraBawFpGxj50/fNB426vRyMrwxOl61YIoBopje4T1jJWA3LZNE6X5PxhKaOdA3:djpGwVB426vRdrEVpt1jFlAAaQF\n\n\nEntropy\n4.345227\n\n\n\nAntivirus\n\n\n\nAntiy\nTrojan/Unix.FASTCash\n\n\n\nYara Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nProcess List\n\n\n\nProcess\nPID\nPPID\n\n\nlsass.exe\n496\n(384)\n\n\ncmd.exe\n2932\n(2888)\n\n\nrundll32.exe\n2564\n(2932)\n\n\nAcroRd32.exe\n2836\n(2564)\n\n\n\nDescription\nThis file is an AIX executable, intended for a proprietary UNIX operating system developed by IBM. Figure 8 displays strings of interest. The strings contained within the file indicate it is a command-line utility. The file is designed to update a proprietary data structure on a UNIX system known as \"PVPA.\" The code structure in Figure 9, extracted from this application, attempts to perform a raw read of this data structure from memory.\nScreenshots\n\n\nFigure 8 - \n\n \n\nFigure 9 - \n\n\n\nca9ab48d293cc84092e8db8f0ca99cb155b30c61d32a1da7cd3687de454fe86c\nTags\ntrojan\nDetails\n\n\n\nName\n2.so\n\n\nSize\n110592 bytes\n\n\nType\n64-bit XCOFF executable or object module\n\n\nMD5\nb66be2f7c046205b01453951c161e6cc\n\n\nSHA1\nec5784548ffb33055d224c184ab2393f47566c7a\n\n\nSHA256\nca9ab48d293cc84092e8db8f0ca99cb155b30c61d32a1da7cd3687de454fe86c\n\n\nSHA512\n6890dcce36a87b4bb2d71e177f10ba27f517d1a53ab02500296f9b3aac0218107ced483d70d757a54a5f7489106efa1c1830ef12c93a7f6f240f112c3e90efb5\n\n\nssdeep\n3072:ZGLUeY4Q05eZTe/+3YZbAF/svvtBb0tTy:gLFMAG3YZMF/eBbQTy\n\n\nEntropy\n4.752979\n\n\n\nAntivirus\n\n\n\nAntiy\nTrojan/Unix.FASTCash\n\n\nCyren\nTrojan.DHDC-0\n\n\nIkarus\nTrojan.Unix.FastCash\n\n\nMcAfee\nTrojan-FastCash\n\n\nMicrosoft Security Essentials\nTrojan:Unix/FastCash.C!dha\n\n\nSymantec\nTrojan.Fastcash\n\n\nTrendMicro\nTrojan.0A2906AC\n\n\nTrendMicro House Call\nTrojan.0A2906AC\n\n\nVirusBlokAda\nTrojan.Fastcash\n\n\n\nYara Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nProcess List\n\n\n\nProcess\nPID\nPPID\n\n\nlsass.exe\n468\n(384)\n\n\ncmd.exe\n2692\n(2276)\n\n\nrundll32.exe\n2864\n(2692)\n\n\nAcroRd32.exe\n2112\n(2864)\n\n\n\nDescription\nThis file is an AIX executable, intended for a proprietary UNIX operating system developed by IBM. The application provides several exported methods permitting the interaction with financial systems that utilize the ISO8583 standard. A list of the ISO8583 functions is displayed in Figure 10 and Figure 11. This application is malicious in nature. It provides similar capabilities to hijack and return fraudulent ATM financial query responses as those provided by the malware 10AC312C8DD02E417DD24D53C99525C29D74DCBC84730351AD7A4E0A4B1A0EBA.\nScreenshots\n\n\nFigure 10 - Generating random cash amount for fraudulent financial transaction.\n\n \n\nFigure 11 - \n\n \n\nFigure 12 - \n\n\n\n10ac312c8dd02e417dd24d53c99525c29d74dcbc84730351ad7a4e0a4b1a0eba\nTags\ntrojan\nDetails\n\n\n\nName\nLost_File.so\n\n\nSize\n108896 bytes\n\n\nType\n64-bit XCOFF executable or object module\n\n\nMD5\n46b318bbb72ee68c9d9183d78e79fb5a\n\n\nSHA1\n5375ad3746ce42a6f262f55c4f1f0d273fb69c54\n\n\nSHA256\n10ac312c8dd02e417dd24d53c99525c29d74dcbc84730351ad7a4e0a4b1a0eba\n\n\nSHA512\nc91c8ad860d0e03310d8a0c801495e97635a5f8d5e96282dcb343870443ea0519011d745a323d48a941a23b8226a21809d41cd19c8319e99a6c548dd68649ec2\n\n\nssdeep\n3072:vGLUeY4Q05eZTe/+3YZbAF/7dvtV06eyk:+LFMAG3YZMF/fV06eyk\n\n\nEntropy\n4.816181\n\n\n\nAntivirus\n\n\n\nAntiy\nTrojan/Unix.FASTCash\n\n\nCyren\nTrojan.UCLW-4\n\n\nIkarus\nTrojan.Unix.FastCash\n\n\nMcAfee\nTrojan-FastCash\n\n\nMicrosoft Security Essentials\nTrojan:Unix/FastCash.C!dha\n\n\nSymantec\nTrojan.Fastcash\n\n\nTrendMicro\nTrojan.0A2906AC\n\n\nTrendMicro House Call\nTrojan.0A2906AC\n\n\nVirusBlokAda\nTrojan.Fastcash\n\n\n\nYara Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nProcess List\n\n\n\nProcess\nPID\nPPID\n\n\nlsass.exe\n496\n(384)\n\n\ncmd.exe\n2960\n(2908)\n\n\nrundll32.exe\n1864\n(2960)\n\n\nAcroRd32.exe\n2868\n(1864)\n\n\n\nDescription\nThis file is a UNIX Common Object File Format (COFF) executable, a format for executable, object code, and shared libraries used on UNIX systems. The executable provides several exported methods permitting the interaction with financial systems that utilize the ISO8583 standard. This applications is malicious in nature and appears to have been utilized in the life cycle of an attack against ATM systems. Analysis of this library indicates it is designed to hijack queries from ATM systems to back end banking systems and generate fraudulent responses. The three primary functions responsible for generating these fraudulent responses are:GenerateResponseTransaction1GenerateResponseInquiry1GenerateResponseTransaction2These functions piece together the data structure used to generate ATM transaction responses. Screenshots of a section of code from the function GenerateResponseTransaction1 is attached to this document. As this screenshot illustrates, the malware generates a random cash amount which is then placed in the data structure. Analysis indicates this application also provides the capability to block certain financial transactions. These blocked transactions will be logged to a log file in the format: Blocked Message(msg=%04x, term=%02x, pcode=%06x, pan=%s)\nScreenshots\n\n\nFigure 13 - Malware generating random cash amount for fraudulent financial transaction data structure.\n\n \n\nFigure 14 - Malware logging block financial transactions.\n\n \n\nFigure 15 - Functions responsible for create fraudulent financial transaction responses.\n\n\nRelationship Summary\n\n\n\n\nab88f12f0a...\nContains\n75.99.63.27\n\n\n75.99.63.27\nContained_Within\nab88f12f0a30b4601dc26dbae57646efb77d5c6382fb25522c529437e5428629\n\n\nd465637518...\nRelated_To\ne03dc5f1447f243cf1f305c58d95000ef4e7dbcc5c4e91154daa5acd83fea9a8\n\n\ne03dc5f144...\nRelated_To\nd465637518024262c063f4a82d799a4e40ff3381014972f24ea18bc23c3b27ee\n\n\n\n\nRecommendations\n\nNCCIC would like to remind users and administrators to consider using the following best practices to strengthen the security posture of their organization's systems. Any configuration changes should be reviewed by system owners and administrators prior to implementation to avoid unwanted impacts.\n\nMaintain up-to-date antivirus signatures and engines.\nKeep operating system patches up-to-date.\nDisable File and Printer sharing services. If these services are required, use strong passwords or Active Directory authentication.\nRestrict users' ability (permissions) to install and run unwanted software applications. Do not add users to the local administrators group unless required.\nEnforce a strong password policy and implement regular password changes.\nExercise caution when opening e-mail attachments even if the attachment is expected and the sender appears to be known.\nEnable a personal firewall on agency workstations, configured to deny unsolicited connection requests.\nDisable unnecessary services on agency workstations and servers.\nScan for and remove suspicious e-mail attachments; ensure the scanned attachment is its \"true file type\" (i.e., the extension matches the file header).\nMonitor users' web browsing habits; restrict access to sites with unfavorable content.\nExercise caution when using removable media (e.g., USB thumbdrives, external drives, CDs, etc.).\nScan all software downloaded from the Internet prior to executing.\nMaintain situational awareness of the latest threats and implement appropriate ACLs.\n\nAdditional information on malware incident prevention and handling can be found in NIST's Special Publication 800-83, Guide to Malware Incident Prevention & Handling for Desktops and Laptops.\n\nContact Information\n\n\n1-888-282-0870\nNCCICCustomerService@us-cert.gov (UNCLASS)\nus-cert@dhs.sgov.gov (SIPRNET)\nus-cert@dhs.ic.gov (JWICS)\n\nNCCIC continuously strives to improve its products and services. You can help by answering a very short series of questions about this product at the following URL: https://us-cert.gov/forms/feedback/\n\nDocument FAQ\n\nWhat is a MIFR? A Malware Initial Findings Report (MIFR) is intended to provide organizations with malware analysis in a timely manner. In most instances this report will provide initial indicators for computer and network defense. To request additional analysis, please contact US-CERT and provide information regarding the level of desired analysis.\nWhat is a MAR? A Malware Analysis Report (MAR) is intended to provide organizations with more detailed malware analysis acquired via manual reverse engineering. To request additional analysis, please contact US-CERT and provide information regarding the level of desired analysis.\nCan I edit this document? This document is not to be edited in any way by recipients. All comments or questions related to this document should be directed to the NCCIC at 1-888-282-0870 or soc@us-cert.gov.\nCan I submit malware to NCCIC? Malware samples can be submitted via three methods:\n\nWeb: https://malware.us-cert.gov\nE-Mail: submit@malware.us-cert.gov\nFTP: ftp.malware.us-cert.gov (anonymous)\n\nNCCIC encourages you to report any suspicious activity, including cybersecurity incidents, possible malicious code, software vulnerabilities, and phishing-related scams. Reporting forms can be found on US-CERT's homepage at www.us-cert.gov.\n\n\n\n\n\n\n\nRevisions\n\nOctober 2, 2018: Initial version|December 21, 2018: Added IOCs\n",
  "cves": [
    "CVE-2022-47966",
    "CVE-2022-42475"
  ],
  "techniques": [],
  "advisory": "ar18-275a",
  "title": "MAR-10201537 \u2013 HIDDEN COBRA FASTCash-Related Malware | CISA",
  "source": "analysis-reports",
  "id": "55c8240faee118635b7b974a6252d0a0ebe2731e078ff0a16f7d6a076c4b22d2"
}