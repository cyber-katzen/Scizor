{
  "markdown": "\nOVERVIEW\nThis updated advisory is a follow-up to the updated advisory titled ICSA-14-353-01A Network Time Protocol Vulnerabilities that was published December 23, 2014, on the NCCIC/ICS-CERT web site.\nGoogle Security Team researchers Neel Mehta and Stephen Roettger have coordinated multiple vulnerabilities with CERT/CC concerning the Network Time Protocol (NTP). As NTP is widely used within operational industrial control systems deployments, ICS-CERT is providing this information for US critical infrastructure asset owners and operators for awareness and to identify mitigations for affected devices. ICS-CERT may release updates as additional information becomes available.\nThese vulnerabilities could be exploited remotely.\n--------- Begin Update B Part 1 of 5 --------\nProducts using NTP service prior to ntp-4.2.8p1 are affected. This is an open source protocol.\nICS-CERT sent out a query to vendors we have collaborated with in the past to develop a list of known impacted products. Over 20 vendors have responded back with information regarding if their products are affected by this NTP vulnerability. ICS-CERT is creating a supplement to this advisory that will contain vendor-supplied affected product information, which will be updated as new information is received, without updating this advisory.\n--------- End Update B Part 1 of 5 ----------\nIMPACT\nExploitation of these vulnerabilities could allow an attacker to execute arbitrary code with the privileges of the ntpd process.\nImpact to individual organizations depends on many factors that are unique to each organization. ICS-CERT recommends that organizations evaluate the impact of this vulnerability based on their operational environment, architecture, and product implementation.\nBACKGROUND\n--------- Begin Update B Part 2 of 5 --------\nNTP is described in RFC 958,Network Time Protocol (NTP), http://tools.ietf.org/html/rfc958, web site last accessed February 04, 2015. 1305,Network Time Protocol (Version 3) Specification, Implementation and Analysis, http://tools.ietf.org/html/rfc1305, web site last accessed February 04, 2015. and 5905Network Time Protocol (Version 4) Protocol and Algorithms Specification, http://tools.ietf.org/html/rfc5905, web site last accessed February 04, 2015.; IETF Standards documents that describe the protocol and algorithms used to synchronize time over a network. The reference implementation of these Standards comes from the open source project via the University of Delaware and Network Time Foundation, and is in wide use.\n--------- End Update B Part 2 of 5 ----------\nVULNERABILITY CHARACTERIZATION\nVULNERABILITY OVERVIEW\n\nINSUFFICIENT ENTROPYCWE-331: Insufficient Entropy, http://cwe.mitre.org/data/definitions/331.html, web site last accessed December 19, 2014.\n\nIf the authentication key is not set in the configuration file, ntpd will generate a weak random key with insufficient entropy.\nThis vulnerability was resolved with NTP-dev4.2.7p11 on January 28, 2010.\nCVE-2014-9293NVD, http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-9293, web site last accessed February 04, 2015. has been assigned by CERT/CC to this vulnerability. A CVSS v2 base score of 7.3 has been assigned by CERT/CC; the CVSS vector string is (AV:N/AC:L/Au:M/C:P/I:P/A:C).CVSS Calculator, http://nvd.nist.gov/cvss.cfm?version=2&vector=AV:N/AC:L/Au:M/C:P/I:P/A:C, web site last accessed December 19, 2014.\n\nUSE OF CRYPTOGRAPHICALLY WEAK PRNGCWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG), http://cwe.mitre.org/data/definitions/338.html, web site last accessed December 19, 2014.\n\nPrior to NTP-4.2.7p230, ntp-keygen used a weak seed to prepare a random number generator. The random numbers produced were then used to generate symmetric keys.\nThis vulnerability was resolved with NTP-dev4.2.7p230 on November 1, 2010.\nCVE-2014-9294NVD, http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-9294, web site last accessed February 04, 2015. has been assigned by CERT/CC to this vulnerability. A CVSS v2 base score of 7.3 has been assigned; the CVSS vector string is (AV:N/AC:L/Au:M/C:P/I:P/A:C).CVSS Calculator, http://nvd.nist.gov/cvss.cfm?version=2&vector=AV:N/AC:L/Au:M/C:P/I:P/A:C, web site last accessed February 04, 2015.\n\nSTACK-BASED BUFFER OVERFLOWSCWE-121: Stack-Based Buffer Overflow, http://cwe.mitre.org/data/definitions/121.html, web site last accessed February 04, 2015.\n\nA remote attacker can send a carefully crafted packet that can overflow a stack buffer and potentially allow malicious code to be executed with the privilege level of the ntpd process. All NTP4 releases before 4.2.8 are vulnerable.\nThis vulnerability is resolved with NTP-stable4.2.8 on December 19, 2014.\nCVE-2014-9295NVD, http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-9295, web site last accessed February 04, 2015. has been assigned by CERT/CC to this vulnerability. A CVSS v2 base score of 7.5 has been assigned; the CVSS vector string is (AV:N/AC:L/Au:N/C:P/I:P/A:P).CVSS Calculator, http://nvd.nist.gov/cvss.cfm?version=2&vector=AV:N/AC:L/Au:N/C:P/I:P/A:P, web site last accessed February 04, 2015.\n\nMISSING RETURN ON ERRORCWE-389: Error Conditions, Return Values, Status Codes, http://cwe.mitre.org/data/definitions/389.html, web site last accessed February 04, 2015.\n\nIn the NTP code, a section of code is missing a return, and the resulting error indicates processing did not stop. This indicated a specific rare error occurred, which does not appear to affect system integrity. All NTP Version 4 releases before Version 4.2.8 are vulnerable.\nThis vulnerability is resolved with NTP-stable4.2.8 on December 19, 2014.\nCVE-2014-9296NVD, http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-9296, web site last accessed February 04, 2015. has been assigned by CERT/CC to this vulnerability. A CVSS v2 base score of 5.0 has been assigned; the CVSS vector string is (AV:N/AC:L/Au:N/C:N/I:N/A:P).CVSS Calculator, http://nvd.nist.gov/cvss.cfm?version=2&vector=AV:N/AC:L/Au:N/C:N/I:N/A:P, web site last accessed February 04, 2015.\n--------- Begin Update B Part 3 of 5 --------\n\nAUTHENTICATION BYPASS BY SPOOFINGCWE-290: Authentication Bypass by Spoofing, http://cwe.mitre.org/data/definitions/290.html, web site last accessed February 04, 2015.\n\nThe IPv6 address ::1 can be spoofed, allowing an attacker to bypass access control lists (ACLs) based on ::1. All NTP4 releases before 4.2.8 are vulnerable. Linux and slightly older Mac OSX kernels are vulnerable, but other tested OSes are not vulnerable to the ::1 spoofing. Proper firewall rulings can mitigate this problem. As this issue may be a kernel issue, rather than NTPD, source-IP based ACLs may be vulnerable as well.\nThis vulnerability is resolved with NTP-stable4.2.8p1 on February 04, 2014.\nCVE-2014-9297NVD, http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-9297, NIST uses this advisory to create the CVE web site report. This web site will be active sometime after publication of this advisory. has been assigned by CERT/CC to this vulnerability. A CVSS v2 base score of 9.0 has been assigned; the CVSS vector string is (AV:N/AC:L/Au:N/C:P/I:P/A:C).CVSS Calculator, http://nvd.nist.gov/cvss.cfm?version=2&vector=AV:N/AC:L/Au:N/C:P/I:P/A:C, web site last accessed February 04, 2015.\n\nIMPROPER CHECK FOR UNUSUAL OR EXCEPTIONAL CONDITIONSCWE-754: Improper Check for Unusual or Exceptional Conditions, http://cwe.mitre.org/data/definitions/754.html, web site last accessed February 04, 2015.\n\nThe length value in extension field pointers is not properly validated, allowing information leaks. All NTP Version 4 releases before Version 4.2.8 are vulnerable.\nThis vulnerability is resolved with NTP-stable4.2.8p1 on February 04, 2015.\nCVE-2014-9298NVD, http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-9298, NIST uses this advisory to create the CVE web site report. This web site will be active sometime after publication of this advisory. has been assigned by CERT/CC to this vulnerability. A CVSS v2 base score of 7.5 has been assigned; the CVSS vector string is (AV:N/AC:L/Au:N/C:P/I:P/A:P).CVSS Calculator, http://nvd.nist.gov/cvss.cfm?version=2&vector=AV:N/AC:L/Au:N/C:P/I:P/A:P, web site last accessed February 04, 2015.\n--------- End Update B Part 3 of 5 ----------\nVULNERABILITY DETAILS\nEXPLOITABILITY\nThese vulnerabilities could be exploited remotely.\nEXISTENCE OF EXPLOIT\nNo known public exploits specifically target these vulnerabilities.\nDIFFICULTY\nAn attacker with a low skill and an exploit script would be able to exploit these vulnerabilities. However, a higher-level of skill would be necessary to craft usable exploit scripts.\nMITIGATION\n--------- Begin Update B Part 4 of 5 --------\nAll NTP Version 4 releases, prior to Version 4.2.8p1, are vulnerable and need to be updated to Version 4.2.8p1.\nICS-CERT strongly encourages CIKR users to backup current operational ICS configurations, and thoroughly test the updated software for system compatibility on a test system before attempting deployment on operational systems.\nCERT/CC has published a Vulnerability Note at the following URL:\nhttp://www.kb.cert.org/vuls/id/852879\nICS-CERT would like to thank Network Time Foundations\u2019 NTP Project for coordinating with the Google Security Team Researchers.\nThe latest NTP security information and software releases can be accessed at:\nhttp://support.ntp.org/Main/SecurityNotice\nhttp://support.ntp.org/bin/view/Main/SoftwareDownloads.\nThe NTP project recommends updating firewall rules to disallow ::1 packets from incoming physical Ethernet ports (mitigation for CVE-2014-9297).\n--------- End Update B Part 4 of 5 ----------\nICS-CERT also encourages asset owners to take additional defensive measures to protect against this and other cybersecurity risks.\n\nMinimize network exposure for all control system devices and/or systems, and ensure that they are not accessible from the Internet.\nLocate control system networks and remote devices behind firewalls, and isolate them from the business network.\nWhen remote access is required, use secure methods, such as Virtual Private Networks (VPNs), recognizing that VPNs may have vulnerabilities and should be updated to the most current version available. Also recognize that VPN is only as secure as the connected devices.\n\n--------- Begin Update B Part 5 of 5 --------\nAdditional mitigation guidance and recommended practices are publicly available in the following two publications:\n\nBest Practices for Improved Robustness of Time and Frequency Source in Fixed Locations, that is available for download from the ICS-CERT web site https://ics-cert.us-cert.gov/Other-Reports ).\nICS\u2011CERT Technical Information Paper, ICS-TIP-12-146-01B--Targeted Cyber Intrusion Detection and Mitigation Strategies, that is available for download from the ICS-CERT web site (http://ics-cert.us-cert.gov/).\n\n--------- End Update B Part 5 of 5 ----------\nICS-CERT also provides a section for control systems security recommended practices on the ICS-CERT web page at:\u00a0http://ics-cert.us-cert.gov/content/recommended-practices. Several recommended practices are available for reading and download, including Improving Industrial Control Systems Cybersecurity with Defense-in-Depth Strategies. ICS-CERT reminds organizations to perform proper impact analysis and risk assessment prior to deploying defensive measures.\nOrganizations observing any suspected malicious activity should follow their established internal procedures and report their findings to ICS-CERT for tracking and correlation against other incidents.\n",
  "cves": [
    "CVE-2014-9298",
    "CVE-2014-9294",
    "CVE-2014-9296",
    "CVE-2014-9293",
    "CVE-2014-9297",
    "CVE-2014-9295"
  ],
  "techniques": [],
  "advisory": "icsa-14-353-01b",
  "title": "Network Time Protocol Vulnerabilities (Update B) | CISA",
  "source": "ics-advisories",
  "id": "be53adb9bd060573cc240115ef208194d73b3fa3a01ddd24f438d1561c559641"
}