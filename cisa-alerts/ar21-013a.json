{
  "markdown": "\nBackground\nThese types of attacks frequently occurred when victim organizations\u2019 employees worked remotely and used a mixture of corporate laptops and personal devices to access their respective cloud services. Despite the use of security tools, affected organizations typically had weak cyber hygiene practices that allowed threat actors to conduct successful attacks.\nTechnical Details\nThe cyber threat actors involved in these attacks used a variety of tactics and techniques\u2014including phishing, brute force login attempts, and possibly a \u201cpass-the-cookie\u201d attack\u2014to attempt to exploit weaknesses in the victim organizations\u2019 cloud security practices.\nPhishing\nCISA observed cyber threat actors using phishing emails with malicious links to harvest credentials for users\u2019 cloud service accounts (Phishing: Spearphishing Link [T1598.003]). The cyber actors designed emails that included a link to what appeared to be a secure message and also emails that looked like a legitimate file hosting service account login. After a targeted recipient provided their credentials, the threat actors then used the stolen credentials to gain Initial Access [TA0001] to the user\u2019s cloud service account (Valid Accounts [T1078]). CISA observed the actors\u2019 logins originating from foreign locations (although the actors could have been using a proxy or The Onion Router (Tor) to obfuscate their location). The actors then sent emails from the user\u2019s account to phish other accounts within the organization. In some cases, these emails included links to documents within what appeared to be the organization\u2019s file hosting service.\nIn one case, an organization did not require a virtual private network (VPN) for accessing the corporate network. Although their terminal server was located within their firewall, due to remote work posture, the terminal server was configured with port 80 open to allow remote employees to access it\u2014leaving the organization\u2019s network vulnerable. The threat actor attempted to exploit this by launching brute force login attempts (Brute Force [T1110]).\nForwarding Rules\nIn several engagements, CISA observed threat actors collecting sensitive information by taking advantage of email forwarding rules, which users had set up to forward work emails to their personal email accounts (Email Collection: Email Forwarding Rule [T1114.003]).\nModified Forwarding\nIn one case, CISA determined that the threat actors modified an existing email rule on a user\u2019s account\u2014originally set by the user to forward emails sent from a certain sender to a personal account\u2014to redirect the emails to an account controlled by the actors. The threat actors updated the rule to forward all email to the threat actors\u2019 accounts.\nKeyword Search Rule\nThreat actors also modified existing rules to search users\u2019 email messages (subject and body) for several finance-related keywords (which contained spelling mistakes) and forward the emails to the threat actors\u2019 account.\nNew Rule Creation and Forwarding\nIn addition to modifying existing user email rules, the threat actors created new mailbox rules that forwarded certain messages received by the users (specifically, messages with certain phishing-related keywords) to the legitimate users\u2019 Really Simple Syndication (RSS) Feeds or RSS Subscriptions folder in an effort to prevent warnings from being seen by the legitimate users.\nAuthentication\nCISA verified that the threat actors successfully signed into one user\u2019s account with proper multi-factor authentication (MFA). In this case, CISA believes the threat actors may have used browser cookies to defeat MFA with a \u201cpass-the-cookie\u201d attack (Use Alternate Authentication Material: Web Session Cookie [T1550.004]).\nThe threat actors attempted brute force logins (Brute Force [T1110]) on some accounts. However, this activity was not successful. This thwarted attempt was due, in part, to the threat actors not guessing a correct username/password combination, as well as the organization\u2019s use of MFA to access their cloud environment.\n\nSummary\n\nThis Analysis Report uses the MITRE Adversarial Tactics, Techniques, and Common Knowledge (ATT&CK\u00ae) framework. See the ATT&CK for Enterprise framework for all referenced threat actor tactics and techniques.\nThe Cybersecurity and Infrastructure Security Agency (CISA) is aware of several recent successful cyberattacks against various organizations\u2019 cloud services. Threat actors are using phishing and other vectors to exploit poor cyber hygiene practices within a victims\u2019 cloud services configuration. The information in this report is derived exclusively from several CISA incident response engagements and provides the tactics, techniques, and procedures; indicators of compromise (IOCs) that CISA observed as part of these engagements; and recommended mitigations for organization to strengthen their cloud environment configuration to protect against, detect, and respond to potential attacks.\nFor a downloadable copy of IOCs, see AR21-013A.stix.\nNote: the activity and information in this Analysis Report is not explicitly tied to any one threat actor or known to be specifically associated with the advanced persistent threat actor attributed with the compromise of SolarWinds Orion Platform software and other recent activity.\n\nSolution\n\nCISA recommends the following steps for organizations to strengthen their cloud security practices.\n\nImplement conditional access (CA) policies based upon your organization's needs.\nEstablish a baseline for normal network activity within your environment.\nRoutinely review both Active Directory sign-in logs and unified audit logs for anomalous activity.\nEnforce MFA.\nRoutinely review user-created email forwarding rules and alerts, or restrict forwarding.\nHave a mitigation plan or procedures in place; understand when, how, and why to reset passwords and to revoke session tokens.\nFollow recommend guidance on securing privileged access.\nConsider a policy that does not allow employees to use personal devices for work. At a minimum, use a trusted mobile device management solution.\nResolve client site requests internal to your network.\nConsider restricting users from forwarding emails to accounts outside of your domain.\nAllow users to consent only to app integrations that have been pre-approved by an administrator.\nAudit email rules with enforceable alerts via the Security and Compliance Center or other tools that use the Graph API to warn administrators to abnormal activity.\nImplement MFA for all users, without exception.\nConditional access should be understood and implemented with a zero-trust mindset.\nEnsure user access logging is enabled. Forward logs to a security information and event management appliance for aggregation and monitoring so as to not lose visibility on logs outside of logging periods.\nUse a CA policy to block legacy authentication protocols.\nVerify that all cloud-based virtual machine instances with a public IP do not have open Remote Desktop Protocol (RDP) ports. Place any system with an open RDP port behind a firewall and require users to use a VPN to access it through the firewall.\nFocus on awareness and training. Make employees aware of the threats\u2014such as phishing scams\u2014and how they are delivered. Additionally, provide users training on information security principles and techniques as well as overall emerging cybersecurity risks and vulnerabilities.\nEstablish blame-free employee reporting and ensure that employees know who to contact when they see suspicious activity or when they believe they have been a victim of a cyberattack. This will ensure that the proper established mitigation strategy can be employed quickly and efficiently.\nEnsure existing built-in filtering and detection products (e.g., those for spam, phishing, malware, and safe attachments and links are enabled.\nOrganizations using M365 should also consider the following steps.\n\nAssign a few (one to three) trusted users as electronic discovery (or eDiscovery) managers to conduct forensic content searches across the entire M365 environment (Mailboxes, Teams, SharePoint, and OneDrive) for evidence of malicious activity.\nDisable PowerShell remoting to Exchange Online for regular M365 users. Disabling for non-administrative users will lower the likelihood of a compromised user account being used to programmatically access tenant configurations for reconnaissance.\nDo not allow an unlimited amount of unsuccessful login attempts. To configure these settings, see password smart lockout configuration and sign-in activity reports.\nConsider using a tool such as Sparrow or Hawk\u2014open-source PowerShell-based tools used to gather information related to M365\u2014to investigate and audit intrusions and potential breaches.[1][2]\n\n\n\nResources\n\nSee CISA\u2019s Alert on Technical Approaches to Uncovering and Remediating Malicious Activity for guidance on identifying and handling cyber incidents.\nReview CISA\u2019s General Telework Guidance geared toward system administrators.\nSee CISA\u2019s Analysis Report: Microsoft Office 365 Security Observations (May 2019) for additional guidance.\nCISA also released an Alert: Microsoft Office 365 Security Recommendations with guidance on securing M365 environments.\n\n\nReferences\n\n[1] Sparrow: https://github.com/cisa.gov/Sparrow\n[2] Hawk: https://github.com/T0pCyber/hawk\n\nRevisions\n\nJanuary 13, 2021: Initial Version\n",
  "cves": [
    "CVE-2022-42475",
    "CVE-2022-47966"
  ],
  "techniques": [
    "T1550.004",
    "T1114.003",
    "T1598.003"
  ],
  "advisory": "ar21-013a",
  "title": "Strengthening Security Configurations to Defend Against Attackers Targeting Cloud Services | CISA",
  "source": "analysis-reports",
  "id": "5f40a783faa73b28e12fdc601adbad5bcc3f5f92fa0db20b5bbffdf157e4b2b4"
}