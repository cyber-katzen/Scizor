{
  "markdown": "\n\nSummary\n\nCybersecurity and Infrastructure Security Agency (CISA) analysts have compiled the top detection signatures that have been the most active over the month of May in our national Intrusion Detection System (IDS), known as EINSTEIN. This information is meant to give the reader a closer look into what analysts are seeing at the national level and provide technical details on some of the most active threats.\nIDS is a network tool that uses sensors to monitor inbound and outbound traffic to search for any type of suspicious activity or known threats, alerting analysts when a specific traffic pattern matches with an associated threat. IDS allows users to deploy signatures on these boundary sensors to look for the specific pattern, or network indicator, associated with a known threat.\nThe EINSTEIN Program is an automated process for collecting, correlating, analyzing, and sharing computer security information across the federal civilian departments and agencies. By collecting information from participating federal departments and agencies, CISA builds and enhances our Nation\u2019s cyber-related situational awareness.\nThe signatures CISA created have been included below for analysts across various organizations to use in enhancing their own network defenses. Note: CISA has created and tested these signatures in an environment that might not be the same for all organizations, so administrators may need to make changes or updates before using in the following signatures in their local environments.\n\nTechnical Details\n\nNote: the below Snort signatures accounted for over 90 percent of what CISA analysts identified as potential threats using the IDS system for detection.\n1. NetSupport Manager RAT\nDescription\nThe NetSupport Manager Remote Access Tool (RAT) is a legitimate program that, once installed on a victim\u2019s machine, allows remote administrative control. In a malicious context, it can\u2014among many other functions\u2014be used to steal information. Malicious RATs can be difficult to detect because they do not normally appear in lists of running programs, and they can mimic the behavior of legitimate applications.\nExamples\nIn January 2020, Palo Alto researchers observed the abuse of NetSupport in targeted phishing email campaigns.[1] In November 2019, Zscaler researchers observed \u201csoftware update-themed\u201d campaigns tricking users into installing a malicious NetSupport Manager RAT.[2] The earliest malicious use of NetSupport was seen in a phishing email campaign\u2014reported by FireEye researchers in April 2018.[3]\nSnort Signature\nalert tcp any any -> any $HTTP_PORTS (msg:\"NetSupportManager:HTTP Client Header contains 'User-Agent|3a 20|NetSupport Manager/'\"; flow:established,to_server; flowbits:isnotset,.tagged; content:\"User-Agent|3a 20|NetSupport Manager/\"; http_header; fast_pattern:only; content:\"CMD=\"; nocase; http_client_body; depth:4; content:\"POST\"; nocase; http_method; flowbits:set,.; classtype:http-header; reference:url,unit42.paloaltonetworks.com/cortex-xdr-detects-netsupport-manager-rat-campaign/; reference:url,www.pentestpartners.com/security-blog/how-to-reverse-engineer-a-protocol/; reference:url,github.com/silence-is-best/c2db;\n2. Kovter\nDescription\nKovter is a fileless Trojan with several variants. This malware started as ransomware that malicious actors used to trick victims into thinking that they need to pay their local police a fine. Cyber actors have also used Kovter to perform click-fraud operations to infect targets and send stolen information from the target machines to command and control servers. Kovter\u2019s evolving features have allowed this malware to rank among the Center for Internet Security\u2019s most prolific malware year after year.[4] See CISA\u2019s Webinar on Combatting Ransomware for additional information on Kovter.\nSnort Signature\nalert tcp any any -> any $HTTP_PORTS (msg:\"Kovter:HTTP URI POST to CnC Server\";; flow:established,to_server; flowbits:isnotset,.tagged; content:\"POST / HTTP/1.1\"; depth:15; content:\"Content-Type|3a 20|application/x-www-form-urlencoded\"; http_header; depth:47; fast_pattern; content:\"User-Agent|3a 20|Mozilla/\"; http_header; content:!\"LOADCURRENCY\"; nocase; content:!\"Accept\"; http_header; content:!\"Referer|3a|\"; http_header; content:!\"Cookie|3a|\"; nocase; http_header; pcre:\"/^(?:[A-Za-z0-9+\\/]{4})*(?:[A-Za-z0-9+\\/]{2}==|[A-Za-z0-9+\\/]{3}=|[A-Za-z0-9+\\/]{4})$/P\"; pcre:\"/User-Agent\\x3a[^\\r\\n]+\\r\\nHost\\x3a\\x20(?:\\d{1,3}\\.){3}\\d{1,3}\\r\\nContent-Length\\x3a\\x20[1-5][0-9]{2,3}\\r\\n(?:Cache-Control|Pragma)\\x3a[^\\r\\n]+\\r\\n(?:\\r\\n)?$/H\";; classtype:nonstd-tcp;; reference:url,www.malware-traffic-analysis.net/2017/06/29/index2.html;\n3. XMRig\nDescription\nXMRig is a type of cryptocurrency miner that uses the resources of an unsuspecting infected machine to mine Monero\u2014a type of cryptocurrency. XMRig can cause a victim computer to overheat and perform poorly by using additional system resources that would otherwise not be active.\nSnort Signature\nalert tcp any any -> any !25 (msg:\"XMRIG:Non-Std TCP Client Traffic contains JSONRPC 2.0 Config Data\";; flow:established,to_server; flowbits:isnotset; content:\"|22|jsonrpc|22 3a 22|2.0|22|\"; distance:0; content:\"|22|method|22 3a 22|login|22|\"; distance:0; content:\"|22|agent|22 3a 22|XMRig\"; nocase; distance:0; fast_pattern; content:\"libuv/\"; nocase; distance:0; content:!\"|22|login|22 3a 22|x|22|\"; flowbits:set,; classtype:nonstd-tcp;; reference:url,malware-traffic-analysis.net/2017/11/12/index.html; reference:url,www.mysonicwall.com/sonicalert/searchresults.aspx?ev=article&id=1101;\n\nMitigations\n\nCISA recommends using the following best practices to strengthen the security posture of an organization's systems. Any configuration changes should be reviewed by system owners and administrators prior to implementation to avoid unwanted impacts.\n\nMaintain up-to-date antivirus signatures and engines. See Protecting Against Malicious Code.\nEnsure systems have the latest security updates. See Understanding Patches and Software Updates.\nDisable file and printer sharing services. If these services are required, use strong passwords or Active Directory authentication.\nRestrict users' permissions to install and run unwanted software applications. Do not add users to the local administrators\u2019 group unless required.\nEnforce a strong password policy. See Choosing and Protecting Passwords.\nExercise caution when opening email attachments, even if the attachment is expected and the sender appears to be known. See Using Caution with Email Attachments.\nEnable a personal firewall on agency workstations that is configured to deny unsolicited connection requests.\nDisable unnecessary services on agency workstations and servers.\nScan for and remove suspicious email attachments; ensure the scanned attachment is its \"true file type\" (i.e., the extension matches the file header).\nMonitor users' web browsing habits; restrict access to sites with unfavorable content.\nExercise caution when using removable media (e.g., USB thumb drives, external drives, CDs).\nScan all software downloaded from the internet prior to executing.\nMaintain situational awareness of the latest threats and implement appropriate Access Control Lists (ACLs). Sign up to receive CISA\u2019s alerts on security topics and threats.\nSign up for CISA\u2019s free vulnerability scanning and testing services to help organizations secure internet-facing systems from weak configuration and known vulnerabilities. Email vulnerability_info@cisa.dhs.gov to sign up. See https://www.cisa.gov/cyber-resource-hub for more information about vulnerability scanning and other CISA cybersecurity assessment services.\n\nResources\nhttps://unit42.paloaltonetworks.com/cortex-xdr-detects-netsupport-manager-rat-campaign/\nhttps://threatpost.com/netsupport-manager-rat-nortonlifelock-docs/153387/\nhttps://www.zdnet.com/article/new-lokibot-trojan-malware-campaign-comes-disguised-as-a-popular-game-launcher/\nhttps://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/kovter-an-evolving-malware-gone-fileless\nhttps://www.varonis.com/blog/what-is-mimikatz/\n\nReferences\n\n[1] Palo Alto: Cortex XDR\u2122 Detects New Phishing Campaign Installing NetSupport Manager RAT\n[2] Zscaler: NetSupport RAT installed via fake update notices\n[3] FireEye: Fake Software Update Abuses NetSupport Remote Access Tool\n[4] Center for Internet Security: Top 10 Malware April 2020\n\nRevisions\n\nJune 30, 2020: Initial Version\n",
  "cves": [],
  "techniques": [],
  "advisory": "aa20-182a",
  "title": "EINSTEIN Data Trends \u2013 30-day Lookback | CISA",
  "source": "cybersecurity-advisories",
  "id": "406819b7e5b08471ce1f244ca356b1e8aa17735f25bc5569d64f41758ebe51cf"
}