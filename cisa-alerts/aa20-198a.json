{
  "markdown": "\n\nSummary\n\nThis Activity Alert uses the MITRE Adversarial Tactics, Techniques, and Common Knowledge (ATT&CK\u2122) and Pre-ATT&CK frameworks. See the MITRE ATT&CK for Enterprise and Pre-ATT&CK frameworks for referenced threat actor techniques.\nAttributing malicious cyber activity that uses network tunneling and spoofing techniques to a specific threat actor is difficult. Attribution requires analysis of multiple variables, including location. Because threat actors can use these techniques to obfuscate their location, it is not possible to identify the true physical location of malicious activity based solely on the geolocation of Internet Protocol (IP). This Alert discusses how threat actors use these obfuscation techniques to mislead incident responders.\n\nTechnical Details\n\nGeolocation\nThe geolocation of an IP address is often obtained with publicly available information (WHOIS registration) or proprietary information. The level of geographic precision varies widely across sources; some provide country and locality details, while others provide neighborhood-level detail. Additionally, the accuracy of this information varies by source.\nHowever, even if the geolocation of an IP address is accurate, the threat actor may not be physically located near it; instead, they may be hiding their true location through the use of spoofing and network tunnels.\nSpoofing\nA threat actor can spoof packets with an arbitrary source IP address, which in turn geolocates to a specific country (see figure 1). The actor's physical location may be elsewhere. The actor then initiates their malicious activity. Network defenders see packets originating from a source IP address that did not generate the traffic. This technique is most common with connectionless activities, such as distributed Endpoint Denial of Service [T1499] and Network Denial of Service [T1498]\u2014 including DNS amplification\u2014attacks.\n\nFigure 1: IP spoofing\nEncapsulating Network Tunnels\nA network tunnel encapsulates network traffic between two points (see figure 2). Often network tunnels are used for legitimate purposes, such as secure remote administration or creating virtual private networks (VPNs). However, a malicious cyber actor can use this technique to mask their true source IP address and, therefore, their physical location. The threat actor accomplishes masking by using virtual private servers (VPSs), which can be purchased through commercial providers. The threat actor will initiate a remote network tunnel from their computer to the VPS and then use the VPS to initiate malicious activity. Network defenders see the IP address, as well as geolocation information of the VPS. Attempts to identify the cyber actor\u2019s physical location by using the geolocation of the VPS will be inaccurate. Network tunneling is common with malicious Connection Proxy [T1090] activities.\n\nFigure 2: Network tunnel encapsulation\nThe ease with which IP addresses can be spoofed and the possibility that activity could be tunneled through a network to intentionally mask the true source prevents any attempt to identify the physical location of the activity based solely on the geolocation of the IP address.\n\nMitigations\n\nIn addition to being knowledgeable about threat actor obfuscation techniques, CISA encourages incident responders to review the following best practices to strengthen the security posture of their systems. Any configuration changes should be reviewed by system owners and administrators prior to implementation to avoid unwanted impacts.\n\nMaintain up-to-date antivirus signatures and engines. See Protecting Against Malicious Code.\nEnsure systems have the latest security updates. See Understanding Patches and Software Updates.\nDisable file and printer sharing services. If these services are required, use strong passwords or Active Directory authentication.\nRestrict users' permissions to install and run unwanted software applications. Do not add users to the local administrators\u2019 group unless required.\nEnforce a strong password policy. See Choosing and Protecting Passwords.\nExercise caution when opening email attachments, even if the attachment is expected and the sender appears to be known. See Using Caution with Email Attachments.\nEnable a personal firewall on agency workstations that is configured to deny unsolicited connection requests.\nDisable unnecessary services on agency workstations and servers.\nScan for and remove suspicious email attachments; ensure the scanned attachment is its \"true file type\" (i.e., the extension matches the file header).\nMonitor users' web browsing habits; restrict access to sites with unfavorable content.\nExercise caution when using removable media (e.g., USB thumb drives, external drives, CDs).\nScan all software downloaded from the internet prior to executing.\nMaintain situational awareness of the latest threats and implement appropriate Access Control Lists (ACLs).\n\nAdditional Information\nSign up to receive CISA\u2019s alerts on security topics and threats.\nSign up for CISA\u2019s free vulnerability scanning and testing services to help organizations secure internet-facing systems from weak configuration and known vulnerabilities. Email vulnerability_info@cisa.dhs.gov to sign up. See https://www.cisa.gov/cyber-resource-hub\u00a0 for more information about vulnerability scanning and other CISA cybersecurity assessment services.\nAcknowledgements\nPalo Alto Networks and IBM contributed to this Alert.\n\nReferences\n\nCloudflare Blog: The real cause of large DDoS - IP Spoofing\nCisco Configuration Guide: Implementing Tunnels\n\nRevisions\n\nJuly 16, 2020: Initial Version\n",
  "cves": [],
  "techniques": [
    "T1499",
    "T1498",
    "T1090"
  ],
  "advisory": "aa20-198a",
  "title": "Malicious Cyber Actor Use of Network Tunneling and Spoofing to Obfuscate Geolocation | CISA",
  "source": "cybersecurity-advisories",
  "id": "3aec2fafbf9db4887d916eb77c53329271f6f6c9786ee990d0a7f27b982d2846"
}