{"markdown": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Detecting Post\\-Compromise Threat Activity Using the CHIRP IOC Detection Tool \\| CISA\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[Skip to main content](#main) \n\n\n\n\n\n\n\n\n\n\n\n\n![U.S. flag](/profiles/cisad8_gov/themes/custom/gesso/dist/images/us_flag_small.png)\n\n\n\n An official website of the United States government\n \n\n\n\n Here\u2019s how you know\n \n\n\n\n\n\n Here\u2019s how you know\n \n\n\n\n\n\n\n![Dot gov](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-dot-gov.svg)\n\n\n**Official websites use .gov** \n  \n\n A\n **.gov** \n website belongs to an official government organization in the United States.\n \n\n\n\n\n\n![HTTPS](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-https.svg)\n\n\n**Secure .gov websites use HTTPS** \n  \n\n A\n **lock** \n (\n \n\n\n Lock\n \n\n A locked padlock\n \n\n\n\n\n ) or\n **https://** \n means you\u2019ve safely connected to the .gov website. Share sensitive information only on official, secure websites.\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools \"Free Cyber Services\") \n[\\#protect2024](/protect2024) \n[Secure Our World](/node/18883) \n[Shields Up](/node/8056) \n[Report A Cyber Issue](/node/16591) \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[![CISA Logo Americas Cyber Defense Agency](/sites/default/files/images/SVG/header_logo_tagline_update.svg)](/)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[![CISA Logo](/sites/default/files/images/SVG/mobile_logo_wordmark.svg)](/)\n\n\n\n\n\n\n\n\n\n\n Search\n \n\n\n\n\n\n\n\n\n\n Menu\n \n\n\n\n\n\n\n\n\n\n\n\n\n![America's Cyber Defense Agency](/sites/default/files/images/SVG/header_tagline_mobile_update.svg)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Close\n \n\n\n\n\n* Topics\n \n\n\n\n[Topics](/topics) \n\n\n\n\n[Cybersecurity Best Practices](/topics/cybersecurity-best-practices)\n\n\n\n\n[Cyber Threats and Advisories](/topics/cyber-threats-and-advisories)\n\n\n\n\n[Critical Infrastructure Security and Resilience](/topics/critical-infrastructure-security-and-resilience)\n\n\n\n\n[Election Security](/topics/election-security)\n\n\n\n\n[Emergency Communications](/topics/emergency-communications)\n\n\n\n\n[Industrial Control Systems](/topics/industrial-control-systems)\n\n\n\n\n[Information and Communications Technology Supply Chain Security](/topics/information-communications-technology-supply-chain-security)\n\n\n\n\n[Partnerships and Collaboration](/topics/partnerships-and-collaboration)\n\n\n\n\n[Physical Security](/topics/physical-security)\n\n\n\n\n[Risk Management](/topics/risk-management)\n\n\n\n\n\n[How can we help?](/audiences) \n\n\n[Government](/topics/government) \n[Educational Institutions](/topics/educational-institutions) \n[Industry](/topics/industry) \n[State, Local, Tribal, and Territorial](/topics/state-local-tribal-and-territorial) \n[Individuals and Families](/topics/individuals-and-families) \n[Small and Medium Businesses](/topics/small-and-medium-businesses) \n[Find Help Locally](/audiences/find-help-locally) \n[Faith\\-Based Community](/audiences/faith-based-community) \n[Executives](/audiences/executives) \n[High\\-Risk Communities](/audiences/high-risk-communities)\n* [Spotlight](/spotlight)\n* Resources \\& Tools\n \n\n\n\n[Resources \\& Tools](/resources-tools) \n\n\n\n\n[All Resources \\& Tools](/resources-tools/all-resources-tools)\n\n\n\n\n[Services](/resources-tools/services)\n\n\n\n\n[Programs](/resources-tools/programs)\n\n\n\n\n[Resources](/resources-tools/resources)\n\n\n\n\n[Training](/resources-tools/training)\n\n\n\n\n[Groups](/resources-tools/groups)\n* News \\& Events\n \n\n\n\n[News \\& Events](/news-events) \n\n\n\n\n[News](/news-events/news)\n\n\n\n\n[Events](/news-events/events)\n\n\n\n\n[Cybersecurity Alerts \\& Advisories](/news-events/cybersecurity-advisories)\n\n\n\n\n[Directives](/news-events/directives)\n\n\n\n\n[Request a CISA Speaker](/news-events/request-speaker)\n\n\n\n\n[Congressional Testimony](/news-events/congressional-testimony)\n\n\n\n\n[CISA Conferences](/cisa-conferences)\n\n\n\n\n[CISA Live!](/cisa-live)\n* Careers\n \n\n\n\n[Careers](/careers) \n\n\n\n\n[Benefits \\& Perks](/careers/benefits-perks)\n\n\n\n\n[HireVue Applicant Reasonable Accommodations Process](/careers/hirevue-applicant-reasonable-accommodations-process)\n\n\n\n\n[Hiring](/general-recruitment-and-hiring-faqs)\n\n\n\n\n[Resume \\& Application Tips](/careers/resume-application-tips)\n\n\n\n\n[Students \\& Recent Graduates](/students-recent-graduates-employment-opportunities)\n\n\n\n\n[Veteran and Military Spouses](/careers/veteran-and-military-spouse-employment-opportunities)\n\n\n\n\n[Work @ CISA](/careers/work-cisa)\n* About\n \n\n\n\n[About](/about) \n\n\n\n\n[Culture](/about/culture)\n\n\n\n\n[Divisions \\& Offices](/about/divisions-offices)\n\n\n\n\n[Regions](/about/regions)\n\n\n\n\n[Leadership](/about/leadership)\n\n\n\n\n[Doing Business with CISA](/doing-business-cisa)\n\n\n\n\n[Site Links](/site-links)\n\n\n\n\n[Reporting Employee and Contractor Misconduct](/reporting-employee-and-contractor-misconduct)\n\n\n\n\n[CISA GitHub](/cisa-github)\n\n\n\n\n[CISA Central](/cisa-central)\n\n\n\n\n[2023 Year In Review](/about/2023YIR)\n\n\n\n\n[Contact Us](/about/contact-us)\n\n\n\n\n\n\n\n\n\n[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools \"Free Cyber Services\") \n[\\#protect2024](/protect2024) \n[Secure Our World](/node/18883) \n[Shields Up](/node/8056) \n[Report A Cyber Issue](/node/16591) \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Breadcrumb\n \n1. [Home](/)\n2. [News \\& Events](/news-events)\n3. [Cybersecurity Advisories](/news-events/cybersecurity-advisories)\n4. [Cybersecurity Advisory](/news-events/cybersecurity-advisories?f%5B0%5D=advisory_type%3A94)\n\n\n\n\n\n\n\n\n Share:\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Cybersecurity Advisory\n \nDetecting Post\\-Compromise Threat Activity Using the CHIRP IOC Detection Tool\n=============================================================================\n\n\n\n\n\n Last Revised\n \n\n\n April 15, 2021\n \n\n\n\n\n Alert Code\n \n\n AA21\\-077A\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n### Summary\n\n\n\n\n***Updated April 15, 2021: The U.S. Government attributes this activity to the Russian Foreign Intelligence Service (SVR). Additional information may be found in a\n [statement from the White House](https://www.whitehouse.gov/briefing-room/statements-releases/2021/04/15/fact-sheet-imposing-costs-for-harmful-foreign-activities-by-the-russian-government/) \n . For more information on SolarWinds\\-related activity, go to\n [https://us\\-cert.cisa.gov/remediating\\-apt\\-compromised\\-networks](https://us-cert.cisa.gov/remediating-apt-compromised-networks) \n and\n [https://www.cisa.gov/supply\\-chain\\-compromise](https://www.cisa.gov/supply-chain-compromise) \n .***\n\n\n\n\n This Alert announces the CISA Hunt and Incident Response Program (CHIRP) tool. CHIRP is a forensics collection tool that CISA developed to help network defenders find indicators of compromise (IOCs) associated with activity detailed in the following CISA Alerts:\n \n\n\n* AA20\\-352A:\n [Advanced Persistent Threat Compromise of Government Agencies, Critical Infrastructure, and Private Sector Organizations](https://us-cert.cisa.gov/ncas/alerts/aa20-352a) \n , which primarily focuses on an advanced persistent threat (APT) actor\u2019s compromise of SolarWinds Orion products affecting U.S. government agencies, critical infrastructure entities, and private network organizations.\n\n\n* AA21\\-008A:\n [Detecting Post\\-Compromise Threat Activity in Microsoft Cloud Environments](https://us-cert.cisa.gov/ncas/alerts/aa21-008a) \n , which addresses APT activity within Microsoft 365/Azure environments and offers an overview of\u2014and guidance on\u2014available open\\-source tools. The Alert includes the\n [CISA\\-developed Sparrow tool](https://github.com/cisagov/Sparrow) \n that helps network defenders detect possible compromised accounts and applications in the Azure/M365 environment.\n\n\n\n Similar to\n [Sparrow](https://github.com/cisagov/Sparrow) \n \u2014which scans for signs of APT compromise within an M365 or Azure environment\u2014CHIRP scans for signs of APT compromise within an on\\-premises environment.\n \n\n\n\n In this release, CHIRP, by default, searches for IOCs associated with malicious activity detailed in AA20\\-352A and AA21\\-008A that has spilled into an on\\-premises enterprise environment.\n \n\n\n\n CHIRP is freely available on the\n [CISA GitHub Repository](https://github.com/cisagov) \n . For additional guidance watch CISA's\n [CHIRP Overview video](https://www.youtube.com/watch?v=UGYSNiNOpds) \n .\n **Note:** \n CISA will continue to release plugins and IOC packages for new threats via the CISA GitHub Repository.\n \n\n\n\n CISA advises organizations to use CHIRP to:\n \n\n\n* Examine Windows event logs for artifacts associated with this activity;\n* Examine Windows Registry for evidence of intrusion;\n* Query Windows network artifacts; and\n* Apply YARA rules to detect malware, backdoors, or implants.\n\n\n\n Network defenders should review and confirm any post\\-compromise threat activity detected by the tool. CISA has provided confidence scores for each IOC and YARA rule included with CHIRP\u2019s release. For confirmed positive hits, CISA recommends collecting a forensic image of the relevant system(s) and conducting a forensic analysis on the system(s).\n \n\n\n\n If an organization does not have the capability to follow the guidance in this Alert, consider soliciting third\\-party IT security support.\n **Note** \n : Responding to confirmed positive hits is essential to evict an adversary from a compromised network.\n \n\n\n\n[Click here](/sites/default/files/publications/AA21-077A-Detecting_Post-Compromise_Threat_Activity_Using_CHIRP_508.pdf) \n for a PDF version of this report.\n \n\n\n\n### Technical Details\n\n\n\n#### How CHIRP Works\n\n\n\n CHIRP is a command\\-line executable with a dynamic plugin and indicator system to search for signs of compromise. CHIRP has plugins to search through event logs and registry keys and run YARA rules to scan for signs of APT tactics, techniques, and procedures. CHIRP also has a YAML file that contains a list of IOCs that CISA associates with the malware and APT activity detailed in CISA Alerts\n [AA20\\-352A](https://us-cert.cisa.gov/ncas/alerts/aa20-352a) \n and\n [AA21\\-008A](https://us-cert.cisa.gov/ncas/alerts/aa21-008a) \n .\n \n\n\n\n Currently, the tool looks for:\n \n\n\n* The presence of malware identified by security researchers as\n [TEARDROP](https://us-cert.cisa.gov/ncas/analysis-reports/ar21-039b) \n and RAINDROP;\n* Credential dumping certificate pulls;\n* Certain persistence mechanisms identified as associated with this campaign;\n* System, network, and M365 enumeration; and\n* Known observable indicators of lateral movement.\n\n\n\n Network defenders can follow step\\-by\\-step instructions on the\n [CISA CHIRP GitHub repository](https://github.com/cisagov/CHIRP) \n to add additional IOCs, YARA rules, or plugins to CHIRP to search for post\\-compromise threat activity related to the SolarWinds Orion supply chain compromise or new threat activity.\n \n\n\n#### **Compatibility**\n\n\n\n CHIRP currently only scans Windows operating systems.\n \n\n\n#### **Instructions**\n\n\n\n CHIRP is available on CISA\u2019s GitHub repository in two forms:\n \n\n\n1. A compiled executable\n2. A python script\n\n\n\n CISA recommends using the compiled version to easily scan a system for APT activity. For instructions to run, read the README.md in the CHIRP GitHub repository.\n \n\n\n\n If you choose to use the native Python version, see the detailed instructions on the CHIRP GitHub repository.\n \n\n\n\n### Mitigations\n\n\n\n#### Interpreting the Results\n\n\n\n CHIRP provides results of its scan in JSON format. CISA encourages uploading the results into a security information and event management (SIEM) system, if available. If no SIEM system is available, results can be viewed in a compatible web browser or text editor. If CHIRP detects any post\\-compromise threat activity, those detections should be reviewed and confirmed. CISA has provided confidence scores for each IOC and YARA rule included with CHIRP\u2019s release. For confirmed positive hits, CISA recommends collecting a forensic image of the relevant system(s) and conducting a forensic analysis on the system(s).\n \n\n\n\n If you do not have the capability to follow the guidance in this Alert, consider soliciting third\\-party IT security support.\n **Note:** \n Responding to confirmed positive hits is essential to evict an adversary from a compromised network.\n \n\n\n#### **Frequently Asked Questions**\n\n\n1. **What systems should CHIRP run on?** \n\n Systems running SolarWinds Orion or believed to be involved in any resulting lateral movement.\n2. **What should I do with results?** \n\n Ingest the JSON results into a SIEM system, web browser, or text editor.\n3. **Are there existing tools that CHIRP complements and/or provide the same benefit as CHIRP?** \n  \n\n\t1. Antivirus software developers may have begun to roll out detections for the SolarWinds post\\-compromise activity. However, those products can miss historical signs of compromise. CHIRP can provide a complementary benefit to antivirus when run.\n\t2. CISA previously released the Sparrow tool that scans for APT activity within M365 and Azure environments related to activity detailed in CISA Alerts AA20\\-352A and AA21\\-008A. CHIRP provides a complementary capability to Sparrow by scanning for on\\-premises systems for similar activity.\n4. **How often should I run CHIRP?** \n\n CHIRP can be run once or routinely. Currently, CHIRP does not provide a mechanism to run repeatedly in its native format.\n5. **Do I need to configure the tool before I run it?** \n\n No.\n6. **Will CHIRP change or affect anything on the system(s) it runs on?** \n\n No, CHIRP only scans the system(s) it runs on and makes no active changes.\n7. **How long will it take to run CHIRP?** \n\n CHIRP will complete its scan in approximately 1 to 2 hours. Duration will be dependent on the level of activity, the system, and the size of the resident data sets. CHIRP will provide periodic progress updates as it runs.\n8. **If I have questions, who do I contact?** \n\n For general questions regarding CHIRP, please contact CISA via email at\n [central@cisa.dhs.gov](mailto:central@cisa.dhs.gov) \n or by phone at 1\\-888\\-282\\-0870\\. For reporting indicators of potential compromise, contact us by submitting a report through our website at\n [https://us\\-cert.cisa.gov/report](https://us-cert.cisa.gov/report) \n . For all technical issues or support for CHIRP, please submit issues at the\n [CISA CHIRP GitHub Repository](https://github.com/cisagov/CHIRP) \n .\n\n\n\n### Revisions\n\n\n\n\n March 18, 2021: Initial Publication \\|April 9, 2021: Fixed PDF (not related to content)\\|April 15, 2021: Updated with Attribution Statement\n \n\n\n\n\n\n\n\n\n\n\n This product is provided subject to this\n [Notification](/notification \"Follow link\") \n and this\n [Privacy \\& Use](/privacy-policy \"Follow link\") \n policy.\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPlease share your thoughts\n--------------------------\n\n\n\n We recently updated our anonymous\n [product survey](https://www.surveymonkey.com/r/CISA-cyber-survey?product=https://www.cisa.gov/news-events/cybersecurity-advisories/aa21-077a) \n ; we\u2019d welcome your feedback.\n \n\n\n\n\n\n\n\n\n\n\n\n\nRelated Advisories\n------------------\n\n\n\n\n\n\n\n\n\n\n Jul 11, 2024\n \n\n\n Cybersecurity Advisory \\| AA24\\-193A\n \n\n### [CISA Red Team\u2019s Operations Against a Federal Civilian Executive Branch Organization Highlights the Necessity of Defense\\-in\\-Depth](/news-events/cybersecurity-advisories/aa24-193a)\n\n\n\n\n\n\n\n\n\n\n\n Jul 08, 2024\n \n\n\n Cybersecurity Advisory \\| AA24\\-190A\n \n\n### [People\u2019s Republic of China (PRC) Ministry of State Security APT40 Tradecraft in Action](/news-events/cybersecurity-advisories/aa24-190a)\n\n\n\n\n\n\n\n\n\n\n\n May 10, 2024\n \n\n\n Cybersecurity Advisory \\| AA24\\-131A\n \n\n### [\\#StopRansomware: Black Basta](/news-events/cybersecurity-advisories/aa24-131a)\n\n\n\n\n\n\n\n\n\n\n\n Apr 18, 2024\n \n\n\n Cybersecurity Advisory \\| AA24\\-109A\n \n\n### [\\#StopRansomware: Akira Ransomware](/news-events/cybersecurity-advisories/aa24-109a)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[Return to top](#) \n\n\n\n\n* [Topics](/topics)\n* [Spotlight](/spotlight)\n* [Resources \\& Tools](/resources-tools)\n* [News \\& Events](/news-events)\n* [Careers](/careers)\n* [About](/about)\n\n\n\n\n\n\n\n\n[Cybersecurity \\& Infrastructure Security Agency](/ \"Go to the Cybersecurity & Infrastructure Security Agency homepage\")\n\n\n* [Facebook](https://www.facebook.com/CISA)\n* [Twitter](https://twitter.com/CISAgov)\n* [LinkedIn](https://www.linkedin.com/company/cybersecurity-and-infrastructure-security-agency)\n* [YouTube](https://www.youtube.com/@cisagov)\n* [Instagram](https://www.instagram.com/cisagov)\n* [RSS](/subscribe-updates-cisa)\n\n\n\n\n CISA Central\n \n[1\\-844\\-Say\\-CISA](tel:1-844-Say-CISA) \n[SayCISA@cisa.gov](mailto:SayCISA@cisa.gov) \n\n\n\n\n\n\n\n\n\n\n\n DHS Seal\n \n\n\n CISA.gov\n \n\n An official website of the U.S. Department of Homeland Security\n \n\n\n* [About CISA](/about \"About CISA\")\n* [Budget and Performance](https://www.dhs.gov/performance-financial-reports \"Budget and Performance\")\n* [DHS.gov](https://www.dhs.gov \"Department of Homeland Security\")\n* [Equal Opportunity \\& Accessibility](/oedia \"Equal Opportunity & Accessibility\")\n* [FOIA Requests](https://www.dhs.gov/foia \"FOIA Requests\")\n* [No FEAR Act](/no-fear-act \"No FEAR Act Reporting\")\n* [Office of Inspector General](https://www.oig.dhs.gov/ \"Office of Inspector General\")\n* [Privacy Policy](/privacy-policy \"Privacy Policy\")\n* [Subscribe](https://public.govdelivery.com/accounts/USDHSCISA/subscriber/new?topic_id=USDHSCISA_138 \"Subscribe to Email Updates\")\n* [The White House](https://www.whitehouse.gov/ \"The White House\")\n* [USA.gov](https://www.usa.gov/ \"USA.gov\")\n* [Website Feedback](/forms/feedback \"Website Feedback\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n", "cves": [], "techniques": [], "advisory": "aa21-077a", "title": "Detecting Post-Compromise Threat Activity Using the CHIRP IOC Detection Tool | CISA", "source": "cybersecurity-advisories", "id": "401158ebeee028cd8a470ff8c707678bca11a4a69f3fdcdb3f1a360bf208b903"}