{
  "markdown": "\n1. EXECUTIVE SUMMARY\n\nCVSS v3 9.8\nATTENTION: Exploitable remotely/low attack complexity\nVendor: HCC Embedded\nEquipment: InterNiche stack (NicheStack), NicheLite\nVulnerabilities: Return of Pointer Value Outside of Expected Range, Improper Handling of Length Parameter Inconsistency, Use of Insufficiently Random Values, Improper Input Validation, Uncaught Exception, Numeric Range Comparison Without Minimum Check, Generation of Predictable Numbers or Identifiers, Improper Check or Handling of Exceptional Conditions, Improper Null Termination\n\nCISA is aware of a public report, known as \u201cINFRA:HALT\u201d that details vulnerabilities found in the HCC Embedded InterNiche TCP/IP stack, previously known as InterNiche NicheStack. CISA is issuing this advisory to provide early notice of the reported vulnerabilities and identify baseline mitigations for reducing risks to these and other cybersecurity attacks.\n2. UPDATE INFORMATION\nThis updated advisory is a follow-up to the advisory update titled ICSA-21-217-01 HCC Embedded InterNiche TCP/IP stack NicheLite (Update A) that was published September 14, 2021, to the ICS webpage at www.cisa.gov/uscert.\n3. RISK EVALUATION\nSuccessful exploitation of these vulnerabilities may result in unauthorized access to arbitrary information, DNS cache poisoning, remote code execution, or a denial-of-service condition.\n4. TECHNICAL DETAILS\n4.1 AFFECTED PRODUCTS\nThe following embedded component TCP/IP stacks are affected:\n\nInterNiche stack: All versions prior to v4.3\nNicheLite: All versions prior to v4.3\n\n4.2 VULNERABILITY OVERVIEW\n4.2.1\u00a0\u00a0 \u00a0RETURN OF POINTER VALUE OUTSIDE OF EXPECTED RANGE CWE-466\nWhen parsing DNS domain names, there are no checks on whether a domain name compression pointer is pointing within the bounds of the packet, which may result in an out-of-bounds read.\nCVE-2020-25767 has been assigned to this vulnerability. A CVSS v3 base score of 7.5 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H).\n4.2.2\u00a0\u00a0 \u00a0IMPROPER HANDLING OF LENGTH PARAMETER INCONSISTENCY CWE-130\nThe routine for parsing DNS response packets does not check the \u201cresponse data length\u201d field of individual DNS answers, which may cause an out-of-bounds read/write.\nCVE-2020-25928 has been assigned to this vulnerability. A CVSS v3 base score of 9.8 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).\n4.2.3\u00a0\u00a0 \u00a0IMPROPER HANDLING OF LENGTH PARAMETER INCONSISTENCY CWE-130\nThe number of queries or responses specified in the DNS packet header is not validated with the query/response data available in the DNS packet, leading to an out-of-bounds read.\nCVE-2020-25927 has been assigned to this vulnerability. A CVSS v3 base score of 8.2 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H).\n4.2.4\u00a0\u00a0 \u00a0USE OF INSUFFICIENTLY RANDOM VALUES CWE-330\nThe DNS client does not sufficiently randomize transaction IDs, facilitating DNS cache poisoning attacks.\nCVE-2020-25926 has been assigned to this vulnerability. A CVSS v3 base score of 4.0 has been calculated; the CVSS vector string is (AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:L/A:N).\n4.2.5\u00a0\u00a0 \u00a0IMPROPER INPUT VALIDATION CWE-20\nThe code that parses ICMP packets relies on an unchecked value of the IP payload size to compute the ICMP checksum, which may result in an out-of-bounds read.\nCVE-2020-35683 has been assigned to this vulnerability. A CVSS v3 base score of 7.5 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H).\n4.2.6\u00a0\u00a0 \u00a0IMPROPER INPUT VALIDATION CWE-20\nThe code that parses TCP packets relies on an unchecked value of the IP payload size to compute the length of the TCP payload within the TCP checksum computation function, which may result in an out-of-bounds read.\nCVE-2020-35684 has been assigned to this vulnerability. A CVSS v3 base score of 7.5 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H).\n4.2.7\u00a0\u00a0 \u00a0USE OF INSUFFICIENTLY RANDOM VALUES CWE-330\nTCP ISNs are insufficiently randomized, which may result in TCP spoofing by an attacker.\nCVE-2020-35685 has been assigned to this vulnerability. A CVSS v3 base score of 7.5 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N).\n4.2.8\u00a0\u00a0 \u00a0UNCAUGHT EXCEPTION CWE-248\nThe TCP urgent data processing function may invoke a panic function, which may result in an infinite loop.\nCVE-2021-31400 has been assigned to this vulnerability. A CVSS v3 base score of 7.5 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N).\n4.2.9\u00a0\u00a0 \u00a0IMPROPER INPUT VALIDATION CWE-20\nAn attacker could send a specially crafted IP packet to trigger an integer overflow due to the lack of IP length validation.\nCVE-2021-31401 has been assigned to this vulnerability. A CVSS v3 base score of 7.5 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N).\n4.2.10\u00a0\u00a0 \u00a0IMPROPER INPUT VALIDATION CWE-20\nA potential heap buffer overflow exists in the code that parses the HTTP POST request due to lack of size validation.\nCVE-2021-31226 has been assigned to this vulnerability. A CVSS v3 base score of 9.1 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H).\n4.2.11\u00a0\u00a0 \u00a0NUMERIC RANGE COMPARISON WITHOUT MINIMUM CHECK CWE-839\nA potential heap buffer overflow exists in the code that parses the HTTP POST request due to an incorrect signed integer comparison.\nCVE-2021-31227 has been assigned to this vulnerability. A CVSS v3 base score of 7.5 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N).\n4.2.12\u00a0\u00a0 \u00a0GENERATION OF PREDICTABLE NUMBERS OR IDENTIFIERS CWE-340\nAn attacker may be able to predict DNS queries\u2019 source port to then send forged DNS response packets, which may be accepted as valid answers.\nCVE-2021-31228 has been assigned to this vulnerability. A CVSS v3 base score of 4.0 has been calculated; the CVSS vector string is (AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:L/A:N).\n4.2.13\u00a0\u00a0 \u00a0IMPROPER CHECK OR HANDLING OF EXCEPTIONAL CONDITIONS CWE-703\nUnhandled HTTP requests result in an infinite loop that disrupts TCP/IP communication.\nCVE-2021-27565 has been assigned to this vulnerability. A CVSS v3 base score of 7.5 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N).\n4.2.14\u00a0\u00a0 \u00a0IMPROPER NULL TERMINATION CWE-170\nThe TFTP packet processing function does not ensure that the filename is null-terminated, which may result in a denial-of-service condition.\nCVE-2021-36762 has been assigned to this vulnerability. A CVSS v3 base score of 7.5 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N).\n4.3 BACKGROUND\n\nCRITICAL INFRASTRUCTURE SECTORS: Multiple\nCOUNTRIES/AREAS DEPLOYED: Worldwide\nCOMPANY HEADQUARTERS LOCATION: Hungary\n\n4.4 RESEARCHER\nAmine Amri, Stanislav Dashevskyi, and Daniel dos Santos from Forescout, and Asaf Karas and Shachar Menashe from VDOO reported these vulnerabilities to CISA.\n5. MITIGATIONS\nHCC recommends users apply release v4.3 or later to mitigate these vulnerabilities. For more information, contact HCC.\nAdditional vendors affected by the reported vulnerabilities have also released security advisories related to their affected products. Those advisories are as follows:\n\nSiemens\n\n--------- Begin Update B Part 1 of 1 ---------\n\nMitsubishi Electric MELSEC Series Remote I/O\n\n--------- End Update B Part 1 of 1 ---------\nCISA recommends users take defensive measures to minimize the risk of exploitation of these vulnerabilities. Specifically, users should:\n\nMinimize network exposure for all control system devices and/or systems, and ensure that they are not accessible from the Internet.\nLocate control system networks and remote devices behind firewalls, and isolate them from the business network.\nWhen remote access is required, use secure methods, such as Virtual Private Networks (VPNs), recognizing VPNs may have vulnerabilities and should be updated to the most current version available. Also recognize VPN is only as secure as its connected devices.\n\nCISA reminds organizations to perform proper impact analysis and risk assessment prior to deploying defensive measures.\n\nCISA also provides a section for control systems security recommended practices on the ICS webpage on cisa.gov. Several recommended practices are available for reading and download, including Improving Industrial Control Systems Cybersecurity with Defense-in-Depth Strategies.\nOrganizations observing any suspected malicious activity should follow their established internal procedures and report their findings to CISA for tracking and correlation against other incidents.\nNo known public exploits specifically target these vulnerabilities.\n",
  "cves": [
    "CVE-2021-31227",
    "CVE-2020-35684",
    "CVE-2021-31401",
    "CVE-2020-25767",
    "CVE-2020-25926",
    "CVE-2020-25928",
    "CVE-2020-35683",
    "CVE-2021-31228",
    "CVE-2021-36762",
    "CVE-2021-27565",
    "CVE-2020-25927",
    "CVE-2021-31226",
    "CVE-2021-31400",
    "CVE-2020-35685"
  ],
  "techniques": [],
  "advisory": "icsa-21-217-01",
  "title": "HCC Embedded InterNiche TCP/IP stack, NicheLite (Update B) | CISA",
  "source": "ics-advisories",
  "id": "4007bab89d5ff5969919d3fbbb59a5be00f87e796436ec7573bfda1cb002d804"
}