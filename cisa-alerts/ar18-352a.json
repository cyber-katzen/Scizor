{"markdown": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Quasar Open\\-Source Remote Administration Tool \\| CISA\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[Skip to main content](#main) \n\n\n\n\n\n\n\n\n\n\n\n\n![U.S. flag](/profiles/cisad8_gov/themes/custom/gesso/dist/images/us_flag_small.png)\n\n\n\n An official website of the United States government\n \n\n\n\n Here\u2019s how you know\n \n\n\n\n\n\n Here\u2019s how you know\n \n\n\n\n\n\n\n![Dot gov](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-dot-gov.svg)\n\n\n**Official websites use .gov** \n  \n\n A\n **.gov** \n website belongs to an official government organization in the United States.\n \n\n\n\n\n\n![HTTPS](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-https.svg)\n\n\n**Secure .gov websites use HTTPS** \n  \n\n A\n **lock** \n (\n \n\n\n Lock\n \n\n A locked padlock\n \n\n\n\n\n ) or\n **https://** \n means you\u2019ve safely connected to the .gov website. Share sensitive information only on official, secure websites.\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools \"Free Cyber Services\") \n[\\#protect2024](/protect2024) \n[Secure Our World](/node/18883) \n[Shields Up](/node/8056) \n[Report A Cyber Issue](/node/16591) \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[![CISA Logo Americas Cyber Defense Agency](/sites/default/files/images/SVG/header_logo_tagline_update.svg)](/)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[![CISA Logo](/sites/default/files/images/SVG/mobile_logo_wordmark.svg)](/)\n\n\n\n\n\n\n\n\n\n\n Search\n \n\n\n\n\n\n\n\n\n\n Menu\n \n\n\n\n\n\n\n\n\n\n\n\n\n![America's Cyber Defense Agency](/sites/default/files/images/SVG/header_tagline_mobile_update.svg)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Close\n \n\n\n\n\n* Topics\n \n\n\n\n[Topics](/topics) \n\n\n\n\n[Cybersecurity Best Practices](/topics/cybersecurity-best-practices)\n\n\n\n\n[Cyber Threats and Advisories](/topics/cyber-threats-and-advisories)\n\n\n\n\n[Critical Infrastructure Security and Resilience](/topics/critical-infrastructure-security-and-resilience)\n\n\n\n\n[Election Security](/topics/election-security)\n\n\n\n\n[Emergency Communications](/topics/emergency-communications)\n\n\n\n\n[Industrial Control Systems](/topics/industrial-control-systems)\n\n\n\n\n[Information and Communications Technology Supply Chain Security](/topics/information-communications-technology-supply-chain-security)\n\n\n\n\n[Partnerships and Collaboration](/topics/partnerships-and-collaboration)\n\n\n\n\n[Physical Security](/topics/physical-security)\n\n\n\n\n[Risk Management](/topics/risk-management)\n\n\n\n\n\n[How can we help?](/audiences) \n\n\n[Government](/topics/government) \n[Educational Institutions](/topics/educational-institutions) \n[Industry](/topics/industry) \n[State, Local, Tribal, and Territorial](/topics/state-local-tribal-and-territorial) \n[Individuals and Families](/topics/individuals-and-families) \n[Small and Medium Businesses](/topics/small-and-medium-businesses) \n[Find Help Locally](/audiences/find-help-locally) \n[Faith\\-Based Community](/audiences/faith-based-community) \n[Executives](/audiences/executives) \n[High\\-Risk Communities](/audiences/high-risk-communities)\n* [Spotlight](/spotlight)\n* Resources \\& Tools\n \n\n\n\n[Resources \\& Tools](/resources-tools) \n\n\n\n\n[All Resources \\& Tools](/resources-tools/all-resources-tools)\n\n\n\n\n[Services](/resources-tools/services)\n\n\n\n\n[Programs](/resources-tools/programs)\n\n\n\n\n[Resources](/resources-tools/resources)\n\n\n\n\n[Training](/resources-tools/training)\n\n\n\n\n[Groups](/resources-tools/groups)\n* News \\& Events\n \n\n\n\n[News \\& Events](/news-events) \n\n\n\n\n[News](/news-events/news)\n\n\n\n\n[Events](/news-events/events)\n\n\n\n\n[Cybersecurity Alerts \\& Advisories](/news-events/cybersecurity-advisories)\n\n\n\n\n[Directives](/news-events/directives)\n\n\n\n\n[Request a CISA Speaker](/news-events/request-speaker)\n\n\n\n\n[Congressional Testimony](/news-events/congressional-testimony)\n\n\n\n\n[CISA Conferences](/cisa-conferences)\n\n\n\n\n[CISA Live!](/cisa-live)\n* Careers\n \n\n\n\n[Careers](/careers) \n\n\n\n\n[Benefits \\& Perks](/careers/benefits-perks)\n\n\n\n\n[HireVue Applicant Reasonable Accommodations Process](/careers/hirevue-applicant-reasonable-accommodations-process)\n\n\n\n\n[Hiring](/general-recruitment-and-hiring-faqs)\n\n\n\n\n[Resume \\& Application Tips](/careers/resume-application-tips)\n\n\n\n\n[Students \\& Recent Graduates](/students-recent-graduates-employment-opportunities)\n\n\n\n\n[Veteran and Military Spouses](/careers/veteran-and-military-spouse-employment-opportunities)\n\n\n\n\n[Work @ CISA](/careers/work-cisa)\n* About\n \n\n\n\n[About](/about) \n\n\n\n\n[Culture](/about/culture)\n\n\n\n\n[Divisions \\& Offices](/about/divisions-offices)\n\n\n\n\n[Regions](/about/regions)\n\n\n\n\n[Leadership](/about/leadership)\n\n\n\n\n[Doing Business with CISA](/doing-business-cisa)\n\n\n\n\n[Site Links](/site-links)\n\n\n\n\n[Reporting Employee and Contractor Misconduct](/reporting-employee-and-contractor-misconduct)\n\n\n\n\n[CISA GitHub](/cisa-github)\n\n\n\n\n[CISA Central](/cisa-central)\n\n\n\n\n[2023 Year In Review](/about/2023YIR)\n\n\n\n\n[Contact Us](/about/contact-us)\n\n\n\n\n\n\n\n\n\n[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools \"Free Cyber Services\") \n[\\#protect2024](/protect2024) \n[Secure Our World](/node/18883) \n[Shields Up](/node/8056) \n[Report A Cyber Issue](/node/16591) \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Breadcrumb\n \n1. [Home](/)\n2. [News \\& Events](/news-events)\n3. [Cybersecurity Advisories](/news-events/cybersecurity-advisories)\n4. [Analysis Report](/news-events/cybersecurity-advisories?f%5B0%5D=advisory_type%3A65)\n\n\n\n\n\n\n\n\n Share:\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Analysis Report\n \nQuasar Open\\-Source Remote Administration Tool\n==============================================\n\n\n\n\n\n Last Revised\n \n\n\n February 14, 2019\n \n\n\n\n\n Alert Code\n \n\n AR18\\-352A\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Quasar is a publically available, open\\-source RAT for Microsoft Windows operating systems (OSs) written in the C\\# programming language. Quasar is authored by GitHub user MaxXor and publicly hosted as a GitHub repository. While the tool can be used for legitimate purposes (e.g., an organization\u2019s helpdesk technician remotely accessing an employee\u2019s laptop), the Cybersecurity and Infrastructure Security Agency (CISA), is aware of APT actors using Quasar for cybercrime and cyber espionage campaigns.\n \n\n\n\n Quasar was first released in July 2014 as \u201cxRAT 2\\.0\\.\u201d In August 2015, xRAT was renamed \u201cQuasar\u201d and released as v1\\.0\\.0\\.0\\. For this report, the National Cybersecurity and Communications Integration Center (NCCIC), part of CISA, analyzed Quasar version 1\\.3\\.0\\.0, which was released on September 28, 2016, and is the latest stable version available on GitHub. This report does not reflect any changes Quasar\u2019s author has made to the tool\u2019s source code since the release of v1\\.3\\.0\\.0\\.\n \n\n\n\n Open\\-source reports state that some APT actors have adapted Quasar and created modified minor (1\\.3\\.4\\.0\\) and major (2\\.0\\.0\\.0 and 2\\.0\\.0\\.1\\) versions.\n [\\[1]](https://www.fireeye.com/blog/threat-research/2017/04/apt10_menupass_grou.html) \n ,\n [\\[2]](https://unit42.paloaltonetworks.com/unit42-downeks-and-quasar-rat-used-in-recent-targeted-attacks-against-governments/) \n NCCIC has not determined the exact difference between these versions and v1\\.3\\.0\\.0\\. Therefore, NCCIC cannot definitively say whether the detection and mitigation recommendations provided in this report will work effectively against APT actor\\-modified versions of Quasar.\n \n\n\n#### High Level Architecture\n\n\n\n Quasar uses a client\\-server architecture that enables one user to remotely access many clients. The server is responsible for creating client binaries and managing client connections. Users then interact with connected clients through the server\u2019s graphical user interface (GUI).\n \n\n\n\n Note: Quasar does not contain software vulnerability exploits. Threat actors must leverage other tools or methods to gain access to a target host before they can use Quasar.\n \n\n\n#### Requirements\n\n\n\n Quasar requires a Microsoft .NET Framework 4\\.0 (or higher) Client Profile. The Quasar client and server will run on the following OSs (32\\- and 64\\-bit):\n \n\n\n* Windows XP Service Pack 3,\n* Windows Server 2003,\n* Windows Vista,\n* Windows Server 2008,\n* Windows 7,\n* Windows Server 2012,\n* Windows 8/8\\.1, and\n* Windows 10\\.\n\n\n#### Quasar Server\n\n\n\n The Quasar server component is responsible for\n \n\n\n* Listening for and handling client connections (e.g., catching new connections, terminating connections);\n* Managing connected clients (e.g., retrieving files, showing the screen, killing processes); and\n* Configuring and building client executables.\n\n\n\n Figure 1 shows the Quasar server component GUI. Quasar users interact with the server and, in turn, its clients, through the GUI. Each client\u2019s entry is listed individually and includes the client\u2019s Internet Protocol (IP) address, username, Quasar client version, connection status, user status, country, OS, and account type. The Quasar user initiates client interactions by right\\-clicking an individual client row, which opens a pop\\-up menu with available commands.\n \n\n\n\n![]()\n\n\n\n\n**Figure 1: Quasar screenshot \u2013 example of a Quasar server with a connected client** \n\n\n\n\n The server component builds client executables that the Quasar user can run on target hosts. The client builder feature allows the Quasar user to select from different options and attributes (see table 1\\).\n \n\n\n\n****Table 1: Quasar client builder feature options and attributes****\n\n\n\n\n\n| **Option** | **Default Option** | **Description** |\n| --- | --- | --- |\n| **Basic Settings** | | |\n| Client tag | None | Represents the name for the client instance. This value is displayed in the connection table (see figure 1\\) of the Quasar server GUI once the client connects |\n| Mutex | QSR\\_MUTEX\\_\\[18 character alphanumeric upper and lowercase string] | Sets the file mutual exclusion object (mutex) to prevent the same host being infected multiple times |\n| **Connection Settings** | | |\n| Callback IP | None | Sets the server IP for the client connection |\n| Callback domain | None | Sets the domain for the client connection |\n| Callback port | 4782 | Sets the Transmission Control Protocol (TCP) port callback to \u201con\u201d |\n| Password | 1234 | Sets the password for Advanced Encryption Standard (AES) encryption |\n| Connection retry | 300ms | Sets how often the client will attempt to callback if they are not connected |\n| **Installation Settings** | | |\n| Install client | Off | Sets the default for whether or not the client will install on a host |\n| Base installation paths | * `%AppData%` * Program Files\\* * `Windows\\SysWOW64`   \\* | The location where the client file will be installed on a host. This field is limited to the options listed. Starred items (\\*) require administrator privileges |\n| Install subdirectory | SubDir | Makes a customizable subdirectory within the base installation path |\n| Install name | Client | The name of the client file. This file must be  `.exe` |\n| Run client when the computer starts | Off | A checkbox that, if checked, will add the Quasar client as an AutoRun via Registry Key or Scheduled Task |\n| Startup name | Quasar Client Startup | Customizable free text field |\n\n\n\n The Quasar user can also set metadata to be embedded in the executable, such as the author, organization, copyright, year, and version.\n \n\n\n#### Quasar Client\n\n\n\n Quasar client instances are built by the server component. Based on multiple client builds, each with different configurations, the client size is consistently 349KB. Once it is distributed to a target host, the client needs to be executed before it can call back to the server. Client execution is invisible to the target host user and does not generate any visible windows or notifications on the target host, except in cases where the client becomes unresponsive. Once running on a target host, the client \u00a0process is visible to the target host user via Windows Task Manager or a similar process management program.\n \n\n\n#### Network Traffic\n\n\n\n Quasar encrypts communications using the AES algorithm. The client builder hardcodes a Quasar user\\-chosen, pre\\-shared key to be used in command and control (C2\\) communications. The server must be configured to listen on the callback port and use the pre\\-shared key. (Quasar\u2019s author has stated \\[via GitHub] that they would like to update Quasar to use Transport Layer Security for C2 encryption in the future.)\n \n\n\n\n After the TCP handshake is completed, all traffic between the server and client is encrypted. The entropy of AES ciphertext makes it impossible to write a pattern to detect this content. Quasar uses the first 4 bytes of the TCP payload to track the payload\u2019s total size in little\\-endian format. This size\\-tracking pattern is distinctive to Quasar network traffic. As shown in figure 2, the first 4 bytes of the TCP payload contain 0x40000000 or 64 decimal in hexadecimal notation. Subtracting the tracking bytes (4 bytes) from the total TCP payload (68 bytes) results in an actual payload size of 64 bytes.\n \n\n\n\n![]()\n\n\n\n\n**Figure 2:\u00a0Quasar screenshot\u00a0\u2013 C2 traffic** \n\n\n\n\n The distinctive first 4 bytes of the payload can be used to identify Quasar traffic. Specifically, the first 4 bytes can identify the first packet sent from the server to the client following the TCP handshake. This packet is used to initiate the server/client authentication process. See table 2 for a description of the attributes of the first packet from the server to the client following the TCP handshake. This information can be used to identify potential Quasar activity on a network.\n \n\n\n\n**Table 2: Quasar packet attributes** \n\n\n\n\n\n| **Type** | **Attribute** |\n| --- | --- |\n| TCP Flag | `PSH`   and  `ACK` |\n| Total Size | 122 bytes |\n| TCP payload size | 68 bytes |\n| First 4 bytes of payload | 0x40000000 |\n\n\n#### **Client Network Traffic**\n\n\n\n Quasar allows the user to gather host system information. As part of the client connection setup, the client attempts to discover its geolocation\u2014including its Wide Area Network (WAN) IP address\u2014by sending an\n `HTTP GET` \n request to the Uniform Resource Locator (URL)\n `ip-api[.]com/json/` \n with User\\-Agent string:\n \n\n\n\n`Mozilla/5.0 (Windows NT 6.3; rv:48.0) Gecko/20100101 Firefox/48.0` \n .\n \n\n\n\n This User\\-Agent string mimics a Mozilla Firefox 48 browser running on Windows 8\\.1\\. This User\\-Agent string would likely stand out as unique in a corporate network environment, and its presence could be a high\\-confidence indication of Quasar activity.\n \n\n\n\n If the client does not receive a response from this lookup, the client attempts to retrieve WAN IP information from\n `freegeoip[.]net` \n and\n `api[.]ipify[.]org` \n , respectively. The User\\-Agent string remains consistent across all attempts.\n \n\n\n\n Quasar users can also direct the client to access websites. These requests can be set as visible to the host user via a browser window that opens or invisible to the host user via the C\\# WebRequest class. Requests that are visible to the host user use the User Agent string from the Quasar user\u2019s browser. Requests that are marked as invisible to the host user are sent with User\\-Agent string:\n \n\n\n\n`Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_3) AppleWebKit/537.75.14 (KHTML, like Gecko) Version/7.0.3 Safari/7046A194A` \n .\n \n\n\n\n This User\\-Agent string mimics an Apple Safari 7\\.0\\.3 browser running on Mac OS X 10\\.9\\.3\\. The use of Mac OS X as the operating system is interesting because Quasar can only be run on Windows. NCCIC has leveraged Quasar\u2019s use of Mac OS X to limit false positives in the Snort signatures for this activity.\n \n\n\n\n The User\\-Agent strings listed in this section are set by the server component when the client file is built. The strings can only be changed by altering the User\\-Agent string in the server source code. All clients built with a server component compiled from unaltered Quasar v1\\.3\\.0\\.0 source code contain these User\\-Agents.\n \n\n\n#### **Client Installation**\n\n\n\n Quasar\u2019s client builder limits the base directories in which the client may be placed. The three base directories in which the Quasar client builder can place itself are\n \n\n\n* Program Files (requires administrator privileges),\n* `Windows\\SysWOW64` \n (requires administrator privileges), and\n* %APPDATA%.\n\n\n\n![]()\n\n\n\n\n**Figure 3:\u00a0Quasar sceenshot \u2013\u00a0client installation settings** \n\n\n\n\n Quasar users can specify which subdirectory within the base directory to place the client executable (as shown in figure 3\\). Quasar users can also specify the name of the executable. Both the client executable and the subdirectory can be hidden from the target host user during installation by a Windows application programming interface call that sets one of the file\u2019s attributes to \u201chidden.\u201d The \u201chidden\u201d setting only hides files from the target host user\u2019s view in Windows File Explorer.\n \n\n\n#### **Persistence**\n\n\n\n Quasar achieves persistence by executing on startup, as seen in the source code shown in figure 4\\. To achieve persistence, Quasar uses two methods: scheduled tasks and registry keys. If the client process has administrator privileges, the client will generate a scheduled task via\n `schtasks` \n . The scheduled task is generated using the task name created in the client builder. The schedule task runs after the host user logs on, executes with the highest run level (i.e., the highest level of privilege), and suppresses any errors related to creating the task. If the process does not have administrator privileges, the scheduled task will only add a registry value. That registry value is added to the following key:\n \n\n\n\n`HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run` \n .\n \n\n\n\n The value name is then configured in the client builder, and the client adds its current path as the startup program.\n \n\n\n\n\n if (WindowsAccountHelper.GetAccountType() \\=\\= \"Admin\")\n \n\n\n\n {\n \n\n\n\n try\n \n\n\n\n {\n \n\n\n\n ProcessStartInfo startInfo \\= new ProcessStartInfo(\"schtasks\")\n \n\n\n\n {\n \n\n\n\n Arguments \\= \"/create /tn \\\\\"\" \\+ Settings.STARTUPKEY \\+ \"\\\\\" /sc ONLOGON /tr \\\\\"\" \\+ ClientData.CurrentPath \\+ \"\\\\\" /rl HIGHEST /f\",\n \n\n\n\n UseShellExecute \\= false,\n \n\n\n\n CreateNoWindow \\= true\n \n\n\n\n };\n \n\n\n\n\n\n\n\n Process p \\= Process.Start(startInfo);\n \n\n\n\n p.WaitForExit(1000\\);\n \n\n\n\n if (p.ExitCode \\=\\= 0\\) return true;\n \n\n\n\n }\n \n\n\n\n catch (Exception)\n \n\n\n\n {\n \n\n\n\n }\n \n\n\n\n\n\n\n\n return RegistryKeyHelper.AddRegistryKeyValue(RegistryHive.CurrentUser,\n \n\n\n\n \"Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Run\", Settings.STARTUPKEY, ClientData.CurrentPath,\n \n\n\n\n true);\n \n\n\n\n }\n \n\n\n\n else\n \n\n\n\n {\n \n\n\n\n return RegistryKeyHelper.AddRegistryKeyValue(RegistryHive.CurrentUser,\n \n\n\n\n \"Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Run\", Settings.STARTUPKEY, ClientData.CurrentPath,\n \n\n\n\n true);\n \n\n\n\n\n**Figure 4: Source code from\n `Quasar/Client/Core/Installation/Startup.cs`**\n\n\n\n#### ****Privilege Escalation****\n\n\n\n Quasar allows the tool user to escalate the client\u2019s running privileges, as seen in the source code shown in figure 5\\. To escalate the client\u2019s running privileges, Quasar attempts to launch a command prompt (\n `cmd.exe` \n ) as an administrator. The elevated command prompt then relaunches the client. The client inherits the parent process\u2019 now\\-elevated privileges. If the Window\u2019s User Account Control (UAC) is configured, this method generates a UAC pop\\-up window on the target host, which asks the target host user to confirm the process of running the command prompt as the administrator.\n \n\n\n\n\n if (WindowsAccountHelper.GetAccountType() !\\= \"Admin\")\n \n\n\n\n {\n \n\n\n\n ProcessStartInfo processStartInfo \\= new ProcessStartInfo\n \n\n\n\n {\n \n\n\n\n FileName \\= \"cmd\",\n \n\n\n\n Verb \\= \"runas\",\n \n\n\n\n Arguments \\= \"/k START \\\\\"\\\\\" \\\\\"\" \\+ ClientData.CurrentPath \\+ \"\\\\\" \\& EXIT\",\n \n\n\n\n WindowStyle \\= ProcessWindowStyle.Hidden,\n \n\n\n\n UseShellExecute \\= true\n \n\n\n\n };\n \n\n\n\n\n****Figure 5: Source code from\n `Quasar/Client/Core/Commands/SystemHandler.cs`****\n\n\n\n\n### Summary\n\n\n\n\n Quasar, a legitimate open\\-source remote administration tool (RAT), has been observed being used maliciously by Advanced Persistent Threat (APT) actors to facilitate network exploitation.\n \n\n\n\n This Analysis Report provides information on Quasar\u2019s functions and features, along with recommendations for preventing and mitigating Quasar activity.\n \n\n\n\n### Solution\n\n\n\n\n Network defenders can detect Quasar activity by monitoring network traffic for its unique pattern, the registry key it edits for persistence, mutexes for strings that follow the default Quasar pattern, and the directories where Quasar installs itself. Commercial antivirus programs detect most Quasar client binary builds as malicious.\n \n\n\n#### Snort Signatures\n\n\n#### Signature 1: TCP Payload Size Tracking\n\n\n\n This signature matches on a server\\-to\\-client packet with a TCP payload length of 68 bytes and the first 4 bytes matching the size tracking sequence. NCCIC observed this packet as the first packet after the TCP handshake. Network defenders can create and implement additional signatures to detect differing TCP payload sizes and the packet\u2019s respective size tracking sequences. The following Snort signature can be used to detect unmodified Quasar v1\\.3\\.0\\.0; however, it is unknown if this signature can be used to detect modified versions.\n \n\n\n\n alert tcp $EXTERNAL\\_NET :1024 \\-\\> $HOME\\_NET any (msg:\"Non\\-Std TCP Server Traffic contains '\\|40 00 00 00\\|' (Quasar RAT Initial Packet)\"; sid:10000; rev:1; flow:established,from\\_server; dsize:68; content:\"\\|40 00 00 00\\|\"; depth:4; fast\\_pattern;)\n \n\n Quasar uses a TCP payload of 68 bytes at the beginning of each of its sessions. Quasar\u2019s distinctive 68\\-byte TCP payload presents the best opportunity for network defenders to identify Quasar activity.\n \n\n\n\n It is likely that the Quasar TCP payload server packet will originate from TCP port 80 or 443 to traverse network firewalls and attempt to blend in with normal web browsing traffic. Network defenders may want to further limit this Snort signature to only TCP ports 80 or 443\\.\n \n\n\n\n When reviewing alerts generated by this Snort signature, network defenders should look for server\\-to\\-client TCP\n `PSH/ACK` \n packets following the alert packet. True positive alerts will likely have a 4\\-byte tracking sequence equal to the size of the TCP payload minus 4 bytes, with what appears to be ciphertext in the remaining payload.\n \n\n\n\n NCCIC recommends applying this Snort signature to a network sensor located on an organization\u2019s perimeter to limit the false positives generated by internal organization traffic.\n \n\n\n#### Signature 2: IP Lookup User\\-Agent String, HyperText Transfer Protocol Header Host, and HyperText Transfer Protocol Header URI\n\n\n\n alert tcp $HOME\\_NET any \\-\\> $EXTERNAL\\_NET $HTTP\\_PORTS (msg:\"HTTP Client Header contains 'Host\\|3a 20\\|ip\\-api com', URI '/json/' (Quasar RAT)\"; sid:10002; rev:1; flow:established,to\\_server; content:\"Host\\|3a 20\\|ip\\-api\\|2e\\|com\\|0d 0a\\|\"; http\\_header; fast\\_pattern:only; content:\"User\\-Agent\\|3a 20\\|Mozilla/5\\.0 (Windows NT 6\\.3\\|3b\\| rv\\|3a\\|48\\.0\\) Gecko/20100101 Firefox/48\\.0\\|0d 0a\\|\"; http\\_header; content:\"/json/\"; http\\_uri; depth:6; urilen:6,norm; priority:2;)\n \n\n This Snort signature alerts on the WAN IP lookup initiated by the Quasar client. The User\\-Agent string, Hypertext Transfer Protocol (HTTP) header host, and HTTP header URI values are set by the server component when the client is built. The server component is configured with these values at compile time. The User\\-Agent string mimics Windows 8\\.1 running Firefox 48, both of which are considerably dated. It is possible to see this User\\-Agent string used legitimately; however, organizations with information technology baselines should know if this User\\-Agent string legitimately exists in their network environment.\n \n\n\n#### Signature 3: Hidden HTTP Request User\\-Agent String and Time\\-to\\-Live\n\n\n\n alert tcp $HOME\\_NET any \\-\\> $EXTERNAL\\_NET $HTTP\\_PORTS (msg:\"HTTP Client Header contains 'User\\-Agent\\|3a 20\\|Mozilla/5\\.0 (Macintosh\\|3b\\| Intel Mac OS X 10\\_9\\_3\\) AppleWebKit/537\\.75\\.14 (KHTML, like Gecko) Version/7\\.0\\.3 Safari/7046A194A', TTL 65\\-128 (Quasar RAT)\"; sid:10001; rev:1; flow:established,to\\_server; content:\"User\\-Agent\\|3a 20\\|Mozilla/5\\.0 (Macintosh\\|3b\\| Intel Mac OS X 10\\_9\\_3\\) AppleWebKit/537\\.75\\.14 (KHTML, like Gecko) Version/7\\.0\\.3 Safari/7046A194A\\|0d 0a\\|\"; http\\_header; fast\\_pattern:only; priority:2;)\n \n\n This Snort signature alerts on a client\\-generated hidden HTTP request. The Quasar user can direct the target host to visit a URL and retrieve the content. If the request is set to \u201chidden,\u201d the client uses this User\\-Agent string to mimic Mac OS X 10\\.9\\.3 and Safari 7\\. Mac OS X 10\\.9\\.3 and Safari 7 are not only dated, but also do not match the OS on which Quasar operates (i.e., Windows). When reviewing alerts NCCIC recommends looking for packets with a TTL between 65 and 128\\.\n \n\n\n\n### References\n\n\n\n\n[FireEye blog on new tools used by an APT group](https://www.fireeye.com/blog/threat-research/2017/04/apt10_menupass_grou.html) \n\n\n[Palo Alto Networks Unit 42 blog on Quasar](https://researchcenter.paloaltonetworks.com/2017/01/unit42-downeks-and-quasar-rat-used-in-recent-targeted-attacks-against-governments/) \n\n\n### Revisions\n\n\n\n\n December 18, 2018: Initial version\\|December 21, 2018: Updated signatures\n \n\n\n\n\n\n\n\n\n\n\n This product is provided subject to this\n [Notification](/notification \"Follow link\") \n and this\n [Privacy \\& Use](/privacy-policy \"Follow link\") \n policy.\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPlease share your thoughts\n--------------------------\n\n\n\n We recently updated our anonymous\n [product survey](https://www.surveymonkey.com/r/CISA-cyber-survey?product=https://www.cisa.gov/news-events/analysis-reports/ar18-352a) \n ; we\u2019d welcome your feedback.\n \n\n\n\n\n\n\n\n\n\n\n\n\nRelated Advisories\n------------------\n\n\n\n\n\n\n\n\n\n\n Feb 07, 2024\n \n\n\n Analysis Report \\| AR24\\-038A\n \n\n### [MAR\\-10448362\\-1\\.v1 Volt Typhoon](/news-events/analysis-reports/ar24-038a)\n\n\n\n\n\n\n\n\n\n\n\n Nov 21, 2023\n \n\n\n Analysis Report \\| AR23\\-325A\n \n\n### [MAR\\-10478915\\-1\\.v1 Citrix Bleed](/news-events/analysis-reports/ar23-325a)\n\n\n\n\n\n\n\n\n\n\n\n Sep 07, 2023\n \n\n\n Analysis Report \\| AR23\\-250A\n \n\n### [MAR\\-10430311\\-1\\.v1 Multiple Nation\\-State Threat Actors Exploit CVE\\-2022\\-47966 and CVE\\-2022\\-42475](/news-events/analysis-reports/ar23-250a)\n\n\n\n\n\n\n\n\n\n\n\n Sep 07, 2023\n \n\n\n Analysis Report \\| AR23\\-250A\n \n\n### [MAR\\-10454006\\.r5\\.v1 SUBMARINE, SKIPJACK, SEASPRAY, WHIRLPOOL, and SALTWATER Backdoors](/news-events/analysis-reports/ar23-250a-0)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[Return to top](#) \n\n\n\n\n* [Topics](/topics)\n* [Spotlight](/spotlight)\n* [Resources \\& Tools](/resources-tools)\n* [News \\& Events](/news-events)\n* [Careers](/careers)\n* [About](/about)\n\n\n\n\n\n\n\n\n[Cybersecurity \\& Infrastructure Security Agency](/ \"Go to the Cybersecurity & Infrastructure Security Agency homepage\")\n\n\n* [Facebook](https://www.facebook.com/CISA)\n* [Twitter](https://twitter.com/CISAgov)\n* [LinkedIn](https://www.linkedin.com/company/cybersecurity-and-infrastructure-security-agency)\n* [YouTube](https://www.youtube.com/@cisagov)\n* [Instagram](https://www.instagram.com/cisagov)\n* [RSS](/subscribe-updates-cisa)\n\n\n\n\n CISA Central\n \n[1\\-844\\-Say\\-CISA](tel:1-844-Say-CISA) \n[SayCISA@cisa.gov](mailto:SayCISA@cisa.gov) \n\n\n\n\n\n\n\n\n\n\n\n DHS Seal\n \n\n\n CISA.gov\n \n\n An official website of the U.S. Department of Homeland Security\n \n\n\n* [About CISA](/about \"About CISA\")\n* [Budget and Performance](https://www.dhs.gov/performance-financial-reports \"Budget and Performance\")\n* [DHS.gov](https://www.dhs.gov \"Department of Homeland Security\")\n* [Equal Opportunity \\& Accessibility](/oedia \"Equal Opportunity & Accessibility\")\n* [FOIA Requests](https://www.dhs.gov/foia \"FOIA Requests\")\n* [No FEAR Act](/no-fear-act \"No FEAR Act Reporting\")\n* [Office of Inspector General](https://www.oig.dhs.gov/ \"Office of Inspector General\")\n* [Privacy Policy](/privacy-policy \"Privacy Policy\")\n* [Subscribe](https://public.govdelivery.com/accounts/USDHSCISA/subscriber/new?topic_id=USDHSCISA_138 \"Subscribe to Email Updates\")\n* [The White House](https://www.whitehouse.gov/ \"The White House\")\n* [USA.gov](https://www.usa.gov/ \"USA.gov\")\n* [Website Feedback](/forms/feedback \"Website Feedback\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n", "cves": ["CVE-2022-47966", "CVE-2022-42475"], "techniques": [], "advisory": "ar18-352a", "title": "Quasar Open-Source Remote Administration Tool | CISA", "source": "analysis-reports", "id": "fbe5c5747ad685254c2380536d7c3d7f78ebe0f9165100a3c3452bd034d3bf98"}