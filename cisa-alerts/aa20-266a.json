{
  "markdown": " LokiBot Malware \\| CISA A A ( Lock ) or[\\#protect2024](/protect2024)  Search Menu Close[Faith\\-Based Community](/audiences/faith-based-community) [High\\-Risk Communities](/audiences/high-risk-communities)* Resources \\& Tools[Resources \\& Tools](/resources-tools) [All Resources \\& Tools](/resources-tools/all-resources-tools)* News \\& Events[News \\& Events](/news-events) [Cybersecurity Alerts \\& Advisories](/news-events/cybersecurity-advisories)[Benefits \\& Perks](/careers/benefits-perks)[Resume \\& Application Tips](/careers/resume-application-tips)[Students \\& Recent Graduates](/students-recent-graduates-employment-opportunities)[Divisions \\& Offices](/about/divisions-offices)[\\#protect2024](/protect2024) 2. [News \\& Events](/news-events)4. [Cybersecurity Advisory](/news-events/cybersecurity-advisories?f%5B0%5D=advisory_type%3A94) Cybersecurity AdvisoryLokiBot Malware=============== Last Revised October 24, 2020 Alert Code AA20\\-266A### Summary*This Alert uses the MITRE Adversarial Tactics, Techniques, and Common Knowledge (ATT\\&CK\u00ae) framework. See the [ATT\\&CK for Enterprise](https://attack.mitre.org/versions/v7/matrices/enterprise/)  frameworks for all referenced threat actor techniques.*  This product was written by the Cybersecurity and Infrastructure Security Agency (CISA) with contributions by the [Multi\\-State Information Sharing \\& Analysis Center (MS\\-ISAC)](https://www.cisecurity.org/ms-isac/)  . CISA has observed a notable increase in the use of LokiBot malware by malicious cyber actors since July 2020\\. Throughout this period, CISA\u2019s EINSTEIN Intrusion Detection System, which protects federal, civilian executive branch networks, has detected persistent malicious LokiBot activity. LokiBot uses a credential\\- and information\\-stealing malware, often sent as a malicious attachment and known for being simple, yet effective, making it an attractive tool for a broad range of cyber actors across a wide variety of data compromise use cases.### Technical Details LokiBot\u2014also known as Lokibot, Loki PWS, and Loki\\-bot\u2014employs Trojan malware to steal sensitive information such as usernames, passwords, cryptocurrency wallets, and other credentials.* The malware steals credentials through the use of a keylogger to monitor browser and desktop activity ( *Credentials from Password Stores*  \\[ [T1555](https://attack.mitre.org/versions/v7/techniques/T1555/)  ]).\t+ (\t *Credentials from Password Stores: Credentials from Web Browsers* \t \\[\t [T1555\\.003](https://attack.mitre.org/versions/v7/techniques/T1555/003) \t ])\t+ (\t *Input Capture: Keylogging* \t \\[\t [T1056\\.001](https://attack.mitre.org/versions/v7/techniques/T1056/001) \t ])* LokiBot can also create a backdoor into infected systems to allow an attacker to install additional payloads ( *Event Triggered Execution: Accessibility Features*  \\[ [T1546\\.008](https://attack.mitre.org/versions/v7/techniques/T1546/008/)  ]).* Malicious cyber actors typically use LokiBot to target Windows and Android operating systems and distribute the malware via email, malicious websites, text, and other private messages ( *User Execution: Malicious File*  \\[ [T1204\\.002](https://attack.mitre.org/versions/v7/techniques/T1204/002/)  ]). See figure 1 for enterprise techniques used by LokiBot.![]() \u200b*Figure 1: MITRE ATT\\&CK enterprise techniques used by LokiBot*  Since LokiBot was first reported in 2015, cyber actors have used it across a range of targeted applications, including the following.* **February 2020:**  Trend Micro identified cyber actors using LokiBot to impersonate a launcher for Fortnite\u2014a popular video game.\\[ [1](https://blog.trendmicro.com/trendlabs-security-intelligence/lokibot-impersonates-popular-game-launcher-and-drops-compiled-c-code-file/)  ]* **August 2019:**  FortiGuard SE researchers discovered a malspam campaign distributing LokiBot information\\-stealing payloads in spearphishing attack on a U.S. manufacturing company.\\[ [2](https://www.fortinet.com/blog/threat-research/new-infostealer-attack-uses-lokibot#:~:text=The%20FortiGuard%20Labs%20SE%20team%20identified%20a%20new,manufacturing%20company%20utilizing%20the%20well%20documented%20infostealer%20LokiBot.)  ]* **August 2019:**  Trend Micro researchers reported LokiBot malware source code being hidden in image files spread as attachments in phishing emails.\\[ [3](https://www.zdnet.com/article/lokibot-information-stealer-now-hides-malware-in-image-files/)  ]* **June 2019:**  Netskope uncovered LokiBot being distributed in a malspam campaign using ISO image file attachments.\\[ [4](https://www.securityweek.com/lokibot-and-nanocore-malware-distributed-iso-image-files)  ]* **April 2019:**  Netskope uncovered a phishing campaign using malicious email attachments with LokiBot malware to create backdoors onto infected Windows systems and steal sensitive information.\\[ [5](https://www.netskope.com/blog/lokibot-nanocore-iso-disk-image-files)  ]* **February 2018:**  Trend Micro discovered CVE\\-2017\\-11882 being exploited in an attack using Windows Installer service to deliver LokiBot malware.\\[ [6](https://www.trendmicro.com/en_us/research/18/b/attack-using-windows-installer-msiexec-exe-leads-lokibot.html)  ]* **October 2017:**  SfyLabs identified cyber actors using LokiBot as an Android banking trojan that turns into ransomware.\\[ [7](https://www.bleepingcomputer.com/news/security/lokibot-android-banking-trojan-turns-into-ransomware-when-you-try-to-remove-it/)  ]* **May 2017:**  Fortinet reported malicious actors using a PDF file to spread a new LokiBot variant capable of stealing credentials from more than 100 different software tools.\\[ [8](https://www.fortinet.com/blog/threat-research/new-loki-variant-being-spread-via-pdf-file)  ]* **March 2017:**  Check Point discovered LokiBot malware found pre\\-installed on Android devices.\\[ [9](https://blog.checkpoint.com/2017/03/10/preinstalled-malware-targeting-mobile-users/)  ]* **December 2016:**  Dr.Web researchers identified a new LokiBot variant targeting Android core libraries.\\[ [10](https://www.bleepingcomputer.com/news/security/loki-trojan-infects-android-libraries-and-system-process-to-get-root-privileges/)  ]* **February 2016:**  Researchers discovered the LokiBot Android Trojan infecting the core Android operating system processes.\\[ [11](https://www.cyber.nj.gov/threat-center/threat-profiles/android-malware-variants/lokibot)  ]### MITRE ATT\\&CK Techniques According to MITRE, [LokiBot](https://attack.mitre.org/versions/v7/software/S0447/)  uses the ATT\\&CK techniques listed in table 1\\.*Table 1: LokiBot ATT\\&CK techniques* | Technique | Use || --- | --- || *System Network Configuration Discovery*   \\[  [T1016](https://attack.mitre.org/versions/v7/techniques/T1016)   ] | LokiBot has the ability to discover the domain name of the infected host. || *Obfuscated Files or Information*   \\[  [T1027](https://attack.mitre.org/versions/v7/techniques/T1027/)   ] | LokiBot has obfuscated strings with base64 encoding. || *Obfuscated Files or Information: Software Packing*   \\[  [T1027\\.002](https://attack.mitre.org/versions/v7/techniques/T1027/002/)   ] | LokiBot has used several packing methods for obfuscation. || *System Owner/User Discovery*   \\[  [T1033](https://attack.mitre.org/versions/v7/techniques/T1033)   ] | LokiBot has the ability to discover the username on the infected host. || *Exfiltration Over C2 Channel*   \\[  [T1041](https://attack.mitre.org/versions/v7/techniques/T1041/)   ] | LokiBot has the ability to initiate contact with command and control to exfiltrate stolen data. || *Process Injection: Process Hollowing*   \\[  [T1055\\.012](https://attack.mitre.org/versions/v7/techniques/T1055/012/)   ] | LokiBot has used process hollowing to inject into legitimate Windows process vbc.exe. || *Input Capture: Keylogging*   \\[  [T1056\\.001](https://attack.mitre.org/versions/v7/techniques/T1056/001)   ] | LokiBot has the ability to capture input on the compromised host via keylogging. || *Application Layer Protocol: Web Protocols*   \\[  [T1071\\.001](https://attack.mitre.org/versions/v7/techniques/T1071/001)   ] | LokiBot has used Hypertext Transfer Protocol for command and control. || *System Information Discovery*   \\[  [T1082](https://attack.mitre.org/versions/v7/techniques/T1082)   ] | LokiBot has the ability to discover the computer name and Windows product name/version. || *User Execution: Malicious File*   \\[  [T1204\\.002](https://attack.mitre.org/versions/v7/techniques/T1204/002/)   ] | LokiBot has been executed through malicious documents contained in spearphishing emails. || *Credentials from Password Stores*   \\[  [T1555](https://attack.mitre.org/versions/v7/techniques/T1555/)   ] | LokiBot has stolen credentials from multiple applications and data sources including Windows operating system credentials, email clients, File Transfer Protocol, and Secure File Transfer Protocol clients. || *Credentials from Password Stores: Credentials from Web Browsers*   \\[  [T1555\\.003](https://attack.mitre.org/versions/v7/techniques/T1555/003)   ] | LokiBot has demonstrated the ability to steal credentials from multiple applications and data sources including Safari and Chromium and Mozilla Firefox\\-based web browsers. || *Hide Artifacts: Hidden Files and Directories*   \\[  [T1564\\.001](https://attack.mitre.org/versions/v7/techniques/T1564/001/)   ] | LokiBot has the ability to copy itself to a hidden file and directory. |### Detection#### Signatures CISA developed the following Snort signature for use in detecting network activity associated with LokiBot activity. alert tcp any any \\-\\> any $HTTP\\_PORTS (msg:\"Lokibot:HTTP URI POST contains '/\\*/fre.php' post\\-infection\"; flow:established,to\\_server; flowbits:isnotset,.tagged; content:\"/fre.php\"; http\\_uri; fast\\_pattern:only; urilen:\\<50,norm; content:\"POST\"; nocase; http\\_method; pcre:\"/\\\\/(?:alien\\|loky\\\\d\\|donep\\|jemp\\|lokey\\|new2\\|loki\\|Charles\\|sev7n\\|dbwork\\|scroll\\\\/NW\\|wrk\\|job\\|five\\\\d?\\|donemy\\|animation\\\\dkc\\|love\\|Masky\\|v\\\\d\\|lifetn\\|Ben)\\\\/fre\\\\.php$/iU\"; flowbits:set,.tagged;classtype:http\\-uri; metadata:service http; metadata:pattern HTTP\\-P001,)### Mitigations CISA and MS\\-ISAC recommend that federal, state, local, tribal, territorial government, private sector users, and network administrators consider applying the following best practices to strengthen the security posture of their organization's systems. System owners and administrators should review any configuration changes prior to implementation to avoid unwanted impacts.* Maintain up\\-to\\-date antivirus signatures and engines. See [Protecting Against Malicious Code](https://www.us-cert.gov/ncas/tips/ST18-271)  .* Keep operating system patches up to date. See [Understanding Patches and Software Updates](https://www.us-cert.gov/ncas/tips/ST04-006)  .* Disable file and printer sharing services. If these services are required, use [strong passwords](https://us-cert.cisa.gov/ncas/tips/ST04-002)  or Active Directory authentication.* Enforce multi\\-factor authentication. See [Supplementing Passwords](https://www.us-cert.gov/ncas/tips/ST05-012)  for more information.* Restrict users' ability (permissions) to install and run unwanted software applications. Do not add users to the local administrators\u2019 group unless required.* Enforce a strong password policy. See [Choosing and Protecting Passwords](https://www.us-cert.gov/ncas/tips/ST04-002)  .* Exercise caution when opening email attachments, even if the attachment is expected and the sender appears to be known. See [Using Caution with Email Attachments](https://www.us-cert.gov/ncas/tips/ST04-010)  .* Enable a personal firewall on agency workstations, configured to deny unsolicited connection requests.* Disable unnecessary services on agency workstations and servers.* Scan for and remove suspicious email attachments; ensure the scanned attachment is its \"true file type\" (i.e., the extension matches the file header).* Monitor users' web browsing habits; restrict access to sites with unfavorable content.* Exercise caution when using removable media (e.g., USB thumb drives, external drives, CDs).* Scan all software downloaded from the internet prior to executing.* Maintain situational awareness of the latest threats and implement appropriate access control lists.* Visit the MITRE ATT\\&CK Techniques pages (linked in table 1 above) for additional mitigation and detection strategies. For additional information on malware incident prevention and handling, see the National Institute of Standards and Technology Special Publication 800\\-83, [Guide to Malware Incident Prevention and Handling for Desktops and Laptops](https://csrc.nist.gov/publications/detail/sp/800-83/rev-1/final)  .### Resources Center for Internet Security Security Event Primer \u2013 Malware: [https://www.cisecurity.org/white\\-papers/security\\-event\\-primer\\-malware/](https://www.cisecurity.org/white-papers/security-event-primer-malware/)  MITRE ATT\\&CK \u2013 LokiBot: [https://attack.mitre.org/software/S0447/](https://attack.mitre.org/versions/v7/software/S0447/)  MITRE ATT\\&CK for Enterprise: [https://attack.mitre.org/matrices/enterprise/](https://attack.mitre.org/versions/v7/matrices/enterprise/) ### References[\\[1] Trend Micro: LokiBot Impersonates Popular Game Launcher and Drops Compiled C\\# Code File](https://blog.trendmicro.com/trendlabs-security-intelligence/lokibot-impersonates-popular-game-launcher-and-drops-compiled-c-code-file/) [\\[2] Fortinet: Newly Discovered Infostealer Attack Uses LokiBot](https://www.fortinet.com/blog/threat-research/new-infostealer-attack-uses-lokibot#:~:text=The%20FortiGuard%20Labs%20SE%20team%20identified%20a%20new,manufacturing%20company%20utilizing%20the%20well%20documented%20infostealer%20LokiBot.) [\\[3] ZDNet: LokiBot Malware Now Hides its Source Code in Image Files](https://www.zdnet.com/article/lokibot-information-stealer-now-hides-malware-in-image-files/) [\\[4] SecurityWeek: LokiBot and NanoCore Malware Distributed in ISO Image Files](https://www.securityweek.com/lokibot-and-nanocore-malware-distributed-iso-image-files) [\\[5] Netskope: LokiBot \\& NanoCore being distributed via ISO disk image files](https://www.netskope.com/blog/lokibot-nanocore-iso-disk-image-files) [\\[6] Trend Micro: Attack Using Windows Installer Leads to LokiBot](https://www.trendmicro.com/en_us/research/18/b/attack-using-windows-installer-msiexec-exe-leads-lokibot.html) [\\[7] BleepingComputer: LokiBot Android Banking Trojan Turns Into Ransomware When You Try to Remove It](https://www.bleepingcomputer.com/news/security/lokibot-android-banking-trojan-turns-into-ransomware-when-you-try-to-remove-it/) [\\[8] Fortinet: New Loki Variant Being Spread via PDF File](https://www.fortinet.com/blog/threat-research/new-loki-variant-being-spread-via-pdf-file) [\\[9] Check Point: Preinstalled Malware Targeting Mobile Users](https://blog.checkpoint.com/2017/03/10/preinstalled-malware-targeting-mobile-users/) [\\[10] BleepingComputer: Loki Trojan Infects Android Libraries and System Process to Get Root Privileges](https://www.bleepingcomputer.com/news/security/loki-trojan-infects-android-libraries-and-system-process-to-get-root-privileges/) [\\[11]\u202fNew Jersey Cybersecurity \\& Communications Integration Cell:\u202fLokiBot](https://www.cyber.nj.gov/threat-center/threat-profiles/android-malware-variants/lokibot) ### Revisions September 22, 2020: Initial Version\\|September 23, 2020: Added hyperlink to MS\\-ISAC This product is provided subject to this [Notification](/notification \"Follow link\")  and this [Privacy \\& Use](/privacy-policy \"Follow link\")  policy.-------------------------- [product survey](https://www.surveymonkey.com/r/CISA-cyber-survey?product=https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-266a)  ; Related Advisories------------------ Jul 11, 2024 Cybersecurity Advisory \\| AA24\\-193A### [CISA Red Team\u2019s Operations Against a Federal Civilian Executive Branch Organization Highlights the Necessity of Defense\\-in\\-Depth](/news-events/cybersecurity-advisories/aa24-193a) Jul 08, 2024 Cybersecurity Advisory \\| AA24\\-190A### [People\u2019s Republic of China (PRC) Ministry of State Security APT40 Tradecraft in Action](/news-events/cybersecurity-advisories/aa24-190a) May 10, 2024 Cybersecurity Advisory \\| AA24\\-131A### [\\#StopRansomware: Black Basta](/news-events/cybersecurity-advisories/aa24-131a) Apr 18, 2024 Cybersecurity Advisory \\| AA24\\-109A### [\\#StopRansomware: Akira Ransomware](/news-events/cybersecurity-advisories/aa24-109a)* [Resources \\& Tools](/resources-tools)* [News \\& Events](/news-events)[Cybersecurity \\& Infrastructure Security Agency](/ \"Go to the Cybersecurity & Infrastructure Security Agency homepage\")[1\\-844\\-Say\\-CISA](tel:1-844-Say-CISA) * [Equal Opportunity \\& Accessibility](/oedia \"Equal Opportunity & Accessibility\")",
  "cves": [
    "CVE-2017-11882"
  ],
  "techniques": [
    "T1564.001",
    "T1055.012",
    "T1027.002",
    "T1204.002",
    "T1546.008",
    "T1056.001",
    "T1555.003",
    "T1071.001"
  ],
  "advisory": "aa20-266a",
  "title": "LokiBot Malware | CISA",
  "source": "cybersecurity-advisories",
  "id": "3bbaeba29cfa905003e6a4bdb359474627824671e9b806817b4c715ddc9f1558"
}