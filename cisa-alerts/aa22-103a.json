{
  "markdown": "\n\nSummary\n\nActions to Take Today to Protect ICS/SCADA Devices:\u2022 Enforce multifactor authentication for all remote access to ICS networks and devices whenever possible.\u2022 Change all passwords to ICS/SCADA devices and systems on a consistent schedule, especially all default passwords, to device-unique strong passwords to mitigate password brute force attacks and to give defender monitoring systems opportunities to detect common attacks.\u2022 Leverage a properly installed continuous OT monitoring solution to log and alert on malicious indicators and behaviors.\nThe Department of Energy (DOE), the Cybersecurity and Infrastructure Security Agency (CISA), the National Security Agency (NSA), and the Federal Bureau of Investigation (FBI) are releasing this joint Cybersecurity Advisory (CSA) to warn that certain advanced persistent threat (APT) actors have exhibited the capability to gain full system access to multiple industrial control system (ICS)/supervisory control and data acquisition (SCADA) devices, including:\n\nSchneider Electric programmable logic controllers (PLCs),\nOMRON Sysmac NEX PLCs, and\nOpen Platform Communications Unified Architecture (OPC UA) servers.\n\nThe APT actors have developed custom-made tools for targeting ICS/SCADA devices. The tools enable them to scan for, compromise, and control affected devices once they have established initial access to the operational technology (OT) network. Additionally, the actors can compromise Windows-based engineering workstations, which may be present in information technology (IT) or OT environments, using an exploit that compromises an ASRock motherboard driver with known vulnerabilities. By compromising\u00a0and maintaining full system access to ICS/SCADA devices, APT actors could elevate privileges, move laterally within an OT environment, and disrupt critical devices or functions.\nDOE, CISA, NSA, and the FBI urge critical infrastructure organizations, especially Energy Sector organizations, to implement the detection and mitigation recommendations provided in this CSA to detect potential malicious APT activity and harden their ICS/SCADA devices.\u00a0\nClick here\u00a0for a PDF version of this report.\u00a0\n\nTechnical Details\n\nAPT actors have developed custom-made tools that, once they have established initial access in an OT network, enables them to scan for, compromise, and control certain ICS/SCADA devices, including the following:\n\nSchneider Electric MODICON and MODICON Nano PLCs, including (but may not be limited to) TM251, TM241, M258, M238, LMC058, and LMC078;\nOMRON Sysmac NJ and NX PLCs, including (but may not be limited to) NEX NX1P2, NX-SL3300, NX-ECC203, NJ501-1300, S8VK, and R88D-1SN10F-ECT; and\u00a0\nOPC Unified Architecture (OPC UA) servers. \u00a0\n\nThe APT actors\u2019 tools have a modular architecture and enable cyber actors to conduct highly automated exploits against targeted devices. The tools have a virtual console with a command interface that mirrors the interface of the targeted ICS/SCADA device. Modules interact with targeted devices, enabling operations by lower-skilled cyber actors to emulate higher-skilled actor capabilities.\nThe APT actors can leverage the modules to scan for targeted devices, conduct reconnaissance on device details, upload malicious configuration/code to the targeted device, back up or restore device contents, and modify device parameters.\u00a0\nIn addition, the APT actors can use a tool that installs and exploits a known-vulnerable ASRock-signed motherboard driver, AsrDrv103.sys, exploiting CVE-2020-15368 to execute malicious code in the Windows kernel. Successful deployment of this tool can allow APT actors to move laterally within an IT or OT environment and disrupt critical devices or functions.\nAPT Tool for Schneider Electric Devices \u00a0\nThe APT actors\u2019 tool for Schneider Electric devices has modules that interact via normal management protocols and Modbus (TCP 502). Modules may allow cyber actors to:\n\nRun a rapid scan that identifies all Schneider PLCs on the local network via User Datagram Protocol (UDP) multicast with a destination port of 27127 (Note: UDP 27127 is a standard discovery scan used by engineering workstations to discover PLCs and may not be indicative of malicious activity);\nBrute-force Schneider Electric PLC passwords using CODESYS and other available device protocols via UDP port 1740 against defaults or a dictionary word list (Note: this capability may work against other CODESYS-based devices depending on individual design and function, and this report will be updated as more information becomes available);\u00a0\nConduct a denial-of-service attack to prevent network communications from reaching the PLC;\nSever connections, requiring users to re-authenticate to the PLC, likely to facilitate capture of credentials;\u00a0\nConduct a \u2018packet of death\u2019 attack to crash the PLC until a power cycle and configuration recovery is conducted; and\u00a0\nSend custom Modbus commands (Note: this capability may work against Modbus other than in Schneider Electric PLCs).\n\nRefer to the appendix for tactics, techniques, and procedures (TTPs) associated with this tool.\nAPT Tool for OMRON\u00a0\nThe APT actors\u2019 tool for OMRON devices has modules that can interact by:\n\nScanning for OMRON using Factory Interface Network Service (FINS) protocol;\nParsing the Hypertext Transfer Protocol (HTTP) response from OMRON devices;\nRetrieving the media access control (MAC) address of the device;\nPolling for specific devices connected to the PLC;\nBacking up/restoring arbitrary files to/from the PLC; and\nLoading a custom malicious agent on OMRON PLCs for additional attacker-directed capability.\n\nAdditionally, the OMRON modules can upload an agent that allows a cyber actor to connect and initiate commands\u2014such as file manipulation, packet captures, and code execution\u2014via HTTP and/or Hypertext Transfer Protocol Secure (HTTPS).\u00a0\nRefer to the appendix for TTPs associated with this tool.\nAPT Tool for OPC UA\u00a0\nThe APT actors\u2019 tool for OPC UA has modules with basic functionality to identify OPC UA servers and to connect to an OPC UA server using default or previously compromised credentials. The client can read the OPC UA structure from the server and potentially write tag values available via OPC UA.\nThe threat from this tool can be significantly reduced by properly configuring OPC UA security. Refer to the Mitigations below for more information.\u00a0\nRefer to the appendix for TTPs associated with this tool.\n\nMitigations\n\nNote: these mitigations are provided to enable network defenders to begin efforts to protect systems and devices from new capabilities. They have not been verified against every environment and should be tested prior to implementing.\nDOE, CISA, NSA, and the FBI recommend all organizations with ICS/SCADA devices implement the following proactive mitigations:\n\nIsolate ICS/SCADA systems and networks from corporate and internet networks using strong perimeter controls, and limit any communications entering or leaving ICS/SCADA perimeters.\u00a0\nEnforce multifactor authentication for all remote access to ICS networks and devices whenever possible.\nHave a cyber incident response plan, and exercise it regularly with stakeholders in IT, cybersecurity, and operations.\nChange all passwords to ICS/SCADA devices and systems on a consistent schedule, especially all default passwords, to device-unique strong passwords to mitigate password brute force attacks and to give defender monitoring systems opportunities to detect common attacks.\nEnsure OPC UA security is correctly configured with application authentication enabled and explicit trust lists.\u00a0\nEnsure the OPC UA certificate private keys and user passwords are stored securely.\u00a0\nMaintain known-good offline backups for faster recovery upon a disruptive attack, and conduct hashing and integrity checks on firmware and controller configuration files to ensure validity of those backups.\u00a0\nLimit ICS/SCADA systems\u2019 network connections to only specifically allowed management and engineering workstations.\nRobustly protect management systems by configuring Device Guard, Credential Guard, and Hypervisor Code Integrity (HVCI). Install Endpoint Detection and Response (EDR) solutions on these subnets and ensure strong anti-virus file reputation settings are configured.\nImplement robust log collection and retention from ICS/SCADA systems and management subnets.\nLeverage a continuous OT monitoring solution to alert on malicious indicators and behaviors, watching internal systems and communications for known hostile actions and lateral movement. For enhanced network visibility to potentially identify abnormal traffic, consider using CISA\u2019s open-source Industrial Control Systems Network Protocol Parsers (ICSNPP).\nEnsure all applications are only installed when necessary for operation.\u00a0\nEnforce principle of least privilege. Only use admin accounts when required for tasks, such as installing software updates.\u00a0\nInvestigate symptoms of a denial of service or connection severing, which exhibit as delays in communications processing, loss of function requiring a reboot, and delayed actions to operator comments as signs of potential malicious activity.\nMonitor systems for loading of unusual drivers, especially for ASRock driver if no ASRock driver is normally used on the system.\u00a0\n\nResources\nFor additional guidance on securing OT devices, see\u00a0\n\nLayering Network Security Through Segmentation,\u00a0\nStop Malicious Cyber Activity Against Connected Operational Technology, and\nNSA and CISA Recommend Immediate Actions to Reduce Exposure Across Operational Technologies and Control Systems. \u00a0\n\nFor additional guidance on securing OPC UA enabled devices, see:\u00a0\n\nPractical Security Recommendations for building OPC UA Applications\n\nFor more information on APT actors\u2019 tools and TTPs, refer to:\u00a0\n\nMandiant\u2019s Blog \u2013 INCONTROLLER: New State-Sponsored Cyber Attack Tools Target Multiple Industrial Control Systems\nDragos\u2019 Blog\u00a0\u2013 CHERNOVITE'S\u00a0PIPEDREAM:\u00a0Malware Targeting Industrial Control Systems\n\nDisclaimer\nThe information in this report is being provided \u201cas is\u201d for informational purposes only. DOE, CISA, NSA, and the FBI do not endorse any commercial product or service, including any subjects of analysis. Any reference to specific commercial products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by the DOE, CISA, NSA, or the FBI, and this guidance shall not be used for advertising or product endorsement purposes.\nAcknowledgements\nThe DOE, CISA, NSA, and the FBI would like to thank Dragos, Mandiant, Microsoft, Palo Alto Networks, and Schneider Electric\u00a0for their contributions to this joint CSA.\nAppendix: APT Cyber Tools Tactics, Techniques, and Procedures\nSee tables 1 through 3 for TTPs associated with the cyber actors\u2019 tools described in this CSA mapped to the MITRE ATT&CK for ICS framework. See the ATT&CK for ICS framework for all referenced threat actor tactics and techniques.\nTable 1: APT Tool for Schneider Electric ICS TTPs\n\n\n\nTactic\nTechnique\n\n\n\n\nExecution\nCommand-Line Interface [T0807]\n\n\nScripting [T0853]\n\n\nPersistence\nModify Program [T0889]\n\n\nSystem Firmware [T0857]\n\n\nValid Accounts [T0859]\n\n\nDiscovery\nRemote System Discovery [T0846]\n\n\nRemote System Information Discovery [T0888]\n\n\nLateral Movement\nDefault Credentials [T0812]\n\n\nProgram Download [T0843]\n\n\nValid Accounts [T0859]\n\n\nCollection\n\u00a0\n\n\nMonitor Process State [T0801]\n\n\nProgram Upload [T0845]\n\n\nMonitor Process State [T0801]\n\n\nCommand and Control\nCommonly Used Port [T0885]\n\n\nStandard Application Layer Protocol [T0869]\n\n\nInhibit Response Function\nBlock Reporting Message [T0804]\n\n\nBlock Command Message [T0803]\n\n\nDenial of Service [T0814]\n\n\nData Destruction [T0809]\n\n\nDevice Restart/Shutdown [T0816]\n\n\nSystem Firmware [T0857]\n\n\nImpair Process Control\nModify Parameter [T0836]\n\n\nUnauthorized Command Message [T0855]\n\n\nImpact\nDenial of Control [T0813]\n\n\nDenial of View [T0815]\n\n\nLoss of Availability [T0826]\n\n\nLoss of Control [T0827]\n\n\nLoss of Productivity and Revenue [T0828]\n\n\nManipulation of Control [T0831]\n\n\nTheft of Operational Information [T0882]\n\n\n\n\u00a0\nTable 2: APT Tool for OMRON ICS TTPs\n\n\n\nTactic\nTechnique\n\n\n\n\nInitial Access\nRemote Services [T0886]\n\n\nExecution\nCommand-Line Interface [T0807]\n\n\nScripting [T0853]\n\n\nChange Operating Mode [T0858]\n\n\nModify Controller Tasking [T0821]\n\n\nNative API [T0834]\n\n\nPersistence\nModify Program [T0889]\n\n\nValid Accounts [T0859]\n\n\nEvasion\nChange Operating Mode [T0858]\n\n\nDiscovery\u00a0\nNetwork Sniffing [T0842]\n\n\nRemote System Discovery [T0846]\n\n\nRemote System Information Discovery [T0888]\n\n\nLateral Movement\nDefault Credentials [T0812]\n\n\nLateral Tool Transfer [T0867]\n\n\nProgram Download [T0843]\n\n\nRemote Services [T0886]\n\n\nValid Accounts [T0859]\n\n\nCollection\nDetect Operating Mode [T0868]\n\n\nMonitor Process State [T0801]\n\n\nProgram Upload [T0845]\n\n\nCommand and Control\nCommonly Used Port [T0885]\n\n\nStandard Application Layer Protocol [T0869]\n\n\nInhibit Response Function\nService Stop [T0881]\n\n\nImpair Process Control\nModify Parameter [T0836]\n\n\nUnauthorized Command Message [T0855]\n\n\nImpact\nDamage to Property [T0879]\n\n\nLoss of Safety [T0837]\n\n\nManipulation of Control [T0831]\n\n\nTheft of Operational Information [T0882]\n\n\n\n\u00a0\nTable 3:\u00a0APT Tool for OPC UA ICS TTPs\n\n\n\nTactic\nTechnique\n\n\n\n\nExecution\nCommand-Line Interface [T0807]\n\n\nScripting [T0853]\n\n\nPersistence\nValid Accounts [T0859]\n\n\nDiscovery\nRemote System Discovery [T0846]\n\n\nRemote System Information Discovery [T0888]\n\n\nLateral Movement\nValid Accounts [T0859]\n\n\nCollection\nMonitor Process State [T0801]\n\n\nPoint & Tag Identification [T0861]\n\n\nCommand and Control\nCommonly Used Port [T0885]\n\n\nStandard Application Layer Protocol [T0869]\n\n\nImpact\nManipulation of View [T0832]\n\n\nTheft of Operational Information [T0882]\n\n\n\n\nContact Information\n\nOrganizations can also report anomalous cyber activity and/or cyber incidents 24/7 to\u00a0report@cisa.gov\u00a0or by calling 1-844-Say-CISA (1-844-729-2472) and/or to the FBI via your local FBI field office or the FBI\u2019s 24/7 CyWatch at (855) 292-3937 or CyWatch@fbi.gov. When available, please include the following information regarding the incident: date, time, and location of the incident; type of activity; number of people affected; type of equipment used for the activity; the name of the submitting company or organization; and a designated point of contact. For NSA client requirements or general cybersecurity inquiries, contact the Cybersecurity Requirements Center at 410-854-4200 or Cybersecurity_Requests@nsa.gov.\u00a0\n\nRevisions\n\nApril 13, 2022: Initial Version|April 14. 2022: Added Resources|May 25, 2022: Added Additional Mitigations and Resources\n",
  "cves": [
    "CVE-2020-15368"
  ],
  "techniques": [
    "T0812",
    "T0804",
    "T0855",
    "T0857",
    "T0861",
    "T0885",
    "T0859",
    "T0842",
    "T0827",
    "T0836",
    "T0813",
    "T0867",
    "T0814",
    "T0868",
    "T0816",
    "T0853",
    "T0845",
    "T0879",
    "T0803",
    "T0869",
    "T0889",
    "T0831",
    "T0886",
    "T0882",
    "T0837",
    "T0881",
    "T0826",
    "T0807",
    "T0858",
    "T0888",
    "T0832",
    "T0843",
    "T0834",
    "T0821",
    "T0809",
    "T0801",
    "T0828",
    "T0815",
    "T0846"
  ],
  "advisory": "aa22-103a",
  "title": "APT Cyber Tools Targeting ICS/SCADA Devices | CISA",
  "source": "cybersecurity-advisories",
  "id": "809379233683c95d07b865ca8274bdf7099eca93141e71eb543c0f128e88c454"
}