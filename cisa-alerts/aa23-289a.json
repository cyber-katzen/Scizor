{
  "markdown": "\nSUMMARY\nThe Cybersecurity and Infrastructure Security Agency (CISA), Federal Bureau of Investigation (FBI), and Multi-State Information Sharing and Analysis Center (MS-ISAC) are releasing this joint Cybersecurity Advisory (CSA) in response to the active exploitation of CVE-2023-22515. This recently disclosed vulnerability affects certain versions of Atlassian Confluence Data Center and Server, enabling malicious cyber threat actors to obtain initial access to Confluence instances by creating unauthorized Confluence administrator accounts. Threat actors exploited CVE-2023-22515 as a zero-day to obtain access to victim systems and continue active exploitation post-patch. Atlassian has rated this vulnerability as critical; CISA, FBI, and MS-ISAC expect widespread, continued exploitation due to ease of exploitation.\nCISA, FBI, and MS-ISAC strongly encourage network administrators to immediately apply the upgrades provided by Atlassian. CISA, FBI, and MS-ISAC also encourage organizations to hunt for malicious activity on their networks using the detection signatures and indicators of compromise (IOCs) in this CSA. If a potential compromise is detected, organizations should apply the incident response recommendations.\nFor additional information on upgrade instructions, a complete list of affected product versions, and IOCs, see Atlassian\u2019s security advisory for CVE-2023-22515.[1] While Atlassian\u2019s advisory provides interim measures to temporarily mitigate known attack vectors, CISA, FBI, and MS-ISAC strongly encourage upgrading to a fixed version or taking servers offline to apply necessary updates.\nDownload the PDF version of this report:\n\n\nAA23-289A Threat Actors Exploit Atlassian Confluence CVE-2023-22515 for Initial Access to Networks\n(PDF,       476.56 KB\n  )\n\n\nFor a downloadable copy of IOCs, see:\n\n\nAA23-289A STIX XML\n(XML,       12.45 KB\n  )\n\n\n\n\nAA23-289A STIX JSON\n(JSON,       9.03 KB\n  )\n\n\nTECHNICAL DETAILS\nOverview\nCVE-2023-22515 is a critical Broken Access Control vulnerability affecting the following versions of Atlassian Confluence Data Center and Server. Note: Atlassian Cloud sites (sites accessed by an atlassian.net domain), including Confluence Data Center and Server versions before 8.0.0, are not affected by this vulnerability.\n\n\n\n\n\n8.0.0\n8.0.1\n8.0.2\n8.0.3\n8.0.4\n8.1.0\n8.1.1\n\n\n\n\n8.1.3\n8.1.4\n8.2.0\n8.2.1\n8.2.2\n8.2.3\n8.3.0\n\n\n\n\n8.3.1\n8.3.2\n8.4.0\n8.4.1\n8.4.2\n8.5.0\n8.5.1\n\n\n\n\n\nUnauthenticated remote threat actors can exploit this vulnerability to create unauthorized Confluence administrator accounts and access Confluence instances. More specifically, threat actors can change the Confluence server\u2019s configuration to indicate the setup is not complete and use the /setup/setupadministrator.action endpoint to create a new administrator user. The vulnerability is triggered via a request on the unauthenticated /server-info.action endpoint.\nConsidering the root cause of the vulnerability allows threat actors to modify critical configuration settings, CISA, FBI, and MS-ISAC assess that the threat actors may not be limited to creating new administrator accounts. Open source further indicates an Open Web Application Security Project (OWASP) classification of injection (i.e., CWE-20: Improper Input Validation) is an appropriate description.[2] Atlassian released a patch on October 4, 2023, and confirmed that threat actors exploited CVE-2023-22515 as a zero-day\u2014a previously unidentified vulnerability.[1]\nOn October 5, 2023, CISA added this vulnerability to its Known Exploited Vulnerabilities Catalog based on evidence of active exploitation. Due to the ease of exploitation, CISA, FBI, and MS-ISAC expect to see widespread exploitation of unpatched Confluence instances in government and private networks.\nPost-Exploitation: Exfiltration of Data\nPost-exploitation exfiltration of data can be executed through of a variety of techniques. A predominant method observed involves the use of cURL\u2014a command line tool used to transfer data to or from a server. An additional data exfiltration technique observed includes use of Rclone [S1040]\u2014a command line tool used to sync data to cloud and file hosting services such as Amazon Web Services and China-based UCloud Information Technology Limited. Note: This does not preclude the effectiveness of alternate methods, but highlights methods observed to date. Threat actors were observed using Rclone to either upload a configuration file to victim infrastructure or enter cloud storage credentials via the command line. Example configuration file templates are listed in the following Figures 1 and 2, which are populated with the credentials of the exfiltration point:\n\n\n\n[s3]type =env_auth =access_key_id =secret_access_key =region =\u00a0endpoint = \u00a0location_constraint =acl =server_side_encryption =storage_class =\n\n\n\n\n\n\n[minio]type =provider =env_auth =access_key_id =secret_access_key =endpoint =acl =\n\n\n\nThe following User-Agent strings were observed in request headers.\u00a0Note: As additional threat actors begin to use this CVE due to the availability of publicly posted proof-of-concept code, an increasing variation in User-Agent strings is expected:\n\nPython-requests/2.27.1\ncurl/7.88.1\n\nIndicators of Compromise\nDisclaimer: Organizations are recommended to investigate or vet these IP addresses prior to taking action, such as blocking.\nThe following IP addresses were obtained from FBI investigations as of October 2023 and observed conducting data exfiltration:\n\n170.106.106[.]16\n43.130.1[.]222\n152.32.207[.]23\n199.19.110[.]14\n95.217.6[.]16 (Note: This is the official rclone.org website)\n\nAdditional IP addresses observed sending related exploit traffic have been shared by Microsoft.[3]\nDETECTION METHODS\nNetwork defenders are encouraged to review and deploy Proofpoint\u2019s Emerging Threat signatures. See Ruleset Update Summary - 2023/10/12 - v10438.[4]\nNetwork defenders are also encouraged to aggregate application and server-level logging from Confluence servers to a logically separated log search and alerting system, as well as configure alerts for signs of exploitation (as detailed in Atlassian\u2019s security advisory).\nINCIDENT RESPONSE\nOrganizations are encouraged to review all affected Confluence instances for evidence of compromise, as outlined by Atlassian.[1] If compromise is suspected or detected, organizations should assume that threat actors hold full administrative access and can perform any number of unfettered actions\u2014these include but are not limited to exfiltration of content and system credentials, as well as installation of malicious plugins.\nIf a potential compromise is detected, organizations should:\n\nCollect and review artifacts such as running processes/services, unusual authentications, and recent network connections.\n\nNote: Upgrading to fixed versions, as well as removing malicious administrator accounts may not fully mitigate risk considering threat actors may have established additional persistence mechanisms.\nSearch and audit logs from Confluence servers for attempted exploitation.[2]\n\n\nQuarantine and take offline potentially affected hosts.\nProvision new account credentials.\nReimage compromised hosts.\nReport the compromise to CISA via CISA\u2019s 24/7 Operations Center (report@cisa.gov or 888-282-0870). The FBI encourages recipients of this document to report information concerning suspicious or criminal activity to their local FBI field office or IC3.gov. State, local, tribal, and territorial governments should report incidents to the MS-ISAC (SOC@cisecurity.org or 866-787-4722).\n\nMITIGATIONS\nThese mitigations apply to all organizations using non-cloud Atlassian Confluence Data Center and Server software. CISA, FBI, and MS-ISAC recommend that software manufacturers incorporate secure by design and default principles and tactics into their software development practices to reduce the prevalence of Broken Access Control vulnerabilities, thus strengthening the secure posture for their customers.\nFor more information on secure by design, see CISA\u2019s Secure by Design and Default webpage and joint guide.\nAs of October 10, 2023, proof-of-concept exploits for CVE-2023-22515 have been observed in open source publications.[5] While there are immediate concerns such as increased risk of exploitation and the potential integration into malware toolkits, the availability of a proof-of-concept presents an array of security and operational challenges that extend beyond these immediate issues. Immediate action is strongly advised to address the potential risks associated with this development.\nCISA, FBI, and MS-ISAC recommend taking immediate action to address the potential associated risks and encourage organizations to:\n\nImmediately upgrade to fixed versions. See Atlassian\u2019s upgrading instructions[6] for more information. If unable to immediately apply upgrades, restrict untrusted network access until feasible. Malicious cyber threat actors who exploit the affected instance can escalate to administrative privileges.\nFollow best cybersecurity practices in your production and enterprise environments. While not observed in this instance of exploitation, mandating phishing-resistant multifactor authentication (MFA) for all staff and services can make it more difficult for threat actors to gain access to networks and information systems. For additional best practices, see:\n\nCISA\u2019s Cross-Sector Cybersecurity Performance Goals (CPGs). The CPGs, developed by CISA and the National Institute of Standards and Technology (NIST), are a prioritized subset of IT and OT security practices that can meaningfully reduce the likelihood and impact of known cyber risks and common tactics, techniques, and procedures (TTPs). Because the CPGs are a subset of best practices, CISA recommends software manufacturers implement a comprehensive information security program based on a recognized framework, such as the NIST Cybersecurity Framework (CSF).\nCenter for Internet Security\u2019s (CIS) Critical Security Controls. The CIS Critical Security Controls are a prescriptive, prioritized, and simplified set of best practices that organizations can use to strengthen cybersecurity posture and protect against cyber incidents.\n\n\n\nRESOURCES\n\nNIST: CVE-2023-22515\nMITRE: CWE-20 - Improper Input Validation\nCISA: Known Exploited Vulnerabilities Catalog\nMITRE Software: Rclone\nCISA: Secure by Design and Default\nCISA: Phishing-Resistant MFA\nCISA: Cross-Sector Cybersecurity Performance Goals\nCIS: Critical Security Controls\n\nREFERENCES\n[1]\u00a0 \u00a0Atlassian: CVE-2023-22515 - Broken Access Control Vulnerability in Confluence Data Center and Server[2]\u00a0 \u00a0Rapid7: CVE-2023-22515 Analysis[3]\u00a0 \u00a0Microsoft: CVE-2023-22515 Exploit IP Addresses[4]\u00a0 \u00a0Proofpoint: Emerging Threats Rulesets[5]\u00a0 \u00a0Confluence CVE-2023-22515 Proof of Concept - vulhub[6]\u00a0\u00a0 Atlassian Support: Upgrading Confluence\nDISCLAIMER\nThe information in this report is being provided \u201cas is\u201d for informational purposes only. CISA, FBI, and MS-ISAC do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by CISA, FBI, and MS-ISAC.\nVERSION HISTORY\nOctober 16, 2023: Initial version.\n",
  "cves": [
    "CVE-2023-22515"
  ],
  "techniques": [],
  "advisory": "aa23-289a",
  "title": "Threat Actors Exploit Atlassian Confluence CVE-2023-22515 for Initial Access to Networks | CISA",
  "source": "cybersecurity-advisories",
  "id": "151408abd86a218a405a1b0688335172c36324b5deba6aab8ab021d2f86e2f94"
}