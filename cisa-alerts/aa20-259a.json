{"markdown": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Iran\\-Based Threat Actor Exploits VPN Vulnerabilities \\| CISA\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[Skip to main content](#main) \n\n\n\n\n\n\n\n\n\n\n\n\n![U.S. flag](/profiles/cisad8_gov/themes/custom/gesso/dist/images/us_flag_small.png)\n\n\n\n An official website of the United States government\n \n\n\n\n Here\u2019s how you know\n \n\n\n\n\n\n Here\u2019s how you know\n \n\n\n\n\n\n\n![Dot gov](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-dot-gov.svg)\n\n\n**Official websites use .gov** \n  \n\n A\n **.gov** \n website belongs to an official government organization in the United States.\n \n\n\n\n\n\n![HTTPS](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-https.svg)\n\n\n**Secure .gov websites use HTTPS** \n  \n\n A\n **lock** \n (\n \n\n\n Lock\n \n\n A locked padlock\n \n\n\n\n\n ) or\n **https://** \n means you\u2019ve safely connected to the .gov website. Share sensitive information only on official, secure websites.\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools \"Free Cyber Services\") \n[\\#protect2024](/protect2024) \n[Secure Our World](/node/18883) \n[Shields Up](/node/8056) \n[Report A Cyber Issue](/node/16591) \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[![CISA Logo Americas Cyber Defense Agency](/sites/default/files/images/SVG/header_logo_tagline_update.svg)](/)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[![CISA Logo](/sites/default/files/images/SVG/mobile_logo_wordmark.svg)](/)\n\n\n\n\n\n\n\n\n\n\n Search\n \n\n\n\n\n\n\n\n\n\n Menu\n \n\n\n\n\n\n\n\n\n\n\n\n\n![America's Cyber Defense Agency](/sites/default/files/images/SVG/header_tagline_mobile_update.svg)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Close\n \n\n\n\n\n* Topics\n \n\n\n\n[Topics](/topics) \n\n\n\n\n[Cybersecurity Best Practices](/topics/cybersecurity-best-practices)\n\n\n\n\n[Cyber Threats and Advisories](/topics/cyber-threats-and-advisories)\n\n\n\n\n[Critical Infrastructure Security and Resilience](/topics/critical-infrastructure-security-and-resilience)\n\n\n\n\n[Election Security](/topics/election-security)\n\n\n\n\n[Emergency Communications](/topics/emergency-communications)\n\n\n\n\n[Industrial Control Systems](/topics/industrial-control-systems)\n\n\n\n\n[Information and Communications Technology Supply Chain Security](/topics/information-communications-technology-supply-chain-security)\n\n\n\n\n[Partnerships and Collaboration](/topics/partnerships-and-collaboration)\n\n\n\n\n[Physical Security](/topics/physical-security)\n\n\n\n\n[Risk Management](/topics/risk-management)\n\n\n\n\n\n[How can we help?](/audiences) \n\n\n[Government](/topics/government) \n[Educational Institutions](/topics/educational-institutions) \n[Industry](/topics/industry) \n[State, Local, Tribal, and Territorial](/topics/state-local-tribal-and-territorial) \n[Individuals and Families](/topics/individuals-and-families) \n[Small and Medium Businesses](/topics/small-and-medium-businesses) \n[Find Help Locally](/audiences/find-help-locally) \n[Faith\\-Based Community](/audiences/faith-based-community) \n[Executives](/audiences/executives) \n[High\\-Risk Communities](/audiences/high-risk-communities)\n* [Spotlight](/spotlight)\n* Resources \\& Tools\n \n\n\n\n[Resources \\& Tools](/resources-tools) \n\n\n\n\n[All Resources \\& Tools](/resources-tools/all-resources-tools)\n\n\n\n\n[Services](/resources-tools/services)\n\n\n\n\n[Programs](/resources-tools/programs)\n\n\n\n\n[Resources](/resources-tools/resources)\n\n\n\n\n[Training](/resources-tools/training)\n\n\n\n\n[Groups](/resources-tools/groups)\n* News \\& Events\n \n\n\n\n[News \\& Events](/news-events) \n\n\n\n\n[News](/news-events/news)\n\n\n\n\n[Events](/news-events/events)\n\n\n\n\n[Cybersecurity Alerts \\& Advisories](/news-events/cybersecurity-advisories)\n\n\n\n\n[Directives](/news-events/directives)\n\n\n\n\n[Request a CISA Speaker](/news-events/request-speaker)\n\n\n\n\n[Congressional Testimony](/news-events/congressional-testimony)\n\n\n\n\n[CISA Conferences](/cisa-conferences)\n\n\n\n\n[CISA Live!](/cisa-live)\n* Careers\n \n\n\n\n[Careers](/careers) \n\n\n\n\n[Benefits \\& Perks](/careers/benefits-perks)\n\n\n\n\n[HireVue Applicant Reasonable Accommodations Process](/careers/hirevue-applicant-reasonable-accommodations-process)\n\n\n\n\n[Hiring](/general-recruitment-and-hiring-faqs)\n\n\n\n\n[Resume \\& Application Tips](/careers/resume-application-tips)\n\n\n\n\n[Students \\& Recent Graduates](/students-recent-graduates-employment-opportunities)\n\n\n\n\n[Veteran and Military Spouses](/careers/veteran-and-military-spouse-employment-opportunities)\n\n\n\n\n[Work @ CISA](/careers/work-cisa)\n* About\n \n\n\n\n[About](/about) \n\n\n\n\n[Culture](/about/culture)\n\n\n\n\n[Divisions \\& Offices](/about/divisions-offices)\n\n\n\n\n[Regions](/about/regions)\n\n\n\n\n[Leadership](/about/leadership)\n\n\n\n\n[Doing Business with CISA](/doing-business-cisa)\n\n\n\n\n[Site Links](/site-links)\n\n\n\n\n[Reporting Employee and Contractor Misconduct](/reporting-employee-and-contractor-misconduct)\n\n\n\n\n[CISA GitHub](/cisa-github)\n\n\n\n\n[CISA Central](/cisa-central)\n\n\n\n\n[2023 Year In Review](/about/2023YIR)\n\n\n\n\n[Contact Us](/about/contact-us)\n\n\n\n\n\n\n\n\n\n[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools \"Free Cyber Services\") \n[\\#protect2024](/protect2024) \n[Secure Our World](/node/18883) \n[Shields Up](/node/8056) \n[Report A Cyber Issue](/node/16591) \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Breadcrumb\n \n1. [Home](/)\n2. [News \\& Events](/news-events)\n3. [Cybersecurity Advisories](/news-events/cybersecurity-advisories)\n4. [Cybersecurity Advisory](/news-events/cybersecurity-advisories?f%5B0%5D=advisory_type%3A94)\n\n\n\n\n\n\n\n\n Share:\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Cybersecurity Advisory\n \nIran\\-Based Threat Actor Exploits VPN Vulnerabilities\n=====================================================\n\n\n\n\n\n Last Revised\n \n\n\n September 15, 2020\n \n\n\n\n\n Alert Code\n \n\n AA20\\-259A\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n### Summary\n\n\n\n\n*This Alert uses the MITRE Adversarial Tactics, Techniques, and Common Knowledge (ATT\\&CK\u00ae) framework. See the\n [ATT\\&CK for Enterprise](https://attack.mitre.org/matrices/enterprise/) \n framework for all referenced threat actor techniques.* \n\n\n\n\n This product was written by the Cybersecurity and Infrastructure Security Agency (CISA) with contributions from the Federal Bureau of Investigation (FBI). CISA and FBI are aware of an Iran\\-based malicious cyber actor targeting several U.S. federal agencies and other U.S.\\-based networks. Analysis of the threat actor\u2019s indicators of compromise (IOCs) and tactics, techniques, and procedures (TTPs) indicates a correlation with the group known by the names, Pioneer Kitten and UNC757\\. This threat actor has been observed exploiting several publicly known Common Vulnerabilities and Exposures (CVEs) dealing with Pulse Secure virtual private network (VPN), Citrix NetScaler, and F5 vulnerabilities. This threat actor used these vulnerabilities to gain initial access to targeted networks and then maintained access within the successfully exploited networks for several months using multiple means of persistence.\n \n\n\n\n This Advisory provides the threat actor\u2019s TTPs, IOCs, and exploited CVEs to help administrators and network defenders identify a potential compromise of their network and protect their organization from future attacks.\n \n\n\n\n[Click here](https://us-cert.cisa.gov/sites/default/files/publications/AA20-259A-Iran-Based_Threat_Actor_Exploits_VPN_Vulnerabilities_S508C.pdf) \n for a PDF version of this report.\n \n\n\n\n### Technical Details\n\n\n\n\n CISA and FBI are aware of a widespread campaign from an Iran\\-based malicious cyber actor targeting several industries mainly associated with information technology, government, healthcare, financial, insurance, and media sectors across the United States. The threat actor conducts mass\\-scanning and uses tools, such as Nmap, to identify open ports. Once the open ports are identified, the threat actor exploits CVEs related to VPN infrastructure to gain initial access to a targeted network. CISA and the FBI have observed the threat actor exploiting multiple CVEs, including CVE\\-2019\\-11510, CVE\\-2019\\-11539, CVE\\-2019\\-19781, and CVE\\-2020\\-5902\\.\n \n\n\n\n After gaining initial access to a targeted network, the threat actor obtains administrator\\-level credentials and installs web shells allowing further entrenchment. After establishing a foothold, the threat actor\u2019s goals appear to be maintaining persistence and exfiltrating data. This threat actor has been observed selling access to compromised network infrastructure in an online hacker forum. Industry reporting indicates that the threat actor operates as a contractor supporting Iranian government interests, but the malicious activity appears to also serve the threat actor\u2019s own financial interests. The FBI notes this threat actor has the capability, and likely the intent, to deploy ransomware on victim networks.\n \n\n\n\n CISA and FBI have observed this Iran\\-based threat actor relying on exploits of remote external services on internet\\-facing assets to gain initial access to victim networks. The threat actor also relies heavily on open\\-source and operating system (OS) tooling to conduct operations, such as ngrok; fast reverse proxy (FRP); Lightweight Directory Access Protocol (LDAP) directory browser; as well as web shells known as ChunkyTuna, Tiny, and China Chopper.\n \n\n\n\n Table 1 illustrates some of the common tools this threat actor has used.\n \n\n\n\n*Table 1: Common exploit tools* \n\n\n\n\n\n| Tool | Detail |\n| --- | --- |\n| ChunkyTuna web shell | ChunkyTuna allows for chunked transfer encoding hypertext transfer protocol (HTTP) that tunnels Transmission Control Protocol (TCP) streams over HTTP. The web shell allows for reverse connections to a server with the intent to exfiltrate data. |\n| Tiny web shell | Tiny uses Hypertext Preprocessor (PHP) to create a backdoor. It has the capability to allow a threat actor remote access to the system and can also tunnel or route traffic. |\n| China Chopper web shell | China Chopper is a web shell hosted on a web server and is mainly used for web application attacks; it is configured in a client/server relationship. China Chopper contains security scanners and can be used to upload files and brute\\-force passwords. |\n| FRPC | FRPC is a modified version of the open\\-source FRP tool. It allows a system\u2014inside a router or firewall providing Network Address Translation\u2014to provide network access to systems/operators located outside of the victim network. In this case, FRPC was used as reverse proxy, tunneling Remote Desktop Protocol (RDP) over Transport Layer Security (TLS), giving the threat actor primary persistence. |\n| Chisel | Chisel is a fast TCP tunnel over HTTP and secured via Secure Shell (SSH). It is a single executable that includes both client and server. The tool is useful for passing through firewalls, but it can also be used to provide a secure form of communication to an endpoint on a victim network. |\n| ngrok | ngrok is a tool used to expose a local port to the internet. Optionally, tunnels can be secured with TLS. |\n| Nmap | Nmap is used for vulnerability scanning and network discovery. |\n| Angry IP Scanner | Angry IP Scanner is a scanner that can ping a range of Internet Protocol (IP) addresses to check if they are active and can also resolve hostnames, scan ports, etc. |\n| Drupwn | Drupwn is a Python\\-based tool used to scan for vulnerabilities and exploit CVEs in Drupal devices. |\n\n\n\n  \n\n  \n\n Notable means of detecting this threat actor:\n \n\n\n* CISA and the FBI note that this group makes significant use of ngrok, which may appear as TCP port 443 connections to external cloud\\-based infrastructure.\n* The threat actor uses FRPC over port 7557\\.\n* [Malware Analysis Report MAR\\-10297887\\-1\\.v1](https://us-cert.cisa.gov/ncas/analysis-reports/ar20-259a) \n details some of the tools this threat actor used against some victims.\n\n\n\n The following file paths can be used to detect Tiny web shell, ChunkyTuna web shell, or Chisel if a network has been compromised by this attacker exploiting CVE\\-2019\\-19781\\.\n \n\n\n* Tiny web shell\n\n\n\n`/netscaler/ns_gui/admin_ui/rdx/core/css/images/css.php\n   \n\n  \n\n /netscaler/ns_gui/vpn/images/vpn_ns_gui.php\n   \n\n  \n\n /var/vpn/themes/imgs/tiny.php` \n\n\n\n* ChunkyTuna web shell\n\n\n\n`/var/vpn/themes/imgs/debug.php\n   \n\n  \n\n /var/vpn/themes/imgs/include.php\n   \n\n  \n\n /var/vpn/themes/imgs/whatfile` \n\n\n\n* Chisel\n\n\n\n`/var/nstmp/chisel` \n\n\n\n### MITRE ATT\\&CK Framework\n\n\n#### Initial Access\n\n\n\n As indicated in table 2, the threat actor primarily gained initial access by using the publicly available exploit for CVE\\-2019\\-19781\\. From there, the threat actor used the Citrix environment to establish a presence on an internal network server.\n \n\n\n\n*Table 2: Initial access techniques* \n\n\n\n\n\n| ID | Technique/Sub\\-Technique | Context |\n| --- | --- | --- |\n| [T1190](https://attack.mitre.org/techniques/T1190/) | Exploit Public\\-Facing Application | The threat actor primarily gained initial access by compromising a Citrix NetScaler remote access server using a publicly available exploit for CVE\\-2019\\-19781\\. The threat actor also exploited CVE\\-2019\\-11510, CVE\\-2019\\-11539, and CVE\\-2020\\-5902\\. |\n\n\n#### Execution\n\n\n\n After gaining initial access, the threat actor began executing scripts, as shown in table 3\\.\n \n\n\n\n*Table 3: Execution techniques* \n\n\n\n\n\n| ID | Technique/Sub\\-Technique | Context |\n| --- | --- | --- |\n| [T1059\\.001](https://attack.mitre.org/techniques/T1059/001/) | Command and Scripting Interpreter: PowerShell | A PowerShell script (  `keethief`   and  `kee.ps1`   ) was used to access KeePass data. |\n| [T1059\\.003](https://attack.mitre.org/techniques/T1059/003/) | Command and Scripting Interpreter: Windows Command Shell | `cmd.exe`   was launched via sticky keys that was likely used as a password changing mechanism. |\n\n\n#### Persistence\n\n\n\n CISA observed the threat actor using the techniques identified in table 4 to establish persistence.\n \n\n\n\n*Table 4: Persistence techniques* \n\n\n\n\n\n| ID | Technique/Sub\\-Technique | Context |\n| --- | --- | --- |\n| [T1053\\.003](https://attack.mitre.org/techniques/T1053/003/) | Scheduled Task/Job: Cron | The threat actor loaded a series of scripts to  `cron`   and ran them for various purposes (mainly to access NetScaler web forms). |\n| [T1053\\.005](https://attack.mitre.org/techniques/T1053/005/) | Scheduled Task/Job: Scheduled Task | The threat actor installed and used FRPC (  `frpc.exe`   ) on both NetScaler and internal devices. The task was named  `lpupdate`   and the binary was named  `svchost`   , which was the reverse proxy. The threat actor executed this command daily. |\n| [T1505\\.003](https://attack.mitre.org/techniques/T1505/003/) | Server Software Component: Web Shell | The threat actor used several web shells on existing web servers. Both NetScaler and web servers called out for ChunkyTuna. |\n| [T1546\\.008](https://attack.mitre.org/techniques/T1546/008/) | Event Triggered Execution: Accessibility Features | The threat actor used sticky keys (  `sethc.exe`   ) to launch  `cmd.exe`   . |\n\n\n#### Privilege Escalation\n\n\n\n CISA observed no evidence of direct privilege escalation. The threat actor attained domain administrator credentials on the NetScaler device via exploit and continued to expand credential access on the network.\n \n\n\n#### Defense Evasion\n\n\n\n CISA observed the threat actor using the techniques identified in table 5 to evade detection.\n \n\n\n\n*Table 5: Defensive evasion techniques* \n\n\n\n\n\n| ID | Technique/Sub\\-Technique | Context |\n| --- | --- | --- |\n| [T1027\\.002](https://attack.mitre.org/techniques/T1027/002/) | Obfuscated Files or Information: Software Packing | The threat actor used base64 encoding for payloads on NetScaler during initial access, making the pre\\-compiled payloads easier to avoid detection. |\n| [T1027\\.004](https://attack.mitre.org/techniques/T1036/004/) | Obfuscated Files or Information: Compile After Delivery | The threat actor used base64 encoding schemes on distributed (uncompiled) scripts and files to avoid detection. |\n| [T1036\\.004](https://attack.mitre.org/techniques/T1245/) | Masquerading: Masquerade Task or Service | The threat actor used FRPC (  `frpc.exe`   ) daily as reverse proxy, tunneling RDP over TLS. The FRPC (  `frpc.exe`   ) task name was  `lpupdate`   and ran out of Input Method Editor (IME) directory. In other events, the threat actor has been observed hiding activity via ngrok. |\n| [T1036\\.005](https://attack.mitre.org/techniques/T1036/005/) | Masquerading: Match Legitimate Name or Location | The FRPC (  `frpc.exe`   ) binary name was  `svchost`   , and the configuration file was  `dllhost.dll`   , attempting to masquerade as a legitimate Dynamic Link Library. |\n| [T1070\\.004](https://attack.mitre.org/techniques/T1070/004/) | Indicator Removal on Host: File Deletion | To minimize their footprint, the threat actor ran  `./httpd-nscache_clean`   every 30 minutes, which cleaned up files on the NetScaler device. |\n\n\n#### Credential Access\n\n\n\n CISA observed the threat actor using the techniques identified in table 6 to further their credential access.\n \n\n\n\n*Table 6: Credential access techniques* \n\n\n\n\n\n| ID | Technique/Sub\\-Technique | Context |\n| --- | --- | --- |\n| [T1003\\.001](https://attack.mitre.org/techniques/T1003/001/) | OS Credential Dumping: LSASS Memory | The threat actor used  `procdump`   to dump process memory from the Local Security Authority Subsystem Service (LSASS). |\n| [T1003\\.003](https://attack.mitre.org/techniques/T1003/003/) | OS Credential Dumping: Windows NT Directory Services (NTDS) | The threat actor used Volume Shadow Copy to access credential information from the NTDS file. |\n| [T1552\\.001](https://attack.mitre.org/techniques/T1552/001/) | Unsecured Credentials: Credentials in Files | The threat actor accessed files containing valid credentials. |\n| [T1555](https://attack.mitre.org/techniques/T1555/) | Credentials from Password Stores | The threat actor accessed a  `KeePass`   database multiple times and used  `kee.ps1`   PowerShell script. |\n| [T1558](https://attack.mitre.org/techniques/T1558/) | Steal or Forge Kerberos Tickets | The threat actor conducted a directory traversal attack by creating files and exfiltrating a Kerberos ticket on a NetScaler device. The threat actor was then able to gain access to a domain account. |\n\n\n#### Discovery\n\n\n\n CISA observed the threat actor using the techniques identified in table 7 to learn more about the victim environments.\n \n\n\n\n*Table 7: Discovery techniques* \n\n\n\n\n\n| ID | Technique/Sub\\-Technique | Context |\n| --- | --- | --- |\n| [T1018](https://attack.mitre.org/techniques/T1018/) | Remote System Discovery | The threat actor used Angry IP Scanner to detect remote systems. |\n| [T1083](https://attack.mitre.org/techniques/T1083/) | File and Directory Discovery | The threat actor used WizTree to obtain network files and directory listings. |\n| [T1087](https://attack.mitre.org/techniques/T1087/) | Account Discovery | The threat actor accessed  `ntuser.dat`   and  `UserClass.dat`   and used Softerra LDAP Browser to browse documentation for service accounts. |\n| [T1217](https://attack.mitre.org/techniques/T1217/) | Browser Bookmark Discovery | The threat actor used Google Chrome bookmarks to find internal resources and assets. |\n\n\n#### Lateral Movement\n\n\n\n CISA also observed the threat actor using open\\-source tools such as Plink and TightVNC for lateral movement. CISA observed the threat actor using the techniques identified in table 8 for lateral movement within the victim environment.\n \n\n\n\n*Table 8: Lateral movement techniques* \n\n\n\n\n\n| ID | Technique/Sub\\-Technique | Context |\n| --- | --- | --- |\n| [T1021](https://attack.mitre.org/techniques/T1021/) | Remote Services | The threat actor used RDP with valid account credentials for lateral movement in the environment. |\n| [T1021\\.001](https://attack.mitre.org/techniques/T1021/001/) | Remote Services: Remote Desktop Protocol | The threat actor used RDP to log in and then conduct lateral movement. |\n| [T1021\\.002](https://attack.mitre.org/techniques/T1021/002/) | Remote Services: SMB/Windows Admin Shares | The threat actor used PsExec. and PSEXECSVC pervasively on several hosts. The threat actor was also observed using a valid account to access SMB shares. |\n| [T1021\\.004](https://attack.mitre.org/techniques/T1021/004/) | Remote Services: SSH | The threat actor used Plink and PuTTY for lateral movement. Artifacts of Plink were used for encrypted sessions in the system registry hive. |\n| [T1021\\.005](https://attack.mitre.org/techniques/T1021/005/) | Remote Services: Virtual Network Computing (VNC) | The threat actor installed TightVNC server and client pervasively on compromised servers and endpoints in the network environment as lateral movement tool. |\n| [T1563\\.002](https://attack.mitre.org/techniques/T1563/002/) | Remote Service Session Hijacking: RDP Hijacking | The threat actor likely hijacked a legitimate RDP session to move laterally within the network environment. |\n\n\n#### Collection\n\n\n\n CISA observed the threat actor using the techniques identified in table 9 for collection within the victim environment.\n \n\n\n\n*Table 9: Collection techniques* \n\n\n\n\n\n| ID | Technique/Sub\\-Technique | Context |\n| --- | --- | --- |\n| [T1005](https://attack.mitre.org/techniques/T1005/) | Data from Local System | The threat actor searched local system sources to accessed sensitive documents. |\n| [T1039](https://attack.mitre.org/techniques/T1039/) | Data from Network Shared Drive | The threat actor searched network shares to access sensitive documents. |\n| [T1213](https://attack.mitre.org/techniques/T1213/) | Data from Information Repositories | The threat actor accessed victim security/IT monitoring environments, Microsoft Teams, etc., to mine valuable information. |\n| [T1530](https://attack.mitre.org/techniques/T1530/) | Data from Cloud Storage Object | The threat actor obtained files from the victim cloud storage instances. |\n| [T1560\\.001](https://attack.mitre.org/techniques/T1560/001/) | Archive Collected Data: Archive via Utility | The threat actor used 7\\-Zip to archive data. |\n\n\n#### Command and Control\n\n\n\n CISA observed the threat actor using the techniques identified in table 10 for command and control (C2\\).\n \n\n\n\n*Table 10: Command and control techniques* \n\n\n\n\n\n| ID | Technique/Sub\\-Technique | Context |\n| --- | --- | --- |\n| [T1071\\.001](https://attack.mitre.org/techniques/T1071/001/) | Application Layer Protocol: Web Protocols | The threat actor used various web mechanisms and protocols, including the web shells listed in table 1\\. |\n| [T1105](https://attack.mitre.org/techniques/T1105/) | Ingress Tool Transfer | The threat actor downloaded tools such as PsExec directly to endpoints and downloaded web shells and scripts to NetScaler in base64\\-encoded schemes. |\n| [T1572](https://attack.mitre.org/techniques/T1572/) | Protocol Tunneling | The threat actor used  `FRPC.exe`   to tunnel RDP over port 443\\. The threat actor has also been observed using ngrok for tunneling. |\n\n\n#### Exfiltration\n\n\n\n CISA currently has no evidence of data exfiltration from this threat actor but assesses that it was likely due to the use of 7\\-Zip and viewing of sensitive documents.\n \n\n\n\n### Mitigations\n\n\n\n#### Recommendations\n\n\n\n CISA and FBI recommend implementing the following recommendations.\n \n\n\n* If your organization has not patched for the Citrix CVE\\-2019\\-19781 vulnerability, and a compromise is suspected, follow the recommendations in CISA Alert\n [AA20\\-031A](https://us-cert.cisa.gov/ncas/alerts/aa20-031a) \n .\n* This threat actor has been observed targeting other CVEs mentioned in this report; follow the recommendations in the CISA resources provided below.\n* If using Windows Active Directory and compromise is suspected, conduct remediation of the compromised Windows Active Directory forest.\n\t+ If compromised, rebuild/reimage compromised NetScaler devices.\n* Routinely audit configuration and patch management programs.\n* Monitor network traffic for unexpected and unapproved protocols, especially outbound to the internet (e.g., SSH, SMB, RDP).\n* Implement multi\\-factor authentication, especially for privileged accounts.\n* Use separate administrative accounts on separate administration workstations.\n* Implement the principle of least privilege on data access.\n* Secure RDP and other remote access solutions using multifactor authentication and \u201cjump boxes\u201d for access.\n* Deploy endpoint defense tools on all endpoints; ensure they work and are up to date.\n* Keep software up to date.\n\n\n\n### Contact Information\n\n\n\n\n To report suspicious or criminal activity related to information found in this Joint Cybersecurity Advisory, contact your local FBI field office at\n [www.fbi.gov/contact\\-us/field](https://www.fbi.gov/contact-us/field-offices) \n , or the FBI\u2019s 24/7 Cyber Watch (CyWatch) at (855\\) 292\\-3937 or by e\\-mail at\n [CyWatch@fbi.gov](mailto:%20CyWatch@fbi.gov) \n . When available, please include the following information regarding the incident: date, time, and location of the incident; type of activity; number of people affected; type of equipment used for the activity; the name of the submitting company or organization; and a designated point of contact. To request incident response resources or technical assistance related to these threats, contact CISA at\n [central@cisa.dhs.gov](mailto:%20Central@cisa.dhs.gov) \n .\n \n\n\n### Resources\n\n\n\n[CISA Alert AA20\\-031A: Detecting Citrix CVE\\-2019\\-19781](https://us-cert.cisa.gov/ncas/alerts/aa20-031a) \n  \n\n  \n\n[CISA Alert AA20\\-073A: Enterprise VPN Security](https://us-cert.cisa.gov/ncas/alerts/aa20-073a) \n  \n\n  \n\n[CISA Alert AA20\\-107A: Continued Threat Actor Exploitation Post Pulse Secure VPN Patching](https://us-cert.cisa.gov/ncas/alerts/aa20-107a) \n  \n\n  \n\n[CISA Alert AA20\\-206A: Threat Actor Exploitation of F5 BIG\\-IP CVE\\-2020\\-5902](https://us-cert.cisa.gov/ncas/alerts/aa20-206a) \n  \n\n  \n\n[CISA Security Tip: Securing Network Infrastructure Devices](https://us-cert.cisa.gov/ncas/tips/ST18-001) \n\n\n\n\n### Revisions\n\n\n\n\n September 15, 2020: Initial Version\n \n\n\n\n\n\n\n\n\n\n\n This product is provided subject to this\n [Notification](/notification \"Follow link\") \n and this\n [Privacy \\& Use](/privacy-policy \"Follow link\") \n policy.\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPlease share your thoughts\n--------------------------\n\n\n\n We recently updated our anonymous\n [product survey](https://www.surveymonkey.com/r/CISA-cyber-survey?product=https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-259a) \n ; we\u2019d welcome your feedback.\n \n\n\n\n\n\n\n\n\n\n\n\n\nRelated Advisories\n------------------\n\n\n\n\n\n\n\n\n\n\n Jul 11, 2024\n \n\n\n Cybersecurity Advisory \\| AA24\\-193A\n \n\n### [CISA Red Team\u2019s Operations Against a Federal Civilian Executive Branch Organization Highlights the Necessity of Defense\\-in\\-Depth](/news-events/cybersecurity-advisories/aa24-193a)\n\n\n\n\n\n\n\n\n\n\n\n Jul 08, 2024\n \n\n\n Cybersecurity Advisory \\| AA24\\-190A\n \n\n### [People\u2019s Republic of China (PRC) Ministry of State Security APT40 Tradecraft in Action](/news-events/cybersecurity-advisories/aa24-190a)\n\n\n\n\n\n\n\n\n\n\n\n May 10, 2024\n \n\n\n Cybersecurity Advisory \\| AA24\\-131A\n \n\n### [\\#StopRansomware: Black Basta](/news-events/cybersecurity-advisories/aa24-131a)\n\n\n\n\n\n\n\n\n\n\n\n Apr 18, 2024\n \n\n\n Cybersecurity Advisory \\| AA24\\-109A\n \n\n### [\\#StopRansomware: Akira Ransomware](/news-events/cybersecurity-advisories/aa24-109a)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[Return to top](#) \n\n\n\n\n* [Topics](/topics)\n* [Spotlight](/spotlight)\n* [Resources \\& Tools](/resources-tools)\n* [News \\& Events](/news-events)\n* [Careers](/careers)\n* [About](/about)\n\n\n\n\n\n\n\n\n[Cybersecurity \\& Infrastructure Security Agency](/ \"Go to the Cybersecurity & Infrastructure Security Agency homepage\")\n\n\n* [Facebook](https://www.facebook.com/CISA)\n* [Twitter](https://twitter.com/CISAgov)\n* [LinkedIn](https://www.linkedin.com/company/cybersecurity-and-infrastructure-security-agency)\n* [YouTube](https://www.youtube.com/@cisagov)\n* [Instagram](https://www.instagram.com/cisagov)\n* [RSS](/subscribe-updates-cisa)\n\n\n\n\n CISA Central\n \n[1\\-844\\-Say\\-CISA](tel:1-844-Say-CISA) \n[SayCISA@cisa.gov](mailto:SayCISA@cisa.gov) \n\n\n\n\n\n\n\n\n\n\n\n DHS Seal\n \n\n\n CISA.gov\n \n\n An official website of the U.S. Department of Homeland Security\n \n\n\n* [About CISA](/about \"About CISA\")\n* [Budget and Performance](https://www.dhs.gov/performance-financial-reports \"Budget and Performance\")\n* [DHS.gov](https://www.dhs.gov \"Department of Homeland Security\")\n* [Equal Opportunity \\& Accessibility](/oedia \"Equal Opportunity & Accessibility\")\n* [FOIA Requests](https://www.dhs.gov/foia \"FOIA Requests\")\n* [No FEAR Act](/no-fear-act \"No FEAR Act Reporting\")\n* [Office of Inspector General](https://www.oig.dhs.gov/ \"Office of Inspector General\")\n* [Privacy Policy](/privacy-policy \"Privacy Policy\")\n* [Subscribe](https://public.govdelivery.com/accounts/USDHSCISA/subscriber/new?topic_id=USDHSCISA_138 \"Subscribe to Email Updates\")\n* [The White House](https://www.whitehouse.gov/ \"The White House\")\n* [USA.gov](https://www.usa.gov/ \"USA.gov\")\n* [Website Feedback](/forms/feedback \"Website Feedback\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n", "cves": ["CVE-2019-11510", "CVE-2020-5902", "CVE-2019-19781", "CVE-2019-11539"], "techniques": ["T1036.004", "T1059.003", "T1053.005", "T1036.005", "T1003.001", "T1021.004", "T1021.001", "T1563.002", "T1027.004", "T1505.003", "T1003.003", "T1070.004", "T1059.001", "T1071.001", "T1021.005", "T1560.001", "T1027.002", "T1021.002", "T1053.003", "T1552.001", "T1546.008"], "advisory": "aa20-259a", "title": "Iran-Based Threat Actor Exploits VPN Vulnerabilities | CISA", "source": "cybersecurity-advisories", "id": "709b439fd0bff34b05c2c411fecc27611312120079849a2556f1cdf265d4e808"}