{
  "markdown": "\n\n\n\n\n\u00a0\nNotification\n\nThis report is provided \"as is\" for informational purposes only. The Department of Homeland Security (DHS) does not provide any warranties of any kind regarding any information contained within. DHS does not endorse any commercial product or service, referenced in this bulletin or otherwise.\nThis document is marked TLP:WHITE. Disclosure is not limited. Sources may use TLP:WHITE when information carries minimal or no foreseeable risk of misuse, in accordance with applicable rules and procedures for public release. Subject to standard copyright rules, TLP:WHITE information may be distributed without restriction. For more information on the Traffic Light Protocol, see http://www.us-cert.gov/tlp.\n\nSummary\n\nDescription\nThis submission includes four unique files. The first is an installer for additional malware: a Remote Access Trojan (RAT) and a malicious Dynamic Link Library (DLL) that functions as a Server Message Block (SMB) Worm. The fourth file is another SMB worm in the form of a Windows 32-bit executable.Both SMB worms attempt to spread locally and to random IP addresses on the public Internet by attempting to brute force vulnerable systems using a built-in list of common passwords. The RAT included with the SMB worm provides the attacker with the ability to deliver additional malware, run local commands, and exfiltrate data.As of May 31, 2018, this report has been updated to correct the email addresses used by Wmmvsvc.dll (ea46ed5aed900cd9f01156a1cd446cbb3e10191f9f980e9f710ea1c20440c781).\nFor a downloadable copy of IOCs, see:\n\nMAR-10135536-3.stix\n\nEmails (2)\nmisswang8107@gmail.com\nredhat@gmail.com\nSubmitted Files (4)\n077d9e0e12357d27f7f0c336239e961a7049971446f7a3f10268d9439ef67885 (4731CBAEE7ACA37B596E38690160A7...)\na1c483b0ee740291b91b11e18dd05f0a460127acfc19d47b446d11cd0e26d717 (scardprv.dll)\nea46ed5aed900cd9f01156a1cd446cbb3e10191f9f980e9f710ea1c20440c781 (Wmmvsvc.dll)\nfe7d35d19af5f5ae2939457a06868754b8bdd022e1ff5bdbe4e7c135c48f9a16 (298775B04A166FF4B8FBD3609E7169...)\n\nFindings\n\n077d9e0e12357d27f7f0c336239e961a7049971446f7a3f10268d9439ef67885\nTags\nbackdoortrojanworm\nDetails\n\n\n\nName\n4731CBAEE7ACA37B596E38690160A749\n\n\nSize\n208896 bytes\n\n\nType\nPE32 executable (GUI) Intel 80386, for MS Windows\n\n\nMD5\n4731cbaee7aca37b596e38690160a749\n\n\nSHA1\n80fac6361184a3e24b33f6acb8688a6b7276b0f2\n\n\nSHA256\n077d9e0e12357d27f7f0c336239e961a7049971446f7a3f10268d9439ef67885\n\n\nSHA512\n9fdc1bf087d3e2fa80ff4ed749b11a2b3f863bed7a59850f6330fc1467c38eed052eee0337d2f82f9fe8e145f68199b966ae3c08f7ad1475b665beb8cd29f6d7\n\n\nssdeep\n6144:M6atGpHk4NdSksOBbNUyb4ajb1TWiYW9ebYwtJEGLYMYR4:Msdk4NdSksOv\n\n\nEntropy\n7.731026\n\n\n\nAntivirus\n\n\n\nAVG\nBackDoor.Generic14.ARHX\n\n\nAhnlab\nTrojan/Win32.Npkon\n\n\nAvira\nBDS/Joanap.A.11\n\n\nBitDefender\nGen:Variant.Barys.57573\n\n\nClamAV\nWin.Trojan.Agent-1388737\n\n\nCyren\nW32/Zegost.AA.gen!Eldorado\n\n\nESET\nWin32/Scadprv.A trojan\n\n\nEmsisoft\nGen:Variant.Barys.57573 (B)\n\n\nF-secure\nGen:Variant.Barys.57573\n\n\nFilseclab\nWorm.Agent.age.ebwv\n\n\nIkarus\nWorm.Win32.Agent\n\n\nK7\nBackdoor ( 04c4b9d11 )\n\n\nMcAfee\nW32/FunCash!worm\n\n\nMicrosoft Security Essentials\nBackdoor:Win32/Joanap.J!dha\n\n\nNANOAV\nTrojan.Win32.Agent.crilzb\n\n\nQuick Heal\nBackdoor.Joanap\n\n\nSophos\nMal/EncPk-AGS\n\n\nSymantec\nTrojan.Gen.2\n\n\nSystweak\ntrojan.agent\n\n\nTrendMicro\nBKDR_JOANAP.AC\n\n\nTrendMicro House Call\nBKDR_JOANAP.AC\n\n\nVir.IT eXplorer\nBackdoor.Win32.Generic.ARHX\n\n\nVirusBlokAda\nWorm.Agent\n\n\nZillya!\nWorm.Agent.Win32.3373\n\n\nnProtect\nWorm/W32.Agent.208896.AK\n\n\n\nYara Rules\n\n\n\nhidden_cobra_consolidated.yara\nrule Enfal_Generic { meta: author = \"NCCIC trusted 3rd party\" incident = \"10135536\" date = \"2018-04-12\" category = \"hidden_cobra\" family = \"BRAMBUL,JOANAP\" MD5_1 = \"483B95B1498B615A1481345270BFF87D\" MD5_2 = \"4731CBAEE7ACA37B596E38690160A749\" MD5_3 = \"CD60FD107BAACCAFA6C24C1478C345C8\" MD5_4 = \"298775B04A166FF4B8FBD3609E716945\" Info = \"Detects Hidden Cobra SMB Worm / RAT\" strings: $s0 = {6D737373636172647072762E6178} $s1 = {6E3472626872697138393076393D3032333D30312A2628542D30513332354A314E3B4C4B} $s2 = {72656468617440676D61696C2E636F6D} $s3 = {6D69737377616E673831303740676D61696C2E636F6D} $s4 = {534232755365435632564474} $s5 = {794159334D6559704275415756426341} $s6 = {705641325941774242347A41346167664B6232614F7A4259} $s7 = {AE8591916D586DE4F6FB8EE2F0BBF1F9} $s8 = {F96D5DD36D6D9A87DD6D506D6D6D516D} $s9 = {43616E6E6F74206372656174652072656D6F74652066696C652E} $s10 = {43616E6E6F74206F70656E2072656D6F74652066696C65} $s11 = {663D547D75128D85FCFEFFFF5056} $s12 = {663D547D75128D85FCFEFFFF5056E88C060000E9A9000000663D557D7512} $s13 = {663D567D750F8D85FCFEFFFF5056E891070000EB7C663D577D} $s14 = {3141327A3342347935433678374438773945307624465F754774487349724A71} $s15 = {393032356A6864686F333965686532} condition: ($s0) or ($s1) or ($s2) or ($s3) or ($s4 and $s5 and $s6) or ($s7 and $s8) or ($s9 and $s10 and $s11) or ($s12 and $s13) or ($s14 and $s15) }\n\n\n\nssdeep Matches\nNo matches found.\nPE Metadata\n\n\n\nCompile Date\n2011-09-14 01:53:24-04:00\n\n\nImport Hash\ne8cd12071a8e823ebc434c8ee3e23203\n\n\n\nPE Sections\n\n\n\nMD5\nName\nRaw Size\nEntropy\n\n\nbf69e0e64bdafa28b31e3c2134e1d696\nheader\n4096\n0.658046\n\n\n27f1df91dc992ababc89460f771a6026\n.text\n24576\n6.227301\n\n\n249e10a4ad0a58c3db84eb2f69db5db5\n.rdata\n4096\n4.367702\n\n\n88b5582d4d361c92e9234abf0942ed9e\n.data\n4096\n2.546586\n\n\na18b7869b3bfd4a2ef0d03c96fa09221\n.rsrc\n172032\n7.969250\n\n\n\nPackers/Compilers/Cryptors\n\n\n\nInstaller VISE Custom\n\n\n\nProcess List\n\n\n\nProcess\nPID\nPPID\n\n\n077d9e0e12357d27f7f0c336239e961a7049971446f7a3f10268d9439ef67885.exe\n2628\n(2588)\n\n\n\nRelationships\n\n\n\n077d9e0e12...\nDropped\na1c483b0ee740291b91b11e18dd05f0a460127acfc19d47b446d11cd0e26d717\n\n\n077d9e0e12...\nDropped\nea46ed5aed900cd9f01156a1cd446cbb3e10191f9f980e9f710ea1c20440c781\n\n\n\nDescription\nThis 32-bit Windows executable file drops two malicious applications.The first (a1c483b0ee740291b91b11e18dd05f0a460127acfc19d47b446d11cd0e26d717) is a fully functioning RAT.The second application (ea46ed5aed900cd9f01156a1cd446cbb3e10191f9f980e9f710ea1c20440c781) is a SMB worm that will spread to local subnets and external networks.\n\n\na1c483b0ee740291b91b11e18dd05f0a460127acfc19d47b446d11cd0e26d717\nTags\nbackdoorbottrojanworm\nDetails\n\n\n\nName\nscardprv.dll\n\n\nSize\n77824 bytes\n\n\nType\nPE32 executable (DLL) (GUI) Intel 80386, for MS Windows\n\n\nMD5\n4613f51087f01715bf9132c704aea2c2\n\n\nSHA1\n6b1ddf0e63e04146d68cd33b0e18e668b29035c4\n\n\nSHA256\na1c483b0ee740291b91b11e18dd05f0a460127acfc19d47b446d11cd0e26d717\n\n\nSHA512\n37fa5336d1554557250e4a3bcb4ccfca79f4873264cb161dee340d35a2f8f17f7853fe942809bb343ac1eae0a37122b5e8fd703a9b820ec96abb65c8327c1b6a\n\n\nssdeep\n768:qtT2AxNtcgpqLepcy2y6/chYdP8KuSFM+Cs5CBaho9S4AJKqBz8MZdVsrQVBnVGa:qwONtBqL1dDMrs5CN9S4A3HOYBnVL\n\n\nEntropy\n6.138177\n\n\n\nAntivirus\n\n\n\nAVG\nAgent3.BAPF\n\n\nAhnlab\nTrojan/Win32.Dllbot\n\n\nAvira\nTR/Gendal.6762100\n\n\nBitDefender\nGen:Variant.Graftor.Elzob.3935\n\n\nClamAV\nWin.Trojan.Agent-1388765\n\n\nESET\na variant of Win32/Scadprv.A trojan\n\n\nEmsisoft\nGen:Variant.Graftor.Elzob.3935 (B)\n\n\nF-secure\nGen:Variant.Graftor.Elzob.3935\n\n\nFilseclab\nWorm.Agent.ago.thfj.dll\n\n\nIkarus\nWorm.Win32.Agent\n\n\nK7\nTrojan ( 0001659c1 )\n\n\nMcAfee\nW32/FunCash!worm\n\n\nMicrosoft Security Essentials\nBackdoor:Win32/Joanap.B!dha\n\n\nNANOAV\nTrojan.Win32.Agent.cwccco\n\n\nQuick Heal\nBackdoor.Duzzer.A5\n\n\nSophos\nMal/Generic-L\n\n\nSymantec\nBackdoor.Joanap\n\n\nSystweak\nmalware.gen-20120501\n\n\nTrendMicro\nBKDR_JOANAP.AC\n\n\nTrendMicro House Call\nBKDR_JOANAP.AC\n\n\nVir.IT eXplorer\nTrojan.Win32.Agent3.BAPF\n\n\nVirusBlokAda\nWorm.Agent\n\n\nZillya!\nWorm.Agent.Win32.5702\n\n\nnProtect\nWorm/W32.Agent.77824.CJ\n\n\n\nYara Rules\n\n\n\nhidden_cobra_consolidated.yara\nrule Enfal_Generic { meta: author = \"NCCIC trusted 3rd party\" incident = \"10135536\" date = \"2018-04-12\" category = \"hidden_cobra\" family = \"BRAMBUL,JOANAP\" MD5_1 = \"483B95B1498B615A1481345270BFF87D\" MD5_2 = \"4731CBAEE7ACA37B596E38690160A749\" MD5_3 = \"CD60FD107BAACCAFA6C24C1478C345C8\" MD5_4 = \"298775B04A166FF4B8FBD3609E716945\" Info = \"Detects Hidden Cobra SMB Worm / RAT\" strings: $s0 = {6D737373636172647072762E6178} $s1 = {6E3472626872697138393076393D3032333D30312A2628542D30513332354A314E3B4C4B} $s2 = {72656468617440676D61696C2E636F6D} $s3 = {6D69737377616E673831303740676D61696C2E636F6D} $s4 = {534232755365435632564474} $s5 = {794159334D6559704275415756426341} $s6 = {705641325941774242347A41346167664B6232614F7A4259} $s7 = {AE8591916D586DE4F6FB8EE2F0BBF1F9} $s8 = {F96D5DD36D6D9A87DD6D506D6D6D516D} $s9 = {43616E6E6F74206372656174652072656D6F74652066696C652E} $s10 = {43616E6E6F74206F70656E2072656D6F74652066696C65} $s11 = {663D547D75128D85FCFEFFFF5056} $s12 = {663D547D75128D85FCFEFFFF5056E88C060000E9A9000000663D557D7512} $s13 = {663D567D750F8D85FCFEFFFF5056E891070000EB7C663D577D} $s14 = {3141327A3342347935433678374438773945307624465F754774487349724A71} $s15 = {393032356A6864686F333965686532} condition: ($s0) or ($s1) or ($s2) or ($s3) or ($s4 and $s5 and $s6) or ($s7 and $s8) or ($s9 and $s10 and $s11) or ($s12 and $s13) or ($s14 and $s15) }\n\n\n\nssdeep Matches\nNo matches found.\nPE Metadata\n\n\n\nCompile Date\n2011-09-14 01:38:38-04:00\n\n\nImport Hash\nf6f7b2e00921129d18061822197111cd\n\n\n\nPE Sections\n\n\n\nMD5\nName\nRaw Size\nEntropy\n\n\nc745765d5ae0458d76c721b8a82eca52\nheader\n4096\n0.763991\n\n\nf16ff24a6d95e0e0711eccae4283bbe5\n.text\n40960\n6.506011\n\n\nb89bb8a288d739a27d7021183336413c\n.rdata\n20480\n6.655349\n\n\nfcd7ede94211c9d653bd8cc776feb8be\n.data\n4096\n4.326483\n\n\n56dc69f697f36158eefefdde895f39b6\n.rsrc\n4096\n0.613739\n\n\n20601cf5d6aecb9837dcc1747847c5a2\n.reloc\n4096\n4.068756\n\n\n\nPackers/Compilers/Cryptors\n\n\n\nMicrosoft Visual C++ 6.0 DLL\n\n\n\nRelationships\n\n\n\na1c483b0ee...\nDropped_By\n077d9e0e12357d27f7f0c336239e961a7049971446f7a3f10268d9439ef67885\n\n\n\nDescription\nThis 32-bit Windows DLL is written to disk and then loaded by the file \"4731CBAEE7ACA37B596E38690160A749\".This malware has been identified as a RAT, providing a remote actor with the ability to exfiltrate data, drop and run secondary payloads, and provide proxy capabilities on a compromised Windows device. The malware binds to port 443 and listens for incoming connections from a remote operator, using the Rivest Cipher 4 (RC4) encryption algorithm to protect communications with its Command and Control (C2).The malware also creates a log entry in a file named \u201cmssscardprv.ax\u201d, located in the %WINDIR%\\system32 folder. The log entry includes the victim's Internet Protocol (IP) address, host name, and current system time.\n\n\nea46ed5aed900cd9f01156a1cd446cbb3e10191f9f980e9f710ea1c20440c781\nTags\nbackdoorbottrojanworm\nDetails\n\n\n\nName\nWmmvsvc.dll\n\n\nSize\n91664 bytes\n\n\nType\nPE32 executable (DLL) (GUI) Intel 80386, for MS Windows\n\n\nMD5\ne86c2f4fc88918246bf697b6a404c3ea\n\n\nSHA1\n9b7609349a4b9128b9db8f11ac1c77728258862c\n\n\nSHA256\nea46ed5aed900cd9f01156a1cd446cbb3e10191f9f980e9f710ea1c20440c781\n\n\nSHA512\nf6097c66a526ba7a3c918b1c7fccae03c812046d642a4adb62ee7a24cbcee889c0348020ae7e2e82ee3f284b311f049ed596edb22b90153cadc11c646d4f9a45\n\n\nssdeep\n768:9eY/pEwKWcwP/bY4XxlGLup3Tq1LpDLJkDcw3f9zj:MitnU4viJJDw3Z\n\n\nEntropy\n3.156854\n\n\n\nAntivirus\n\n\n\nAVG\nPSW.Generic9.ACQQ\n\n\nAhnlab\nTrojan/Win32.Dllbot\n\n\nAvira\nBDS/Joanap.A.8\n\n\nBitDefender\nGen:Variant.Symmi.49274\n\n\nClamAV\nWin.Trojan.Agent-1388727\n\n\nCyren\nW32/Trojan.WXKV-0327\n\n\nESET\na variant of Win32/Agent.NJF worm\n\n\nEmsisoft\nGen:Variant.Symmi.49274 (B)\n\n\nF-secure\nGen:Variant.Symmi.49274\n\n\nFilseclab\nTrojan.Agent.NJF.cuzy.dll\n\n\nIkarus\nWorm.Win32.Agent\n\n\nK7\nTrojan ( 00515bda1 )\n\n\nMcAfee\nGeneric PWS.tr\n\n\nMicrosoft Security Essentials\nBackdoor:Win32/Joanap.A!dha\n\n\nNANOAV\nTrojan.Win32.Agent.cqilax\n\n\nNetGate\nTrojan.Win32.Malware\n\n\nQuick Heal\nBackdoor.Joanap\n\n\nSophos\nMal/Generic-L\n\n\nSymantec\nW32.Brambul\n\n\nVir.IT eXplorer\nTrojan.Win32.Generic.ACQQ\n\n\nVirusBlokAda\nWorm.Agent\n\n\nZillya!\nWorm.Agent.Win32.3549\n\n\nnProtect\nWorm/W32.Agent.91664\n\n\n\nYara Rules\n\n\n\nhidden_cobra_consolidated.yara\nrule Enfal_Generic { meta: author = \"NCCIC trusted 3rd party\" incident = \"10135536\" date = \"2018-04-12\" category = \"hidden_cobra\" family = \"BRAMBUL,JOANAP\" MD5_1 = \"483B95B1498B615A1481345270BFF87D\" MD5_2 = \"4731CBAEE7ACA37B596E38690160A749\" MD5_3 = \"CD60FD107BAACCAFA6C24C1478C345C8\" MD5_4 = \"298775B04A166FF4B8FBD3609E716945\" Info = \"Detects Hidden Cobra SMB Worm / RAT\" strings: $s0 = {6D737373636172647072762E6178} $s1 = {6E3472626872697138393076393D3032333D30312A2628542D30513332354A314E3B4C4B} $s2 = {72656468617440676D61696C2E636F6D} $s3 = {6D69737377616E673831303740676D61696C2E636F6D} $s4 = {534232755365435632564474} $s5 = {794159334D6559704275415756426341} $s6 = {705641325941774242347A41346167664B6232614F7A4259} $s7 = {AE8591916D586DE4F6FB8EE2F0BBF1F9} $s8 = {F96D5DD36D6D9A87DD6D506D6D6D516D} $s9 = {43616E6E6F74206372656174652072656D6F74652066696C652E} $s10 = {43616E6E6F74206F70656E2072656D6F74652066696C65} $s11 = {663D547D75128D85FCFEFFFF5056} $s12 = {663D547D75128D85FCFEFFFF5056E88C060000E9A9000000663D557D7512} $s13 = {663D567D750F8D85FCFEFFFF5056E891070000EB7C663D577D} $s14 = {3141327A3342347935433678374438773945307624465F754774487349724A71} $s15 = {393032356A6864686F333965686532} condition: ($s0) or ($s1) or ($s2) or ($s3) or ($s4 and $s5 and $s6) or ($s7 and $s8) or ($s9 and $s10 and $s11) or ($s12 and $s13) or ($s14 and $s15) }\n\n\n\nssdeep Matches\nNo matches found.\nPE Metadata\n\n\n\nCompile Date\n2011-09-14 11:42:30-04:00\n\n\nImport Hash\nf0087d7b90876a2769f2229c6789fcf3\n\n\nCompany Name\nMicrosoft Corporation\n\n\nFile Description\nMicrosoft XML Encoder/Transcoder\n\n\nInternal Name\nxpsshrm.dll\n\n\nLegal Copyright\n\u00a9 Microsoft Corporation. All rights reserved.\n\n\nOriginal Filename\nxpsshrm.dll\n\n\nProduct Name\nMicrosoft\u00ae Windows Media Services\n\n\nProduct Version\n9.00.00.4503\n\n\n\nPE Sections\n\n\n\nMD5\nName\nRaw Size\nEntropy\n\n\n037e97300efd533dd48d334d30bdc408\nheader\n4096\n0.759334\n\n\n4b5019185bb0b82273442dae3f15f105\n.text\n24576\n6.083997\n\n\n9e5a1cfda72f8944cd5e35e33a2a73b0\n.rdata\n4096\n3.267725\n\n\n47982ac1b20cac03adcfd62f5881b79c\n.data\n49152\n1.087883\n\n\nb971ab49349a660c70cb6987b7fb3ed3\n.rsrc\n4096\n1.140488\n\n\nad5750c9584c0eba32643810ab6e8a53\n.reloc\n4096\n2.515288\n\n\n\nPackers/Compilers/Cryptors\n\n\n\nMicrosoft Visual C++ 6.0 DLL\n\n\n\nRelationships\n\n\n\nea46ed5aed...\nDropped_By\n077d9e0e12357d27f7f0c336239e961a7049971446f7a3f10268d9439ef67885\n\n\nea46ed5aed...\nConnected_To\nmisswang8107@gmail.com\n\n\nea46ed5aed...\nContains\nredhat@gmail.com\n\n\n\nDescription\nThis file is a malicious 32-bit Windows DLL that is written to disk then loaded by the file \"4731CBAEE7ACA37B596E38690160A749\".When executed, the DLL attempts to contact all of the Internet Protocol (IP) addresses on the victim's local subnet. If the malware is able to connect to these IP addresses, it will attempt to gain unauthorized access via the SMB protocol on port 445 using a brute-force password attack. The malware contains an embedded password list consisting of commonly used passwords and generates random external IP addresses, which it attempts to attack.If the malware successfully gains access to another system, it will send an email containing the system's IP address, hostname, username, and password to the following address:--Begin email address--misswang8107@gmail.com--End email address--The email will appear to be from the following address (Refer to Figure 1):--Begin email address--redhat@gmail.com--End email address--The malware uses the victim's system folder to create a shared folder named \"adnim$\" by running the following commands via a remotely run service:--Begin commands utilized to create SMB share--cmd.exe /q /c net share adnim$=%SystemRoot%cmd.exe /q /c net share adnim$=%%SystemRoot%% /GRANT:%s,FULL--End commands utilized to create SMB share--The malware will then copy itself to newly created shared folder as a file named \"mssscardprv.ax\". After copying the malware to the new system it then runs the file on the victim system using a malicious service. The adnim$ share will then be deleted from the remote system using the following command:--Begin command used to delete share--'cmd.exe /q /c net share adnim$ /delete'--End command used to delete share--The malware determines if Remote Desktop Protocol (RDP) is enabled by attempting to connect to port 3389. If it is able to connect to this port, the malware will report RDP is available on the compromised system. This information is provided to the operator using the malicious email address provided earlier.This malware can communicate with the RAT identified as \"scardprv.dll\" (4613f51087f01715bf9132c704aea2c2). The communication is protected with the Rivest Cipher 4 (RC4) encryption protocol. When attempting to propagate, the malware uses the following three usernames combined with a password brute-force attack:--Begin malicious usernames used by SMB worm--AdministrateurAdministradorAdministrator--End malicious usernames used by SMB worm--Although the malware uses numerous embedded passwords in its brute force attacks, within our environment the malware consistently used the following \"Lan Manager Response\" in its SMB attacks:--Begin static Lan Manager response--8C15084FA541079A000000000000000000--End static Lan Manager response--This hexadecimal value may be useful in detecting this worm as it communicates over port 445 and attempts to spread. Specifically, when the malware attempts to run a remote service to create the \"adnim$\" share, the following network traffic is generated:--Begin network signature--ASCII: cmd.exe /q /c net share adnim$=%SystemRoot% /GRANT:Administrator,FULLHEX: 636D642E657865202F71202F63206E65742073686172652061646E696D243D2553797374656D526F6F7425202F4752414E543A41646D696E6973747261746F722C46554C4C--End network signature--\nScreenshots\n\n\nFigure 1 - The screenshot illustrates the to and from email addresses for data exfiltration.\n\n\n\nfe7d35d19af5f5ae2939457a06868754b8bdd022e1ff5bdbe4e7c135c48f9a16\nTags\nbackdoortrojanworm\nDetails\n\n\n\nName\n298775B04A166FF4B8FBD3609E716945\n\n\nSize\n86016 bytes\n\n\nType\nPE32 executable (GUI) Intel 80386, for MS Windows\n\n\nMD5\n298775b04a166ff4b8fbd3609e716945\n\n\nSHA1\n2e0f666831f64d7383a11b444e2c16b38231f481\n\n\nSHA256\nfe7d35d19af5f5ae2939457a06868754b8bdd022e1ff5bdbe4e7c135c48f9a16\n\n\nSHA512\nadc9bb5a2116134ddf57d1b1765d5981c55828aa8c6719964b0e2eeb6c9068a2acaa98c2e03227a406a4fbfa2f007f5eb9f57a61e3749b8eb0d73b1881328fbf\n\n\nssdeep\n768:i+cDn8nAQ5Toz4c0+u5jrdXs+W+aCNkiC8xeC3cs:i+M8ndTozOn5jxF/US0s\n\n\nEntropy\n2.873816\n\n\n\nAntivirus\n\n\n\nClamAV\nWin.Trojan.Agent-1388727\n\n\nESET\na variant of Win32/Agent.NVC worm\n\n\nMcAfee\nGenericRXCB-TI!298775B04A16\n\n\nMicrosoft Security Essentials\nBackdoor:Win32/Joanap.A!dha\n\n\nSymantec\nHeur.AdvML.B\n\n\n\nYara Rules\n\n\n\nhidden_cobra_consolidated.yara\nrule Enfal_Generic { meta: author = \"NCCIC trusted 3rd party\" incident = \"10135536\" date = \"2018-04-12\" category = \"hidden_cobra\" family = \"BRAMBUL,JOANAP\" MD5_1 = \"483B95B1498B615A1481345270BFF87D\" MD5_2 = \"4731CBAEE7ACA37B596E38690160A749\" MD5_3 = \"CD60FD107BAACCAFA6C24C1478C345C8\" MD5_4 = \"298775B04A166FF4B8FBD3609E716945\" Info = \"Detects Hidden Cobra SMB Worm / RAT\" strings: $s0 = {6D737373636172647072762E6178} $s1 = {6E3472626872697138393076393D3032333D30312A2628542D30513332354A314E3B4C4B} $s2 = {72656468617440676D61696C2E636F6D} $s3 = {6D69737377616E673831303740676D61696C2E636F6D} $s4 = {534232755365435632564474} $s5 = {794159334D6559704275415756426341} $s6 = {705641325941774242347A41346167664B6232614F7A4259} $s7 = {AE8591916D586DE4F6FB8EE2F0BBF1F9} $s8 = {F96D5DD36D6D9A87DD6D506D6D6D516D} $s9 = {43616E6E6F74206372656174652072656D6F74652066696C652E} $s10 = {43616E6E6F74206F70656E2072656D6F74652066696C65} $s11 = {663D547D75128D85FCFEFFFF5056} $s12 = {663D547D75128D85FCFEFFFF5056E88C060000E9A9000000663D557D7512} $s13 = {663D567D750F8D85FCFEFFFF5056E891070000EB7C663D577D} $s14 = {3141327A3342347935433678374438773945307624465F754774487349724A71} $s15 = {393032356A6864686F333965686532} condition: ($s0) or ($s1) or ($s2) or ($s3) or ($s4 and $s5 and $s6) or ($s7 and $s8) or ($s9 and $s10 and $s11) or ($s12 and $s13) or ($s14 and $s15) }\n\n\n\nssdeep Matches\nNo matches found.\nPE Metadata\n\n\n\nCompile Date\n2018-01-05 01:22:45-05:00\n\n\nImport Hash\n9f298eba36baa47b98a60cf36fdb2301\n\n\n\nPE Sections\n\n\n\nMD5\nName\nRaw Size\nEntropy\n\n\n8a5b06109c3bd4323fa3318f9874d529\nheader\n4096\n0.703885\n\n\n413f30d4d86037b75958b45b9efbe1de\n.text\n20480\n6.302858\n\n\n82b41fefc9aa74a2430f1421fd5fe5b3\n.rdata\n4096\n3.748024\n\n\nb6f17870ca5f45d4c75e18024e6e1180\n.data\n53248\n1.067897\n\n\ncda5ef1038742e5ef46b9cfa269b0434\n.rsrc\n4096\n0.608792\n\n\n\nPackers/Compilers/Cryptors\n\n\n\nMicrosoft Visual C++ v6.0\n\n\n\nProcess List\n\n\n\nProcess\nPID\nPPID\n\n\nfe7d35d19af5f5ae2939457a06868754b8bdd022e1ff5bdbe4e7c135c48f9a16.exe\n2436\n(2408)\n\n\n\nDescription\nThis file is a malicious 32-bit Windows executable file designed to scan the local network and the Internet for machines that are accessible and have open SMB ports. Once the malware gains access to a remote machine, it will deliver a malicious payload. This file accepts the following command-line arguments for execution:--Begin arguments---i ==> Create service-u ==> Control and delete service-s ==> Start service-r ==> Run not as a service-k ==> ControlService--End arguments--When executed with the \"-i\" argument, the malware installs and executes itself as the following service:--Begin service information--ServiceName = \"RdpCertification\"DisplayName = \"Remote Desktop Certification Services\"DesiredAccess = SERVICE_ALL_ACCESSServiceType = SERVICE_WIN32_OWN_PROCESS|SERVICE_INTERACTIVE_PROCESSStartType = SERVICE_AUTO_STARTBinaryPathName = \"%current directory%\\298775B04A166FF4B8FBD3609E716945.exe\"--End service information--The malware creates a mutual exclusion (Mutex) object named \"PlatFormSDK20150201\", then generates a list of IP addresses using a domain generation algorithm (DGA). The DGA uses the system time in the algorithm to create the list of IP addresses.It generates network traffic over Transmission Control Protocol (TCP) ports 80 and 445 via the victims' IP addresses and the generated IP addresses.Sample HTTP request:--Begin HTTP request--OPTIONS / HTTP/1.1translate: fUser-Agent: Microsoft-WebDAV-MiniRedir/5.1.2600Host: 159.154.100.0Content-Length: 0Connection: Keep-Alive--End HTTP request--Once successfully connected to other Windows hosts or the generated IP addresses using port 445, the malware attempts to use a hard-coded list of passwords for SMB connections. If the password is correctly guessed, a file share is established. The malware uses the following methods to access shares on the remote systems:To gain access to remote systems it uses ($IPC) share via \u201c\\\\remote system IP\\$IPC\u201dIt checks for existing shares by using \u201c\\\\hostname\\adnim$\\system32\u201dIt will create a new share named \"adnim$\" using the following command:--Begin new share command--\u201ccmd.exe /q /c net share adnim$=%SystemRoot%\u201d\u201ccmd.exe /q /c net share adnim$=%%SystemRoot%% /GRANT:%s,FULL\u201d--End new share command\u2014Once a file share is successfully established, the malware uploads a copy of a payload \"C:\\WINDOWS\\TEMP\\TMP1.tmp\" and installs it as a service. The malware payload that is uploaded and then run on the newly infected host was not available at the time of analysis.The remote network share is removed after infection using the following command:--Begin command--\u201ccmd.exe /q /c net share adnim$ /delete\u201d--End command--Once the payload has been uploaded and executed, the malware uses Simple Mail Transfer Protocol (SMTP) to send collected data. The data provides infection status to a remote operator.Displayed below are the domain names of the service providers used to send data:--Begin SMTP domain information--\"www.hotmail.com\"--End SMTP domain information--Displayed is the structure of the email sent:--Begin email structure format--SUBJECT: %s%s%sTO: Joana <%s>%sFROM: <%s>%sDATA%sRCPT TO: <%s>%sMAIL FROM: <%s>%sAUTH LOGIN%sHELO %s%s--End email structure format--Displayed is a list of brute force passwords used to establish connections:--Begin brute force password--!@#$!@#$%!@#$%^!@#$%^&!@#$%^&*!@#$%^&*()\"KGS!@#$%\"0000000000000000000000011111111111111111111111111222121212121212123123123321123412345123456123456712345678123456789123456^%$#@!1234qwer123abc123asd123qwe13131q2w3e1q2w3e4r1qaz2wsx200920102011201220132014201520162017201843215432165432169696666667777888888888888888888888888888888Adminabc123abc@123abcdadminadmin123admin!23admin!@#administratoradministradorasdfasdfgasdfghasdf123asdf!23baseballbackupblankciscocompaqcontrolcomputercookie123databasedbpassworddb1234defaultdellenablefishfoobargatewayguestgolfharleyhomeiloveyouinternetletmeinLoginloginlovemanageroracleownerpasspasswdpasswordp@sswordpassword1password!passw0rdPassword1pa55w0rdpw123q1w2e3q1w2e3r4q1w2e3r4t5q1w2e3r4t5y6qazwsxqazwsxedcqwerqwertqwerty!QAZxsw2rootsecretserversqlexecshadowsupersybasetemptemp123testtest!test1test123test!23winxpwin2000win2003Welcome1Welcome123xxxxyxcvzxcvAdministratorAdmin--End brute force password--\n\n\nredhat@gmail.com\nDetails\n\n\n\nAddress\nredhat@gmail.com\n\n\n\nRelationships\n\n\n\nredhat@gmail.com\nContained_Within\nea46ed5aed900cd9f01156a1cd446cbb3e10191f9f980e9f710ea1c20440c781\n\n\n\n\n\nmisswang8107@gmail.com\nDetails\n\n\n\nAddress\nmisswang8107@gmail.com\n\n\n\nRelationships\n\n\n\nmisswang8107@gmail.com\nConnected_From\nea46ed5aed900cd9f01156a1cd446cbb3e10191f9f980e9f710ea1c20440c781\n\n\n\n\nRelationship Summary\n\n\n\n\n077d9e0e12...\nDropped\na1c483b0ee740291b91b11e18dd05f0a460127acfc19d47b446d11cd0e26d717\n\n\n077d9e0e12...\nDropped\nea46ed5aed900cd9f01156a1cd446cbb3e10191f9f980e9f710ea1c20440c781\n\n\na1c483b0ee...\nDropped_By\n077d9e0e12357d27f7f0c336239e961a7049971446f7a3f10268d9439ef67885\n\n\nea46ed5aed...\nDropped_By\n077d9e0e12357d27f7f0c336239e961a7049971446f7a3f10268d9439ef67885\n\n\nea46ed5aed...\nConnected_To\nmisswang8107@gmail.com\n\n\nea46ed5aed...\nContains\nredhat@gmail.com\n\n\nredhat@gmail.com\nContained_Within\nea46ed5aed900cd9f01156a1cd446cbb3e10191f9f980e9f710ea1c20440c781\n\n\nmisswang8107@gmail.com\nConnected_From\nea46ed5aed900cd9f01156a1cd446cbb3e10191f9f980e9f710ea1c20440c781\n\n\n\n\nRecommendations\n\nNCCIC would like to remind users and administrators to consider using the following best practices to strengthen the security posture of their organization's systems. Any configuration changes should be reviewed by system owners and administrators prior to implementation to avoid unwanted impacts.\n\nMaintain up-to-date antivirus signatures and engines.\nKeep operating system patches up-to-date.\nDisable File and Printer sharing services. If these services are required, use strong passwords or Active Directory authentication.\nRestrict users' ability (permissions) to install and run unwanted software applications. Do not add users to the local administrators group unless required.\nEnforce a strong password policy and implement regular password changes.\nExercise caution when opening e-mail attachments even if the attachment is expected and the sender appears to be known.\nEnable a personal firewall on agency workstations, configured to deny unsolicited connection requests.\nDisable unnecessary services on agency workstations and servers.\nScan for and remove suspicious e-mail attachments; ensure the scanned attachment is its \"true file type\" (i.e., the extension matches the file header).\nMonitor users' web browsing habits; restrict access to sites with unfavorable content.\nExercise caution when using removable media (e.g., USB thumbdrives, external drives, CDs, etc.).\nScan all software downloaded from the Internet prior to executing.\nMaintain situational awareness of the latest threats and implement appropriate ACLs.\n\nAdditional information on malware incident prevention and handling can be found in NIST's Special Publication 800-83, Guide to Malware Incident Prevention & Handling for Desktops and Laptops.\n\nContact Information\n\n\n1-888-282-0870\nNCCICCustomerService@us-cert.gov (UNCLASS)\nus-cert@dhs.sgov.gov (SIPRNET)\nus-cert@dhs.ic.gov (JWICS)\n\nNCCIC continuously strives to improve its products and services. You can help by answering a very short series of questions about this product at the following URL: https://us-cert.gov/forms/feedback/\n\nDocument FAQ\n\nWhat is a MAR? A Malware Analysis Report (MAR) is intended to provide organizations with more detailed malware analysis acquired via manual reverse engineering. To request additional analysis, please contact NCCIC and provide information regarding the level of desired analysis.\nCan I edit this document? This document is not to be edited in any way by recipients. All comments or questions related to this document should be directed to NCCIC at 1-888-282-0870 or soc@us-cert.gov.\nCan I submit malware to NCCIC? Malware samples can be submitted via three methods:\n\nWeb: https://malware.us-cert.gov\nE-Mail: submit@malware.us-cert.gov\nFTP: ftp.malware.us-cert.gov (anonymous)\n\nNCCIC encourages you to report any suspicious activity, including cybersecurity incidents, possible malicious code, software vulnerabilities, and phishing-related scams. Reporting forms can be found on the NCCIC/US-CERT homepage at www.us-cert.gov.\n\n\n\n\n\n\n\nRevisions\n\nMay 29, 2018: Initial version|May 31, 2018: Corrected error in MAR and STIX file\n",
  "cves": [
    "CVE-2022-47966",
    "CVE-2022-42475"
  ],
  "techniques": [],
  "advisory": "ar18-149a",
  "title": "MAR-10135536-3 - HIDDEN COBRA RAT/Worm | CISA",
  "source": "analysis-reports",
  "id": "51ac4736014e2d34ad3f219459a675cec792bd405fceda983308d6a5b779192f"
}