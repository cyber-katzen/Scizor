{
  "markdown": "\nNotification\nThis report is provided \"as is\" for informational purposes only. The Department of Homeland Security (DHS) does not provide any warranties of any kind regarding any information contained herein. The DHS does not endorse any commercial product or service referenced in this bulletin or otherwise.\nThis document is marked TLP:CLEAR--Disclosure is not limited. Sources may use TLP:CLEAR when information carries minimal or no foreseeable risk of misuse, in accordance with applicable rules and procedures for public release. Subject to standard copyright rules, TLP:CLEAR information may be distributed without restriction. For more information on the Traffic Light Protocol (TLP), see http://www.cisa.gov/tlp.\nSummary\nDescription\nThis Malware Analysis Report (MAR) is the result of analytic efforts by the Cybersecurity and Infrastructure Security Agency (CISA) to provide detailed analysis of files associated with CovalentStealer malware, which is designed to identify and exfiltrate files to a remote server. CISA obtained CovalentStealer malware samples during an on-site incident response engagement at a Defense Industrial Base (DIB) Sector organization compromised by advanced persistent threat (APT) actors.\n\nCISA analyzed 19 files associated with CovalentStealer malware. The files are designed to identify file shares on a system, categorize the files, and upload the files to a remote server. The files include two configurations that specifically target the victim's documents using predetermined files paths and user credentials. The two remaining files were identified as open source utilities the threat actor utilized on the victim's system. One file is a publicly available utility used to compress and archive other files. The second file is an open source utility used to extract the Master File Table (MFT) from a volume and can be used for file enumeration.\nCISA is distributing this MAR to enable network defense and reduce exposure to APT sponsored malicious cyber activity.\n\nFor more information on the confirmed compromise, see Joint CSA: Impacket and Exfiltration Tool Used to Steal Sensitive Information from Defense Industrial Base Organization.\nDownload the PDF version of this report:\n\n\nMAR-10365227.r1.v1 - Impacket\n(PDF,       2.34 MB\n  )\n\n\nFor a downloadable copy of IOCs, see:\n\n\nMAR-10365227.r1.v1 STIX XML\n(XML,       1.42 MB\n  )\n\n\nSubmitted Files (19)\n09605981a072c604e6ef9ad2dd7d2a78b48b07ee3339589bfcf0a466a9190904 (msexch.log)\n0b01f392fa030be1ddd549fb79cf280d2a2c745578a56fedd4cb5e9438ae72cb (ntstatus.bat)\n0b7d15968d44710b3e7f153c04b5038d03900a6685643bc8efe688c4d5a5deab (ntstatus_temp.log)\n157a0ffd18e05bfd90a4ec108e5458cbde01015e3407b3964732c9d4ceb71656 (ntstatus.exe)\n25afc6741abfa27f5b50844331772466182ebe3f74bc84f911314d1a68c62cb2 (mqsvn.ini)\n30191b3badf3cdbc65d0ffeb68e0f26cef10a41037351b0f562ab52fce7432cc (msexch.exe)\n3585c3136686d7d48e53c21be61bb2908d131cf81b826acf578b67bb9d8e9350 (mqsvn.exe)\n517faa4a0666ec68842f256f08d987935b6ce9ef64e33f027e084e8f45b9366d (onedrv.dat)\n52765525103f5b3b07d0882cc8ee4bb8e279ad5d451e1ed07cae3b98565cce29 (msexch.ini)\n5ba0d0bfda372c1f6aa382a70f4ab8427ec998b680510e208fdf878cfda9afe3 (ntstatus.log)\n603e75db59285734cfb5a469e984c4e359e660ccb7836ff9c209aec36931bc2b (mqsvn.log)\n6a0cd866c849e62f9ccc26575d8794c2e0b14722387742b965d4358e1e0e8b3c (msexch_temp.log)\n84164e1e8074c2565d3cd178babd93694ce54811641a77ffdc8d1084dd468afb (onedrv.exe)\n91a8b31c126a021f5c156742016acdcca7d83eac4b583bae5d4fd0a85a96813b (onedrv.ini)\nb03ac5eaf2131060ee381e5e46ebc705d8d617a90cc61fa4918174545b4fbaa6 (ntstatus.bin)\nbfa7adeda4597b70bf74a9f2032df2f87e07f2dbb46e85cb7c091b83161d6b0a (vmware.exe)\nda267c72f58ec487761de99d0f3bcfd87771a36afc06716053960633a74139df (ntstatus.ini)\ne03a2c8a6e81cf62ba7401c598ea1d4635b08bbf9c2fec080b536dde29e6392f (msexch.bin)\nfae38156e9ce12368c846836b87861f4f12e14698cb65f14545205fa56d8c496 (vmware.ps1)\nAdditional Files (2)\n1352dbb093a337eb8db9d0135adbe0542bb7e7163616e4f8962919becab171da (result.exe)\nd221ca9c519ae04c7724baca8d36c2ce77454e0f9aa0f119ecfa9246973a92f8 (Uploader.exe)\nFindings\n84164e1e8074c2565d3cd178babd93694ce54811641a77ffdc8d1084dd468afb\nTags\ninformation-stealeruploader\nDetails\n\n\n\n\n\nName\nonedrv.exe\n\n\nSize\n791040 bytes\n\n\nType\nPE32+ executable (GUI) x86-64 Mono/.Net assembly, for MS Windows\n\n\nMD5\n806998079c80f53afae3b0366bac1479\n\n\nSHA1\n9f7378da13ca1da75e12e536c8e2dc4cd2236489\n\n\nSHA256\n84164e1e8074c2565d3cd178babd93694ce54811641a77ffdc8d1084dd468afb\n\n\nSHA512\n3d592a606426386fa5f1224c7d3f82f31f5a4d23f9c67422d774e080725bc5698e7786407863dd50d7172e814871bdfabbbe6dce9545733d995ddd892249ba22\n\n\nssdeep\n12288:kyIzsYTd+LXxWtmtOdnPR3xTexehCkijOcXF8qSH8gdkMdCNGCWJOWCmP8pSMmVN:ky4sO+9ymtsnPRBnlivXPSHxkMNHCNp\n\n\nEntropy\n7.996795\n\n\n\nAntivirus\n\n\n\nAvira\nHEUR/AGEN.1221987\n\n\n\nYARA Rules\n\nrule CISA_10365227_03 : ClientUploader\n\t{\n\t\u00a0\u00a0\u00a0meta:\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Author = \"CISA Code & Media Analysis\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Incident = \"10365227\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Date = \"2021-12-23\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Last_Modified = \"20211224_1200\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Actor = \"n/a\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Category = \"n/a\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Family = \"n/a\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Description = \"Detects ClientUploader_onedrv\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0MD5_1 = \"806998079c80f53afae3b0366bac1479\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0SHA256_1 = \"84164e1e8074c2565d3cd178babd93694ce54811641a77ffdc8d1084dd468afb\"\n\t\u00a0\u00a0\u00a0strings:\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s1 = \"Decoder2\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s2 = \"ClientUploader\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s3 = \"AppDomain\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s4 = { 5F 49 73 52 65 70 47 ?? 44 65 63 6F 64 65 72 73 }\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s5 = \"LzmaDecoder\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s6 = \"$ee1b3f3b-b13c-432e-a461-e52d273896a7\"\n\t\u00a0\u00a0\u00a0condition:\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0uint16(0) == 0x5a4d and all of them\n\t}\n\nssdeep Matches\nNo matches found.\nPE Metadata\n\n\n\nCompile Date\n2021-09-10 17:59:57-04:00\n\n\nInternal Name\nClientUploader.exe\n\n\nOriginal Filename\nClientUploader.exe\n\n\nProduct Version\n1.0.0.0\n\n\n\nPE Sections\n\n\n\nMD5\nName\nRaw Size\nEntropy\n\n\n6b81a95076cc3d6f6dff7d32afa3b7e2\nheader\n512\n2.297287\n\n\n2d3081eb51c7c393e0a670c8bfcf7c24\n.text\n788992\n7.998126\n\n\n5569bca67ba8c174f30990c07b585dbe\n.rsrc\n1536\n3.966404\n\n\n\nPackers/Compilers/Cryptors\n\n\n\nMicrosoft Visual C++ v6.0\n\n\n\nRelationships\n\n\n\n84164e1e80...\nUsed\n91a8b31c126a021f5c156742016acdcca7d83eac4b583bae5d4fd0a85a96813b\n\n\n84164e1e80...\nCreated\n517faa4a0666ec68842f256f08d987935b6ce9ef64e33f027e084e8f45b9366d\n\n\n\nDescription\nThis file has been identified as CovalentStealer malware. The actor utilized code from several open source projects, including ClientUploader. The retained the internal name \"ClientUploader.exe\". The program is a file management system that is capable of uploading files to the Internet.\n\nWhen the program is executed, it will spawn an instance of itself in memory called \u2018koi\u2019. This instance accesses several embedded resources that it uses to locate and manipulate files on the system. The following is a list of the primary embedded resources:\n\n---Begin Embedded Resources---\nBaseNetwork \u2013 This resource is used to create sessions and establish connections to the server.\nFileContainer \u2013 This resource is used to access file shares via Server Message Block (SMB). It is also used to enumerate files and directories and sort them by Message Digest 5 (MD5) hash. It maintains Internet Protocol (IP) addresses, logins, domain names, passwords, and paths for shares on the network.\nIFileWorker \u2013 This resource is a file management program that is capable of moving and categorizing files. It contains compression libraries for Gzip and Brotli, as well as a file blacklist.\nEncryption \u2013 This resource handles file encryption, decryption and secure communications. It decrypts the configuration file, onedrv.ini (91a8b31c126a021f5c156742016acdcca7d83eac4b583bae5d4fd0a85a96813b) using the hard-coded Advanced Encryption Standard (AES) key \u2018M(xcHq88q[s=pc7^+u_Gb_}JC%QQwP:h\u2019 and an Initialization Vector (IV) using the first half of the AES key (See Figure 1).\nOneDriveClient \u2013 This resource targets a user\u2019s OneDrive account and creates an upload session to send the files to a remote server. It is able to access files in the victim\u2019s OneDrive by unique ID (See Figure 2). Files are uploaded to a Microsoft Azure client identified in the configuration file onedrv.ini by client ID.\n---End Embedded Resources---\n\nThe program runs a debugging routine and will output debugging data to a file with the same name as the malware and with the .dat extension, e.g. onedrv.dat (517faa4a0666ec68842f256f08d987935b6ce9ef64e33f027e084e8f45b9366d).\nScreenshots\n\nFigure 1 - This is the AES encryption routine. The routine uses the hard-coded string 'M(xcHq88q[s=pc7^+u_Gb_}JC%QQwP:h' as the AES key and the first half of the key as the IV.\n\nFigure 2 - This is the configuration for the upload session. This module is able to access items in the user's OneDrive by unique ID.\n517faa4a0666ec68842f256f08d987935b6ce9ef64e33f027e084e8f45b9366d\nDetails\n\n\n\nName\nonedrv.dat\n\n\nSize\n267224 bytes\n\n\nType\nASCII text, with CRLF line terminators\n\n\nMD5\ndc0414dec9a84d6342c5d5fc77bbdbed\n\n\nSHA1\n1dad19123564d7d02c3259ab4b06c90181dc4b37\n\n\nSHA256\n517faa4a0666ec68842f256f08d987935b6ce9ef64e33f027e084e8f45b9366d\n\n\nSHA512\n1d262f06881516ca2274d8fb18bcb4bcf9c0b3229370b0609f3803f356a676b1149e22da6a33957862d8470a8531d9719af07bd75379df2ca29e373604fb32cb\n\n\nssdeep\n3072:ERNwmyBvqZKFkVfhJnEFbDcazPQLTnVy8JR6Ylb3uQ0PQNIfFrCGdDlBXZuZpZfB:bWrjgA\n\n\nEntropy\n5.360335\n\n\n\nAntivirus\nNo matches found.\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\n517faa4a06...\nCreated_By\n84164e1e8074c2565d3cd178babd93694ce54811641a77ffdc8d1084dd468afb\n\n\n\nDescription\nThis file contains output from the debugging routine in onedrv.exe (84164e1e8074c2565d3cd178babd93694ce54811641a77ffdc8d1084dd468afb).\n91a8b31c126a021f5c156742016acdcca7d83eac4b583bae5d4fd0a85a96813b\nTags\ninformation-stealer\nDetails\n\n\n\nName\nonedrv.ini\n\n\nSize\n1088 bytes\n\n\nType\ndata\n\n\nMD5\na0ab6d3e643d4dd51ee6ae9079b175a4\n\n\nSHA1\nf179fcc4c41ca5cb443551f88a1074d5176d33f4\n\n\nSHA256\n91a8b31c126a021f5c156742016acdcca7d83eac4b583bae5d4fd0a85a96813b\n\n\nSHA512\n237baa401e0c52ca816cebafa5abf088e9a757f4da452e97210a1fe8eda8c0adc67aa19cacd662dcc98f5bd355d679fb096ff4e97cd54e16c199c66946d65a5e\n\n\nssdeep\n24:olkc5V0yhsd/AFvaPo3b6EJ2ITY9UI62JPld5oKLeWb6l+vTI:olkq0yK/Ata5EJ2I5nOTvTI\n\n\nEntropy\n7.824751\n\n\n\nAntivirus\nNo matches found.\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\n91a8b31c12...\nUsed_By\n84164e1e8074c2565d3cd178babd93694ce54811641a77ffdc8d1084dd468afb\n\n\n\nDescription\nThis artifact is the encrypted configuration file for the OneDriveClient module contained in the file ondrv.exe (84164e1e8074c2565d3cd178babd93694ce54811641a77ffdc8d1084dd468afb). The data is decrypted using the hard-coded key \u2018M(xcHq88q[s=pc7^+u_Gb_}JC%QQwP:h\u2019.\n\nThe file contains paths to two archives targeted by the attacker. The file includes the IP address of the server, stolen credential information, and a key to encrypt the uploaded data. NOTE: The decrypted configuration contains confidential client information and therefore is not included in this report.\n\nIn addition, the data contains a refresh token for an OAuth client for Microsoft Azure with the Client ID of \u20187a3b4b84-ed28-4f18-b30d-218788c74a5f\u2019. Speed and compression information as well as times that the OneDrive share can be accessed are also included in the configuration.\n157a0ffd18e05bfd90a4ec108e5458cbde01015e3407b3964732c9d4ceb71656\nTags\ninformation-stealerobfuscatedtrojanuploader\nDetails\n\n\n\nName\nntstatus.exe\n\n\nSize\n6656 bytes\n\n\nType\nPE32+ executable (GUI) x86-64 Mono/.Net assembly, for MS Windows\n\n\nMD5\nc435d133b45783cce91a5d4e4fbe3f52\n\n\nSHA1\n9ddfa0669358bc19a166a41fd93cec5a3c88205d\n\n\nSHA256\n157a0ffd18e05bfd90a4ec108e5458cbde01015e3407b3964732c9d4ceb71656\n\n\nSHA512\ne4d43dc23ff78f55bc857608fa33691eb7fb3e132332660b46460e7e7512104bc22484489d3d0fbd136270de9f7060641505ad2854cefd50b31ca6bb31b2ae18\n\n\nssdeep\n96:nPbVkB7jiZStZC+01RPmaUrfzvDwiFMCnd+taflUTsqzNt:nPbqFiwW+g5maMzDwQMCQwmT\n\n\nEntropy\n4.921630\n\n\n\nAntivirus\n\n\n\nAdaware\nGen:Variant.Tedy.82790\n\n\nBitdefender\nGen:Variant.Tedy.82790\n\n\nESET\na variant of MSIL/Agent.VOV trojan\n\n\nMcAfee\nGeneric trojan.ri\n\n\nNETGATE\nMalware.Generic\n\n\nSymantec\nProcess timed out\n\n\n\nYARA Rules\n\nrule CISA_10365227_01 : APPSTORAGE\n\t{\n\t\u00a0\u00a0\u00a0meta:\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Author = \"CISA Code & Media Analysis\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Incident = \"10365227\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Date = \"2021-12-23\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Last_Modified = \"20211224_1200\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Actor = \"n/a\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Category = \"n/a\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Family = \"APPSTORAGE\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Description = \"Detects AppStorage_ntstatus_msexch samples\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0MD5_1 = \"c435d133b45783cce91a5d4e4fbe3f52\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0SHA256_1 = \"157a0ffd18e05bfd90a4ec108e5458cbde01015e3407b3964732c9d4ceb71656\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0MD5_2 = \"baa634fdd2b34956524b5519ee97b8a8\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0SHA256_2 = \"30191b3badf3cdbc65d0ffeb68e0f26cef10a41037351b0f562ab52fce7432cc\"\n\t\u00a0\u00a0\u00a0strings:\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s1 = \"026B924DD52F8BE4A3FEE8575DC\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s2 = \"GetHDDId\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s3 = \"AppStorage\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s4 = \"AppDomain\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s5 = \"$1e3e5580-d264-4c30-89c9-8933c948582c\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s6 = \"hrjio2mfsdlf235d\" wide\n\t\u00a0\u00a0\u00a0condition:\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0uint16(0) == 0x5a4d and all of them\n\t}\n\nssdeep Matches\nNo matches found.\nPE Metadata\n\n\n\nCompile Date\n2101-07-23 04:43:10-04:00\n\n\nInternal Name\nAppStorage.exe\n\n\nOriginal Filename\nAppStorage.exe\n\n\nProduct Version\n1.0.0.0\n\n\n\nPE Sections\n\n\n\nMD5\nName\nRaw Size\nEntropy\n\n\n3994632889cebeff28c360da22c696f3\nheader\n512\n2.255013\n\n\nbec2cac9d419ae07e526a03c4a94cb64\n.text\n4608\n5.307382\n\n\n0551c676439e5d812cb2bab3f2060c1b\n.rsrc\n1536\n3.934855\n\n\n\nPackers/Compilers/Cryptors\n\n\n\nMicrosoft Visual C++ v6.0\n\n\n\nRelationships\n\n\n\n157a0ffd18...\nRelated_To\nb03ac5eaf2131060ee381e5e46ebc705d8d617a90cc61fa4918174545b4fbaa6\n\n\n157a0ffd18...\nDropped\n1352dbb093a337eb8db9d0135adbe0542bb7e7163616e4f8962919becab171da\n\n\n157a0ffd18...\nRelated_To\n0b01f392fa030be1ddd549fb79cf280d2a2c745578a56fedd4cb5e9438ae72cb\n\n\n\nDescription\nThis artifact is an obfuscated .NET executable that is used to decode a variant of the CovalentStealer malware. When executed, the program will check the present name of the program and then look in the current directory for a file with the same name and a .bin extension, e.g. ntstatus.bin (b03ac5eaf2131060ee381e5e46ebc705d8d617a90cc61fa4918174545b4fbaa6).\n\nThe program seeks to generate a key called \u2018HDDId\u2019 to decode ntstatus.bin. The embedded string \u2018hrjio2mfsdlf235d\u2019 is used to decode instructions within the program to generate the key (See Figure 3). The first command identifies the machineName of the system. The second command reads the Windows Management Instrumentation (WMI) namespace root/cimv2 to locate the volumeserialnumber of the current drive. Both variables are then modified using an exclusive OR (XOR) routine and the same string above is used to generate the key (See Figure 4). The first part of the key is generated from the volumeserialnumber, and during analysis resolved to \u201876D55BD2\u2019. The machineName resolved to \u2018F3124EDD\u2019 creating the key \u201876D55BD2F3124EDD\u2019 (See Figure 5). Note: The key is an example.\n\nTo generate the correct key the machineName and volumeserialnumber must match the victim\u2019s system, otherwise it fails to decode ntstatus.bin and the program will terminate. This method is used to thwart independent analysis of the file, ntstatus.bin.\nScreenshots\n\nFigure 3 - Screenshot of the XOR routine using the string 'hrjio2mfsdlf235d'.\n\nFigure 4 - The program collects the machineName and volumeserialnumber to generate the HDDId key.\n\nFigure 5 - This is the generated HDDId key used to decode ntstatus.bin\nb03ac5eaf2131060ee381e5e46ebc705d8d617a90cc61fa4918174545b4fbaa6\nTags\ninformation-stealerobfuscateduploader\nDetails\n\n\n\nName\nntstatus.bin\n\n\nSize\n1834496 bytes\n\n\nType\ndata\n\n\nMD5\nd5a7b90177cdf81c2e1de40dc834d764\n\n\nSHA1\nd5dee0a05101cf9ed3c3ca76cf01f518c3ef922c\n\n\nSHA256\nb03ac5eaf2131060ee381e5e46ebc705d8d617a90cc61fa4918174545b4fbaa6\n\n\nSHA512\ncfccd6701a69047c7de246601d2cd41cdc87d314bdcf070778938dad22e3bf5911d3beca0d75379dabdda1ad3c229c3bec329b840f5e4828c8bab41c1cdff159\n\n\nssdeep\n24576:vsGNL+Kei7j3iTeG0fYHTlyAUoFwZJuaEh68w8To7FgunNZG10guctbAgYMEc+1B:DNb7dEh68E72O4hEVF\n\n\nEntropy\n6.681125\n\n\n\nAntivirus\n\n\n\nSymantec\nUnavailable (production)\n\n\n\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\nb03ac5eaf2...\nRelated_To\n157a0ffd18e05bfd90a4ec108e5458cbde01015e3407b3964732c9d4ceb71656\n\n\nb03ac5eaf2...\nContains\n1352dbb093a337eb8db9d0135adbe0542bb7e7163616e4f8962919becab171da\n\n\n\nDescription\nThis is an obfuscated version of CovalentStealer malware. The file is decoded by ntstatus.exe (157a0ffd18e05bfd90a4ec108e5458cbde01015e3407b3964732c9d4ceb71656) using the key '76D55BD2F3124EDD'. The decoded file is called result.exe (1352dbb093a337eb8db9d0135adbe0542bb7e7163616e4f8962919becab171da) and is detailed in this report.\n1352dbb093a337eb8db9d0135adbe0542bb7e7163616e4f8962919becab171da\nTags\ninformation-stealeruploader\nDetails\n\n\n\nName\nresult.exe\n\n\nSize\n1834496 bytes\n\n\nType\nPE32+ executable (console) x86-64 Mono/.Net assembly, for MS Windows\n\n\nMD5\n27a0ba098b8403570c7b1e0863c2d6c5\n\n\nSHA1\n22cb98b9548ffd1010b2799a791ef42b8943f3c9\n\n\nSHA256\n1352dbb093a337eb8db9d0135adbe0542bb7e7163616e4f8962919becab171da\n\n\nSHA512\n7eb71e11947a762d8a9a396de21d6b704f8021acc0ddfc7a959897569d429f3347c9bd1c3206703375d09a81defd3d1f9bba0ea137157d8546b862ded030c4c2\n\n\nssdeep\n49152:F2f6rfgMSneK065JlYaDmxZF5ax00MSMoOKiYyBg9FzfJNFL5QPWES2s1B+dBrSY:F2f6rfgMSneK065JlYaDmxZF5ax00MSt\n\n\nEntropy\n5.579937\n\n\n\nAntivirus\nNo matches found.\nYARA Rules\nNo matches found.\nssdeep Matches\n\n\n\n97\nd221ca9c519ae04c7724baca8d36c2ce77454e0f9aa0f119ecfa9246973a92f8\n\n\n\nPE Metadata\n\n\n\nCompile Date\n2021-10-19 20:19:25-04:00\n\n\nImport Hash\nf34d5f2d4577ed6d9ceec516c1f5a744\n\n\nInternal Name\nClientUploader.exe\n\n\nOriginal Filename\nClientUploader.exe\n\n\nProduct Version\n1.0.0.0\n\n\n\nPE Sections\n\n\n\nMD5\nName\nRaw Size\nEntropy\n\n\n8a2ac318e59571d7c72221d67498bd5f\nheader\n512\n2.722440\n\n\nbe70af56c305ef153e32ecc2430d4d8a\n.text\n1831936\n5.581972\n\n\n5488f249cf62feed84546911d54f96f2\n.rsrc\n1536\n3.971470\n\n\nf80d2b416a07808182a35c49f6967d8f\n.reloc\n512\n0.101910\n\n\n\nRelationships\n\n\n\n1352dbb093...\nCreated\n5ba0d0bfda372c1f6aa382a70f4ab8427ec998b680510e208fdf878cfda9afe3\n\n\n1352dbb093...\nCreated\n0b7d15968d44710b3e7f153c04b5038d03900a6685643bc8efe688c4d5a5deab\n\n\n1352dbb093...\nUsed\nda267c72f58ec487761de99d0f3bcfd87771a36afc06716053960633a74139df\n\n\n1352dbb093...\nDropped_By\n157a0ffd18e05bfd90a4ec108e5458cbde01015e3407b3964732c9d4ceb71656\n\n\n1352dbb093...\nCreated\n0b01f392fa030be1ddd549fb79cf280d2a2c745578a56fedd4cb5e9438ae72cb\n\n\n1352dbb093...\nContained_Within\nb03ac5eaf2131060ee381e5e46ebc705d8d617a90cc61fa4918174545b4fbaa6\n\n\n\nDescription\nThis artifact has been identified as CovalentStealer malware. When the program is executed it will decrypt and read the configuration file ntstatus.ini (da267c72f58ec487761de99d0f3bcfd87771a36afc06716053960633a74139df) in the current directory. It uses the hard-coded AES-256-CBC key \u2018M(xcHq88q[s=pc7^+u_Gb_}JC%QQwP:h\u2019 to decrypt the file. The configuration file will include a path to the directory containing the targeted files, compression parameters, and connection parameters for connecting to a system on the Internet to upload data.\n\nThe malware has several primary modules. The module IFileWorker contains the following functions:\n\n---Begin IFileWorker Functions---\nBrotli. \u2013 This function contains the Brotli compression library to compress and decompress files.\nContainersFilesWorker. \u2013 This function keeps track of uploaded files. It compares the files to a hash list for the file and path before uploading and also compares them to a whitelist and a blacklist by file extension. It also logs the status of each file in the upload process.\nExtension. \u2013 This function checks the file extension to determine if the file needs to be compressed.\nFile Archive. \u2013 This function verifies the size of the file and disposition before compressing the file.\nFileBlock. \u2013 This function converts the file data into a byte stream.\nFileContainers. \u2013 This function segregates files by file type based on the extension.\nGZip. \u2013 This function contains the Gzip compression library to compress and decompress files.\nLogger. \u2013 This function logs debug status messages and telemetry data from other functions and outputs them to a file using the base name and the .dat extension, e.g. ntstatus.dat (See Figure 6).\nWhiteAndBlackList. \u2013 This function maintains a list of files by name and a list of files by extension that match the whitelist or blacklist from the configuration file.\n---End IFileWorker Functions---\n\nNote: The actor utilized this code from the open source project IFileWorker.\n\nThe module OneDriveClient contains the following functions:\n\n---Begin OneDriveClient Functions---\nOneDrive. \u2013 This function uploads files to a Uniform Resource Locator (URL). It configures speed, buffer size, time, etc. based on the parameters in the configuration file, ntstatus.ini. Then, it reports the status of each file to the IFileWorker.Logger function. The following are examples of the OneDrive commands:\n\n\u00a0\u00a0\u00a0 ---Begin OneDrive Commands---\n\u00a0\u00a0\u00a0 OneDriveClient.OneDriveChannel+<Send>\n\u00a0\u00a0\u00a0 OneDriveClient.OneDrive+<GetAccessToken>\n\u00a0\u00a0\u00a0 OneDriveClient.OneDrive+<UploadData>\n\u00a0\u00a0\u00a0 OneDriveClient.OneDrive+<UploadFile>\n\u00a0\u00a0\u00a0 OneDriveClient.OneDrive+<UploadLargeFile>\n\u00a0\u00a0\u00a0 OneDriveClient.OneDrive+<GetUploadUrl>\n\u00a0\u00a0\u00a0 OneDriveClient.OneDrive+<UploadPartWithStopwatch>\n\u00a0\u00a0\u00a0 OneDriveClient.OneDrive+<UploadPart>\n\u00a0\u00a0\u00a0 OneDriveClient.OneDrive+<UploadSmallFileWithStopWatch>\n\u00a0\u00a0\u00a0 OneDriveClient.OneDrive+<UploadSmallFile>\n\u00a0\u00a0\u00a0 ---End OneDriveClient Functions---\n\nOneDriveChannel. \u2013 This function establishes the connection to the server.\nOneDriveChannelSettings. \u2013 This function reads the ClientID, Redirect, Refresh Token, and Scopes from the configuration file, ntstatus.ini to negotiate the connection to the client.\nUploadedFiles. \u2013 This function logs the hash and the file path of the uploaded files and records the information into two files where ntstatus.log contains a list of file hashes and ntstatus_temp.log contains a list of file path hashes (See Figure 7).\n---End OneDriveClient Functions---\n\nThe program also contains supporting libraries for the SMB protocol versions 2 and 3. The libraries have the capacity to maintain a list of IP addresses, logins, domainNames, passwords, and SMB clients that can be used to attempt to search for and log into SMB file stores. Files can be searched by file path, file status (e.g., open or closed), and file attributes (e.g. shared, read only, etc.).\nScreenshots\n\nFigure 6 - The IFileWorker.Logger function is used to generate the log file for debug and telemetry data.\n\nFigure 7 - The OneDriveClient.UploadedFiles function records MD5 hashes of uploaded files into the file ntstatus.log and MD5 hashes of the file paths into the file ntstatus_temp.log.\nda267c72f58ec487761de99d0f3bcfd87771a36afc06716053960633a74139df\nTags\ninformation-stealeruploader\nDetails\n\n\n\nName\nntstatus.ini\n\n\nSize\n3392 bytes\n\n\nType\ndata\n\n\nMD5\nb1a7c2ae593e814cfecdcff709b02615\n\n\nSHA1\nababa956175b2ddae7ec92162a8464b40b79064a\n\n\nSHA256\nda267c72f58ec487761de99d0f3bcfd87771a36afc06716053960633a74139df\n\n\nSHA512\nf511508878f821f80f10d387a60c7bab14c7384cd4ce0a68c73b0331d13d4b716805e3a53794ef0def0062d08eea489ef6239c53c2fa2d7f1c3478aba7e204b1\n\n\nssdeep\n96:m74SD0f7Z2wXZ/BFmcktZdsczgmwL1COPP8yeTY4l9N:s4SDA73Zqlt7gmYQEUyMY4jN\n\n\nEntropy\n7.948675\n\n\n\nAntivirus\nNo matches found.\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\nda267c72f5...\nUsed_By\n1352dbb093a337eb8db9d0135adbe0542bb7e7163616e4f8962919becab171da\n\n\n\nDescription\nThis artifact is the encrypted configuration file for the OneDriveClient module contained in the file result.exe (1352dbb093a337eb8db9d0135adbe0542bb7e7163616e4f8962919becab171da) detailed in this report. The data is decrypted using the hard-coded AES-256-CBC key \u2018M(xcHq88q[s=pc7^+u_Gb_}JC%QQwP:h\u2019. The algorithm uses an IV that is derived from the first half of the encryption key (See Figure 8).\n\nThe file contains multiple paths to archives targeted by the attacker. The file includes the IP address of the server, stolen credential information, and a key to encrypt the uploaded data. NOTE: The decrypted configuration contains confidential client information and therefore is not included in this report.\n\nIn addition, the data contains a refresh token for an OAuth client for Microsoft Azure with the Client ID of \u20187a3b4b84-ed28-4f18-b30d-218788c74a5f\u2019. Speed and compression information as well as times that the OneDrive share can be accessed are also included in the configuration.\nScreenshots\n\nFigure 8 - This is the AES encryption routine. The routine uses the hard-coded string 'M(xcHq88q[s=pc7^+u_Gb_}JC%QQwP:h' as the AES key and the first half of the key as the IV.\n0b01f392fa030be1ddd549fb79cf280d2a2c745578a56fedd4cb5e9438ae72cb\nDetails\n\n\n\nName\nntstatus.bat\n\n\nSize\n91 bytes\n\n\nType\nASCII text, with CRLF line terminators\n\n\nMD5\nd287a50bd0b95d1f153dc071d43e45d3\n\n\nSHA1\ncf1d9da39f4847ee735d46157232585068387763\n\n\nSHA256\n0b01f392fa030be1ddd549fb79cf280d2a2c745578a56fedd4cb5e9438ae72cb\n\n\nSHA512\n1507fd6f41c853f84b7b036280ac6c21556ce5cf10b4008c2902020291255b5bb55e63ebda9921032fd8ebf7f9fd8fffbb7de40e696601bee1486a6155b2a5ed\n\n\nssdeep\n3:nlKsoFDLAdAIvVNIGfMMAyIJooORKQExLAdAn:n25ABvoGfdICFRZENAC\n\n\nEntropy\n4.579538\n\n\n\nAntivirus\nNo matches found.\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\n0b01f392fa...\nCreated_By\n1352dbb093a337eb8db9d0135adbe0542bb7e7163616e4f8962919becab171da\n\n\n0b01f392fa...\nRelated_To\n157a0ffd18e05bfd90a4ec108e5458cbde01015e3407b3964732c9d4ceb71656\n\n\n\nDescription\nThis artifact is a batch file (.bat) that terminates the current process of ntstatus.exe (157a0ffd18e05bfd90a4ec108e5458cbde01015e3407b3964732c9d4ceb71656). It then changes to the directory C:\\windows\\modemlogs\\ and invokes a new instance of ntstatus.exe.\n5ba0d0bfda372c1f6aa382a70f4ab8427ec998b680510e208fdf878cfda9afe3\nDetails\n\n\n\nName\nntstatus.log\n\n\nSize\n17520 bytes\n\n\nType\ndata\n\n\nMD5\n5753ddd324c2054718252c834d93aac9\n\n\nSHA1\na2e852b0d911ced7011a7b954fc379c0d0564fc5\n\n\nSHA256\n5ba0d0bfda372c1f6aa382a70f4ab8427ec998b680510e208fdf878cfda9afe3\n\n\nSHA512\nc326d682fdad505f414bbbbbbcd219d40f8f9948c40ffcfd28a5ac5d9cfec647d5f2712ea23eb79bfafd19edfb49577a75f0f99c616abc444da62820eeee4dc6\n\n\nssdeep\n384:VEiJb1Xwe87kARzd/CT74lZzRdNKHa7QYopmafni+/5vFdIg:VONdKgVm8Qognie5vFdIg\n\n\nEntropy\n7.989546\n\n\n\nAntivirus\nNo matches found.\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\n5ba0d0bfda...\nCreated_By\n1352dbb093a337eb8db9d0135adbe0542bb7e7163616e4f8962919becab171da\n\n\n\nDescription\nThis artifact is a log file created by the OneDriveClient.UploadedFiles function contained in the file result.exe (1352dbb093a337eb8db9d0135adbe0542bb7e7163616e4f8962919becab171da). The file contains the MD5 hash of each file that has been uploaded to the remote server.\n0b7d15968d44710b3e7f153c04b5038d03900a6685643bc8efe688c4d5a5deab\nDetails\n\n\n\nName\nntstatus_temp.log\n\n\nSize\n17520 bytes\n\n\nType\ndata\n\n\nMD5\nadfac9c5ef66c21b85fde6503c025b58\n\n\nSHA1\nd7950ad0cc1798f2184be502fcb12bc0a6f27864\n\n\nSHA256\n0b7d15968d44710b3e7f153c04b5038d03900a6685643bc8efe688c4d5a5deab\n\n\nSHA512\nf14a0b26627b15f628a702deca3ec1696c518cdd05f70426d5a4631a8ec6ced60ab96bfdadcbb362c27932de9a95f4794656379a5512eac3774f84e569fe2671\n\n\nssdeep\n384:gyf7wfPR70mHa7Kdghm5dnB9Yr+DLPim849pbm0NNzt0B1rzLw2nd:wBvKKdghAB9YreLPF84r1N5t0B1XT\n\n\nEntropy\n7.990357\n\n\n\nAntivirus\nNo matches found.\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\n0b7d15968d...\nCreated_By\n1352dbb093a337eb8db9d0135adbe0542bb7e7163616e4f8962919becab171da\n\n\n\nDescription\nThis artifact is a log file created by the OneDriveClient.UploadedFiles function contained in the file result.exe (1352dbb093a337eb8db9d0135adbe0542bb7e7163616e4f8962919becab171da). The file contains the MD5 hash of the file path for each file that has been uploaded to the remote server.\n3585c3136686d7d48e53c21be61bb2908d131cf81b826acf578b67bb9d8e9350\nTags\ndownloaderinformation-stealertrojanuploader\nDetails\n\n\n\nName\nmqsvn.exe\n\n\nSize\n114688 bytes\n\n\nType\nPE32+ executable (console) x86-64 Mono/.Net assembly, for MS Windows\n\n\nMD5\n63cf36ac25788e13b41b1eb6bfc0c6b6\n\n\nSHA1\n22ab6af92ddd984bd054c21799742a5e498e8453\n\n\nSHA256\n3585c3136686d7d48e53c21be61bb2908d131cf81b826acf578b67bb9d8e9350\n\n\nSHA512\n52ecffb0004f5aee6f3a0c7e0edcbe1079845e20a712ac26854921dea9b46ece0d5f89698e833804ebdc9c3f525a8cc8c7a6d781b0caf3164b81cea17edae5c8\n\n\nssdeep\n3072:KNcJNunM5p0TKWODtcT1hR3o92JoeEcfcEcKHWjUNSGdyRCOKFWc70OrZKqaJjLt:Kyf0M5p0TKWwcBhR3o92JoRcJhHMUNSz\n\n\nEntropy\n5.801283\n\n\n\nAntivirus\n\n\n\nIKARUS\nTrojan.MSIL.Crypt\n\n\n\nYARA Rules\n\nrule CISA_10365227_02 : ClientUploader\n\t{\n\t\u00a0\u00a0\u00a0meta:\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Author = \"CISA Code & Media Analysis\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Incident = \"10365227\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Date = \"2021-12-23\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Last_Modified = \"20211224_1200\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Actor = \"n/a\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Category = \"n/a\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Family = \"n/a\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Description = \"Detects ClientUploader_mqsvn\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0MD5_1 = \"63cf36ac25788e13b41b1eb6bfc0c6b6\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0SHA256_1 = \"3585c3136686d7d48e53c21be61bb2908d131cf81b826acf578b67bb9d8e9350\"\n\t\u00a0\u00a0\u00a0strings:\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s1 = \"UploadSmallFileWithStopWatch\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s2 = \"UploadPartWithStopwatch\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s3 = \"AppVClient\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s4 = \"ClientUploader\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s5 = { 46 69 6C 65 43 6F 6E 74 61 69 6E 65 72 2E 46 69 6C 65 41 72 63 68 69 76 65 }\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s6 = { 4F 6E 65 44 72 69 76 65 43 6C 69 65 6E 74 2E 4F 6E 65 44 72 69 76 65 }\n\t\u00a0\u00a0\u00a0condition:\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0uint16(0) == 0x5a4d and all of them\n\t}\n\nssdeep Matches\nNo matches found.\nPE Metadata\n\n\n\nCompile Date\n2021-06-30 15:10:41-04:00\n\n\nCompany Name\nMicrosoft Corporation\n\n\nFile Description\nAppVClient.exe\n\n\nInternal Name\nNone\n\n\nLegal Copyright\n\u00a9 Microsoft Corporation. All rights reserved.\n\n\nOriginal Filename\nNone\n\n\nProduct Name\nAppVClient.exe\n\n\nProduct Version\n10.0.19041.84\n\n\n\nPE Sections\n\n\n\nMD5\nName\nRaw Size\nEntropy\n\n\nbdd5c1c64355001493f1f48cc64646a3\nheader\n512\n2.279615\n\n\n204dc02c928d7206969d5e40f4ed4de4\n.text\n112640\n5.814718\n\n\nc574847bfb2e8be8830c3d846238d2d6\n.rsrc\n1536\n4.261328\n\n\n\nPackers/Compilers/Cryptors\n\n\n\nMicrosoft Visual C++ v6.0\n\n\n\nRelationships\n\n\n\n3585c31366...\nUsed\n25afc6741abfa27f5b50844331772466182ebe3f74bc84f911314d1a68c62cb2\n\n\n3585c31366...\nCreated\n603e75db59285734cfb5a469e984c4e359e660ccb7836ff9c209aec36931bc2b\n\n\n\nDescription\nThis artifact is a variant of CovalentStealer malware. The program is a file management system that is capable of uploading files to the Internet.\n\nThis variant of CovalentStealer malware contains two main modules, FileContainer and OneDriveClient, with the following functions:\n\n---Begin Functions---\nClientUploader.Program<Main>\nFileContainer.FileArchive<Add>\nFileContainer.FileStorage<GetData>\nOneDriveClient.OneDriveChannel<Send>\nOneDriveClient.OneDrive<GetAccessToken>\nOneDriveClient.OneDrive<UploadData>\nOneDriveClient.OneDrive<UploadFile>\nOneDriveClient.OneDrive<UploadLargeFile>\nOneDriveClient.OneDrive<GetUploadUrl>\nOneDriveClient.OneDrive<UploadPartWithStopwatch>\nOneDriveClient.OneDrive<UploadPart>\nOneDriveClient.OneDrive<UploadSmallFileWithStopWatch>\nOneDriveClient.OneDrive<UploadSmallFile>\n---End Functions---\n\nThe FileContainer module is used to enumerate and categorize files on the system. This module is capable of generating an MD5 hash of each file and compressing files using the Gzip or Brotli algorithms. The OneDriveClient module is used to upload files to a Microsoft Azure server on the Internet.\n\nThe program will look for a configuration file with the same name as the application and the .ini extension, e.g. mqsvn.ini (25afc6741abfa27f5b50844331772466182ebe3f74bc84f911314d1a68c62cb2). Alternatively, if this file is not found it will look for the file \u2018config.ini\u2019 (See Figure 9).\n\nThe configuration file is decoded using the AES-256-CBC key M(xcHq88q[s=pc7^+u_Gb_}JC%QQwP:h that is derived from the de-serialized string TSh4Y0hxODhxW3M9cGM3Xit1X0diX31KQyVRUXdQOmg= embedded in the file. The first 16 bytes of the key are then used as an IV (See Figure 8 above).\n\nOther strings were de-serialized to provide additional parameters for the malware program. For example, the string LmJtcDsuanBnOy5qcGVnOy50aWZmOy50AWV7LnBuZw== decoded to a block list of files that the program is supposed to skip containing the extensions \u2018.bmp;.jpg;.jpeg;.tiff;.tif;.png\u2019 and the string LmRvY3g7Lnhsc3g7LnBwdHg= decoded to a list of file extensions that the program is supposed to compress before encrypting and exfiltrating. The extensions included \u2018.docx;.xlsx;.pptx\u2019 (See Figure 10).\n\nThe configuration file contains a refresh token for an OAuth client for Microsoft Azure as well as a ClientID. In addition, it contains a path to the files targeted for uploading, upload times, an encryption key to encrypt the files before uploading, and compression parameters.\nScreenshots\n\nFigure 9 - The ClientUploader program attempts to load a configuration file with an .ini extension from the current directory. The base64 encoded string 'Lmlua@==' represents the .ini extension.\n\nFIgure 10 - The ClientUploader program uses the JavaScriptSerializer routine to decode the parameters required to harvest and upload the documents.\n25afc6741abfa27f5b50844331772466182ebe3f74bc84f911314d1a68c62cb2\nDetails\n\n\n\nName\nmqsvn.ini\n\n\nSize\n800 bytes\n\n\nType\ndata\n\n\nMD5\n14b8e37952e1f532be9db40f654e6ac7\n\n\nSHA1\n01d6b5df5761904b7c8c6c4e34490675d4fa0f36\n\n\nSHA256\n25afc6741abfa27f5b50844331772466182ebe3f74bc84f911314d1a68c62cb2\n\n\nSHA512\nc427510f53e54eeea55e2b747bb58f46488f983c47699772d774a94038bc16b12d332741db958c63324258130b9d0376ae2687d5e7a622d9a853717680833f56\n\n\nssdeep\n24:Y4yqp1BHGwUtSiW0nwPQV1iIN1RBZchbLWuL6e7ZeY:tyqLBm9tSawPPIn7Kqm7t\n\n\nEntropy\n7.761942\n\n\n\nAntivirus\nNo matches found.\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\n25afc6741a...\nUsed_By\n3585c3136686d7d48e53c21be61bb2908d131cf81b826acf578b67bb9d8e9350\n\n\n\nDescription\nThis artifact is the encrypted configuration file for the OneDriveClient module contained in the file mqsvn.exe (3585c3136686d7d48e53c21be61bb2908d131cf81b826acf578b67bb9d8e9350). The data is decrypted using the de-serialized key M(xcHq88q[s=pc7^+u_Gb_}JC%QQwP:h found in mqsvn.exe, detailed in this report.\n\nThe file contains a path to an archive targeted by the attacker. The file includes the AES-256-CBC key 1khvo39Q2evpi**&R$*^Rjhko8tve2b7 that is used to encrypt the harvested documents before they are uploaded to the Internet.\n\nIn addition, the data contains a refresh token for an OAuth client for Microsoft Azure with the Client ID of \u20187a3b4b84-ed28-4f18-b30d-218788c74a5f\u2019. Speed and compression information as well as times that the OneDrive share can be accessed are also included in the configuration. NOTE: The decrypted configuration contains confidential client information and is therefore not included in this report.\n603e75db59285734cfb5a469e984c4e359e660ccb7836ff9c209aec36931bc2b\nDetails\n\n\n\nName\nmqsvn.log\n\n\nSize\n39504 bytes\n\n\nType\ndata\n\n\nMD5\n444ccf674588f47ab5638fb08db98b01\n\n\nSHA1\n4fcf2c22d2ea70430580b487a7834c165deee5d0\n\n\nSHA256\n603e75db59285734cfb5a469e984c4e359e660ccb7836ff9c209aec36931bc2b\n\n\nSHA512\n843cdead51e290ee5466f51f316c5199259b7e55b752efbdcfa83a5c64a0477a4ddcd3ab63785e9e25c01095670073884943fa0419797c0b74d30a9ae240d0cf\n\n\nssdeep\n768:eYarzB8pLwTFL/FX8ANpGMVYO5kELiD4Z8xKzvkA6A3zZesChaFRR:eYaXB8pKF18ANkMX6ELh8xivpzZDC4FH\n\n\nEntropy\n7.995061\n\n\n\nAntivirus\nNo matches found.\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\n603e75db59...\nCreated_By\n3585c3136686d7d48e53c21be61bb2908d131cf81b826acf578b67bb9d8e9350\n\n\n\nDescription\nThis artifact contains encrypted MD5 hashes of files that have been uploaded to the Internet by the file mqsvn.exe (3585c3136686d7d48e53c21be61bb2908d131cf81b826acf578b67bb9d8e9350).\n30191b3badf3cdbc65d0ffeb68e0f26cef10a41037351b0f562ab52fce7432cc\nTags\ninformation-stealerobfuscateduploader\nDetails\n\n\n\nName\nmsexch.exe\n\n\nSize\n6656 bytes\n\n\nType\nPE32+ executable (GUI) x86-64 Mono/.Net assembly, for MS Windows\n\n\nMD5\nbaa634fdd2b34956524b5519ee97b8a8\n\n\nSHA1\ncdc7e3b6905f69d8330c4b0f71494a7db7ac61e7\n\n\nSHA256\n30191b3badf3cdbc65d0ffeb68e0f26cef10a41037351b0f562ab52fce7432cc\n\n\nSHA512\ncdcd245fc1dc5072918950b1950527f0b6284453f527623cb600afc775f2cde507278273c75b4af972ac976c06fa73d414350b92c24c7a1dec44aa05527ca532\n\n\nssdeep\n96:LDuLc7D604Vp9Rzj1HhaUA3zvDwi0MX7gtKflUTsqzNt:LDuw6rVd3aP7Dw9MEQmT\n\n\nEntropy\n4.869180\n\n\n\nAntivirus\n\n\n\nAdaware\nGen:Variant.Tedy.82790\n\n\nBitdefender\nGen:Variant.Tedy.82790\n\n\n\nYARA Rules\n\nrule CISA_10365227_01 : APPSTORAGE\n\t{\n\t\u00a0\u00a0\u00a0meta:\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Author = \"CISA Code & Media Analysis\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Incident = \"10365227\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Date = \"2021-12-23\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Last_Modified = \"20211224_1200\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Actor = \"n/a\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Category = \"n/a\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Family = \"APPSTORAGE\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Description = \"Detects AppStorage_ntstatus_msexch samples\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0MD5_1 = \"c435d133b45783cce91a5d4e4fbe3f52\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0SHA256_1 = \"157a0ffd18e05bfd90a4ec108e5458cbde01015e3407b3964732c9d4ceb71656\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0MD5_2 = \"baa634fdd2b34956524b5519ee97b8a8\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0SHA256_2 = \"30191b3badf3cdbc65d0ffeb68e0f26cef10a41037351b0f562ab52fce7432cc\"\n\t\u00a0\u00a0\u00a0strings:\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s1 = \"026B924DD52F8BE4A3FEE8575DC\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s2 = \"GetHDDId\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s3 = \"AppStorage\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s4 = \"AppDomain\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s5 = \"$1e3e5580-d264-4c30-89c9-8933c948582c\"\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s6 = \"hrjio2mfsdlf235d\" wide\n\t\u00a0\u00a0\u00a0condition:\n\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0uint16(0) == 0x5a4d and all of them\n\t}\n\nssdeep Matches\nNo matches found.\nPE Metadata\n\n\n\nCompile Date\n2083-06-18 19:48:42-04:00\n\n\nInternal Name\nAppStorage.exe\n\n\nOriginal Filename\nAppStorage.exe\n\n\nProduct Version\n1.0.0.0\n\n\n\nPE Sections\n\n\n\nMD5\nName\nRaw Size\nEntropy\n\n\n9b75c9220e4242a6403f02bb9da3d198\nheader\n512\n2.261868\n\n\na69c4d0928332121839c97d955246112\n.text\n4608\n5.236469\n\n\n0551c676439e5d812cb2bab3f2060c1b\n.rsrc\n1536\n3.934855\n\n\n\nPackers/Compilers/Cryptors\n\n\n\nMicrosoft Visual C++ v6.0\n\n\n\nRelationships\n\n\n\n30191b3bad...\nRelated_To\ne03a2c8a6e81cf62ba7401c598ea1d4635b08bbf9c2fec080b536dde29e6392f\n\n\n30191b3bad...\nDropped\nd221ca9c519ae04c7724baca8d36c2ce77454e0f9aa0f119ecfa9246973a92f8\n\n\n\nDescription\nThis artifact is an obfuscated .NET executable that is used to decode a variant of the CovalentStealer malware. When executed, the program will check the present name of the program and then look in the current directory for a file with the same name and a .bin extension, e.g. msexch.bin (e03a2c8a6e81cf62ba7401c598ea1d4635b08bbf9c2fec080b536dde29e6392f).\n\nThe program seeks to generate a key called \u2018HDDId\u2019 to decode msexch.bin. The embedded string \u2018hrjio2mfsdlf235d\u2019 is used to decode instructions within the program to generate the key (See Figure 3 above). This function is similar to the function described in ntstatus.exe detailed elsewhere in this report, however it will take one additional variable to generate the key. The first command identifies the current userName on the system while the second command identifies the machineName. The third command reads the WMI namespace root/cimv2 to locate the volumeserialnumber of the current drive. All of the variables are then modified using an XOR routine and the same string above is used to generate the key (See Figure 11). The first part of the key is generated from the volume serial number which, during analysis resolved to \u201876D55BD2\u2019. The second part of the key is resolved from the userName, which during analysis resolved to \u201834BD153B\u2019. The last part of the key is resolved from the machineName, which resolved to \u2018F3124EDD\u2019 creating the key \u201876D55BD234BD153BF3124EDD\u2019 (See Figure 12). Note: The key is an example.\n\nTo generate the correct key, the userName, machineName, and volumeserialnumber must match the victim\u2019s system, otherwise it fails to decode msexch.bin and the program will terminate. This method is used to thwart independent analysis of the file, msexch.bin.\nScreenshots\n\nFigure 11 - The program collects the userName, machineName, and Volume Serial Number to generate the HDDId key.\n\nFigure 12 - Screenshot of the generated HDDId key used to decode msexch.bin.\ne03a2c8a6e81cf62ba7401c598ea1d4635b08bbf9c2fec080b536dde29e6392f\nTags\ninformation-stealerobfuscateduploader\nDetails\n\n\n\nName\nmsexch.bin\n\n\nSize\n1834496 bytes\n\n\nType\ndata\n\n\nMD5\nbd95f0df1272e5b2854b304c71930168\n\n\nSHA1\n2d28c56daf370370d1c4d95fd25e4f0a04ceda07\n\n\nSHA256\ne03a2c8a6e81cf62ba7401c598ea1d4635b08bbf9c2fec080b536dde29e6392f\n\n\nSHA512\nb01a5b459f0b3b619b742f717e7b536cf713dded36b542d5546a59333c6008aaab0c844a9979b4450dc1a1ced5af41beebfda41191920a678026c63fdf7934dd\n\n\nssdeep\n24576:KNCSFczkVbstNn2I4Evj6ZaIDLdjFu1u1Ww1YfduAiG52Qqlsvz66ZG+b38tTnt4:hz7ePzJuss4caq\n\n\nEntropy\n6.682404\n\n\n\nAntivirus\nNo matches found.\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\ne03a2c8a6e...\nRelated_To\n30191b3badf3cdbc65d0ffeb68e0f26cef10a41037351b0f562ab52fce7432cc\n\n\n\nDescription\nThis is an obfuscated version of CovalentStealer malware. The file is decoded by msexch.exe using the key '76D55BD234BD153BF3124EDD'. The decoded file is called Uploader.exe (d221ca9c519ae04c7724baca8d36c2ce77454e0f9aa0f119ecfa9246973a92f8) and is detailed in this report.\nd221ca9c519ae04c7724baca8d36c2ce77454e0f9aa0f119ecfa9246973a92f8\nTags\ninformation-stealeruploader\nDetails\n\n\n\nName\nUploader.exe\n\n\nSize\n1834496 bytes\n\n\nType\nPE32+ executable (console) x86-64 Mono/.Net assembly, for MS Windows\n\n\nMD5\nf54ae2b0d51bb4cdc2a142733f122311\n\n\nSHA1\n184adab2435e4b0f9b02521fed5e56390b5e775f\n\n\nSHA256\nd221ca9c519ae04c7724baca8d36c2ce77454e0f9aa0f119ecfa9246973a92f8\n\n\nSHA512\n97ed8086dde00af3cbf51c02073aec28957a6bf354799f489ee7c457e82e0b21d7d2fb6ba46589675ed22d51aa0d973ab7d4132a2aeeb0adf15da618d4fb83cd\n\n\nssdeep\n49152:Z2f6rfgMSneK065JlYaDmxZF5ax00MSMoOKiYyBg9FzfJNFL5QPWES2s1B+dBrSC:Z2f6rfgMSneK065JlYaDmxZF5ax00MSt\n\n\nEntropy\n5.580993\n\n\n\nAntivirus\nNo matches found.\nYARA Rules\nNo matches found.\nssdeep Matches\n\n\n\n97\n1352dbb093a337eb8db9d0135adbe0542bb7e7163616e4f8962919becab171da\n\n\n\nPE Metadata\n\n\n\nCompile Date\n2021-09-24 14:56:17-04:00\n\n\nImport Hash\nf34d5f2d4577ed6d9ceec516c1f5a744\n\n\nInternal Name\nClientUploader.exe\n\n\nOriginal Filename\nClientUploader.exe\n\n\nProduct Version\n1.0.0.0\n\n\n\nPE Sections\n\n\n\nMD5\nName\nRaw Size\nEntropy\n\n\na1eef53765269a304aaa217af7ede436\nheader\n512\n2.725476\n\n\n489bbfac9377f3ef9a60f9d64d9ccda8\n.text\n1831936\n5.583032\n\n\n5488f249cf62feed84546911d54f96f2\n.rsrc\n1536\n3.971470\n\n\nfbf8fada938118d358a40e73eb0c8bb9\n.reloc\n512\n0.101910\n\n\n\nRelationships\n\n\n\nd221ca9c51...\nUsed\n52765525103f5b3b07d0882cc8ee4bb8e279ad5d451e1ed07cae3b98565cce29\n\n\nd221ca9c51...\nCreated\n09605981a072c604e6ef9ad2dd7d2a78b48b07ee3339589bfcf0a466a9190904\n\n\nd221ca9c51...\nCreated\n6a0cd866c849e62f9ccc26575d8794c2e0b14722387742b965d4358e1e0e8b3c\n\n\nd221ca9c51...\nDropped_By\n30191b3badf3cdbc65d0ffeb68e0f26cef10a41037351b0f562ab52fce7432cc\n\n\n\nDescription\nThis artifact is a variant of the CovalentStealer program. When the program is executed it will decrypt and read the configuration file msexch.ini (52765525103f5b3b07d0882cc8ee4bb8e279ad5d451e1ed07cae3b98565cce29) in the current directory. It uses the hard-coded AES-256-CBC key \u2018M(xcHq88q[s=pc7^+u_Gb_}JC%QQwP:h\u2019 to decrypt the file. The configuration file will include a path to the directory containing the targeted files, compression parameters, and connection parameters for connecting to a system on the Internet to upload data.\n\nClientUploader has several primary modules. The module IFileWorker contains the following functions:\n\n---Begin IFileWorker Functions---\nBrotli. \u2013 This function contains the Brotli compression library to compress and decompress files.\nContainersFilesWorker. \u2013 This function keeps track of uploaded files. It compares the files to a hash list for the file and path before uploading and also compares them to a whitelist and a blacklist by file extension. It also logs the status of each file in the upload process.\nExtension. \u2013 This function checks the file extension to determine if the file needs to be compressed.\nFile Archive. \u2013 This function verifies the size of the file and disposition before compressing the file.\nFileBlock. \u2013 This function converts the file data into a byte stream.\nFileContainers. \u2013 This function segregates files by file type based on the extension.\nGZip. \u2013 This function contains the Gzip compression library to compress and decompress files.\nLogger. \u2013 This function logs debug status messages and telemetry data from other functions and outputs them to a file using the base name and the .dat extension, e.g. msexch.dat (See Figure 4 above).\nWhiteAndBlackList. \u2013 This function maintains a list of files by name and a list of files by extension that match the whitelist or blacklist from the configuration file.\n---End IFileWorker Functions---\n\nThe module OneDriveClient contains the following functions:\n\n---Begin OneDriveClient Functions---\nOneDrive. \u2013 This function uploads files to a URL. It configures speed, buffer size, time, etc. based on the parameters in the configuration file, msexch.ini. Then, it reports the status of each file to the IFileWorker.Logger function. The following are examples of the OneDrive commands:\n\n\u00a0\u00a0\u00a0 ---Begin OneDrive Commands---\n\u00a0\u00a0\u00a0 OneDriveClient.OneDriveChannel+<Send>\n\u00a0\u00a0\u00a0 OneDriveClient.OneDrive+<GetAccessToken>\n\u00a0\u00a0\u00a0 OneDriveClient.OneDrive+<UploadData>\n\u00a0\u00a0\u00a0 OneDriveClient.OneDrive+<UploadFile>\n\u00a0\u00a0\u00a0 OneDriveClient.OneDrive+<UploadLargeFile>\n\u00a0\u00a0\u00a0 OneDriveClient.OneDrive+<GetUploadUrl>\n\u00a0\u00a0\u00a0 OneDriveClient.OneDrive+<UploadPartWithStopwatch>\n\u00a0\u00a0\u00a0 OneDriveClient.OneDrive+<UploadPart>\n\u00a0\u00a0\u00a0 OneDriveClient.OneDrive+<UploadSmallFileWithStopWatch>\n\u00a0\u00a0\u00a0 OneDriveClient.OneDrive+<UploadSmallFile>\n\u00a0\u00a0\u00a0 ---End OneDriveClient Functions---\n\nOneDriveChannel. \u2013 This function establishes the connection to server.\nOneDriveChannelSettings. \u2013 This function reads the ClientID, Redirect, Refresh Token, and Scopes from the configuration file, msexch.ini to negotiate the connection to the client.\nUploadedFiles. \u2013 This function logs the hash and the file path of the uploaded files and records the information into two files where msexch.log contains a list of file hashes and msexch_temp.log contains a list of file path hashes (See Figure 7 above).\n---End OneDriveClient Functions---\n\nThe program also contains supporting libraries for the SMB protocol versions 2 and 3. The libraries have the capacity to maintain a list of IP addresses, logins, domainNames, passwords, and SMB clients that can be used to attempt to search for and log into SMB file stores. Files can be searched by file path, file status (e.g., open or closed), and file attributes (e.g. shared, read only, etc.).\n52765525103f5b3b07d0882cc8ee4bb8e279ad5d451e1ed07cae3b98565cce29\nTags\ninformation-stealeruploader\nDetails\n\n\n\nName\nmsexch.ini\n\n\nSize\n4816 bytes\n\n\nType\ndata\n\n\nMD5\nd3951137283e84d42f85bb91f0ccfcdd\n\n\nSHA1\n450982b1420a97dcedb15fb058e00e108d240bb7\n\n\nSHA256\n52765525103f5b3b07d0882cc8ee4bb8e279ad5d451e1ed07cae3b98565cce29\n\n\nSHA512\n082594fced158d5597e1b34ec220fd873365f3ec282add680fc84d4b31010c2485e97611049c2d1432b6a1014784e06d3b11f14a815252a28c0c38c4eb5a31e1\n\n\nssdeep\n96:XaMTeYZR1Bm3AboPwVUJyWvihHbP11Ho+5EGsW7MlDz1v7Yrtgx3X:XaWZZR1Bx9VP16+5jRQlDR8U\n\n\nEntropy\n7.963703\n\n\n\nAntivirus\nNo matches found.\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\n5276552510...\nUsed_By\nd221ca9c519ae04c7724baca8d36c2ce77454e0f9aa0f119ecfa9246973a92f8\n\n\n\nDescription\nThis artifact is the encrypted configuration file for the OneDriveClient module contained in the file Uploader.exe (d221ca9c519ae04c7724baca8d36c2ce77454e0f9aa0f119ecfa9246973a92f8) detailed in this report. The data is decrypted using the hard-coded AES-256-CBC key \u2018M(xcHq88q[s=pc7^+u_Gb_}JC%QQwP:h\u2019. The algorithm uses an IV that is derived from the first half of the encryption key (See Figure 8 above).\n\nThe file contains multiple paths to archives targeted by the attacker. The file includes the IP address of the server, stolen credential information, and a key to encrypt the uploaded data. NOTE: The decrypted configuration contains confidential client information and therefore is not included in this report.\n\nIn addition, the data contains a refresh token for an OAuth client for Microsoft Azure with the Client ID of \u20187a3b4b84-ed28-4f18-b30d-218788c74a5f\u2019. Speed and compression information as well as times that the OneDrive share can be accessed are also included in the configuration.\n09605981a072c604e6ef9ad2dd7d2a78b48b07ee3339589bfcf0a466a9190904\nDetails\n\n\n\nName\nmsexch.log\n\n\nSize\n103904 bytes\n\n\nType\ndata\n\n\nMD5\n30ea2a37c7174ed8c3ab88aecee0002b\n\n\nSHA1\n3a6f2826aab7948d8b930f6bf13897160c198807\n\n\nSHA256\n09605981a072c604e6ef9ad2dd7d2a78b48b07ee3339589bfcf0a466a9190904\n\n\nSHA512\n0a78caf6257b8b58578181a9555bf9cee24b1bfced078855145f79757701a53a15968d9bb6acc74fdc9469bd28fa82a53b8d52669fa3952824f51339bd94ad7a\n\n\nssdeep\n3072:OcopRvQIpMV/EN6PmW9tV/PUdpogFeSQx7:CpVFp8/pFhPUdponR7\n\n\nEntropy\n7.998490\n\n\n\nAntivirus\nNo matches found.\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\n09605981a0...\nCreated_By\nd221ca9c519ae04c7724baca8d36c2ce77454e0f9aa0f119ecfa9246973a92f8\n\n\n\nDescription\nThis artifact is a log file created by the OneDriveClient.UploadedFiles function contained in the file Uploader.exe (d221ca9c519ae04c7724baca8d36c2ce77454e0f9aa0f119ecfa9246973a92f8). The file contains the MD5 hash of each file that has been uploaded to the remote server.\n6a0cd866c849e62f9ccc26575d8794c2e0b14722387742b965d4358e1e0e8b3c\nDetails\n\n\n\nName\nmsexch_temp.log\n\n\nSize\n103904 bytes\n\n\nType\ndata\n\n\nMD5\n20b7eb0af9b9e7403a298f7966d5a1d4\n\n\nSHA1\nb2018e61e8b435b6a172b35774377ebc16fd0168\n\n\nSHA256\n6a0cd866c849e62f9ccc26575d8794c2e0b14722387742b965d4358e1e0e8b3c\n\n\nSHA512\n3695120b452c103f54c4eb738648621f162850ec32aca734ecdd552755ecced1500aaf789ec1bf45afc5df4fcfd6144ca4d1fff415a25656dd5493f81b221bfe\n\n\nssdeep\n3072:2H05Z4/LivIjqjSXZa8HaDhpfUcJkm0YK/:29ivImjSX9qnUcdi\n\n\nEntropy\n7.998385\n\n\n\nAntivirus\nNo matches found.\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\n6a0cd866c8...\nCreated_By\nd221ca9c519ae04c7724baca8d36c2ce77454e0f9aa0f119ecfa9246973a92f8\n\n\n\nDescription\nThis artifact is a log file created by the OneDriveClient.UploadedFiles function contained in the file Uploader.exe (d221ca9c519ae04c7724baca8d36c2ce77454e0f9aa0f119ecfa9246973a92f8). The file contains the MD5 hash of the path for each file that has been uploaded to the remote server.\nfae38156e9ce12368c846836b87861f4f12e14698cb65f14545205fa56d8c496\nTags\ninformation-stealer\nDetails\n\n\n\nName\nvmware.ps1\n\n\nSize\n10436 bytes\n\n\nType\nASCII text\n\n\nMD5\n4825b1e32ff062f4671d5420661695af\n\n\nSHA1\n0cbf85f88e2fb0bc721357acdd543d5a1957886f\n\n\nSHA256\nfae38156e9ce12368c846836b87861f4f12e14698cb65f14545205fa56d8c496\n\n\nSHA512\na58298346cdf35e432d755942ef2690c6e3182a4fab03df163142e42cdcb0d7bc3810c647078a779d15ee0676b0eacfa59c38512671dc86264b42f2c8d69edb8\n\n\nssdeep\n192:k9XNMA6GyvE0XJvP0EN3ab3Akz9JUWCUVCRB7/dUV/TpraVm5efUo9wQUyfa3gpA:k9XNMA6pXJvPCUjUmUvaME8obUaYgpj8\n\n\nEntropy\n4.979828\n\n\n\nAntivirus\nNo matches found.\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nDescription\nThis artifact is a script called Export-MFT.ps1 written in PowerShell used to collect the MFT from a system volume. The benign open source script is available on GitHub.\nbfa7adeda4597b70bf74a9f2032df2f87e07f2dbb46e85cb7c091b83161d6b0a\nDetails\n\n\n\nName\nvmware.exe\n\n\nSize\n497104 bytes\n\n\nType\nPE32 executable (console) Intel 80386, for MS Windows\n\n\nMD5\n0acb06da48d86e1ef15c27a4f5a3bddd\n\n\nSHA1\n12dd7a86001ff2b6b661cd7de60ca6aadc9b78ae\n\n\nSHA256\nbfa7adeda4597b70bf74a9f2032df2f87e07f2dbb46e85cb7c091b83161d6b0a\n\n\nSHA512\n98fbcd4e190e0bc17dc712bbbe808c7d24610c334925381544fb16a8f75931db1c5f6597cafbe6a12a9050e482e55351bedb76b40573f8a7489e3c7755bdecd2\n\n\nssdeep\n12288:1NsUjyDukqiudnJkx3piQLmGLvdnTJ0CRUyF1I3Kl:1mkyDuZiCccQLmGpTrCm1I3g\n\n\nEntropy\n6.459391\n\n\n\nAntivirus\nNo matches found.\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nPE Metadata\n\n\n\nCompile Date\n2014-12-02 05:07:13-05:00\n\n\nImport Hash\n1324fa350b5f878451cc28b429b96e9b\n\n\nCompany Name\nAlexander Roshal\n\n\nFile Description\nCommand line RAR\n\n\nInternal Name\nCommand line RAR\n\n\nLegal Copyright\nCopyright \u00a9 Alexander Roshal 1993-2014\n\n\nOriginal Filename\nNone\n\n\nProduct Name\nWinRAR\n\n\nProduct Version\n5.20.0\n\n\n\nPE Sections\n\n\n\nMD5\nName\nRaw Size\nEntropy\n\n\n98efedab8c1234a79df40e93dc82e136\nheader\n1024\n2.635435\n\n\n0b760a9dbbf12c5d32ca265879aabdb2\n.text\n410112\n6.587893\n\n\n3874d7a1d17b892215dc07687ac3b75c\n.rdata\n27136\n4.857459\n\n\ne28ebcc7f9a5e3d463ee9d9de071e085\n.data\n8192\n3.720474\n\n\n5ad98aabb9c5996ee180a98ff9543866\n.rsrc\n31232\n3.540367\n\n\nec534cec214c136ef4552b79103e2eaa\n.reloc\n14336\n5.427399\n\n\n\nPackers/Compilers/Cryptors\n\n\n\nMicrosoft Visual C++ ?.?\n\n\n\nDescription\nThis artifact is a benign publicly available version of the Roshal archiver (RAR), version 5.20.0. RAR.exe is used to compress and archive other files.\nRelationship Summary\n\n\n\n84164e1e80...\nUsed\n91a8b31c126a021f5c156742016acdcca7d83eac4b583bae5d4fd0a85a96813b\n\n\n84164e1e80...\nCreated\n517faa4a0666ec68842f256f08d987935b6ce9ef64e33f027e084e8f45b9366d\n\n\n517faa4a06...\nCreated_By\n84164e1e8074c2565d3cd178babd93694ce54811641a77ffdc8d1084dd468afb\n\n\n91a8b31c12...\nUsed_By\n84164e1e8074c2565d3cd178babd93694ce54811641a77ffdc8d1084dd468afb\n\n\n157a0ffd18...\nRelated_To\nb03ac5eaf2131060ee381e5e46ebc705d8d617a90cc61fa4918174545b4fbaa6\n\n\n157a0ffd18...\nDropped\n1352dbb093a337eb8db9d0135adbe0542bb7e7163616e4f8962919becab171da\n\n\n157a0ffd18...\nRelated_To\n0b01f392fa030be1ddd549fb79cf280d2a2c745578a56fedd4cb5e9438ae72cb\n\n\nb03ac5eaf2...\nRelated_To\n157a0ffd18e05bfd90a4ec108e5458cbde01015e3407b3964732c9d4ceb71656\n\n\nb03ac5eaf2...\nContains\n1352dbb093a337eb8db9d0135adbe0542bb7e7163616e4f8962919becab171da\n\n\n1352dbb093...\nCreated\n5ba0d0bfda372c1f6aa382a70f4ab8427ec998b680510e208fdf878cfda9afe3\n\n\n1352dbb093...\nCreated\n0b7d15968d44710b3e7f153c04b5038d03900a6685643bc8efe688c4d5a5deab\n\n\n1352dbb093...\nUsed\nda267c72f58ec487761de99d0f3bcfd87771a36afc06716053960633a74139df\n\n\n1352dbb093...\nDropped_By\n157a0ffd18e05bfd90a4ec108e5458cbde01015e3407b3964732c9d4ceb71656\n\n\n1352dbb093...\nCreated\n0b01f392fa030be1ddd549fb79cf280d2a2c745578a56fedd4cb5e9438ae72cb\n\n\n1352dbb093...\nContained_Within\nb03ac5eaf2131060ee381e5e46ebc705d8d617a90cc61fa4918174545b4fbaa6\n\n\nda267c72f5...\nUsed_By\n1352dbb093a337eb8db9d0135adbe0542bb7e7163616e4f8962919becab171da\n\n\n0b01f392fa...\nCreated_By\n1352dbb093a337eb8db9d0135adbe0542bb7e7163616e4f8962919becab171da\n\n\n0b01f392fa...\nRelated_To\n157a0ffd18e05bfd90a4ec108e5458cbde01015e3407b3964732c9d4ceb71656\n\n\n5ba0d0bfda...\nCreated_By\n1352dbb093a337eb8db9d0135adbe0542bb7e7163616e4f8962919becab171da\n\n\n0b7d15968d...\nCreated_By\n1352dbb093a337eb8db9d0135adbe0542bb7e7163616e4f8962919becab171da\n\n\n3585c31366...\nUsed\n25afc6741abfa27f5b50844331772466182ebe3f74bc84f911314d1a68c62cb2\n\n\n3585c31366...\nCreated\n603e75db59285734cfb5a469e984c4e359e660ccb7836ff9c209aec36931bc2b\n\n\n25afc6741a...\nUsed_By\n3585c3136686d7d48e53c21be61bb2908d131cf81b826acf578b67bb9d8e9350\n\n\n603e75db59...\nCreated_By\n3585c3136686d7d48e53c21be61bb2908d131cf81b826acf578b67bb9d8e9350\n\n\n30191b3bad...\nRelated_To\ne03a2c8a6e81cf62ba7401c598ea1d4635b08bbf9c2fec080b536dde29e6392f\n\n\n30191b3bad...\nDropped\nd221ca9c519ae04c7724baca8d36c2ce77454e0f9aa0f119ecfa9246973a92f8\n\n\ne03a2c8a6e...\nRelated_To\n30191b3badf3cdbc65d0ffeb68e0f26cef10a41037351b0f562ab52fce7432cc\n\n\nd221ca9c51...\nUsed\n52765525103f5b3b07d0882cc8ee4bb8e279ad5d451e1ed07cae3b98565cce29\n\n\nd221ca9c51...\nCreated\n09605981a072c604e6ef9ad2dd7d2a78b48b07ee3339589bfcf0a466a9190904\n\n\nd221ca9c51...\nCreated\n6a0cd866c849e62f9ccc26575d8794c2e0b14722387742b965d4358e1e0e8b3c\n\n\nd221ca9c51...\nDropped_By\n30191b3badf3cdbc65d0ffeb68e0f26cef10a41037351b0f562ab52fce7432cc\n\n\n5276552510...\nUsed_By\nd221ca9c519ae04c7724baca8d36c2ce77454e0f9aa0f119ecfa9246973a92f8\n\n\n09605981a0...\nCreated_By\nd221ca9c519ae04c7724baca8d36c2ce77454e0f9aa0f119ecfa9246973a92f8\n\n\n6a0cd866c8...\nCreated_By\nd221ca9c519ae04c7724baca8d36c2ce77454e0f9aa0f119ecfa9246973a92f8\n\n\n\nRecommendations\nCISA recommends that users and administrators consider using the following best practices to strengthen the security posture of their organization's systems. Any configuration changes should be reviewed by system owners and administrators prior to implementation to avoid unwanted impacts.\n\nMaintain up-to-date antivirus signatures and engines.\nKeep operating system patches up-to-date.\nDisable File and Printer sharing services. If these services are required, use strong passwords or Active Directory authentication.\nRestrict users' ability (permissions) to install and run unwanted software applications. Do not add users to the local administrators group unless required.\nEnforce a strong password policy and implement regular password changes.\nExercise caution when opening e-mail attachments even if the attachment is expected and the sender appears to be known.\nEnable a personal firewall on agency workstations, configured to deny unsolicited connection requests.\nDisable unnecessary services on agency workstations and servers.\nScan for and remove suspicious e-mail attachments; ensure the scanned attachment is its \"true file type\" (i.e., the extension matches the file header).\nMonitor users' web browsing habits; restrict access to sites with unfavorable content.\nExercise caution when using removable media (e.g., USB thumb drives, external drives, CDs, etc.).\nScan all software downloaded from the Internet prior to executing.\nMaintain situational awareness of the latest threats and implement appropriate Access Control Lists (ACLs).\n\nAdditional information on malware incident prevention and handling can be found in National Institute of Standards and Technology (NIST) Special Publication 800-83, \"Guide to Malware Incident Prevention & Handling for Desktops and Laptops\".\nContact Information\n\n1-888-282-0870\nCISA Central\u00a0(UNCLASS)\nCISA SIPR (SIPRNET)\nCISA IC (JWICS)\n\nCISA continuously strives to improve its products and services. You can help by answering a very short series of questions about this product at the following URL: https://us-cert.cisa.gov/forms/feedback/\nDocument FAQ\nWhat is a MIFR? A Malware Initial Findings Report (MIFR) is intended to provide organizations with malware analysis in a timely manner. In most instances this report will provide initial indicators for computer and network defense. To request additional analysis, please contact CISA and provide information regarding the level of desired analysis.\nWhat is a MAR? A Malware Analysis Report (MAR) is intended to provide organizations with more detailed malware analysis acquired via manual reverse engineering. To request additional analysis, please contact CISA and provide information regarding the level of desired analysis.\nCan I edit this document? This document is not to be edited in any way by recipients. All comments or questions related to this document should be directed to the CISA at 1-888-282-0870 or CISA Central.\nCan I submit malware to CISA? Malware samples can be submitted via three methods:\n\nWeb: https://malware.us-cert.gov\nE-Mail: submit@malware.us-cert.gov\nFTP: ftp.malware.us-cert.gov (anonymous)\n\nCISA encourages you to report any suspicious activity, including cybersecurity incidents, possible malicious code, software vulnerabilities, and phishing-related scams. Reporting forms can be found on CISA's homepage at www.cisa.gov.\n",
  "cves": [
    "CVE-2022-47966",
    "CVE-2022-42475"
  ],
  "techniques": [],
  "advisory": "ar22-277a",
  "title": "MAR-10365227-1.v1 - Impacket | CISA",
  "source": "analysis-reports",
  "id": "28a54c895d1e03bef565295829a60f050a466a9d14b72a0a46f89956a28236d1"
}