{
  "markdown": "\nOverview\nThis advisory is a follow up to the original alert titled ICS-ALERT-12-020-02A\u2014Rockwell Automation ControlLogix PLC Vulnerabilities that was published February 14, 2012, on the ICS-CERT Web page.\nIndependent researcher Rub\u00e9n Santamarta of IOActive identified vulnerabilities in Rockwell Automation\u2019s ControlLogix PLC and released proof-of-concept (exploit) code at the Digital Bond S4 Conference on January 19, 2012. The vulnerabilities are exploitable by transmitting arbitrary commands from a control interface to the programmable logic controller (PLC) or network interface card (NIC). The information was released without coordination with either the vendor or ICS-CERT. Rockwell Automation released firmware patches on July 18, 2012, that resolve the following vulnerabilities. There have been no updates from Rockwell since these patches were released. Exploitation of these vulnerabilities could allow loss of confidentiality, integrity, and availability of the device.\nThese vulnerabilities could be exploited remotely. Exploits that target these vulnerabilities are publicly available.\nAffected Products\nThe following Rockwell products are affected:\n\nAll EtherNet/IP products that conform to the CIP and EtherNet/IP specifications,\n1756-ENBT, 1756-EWEB, 1768-ENBT, 1768-EWEB communication modules,\nCompactLogix L32E and L35E controllers,\n1788-ENBT FLEXLogix adapter,\n1794-AENTR FLEX I/O EtherNet/IP adapter,\nControlLogix, CompactLogix, GuardLogix, and SoftLogix, Version 18 and prior,\nCompactLogix and SoftLogix controllers, Version 19 and prior,\nControlLogix and GuardLogix controllers, Version 20 and prior,\nMicroLogix 1100, and\nMicroLogix 1400.\n\nImpact\nSuccessful exploitation of these vulnerabilities may result in a denial-of-service (DoS) condition, controller fault, or enable a Man-in-the-Middle (MitM) attack, or Replay attack.\nImpact to individual organizations depends on many factors that are unique to each organization. ICS-CERT recommends that organizations evaluate the impact of these vulnerabilities based on their operational environment, architecture, and product implementation.\nBackground\nRockwell Automation provides industrial automation control and information products worldwide, across a wide range of industries.\nThe affected products are PLCs and communication modules. According to Rockwell Automation, these products are deployed across several sectors including agriculture and food, water, chemical, manufacturing and others. According to Rockwell\u2019s Web site, these products are used in France, Italy, the Netherlands, and other countries in Europe, as well as the United States, Korea, China, Japan, and Latin American countries.\nVulnerability Characterization\nVulnerability Overview\nImproper Access Control\u2014Change IP\nWhen an affected product receives a valid CIP message from an unauthorized or unintended source to Port 2222/TCP, Port 2222/UDP, Port 44818/TCP, or Port 44818/UDP that changes the product\u2019s configuration and network parameters, a DoS condition can occur. This situation could cause loss of availability and a disruption of communication with other connected devices.\nCVE-2012-6439 has been assigned to this vulnerability. A CVSS v2 base score of 8.5 has been assigned; the CVSS vector string is (AV:N/AC:L/Au:N/C:N/I:P/A:C).\nImproper Access Control\u2014Reset\nWhen an affected product receives a valid CIP message from an unauthorized or unintended source to Port 2222/TCP, Port 2222/UDP, Port 44818/TCP, or Port 44818/UDP that instructs the product to reset, a DoS can occur. This situation could cause loss of availability and a disruption of communication with other connected devices.\nThis vulnerability was discovered by Rockwell Automation engineers as they were investigating other vulnerabilities reported at the Digital Bond S4 2012 Conference.\nCVE-2012-6442 has been assigned to this vulnerability. A CVSS v2 base score of 7.8 has been assigned; the CVSS vector string is (AV:N/AC:L/Au:N/C:N/I:N/A:C).\nImproper Access Control\u2014Stop\nWhen an affected product receives a valid CIP message from an unauthorized or unintended source to Port 2222/TCP, Port 2222/UDP, Port 44818/TCP, or Port 44818/UDP that instructs the CPU to stop logic execution and enter a fault state, a DoS can occur. This situation could cause loss of availability and a disruption of communication with other connected devices.\nCVE-2012-6435 has been assigned to this vulnerability. A CVSS v2 base score of 7.8 has been assigned; the CVSS vector string is (AV:N/AC:L/Au:N/C:N/I:N/A:C).\nInformation Exposure\nAn information exposure of confidential information results when the device receives a specially crafted CIP packet to Port 2222/TCP, Port 2222/UDP, Port 44818/TCP, or Port 44818/UDP. Successful exploitation of this vulnerability could cause loss of confidentiality.\nThis vulnerability was discovered by Rockwell Automation engineers as they were investigating other vulnerabilities reported at the Digital Bond S4 2012 Conference.\nCVE-2012-6441 has been assigned to this vulnerability. A CVSS v2 base score of 5.0 has been assigned; the CVSS vector string is (AV:N/AC:L/Au:N/C:P/I:N/A:N).\nImproper Input Validation\u2014NIC\nThe device does not properly validate the data being sent to the buffer. An attacker can send a malformed CIP packet to Port 2222/TCP, Port 2222/UDP, Port 44818/TCP, or Port 44818/UDP, which creates a buffer overflow and causes the NIC to crash. Successful exploitation of this vulnerability could cause loss of availability and a disruption in communications with other connected devices.\nCVE-2012-6438 has been assigned to this vulnerability. A CVSS v2 base score of 7.8 has been assigned; the CVSS vector string is (AV:N/AC:L/Au:N/C:N/I:N/A:C).\nImproper Input Validation\u2014CPU\nThe device does not properly validate the data being sent to the buffer. An attacker can send a malformed CIP packet to Port 2222/TCP, Port 2222/UDP, Port 44818/TCP, or Port 44818/UDP, which creates a buffer overflow and causes the CPU to crash. Successful exploitation of this vulnerability could cause loss of availability and a disruption in communications with other connected devices.\nCVE-2012-6436 has been assigned to this vulnerability. A CVSS v2 base score of 7.8 has been assigned; the CVSS vector string is (AV:N/AC:L/Au:N/C:N/I:N/A:C).\nAuthentication Bypass by Capture\u2014Replay\nThe Web server password authentication mechanism used by the products is vulnerable to a MitM and Replay attack. Successful exploitation of this vulnerability will allow unauthorized access of the product\u2019s Web server to view and alter product configuration and diagnostics information.\nhis vulnerability was discovered by Rockwell Automation engineers as they were investigating other vulnerabilities reported at the Digital Bond S4 2012 Conference.\nCVE-2012-6440 has been assigned to this vulnerability. A CVSS v2 base score of 9.3 has been assigned; the CVSS vector string is (AV:N/AC:M/Au:N/C:C/I:C/A:C).\nImproper Authentication\u2014Firmware Upload\nThe device does not properly authenticate users and the potential exists for a remote user to upload a new firmware image to the Ethernet card, whether it is a corrupt or legitimate firmware image. Successful exploitation of this vulnerability could cause loss of availability, integrity, and confidentiality and a disruption in communications with other connected devices.\nCVE-2012-6437 has been assigned to this vulnerability. A CVSS v2 base score of 10.0 has been assigned; the CVSS vector string is (AV:N/AC:L/Au:N/C:C/I:C/A:C).\nVulnerability Details\nExploitability\nThese vulnerabilities could be exploited remotely.\nExistence of Exploit\nExploits that target these vulnerabilities are publicly available.\nDifficulty\nAn attacker with a low-medium skill would be able to exploit these vulnerabilities.\nMitigation\nAccording to Rockwell, any of the above products that become affected by a vulnerability can be reset by rebooting or power cycling the affected product. After the reboot, the affected product may require some reconfiguration.\nTo mitigate the vulnerabilities, Rockwell has developed and released security patches on July 18, 2012, to address each of the issues. To download and install the patches please refer to Rockwell\u2019s Advisories at:\nhttps://rockwellautomation.custhelp.com/app/answers/detail/a_id/470154https://rockwellautomation.custhelp.com/app/answers/detail/aid/470155https://rockwellautomation.custhelp.com/app/answers/detail/aid/470156\nFor more information on security with Rockwell Automation products, please refer to Rockwell\u2019s Security Advisory Index.\nRockwell recommends updating to the newest firmware patches to fix the vulnerabilities, but if not able to do so right away, then Rockwell advises immediately employing the following mitigations for each of the affected products.\nTo mitigate the vulnerabilities pertaining to receiving valid CIP packets:\n\nBlock all traffic to the Ethernet/IP or other CIP protocol-based devices from outside the Manufacturing Zone by restricting or blocking access to TCP and UDP Ports 2222 and 44818 using appropriate security technology such as a firewall or Unified Threat Management (UTM).\nEmploy a UTM appliance that specifically supports CIP message filtering.\n\nTo mitigate the vulnerability pertaining to the corrupted firmware update:\n\nAt this time, Rockwell is still evaluating the feasibility of creating an update for the 1756-ENBT communication module to include a digital signature validation mechanism on the firmware.\nUntil Rockwell creates an update, concerned customers are recommended to employ good security design practices and consider using the more contemporary 1756-EN2T Ethernet/IP communication modules for the ControlLogix platform. The 1756-EN2T has been able to validate digital signatures since firmware Release 5.028.\n\nTo mitigate receiving malformed CIP packets that can cause the controller to enter a fault state:\n\nWhere possible, Rockwell recommends users to upgrade the affected products to Logix Release V20 and higher.\n\nTo mitigate receiving valid CIP packets that instruct the controller to stop logic execution and enter a fault state:\n\nWhere possible, upgrade CompactLogix and SoftLogix affected products to Logix Release V20 or higher.\nWhere possible, upgrade ControlLogix and GuardLogix affected products to Logix Release v20.012 or higher.\nBlock all traffic to the Ethernet/IP or other CIP protocol devices as directed above.\nEmploy a UTM as directed above.\n\nTo mitigate the vulnerability with the Web server password authentication mechanism:\n\nUpgrade the MicroLogix 1400 firmware to FRN 12 or higher.\nBecause of limitations in the MicroLogix 1100 platform, none of the firmware updates will be able to fix this issue, so users should use the following techniques to help reduce the likelihood of compromise.\nWhere possible, disable the Web server and change all default Administrator and Guest passwords.\nIf Web server functionality is needed, then Rockwell recommends upgrading the product\u2019s firmware to the most current version to have the newest enhanced protections available such as:\n\nWhen a controller receives two consecutive invalid authentication requests from an HTTP client, the controller resets the Authentication Counter after 60 minutes.\nWhen a controller receives 10 invalid authentication requests from any HTTP client, it will not accept any valid or invalid authentication packets until a 24-hour HTTP Server Lock Timer timeout.\n\n\nIf Web server functionality is needed, Rockwell also recommends configuring user accounts to have READ only access to the product so those accounts cannot be used to make configuration changes.\n\nIn addition to the above, Rockwell recommends concerned customers remain vigilant and continue to follow security strategies that help reduce risk and enhance overall control system security. Where possible, they suggest you apply multiple recommendations and complement this list with your own best-practices:\n\nEmploy layered security and defense-in-depth methods in system design to restrict and control access to individual products and control networks. Refer to http://www.ab.com/networks/architectures.html for comprehensive information about implementing validated architectures designed to deliver these measures.\nRestrict physical and electronic access to automation products, networks, and systems to only those individuals authorized to be in contact with control system equipment.\nEmploy firewalls with ingress/egress filtering, intrusion detection/prevention systems, and validate all configurations. Evaluate firewall configurations to ensure other appropriate inbound and outbound traffic is blocked.\nUse up-to-date end-point protection software (e.g., antivirus/antimalware software) on all PC-based assets.\nMake sure that software and control system device firmware is patched to current releases.\nPeriodically change passwords in control system components and infrastructure devices.\nWhere applicable, set the controller key-switch/mode-switch to RUN mode.\n\nICS-CERT encourages asset owners to take additional defensive measures to protect against this and other cybersecurity risks.\n\nMinimize network exposure for all control system devices. Critical devices should not directly face the Internet.\nLocate control system networks and remote devices behind firewalls, and isolate them from the business network.\nWhen remote access is required, use secure methods, such as Virtual Private Networks (VPNs), recognizing that VPN is only as secure as the connected devices.\n\nICS-CERT also provides a section for control systems security recommended practices on the US-CERT Web page. Several recommended practices are available for reading and download, including Improving Industrial Control Systems Cybersecurity with Defense-in-Depth Strategies. ICS-CERT reminds organizations to perform proper impact analysis and risk assessment prior to taking defensive measures.\nAdditional mitigation guidance and recommended practices are publicly available in the ICS-CERT Technical Information Paper, ICS-TIP-12-146-01B\u2014Targeted Cyber Intrusion Detection and Mitigation Strategies.\nOrganizations observing any suspected malicious activity should follow their established internal procedures and report their findings to ICS-CERT for tracking and correlation against other incidents.\n\n",
  "cves": [
    "CVE-2012-6436",
    "CVE-2012-6441",
    "CVE-2012-6437",
    "CVE-2012-6440",
    "CVE-2012-6435",
    "CVE-2012-6438",
    "CVE-2012-6439",
    "CVE-2012-6442"
  ],
  "techniques": [],
  "advisory": "icsa-13-011-03",
  "title": "Rockwell Automation ControlLogix PLC Vulnerabilities | CISA",
  "source": "ics-advisories",
  "id": "c0d7da93c7275feef74342d3cd0f7c25fc65e100b14796f0da9c7111a033b739"
}