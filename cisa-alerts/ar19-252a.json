{
  "markdown": "\n\nSummary\n\n\n\n\n\n\n\nNotification\n\nThis report is provided \"as is\" for informational purposes only. The Department of Homeland Security (DHS) does not provide any warranties of any kind regarding any information contained herein. The DHS does not endorse any commercial product or service referenced in this bulletin or otherwise.\nThis document is marked TLP:WHITE--Disclosure is not limited. Sources may use TLP:WHITE when information carries minimal or no foreseeable risk of misuse, in accordance with applicable rules and procedures for public release. Subject to standard copyright rules, TLP:WHITE information may be distributed without restriction. For more information on the Traffic Light Protocol (TLP), see http://www.us-cert.gov/tlp.\n\nSummary\n\nDescription\nThis Malware Analysis Report (MAR) is the result of analytic efforts between the Department of Homeland Security (DHS), the Federal Bureau of Investigation (FBI), and the Department of Defense (DoD). Working with U.S. Government partners, DHS, FBI, and DoD identified Trojan malware variants used by the North Korean government - referred to by the U.S. Government as BADCALL. The U.S. Government refers to malicious cyber activity by the North Korean government as HIDDEN COBRA. For more information on HIDDEN COBRA activity, visit https[:]//www[.]us-cert.gov /hiddencobra.\n\n\t\t\tFBI has high confidence that HIDDEN COBRA actors are using malware variants in conjunction with proxy servers to maintain a presence on victim networks and to further network exploitation. DHS, FBI, and DoD are distributing this MAR to enable network defense and reduce exposure to North Korean government malicious cyber activity.\n\n\t\t\tThis MAR includes malware descriptions related to HIDDEN COBRA, suggested response actions and recommended mitigation techniques. Users or administrators should flag activity associated with the malware, report the activity to the DHS National Cybersecurity and Communications Integration Center (NCCIC) or the FBI Cyber Watch (CyWatch), and give the activity the highest priority for enhanced mitigation.\n\n\t\t\tThis report provides analysis of four (4) malicious executable files. The first three (3) files are 32-bit Windows executables that function as proxy servers and implement a \"Fake TLS\" method similar to the behavior described in a previously published NCCIC report, MAR-10135536-B. The fourth file is an Android Package Kit (APK) file designed to run on Android platforms as a fully functioning Remote Access Tool (RAT).\nFor a downloadable copy of IOCs, see:\n\nMAR-10135536-10.stix\n\nSubmitted Files (4)\n4257bb11570ed15b8a15aa3fc051a580eab5d09c2f9d79e4b264b752c8e584fc (C01DC42F65ACAF1C917C0CC29BA63A...)\n93e13ffd2a2f1a13fb9a09de1d98324f75b3f0f8e0c822857ed5ca3b73ee3672 (22082079AB45CCC256E73B3A7FD547...)\nd1f3b9372a6be9c02430b6e4526202974179a674ce94fe22028d7212ae6be9e7 (C6F78AD187C365D117CACBEE140F62...)\nedd2aff8fad0c76021adc74fe3cb3cb1a02913a839ad0f2cf31fdea8b5aa8195 (D93B6A5C04D392FC8ED30375BE17BE...)\nAdditional Files (2)\n91650e7b0833a34abc9e51bff53cc05ef333513c6be038df29929a0a55310d9c (z)\nda353b2845a354e1a3f671e4a12198e2c6f57a377d02dfaf90477869041a044f (hc.zip)\n\nFindings\n\nd1f3b9372a6be9c02430b6e4526202974179a674ce94fe22028d7212ae6be9e7\nTags\nbackdoordownloadertrojan\nDetails\n\n\n\nName\nC6F78AD187C365D117CACBEE140F6230\n\n\nSize\n208896 bytes\n\n\nType\nPE32 executable (GUI) Intel 80386, for MS Windows\n\n\nMD5\nc6f78ad187c365d117cacbee140f6230\n\n\nSHA1\n5116f281c61639b48fd58caaed60018bafdefe7a\n\n\nSHA256\nd1f3b9372a6be9c02430b6e4526202974179a674ce94fe22028d7212ae6be9e7\n\n\nSHA512\nf03fe686fac20714a6a7141bff1471c9187b0d4630752fb5eb922605dbb74105c1ecced7e1980a0d79195c1a7f1b2f221e483bc9f7e2164a8b4290b512e06503\n\n\nssdeep\n1536:X86D0r4QxG5+XCFpaG7+esyzktLYUwnZ7hUOKYUwnZ7hUOaeYUwnZ7hUOKYUwnZr:X8O0IgCvH7+UzktMxzxgRxzx9\n\n\nEntropy\n6.833120\n\n\n\nAntivirus\n\n\n\nAhnlab\nBackdoor/Win32.Akdoor\n\n\nAntiy\nTrojan/Win32.BTSGeneric\n\n\nBitDefender\nTrojan.Agent.CUTNUnclassified\n\n\nClamAV\nWin.Trojan.BadCall-6473322-0\n\n\nCyren\nW32/Trojan.DCIV-3872\n\n\nESET\nWin32/NukeSped.CX trojan\n\n\nEmsisoft\nTrojan.Agent.CUTN (B)\n\n\nIkarus\nTrojan.Win32.NukeSped\n\n\nK7\nTrojan ( 005272fc1 )\n\n\nMicrosoft Security Essentials\nBackdoor:Win32/Hidcob.A\n\n\nNANOAV\nTrojan.Win32.NukeSped.eydshe\n\n\nSophos\nTroj/Cruprox-C\n\n\nSymantec\nTrojan Horse\n\n\nTACHYON\nBackdoor/W32.Agent.208896.DD\n\n\nTrendMicro\nBKDR_NUKESPED.A\n\n\nTrendMicro House Call\nBKDR_NUKESPED.A\n\n\nVir.IT eXplorer\nTrojan.Win32.Dnldr26.BAYE\n\n\nVirusBlokAda\nTrojan.Downloader\n\n\nZillya!\nTrojan.NukeSped.Win32.49\n\n\n\nYara Rules\n\n\n\nhidden_cobra_consolidated.yara\nrule NK_SSL_PROXY { meta: Author = \"CISA Code & Media Analysis\" Incident = \"10135536\" Date = \"2018-01-09\" Category = \"Hidden_Cobra\" Family = \"BADCALL\" Description = \"Detects NK SSL PROXY\" MD5_1 = \"C6F78AD187C365D117CACBEE140F6230\" MD5_2 = \"C01DC42F65ACAF1C917C0CC29BA63ADC\" strings: $s0 = {8B4C24088A140880F24780C228881408403BC67CEF5E} $s1 = {568B74240C33C085F67E158B4C24088A140880EA2880F247881408403BC67CEF5E} $s2 = {4775401F713435747975366867766869375E2524736466} $s3 = {67686667686A75797566676467667472} $s4 = {6D2A5E265E676866676534776572} $s5 = {3171617A5853444332337765} $s6 = \"ghfghjuyufgdgftr\" $s7 = \"q45tyu6hgvhi7^%$sdf\" $s8 = \"m*^&^ghfge4wer\" condition: ($s0 and $s1 and $s2 and $s3 and $s4 and $s5) or ($s6 and $s7 and $s8) }\n\n\nhidden_cobra_consolidated.yara\nrule xor_add { meta: Author = \"CISA trusted 3rd party\" Incident = \"10135536\" Date = \"2018-04-19\" Category = \"Hidden_Cobra\" Family = \"n/a\" Description = \"n/a\" strings: $decode = { 80 ea 28 80 f2 47} $encode = { 80 f2 47 80 c2 28} condition: uint16(0) == 0x5A4D and uint16(uint32(0x3c)) == 0x4550 and all of them }\n\n\n\nssdeep Matches\nNo matches found.\nPE Metadata\n\n\n\nCompile Date\n2016-02-06 22:17:51-05:00\n\n\nImport Hash\n3f197f5c6469421f4472504b1bada91e\n\n\n\nPE Sections\n\n\n\nMD5\nName\nRaw Size\nEntropy\n\n\na8f97910c62034b318e17aa17fb97f1c\nheader\n4096\n0.688106\n\n\n08112b571663ff5ed42e331a00ccce0c\n.text\n53248\n6.508967\n\n\nca61927558a4dfe9305eb037a5432960\n.rdata\n8192\n4.573237\n\n\nbb49b2fb00c1ae88ad440971914711a7\n.data\n139264\n6.941279\n\n\nc58b62cf949e8636ebd5c75f482207c3\n.sxdata\n4096\n0.181138\n\n\n\nPackers/Compilers/Cryptors\n\n\n\nMicrosoft Visual C++ v6.0\n\n\n\nDescription\nThis file is a malicious 32-bit Windows executable. Analysis indicates this application is designed to force a compromised system to function as a proxy server. When executed, the malware binds and listens for incoming connections on port 8000 of the compromised system. The proxy session traffic is protected by way of a simple cipher based on rotating XOR and ADD. The cipher will XOR each byte sent with 47h and added by 28h. Each byte received by the malware will be XOR\u2019ed by 47h and subtracted by 28h. See Figures 1, 2 and 3 for code examples. Notably, this malware attempts to disable the Windows firewall before binding to port 8000 by modifying the following registry key:\n\n\t\t\t--Begin Firewall Reg Key Modified--\n\n\t\t\tSYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\GloballyOpenPorts\\\\List\n\n\t\t\t--End Firewall Reg Key Modified--\n\n\t\t\tAnalysis of this malware indicates it is designed to turn a victim host into a \"hop point\" by relaying traffic to a remote system. When the adversary initially connects to a victim\u2019s machine via port 8000, the adversary must first authenticate (over a session secured with the XOR/ADD cipher described above) by providing the ASCII string \"1qazXSDC23we\u201d. If the malware does not receive this value, it will terminate the session, responding with the value \"m*^&^ghfge4wer\u201d.\n\n\t\t\tIf the operator authenticates successfully, they can then issue the command \"ghfghjuyufgdgftr\" which instructs the malware to begin functioning as a proxy server and respond to the operator with the value \"q45tyu6hgvhi7^%$sdf\u201d. Next, the malware attempts to create a proxy session between the operator and another server. During this process, the malware will attempt to authenticate with the destination server by sending the value \"ghfghjuyufgdgftr\" as a challenge. To complete the authentication sequence, the malware expects to receive a response value of \"q45tyu6hgvhi7^%$sdf\". All challenge and response traffic is encoded using the ADD/XOR cipher described earlier.\n\n\t\t\tThe proxy session begins with a remote operator connecting to this implant via a \"fake TLS\" connection attempt, similar to the behavior described in a previously released NCCIC report, MAR-10135536-B. Essentially, the malware initiates the TLS session using one of several public SSL certificates obtained from well known, legitimate internet services and embedded in the malware. However, the traffic from the operator to this implant is not protected with SSL / TLS encryption. The traffic is only protected via the ADD/XOR cipher embedded within this implant (see Figure 2-3.). If the remote operator authenticates correctly as detailed above, the implant attempts to begin a proxy session with the remote target system. The traffic to the remote systems from this implant are sent and received via the SSL_read and SSL_write APIs available in OpenSSL. However, the malware does not appear to attempt to load an SSL private key or certificate.\n\n\t\t\tThe malware contains public SSL certificates for the following list of domains, which are used for initiating the \"fake TLS\" session:\n\n\t\t\t--Begin SSL Certificate Strings--\n\n\t\t\tmyservice.xbox.com\n\t\t\tuk.yahoo.com\n\t\t\tweb.whatsapp.com\n\t\t\twww[.]apple.com\n\t\t\twww[.]baidu.com\n\t\t\twww[.]bing.com\n\t\t\twww[.]bitcoin.org\n\t\t\twww[.]comodo.com\n\t\t\twww[.]debian.org\n\t\t\twww[.]dropbox.com\n\t\t\twww[.]facebook.com\n\t\t\twww[.]github.com\n\t\t\twww[.]google.com\n\t\t\twww[.]lenovo.com\n\t\t\twww[.]microsoft.com\n\t\t\twww[.]paypal.com\n\t\t\twww[.]tumblr.com\n\t\t\twww[.]twitter.com\n\t\t\twww[.]wetransfer.com\n\t\t\twww[.]wikipedia.org\n\n\t\t\t--End SSL Certificate Strings--\nScreenshots\n \n\nFigure 1 - \n\n \n\nFigure 2 - \n\n \n\nFigure 3 - \n\n \n\nFigure 4 - \n\n\n\n4257bb11570ed15b8a15aa3fc051a580eab5d09c2f9d79e4b264b752c8e584fc\nTags\nbackdoortrojan\nDetails\n\n\n\nName\nC01DC42F65ACAF1C917C0CC29BA63ADC\n\n\nSize\n233472 bytes\n\n\nType\nPE32 executable (DLL) (GUI) Intel 80386, for MS Windows\n\n\nMD5\nc01dc42f65acaf1c917c0cc29ba63adc\n\n\nSHA1\nd288766fa268bc2534f85fd06a5d52264e646c47\n\n\nSHA256\n4257bb11570ed15b8a15aa3fc051a580eab5d09c2f9d79e4b264b752c8e584fc\n\n\nSHA512\n0ff6745ef787e89bd0f154bd96571f086f6b6596621e7211bb8ce8f970a26a72770a44b9aa1b906e6599dd5f421e0dd50895e2cde9ba85be78b9efbc3e8db5c0\n\n\nssdeep\n1536:cseScclTQDYY3TSF00sK/LVtKYUwnZ7hUO1YUwnZ7hUOAeYUwnZ7hUO7YUwnZ7hj:cseScjYY3Tyc0LVt9xsxuRxSxzxg0j\n\n\nEntropy\n6.861843\n\n\n\nAntivirus\n\n\n\nAhnlab\nBackdoor/Win32.Akdoor\n\n\nAntiy\nTrojan/Win32.BTSGeneric\n\n\nAvira\nTR/NukeSped.ydcjt\n\n\nBitDefender\nTrojan.Agent.CBEJUnclassified\n\n\nClamAV\nWin.Trojan.Agent-6449123-0\n\n\nCyren\nW32/Agent.OOKJ-8303\n\n\nESET\nWin32/NukeSped.CX trojan\n\n\nEmsisoft\nTrojan.Agent.CBEJ (B)\n\n\nIkarus\nTrojan.Agent\n\n\nK7\nTrojan ( 005272fc1 )\n\n\nKaspersky\nBackdoor.Win32.Agent.texxz\n\n\nMcAfee\nGeneric.ayf\n\n\nMicrosoft Security Essentials\nTrojan:Win32/Autophyte.B!dha\n\n\nNANOAV\nTrojan.Win32.NukeSped.eyembk\n\n\nQuick Heal\nTrojan.Multi\n\n\nSophos\nTroj/BadCall-A\n\n\nSymantec\nTrojan Horse\n\n\nTACHYON\nTrojan/W32.Agent.233472.APN\n\n\nTrendMicro\nBKDR_NUKESPED.B\n\n\nTrendMicro House Call\nBKDR_NUKESPED.B\n\n\nVir.IT eXplorer\nBackdoor.Win32.Agent.LX\n\n\nVirusBlokAda\nBackdoor.Agent\n\n\nZillya!\nTrojan.Agent.Win32.879097\n\n\n\nYara Rules\n\n\n\nhidden_cobra_consolidated.yara\nrule NK_SSL_PROXY { meta: Author = \"CISA Code & Media Analysis\" Incident = \"10135536\" Date = \"2018-01-09\" Category = \"Hidden_Cobra\" Family = \"BADCALL\" Description = \"Detects NK SSL PROXY\" MD5_1 = \"C6F78AD187C365D117CACBEE140F6230\" MD5_2 = \"C01DC42F65ACAF1C917C0CC29BA63ADC\" strings: $s0 = {8B4C24088A140880F24780C228881408403BC67CEF5E} $s1 = {568B74240C33C085F67E158B4C24088A140880EA2880F247881408403BC67CEF5E} $s2 = {4775401F713435747975366867766869375E2524736466} $s3 = {67686667686A75797566676467667472} $s4 = {6D2A5E265E676866676534776572} $s5 = {3171617A5853444332337765} $s6 = \"ghfghjuyufgdgftr\" $s7 = \"q45tyu6hgvhi7^%$sdf\" $s8 = \"m*^&^ghfge4wer\" condition: ($s0 and $s1 and $s2 and $s3 and $s4 and $s5) or ($s6 and $s7 and $s8) }\n\n\nhidden_cobra_consolidated.yara\nrule xor_add { meta: Author = \"CISA trusted 3rd party\" Incident = \"10135536\" Date = \"2018-04-19\" Category = \"Hidden_Cobra\" Family = \"n/a\" Description = \"n/a\" strings: $decode = { 80 ea 28 80 f2 47} $encode = { 80 f2 47 80 c2 28} condition: uint16(0) == 0x5A4D and uint16(uint32(0x3c)) == 0x4550 and all of them }\n\n\n\nssdeep Matches\nNo matches found.\nPE Metadata\n\n\n\nCompile Date\n2016-02-05 13:16:54-05:00\n\n\nImport Hash\n0b10d6fde1b7cdd778e0338a2d7e5046\n\n\n\nPE Sections\n\n\n\nMD5\nName\nRaw Size\nEntropy\n\n\nf0cb80c557b1172362064c51bbb9b271\nheader\n4096\n0.696473\n\n\ne9d0219343e64c8c8aa6f084db44b92c\n.text\n45056\n6.324040\n\n\n1092801819f120298e2ddac6a96e3fd0\n.rdata\n8192\n3.775333\n\n\n5109fb1db61b533c23762d9044579db7\n.data\n167936\n7.045393\n\n\n9ce04d3e820fa7056f351dbcfa05b0fb\n.reloc\n8192\n2.767666\n\n\n\nPackers/Compilers/Cryptors\n\n\n\nMicrosoft Visual C++ 6.0\n\n\nMicrosoft Visual C++ 6.0 DLL (Debug)\n\n\n\nDescription\nThis file is a malicious 32-bit Windows DLL. Static analysis indicates this application is very similar in structure and function to C6F78AD187C365D117CACBEE140F6230. However, rather than being a PE32 executable this application is a Windows 32-bit DLL, which must be loaded by an external loader. This external loader was not included within this submission.\n\n\t\t\tThis DLL is designed to force a compromised system to act as a proxy server. This implant is designed to proxy network traffic from an operator to another software tool that is being operated by the adversary on a remote system. The traffic to and from this proxy server will be protected with the same simple XOR / ADD cipher used by the malware C6F78AD187C365D117CACBEE140F6230. Static analysis indicates sessions from the remote operator connecting directly to this implant will be protected via SSL / TLS, however the proxy sessions to the remote systems will not be protected via TLS but will instead use a \"fake TLS\" session. The traffic from the operator to this implant and traffic from the implant to the remote systems will be protected via the embedded XOR / ADD cipher (view screenshot). To implement SSL with the remote operator, the malware loads a private key from a file named 'wbemhost.dll' and a certificate from a file named 'netconf.dll'. This malware does not drop either of these files (see Figure. 7).\n\n\t\t\tAnalysis of this malware indicates it is designed to bind to and listen for incoming connections to the victim\u2019s system after disabling the firewall by modifying the following registry key. The firewall is disabled by allowing incoming access on port 443.\n\n\t\t\t--Begin Firewall Reg Key Modified--\n\n\t\t\tSYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfileGloballyOpenPorts\\\\List\n\n\t\t\t--End Firewall Reg Key Modified--\n\n\t\t\tAfter connecting to this malware, the operator must issue the challenge value \"qwertyuiop\" to authenticate with the implant (see Figure 5). This malware also has the added capability of allowing an operator to collect information about the compromised system. This information is collected using the Windows APIs GetComputerNameW, gethostbyname, and GetAdaptersInfo. In order to use this feature, the operator must issue the instruction value \"ghfghjuyufgdgftr\u201d after authenticating. As with C6F78AD187C365D117CACBEE140F6230, this malware uses the OpenSLL functions ssl_read() and ssl_write() to exchange data with the operator, however the malware additionally uses a simple XOR cipher (as earlier described) to decrypt incoming traffic.\n\n\t\t\tAnalysis indicates this malware must also authenticate with the destination server to which the operator wishes to proxy traffic. To do so, this malware first sends that remote server the challenge value \"1qazXSDC23we.\" The malware must then receive the following response from the destination server before it will allow the operator to proxy traffic to it: \"m*^&^ghfge4wer\u201d (see Figure 6). The authentication values sent to and from this proxy server will be protected via the same XOR / ADD cipher utilized by the malware C6F78AD187C365D117CACBEE140F6230 (see Figures 8-9).\n\n\t\t\tThe following is a list of the domains for which the malware contains public SSL certificates, used for initiating the \"FAKE TLS\" sessions:\n\n\t\t\t--Begin SSL cert list--\n\n\t\t\tmyservice.xbox.com\n\t\t\tuk.yahoo.com\n\t\t\tweb.whatsapp.com\n\t\t\twww[.]apple.com\n\t\t\twww[.]baidu.com\n\t\t\twww[.]bing.com\n\t\t\twww[.]bitcoin.org\n\t\t\twww[.]comodo.com\n\t\t\twww[.]debian.org\n\t\t\twww[.]dropbox.com\n\t\t\twww[.]facebook.com\n\t\t\twww[.]github.com\n\t\t\twww[.]google.com\n\t\t\twww[.]lenovo.com\n\t\t\twww[.]microsoft.com\n\t\t\twww[.]paypal.com\n\t\t\twww[.]tumblr.com\n\t\t\twww[.]twitter.com\n\t\t\twww[.]wetransfer.com\n\t\t\twww[.]wikipedia.org\n\n\t\t\t--End SSL cert list--\nScreenshots\n \n\nFigure 5 - \n\n \n\nFigure 6 - \n\n \n\nFigure 7 - \n\n \n\nFigure 9 - \n\n \n\nFigure 8 - \n\n\n\n93e13ffd2a2f1a13fb9a09de1d98324f75b3f0f8e0c822857ed5ca3b73ee3672\nTags\nbackdoortrojan\nDetails\n\n\n\nName\n22082079AB45CCC256E73B3A7FD54791\n\n\nSize\n118784 bytes\n\n\nType\nPE32 executable (DLL) (GUI) Intel 80386, for MS Windows\n\n\nMD5\n22082079ab45ccc256e73b3a7fd54791\n\n\nSHA1\n029bb15a2ba0bea98934aa2b181e4e76c83282ce\n\n\nSHA256\n93e13ffd2a2f1a13fb9a09de1d98324f75b3f0f8e0c822857ed5ca3b73ee3672\n\n\nSHA512\n1b8c3e6da2e43f14d291c6e850eb6a0a51947bb2e87ce378a1b08119667509c36046b73a2e3528054b2b04925abecdc385478b3ff542a31a1b37b1d683461fe5\n\n\nssdeep\n3072:zO+bv42IGfT/EpdIS+aYy8Wt9QopUuul/WRaKj1gv:aov42T/EptldpZugQK\n\n\nEntropy\n6.824890\n\n\n\nAntivirus\n\n\n\nAhnlab\nTrojan/Win32.Casdet\n\n\nAntiy\nTrojan/Win32.Casdet\n\n\nAvira\nTR/Agent.tsurv\n\n\nBitDefender\nTrojan.GenericKD.41577128Unclassified\n\n\nCyren\nW32/Trojan.DKUU-0798\n\n\nESET\nWin32/NukeSped.FU trojan\n\n\nEmsisoft\nTrojan.GenericKD.41577128 (B)\n\n\nK7\nTrojan ( 005560611 )\n\n\nMcAfee\nRDN/Generic.dx\n\n\nQuick Heal\nTrojan.Casdet\n\n\nSymantec\nBackdoor.Trojan\n\n\n\nYara Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nPE Metadata\n\n\n\nCompile Date\n2018-07-17 00:59:05-04:00\n\n\nImport Hash\n16829b63f8ecedc02fa379016636a7b3\n\n\n\nPE Sections\n\n\n\nMD5\nName\nRaw Size\nEntropy\n\n\n1e0638185a7f70a39e8366d293736868\nheader\n4096\n0.696223\n\n\n7c0e47bb01059f413f0aac60be01708b\n.text\n36864\n6.564904\n\n\nbf754906211b615d5a32284c3e3c97ad\n.rdata\n12288\n4.513552\n\n\nc31a6726d1210b6c5e8c622e9fc91c3d\n.data\n57344\n7.684244\n\n\nf9f1af8f7d13e1321806e125559cde91\n.reloc\n8192\n1.955731\n\n\n\nPackers/Compilers/Cryptors\n\n\n\nMicrosoft Visual C++ 6.0\n\n\nMicrosoft Visual C++ 6.0 DLL (Debug)\n\n\n\nRelationships\n\n\n\n93e13ffd2a...\nContains\nda353b2845a354e1a3f671e4a12198e2c6f57a377d02dfaf90477869041a044f\n\n\n\nDescription\nThis file is a 32-bit Windows DLL. This file is an implant loader for a DLL and is designed to be called from the ServiceMain export function. The malware attempts to decrypt an embedded chunk of data that is 50896 bytes in size. This decryption is performed utilizing an RC4 algorithm. The key used for this decryption is displayed below:\n\n\t\t\t--Begin RC4 Key--\n\n\t\t\tCC E5 71 D9 B5 88 9D 53 EF 74 D1 9A E5 A4 1E B3\n\n\t\t\t--End RC4 Key--\n\n\t\t\tThis decrypted file is a zip file which contains a malicious DLL file named 'z' (2733A9069F0B0A57BF9831FE582E35D9).\nScreenshots\n \n\nFigure 10 - \n\n\n\nda353b2845a354e1a3f671e4a12198e2c6f57a377d02dfaf90477869041a044f\nTags\ntrojan\nDetails\n\n\n\nName\nhc.zip\n\n\nSize\n50896 bytes\n\n\nType\nZip archive data, at least v2.0 to extract\n\n\nMD5\neb7da5f1e86679405aa255aa4761977d\n\n\nSHA1\n880cb39fee291aa93eb43d92f7af6b500f6d57dc\n\n\nSHA256\nda353b2845a354e1a3f671e4a12198e2c6f57a377d02dfaf90477869041a044f\n\n\nSHA512\nf1bc07f218e266d10a3f4d4a76388d3dc37fe51134877fcf071a745214a4309ff6ec71cdf5e7943b08dd68824cf4883a1f4c493911bef4d573bf59a2439dc788\n\n\nssdeep\n768:wu4/k7m28PNNc5lepsSIDq/TlF6u7ODBHGslr5XRdBXSCF8bbbbbb0gbvbbb9fG+:4M/sfqrD6THl7OlFXRbXhFM++\n\n\nEntropy\n7.993615\n\n\n\nAntivirus\n\n\n\nMicrosoft Security Essentials\nTrojan:Win32/Autophyte.B!dha\n\n\nQuick Heal\nTrojan.Autophyte\n\n\n\nYara Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\nda353b2845...\nContains\n91650e7b0833a34abc9e51bff53cc05ef333513c6be038df29929a0a55310d9c\n\n\nda353b2845...\nContained_Within\n93e13ffd2a2f1a13fb9a09de1d98324f75b3f0f8e0c822857ed5ca3b73ee3672\n\n\n\nDescription\nThis file is a zip compressed archive that was extracted from the file 22082079AB45CCC256E73B3A7FD54791. The zip file contains the malicious DLL 'z' (2733a9069f0b0a57bf9831fe582e35d9).\n\n\n91650e7b0833a34abc9e51bff53cc05ef333513c6be038df29929a0a55310d9c\nTags\nbackdoortrojan\nDetails\n\n\n\nName\nz\n\n\nSize\n221184 bytes\n\n\nType\nPE32 executable (DLL) (GUI) Intel 80386, for MS Windows\n\n\nMD5\n2733a9069f0b0a57bf9831fe582e35d9\n\n\nSHA1\nf06f9d015c2f445ee0f13da5708f93c381f4442d\n\n\nSHA256\n91650e7b0833a34abc9e51bff53cc05ef333513c6be038df29929a0a55310d9c\n\n\nSHA512\n78dde154425ff447d9f7d38dacd707227a9375f6b8890f3da99f97f93acf9fb12db3f678db799920fac0854235aaeb558d49578d5f443d85a4c1d62e286398c9\n\n\nssdeep\n1536:kkRTTvge1l5HFXCtTX/Mo1xaft0YUwnZ7hUOSYUwnZ7hUOAeYUwnZ7hUOCYUwnZl:kkRTTRj5HlkMsaft7xfxuRx3xzxN\n\n\nEntropy\n7.062074\n\n\n\nAntivirus\n\n\n\nAhnlab\nBackdoor/Win32.Akdoor\n\n\nAntiy\nTrojan/Win32.Autophyte\n\n\nAvira\nTR/NukeSped.kaqej\n\n\nBitDefender\nGen:Variant.Zusy.290461Unclassified\n\n\nClamAV\nWin.Trojan.BadCall-6473322-0\n\n\nESET\nWin32/NukeSped.FU trojan\n\n\nEmsisoft\nGen:Variant.Zusy.290461 (B)\n\n\nIkarus\nTrojan.Win32.Autophyte\n\n\nK7\nTrojan ( 005562ef1 )\n\n\nMcAfee\nRDN/Generic BackDoor\n\n\nMicrosoft Security Essentials\nTrojan:Win32/Autophyte.B!dha\n\n\nQuick Heal\nTrojan.Autophyte\n\n\nSymantec\nTrojan.Proxabop\n\n\n\nYara Rules\n\n\n\nhidden_cobra_consolidated.yara\nrule NK_SSL_PROXY { meta: Author = \"CISA Code & Media Analysis\" Incident = \"10135536\" Date = \"2018-01-09\" Category = \"Hidden_Cobra\" Family = \"BADCALL\" Description = \"Detects NK SSL PROXY\" MD5_1 = \"C6F78AD187C365D117CACBEE140F6230\" MD5_2 = \"C01DC42F65ACAF1C917C0CC29BA63ADC\" strings: $s0 = {8B4C24088A140880F24780C228881408403BC67CEF5E} $s1 = {568B74240C33C085F67E158B4C24088A140880EA2880F247881408403BC67CEF5E} $s2 = {4775401F713435747975366867766869375E2524736466} $s3 = {67686667686A75797566676467667472} $s4 = {6D2A5E265E676866676534776572} $s5 = {3171617A5853444332337765} $s6 = \"ghfghjuyufgdgftr\" $s7 = \"q45tyu6hgvhi7^%$sdf\" $s8 = \"m*^&^ghfge4wer\" condition: ($s0 and $s1 and $s2 and $s3 and $s4 and $s5) or ($s6 and $s7 and $s8) }\n\n\nhidden_cobra_consolidated.yara\nrule xor_add { meta: Author = \"CISA trusted 3rd party\" Incident = \"10135536\" Date = \"2018-04-19\" Category = \"Hidden_Cobra\" Family = \"n/a\" Description = \"n/a\" strings: $decode = { 80 ea 28 80 f2 47} $encode = { 80 f2 47 80 c2 28} condition: uint16(0) == 0x5A4D and uint16(uint32(0x3c)) == 0x4550 and all of them }\n\n\n\nssdeep Matches\nNo matches found.\nPE Metadata\n\n\n\nCompile Date\n2018-07-17 00:53:11-04:00\n\n\nImport Hash\n6a279f14835aa138eab03b57a6e45825\n\n\n\nPE Sections\n\n\n\nMD5\nName\nRaw Size\nEntropy\n\n\n79d8ca8726a734aef20f898f5e2fbb50\nheader\n4096\n0.711446\n\n\ne2d8cd2675a9cf155d8a84a98e91726a\n.text\n40960\n6.486031\n\n\n9dd07afaecfd084b82051ce7ad1b4bc1\n.rdata\n8192\n4.848305\n\n\n20de8f78ea78fe96c41dd8926438fdab\n.data\n159744\n7.189385\n\n\n5aff5f4cc16000bc502b6eec007c9e31\n.reloc\n8192\n2.586704\n\n\n\nPackers/Compilers/Cryptors\n\n\n\nMicrosoft Visual C++ 6.0\n\n\nMicrosoft Visual C++ 6.0 DLL (Debug)\n\n\n\nRelationships\n\n\n\n91650e7b08...\nContained_Within\nda353b2845a354e1a3f671e4a12198e2c6f57a377d02dfaf90477869041a044f\n\n\n\nDescription\nThis file is a 32-bit DLL file. Static analysis indicates this application is very similar in structure and function to C6F78AD187C365D117CACBEE140F6230.\n\n\t\t\tThis DLL is designed to force a compromised system to act as a proxy server. This implant is designed to proxy network traffic from an operator to another software tool that is being operated by the adversary on a remote system. The traffic to and from this proxy server will be protected with the same simple XOR / ADD cipher used by the malware C6F78AD187C365D117CACBEE140F6230.\n\n\t\t\tStatic analysis indicates the OpenSSL library is used to implement a TLS/SSL initialization between the operator and this implant. The malware will also use a rotating XOR / ADD cipher to secure communications from the remote operator -- in addition to the SSL encryption. During this initialization process the malware loads a private key from a file named 'wbemhost.dll' (see Figure 11.) and a certificate from a file named 'netconf.dll'. The malware does not drop these two files, therefore it is expected to be already dropped on the system using another method.\n\n\t\t\tAnalysis of this malware indicates it is designed to bind to and listen for incoming connections on port 443 of a victim\u2019s system after disabling the firewall by modifying the following registry key:\n\n\t\t\t--Begin Firewall Reg Key Modified--\n\n\t\t\tSYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\n\n\t\t\tGloballyOpenPorts\\\\List\n\n\t\t\t--End Firewall Reg Key Modified--\n\n\t\t\tStatic analysis indicates the malware attempts to read configuration data from the following registry key:\n\n\t\t\t--Begin Config Registry Key --\n\n\t\t\tKey: SOFTWARE\\Microsoft\\windows\\CurrentVersion\\NetConfigs\n\t\t\tValue: Description\n\n\t\t\t--End Config Registry Key--\n\n\t\t\tThe registry key name is decrypted via RC4 and the malware will attempt to decrypt the contents by using RC4 if the key is present on the victim's system. The malware binds and listens for C2 sessions on the victim's system (see Figure 12.). Once a C2 session is received on a binded port the malware will read the data by using the OpenSSL library and will decode it using a simple rotating XOR / ADD cipher.\n\n\t\t\tAfter decrypting the incoming traffic the implant ensures it contains the following authentication value:\n\n\t\t\t--Begin Auth Value--\n\n\t\t\tqwertyuiop\n\n\t\t\t--End Auth Value--\n\n\t\t\tIf the authentication value exists, the implant knows the external operator wants to proxy traffic through to another location. The malware will respond with the XOR / ADD encoded value \"asdfghjkl\" to let the operator know it is ready to proceed with the proxy requests. Static analysis indicates the malware will connect to remote proxy servers via the Fake TLS protocol mentioned in prior analysis. SSL encryption will not be used to secure communications between this implant and the remote proxy servers -- it will simply use its embedded XOR / ADD cipher (view screenshot). The malware notifies the remote proxy server it wants to open a session by sending it the value \"1qazXSDC23we\". It then expects the remote proxy server to respond with the value \"m*^&^ghfge4wer\". If the remote proxy server does not respond with this value, the proxy session will not continue.\n\n\t\t\tAnalysis indicates the malware also contains a large structure capable of gathering a great deal of information about the victim's system including the computer named and attached adapters. If the following authentication value is received from the external operator, the malware knows the operator wants to gather information about the victim's system:\n\n\t\t\t--Begin Auth Value--\n\n\t\t\tghfghjuyufgdgftr\n\n\t\t\t--End Auth Value--\n\n\t\t\tThe malware will then respond with the XOR / ADD encoded value \"q45tyu6hgvhi7^%$sdf\" to let the remote operator know that it received the command to gather the system information (see Figure 13.). Static analysis indicates all network traffic received and sent from this implant will be protected via a rotating XOR / ADD cipher. Additionally, the connection to the binded port by the C2 operator will be protected via SSL encryption. Whereas, the connections to the remote hosts (accessed via a proxy session) will be protected only via the cipher mentioned above (see Figures 14-15.).\nScreenshots\n \n\nFigure 13 - \n\n \n\nFigure 14 - \n\n \n\nFigure 11 - \n\n \n\nFigure 12 - \n\n \n\nFigure 15 - \n\n \n\nFigure 16 - \n\n \n\nFigure 17 - \n\n\n\nedd2aff8fad0c76021adc74fe3cb3cb1a02913a839ad0f2cf31fdea8b5aa8195\nTags\nbackdoorspywaretrojan\nDetails\n\n\n\nName\nD93B6A5C04D392FC8ED30375BE17BEB4\n\n\nSize\n321730 bytes\n\n\nType\nJava archive data (JAR)\n\n\nMD5\nd93b6a5c04d392fc8ed30375be17beb4\n\n\nSHA1\nf862c2899c41a4d1120a7739cdaff561d2490360\n\n\nSHA256\nedd2aff8fad0c76021adc74fe3cb3cb1a02913a839ad0f2cf31fdea8b5aa8195\n\n\nSHA512\n709931cec37cedf4c5f84f1a2242e48c8465b97217be96a77627a83f317cbb1d0a1a1886955b982b0bf9b92ccf7ab1bef8d782622f81ce1eba337f0530589333\n\n\nssdeep\n6144:1c35mQ6aHY0wxxp/2o0uK1uv8q8lY1pr/Cc800a0sdOQypHIKO9kxZ4:+J5Hlwxmo0Tuv8q8i3+c800NsdFyKKOR\n\n\nEntropy\n7.989671\n\n\n\nAntivirus\n\n\n\nAhnlab\nAndroid-Spyware/Susdama.74c94\n\n\nAvira\nANDROID/Agent.uytoi\n\n\nIkarus\nTrojan.AndroidOS.Agent\n\n\nNANOAV\nTrojan.Android.Mlw.femarh\n\n\nQuick Heal\nAndroid.Manuscrypt.GEN21990\n\n\nSophos\nAndr/Spy-ANK\n\n\nSymantec\nBackdoor.Trojan\n\n\n\nYara Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nDescription\nThis file is a malicious Android APK file. Static analysis indicates it is a RAT, which is designed to listen for incoming connections to a compromised Android device, on port 60000.\n\n\t\t\tAnalysis indicates the Android app is capable of recording phone calls, taking screenshots using the device's embedded camera, reading data from the device's contact manager, and downloading and uploading data from the compromised Android device. The application is also capable of executing commands on the compromised system and scanning for open Wi-Fi channels.\n\nRelationship Summary\n\n\n\n\n93e13ffd2a...\nContains\nda353b2845a354e1a3f671e4a12198e2c6f57a377d02dfaf90477869041a044f\n\n\nda353b2845...\nContains\n91650e7b0833a34abc9e51bff53cc05ef333513c6be038df29929a0a55310d9c\n\n\nda353b2845...\nContained_Within\n93e13ffd2a2f1a13fb9a09de1d98324f75b3f0f8e0c822857ed5ca3b73ee3672\n\n\n91650e7b08...\nContained_Within\nda353b2845a354e1a3f671e4a12198e2c6f57a377d02dfaf90477869041a044f\n\n\n\n\nRecommendations\n\nCISA recommends that users and administrators consider using the following best practices to strengthen the security posture of their organization's systems. Any configuration changes should be reviewed by system owners and administrators prior to implementation to avoid unwanted impacts.\n\nMaintain up-to-date antivirus signatures and engines.\nKeep operating system patches up-to-date.\nDisable File and Printer sharing services. If these services are required, use strong passwords or Active Directory authentication.\nRestrict users' ability (permissions) to install and run unwanted software applications. Do not add users to the local administrators group unless required.\nEnforce a strong password policy and implement regular password changes.\nExercise caution when opening e-mail attachments even if the attachment is expected and the sender appears to be known.\nEnable a personal firewall on agency workstations, configured to deny unsolicited connection requests.\nDisable unnecessary services on agency workstations and servers.\nScan for and remove suspicious e-mail attachments; ensure the scanned attachment is its \"true file type\" (i.e., the extension matches the file header).\nMonitor users' web browsing habits; restrict access to sites with unfavorable content.\nExercise caution when using removable media (e.g., USB thumb drives, external drives, CDs, etc.).\nScan all software downloaded from the Internet prior to executing.\nMaintain situational awareness of the latest threats and implement appropriate Access Control Lists (ACLs).\n\nAdditional information on malware incident prevention and handling can be found in National Institute of Standards and Technology (NIST) Special Publication 800-83, \"Guide to Malware Incident Prevention & Handling for Desktops and Laptops\".\n\nContact Information\n\n\n1-888-282-0870\nNCCICCustomerService@us-cert.gov (UNCLASS)\nus-cert@dhs.sgov.gov (SIPRNET)\nus-cert@dhs.ic.gov (JWICS)\n\nCISA continuously strives to improve its products and services. You can help by answering a very short series of questions about this product at the following URL: https://us-cert.gov/forms/feedback/\n\nDocument FAQ\n\nWhat is a MIFR? A Malware Initial Findings Report (MIFR) is intended to provide organizations with malware analysis in a timely manner. In most instances this report will provide initial indicators for computer and network defense. To request additional analysis, please contact CISA and provide information regarding the level of desired analysis.\nWhat is a MAR? A Malware Analysis Report (MAR) is intended to provide organizations with more detailed malware analysis acquired via manual reverse engineering. To request additional analysis, please contact CISA and provide information regarding the level of desired analysis.\nCan I edit this document? This document is not to be edited in any way by recipients. All comments or questions related to this document should be directed to the CISA at 1-888-282-0870 or soc@us-cert.gov.\nCan I submit malware to CISA? Malware samples can be submitted via three methods:\n\nWeb: https://malware.us-cert.gov\nE-Mail: submit@malware.us-cert.gov\nFTP: ftp.malware.us-cert.gov (anonymous)\n\nCISA encourages you to report any suspicious activity, including cybersecurity incidents, possible malicious code, software vulnerabilities, and phishing-related scams. Reporting forms can be found on CISA's homepage at www.us-cert.gov.\n\n\n\n\n\n\n\n\nRevisions\n\nSeptember 9, 2019: Initial version\n",
  "cves": [
    "CVE-2022-47966",
    "CVE-2022-42475"
  ],
  "techniques": [],
  "advisory": "ar19-252a",
  "title": "MAR-10135536-10 \u2013 North Korean Trojan: BADCALL | CISA",
  "source": "analysis-reports",
  "id": "09ec76aaa0dae99664e0f1cfd5c5efcda95be7675a09a93ffc5daad635a259bd"
}