{
  "markdown": "\nbody#cma-body { font-family: Franklin Gothic Medium, Franklin Gothic, ITC Franklin Gothic, Arial, sans-serif; font-size: 15px; } table#cma-table { width: 900px; margin: 2px; table-layout: fixed; border-collapse: collapse; } div#cma-exercise { width: 900px; height: 30px; text-align: center; line-height: 30px; font-weight: bold; font-size: 18px; } div.cma-header { text-align: center; margin-bottom: 40px; } div.cma-footer { text-align: center; margin-top: 20px; } h2.cma-tlp { background-color: #000; color: #ffffff; width: 180px; height: 30px; text-align: center; line-height: 30px; font-weight: bold; font-size: 18px; float: right; } span.cma-fouo { line-height: 30px; font-weight: bold; font-size: 16px; } h3.cma-section-title { font-size: 18px; font-weight: bold; padding: 0 10px; margin-top: 10px; } h4.cma-object-title { font-size: 16px; font-weight: bold; margin-left: 20px; } h5.cma-data-title { padding: 3px 0 3px 10px; margin: 10px 0 0 20px; background-color: #e7eef4; font-size: 15px; } p.cma-text { margin: 5px 0 0 25px !important; word-wrap: break-word !important; } div.cma-section { border-bottom: 5px solid #aaa; margin: 5px 0; padding-bottom: 10px; } div.cma-avoid-page-break { page-break-inside: avoid; } div#cma-summary { page-break-after: always; } div#cma-faq { page-break-after: always; } table.cma-content { border-collapse: collapse; margin-left: 20px; } table.cma-hashes { table-layout: fixed; width: 880px; } table.cma-hashes td{ width: 780px; word-wrap: break-word; } .cma-left th { text-align: right; vertical-align: top; padding: 3px 8px 3px 20px; background-color: #f0f0f0; border-right: 1px solid #aaa; } .cma-left td { padding-left: 8px; } .cma-color-title th, .cma-color-list th, .cma-color-title-only th { text-align: left; padding: 3px 0 3px 20px; background-color: #f0f0f0; } .cma-color-title td, .cma-color-list td, .cma-color-title-only td { padding: 3px 20px; } .cma-color-title tr:nth-child(odd) { background-color: #f0f0f0; } .cma-color-list tr:nth-child(even) { background-color: #f0f0f0; } td.cma-relationship { max-width: 310px; word-wrap: break-word; } ul.cma-ul { margin: 5px 0 10px 0; } ul.cma-ul li { line-height: 20px; margin-bottom: 5px; word-wrap: break-word; } #cma-survey { font-weight: bold; font-style: italic; } div.cma-banner-container { position: relative; text-align: center; color: white; } img.cma-banner { max-width: 900px; height: auto; } img.cma-nccic-logo { max-height: 60px; width: auto; float: left; margin-top: -15px; } div.cma-report-name { position: absolute; bottom: 32px; left: 12px; font-size: 20px; } div.cma-report-number { position: absolute; bottom: 70px; right: 100px; font-size: 18px; } div.cma-report-date { position: absolute; bottom: 32px; right: 100px; font-size: 18px; } img.cma-thumbnail { max-height: 100px; width: auto; vertical-align: top; } img.cma-screenshot { margin: 10px 0 0 25px; max-width: 800px; height: auto; vertical-align: top; border: 1px solid #000; } div.cma-screenshot-text { margin: 10px 0 0 25px; } .cma-break-word { word-wrap: break-word; } .cma-tag { border-radius: 5px; padding: 1px 10px; margin-right: 10px; } .cma-tag-info { background: #f0f0f0; } .cma-tag-warning { background: #ffdead; }\n\n\n\n\n\n\n\nMalware Analysis Report\n10322463.r5.v1\n2021-02-12\n\nNotification\n\nThis report is provided \"as is\" for informational purposes only. The Department of Homeland Security (DHS) does not provide any warranties of any kind regarding any information contained herein. The DHS does not endorse any commercial product or service referenced in this bulletin or otherwise.\nThis document is marked TLP:WHITE--Disclosure is not limited. Sources may use TLP:WHITE when information carries minimal or no foreseeable risk of misuse, in accordance with applicable rules and procedures for public release. Subject to standard copyright rules, TLP:WHITE information may be distributed without restriction. For more information on the Traffic Light Protocol (TLP), see http://www.us-cert.gov/tlp.\n\nSummary\n\nDescription\nThis Malware Analysis Report (MAR) is the result of analytic efforts among the Federal Bureau of Investigation (FBI), the Cybersecurity and Infrastructure Security Agency (CISA), and the Department of Treasury (Treasury) to highlight the cyber threat to cryptocurrency posed by North Korea, formally known as the Democratic People\u2019s Republic of Korea (DPRK), and provide mitigation recommendations. Working with U.S. government partners, FBI, CISA, and Treasury assess that Lazarus Group\u2014which these agencies attribute to North Korean state-sponsored advanced persistent threat (APT) actors\u2014is targeting individuals and companies, including cryptocurrency exchanges and financial service companies, through the dissemination of cryptocurrency trading applications that have been modified to include malware that facilitates theft of cryptocurrency.\n\n\t\t\tThis MAR highlights this cyber threat posed by North Korea and provides detailed indicators of compromise (IOCs) used by the North Korean government. The U.S. Government refers to malicious cyber activity by the North Korean government as HIDDEN COBRA. For more information on other versions of AppleJeus and recommended steps to mitigate this threat, see Joint Cybersecurity Advisory AA21-048A: AppleJeus: Analysis of\u00a0North Korea's Cryptocurrency Malware at https://www.us-cert.cisa.gov/ncas/alerts/AA21-048A.\n\n\t\t\tThere have been multiple versions of AppleJeus malware discovered since its initial discovery in August 2018. In most versions, the malware appears to be from a legitimate-looking cryptocurrency trading company and website, whereby an unsuspecting individual downloads a third-party application from a website that appears legitimate.\n\n\t\t\tThe U.S. Government has identified AppleJeus malware version\u2014CoinGoTrade\u2014and associated IOCs used by the North Korean government in AppleJeus operations.\n\n\t\t\tCoinGoTrade discovered in October 2020, is a legitimate-looking cryptocurrency trading software that is marketed and distributed by a company and website\u2014CoinGoTrade and coingotrade[.]com, respectively\u2014that appear legitimate. Some information has been redacted from this report to preserve victim anonymity.\nFor a downloadable copy of IOCs, see: MAR-10322463-5.v1.stix.\nSubmitted Files (7)\n326d7836d580c08cf4b5e587434f6e5011ebf2284bbf3e7c083a8f41dac36ddd (CoinGoTradeUpgradeDaemon)\n[Redacted] (CoinGoTrade.msi)\n3e5442440aea07229a1bf6ca2fdf78c5e2e5eaac312a325ccb49d45da14f97f4 (CoinGoTrade.exe)\n527792dfab79f026eaa6930d2109c93e816ed31826dba0338a9223db71aced18 (CoinGo_Trade)\n572a124f5665be68eaa472590f3ba75bf34b0ea2942b5fcbfd3e74654202dd09 (CoinGoTradeUpdate.exe)\n5e40d106977017b1ed235419b1e59ff090e1f43ac57da1bb5d80d66ae53b1df8 (prtspool)\n[Redacted] (CoinGoTrade.dmg)\nDomains (4)\nairbseeker.com\ncoingotrade.com\nglobalkeystroke.com\nwoodmate.it\nIPs (1)\n23.152.0.101\n\nFindings\n\n[Redacted]\nTags\ndropper\nDetails\n\n\n\nName\nCoinGoTrade.msi\n\n\nSize\n[Redacted] bytes\n\n\nType\nComposite Document File V2 Document, Little Endian, Os: Windows, Version 10.0, MSI Installer, Security: 0, Code page: 1252, Number of Words: 2, Subject: CoinGoTrade, Author: CoinGoTrade, Name of Creating Application: Advanced Installer 14.5.2 build 83143, Template: ;1033, Comments: This installer database contains the logic and data required to install CoinGoTrade., Title: Installation Database, Keywords: Installer, MSI, Database, Number of Pages: 200\n\n\nMD5\n[Redacted]\n\n\nSHA1\n[Redacted]\n\n\nSHA256\n[Redacted]\n\n\nSHA512\n[Redacted]\n\n\nssdeep\n[Redacted]\n\n\nEntropy\n[Redacted]\n\n\n\nAntivirus\n\n\n\nAvira\nTR/NukeSped.lyfhd\n\n\n\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\n[Redacted]\nDownloaded_By\ncoingotrade.com\n\n\n[Redacted]\nContains\n3e5442440aea07229a1bf6ca2fdf78c5e2e5eaac312a325ccb49d45da14f97f4\n\n\n[Redacted]\nContains\n572a124f5665be68eaa472590f3ba75bf34b0ea2942b5fcbfd3e74654202dd09\n\n\n\nDescription\nThis Windows program from the CoinGoTrade site is a Windows MSI Installer. The installer appears to be legitimate and will install \"CoinGoTrade.exe\" (3e5442440aea07229a1bf6ca2fdf78c5e2e5eaac312a325ccb49d45da14f97f4) in the \u201cC:\\Program Files (x86)\\CoinGoTrade\u201d folder. It will also install \"CoinGoTradeUpdate.exe\" (572a124f5665be68eaa472590f3ba75bf34b0ea2942b5fcbfd3e74654202dd09) in the \u201cC:\\Users\\<username>\\AppData\\Roaming\\CoinGoTradeSupport\u201d folder. Immediately after installation, the installer launches \"CoinGoTradeUpdate.exe.\" During installation, a \"CoinGoTrade\" folder containing the \"CoinGoTrade.exe\" application is added to the start menu.\nScreenshots\n \n\nFigure 1 - Screenshot of \"CoinGoTrade\" installation.\n\n\n\ncoingotrade.com\nURLs\n\ncoingotrade.com/update_coingotrade.php\nhxxps[:]//coingotrade.com/download/[GUID]\n\nWhois\nWhois for coingotrade.com had the following information:\n\t\t\tRegistrar: NAMECHEAP INC\n\t\t\tCreation Date: 2020-02-28\n\t\t\tRegistrar Registration Expiration Date: 2021-02-28\nRelationships\n\n\n\ncoingotrade.com\nDownloaded\n[Redacted]\n\n\ncoingotrade.com\nConnected_From\n572a124f5665be68eaa472590f3ba75bf34b0ea2942b5fcbfd3e74654202dd09\n\n\ncoingotrade.com\nDownloaded\n[Redacted]\n\n\n\nDescription\nThe domain \"coingotrade.com\" had a legitimately signed Sectigo Secure Sockets Layer (SSL) certificate, which was \u201cDomain Control Validated,\" similar to the domain certificates for previous AppleJeus variants. Investigation revealed the point of contact listed for verification was support[@]coingotrade.com. No other contact information was available as the administrative or technical contact for the coingotrade.com domain.\n\n\t\t\tThe domain is registered with NameCheap at the IP address 198.54.114.175 with ASN 22612.\n\n\t\t\tInvestigation revealed the IP address 198.54.114.175 was hosted at NameCheap, but no records were available at the time of writing.\nScreenshots\n \n\nFigure 2 -  Screenshot of the \"CoinGoTrade\" website.\n\n\n\n3e5442440aea07229a1bf6ca2fdf78c5e2e5eaac312a325ccb49d45da14f97f4\nTags\ntrojan\nDetails\n\n\n\nName\nCoinGoTrade.exe\n\n\nSize\n166912 bytes\n\n\nType\nPE32 executable (GUI) Intel 80386 Mono/.Net assembly, for MS Windows\n\n\nMD5\n88de31ad947927004ab56ab1e855fd64\n\n\nSHA1\n1d1f9f3ee8329c3f3033222a46c7a311f259a359\n\n\nSHA256\n3e5442440aea07229a1bf6ca2fdf78c5e2e5eaac312a325ccb49d45da14f97f4\n\n\nSHA512\n6e8391afc19ddfb841b79cc9b697fcd162d3a94a79976d3525476475d6fbe684ce9f2ba3a433cd725a51a71f6f74635a109914ff14252fac7e167a095ff1a890\n\n\nssdeep\n3072:ssXh1ExFDi8z4C3Ssi5jCxe7IDYQFNY7BGMDK49eQ:sZRul5rLK4s\n\n\nEntropy\n4.402659\n\n\n\nAntivirus\n\n\n\nAhnlab\nTrojan/Win32.FakeCoinTrader\n\n\nBitDefender\nGen:Variant.MSILHeracles.2293\n\n\nESET\na variant of MSIL/Agent.TYJ trojan\n\n\nEmsisoft\nGen:Variant.MSILHeracles.2293 (B)\n\n\nLavasoft\nGen:Variant.MSILHeracles.2293\n\n\n\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nPE Metadata\n\n\n\nCompile Date\n2020-03-17 04:55:13-04:00\n\n\nImport Hash\nf34d5f2d4577ed6d9ceec516c1f5a744\n\n\nFile Description\nCryptoMex\n\n\nInternal Name\nCoinGoTrade.exe\n\n\nLegal Copyright\nCopyright \u00a9 2020\n\n\nOriginal Filename\nCoinGoTrade.exe\n\n\nProduct Name\nCryptoMex\n\n\nProduct Version\n1.0.0.0\n\n\n\nPE Sections\n\n\n\nMD5\nName\nRaw Size\nEntropy\n\n\nebb11bbea122a2fc761dff1d05defdb0\nheader\n512\n2.714333\n\n\nb0d3ef9b5a227d092cf27c40c028d82d\n.text\n40960\n4.785436\n\n\n35d28033f1f2359f265d8f406fc2c620\n.rsrc\n124928\n4.154855\n\n\n9d7ce3b9440143a341b9232fc0cb38ce\n.reloc\n512\n0.081539\n\n\n\nPackers/Compilers/Cryptors\n\n\n\nMicrosoft Visual C# v7.0 / Basic .NET\n\n\n\nRelationships\n\n\n\n3e5442440a...\nContained_Within\n[Redacted]\n\n\n3e5442440a...\nConnected_To\n23.152.0.101\n\n\n\nDescription\nThis file is a 32-bit Windows executable contained within the Windows MSI Installer \"CoinGoTrade.msi.\" When executed, \"CoinGoTrade.exe\" loads a legitimate looking cryptocurrency wallet application with no signs of malicious activity. The strings for \"CoinGoTrade.exe\" contain the command and control (C2) \"hxxp[:]//23.152.0.101:8080/ which was also identified in the MacOS CoinGo_Trade (527792dfab79f026eaa6930d2109c93e816ed31826dba0338a9223db71aced18) and the Kupay Wallet Stage 2 from AppleJeus version 4. In addition, a build path is present in the strings \u201cU:\\work\\CryptoMex\\teobot\\teobot\\obj\\Release\\CoinGoTrade.pdb\" and the file properties description also states \u201cCryptoMex.\" CryptoMex is likely an open source cryptocurrency application which was copied in order to create this application.\nScreenshots\n \n\nFigure 3 - Screenshot of \"CryptoMex\" listed in CoinGoTrade.exe\" properties.\n\n\n\n23.152.0.101\nTags\ncommand-and-control\nPorts\n\n8080 TCP\n\nWhois\nQueried whois.arin.net with \"n 23.152.0.101\"...\n\n\t\t\tNetRange: \u00a0\u00a0\u00a0 23.152.0.0 - 23.152.0.255\n\t\t\tCIDR: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 23.152.0.0/24\n\t\t\tNetName: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0CROWNCLOUD-V6V4\n\t\t\tNetHandle: \u00a0\u00a0\u00a0 NET-23-152-0-0-1\n\t\t\tParent: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 NET23 (NET-23-0-0-0-0)\n\t\t\tNetType: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Direct Allocation\n\t\t\tOriginAS: \u00a0\u00a0\u00a0 AS8100\n\t\t\tOrganization: Crowncloud US LLC (CUL-34)\n\t\t\tRegDate: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a02015-11-23\n\t\t\tUpdated: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a02015-11-23\n\t\t\tComment: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0IPs in this block are statically assigned, please report any abuse to admin@crowncloud.us\n\t\t\tRef: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0https://rdap.arin.net/registry/ip/23.152.0.0\n\n\n\t\t\tOrgName: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Crowncloud US LLC\n\t\t\tOrgId: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 CUL-34\n\t\t\tAddress: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0530 W 6th St\n\t\t\tAddress: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0C/O Cid 4573 Quadranet Inc. Ste 901\n\t\t\tCity: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 Los Angeles\n\t\t\tStateProv: \u00a0\u00a0\u00a0 CA\n\t\t\tPostalCode: \u00a0\u00a0\u00a0 90014-1207\n\t\t\tCountry: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0US\n\t\t\tRegDate: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a02014-07-25\n\t\t\tUpdated: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a02017-10-10\n\t\t\tRef: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0https://rdap.arin.net/registry/entity/CUL-34\n\n\n\t\t\tOrgTechHandle: CROWN9-ARIN\n\t\t\tOrgTechName: Crowncloud Support\n\t\t\tOrgTechPhone: +1-940-867-4072\n\t\t\tOrgTechEmail: admin@crowncloud.us\n\t\t\tOrgTechRef: \u00a0\u00a0\u00a0https://rdap.arin.net/registry/entity/CROWN9-ARIN\n\n\t\t\tOrgAbuseHandle: CROWN9-ARIN\n\t\t\tOrgAbuseName: Crowncloud Support\n\t\t\tOrgAbusePhone: +1-940-867-4072\n\t\t\tOrgAbuseEmail: admin@crowncloud.us\n\t\t\tOrgAbuseRef: \u00a0\u00a0\u00a0https://rdap.arin.net/registry/entity/CROWN9-ARIN\nRelationships\n\n\n\n23.152.0.101\nConnected_From\n3e5442440aea07229a1bf6ca2fdf78c5e2e5eaac312a325ccb49d45da14f97f4\n\n\n23.152.0.101\nConnected_From\n527792dfab79f026eaa6930d2109c93e816ed31826dba0338a9223db71aced18\n\n\n\nDescription\nThis IP address is the C2 for \"CoinGoTrade.exe\" and \"CoinGo_Trade.\"\n\n\n572a124f5665be68eaa472590f3ba75bf34b0ea2942b5fcbfd3e74654202dd09\nTags\ntrojan\nDetails\n\n\n\nName\nCoinGoTradeUpdate.exe\n\n\nSize\n115712 bytes\n\n\nType\nPE32+ executable (GUI) x86-64, for MS Windows\n\n\nMD5\n149a696472d4a189f5896336ab16cc34\n\n\nSHA1\ndecb43141699e43a1d27dc2db063e0020f9f33aa\n\n\nSHA256\n572a124f5665be68eaa472590f3ba75bf34b0ea2942b5fcbfd3e74654202dd09\n\n\nSHA512\n32081f04a1b4a9540aad81a2a20c00c81ade40624dd446babebeb7230bb84025ba59516fab1388aad3fbf6842811ef2d8d6f0978950442c320edcd2bd8380847\n\n\nssdeep\n3072:FHAqeXaeHx9pdpqw6IQIsMF6s3yv7pHOBo:FWXaeHxrvB6X9M33\n\n\nEntropy\n6.128250\n\n\n\nAntivirus\n\n\n\nAhnlab\nTrojan/Win64.FakeCoinTrader\n\n\nAvira\nTR/NukeSped.ooibk\n\n\nESET\na variant of Win64/NukeSped.CR trojan\n\n\nIkarus\nTrojan.Win64.Nukesped\n\n\nK7\nTrojan ( 00567f291 )\n\n\nSymantec\nTrojan.Gen.2\n\n\nTACHYON\nTrojan/W64.APosT.115712\n\n\nZillya!\nTrojan.APosT.Win32.1433\n\n\n\nYARA Rules\nNo matches found.\nssdeep Matches\n\n\n\n94\nfc1aafd2ed190fa523e60c3d22b6f7ca049d97fc41c9a2fe987576d6b5e81d6d\n\n\n\nPE Metadata\n\n\n\nCompile Date\n2020-03-17 21:02:52-04:00\n\n\nImport Hash\n565005404f00b7def4499142ade5e3dd\n\n\n\nPE Sections\n\n\n\nMD5\nName\nRaw Size\nEntropy\n\n\nd959d6ecb853f993046f81f109f7a5a9\nheader\n1024\n2.714314\n\n\ne350351a05606da16418a7f01436cd7d\n.text\n65536\n6.455927\n\n\n5889779ac56e5fa9aa8123921d9ba943\n.rdata\n39936\n5.084443\n\n\ndbf3b39f579f6cafbdf3960f0a87f5f9\n.data\n2560\n1.851526\n\n\n9b5c53415d33ef775d744a48f71fcd18\n.pdata\n4096\n4.957426\n\n\n90e2eb1b90616d039eca5e2627ea1134\n.gfids\n512\n1.320519\n\n\n3f1861d2a0b1dc2d1329c9d2b3353924\n.reloc\n2048\n4.762609\n\n\n\nPackers/Compilers/Cryptors\n\n\n\nMicrosoft Visual C++ 8.0 (DLL)\n\n\n\nRelationships\n\n\n\n572a124f56...\nContained_Within\n[Redacted]\n\n\n572a124f56...\nConnected_To\ncoingotrade.com\n\n\n\nDescription\nThis file is a 32-bit Windows executable contained within the Windows MSI Installer \"CoinGoTrade.msi.\" When executed, CoinGoTradeUpdate.exe will installs itself as a service, which will automatically start when any user logs on. The service is installed with the description of \u201cAutomatic CoinGoTrade Upgrade.\"\n\n\t\t\tAfter installing the service, \"CoinGoTradeUpdate.exe\" has similar behavior to the updater component for AppleJeus version 4 \"Kupay Wallet.\" On startup \"CoinGoUpdate.exe\" allocates memory to write a file. After allocating the memory and storing the hard-coded string \u201cLatest\u201d in a variable, the program attempts to open a network connection. The connection is named \"CoinGoTrade 1.0 (Check Update Windows),\" which is likely to avoid suspicion from a user.\n\n\t\t\tSimilarly, to previous AppleJeus variants, \"CoinGoTradeUpdate.exe\" collects some basic information from the system as well as a timestamp, and places the collected information in hard-coded format strings. Specifically, the timestamp is placed into a format string \u201cver=%d&timestamp=%lu\u201d where \"ver\" is set as the 1000, possibly referring to the CoinGoTrade version previously mentioned. This basic information and hard-coded strings are sent via a POST to the C2 \"coingotrade.com/update_coingotrade.php.\" If the POST is successful (i.e. returns an HTTP response status code of 200) but fails any of multiple different checks, \"CoinGoTradeUpdate.exe\" will sleep for two minutes and then regenerate the timestamp and contact the C2 again.\n\n\t\t\tAfter receiving the payload from the C2, the program writes the payload to memory and executes the payload.\n\n\t\t\tThe payload for the Windows malware could not be downloaded, as the C2 server \"coingotrade.com/coingotrade_update.php\" was no longer accessible. In addition, the sample was not identified in open source reporting for this sample. The Windows payload is likely similar in functionality to \"prtspool\" (5e40d106977017b1ed235419b1e59ff090e1f43ac57da1bb5d80d66ae53b1df8) the OSX stage 2 sample.\nScreenshots\n \n\nFigure 4 - Screenshot of the format string and version.\n\n\n\n[Redacted]\nTags\ndroppertrojan\nDetails\n\n\n\nName\nCoinGoTrade.dmg\n\n\nSize\n[Redacted] bytes\n\n\nType\nzlib compressed data\n\n\nMD5\n[Redacted]\n\n\nSHA1\n[Redacted]\n\n\nSHA256\n[Redacted]\n\n\nSHA512\n[Redacted]\n\n\nssdeep\n[Redacted]\n\n\nEntropy\n[Redacted]\n\n\n\nAntivirus\nNo matches found.\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\n[Redacted]\nDownloaded_By\ncoingotrade.com\n\n\n[Redacted]\nContains\n527792dfab79f026eaa6930d2109c93e816ed31826dba0338a9223db71aced18\n\n\n[Redacted]\nContains\n326d7836d580c08cf4b5e587434f6e5011ebf2284bbf3e7c083a8f41dac36ddd\n\n\n\nDescription\nThis OSX program from the CoinGoTrade site is an Apple DMG installer. The installer was hosted at hxxps[:]//coingotrade.com/[GUID]. The [GUID] is a unique file that is crafted for a specific victim and is being withheld to preserve the identity of the intended recipient. The OSX program is an Apple DMG installer with the file name CoinGoTrade.dmg.\n\n\t\t\tThe OSX program does not have a digital signature and will warn the user of that before installation. As all previous versions of AppleJeus, the CoinGoTrade installer appears to be legitimate and installs both \u201cCoinGo_Trade\u201d (527792dfab79f026eaa6930d2109c93e816ed31826dba0338a9223db71aced18) in the \u201c/Applications/CoinGoTrade.app/Contents/MacOS/\u201d folder and a program named \"CoinGoTradeUpgradeDaemon\" (326d7836d580c08cf4b5e587434f6e5011ebf2284bbf3e7c083a8f41dac36ddd) also in the \u201c/Applications/CoinGoTrade.app/Contents/MacOS/\u201d folder. The installer contains a postinstall script (Figure 5).\n\n\t\t\tThe postinstall script is identical in functionality to the postinstall scripts from previous AppleJeus variants and is identical to the AppleJeus variant 4 \"Kupay\" postinstall script without the \"launchctl\" command. The postinstall script creates a \u201cCoinGoTradeService\u201d folder in the OSX \u201c/Library/Application Support\u201d folder and moves \"CoinGoTradeUpgradeDaemon\" to it. The \u201cApplication Support\u201d folder contains both system and third-party support files which are necessary for program operation. Typically, the subfolders have names matching those of the actual applications. At installation, CoinGoTrade placed the plist file (com.coingotrade.pkg.product.plist) in \u201c/Library/LaunchDaemons/.\"\n\n\t\t\tAs the LaunchDaemon will not be run immediately after the plist file is moved, the postinstall script then launches the \"CoinGoTradeUpgradeDaemon\" program in the background.\nScreenshots\n \n\nFigure 5 - Screenshot of the postinstall script.\n\n \n\nFigure 6 - Screenshot of \"com.coingotrade.pkg.product.plist.\"\n\n\n\n527792dfab79f026eaa6930d2109c93e816ed31826dba0338a9223db71aced18\nTags\ntrojan\nDetails\n\n\n\nName\nCoinGo_Trade\n\n\nSize\n49536 bytes\n\n\nType\nMach-O 64-bit x86_64 executable, flags:<NOUNDEFS|DYLDLINK|TWOLEVEL|PIE>\n\n\nMD5\n7a73178c682d1a61b2f1c61ae558b608\n\n\nSHA1\n358f4c8575c82f45340886f282d41ca0560cfa6e\n\n\nSHA256\n527792dfab79f026eaa6930d2109c93e816ed31826dba0338a9223db71aced18\n\n\nSHA512\nbb044103c9d2abd04b06a7bae31215302e8310ef5e815ee15025b430b9ea230c7246c96769b2f03a614e1d196ab9bbdf9d3b49980d1b282f58d3823b510ce990\n\n\nssdeep\n384:O6XCYcjaTtLXN8KzIBAsyDfpBkSp6nHYYAZvamQ5nT:O6XZnRNnzICsyuHYrBxgn\n\n\nEntropy\n3.472034\n\n\n\nAntivirus\nNo matches found.\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\n527792dfab...\nContained_Within\n[Redacted]\n\n\n527792dfab...\nConnected_To\n23.152.0.101\n\n\n\nDescription\nThis OSX sample was contained within Apple DMG installer \"CoinGoTrade.dmg.\" \"CoinGo _Trade\" is likely a copy of an open source cryptocurrency application. The strings for \"CoinGo_Trade\" contain the C2 hxxp[:]//23.152.0.101:8080, which is also found in the Windows CoinGoTrade.exe (3e5442440aea07229a1bf6ca2fdf78c5e2e5eaac312a325ccb49d45da14f97f4) and the Kupay Wallet Stage 2 from AppleJeus version 4.\n\n\n326d7836d580c08cf4b5e587434f6e5011ebf2284bbf3e7c083a8f41dac36ddd\nTags\nbackdoortrojan\nDetails\n\n\n\nName\nCoinGoTradeUpgradeDaemon\n\n\nSize\n33312 bytes\n\n\nType\nMach-O 64-bit x86_64 executable, flags:<NOUNDEFS|DYLDLINK|TWOLEVEL|PIE>\n\n\nMD5\n0d195513534855e613bd7a29243565ab\n\n\nSHA1\n80923c208c2c821ed99e1ed8f50bd549598a210c\n\n\nSHA256\n326d7836d580c08cf4b5e587434f6e5011ebf2284bbf3e7c083a8f41dac36ddd\n\n\nSHA512\nd4c822252c03523a3e37edf314caa5142be230e2c34e3f5b648a944b88632e6e74af41bc9c8661c608fdff19822c590f6f98d41dc524385be3092af42936f30f\n\n\nssdeep\n192:fWkPKt21UIIymPTTDO/kqMd+K2uk6aLc4eL:fWIogUKmPTT8\n\n\nEntropy\n1.690330\n\n\n\nAntivirus\n\n\n\nAhnlab\nTrojan/OSX64.FakeCoinTrader.33313\n\n\nAntiy\nTrojan/Mac.NukeSped\n\n\nAvira\nOSX/NukeSped.ifaaj\n\n\nBitDefender\nGen:Variant.Trojan.MAC.Lazarus.4\n\n\nClamAV\nOsx.Malware.Agent-8010705-0\n\n\nESET\na variant of OSX/NukeSped.F trojan\n\n\nEmsisoft\nGen:Variant.Trojan.MAC.Lazarus.4 (B)\n\n\nIkarus\nTrojan.OSX.Nukesped\n\n\nLavasoft\nGen:Variant.Trojan.MAC.Lazarus.4\n\n\nMcAfee\nOSX/Lazarus.c\n\n\nMicrosoft Security Essentials\nTrojan:MacOS/NukeSped.D!MTB\n\n\nQuick Heal\nMac.Backdoor.38173.GC\n\n\nSophos\nOSX/NukeSped-AG\n\n\nSymantec\nOSX.Trojan.Gen\n\n\nTrendMicro\nTROJ_FR.84D8D3BE\n\n\nTrendMicro House Call\nTROJ_FR.84D8D3BE\n\n\nZillya!\nTrojan.NukeSped.OSX.7\n\n\n\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\n326d7836d5...\nContained_Within\n[Redacted]\n\n\n\nDescription\nThis OSX sample was contained within Apple DMG installer \"CoinGoTrade.dmg.\" \"CoinGoTradeUpgradeDaemon\" is similar to \"kupay_upgrade\" from AppleJeus version 4. When executed, \"CoinGoTradeUpgradeDaemon\" will immediately sleep for five seconds and then test to see if the hard-coded value stored in \u201cisReady\u201d is a 0 or a 1. If it is a 0, the program sleeps again and if it is a 1, the function \u201cCheckUpdate\u201d is called. This function contains most of the logic functionality of the malware. \"CheckUpdate\" sends a POST to the C2 hxxps[:]//coingotrade.com/update_coingotrade.php with a connection named \u201cCoinGoTrade 1.0 (Check Update Osx).\n\n\t\t\tIf the C2 server returns a file, it is decoded and written to \u201c/private/tmp/updatecoingotrade\u201d and the permissions are set with the command \"chmod\" 700 (only the user can read, write, and execute). The stage 2 malware (/private/tmp/updatecoingotrade) is then launched and the malware \"CoinGoTradeUpgradeDaemon\" returns to sleeping and checking in with the C2 server.\n\n\t\t\tThe stage 2 payload for CoinGoTrade was no longer available from the specified download URL, however, there was a file \"prtspool\" (5e40d106977017b1ed235419b1e59ff090e1f43ac57da1bb5d80d66ae53b1df8) submitted to VirusTotal by the same user on the same date as \"CoinGoTradeUpgradeDaemon.\" This suggests the submitted file may be related to the OSX malware and could be the downloaded payload. Analysis by Crowdstrike showed the file has the same encryption algorithm and initial key values as a Lazarus Group implant known as HOPLIGHT or MANUSCRYPT.\nScreenshots\n \n\nFigure 7 - Screenshot of the C2 loaded into variable.\n\n \n\nFigure 8 - Screenshot of the format string.\n\n\n\n5e40d106977017b1ed235419b1e59ff090e1f43ac57da1bb5d80d66ae53b1df8\nTags\nbackdoortrojan\nDetails\n\n\n\nName\nprtspool\n\n\nSize\n57376 bytes\n\n\nType\nMach-O 64-bit x86_64 executable, flags:<NOUNDEFS|DYLDLINK|TWOLEVEL|BINDS_TO_WEAK|PIE>\n\n\nMD5\n451c23709ecd5a8461ad060f6346930c\n\n\nSHA1\n58b0516d28bd7218b1908fb266b8fe7582e22a5f\n\n\nSHA256\n5e40d106977017b1ed235419b1e59ff090e1f43ac57da1bb5d80d66ae53b1df8\n\n\nSHA512\n80961db270b9f15cff4b0443be79b253e0f98304990fceda03cd2b25393b0e483eacc553e7b33d20da23e3317fafc7b41f93c4a9da863b99c8f5d3c642d036c8\n\n\nssdeep\n768:qQS5bSXXUkVSpVM0ZJflKprXYgICxdAvV/hQJx62:gbGkjZ7KbICY/hQJx6\n\n\nEntropy\n4.259743\n\n\n\nAntivirus\n\n\n\nAntiy\nTrojan[Backdoor]/OSX.NukeSped\n\n\nAvira\nOSX/NukeSped.vhsxo\n\n\nBitDefender\nTrojan.MAC.Generic.12195\n\n\nClamAV\nOsx.Malware.Agent-8019494-0\n\n\nESET\na variant of OSX/NukeSped.E trojan\n\n\nEmsisoft\nTrojan.MAC.Generic.12195 (B)\n\n\nIkarus\nTrojan.OSX.Nukesped\n\n\nLavasoft\nTrojan.MAC.Generic.12195\n\n\nMcAfee\nOSX/Nukesped.e\n\n\nQuick Heal\nMac.Backdoor.38173.GC\n\n\nSophos\nOSX/NukeSped-AF\n\n\nSymantec\nOSX.Trojan.Gen\n\n\nTrendMicro\nTROJ_FR.84D8D3BE\n\n\nTrendMicro House Call\nTROJ_FR.84D8D3BE\n\n\nZillya!\nTrojan.NukeSped.OSX.14\n\n\n\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\n5e40d10697...\nConnected_To\nairbseeker.com\n\n\n5e40d10697...\nConnected_To\nglobalkeystroke.com\n\n\n5e40d10697...\nConnected_To\nwoodmate.it\n\n\n\nDescription\nThis file is a OSX samples that was likely the payload for the sample \"CoinGoTradeUpgradeDaemon.\"This file \"prtspool\" is a 64-bit MACHO executable with the following capabilities:\n\n\t\t\t--Begin capabilities--\n\t\t\tPerform a heart-beat check in with the current C2\n\t\t\tSleep for the specified number of minutes\n\t\t\tEnsure a copy of the current configuration data is written to the file on disk\n\t\t\tDelete the configuration file and exit the implant.\n\t\t\tUpload the current in memory configuration data.\n\t\t\tDownload a new configuration, overwrite the current in memory configuration and write the data to the file /private/etc/krb5d.conf\n\t\t\tPerform a secure delete or file wipe the specified file by overwriting it with all zeros before deleting it from the system.\n\t\t\tDownload a file from the C2 and write it to the specified path.\n\t\t\tUpload a file from the specified file to the C2 server.\n\t\t\tExecute the specified command on the OS shell, pipe the output to a temporary file, and upload it to the C2.\n\t\t\tExecute the specified process.\n\t\t\tList the files and directories in the specified path.\n\t\t\tPerform a TCP connection to the specified IP address and port and report the status back to the C2.\n\t\t\tSet the current working directory to the specified path.\n\t\t\t--End capabilities--\n\n\t\t\tThe file has three C2 URLs hard-coded into the file. In communicating with these servers, the file uses an HTTP POST with multipart-form data boundary string \"--N9dLfqxHNUUw8qaUPqggVTpX.\" Similar to other Lazarus malware, \"prtspool\" uses format strings to store data collected about the system and sends it to the C2s.\n\n\t\t\t--Begin C2 URLs--\n\t\t\thxxps[:]//airbseeker.com/rediret.php\n\t\t\thxxps[:]//globalkeystroke.com/pockbackx.php\n\t\t\thxxps[:]//www[.]woodmate.it/administrator/help/en-GB/bins/tags/taghelper.php.\n\t\t\t--End C2 URLs--\n\n\nairbseeker.com\nTags\ncommand-and-control\nURLs\n\nhxxps[:]//airbseeker.com/rediret.php\n\nWhois\nWhois for airbseeker.com had the following information:\n\t\t\tRegistrar: NAMECHEAP INC\n\t\t\tCreated: 2020-03-03\n\t\t\tExpires: 2021-03-03\nRelationships\n\n\n\nairbseeker.com\nConnected_From\n5e40d106977017b1ed235419b1e59ff090e1f43ac57da1bb5d80d66ae53b1df8\n\n\n\nDescription\nThe domain \"airbseeker.com\" has a legitimately signed Sectigo SSL certificate, which was \u201cDomain Control Validated.\" The domain was at the IP address 68.65.122.160 with ASN 22612.\n\n\nglobalkeystroke.com\nTags\ncommand-and-control\nWhois\nWhois for globalkeystroke.com had the following information:\n\t\t\tRegistrar: NAMECHEAP INC\n\t\t\tCreated: 2019-11-11\n\t\t\tExpires: 2020-11-11\nRelationships\n\n\n\nglobalkeystroke.com\nConnected_From\n5e40d106977017b1ed235419b1e59ff090e1f43ac57da1bb5d80d66ae53b1df8\n\n\n\nDescription\nThe domain \"globalkeystroke.com\" has a legitimately signed Sectigo SSL certificate, which was \u201cDomain Control Validated.\" Investigation revealed the point of contact listed for verification was admin[@]globalkeystroke.com. No other contact information was available as the administrative or technical contact for the globalkeystroke.com domain.\n\n\t\t\tThe domain is registered with NameCheap at the IP address 68.65.122.160 with ASN 22612. The IP address of 185.228.83.129 belongs to Access2.it Group B.v. ISP of the Netherlands. Whois information for the IP revealed the network name as belonging to CrownCloud of Australia.\n\n\t\t\tOn October 11, 2019, the IP address 185.228.83.129 was hosting the domain dev.jmttrading.org according to PassiveDNS. JMT Trading was the second variant of the AppleJeus malware.\n\n\nwoodmate.it\nTags\ncommand-and-control\nWhois\nWhois for woodmate.it had the following information:\n\t\t\tRegistrar: REGISTRYGATE GMBH\n\t\t\tCreated: 2014-05-07\n\t\t\tExpires: 2020-05-07\nRelationships\n\n\n\nwoodmate.it\nConnected_From\n5e40d106977017b1ed235419b1e59ff090e1f43ac57da1bb5d80d66ae53b1df8\n\n\n\nDescription\nThe domain \"woodmate.it\" has a legitimately signed Let\u2019s Encrypt certificate. Let\u2019s Encrypt is a nonprofit Certificate Authority which provides free and automated TLS/SSL certificates for anyone running their software. They do not perform any identity validation.\n\n\t\t\tThe domain is registered with RegistryGate GMBH of Germany at the IP address 85.13.146.113 with ASN 34788.\n\n\t\t\tThe IP address 85.13.146.113 is hosted by Neue Medien Muennich Gmbh of Germany.\n\nRelationship Summary\n\n\n\n\n[Redacted]\nDownloaded_By\ncoingotrade.com\n\n\n[Redacted]\nContains\n3e5442440aea07229a1bf6ca2fdf78c5e2e5eaac312a325ccb49d45da14f97f4\n\n\n[Redacted]\nContains\n572a124f5665be68eaa472590f3ba75bf34b0ea2942b5fcbfd3e74654202dd09\n\n\ncoingotrade.com\nDownloaded\n[Redacted]\n\n\ncoingotrade.com\nConnected_From\n572a124f5665be68eaa472590f3ba75bf34b0ea2942b5fcbfd3e74654202dd09\n\n\ncoingotrade.com\nDownloaded\n[Redacted]\n\n\n3e5442440a...\nContained_Within\n[Redacted]\n\n\n3e5442440a...\nConnected_To\n23.152.0.101\n\n\n23.152.0.101\nConnected_From\n3e5442440aea07229a1bf6ca2fdf78c5e2e5eaac312a325ccb49d45da14f97f4\n\n\n23.152.0.101\nConnected_From\n527792dfab79f026eaa6930d2109c93e816ed31826dba0338a9223db71aced18\n\n\n572a124f56...\nContained_Within\n[Redacted]\n\n\n572a124f56...\nConnected_To\ncoingotrade.com\n\n\n[Redacted]\nDownloaded_By\ncoingotrade.com\n\n\n[Redacted]\nContains\n527792dfab79f026eaa6930d2109c93e816ed31826dba0338a9223db71aced18\n\n\n[Redacted]\nContains\n326d7836d580c08cf4b5e587434f6e5011ebf2284bbf3e7c083a8f41dac36ddd\n\n\n527792dfab...\nContained_Within\n[Redacted]\n\n\n527792dfab...\nConnected_To\n23.152.0.101\n\n\n326d7836d5...\nContained_Within\n[Redacted]\n\n\n5e40d10697...\nConnected_To\nairbseeker.com\n\n\n5e40d10697...\nConnected_To\nglobalkeystroke.com\n\n\n5e40d10697...\nConnected_To\nwoodmate.it\n\n\nairbseeker.com\nConnected_From\n5e40d106977017b1ed235419b1e59ff090e1f43ac57da1bb5d80d66ae53b1df8\n\n\nglobalkeystroke.com\nConnected_From\n5e40d106977017b1ed235419b1e59ff090e1f43ac57da1bb5d80d66ae53b1df8\n\n\nwoodmate.it\nConnected_From\n5e40d106977017b1ed235419b1e59ff090e1f43ac57da1bb5d80d66ae53b1df8\n\n\n\n\nRecommendations\n\nCISA recommends that users and administrators consider using the following best practices to strengthen the security posture of their organization's systems. Any configuration changes should be reviewed by system owners and administrators prior to implementation to avoid unwanted impacts.\n\nMaintain up-to-date antivirus signatures and engines.\nKeep operating system patches up-to-date.\nDisable File and Printer sharing services. If these services are required, use strong passwords or Active Directory authentication.\nRestrict users' ability (permissions) to install and run unwanted software applications. Do not add users to the local administrators group unless required.\nEnforce a strong password policy and implement regular password changes.\nExercise caution when opening e-mail attachments even if the attachment is expected and the sender appears to be known.\nEnable a personal firewall on agency workstations, configured to deny unsolicited connection requests.\nDisable unnecessary services on agency workstations and servers.\nScan for and remove suspicious e-mail attachments; ensure the scanned attachment is its \"true file type\" (i.e., the extension matches the file header).\nMonitor users' web browsing habits; restrict access to sites with unfavorable content.\nExercise caution when using removable media (e.g., USB thumb drives, external drives, CDs, etc.).\nScan all software downloaded from the Internet prior to executing.\nMaintain situational awareness of the latest threats and implement appropriate Access Control Lists (ACLs).\n\nAdditional information on malware incident prevention and handling can be found in National Institute of Standards and Technology (NIST) Special Publication 800-83, \"Guide to Malware Incident Prevention & Handling for Desktops and Laptops\".\n\nContact Information\n\n\n1-888-282-0870\nCISA Central\u00a0(UNCLASS)\nCISA SIPR (SIPRNET)\nCISA IC (JWICS)\n\nCISA continuously strives to improve its products and services. You can help by answering a very short series of questions about this product at the following URL: https://us-cert.cisa.gov/forms/feedback/\n\nDocument FAQ\n\nWhat is a MIFR? A Malware Initial Findings Report (MIFR) is intended to provide organizations with malware analysis in a timely manner. In most instances this report will provide initial indicators for computer and network defense. To request additional analysis, please contact CISA and provide information regarding the level of desired analysis.\nWhat is a MAR? A Malware Analysis Report (MAR) is intended to provide organizations with more detailed malware analysis acquired via manual reverse engineering. To request additional analysis, please contact CISA and provide information regarding the level of desired analysis.\nCan I edit this document? This document is not to be edited in any way by recipients. All comments or questions related to this document should be directed to the CISA at 1-888-282-0870 or CISA Central.\nCan I submit malware to CISA? Malware samples can be submitted via three methods:\n\nWeb: https://malware.us-cert.gov\nE-Mail: submit@malware.us-cert.gov\nFTP: ftp.malware.us-cert.gov (anonymous)\n\nCISA encourages you to report any suspicious activity, including cybersecurity incidents, possible malicious code, software vulnerabilities, and phishing-related scams. Reporting forms can be found on CISA's homepage at www.cisa.gov.\n\n\n\n\n\n\n\n\nRevisions\n\nFebruary 17, 2021: Initial Version\n",
  "cves": [
    "CVE-2022-42475",
    "CVE-2022-47966"
  ],
  "techniques": [],
  "advisory": "ar21-048e",
  "title": "MAR-10322463-5.v1 - AppleJeus: CoinGoTrade | CISA",
  "source": "analysis-reports",
  "id": "51f9e7e2426d28843a639e78fc2d14492707a7f9e8b2184b91cff570de786c8c"
}