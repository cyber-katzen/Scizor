{
  "markdown": "\nbody#cma-body { font-family: Franklin Gothic Medium, Franklin Gothic, ITC Franklin Gothic, Arial, sans-serif; font-size: 15px; } table#cma-table { width: 900px; margin: 2px; table-layout: fixed; border-collapse: collapse; } div#cma-exercise { width: 900px; height: 30px; text-align: center; line-height: 30px; font-weight: bold; font-size: 18px; } div.cma-header { text-align: center; margin-bottom: 40px; } div.cma-footer { text-align: center; margin-top: 20px; } h2.cma-tlp { background-color: #000; color: #ffffff; width: 180px; height: 30px; text-align: center; line-height: 30px; font-weight: bold; font-size: 18px; float: right; } span.cma-fouo { line-height: 30px; font-weight: bold; font-size: 16px; } h3.cma-section-title { font-size: 18px; font-weight: bold; padding: 0 10px; margin-top: 10px; } h4.cma-object-title { font-size: 16px; font-weight: bold; margin-left: 20px; } h5.cma-data-title { padding: 3px 0 3px 10px; margin: 10px 0 0 20px; background-color: #e7eef4; font-size: 15px; } p.cma-text { margin: 5px 0 0 25px !important; word-wrap: break-word !important; } div.cma-section { border-bottom: 5px solid #aaa; margin: 5px 0; padding-bottom: 10px; } div.cma-avoid-page-break { page-break-inside: avoid; } div#cma-summary { page-break-after: always; } div#cma-faq { page-break-after: always; } table.cma-content { border-collapse: collapse; margin-left: 20px; } table.cma-hashes { table-layout: fixed; width: 880px; } table.cma-hashes td{ width: 780px; word-wrap: break-word; } .cma-left th { text-align: right; vertical-align: top; padding: 3px 8px 3px 20px; background-color: #f0f0f0; border-right: 1px solid #aaa; } .cma-left td { padding-left: 8px; } .cma-color-title th, .cma-color-list th, .cma-color-title-only th { text-align: left; padding: 3px 0 3px 20px; background-color: #f0f0f0; } .cma-color-title td, .cma-color-list td, .cma-color-title-only td { padding: 3px 20px; } .cma-color-title tr:nth-child(odd) { background-color: #f0f0f0; } .cma-color-list tr:nth-child(even) { background-color: #f0f0f0; } td.cma-relationship { max-width: 310px; word-wrap: break-word; } ul.cma-ul { margin: 5px 0 10px 0; } ul.cma-ul li { line-height: 20px; margin-bottom: 5px; word-wrap: break-word; } #cma-survey { font-weight: bold; font-style: italic; } div.cma-banner-container { position: relative; text-align: center; color: white; } img.cma-banner { max-width: 900px; height: auto; } img.cma-nccic-logo { max-height: 60px; width: auto; float: left; margin-top: -15px; } div.cma-report-name { position: absolute; bottom: 32px; left: 12px; font-size: 20px; } div.cma-report-number { position: absolute; bottom: 70px; right: 100px; font-size: 18px; } div.cma-report-date { position: absolute; bottom: 32px; right: 100px; font-size: 18px; } img.cma-thumbnail { max-height: 100px; width: auto; vertical-align: top; } img.cma-screenshot { margin: 10px 0 0 25px; max-width: 800px; height: auto; vertical-align: top; border: 1px solid #000; } div.cma-screenshot-text { margin: 10px 0 0 25px; } .cma-break-word { word-wrap: break-word; } .cma-tag { border-radius: 5px; padding: 1px 10px; margin-right: 10px; } .cma-tag-info { background: #f0f0f0; } .cma-tag-warning { background: #ffdead; }\n\n\n\n\n\n\n\nMalware Analysis Report\n10322463.r1.v1\n2021-02-12\n\nNotification\n\nThis report is provided \"as is\" for informational purposes only. The Department of Homeland Security (DHS) does not provide any warranties of any kind regarding any information contained herein. The DHS does not endorse any commercial product or service referenced in this bulletin or otherwise.\nThis document is marked TLP:WHITE--Disclosure is not limited. Sources may use TLP:WHITE when information carries minimal or no foreseeable risk of misuse, in accordance with applicable rules and procedures for public release. Subject to standard copyright rules, TLP:WHITE information may be distributed without restriction. For more information on the Traffic Light Protocol (TLP), see http://www.us-cert.gov/tlp.\n\nSummary\n\nDescription\nThis Malware Analysis Report (MAR) is the result of analytic efforts among the Federal Bureau of Investigation (FBI), the Cybersecurity and Infrastructure Security Agency (CISA), and the Department of Treasury (Treasury) to highlight the cyber threat to cryptocurrency posed by North Korea, formally known as the Democratic People\u2019s Republic of Korea (DPRK), and provide mitigation recommendations. Working with U.S. government partners, FBI, CISA, and Treasury assess that Lazarus Group\u2014which these agencies attribute to North Korean state-sponsored advanced persistent threat (APT) actors\u2014is targeting individuals and companies, including cryptocurrency exchanges and financial service companies, through the dissemination of cryptocurrency trading applications that have been modified to include malware that facilitates theft of cryptocurrency.\n\n\t\t\tThis MAR highlights this cyber threat posed by North Korea and provides detailed indicators of compromise (IOCs) used by the North Korean government. The U.S. Government refers to malicious cyber activity by the North Korean government as HIDDEN COBRA. For more information on other versions of AppleJeus and recommended steps to mitigate this threat, see Joint Cybersecurity Advisory AA21-048A: AppleJeus: Analysis of North Korea's Cryptocurrency Malware at https://www.us-cert.cisa.gov/ncas/alerts/AA21-048A.\n\n\t\t\tThere have been multiple versions of AppleJeus malware discovered since its initial discovery in August 2018. In most versions, the malware appears to be from a legitimate-looking cryptocurrency trading company and website, whereby an unsuspecting individual downloads a third-party application from a website that appears legitimate.\n\n\t\t\tThe U.S. Government has identified AppleJeus malware version\u2014Celas Trade Pro\u2014and associated IOCs used by the North Korean government in AppleJeus operations.\n\n\t\t\tIn August 2018, open source reporting revealed information about a Trojanized version of a legitimate cryptocurrency trading application on a victim\u2019s computer (Note: identity of the victim was not disclosed). The malicious program, known as Celas Trade Pro, is a modified version of the benign QT Bitcoin Trader application. This incident led to the victim company being infected with the malware known to the U.S. Government as FALLCHILL, a North Korean remote administration tool (RAT). According to CISA, FALLCHILL \u201cis a fully functional RAT with multiple commands that the actors can issue from a command and control (C2) server to a victim\u2019s system via dual proxies. FALLCHILL typically infects a system as a file dropped by other HIDDENCOBRA malware. Because of this, additional HIDDENCOBRA malware may be present on systems compromised with FALLCHILL.\"\n\n\t\t\tCelas Trade Pro had been recommended to the victim company via a phishing email from a company known as Celas Limited. The email provided a link to the Celas Limited website (https://www[.]celasllc.com), where the user could download a Windows or MacOS version of the Celas Trade Pro software.\n\u00a0\nFor a downloadable copy of IOCs, see: MAR-10322463-1.v1.stix.\nSubmitted Files (6)\n5e54bccbd4d93447e79cda0558b0b308a186c2be571c739e5460a3cb6ef665c0 (Updater)\n6ee19085ad5c17f989616d17ef68041910b3d0cbcf7e08cc7d7c1a1cb09e6b69 (celastradepro_win_installer_1....)\na84ed8ce714dff76b48b26414de9f045de561146d7eaa09019cbfbb2586c9765 (CelasTradePro.exe)\nbdff852398f174e9eef1db1c2d3fefdda25fe0ea90a40a2e06e51b5c0ebd69eb (Updater.exe)\nc0c2239138b9bc659b5bddd8f49fa3f3074b65df8f3a2f639f7c632d2306af70 (CelasTradePro)\nd404c0a634cef0d32029286fde8efccb6dfe1809066bbec7ac32d42c5ce3bc04 (celastradepro_mac_installer_1....)\nDomains (1)\ncelasllc.com\n\nFindings\n\n6ee19085ad5c17f989616d17ef68041910b3d0cbcf7e08cc7d7c1a1cb09e6b69\nTags\ndroppertrojan\nDetails\n\n\n\nName\ncelastradepro_win_installer_1.00.00.msi\n\n\nSize\n9827840 bytes\n\n\nType\nComposite Document File V2 Document, Little Endian, Os: Windows, Version 10.0, MSI Installer, Last Printed: Fri Dec 11 11:47:44 2009, Create Time/Date: Fri Dec 11 11:47:44 2009, Last Saved Time/Date: Fri Dec 11 11:47:44 2009, Security: 0, Code page: 1252, Revision Number: {A3B40756-2C9C-4167-9296-5DD2DAF7973E}, Number of Words: 2, Subject: CelasTradePro, Author: CELAS LLC, Name of Creating Application: Advanced Installer 14.5.2 build 83143, Template: ;1033, Comments: This installer database contains the logic and data required to install CelasTradePro., Title: Installation Database, Keywords: Installer, MSI, Database, Number of Pages: 200\n\n\nMD5\n9e740241ca2acdc79f30ad2c3f50990a\n\n\nSHA1\n0c5e4cec03d2eea2b1dd5356fe05de64a0278cd6\n\n\nSHA256\n6ee19085ad5c17f989616d17ef68041910b3d0cbcf7e08cc7d7c1a1cb09e6b69\n\n\nSHA512\ndd02c1e717c2556b64d261f04c5a8add7dcc2f3ad267507d883ba68c7e4cf827136edce517aab055dfa02d8569a5779eb1fc24fb0b7c6bb3447d45e2802726e5\n\n\nssdeep\n196608:s80YaAWH7ICcfRLdq81w920W+ZP6g2DsjW1TIZfxgNu1DZNJQfIYizTrh50:sPUWHECcfBdR1w9NWqSg2DsK1TmfxgiD\n\n\nEntropy\n7.973409\n\n\n\nAntivirus\n\n\n\nAhnlab\nMSI/Installer\n\n\nComodo\nMalware\n\n\nMicrosoft Security Essentials\nTrojan:Win32/Letdater\n\n\nQuick Heal\nOLE.MSI.Agent.39994.GC\n\n\nSophos\nTroj/NukeSped-X\n\n\nSymantec\nTrojan.Dropper\n\n\nTrendMicro\nTrojan.BC27BA50\n\n\nTrendMicro House Call\nTrojan.BC27BA50\n\n\n\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\n6ee19085ad...\nDownloaded_From\ncelasllc.com\n\n\n6ee19085ad...\nContains\na84ed8ce714dff76b48b26414de9f045de561146d7eaa09019cbfbb2586c9765\n\n\n6ee19085ad...\nContains\nbdff852398f174e9eef1db1c2d3fefdda25fe0ea90a40a2e06e51b5c0ebd69eb\n\n\n\nDescription\nThis Windows program from the Celas LLC site is a Windows MSI Installer. The installer looks legitimate and previously had a valid digital signature from Comodo (Sectigo). The signature was signed with a code signing certificate purchased by the same user as the Secure Sockets Layer (SSL) certificate for \"celasllc.com.\" The installer asks for administrative privileges to run and while installing \"CelasTradePro.exe\" (a84ed8ce714dff76b48b26414de9f045de561146d7eaa09019cbfbb2586c9765) it also installs \"Updater.exe\" in the \u201cC:\\Program Files (x86)\\CelasTradePro\u201d folder. Immediately after installation, the installer launches \"Updater.exe\" (bdff852398f174e9eef1db1c2d3fefdda25fe0ea90a40a2e06e51b5c0ebd69eb) with the \u201cCheckUpdate\u201d parameter.\nScreenshots\n \n\nFigure 1 - Screenshot of the CelasTradePro installation.\n\n\n\ncelasllc.com\nTags\ncommand-and-control\nURLs\n\ncelasllc.com/checkupdate.php\n\nWhois\nWhois for celasllc.com had the following information in August 2018:\n\t\t\tIP Address: 185.142.236.213\n\t\t\tRegistrant Name: John Broox\n\t\t\tRegistrant Organization:\n\t\t\tRegistrant Street: 2141 S Archer Ave\n\t\t\tRegistrant City: Chicago\n\t\t\tRegistrant State/Province: Illinois\n\t\t\tRegistrant Postal Code: 60601\n\t\t\tRegistrant Country: US\n\t\t\tRegistrant Phone: +1.8133205751\n\t\t\tRegistrant Email: johnbroox200@gmail.com\n\t\t\tName server: 1a7ea920.bitcoin-dns.hosting\n\t\t\tName Server: a8332f3a.bitcoin-dns.hosting\n\t\t\tName Server: ad636824.bitcoin-dns.hosting\n\t\t\tName Server: c358ea2d.bitcoin-dns.hosting\n\t\t\tCreated: May 29, 2018\n\t\t\tExpires: May 29, 2019\n\t\t\tUpdated: Sep 9, 2018\nRelationships\n\n\n\ncelasllc.com\nDownloaded_To\n6ee19085ad5c17f989616d17ef68041910b3d0cbcf7e08cc7d7c1a1cb09e6b69\n\n\ncelasllc.com\nDownloaded_To\nd404c0a634cef0d32029286fde8efccb6dfe1809066bbec7ac32d42c5ce3bc04\n\n\n\nDescription\nThe Celas Limited website had a professional appearance, and at the time had a valid Secure Sockets Layer (SSL) certificate issued by Comodo (now Sectigo). The SSL certificate was \u201cDomain Control Validated,\" which is a weak security verification level for a webserver. Typically, this is a fully automated verification where the certificate requester only needs to demonstrate control over the domain name (i.e. with an email like admin[@]celasllc.com). This type of certificate necessitates no validation of the identity of the website\u2019s owner, nor the existence of the actual business. At the time of analysis, the domain celasllc.com resolved to IP address 185.142.236.213, which belongs to the Netherlands Amsterdam Blackhost Ltd ISP, AS174, Cogent Communications.\nScreenshots\n \n\nFigure 2 - Screenshot of the Celas LLC website.\n\n\n\na84ed8ce714dff76b48b26414de9f045de561146d7eaa09019cbfbb2586c9765\nTags\ntrojan\nDetails\n\n\n\nName\nCelasTradePro.exe\n\n\nSize\n2517160 bytes\n\n\nType\nPE32 executable (GUI) Intel 80386, for MS Windows\n\n\nMD5\n45eb8f06c5f732e8dde8e9318d8b2392\n\n\nSHA1\nd4583cba9034a3068f8106b5013d37d7bdd46f38\n\n\nSHA256\na84ed8ce714dff76b48b26414de9f045de561146d7eaa09019cbfbb2586c9765\n\n\nSHA512\n6536a7b0767828bb95f6f33a4e465fec48fc474b4f919bc878e02966f82f900fbaa6e2f9d7bc1dffa28bbe35f94ee6b9a570902843dfd35a8c9d1405ac130039\n\n\nssdeep\n49152:TrxfUhMyK0lq3Z8SC8Q1ZZmpwi0qEdz+7WGSVOr:PxfU60lqiV1UL\n\n\nEntropy\n6.852284\n\n\n\nAntivirus\n\n\n\nSophos\nMal/BadCert-Gen\n\n\n\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nPE Metadata\n\n\n\nCompile Date\n2018-06-17 20:17:48-04:00\n\n\nImport Hash\n33ef6aff05b44076249d6ed27e247e11\n\n\nCompany Name\nCelas LLC\n\n\nFile Description\nCelas Bitcoin Trader\n\n\nInternal Name\nCelas Bitcoin Trader\n\n\nLegal Copyright\nCopyright (C) 2018 CELAS LLC\n\n\nOriginal Filename\nCelasTradePro.exe\n\n\nProduct Name\nCelasTradePro\n\n\nProduct Version\n1.0.0.0\n\n\n\nPE Sections\n\n\n\nMD5\nName\nRaw Size\nEntropy\n\n\n724cd82da1ca0a93b9d171923d149ce9\nheader\n1024\n2.738571\n\n\n4909abcdca48f01dd7d44d7b6035deef\n.text\n1152000\n6.244241\n\n\n88f7c98251537ffd1f94935b8c134b9a\n.rdata\n1076224\n6.842683\n\n\n0e102f466e9e6893970e2fd96c8b3fce\n.data\n9728\n4.517533\n\n\n87a4b3b57b1b37d19870a4f1c9577374\n.rsrc\n110592\n3.737298\n\n\na6d8c9855dc4334bb35c95a1e0518a9d\n.reloc\n162304\n6.385957\n\n\n\nPackers/Compilers/Cryptors\n\n\n\nMicrosoft Visual C++ ?.?\n\n\n\nRelationships\n\n\n\na84ed8ce71...\nContained_Within\n6ee19085ad5c17f989616d17ef68041910b3d0cbcf7e08cc7d7c1a1cb09e6b69\n\n\n\nDescription\nThis file is a 32-bit Windows executable contained within the Windows MSI Installer \"celastradepro_win_installer_1.00.00.msi.\" When executed, \"CelasTradePro.exe\" asks for the user\u2019s exchange and then loads a legitimate cryptocurrency trading platform with no signs of malicious activity.\n\n\t\t\tCelasTradePro is extremely similar in appearance to a version of an open source cryptocurrency trading platform available around the same timeframe known as QT Bitcoin Trader (screenshots 3 and 4). In addition to similar appearance, many strings found in CelasTradePro have QT Bitcoin Trader references and parameters being set to \u201cCelas Trade Pro\u201d including but not limited to:\n\n\t\t\t--Begin similarities--\n\t\t\tString_ABOUT_QT_BITCOIN_TRADER_TEXT=Celas Trade Pro\n\t\t\tQtBitcoinTrader\n\t\t\tString_ABOUT_QT_BITCOIN_TRADER_TEXT=Celas Trade Pro is a free Open Source project developed on pure C++ Qt and OpenSSL.\n\t\t\tjulyighor@gmail.com (note: Ighor July is one of the developers of QT Bitcoin Trader)\n\t\t\t--End similarities--\n\n\t\t\tThe strings also reference the name \u201cJohn Broox\u201d as the author of CelasTradePro.\n\n\t\t\tWhile the CelasTradePro application is likely a modification of QT Bitcoin Trader, the legitimate QT Bitcoin Trader for Windows is not available for download as an MSI, but only as a Windows portable executable. This is a singular file named \"QtBitcoinTrader.exe\" and does not install or run any additional programs. The CelasTradePro MSI contains \"CelasTradePro.exe,\" the modified version of QT Bitcoin Trader, as well as the additional \"Updater.exe\" (bdff852398f174e9eef1db1c2d3fefdda25fe0ea90a40a2e06e51b5c0ebd69eb) executable not included with the original QT Bitcoin Trader.\nScreenshots\n \n\nFigure 3 - Screenshot of the CelasTradePro application.\n\n \n\nFigure 4 - Screenshot of the QT Bitcoin Trader application.\n\n\n\nbdff852398f174e9eef1db1c2d3fefdda25fe0ea90a40a2e06e51b5c0ebd69eb\nTags\ndownloaderloaderspywaretrojan\nDetails\n\n\n\nName\nUpdater.exe\n\n\nSize\n173224 bytes\n\n\nType\nPE32 executable (GUI) Intel 80386, for MS Windows\n\n\nMD5\nb054a7382adf6b774b15f52d971f3799\n\n\nSHA1\nb4d43cd2d81d17dec523915c0fc61b4b29e62c58\n\n\nSHA256\nbdff852398f174e9eef1db1c2d3fefdda25fe0ea90a40a2e06e51b5c0ebd69eb\n\n\nSHA512\n7c307a2ed0e6e483a0f3e7161ff0433e6bd498ab0b14b5359a938554999b076c4143a766b96c05dc0b949948cac97d81534ceb1300d02276ec90e2c1162383a9\n\n\nssdeep\n1536:XN9cIi98pUYi7tIP+arPg1ssvpoOJwtFT6BxdYIHs/5mBS0LiF:99clzLPPBoOJwWBxdYlxySr\n\n\nEntropy\n4.980364\n\n\n\nAntivirus\n\n\n\nAhnlab\nMalware/Win32.Generic\n\n\nAntiy\nTrojan[Downloader]/Win32.Agent\n\n\nAvira\nTR/Dldr.Agent.jlhae\n\n\nBitDefender\nTrojan.GenericKD.40404380\n\n\nClamAV\nWin.Spyware.Fallchill-6663754-2\n\n\nComodo\nMalware\n\n\nESET\nWin32/TrojanDownloader.NukeSped.E trojan\n\n\nEmsisoft\nTrojan.GenericKD.40404380 (B)\n\n\nIkarus\nTrojan-Downloader.Agent\n\n\nK7\nRiskware ( 0040eff71 )\n\n\nLavasoft\nTrojan.GenericKD.40404380\n\n\nMcAfee\nGeneric trojan.d\n\n\nMicrosoft Security Essentials\nTrojan:Win32/Letdater\n\n\nNANOAV\nTrojan.Win32.Letscool.fflqoo\n\n\nSophos\nTroj/NukeSped-Y\n\n\nSymantec\nTrojan Horse\n\n\nSystweak\ntrojan.agent\n\n\nTrendMicro\nTrojan.BC27BA50\n\n\nTrendMicro House Call\nTrojan.BC27BA50\n\n\nVirusBlokAda\nTrojanDownloader.Agent\n\n\nZillya!\nDownloader.Agent.Win32.365188\n\n\n\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nPE Metadata\n\n\n\nCompile Date\n2018-06-15 06:56:27-04:00\n\n\nImport Hash\nb25cd98650edb58a9a4d00af1d17453d\n\n\n\nPE Sections\n\n\n\nMD5\nName\nRaw Size\nEntropy\n\n\n2c879beba343ce37c06647fb37be983e\nheader\n1024\n2.572659\n\n\n4da943f482631027a2152c6f336055af\n.text\n38912\n6.556738\n\n\n0b7c67c806051953aa6addc2771a20eb\n.rdata\n10240\n4.875590\n\n\n49f73fd786fe23fbc68635fbf76b63a3\n.data\n4096\n2.272665\n\n\n7a96caced6b43d719b90f6e332ad12f3\n.rsrc\n109568\n3.715817\n\n\n8aacf0cff202d7d74c04f938df61e45f\n.reloc\n4096\n4.127553\n\n\n\nPackers/Compilers/Cryptors\n\n\n\nMicrosoft Visual C++ ?.?\n\n\n\nRelationships\n\n\n\nbdff852398...\nContained_Within\n6ee19085ad5c17f989616d17ef68041910b3d0cbcf7e08cc7d7c1a1cb09e6b69\n\n\n\nDescription\nThis file is a 32-bit Windows executable contained within the Windows MSI Installer \"celastradepro_win_installer_1.00.00.msi.\" \"Updater.exe\" has the same program icon as CelasTradePro. Updater.exe was likely developed under the name \u201cjeus\u201d based on the build path \u201cZ:\\jeus\\downloader\\downloader_exe_vs2010\\Release\\dloader.pdb\u201d found in the code (partial origin of the name AppleJeus).\n\n\t\t\t\"Updater.exe\" collects victim host information and sends it back to the server. At launch the malware first checks for the \u201cCheckUpdate\u201d parameter and if not found, exits the program. This is likely to evade detection in a sandbox environment. If the \"CheckUpdate\" parameter is found, the malware creates a unique identifier for the system following the format \u201c%09d-%05d.\" It then collects process lists excluding the \u201cSystem\u201d processes and queries the registry at \u201cHKLM\\SOFTWARE\\Microsoft\\Window NT\\CurrentVersion\u201d for the following values:\n\n\t\t\t--Begin values--\n\t\t\tProductName (Windows OS Version)\n\t\t\tCurrentBuildNumber (Windows 10 build version)\n\t\t\tReleaseID (Windows 10 version information)\n\t\t\tUBR (Sub version of Windows 10 build)\n\t\t\tBuildBranch (Windows 10 build branch information)\n\t\t\t--End values--\n\n\t\t\tAfter collecting this information, \"Updater.exe\" encrypts the data with the hard-coded XOR key \u201cMoz&Wie;#t/6T!2y,\" prepends the encrypted data with \u201cGIF89a\u201d (image header) and sends the data to \"celasllc.com/checkupdate.php.\"\n\n\t\t\tThe malware also uses a hard-coded User-Agent string \u201cMozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.1; Trident/6.0\u201d and multipart form data separator \u201cjeus.\" If the malware receives a response with HTTP code 200, it will decode the base64 payload, then decrypt the result using the hard-coded RC4 decryption key \u201cW29ab@ad%Df324V$Yd.\" The raw data is then written to a file prepended with the \u201cMAX_PATHjeusD\u201d string.\nScreenshots\n \n\nFigure 5 - Screenshot of the \"CheckUpdate\" parameter verification in \"Updater.exe.\"\n\n \n\nFigure 6 - Hard-coded XOR key and XOR encryption in \"Updater.exe.\"\n\n\n\nd404c0a634cef0d32029286fde8efccb6dfe1809066bbec7ac32d42c5ce3bc04\nTags\ndownloaderdropperloadertrojan\nDetails\n\n\n\nName\ncelastradepro_mac_installer_1.00.00.dmg\n\n\nSize\n15020544 bytes\n\n\nType\nDOS/MBR boot sector; partition 1 : ID=0xee, start-CHS (0x3ff,254,63), end-CHS (0x3ff,254,63), startsector 1, 29336 sectors, extended partition table (last)\n\n\nMD5\n48ded52752de9f9b73c6bf9ae81cb429\n\n\nSHA1\n1e8a2f1f751e5a9931bca5710b4f304798d665dc\n\n\nSHA256\nd404c0a634cef0d32029286fde8efccb6dfe1809066bbec7ac32d42c5ce3bc04\n\n\nSHA512\n4c4e4445638ace360c82be741e634601bd1beaf980cdc02523484cc7f161b57015f325708ce72d9a2496f3b5bf2d05df5133aee0d1c375b76b23e6a660436d0f\n\n\nssdeep\n393216:0naJ/9SL/uXRs1q5wxrCAveZZXFdklxkBSY6bzLZaM:bJ/9SLQRwqSrCAS5klxPY6bXZx\n\n\nEntropy\n7.710370\n\n\n\nAntivirus\n\n\n\nAntiy\nTrojan/OSX.Lazarus\n\n\nAvira\nOSX/Lazarus.A\n\n\nComodo\nMalware\n\n\nESET\nOSX/TrojanDownloader.NukeSped.A trojan\n\n\nIkarus\nTrojan.OSX.Lazarus\n\n\nMcAfee\nOSX/Lazarus.a\n\n\nSymantec\nOSX.Dropper\n\n\nTrendMicro\nOSX_APPLEJEUS.A\n\n\nTrendMicro House Call\nOSX_APPLEJEUS.A\n\n\nVir.IT eXplorer\nOSX.Lazarus.ASM\n\n\n\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\nd404c0a634...\nDownloaded_From\ncelasllc.com\n\n\nd404c0a634...\nContains\nc0c2239138b9bc659b5bddd8f49fa3f3074b65df8f3a2f639f7c632d2306af70\n\n\nd404c0a634...\nContains\n5e54bccbd4d93447e79cda0558b0b308a186c2be571c739e5460a3cb6ef665c0\n\n\n\nDescription\nThis OSX program from the Celas LLC site is an Apple DMG Installer. The OSX program has very similar functionality to the Windows program and also previously had a valid digital signature from Comodo. Again the installer appears to be legitimate, and installs CelasTradePro as well as a program named \u201cUpdater\u201d in the \u201c/Applications/CelasTradePro.app/Contents/MacOS/\u201d folder. The installer contains a postinstall script (see figure 6).\n\n\t\t\tA postinstall script is a sequence of instructions which runs after the successful installation of an OSX application. This script moves the hidden \u201c.com.celastradepro.plist\u201d file from the installer package to the LaunchDaemons folder. This file is hidden because the leading \u201c.\u201d causes it to not be shown to the user if they view the folder in the Finder application. Once in the LaunchDaemons folder, this plist file will be ran on system load as root for every user. This will launch the Updater program with the CheckUpdate parameter.\n\n\t\t\tAs the LaunchDaemon will not run automatically after the plist file is moved, the postinstall script then launches the Updater program with the CheckUpdate parameter and runs it in the background (&). The package also has \u201cDeveloped by John Broox. CELAS LLC\u201d in the Info.plist properties file.\nScreenshots\n \n\nFigure 7 - Screenshot of the postinstall script included in OSX Celas installer.\n\n \n\nFigure 8 - Screenshot of the \"com.celastradepro.plist\" file.\n\n\n\nc0c2239138b9bc659b5bddd8f49fa3f3074b65df8f3a2f639f7c632d2306af70\nTags\ntrojan\nDetails\n\n\n\nName\nCelasTradePro\n\n\nSize\n3544560 bytes\n\n\nType\nMach-O 64-bit x86_64 executable, flags:<NOUNDEFS|DYLDLINK|TWOLEVEL|WEAK_DEFINES|BINDS_TO_WEAK|PIE>\n\n\nMD5\n4eedb2df53597a15fd48b726d85517f0\n\n\nSHA1\na60ece7673fa415abe1fb97ac60e19ee446858b1\n\n\nSHA256\nc0c2239138b9bc659b5bddd8f49fa3f3074b65df8f3a2f639f7c632d2306af70\n\n\nSHA512\n853c85760576919bc59aee901663057a0bfd5a286345cc7464f61e7bdfdebfeb2148401597ae037bbf052c052112cb37c34924b2876383c920d17b908f0e3a85\n\n\nssdeep\n49152:bvzxIgxauUDh0Dh6jQIRfzOQo14GNoiZPw6YBoOBzRK8IA1LGqBKta9w35wwlRoJ:3xuwhRIR2LPZPwX1vbL9BgwseMzio\n\n\nEntropy\n6.559908\n\n\n\nAntivirus\n\n\n\nAhnlab\nOSX/Agent.3544560\n\n\nAntiy\nTrojan/OSX.Lazarus\n\n\nAvira\nOSX/Lazarus.dplva\n\n\nBitDefender\nTrojan.MAC.Lazarus.B\n\n\nClamAV\nOsx.Malware.Agent-7408161-0\n\n\nESET\na variant of Generik.IWGLIQC trojan\n\n\nEmsisoft\nTrojan.MAC.Lazarus.B (B)\n\n\nIkarus\nOSX.Lazarus\n\n\nLavasoft\nTrojan.MAC.Lazarus.B\n\n\nMcAfee\nOSX/Lazarus.f\n\n\nSophos\nOSX/Lazarus-D\n\n\nSymantec\nOSX.Malcol.2\n\n\nZillya!\nTrojan.MAC.OSX.89\n\n\n\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\nc0c2239138...\nContained_Within\nd404c0a634cef0d32029286fde8efccb6dfe1809066bbec7ac32d42c5ce3bc04\n\n\n\nDescription\nThis OSX sample was contained within Apple DMG Installer \"celastradepro_mac_installer_1.00.00.dmg.\" When executed, CelasTradePro has identical functionality and appearance to the Windows version CelasTradePro.exe. It asks for the users\u2019 exchange and loads a legitimate cryptocurrency trading application with no signs of malicious activity. As functionality and appearance are the same, it follows that CelasTradePro is a modification of the OSX QT Bitcoin Trader. In addition to similar appearance, many strings found in CelasTradePro have QT Bitcoin Trader references and parameters being set to \u201cCelas Trade Pro\u201d including but not limited to:\n\n\t\t\t--Begin similarities--\n\t\t\tString_ABOUT_QT_BITCOIN_TRADER_TEXT=Celas Trade Pro\n\t\t\tString_ABOUT_QT_BITCOIN_TRADER_TEXT=Celas Trade Pro is a free Open Source project<br>developed on pure C++ Qt and OpenSSL.\n\t\t\tString_APPLICATION_TITLE=Qt Bitcoin Trader\n\t\t\tjulyighor@gmail.com (note: Ighor July is one of the developers of QT Bitcoin Trader)\n\t\t\t--End similarities--\n\n\t\t\tThe strings also reference the name \u201cJohn Broox\u201d as the author of CelasTradePro.\n\n\t\t\tWhile the CelasTradePro application is likely a modification of QT Bitcoin Trader, the legitimate QT Bitcoin Trader DMG for OSX does not contain the postinstall script nor the plist file which creates a LaunchDaemon. When ran, only QTBitcoinTrader will be installed, and no additional programs will be created, installed, or launched.\n\n\t\t\tThe CelasTradePro DMG contains the CelasTradePro OSX executable (the modified version of QT Bitcoin Trader) as well as the additional Updater OSX executable not included with the original QT Bitcoin Trader.\nScreenshots\n \n\nFigure 9 - Screenshot of the legitimate QTBitcoinTrader DMG contents.\n\n\n\n5e54bccbd4d93447e79cda0558b0b308a186c2be571c739e5460a3cb6ef665c0\nTags\nbackdoordownloaderloadertrojan\nDetails\n\n\n\nName\nUpdater\n\n\nSize\n50320 bytes\n\n\nType\nMach-O 64-bit x86_64 executable, flags:<NOUNDEFS|DYLDLINK|TWOLEVEL|WEAK_DEFINES|BINDS_TO_WEAK|PIE>\n\n\nMD5\naeee54a81032a6321a39566f96c822f5\n\n\nSHA1\n53aa0971eb5d53ed242764ebfc89ad591a5211b2\n\n\nSHA256\n5e54bccbd4d93447e79cda0558b0b308a186c2be571c739e5460a3cb6ef665c0\n\n\nSHA512\n9e9abc2c824df20249df9161ad830af2a3d01867089eed23d5985445e34120238881ac3cfd9529bf27588c36f2a17533a4bda8fce8c91949360c236b60852fb0\n\n\nssdeep\n768:A4yOeE/pwi8Aea02PG2mG1oAK+g7mj78yfgum0+mifm:GOeE/pwFs02pvg7mj7bfgum0hi\n\n\nEntropy\n5.010104\n\n\n\nAntivirus\n\n\n\nAhnlab\nOSX/Agent.50320\n\n\nAntiy\nTrojan/OSX.Lazarus\n\n\nAvira\nVBS/Dldr.Formac.npwdq\n\n\nBitDefender\nTrojan.MAC.Lazarus\n\n\nClamAV\nOsx.Malware.Agent-9667647-0\n\n\nComodo\nMalware\n\n\nESET\na variant of OSX/TrojanDownloader.NukeSped.A trojan\n\n\nEmsisoft\nTrojan.MAC.Lazarus (B)\n\n\nIkarus\nTrojan.MAC.Lazarus\n\n\nLavasoft\nTrojan.MAC.Lazarus\n\n\nMicrosoft Security Essentials\nBackdoor:MacOS/AppleJeus.A\n\n\nNANOAV\nTrojan.Mac.Mlw.fhnynm\n\n\nSophos\nOSX/Lazarus-D\n\n\nSymantec\nOSX.Trojan.Gen\n\n\nTrendMicro\nOSX_LAZARUS.A\n\n\nTrendMicro House Call\nOSX_LAZARUS.A\n\n\nZillya!\nDownloader.NukeSped.OSX.1\n\n\n\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\n5e54bccbd4...\nContained_Within\nd404c0a634cef0d32029286fde8efccb6dfe1809066bbec7ac32d42c5ce3bc04\n\n\n\nDescription\nThis OSX sample was contained within Apple DMG Installer \"celastradepro_mac_installer_1.00.00.dmg.\" Updater functions very similarly to the Windows Updater.exe, and collects victim host information to send back to the server. Upon launch, the malware checks for the \u201cCheckUpdate\u201d parameter, and just as the Windows sample, will exit if the parameter is not found. This is likely to avoid sandbox analysis. If the \u201cCheckUpdate\u201d parameter is found, the malware then creates a unique identifier for the system following the format \u201c%09d-%06d.\"\n\n\t\t\tUpdater then uses dedicated QT classes to get system information including host name, OS type and version, system architecture, and OS kernel type and version. The QT Framework is a cross-platform toolkit designed for creating multi-platform applications with native Graphical User Interfaces (GUI) for each platform.\n\n\t\t\tAfter collecting this data, Updater follows the same process as the Windows \"Updater.exe\" to encrypt and send the data. All data is XOR encrypted with the hard-coded key \u201cMoz&Wie;#t/6T!2y\u201d, prepended with \u201cGIF89a\u201d (image header), and sent to www[.]celasllc.com/checkupdate.php. The malware uses the same multipart form data separator \u201cjeus\u201d but has a different hard-coded user-agent string of \u201cMozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.139 Safari/537.36.\"\n\n\t\t\tIf Updater receives a response with the HTTP code 200, it will decode the base64 payload, and decrypt it using the same hard-coded RC4 key \u201cW29ab@ad%Df324V$Yd\u201d as the Windows malware. The decrypted data is then saved to the hard-coded \u201c/var/zdiffsec\u201d file location, file permissions are changed to executable for all users, and the file is started with the hard-coded command line argument \u201cbf6a0c760cc642.\"\nScreenshots\n \n\nFigure 10 - Screenshot of the \"CheckUpdate\" parameter verification in \"Updater.\"\n\n \n\nFigure 11 - Screenshot of various hard-coded values in \"Updater.\"\n\n\nRelationship Summary\n\n\n\n\n6ee19085ad...\nDownloaded_From\ncelasllc.com\n\n\n6ee19085ad...\nContains\na84ed8ce714dff76b48b26414de9f045de561146d7eaa09019cbfbb2586c9765\n\n\n6ee19085ad...\nContains\nbdff852398f174e9eef1db1c2d3fefdda25fe0ea90a40a2e06e51b5c0ebd69eb\n\n\ncelasllc.com\nDownloaded_To\n6ee19085ad5c17f989616d17ef68041910b3d0cbcf7e08cc7d7c1a1cb09e6b69\n\n\ncelasllc.com\nDownloaded_To\nd404c0a634cef0d32029286fde8efccb6dfe1809066bbec7ac32d42c5ce3bc04\n\n\na84ed8ce71...\nContained_Within\n6ee19085ad5c17f989616d17ef68041910b3d0cbcf7e08cc7d7c1a1cb09e6b69\n\n\nbdff852398...\nContained_Within\n6ee19085ad5c17f989616d17ef68041910b3d0cbcf7e08cc7d7c1a1cb09e6b69\n\n\nd404c0a634...\nDownloaded_From\ncelasllc.com\n\n\nd404c0a634...\nContains\nc0c2239138b9bc659b5bddd8f49fa3f3074b65df8f3a2f639f7c632d2306af70\n\n\nd404c0a634...\nContains\n5e54bccbd4d93447e79cda0558b0b308a186c2be571c739e5460a3cb6ef665c0\n\n\nc0c2239138...\nContained_Within\nd404c0a634cef0d32029286fde8efccb6dfe1809066bbec7ac32d42c5ce3bc04\n\n\n5e54bccbd4...\nContained_Within\nd404c0a634cef0d32029286fde8efccb6dfe1809066bbec7ac32d42c5ce3bc04\n\n\n\n\nConclusion\n\nAfter a cyber-security organization published a report detailing the above programs and their malicious extras, the Celas LLC site was no longer accessible. As this site was the command and control server (C2), the payload cannot be confirmed. The cyber security organization who published the AppleJeus report states the payload was an encrypted and obfuscated binary which eventually drops FALLCHILL onto the machine and installs it as a service.\n\n\t\t\tThe FALLCHILL sample found by the cyber security organization had two default C2 server addresses:\n\t\t\t196.38.48.121 \u2013 South Africa Internet Solutions, AS3741\n\t\t\t185.142.236.226 \u2013 Netherlands Amsterdam Blackhost Ltd ISP, AS174 Cogent Communications\n\n\t\t\tThe C2 185.142.236.226 resides in the same Autonomous System Number (ASN) and ISP as the celasllc.com domain. Furthermore, these IP addresses have been used in three earlier versions of FALLCHILL for C2 according to open source reporting:\n\n\t\t\t--Begin MD5 and timestamp--\n\t\t\t94dfcabd8ba5ca94828cd5a88d6ed488 \u00a0\u00a0\u00a0 2016-10-24 02:31:18\n\t\t\t14b6d24873f19332701177208f85e776 \u00a0\u00a0\u00a0 2017-06-07 06:41:27\n\t\t\tabec84286df80704b823e698199d89f7 \u00a0\u00a0\u00a0 2017-01-18 04:29:29\n\t\t\t--End MD5 and timestamp--\n\n\t\t\tFile Properties for this sample of FALLCHILL after decryption:\n\t\t\tMD5: d7089e6bc8bd137a7241a7ad297f975d\n\t\t\tSHA-1: 15062b26d9dd1cf7b0cdf167f4b37cb632ddbd41\n\t\t\tSHA-256: 08012e68f4f84bba8b74690c379cb0b1431cdcadc9ed076ff068de289e0f6774\n\n\t\t\tFALLCHILL malware uses a RC4 encryption algorithm with a 16-byte key to protect its communications. According to reporting from the cyber-security organization that published the original AppleJeus report, the key extracted from the FALLCHILL variant used in the Celas Trade Pro application is \u201cDA E1 61 FF 0C 27 95 87 17 57 A4 D6 EA E3 82 2B.\" This RC4 key has also been used in a previous version of FALLCHILL used by DPRK actors, as further documented in the US-CERT Malware Analysis Report AR18-165A released on June 14, 2018. This report was a joint effort by the FBI and DHS, while working with other U.S. Government partners, to analyze and attribute computer intrusion activity from the DPRK.\n\n\t\t\tNote: The version numbers for AppleJeus correspond to the order the campaigns were identified open source or through investigative means. These versions may or may not be in the correct order for development or deployment of the AppleJeus campaigns.\n\nRecommendations\n\nCISA recommends that users and administrators consider using the following best practices to strengthen the security posture of their organization's systems. Any configuration changes should be reviewed by system owners and administrators prior to implementation to avoid unwanted impacts.\n\nMaintain up-to-date antivirus signatures and engines.\nKeep operating system patches up-to-date.\nDisable File and Printer sharing services. If these services are required, use strong passwords or Active Directory authentication.\nRestrict users' ability (permissions) to install and run unwanted software applications. Do not add users to the local administrators group unless required.\nEnforce a strong password policy and implement regular password changes.\nExercise caution when opening e-mail attachments even if the attachment is expected and the sender appears to be known.\nEnable a personal firewall on agency workstations, configured to deny unsolicited connection requests.\nDisable unnecessary services on agency workstations and servers.\nScan for and remove suspicious e-mail attachments; ensure the scanned attachment is its \"true file type\" (i.e., the extension matches the file header).\nMonitor users' web browsing habits; restrict access to sites with unfavorable content.\nExercise caution when using removable media (e.g., USB thumb drives, external drives, CDs, etc.).\nScan all software downloaded from the Internet prior to executing.\nMaintain situational awareness of the latest threats and implement appropriate Access Control Lists (ACLs).\n\nAdditional information on malware incident prevention and handling can be found in National Institute of Standards and Technology (NIST) Special Publication 800-83, \"Guide to Malware Incident Prevention & Handling for Desktops and Laptops\".\n\nContact Information\n\n\n1-888-282-0870\nCISA Central\u00a0(UNCLASS)\nCISA SIPR (SIPRNET)\nCISA IC (JWICS)\n\nCISA continuously strives to improve its products and services. You can help by answering a very short series of questions about this product at the following URL: https://us-cert.cisa.gov/forms/feedback/\n\nDocument FAQ\n\nWhat is a MIFR? A Malware Initial Findings Report (MIFR) is intended to provide organizations with malware analysis in a timely manner. In most instances this report will provide initial indicators for computer and network defense. To request additional analysis, please contact CISA and provide information regarding the level of desired analysis.\nWhat is a MAR? A Malware Analysis Report (MAR) is intended to provide organizations with more detailed malware analysis acquired via manual reverse engineering. To request additional analysis, please contact CISA and provide information regarding the level of desired analysis.\nCan I edit this document? This document is not to be edited in any way by recipients. All comments or questions related to this document should be directed to the CISA at 1-888-282-0870 or CISA Central.\nCan I submit malware to CISA? Malware samples can be submitted via three methods:\n\nWeb: https://malware.us-cert.gov\nE-Mail: submit@malware.us-cert.gov\nFTP: ftp.malware.us-cert.gov (anonymous)\n\nCISA encourages you to report any suspicious activity, including cybersecurity incidents, possible malicious code, software vulnerabilities, and phishing-related scams. Reporting forms can be found on CISA's homepage at www.cisa.gov.\n\n\n\n\n\n\n\n\nRevisions\n\nFebruary 17, 2021: Initial Version\n",
  "cves": [
    "CVE-2022-47966",
    "CVE-2022-42475"
  ],
  "techniques": [],
  "advisory": "ar21-048a",
  "title": "MAR-10322463-1.v1 - AppleJeus: Celas Trade Pro | CISA",
  "source": "analysis-reports",
  "id": "a686bc3ee919e594db7a09d4ac89da9353ffc88a4ebb07496c38e467c540d359"
}