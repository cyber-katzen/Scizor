{
  "markdown": " Innominate MGuard Weak HTTPS and SSH Keys \\| CISA A A ( Lock ) or[\\#protect2024](/protect2024)  Search Menu Close[Faith\\-Based Community](/audiences/faith-based-community) [High\\-Risk Communities](/audiences/high-risk-communities)* Resources \\& Tools[Resources \\& Tools](/resources-tools) [All Resources \\& Tools](/resources-tools/all-resources-tools)* News \\& Events[News \\& Events](/news-events) [Cybersecurity Alerts \\& Advisories](/news-events/cybersecurity-advisories)[Benefits \\& Perks](/careers/benefits-perks)[Resume \\& Application Tips](/careers/resume-application-tips)[Students \\& Recent Graduates](/students-recent-graduates-employment-opportunities)[Divisions \\& Offices](/about/divisions-offices)[\\#protect2024](/protect2024) 2. [News \\& Events](/news-events) ICS AdvisoryInnominate MGuard Weak HTTPS and SSH Keys========================================= Last Revised September 06, 2018 Alert Code ICSA\\-12\\-167\\-01Overview-------- An independent research group comprised of Nadia Heninger, Zakir Durumeric, Eric Wustrow, and J. Alex Halderman identified an insufficient entropy vulnerability in Innominate\u2019s mGuard network appliance product line. By impersonating the device, an attacker can obtain the credentials of administrative users and potentially perform a Man\\-in\\-the\\-Middle (MitM) attack. Innominate has validated the vulnerability and produced an update that resolves the reported vulnerability. This vulnerability can be remotely exploited. ICS\\-CERT has coordinated this vulnerability with Innominate, which has produced an update that resolves this vulnerability.Affected Products----------------- All versions of the following Innominate products are affected:* mGuard Smart\u2014HW\\-101020, HW\\-101050, BD\\-101010, BD\\-101020,* mGuard PCI\u2014HW\\-102020, HW\\-102050, BD\\-111010, BD\\-111020,* mGuard Industrial RS\u2014HW\\-105000, BD\\-501000, BD\\-501010, BD\\-501020,* mGuard Blade\u2014HW\\-104020, HW\\-104050,* mGuard Delta\u2014HW\\-103050, BD\\-201000,* EAGLE mGuard\u2014HW\\-201000, BD\\-301010,* All products manufactured prior to 2006\\.Impact------ This vulnerability can weaken the security posture of any industrial network in which these products are deployed. Impact to individual organizations depends on many factors that are unique to each organization. ICS\\-CERT recommends that organizations evaluate the impact of this vulnerability based on their operational environment, architecture, and product implementation.Background---------- Innominate is a company based in Berlin, Germany, founded in 2001\\. Innominate\u2019s mGuard product line includes firewall and VPN network security appliances. Innominate\u2019s products are deployed in many sectors including manufacturing, electric power generation, water, transportation, healthcare, communications, and satellite operations. Innominate reports that the mGuard products are used many countries worldwide.Vulnerability Characterization------------------------------### Vulnerability Overview The mGuard products do not use sufficient entropy when generating keys for HTTPS and SSH, therefore making them too weak. By calculating private keys, an attacker could perform a MitM attack on the system. This could allow the attacker to execute arbitrary code or gain unauthorized access to the system. Keys that are loaded as part of the mGuard configuration (i.e., VPN) are not affected.### Vulnerability Details#### Exploitability An attacker can predict the user\u2019s session ID and potentially hijack the session. This vulnerability could be exploited remotely by a MitM type attack. An attacker that has obtained unauthorized access could inject malicious code or change system settings. The attacker must first successfully guess or calculate the private key of the mGuard device and have physical access to the network path between the device and a legitimate administrator or have the ability to deviate legitimate device traffic to the attacker\u2019s system using techniques such as ARP spoofing.#### Existence of Exploit No known exploits specifically target this vulnerability.#### Difficulty An attacker with a high skill level would be able to exploit this vulnerability.Mitigation---------- Software Version 7\\.5\\.0 or later properly uses existing entropy before generating HTTPS and SSH keys. It also increases the size of the RSA keys from 1,024 bits to 2,048 bits. The software update can be found at Innominate download website.e Innominate recommends changing passwords after new keys are generated. Innominate recommends one of the three following mitigation procedures:1. Use the Rescue Procedure to install the software Version 7\\.5\\.0\\. New keys will be generated as part of this process.2. Use the update mechanism to update the devices to Version 7\\.5\\.0\\. a. Install the update. Existing keys will be kept. b. After the update, the existing keys must be replaced by using one of the following methods: i. Web User Interface 1\\) Login as root or admin user. 2\\) Press the \u201cGenerate new 2048 bit keys\u201d button either in the \u201cWeb Settings \\-\\> Access\u201d or in the \u201cSystem Settings \\-\\> Shell Access\u201d menu. 3\\) Note the fingerprint output of the newly generated keys. 4\\) Login via HTTPS and compare the certificate information provided by the browser. ii. Console 1\\) Login via the serial console or SSH as root or admin user. 2\\) Call the program: $ rsa\\_renewal update. 3\\) Note the fingerprint output of the newly generated keys. 4\\) Login via SSH and compare the fingerprints shown by the SSH. 3\\. Upload and execute a shell script via SSH as root, provided by Innominate. The script will generate new 2,048 bit keys without requiring an update to software Version 7\\.5\\.0\\. a. The script can be downloaded from Innominate at http://www.innominate.com/en/downloads/software\\-and\\-misc. b. Use scp to copy the script onto the mGuard like (but appropriate for the user\u2019s setup): $ scp generate\\_2048key.sh root@192\\.168\\.1\\.1:/root/. c. Login via SSH as root user. d. Execute the script: $ sh /root/generate\\_2048key.sh. e. Note the fingerprint output of the newly generated keys. f. Login via SSH and compare the fingerprints shown by SSH. ICS\\-CERT encourages asset owners to take additional defensive measures to protect against this and other cybersecurity risks.* Minimize network exposure for all control system devices. Critical devices should not directly face the Internet.* Locate control system networks and remote devices behind firewalls, and isolate them from the business network.* When remote access is required, use secure methods, such as Virtual Private Networks (VPNs), recognizing that VPN is only as secure as the connected devices. The Control Systems Security Program (CSSP) also provides [a section for control systems security recommended practices](/ics/recommended-practices)  on the CSSP web page. Several recommended practices are available for reading and download, including [Improving Industrial Control Systems Cybersecurity with Defense\\-in\\-Depth Strategies](/sites/default/files/recommended_practices/NCCIC_ICS-CERT_Defense_in_Depth_2016_S508C.pdf)  . ICS\\-CERT reminds organizations to perform proper impact analysis and risk assessment prior to taking defensive measures. Organizations observing any suspected malicious activity should follow their established internal procedures and report their findings to ICS\\-CERT for tracking and correlation against other incidents. This product is provided subject to this [Notification](/notification \"Follow link\")  and this [Privacy \\& Use](/privacy-policy \"Follow link\")  policy.Vendor------* Innominate-------------------------- [product survey](https://www.surveymonkey.com/r/CISA-cyber-survey?product=https://www.cisa.gov/news-events/ics-advisories/icsa-12-167-01)  ; Related Advisories------------------ Jul 18, 2024 ICS Advisory \\| ICSA\\-24\\-200\\-01### [Mitsubishi Electric MELSOFT MaiLab](/news-events/ics-advisories/icsa-24-200-01) Jul 18, 2024 ICS Advisory \\| ICSA\\-24\\-200\\-02### [Subnet Solutions PowerSYSTEM Center](/news-events/ics-advisories/icsa-24-200-02) Jul 16, 2024 ICS Advisory \\| ICSA\\-24\\-198\\-01### [Rockwell Automation Pavilion 8](/news-events/ics-advisories/icsa-24-198-01) Jul 11, 2024 ICS Advisory \\| ICSA\\-24\\-193\\-01### [Siemens Remote Connect Server](/news-events/ics-advisories/icsa-24-193-01)* [Resources \\& Tools](/resources-tools)* [News \\& Events](/news-events)[Cybersecurity \\& Infrastructure Security Agency](/ \"Go to the Cybersecurity & Infrastructure Security Agency homepage\")[1\\-844\\-Say\\-CISA](tel:1-844-Say-CISA) * [Equal Opportunity \\& Accessibility](/oedia \"Equal Opportunity & Accessibility\")",
  "cves": [],
  "techniques": [],
  "advisory": "icsa-12-167-01",
  "title": "Innominate MGuard Weak HTTPS and SSH Keys | CISA",
  "source": "ics-advisories",
  "id": "a125d7e829bd0c9d7f7719dea4f696a595b60e5745f482d1148f059cf97df259"
}