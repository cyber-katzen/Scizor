{
  "markdown": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Innominate MGuard Weak HTTPS and SSH Keys \\| CISA\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[Skip to main content](#main) \n\n\n\n\n\n\n\n\n\n\n\n\n![U.S. flag](/profiles/cisad8_gov/themes/custom/gesso/dist/images/us_flag_small.png)\n\n\n\n An official website of the United States government\n \n\n\n\n Here\u2019s how you know\n \n\n\n\n\n\n Here\u2019s how you know\n \n\n\n\n\n\n\n![Dot gov](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-dot-gov.svg)\n\n\n**Official websites use .gov** \n  \n\n A\n **.gov** \n website belongs to an official government organization in the United States.\n \n\n\n\n\n\n![HTTPS](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-https.svg)\n\n\n**Secure .gov websites use HTTPS** \n  \n\n A\n **lock** \n (\n \n\n\n Lock\n \n\n A locked padlock\n \n\n\n\n\n ) or\n **https://** \n means you\u2019ve safely connected to the .gov website. Share sensitive information only on official, secure websites.\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools \"Free Cyber Services\") \n[\\#protect2024](/protect2024) \n[Secure Our World](/node/18883) \n[Shields Up](/node/8056) \n[Report A Cyber Issue](/node/16591) \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[![CISA Logo Americas Cyber Defense Agency](/sites/default/files/images/SVG/header_logo_tagline_update.svg)](/)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[![CISA Logo](/sites/default/files/images/SVG/mobile_logo_wordmark.svg)](/)\n\n\n\n\n\n\n\n\n\n\n Search\n \n\n\n\n\n\n\n\n\n\n Menu\n \n\n\n\n\n\n\n\n\n\n\n\n\n![America's Cyber Defense Agency](/sites/default/files/images/SVG/header_tagline_mobile_update.svg)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Close\n \n\n\n\n\n* Topics\n \n\n\n\n[Topics](/topics) \n\n\n\n\n[Cybersecurity Best Practices](/topics/cybersecurity-best-practices)\n\n\n\n\n[Cyber Threats and Advisories](/topics/cyber-threats-and-advisories)\n\n\n\n\n[Critical Infrastructure Security and Resilience](/topics/critical-infrastructure-security-and-resilience)\n\n\n\n\n[Election Security](/topics/election-security)\n\n\n\n\n[Emergency Communications](/topics/emergency-communications)\n\n\n\n\n[Industrial Control Systems](/topics/industrial-control-systems)\n\n\n\n\n[Information and Communications Technology Supply Chain Security](/topics/information-communications-technology-supply-chain-security)\n\n\n\n\n[Partnerships and Collaboration](/topics/partnerships-and-collaboration)\n\n\n\n\n[Physical Security](/topics/physical-security)\n\n\n\n\n[Risk Management](/topics/risk-management)\n\n\n\n\n\n[How can we help?](/audiences) \n\n\n[Government](/topics/government) \n[Educational Institutions](/topics/educational-institutions) \n[Industry](/topics/industry) \n[State, Local, Tribal, and Territorial](/topics/state-local-tribal-and-territorial) \n[Individuals and Families](/topics/individuals-and-families) \n[Small and Medium Businesses](/topics/small-and-medium-businesses) \n[Find Help Locally](/audiences/find-help-locally) \n[Faith\\-Based Community](/audiences/faith-based-community) \n[Executives](/audiences/executives) \n[High\\-Risk Communities](/audiences/high-risk-communities)\n* [Spotlight](/spotlight)\n* Resources \\& Tools\n \n\n\n\n[Resources \\& Tools](/resources-tools) \n\n\n\n\n[All Resources \\& Tools](/resources-tools/all-resources-tools)\n\n\n\n\n[Services](/resources-tools/services)\n\n\n\n\n[Programs](/resources-tools/programs)\n\n\n\n\n[Resources](/resources-tools/resources)\n\n\n\n\n[Training](/resources-tools/training)\n\n\n\n\n[Groups](/resources-tools/groups)\n* News \\& Events\n \n\n\n\n[News \\& Events](/news-events) \n\n\n\n\n[News](/news-events/news)\n\n\n\n\n[Events](/news-events/events)\n\n\n\n\n[Cybersecurity Alerts \\& Advisories](/news-events/cybersecurity-advisories)\n\n\n\n\n[Directives](/news-events/directives)\n\n\n\n\n[Request a CISA Speaker](/news-events/request-speaker)\n\n\n\n\n[Congressional Testimony](/news-events/congressional-testimony)\n\n\n\n\n[CISA Conferences](/cisa-conferences)\n\n\n\n\n[CISA Live!](/cisa-live)\n* Careers\n \n\n\n\n[Careers](/careers) \n\n\n\n\n[Benefits \\& Perks](/careers/benefits-perks)\n\n\n\n\n[HireVue Applicant Reasonable Accommodations Process](/careers/hirevue-applicant-reasonable-accommodations-process)\n\n\n\n\n[Hiring](/general-recruitment-and-hiring-faqs)\n\n\n\n\n[Resume \\& Application Tips](/careers/resume-application-tips)\n\n\n\n\n[Students \\& Recent Graduates](/students-recent-graduates-employment-opportunities)\n\n\n\n\n[Veteran and Military Spouses](/careers/veteran-and-military-spouse-employment-opportunities)\n\n\n\n\n[Work @ CISA](/careers/work-cisa)\n* About\n \n\n\n\n[About](/about) \n\n\n\n\n[Culture](/about/culture)\n\n\n\n\n[Divisions \\& Offices](/about/divisions-offices)\n\n\n\n\n[Regions](/about/regions)\n\n\n\n\n[Leadership](/about/leadership)\n\n\n\n\n[Doing Business with CISA](/doing-business-cisa)\n\n\n\n\n[Site Links](/site-links)\n\n\n\n\n[Reporting Employee and Contractor Misconduct](/reporting-employee-and-contractor-misconduct)\n\n\n\n\n[CISA GitHub](/cisa-github)\n\n\n\n\n[CISA Central](/cisa-central)\n\n\n\n\n[2023 Year In Review](/about/2023YIR)\n\n\n\n\n[Contact Us](/about/contact-us)\n\n\n\n\n\n\n\n\n\n[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools \"Free Cyber Services\") \n[\\#protect2024](/protect2024) \n[Secure Our World](/node/18883) \n[Shields Up](/node/8056) \n[Report A Cyber Issue](/node/16591) \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Breadcrumb\n \n1. [Home](/)\n2. [News \\& Events](/news-events)\n3. [Cybersecurity Advisories](/news-events/cybersecurity-advisories)\n4. [ICS Advisory](/news-events/cybersecurity-advisories?f%5B0%5D=advisory_type%3A95)\n\n\n\n\n\n\n\n\n Share:\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n ICS Advisory\n \nInnominate MGuard Weak HTTPS and SSH Keys\n=========================================\n\n\n\n\n\n Last Revised\n \n\n\n September 06, 2018\n \n\n\n\n\n Alert Code\n \n\n ICSA\\-12\\-167\\-01\n \n\n\n\n\n\n\n\n\n\n\n\n\n\nOverview\n--------\n\n\n\n An independent research group comprised of Nadia Heninger, Zakir Durumeric, Eric Wustrow, and J. Alex Halderman identified an insufficient entropy vulnerability in Innominate\u2019s mGuard network appliance product line. By impersonating the device, an attacker can obtain the credentials of administrative users and potentially perform a Man\\-in\\-the\\-Middle (MitM) attack. Innominate has validated the vulnerability and produced an update that resolves the reported vulnerability. This vulnerability can be remotely exploited.\n   \n\n  \n\n ICS\\-CERT has coordinated this vulnerability with Innominate, which has produced an update that resolves this vulnerability.\n \n\n\nAffected Products\n-----------------\n\n\n\n All versions of the following Innominate products are affected:\n \n\n\n* mGuard Smart\u2014HW\\-101020, HW\\-101050, BD\\-101010, BD\\-101020,\n* mGuard PCI\u2014HW\\-102020, HW\\-102050, BD\\-111010, BD\\-111020,\n* mGuard Industrial RS\u2014HW\\-105000, BD\\-501000, BD\\-501010, BD\\-501020,\n* mGuard Blade\u2014HW\\-104020, HW\\-104050,\n* mGuard Delta\u2014HW\\-103050, BD\\-201000,\n* EAGLE mGuard\u2014HW\\-201000, BD\\-301010,\n* All products manufactured prior to 2006\\.\n\n\nImpact\n------\n\n\n\n This vulnerability can weaken the security posture of any industrial network in which these products are deployed.\n   \n\n  \n\n Impact to individual organizations depends on many factors that are unique to each organization. ICS\\-CERT recommends that organizations evaluate the impact of this vulnerability based on their operational environment, architecture, and product implementation.\n \n\n\nBackground\n----------\n\n\n\n Innominate is a company based in Berlin, Germany, founded in 2001\\. Innominate\u2019s mGuard product line includes firewall and VPN network security appliances. Innominate\u2019s products are deployed in many sectors including manufacturing, electric power generation, water, transportation, healthcare, communications, and satellite operations. Innominate reports that the mGuard products are used many countries worldwide.\n \n\n\nVulnerability Characterization\n------------------------------\n\n\n### Vulnerability Overview\n\n\n\n The mGuard products do not use sufficient entropy when generating keys for HTTPS and SSH, therefore making them too weak. By calculating private keys, an attacker could perform a MitM attack on the system. This could allow the attacker to execute arbitrary code or gain unauthorized access to the system. Keys that are loaded as part of the mGuard configuration (i.e., VPN) are not affected.\n \n\n\n### Vulnerability Details\n\n\n#### Exploitability\n\n\n\n An attacker can predict the user\u2019s session ID and potentially hijack the session. This vulnerability could be exploited remotely by a MitM type attack. An attacker that has obtained unauthorized access could inject malicious code or change system settings.\n   \n\n  \n\n The attacker must first successfully guess or calculate the private key of the mGuard device and have physical access to the network path between the device and a legitimate administrator or have the ability to deviate legitimate device traffic to the attacker\u2019s system using techniques such as ARP spoofing.\n \n\n\n#### Existence of Exploit\n\n\n\n No known exploits specifically target this vulnerability.\n \n\n\n#### Difficulty\n\n\n\n An attacker with a high skill level would be able to exploit this vulnerability.\n \n\n\nMitigation\n----------\n\n\n\n Software Version 7\\.5\\.0 or later properly uses existing entropy before generating HTTPS and SSH keys. It also increases the size of the RSA keys from 1,024 bits to 2,048 bits. The software update can be found at Innominate download website.e Innominate recommends changing passwords after new keys are generated.\n \n\n\n\n Innominate recommends one of the three following mitigation procedures:\n \n\n\n1. Use the Rescue Procedure to install the software Version 7\\.5\\.0\\. New keys will be generated as part of this process.\n2. Use the update mechanism to update the devices to Version 7\\.5\\.0\\.\n\n\n\n a. Install the update. Existing keys will be kept.\n   \n\n b. After the update, the existing keys must be replaced by using one of the following methods:\n \n\n\n\n i. Web User Interface\n \n\n\n\n 1\\) Login as root or admin user.\n   \n\n 2\\) Press the \u201cGenerate new 2048 bit keys\u201d button either in the \u201cWeb Settings \\-\\> Access\u201d or in the \u201cSystem Settings \\-\\> Shell Access\u201d menu.\n   \n\n 3\\) Note the fingerprint output of the newly generated keys.\n   \n\n 4\\) Login via HTTPS and compare the certificate information provided by the browser.\n \n\n\n\n ii. Console\n \n\n\n\n 1\\) Login via the serial console or SSH as root or admin user.\n   \n\n 2\\) Call the program: $ rsa\\_renewal update.\n   \n\n 3\\) Note the fingerprint output of the newly generated keys.\n   \n\n 4\\) Login via SSH and compare the fingerprints shown by the SSH.\n \n\n\n\n 3\\. Upload and execute a shell script via SSH as root, provided by Innominate. The script will generate new 2,048 bit keys without requiring an update to software Version 7\\.5\\.0\\.\n \n\n\n\n a. The script can be downloaded from Innominate at http://www.innominate.com/en/downloads/software\\-and\\-misc.\n   \n\n b. Use scp to copy the script onto the mGuard like (but appropriate for the user\u2019s setup): $ scp generate\\_2048key.sh root@192\\.168\\.1\\.1:/root/.\n   \n\n c. Login via SSH as root user.\n   \n\n d. Execute the script: $ sh /root/generate\\_2048key.sh.\n   \n\n e. Note the fingerprint output of the newly generated keys.\n   \n\n f. Login via SSH and compare the fingerprints shown by SSH.\\\\\n \n\n\n\n ICS\\-CERT encourages asset owners to take additional defensive measures to protect against this and other cybersecurity risks.\n \n\n\n* Minimize network exposure for all control system devices. Critical devices should not directly face the Internet.\n* Locate control system networks and remote devices behind firewalls, and isolate them from the business network.\n* When remote access is required, use secure methods, such as Virtual Private Networks (VPNs), recognizing that VPN is only as secure as the connected devices.\n\n\n\n The Control Systems Security Program (CSSP) also provides\n [a section for control systems security recommended practices](/ics/recommended-practices) \n on the CSSP web page. Several recommended practices are available for reading and download, including\n [Improving Industrial Control Systems Cybersecurity with Defense\\-in\\-Depth Strategies](/sites/default/files/recommended_practices/NCCIC_ICS-CERT_Defense_in_Depth_2016_S508C.pdf) \n . ICS\\-CERT reminds organizations to perform proper impact analysis and risk assessment prior to taking defensive measures.\n \n\n\n\n Organizations observing any suspected malicious activity should follow their established internal procedures and report their findings to ICS\\-CERT for tracking and correlation against other incidents.\n \n\n\n\n\n\n\n\n\n\n\n This product is provided subject to this\n [Notification](/notification \"Follow link\") \n and this\n [Privacy \\& Use](/privacy-policy \"Follow link\") \n policy.\n \n\n\n\n\n\n\n\n\nVendor\n------\n\n\n\n* Innominate\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPlease share your thoughts\n--------------------------\n\n\n\n We recently updated our anonymous\n [product survey](https://www.surveymonkey.com/r/CISA-cyber-survey?product=https://www.cisa.gov/news-events/ics-advisories/icsa-12-167-01) \n ; we\u2019d welcome your feedback.\n \n\n\n\n\n\n\n\n\n\n\n\n\nRelated Advisories\n------------------\n\n\n\n\n\n\n\n\n\n\n Jul 18, 2024\n \n\n\n ICS Advisory \\| ICSA\\-24\\-200\\-01\n \n\n### [Mitsubishi Electric MELSOFT MaiLab](/news-events/ics-advisories/icsa-24-200-01)\n\n\n\n\n\n\n\n\n\n\n\n Jul 18, 2024\n \n\n\n ICS Advisory \\| ICSA\\-24\\-200\\-02\n \n\n### [Subnet Solutions PowerSYSTEM Center](/news-events/ics-advisories/icsa-24-200-02)\n\n\n\n\n\n\n\n\n\n\n\n Jul 16, 2024\n \n\n\n ICS Advisory \\| ICSA\\-24\\-198\\-01\n \n\n### [Rockwell Automation Pavilion 8](/news-events/ics-advisories/icsa-24-198-01)\n\n\n\n\n\n\n\n\n\n\n\n Jul 11, 2024\n \n\n\n ICS Advisory \\| ICSA\\-24\\-193\\-01\n \n\n### [Siemens Remote Connect Server](/news-events/ics-advisories/icsa-24-193-01)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[Return to top](#) \n\n\n\n\n* [Topics](/topics)\n* [Spotlight](/spotlight)\n* [Resources \\& Tools](/resources-tools)\n* [News \\& Events](/news-events)\n* [Careers](/careers)\n* [About](/about)\n\n\n\n\n\n\n\n\n[Cybersecurity \\& Infrastructure Security Agency](/ \"Go to the Cybersecurity & Infrastructure Security Agency homepage\")\n\n\n* [Facebook](https://www.facebook.com/CISA)\n* [Twitter](https://twitter.com/CISAgov)\n* [LinkedIn](https://www.linkedin.com/company/cybersecurity-and-infrastructure-security-agency)\n* [YouTube](https://www.youtube.com/@cisagov)\n* [Instagram](https://www.instagram.com/cisagov)\n* [RSS](/subscribe-updates-cisa)\n\n\n\n\n CISA Central\n \n[1\\-844\\-Say\\-CISA](tel:1-844-Say-CISA) \n[SayCISA@cisa.gov](mailto:SayCISA@cisa.gov) \n\n\n\n\n\n\n\n\n\n\n\n DHS Seal\n \n\n\n CISA.gov\n \n\n An official website of the U.S. Department of Homeland Security\n \n\n\n* [About CISA](/about \"About CISA\")\n* [Budget and Performance](https://www.dhs.gov/performance-financial-reports \"Budget and Performance\")\n* [DHS.gov](https://www.dhs.gov \"Department of Homeland Security\")\n* [Equal Opportunity \\& Accessibility](/oedia \"Equal Opportunity & Accessibility\")\n* [FOIA Requests](https://www.dhs.gov/foia \"FOIA Requests\")\n* [No FEAR Act](/no-fear-act \"No FEAR Act Reporting\")\n* [Office of Inspector General](https://www.oig.dhs.gov/ \"Office of Inspector General\")\n* [Privacy Policy](/privacy-policy \"Privacy Policy\")\n* [Subscribe](https://public.govdelivery.com/accounts/USDHSCISA/subscriber/new?topic_id=USDHSCISA_138 \"Subscribe to Email Updates\")\n* [The White House](https://www.whitehouse.gov/ \"The White House\")\n* [USA.gov](https://www.usa.gov/ \"USA.gov\")\n* [Website Feedback](/forms/feedback \"Website Feedback\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
  "cves": [],
  "techniques": [],
  "advisory": "icsa-12-167-01",
  "title": "Innominate MGuard Weak HTTPS and SSH Keys | CISA",
  "source": "ics-advisories",
  "id": "a125d7e829bd0c9d7f7719dea4f696a595b60e5745f482d1148f059cf97df259"
}