{
  "markdown": "\nOVERVIEW\nOSIsoft has identified and reported to NCCIC/ICS-CERT a default permissions vulnerability in PI AF product. OSIsoft has produced a mitigation plan to remove this vulnerability. This vulnerability could be exploited remotely.\nAFFECTED PRODUCTS\nOSIsoft reports that the vulnerability affects the following products:\n\nPI AF 2.6 new installs,\nPI AF 2.7 upgrade, and\nPI SQL for AF 2.1.\n\nIMPACT\nUnder certain conditions, SQL statements can be executed that result in data tampering, information disclosure, repudiation, elevation of privilege, and denial of service.\nImpact to individual organizations depends on many factors that are unique to each organization. ICS-CERT recommends that organizations evaluate the impact of this vulnerability based on their operational environment, architecture, and product implementation.\nBACKGROUND\nOSIsoft is a US-based company that maintains its headquarters in San Leandro, California, with operations globally.\u00a0\nThe affected product, PI AF, allows definition of organizational assets and/or equipment. PI AF uses Microsoft SQL Server database. According to OSIsoft, PI AF is deployed in several critical infrastructure sectors. OSIsoft estimates that these products are used worldwide.\nVULNERABILITY CHARACTERIZATION\nVULNERABILITY OVERVIEW\n\nINCORRECT DEFAULT PERMISSIONSCWE-276: Incorrect Default Permissions, http://cwe.mitre.org/data/definitions/276.html, web site last accessed May 12, 2015.\n\nSome product installations insert the \u201cEveryone\u201d account in the \u201cPI SQL (AF) Trusted Users\u201d group on the PI AF Server. Users in the \u201cPI SQL (AF) Trusted Users\u201d group can bypass most of the security checks that would normally be applied to various types of SQL statements, and can execute commands on the PI AF SQL Database without authorization.\nCVE-2015-1013NVD, http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2015-1013, NIST uses this advisory to create the CVE web site report. This web site will be active sometime after publication of this advisory. has been assigned to this vulnerability. OSIsoft has calculated a CVSS v2 base score of 6.5; the CVSS vector string is (AV:N/AC:L/Au:S/C:P/I:P/A:P).CVSS Calculator, http://nvd.nist.gov/cvss.cfm?version=2&vector=AV:N/AC:L/Au:S/C:P/I:P/A:P, web site last accessed May 12, 2015.\nVULNERABILITY DETAILS\nEXPLOITABILITY\nThis vulnerability could be exploited remotely.\nEXISTENCE OF EXPLOIT\nNo known public exploits specifically target this vulnerability.\nDIFFICULTY\nAn attacker with a low skill would be able to exploit this vulnerability.\nMITIGATION\nOSIsoft recommends the following mitigation actions, depending on the version of PI WebParts installed, to remove this vulnerability:\nIf a system with\u00a0PI WebParts is installed, the recommended action depends on the version:\n\nPI WebParts 2013 or later\n\n\nRemove the group \u201cPI SQL (AF) Trusted Users\u201d\u00a0\u00a0(if it exists) from the AF server.\nNo further action is required.\n\n\nPI WebParts 2010 (or 2010 R2) \u2013 pick one of the two following options:\n\n\nUpgrade to PI WebParts 2013 or later and follow the steps above, or\nFollow the mitigation steps below.\n\n\nRemove the \u201cEveryone\u201d user from the \u201cPI SQL (AF) Trusted Users\u201d\u00a0group on the AF server.\nIf the SharePoint application pool hosting PI WebParts runs as a domain service account, add that service account to the Windows group.\nIf the SharePoint application pool hosting PI WebParts runs as the built in \u201cNetwork Services\u201d identity, add the PI WebParts web server\u2019s machine account to the Windows group. After these configuration changes are made, an IISRESET must be performed on the PI WebParts web server. If the PI WebParts web server and the AF Server are on the same machine, the built-in \u201cNetwork Services\u201d identity must be added, and the machine must be restarted.\n\n\nIf\u00a0PI WebParts is NOT installed:\n\n\nRemove the group \u201cPI SQL (AF) Trusted Users\u201d (if it exists) from the AF server.\u00a0\n\nFor more information regarding this vulnerability and the recommended mitigation plan, please see OSIsoft\u2019s security bulletin titled \u201cAL00280 - Security Bulletin Vulnerability in PI SQL (AF) Trusted Users group could allow bypassing of security\u201d at the following location:\u00a0\nhttps://techsupport.osisoft.com/Troubleshooting/Alerts/AL00280\nUsers may also visit the OSIsoft technical support web site: https://techsupport.osisoft.com/\nICS-CERT recommends that users take defensive measures to minimize the risk of exploitation of these vulnerabilities. Specifically, users should:\n\nMinimize network exposure for all control system devices and/or systems, and ensure that they are not accessible from the Internet.\nLocate control system networks and remote devices behind firewalls, and isolate them from the business network.\nWhen remote access is required, use secure methods, such as Virtual Private Networks (VPNs), recognizing that VPNs may have vulnerabilities and should be updated to the most current version available. Also recognize that VPN is only as secure as the connected devices.\n\nICS-CERT reminds organizations to perform proper impact analysis and risk assessment prior to deploying defensive measures.\nICS-CERT also provides a section for control systems security recommended practices on the ICS-CERT web page at:\u00a0http://ics-cert.us-cert.gov/content/recommended-practices. Several recommended practices are available for reading and download, including Improving Industrial Control Systems Cybersecurity with Defense-in-Depth Strategies.\nAdditional mitigation guidance and recommended practices are publicly available in the ICS\u2011CERT Technical Information Paper, ICS-TIP-12-146-01B--Targeted Cyber Intrusion Detection and Mitigation Strategies, that is available for download from the ICS-CERT web site (http://ics-cert.us-cert.gov/).\nOrganizations observing any suspected malicious activity should follow their established internal procedures and report their findings to ICS-CERT for tracking and correlation against other incidents.\n",
  "cves": [
    "CVE-2015-1013"
  ],
  "techniques": [],
  "advisory": "icsa-15-132-01",
  "title": "OSIsoft PI AF Incorrect Default Permissions Vulnerability | CISA",
  "source": "ics-advisories",
  "id": "10f65d0d59f65114ab10dda13a1b7946e9a0f7a5e09dcced884adf46c32d59c3"
}