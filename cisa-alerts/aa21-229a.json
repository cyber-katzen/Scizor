{
  "markdown": " BadAlloc Vulnerability Affecting BlackBerry QNX RTOS \\| CISA A A ( Lock ) or[\\#protect2024](/protect2024)  Search Menu Close[Faith\\-Based Community](/audiences/faith-based-community) [High\\-Risk Communities](/audiences/high-risk-communities)* Resources \\& Tools[Resources \\& Tools](/resources-tools) [All Resources \\& Tools](/resources-tools/all-resources-tools)* News \\& Events[News \\& Events](/news-events) [Cybersecurity Alerts \\& Advisories](/news-events/cybersecurity-advisories)[Benefits \\& Perks](/careers/benefits-perks)[Resume \\& Application Tips](/careers/resume-application-tips)[Students \\& Recent Graduates](/students-recent-graduates-employment-opportunities)[Divisions \\& Offices](/about/divisions-offices)[\\#protect2024](/protect2024) 2. [News \\& Events](/news-events)4. [Cybersecurity Advisory](/news-events/cybersecurity-advisories?f%5B0%5D=advisory_type%3A94) Cybersecurity AdvisoryBadAlloc Vulnerability Affecting BlackBerry QNX RTOS==================================================== Last Revised August 23, 2021 Alert Code AA21\\-229A### Summary On August 17, 2021, BlackBerry publicly disclosed that its QNX Real Time Operating System (RTOS) is affected by a [BadAlloc](https://us-cert.cisa.gov/ics/advisories/icsa-21-119-04)  vulnerability\u2014CVE\\-2021\\-22156\\. BadAlloc is a collection of vulnerabilities affecting multiple RTOSs and supporting libraries.\\[ [1](https://support.blackberry.com/kb/articleDetail?articleNumber=000082334)  ] A remote attacker could exploit CVE\\-2021\\-22156 to cause a denial\\-of\\-service condition or execute arbitrary code on affected devices.\\[ [2](https://support.blackberry.com/kb/articleDetail?articleNumber=000082334)  ] BlackBerry QNX RTOS is used in a [wide range of products](https://blackberry.qnx.com/en/company/about-qnx)  whose compromise could result in a malicious actor gaining control of highly sensitive systems,\u00a0 increasing risk to the Nation\u2019s critical functions. **Note**  : at this time, CISA is not aware of active exploitation of this vulnerability. CISA strongly encourages critical infrastructure organizations\u00a0and other organization developing, maintaining, supporting, or using affected QNX\\-based systems, to patch affected products as quickly as possible. Refer to the Mitigations section for more information about patching.[Click here](/sites/default/files/publications/AA21-229A_BadAlloc%20Vulnerability%20Affecting%20BlackBerry%20QNX%20RTOS_Final.pdf)  for a PDF version of this report.### Technical Details CVE\\-2021\\-22156 is an integer overflow vulnerability affecting the `calloc()`  function in the C runtime library of multiple BlackBerry QNX products. Exploitation of this vulnerability could lead to a denial\\-of\\-service condition or arbitrary code execution in affected devices. To exploit this vulnerability, an attacker must have control over the parameters to a `calloc()`  function call and the ability to control what memory is accessed after the allocation. An attacker with network access\u00a0could remotely exploit this vulnerability if the vulnerable product is running and the affected device is exposed to the internet.\\[ [3](https://support.blackberry.com/kb/articleDetail?articleNumber=000082334)  ] CVE\\-2021\\-22156 is part of a collection of integer overflow vulnerabilities, known as BadAlloc, which affect a wide range of industries using Internet of Things (IoT), and operational technology (OT)/industrial control systems (ICS) devices. See CISA [ICS Advisory ICSA\\-21\\-119\\-04](https://us-cert.cisa.gov/ics/advisories/icsa-21-119-04)  and Microsoft\u2019s [BadAlloc blog post](https://msrc-blog.microsoft.com/2021/04/29/badalloc-memory-allocation-vulnerabilities-could-affect-wide-range-of-iot-and-ot-devices-in-industrial-medical-and-enterprise-networks/)  for more information. All BlackBerry programs with dependency on the C runtime library are affected by this vulnerability (see table 1 for a list of affected BlackBerry QNX products). Because many affected devices include safety\\-critical devices, exploitation of this vulnerability could result in a malicious actor gaining control of sensitive systems, possibly leading to increased risk of damage to infrastructure or critical functions.##### **Table 1: Affected BlackBerry QNX Products \\[ [4](https://www.qnx.com/support/knowledgebase.html?id=5015Y000001SX2z)  ]**| Product | Affected Version || --- | --- || QNX SDP | 6\\.5\\.0SP1, 6\\.5\\.0,\u00a0 6\\.4\\.1, 6\\.4\\.0 || QNX Momentics Development Suite | 6\\.3\\.2 || QNX Momentics | 6\\.3\\.0SP3, 6\\.3\\.0SP2, 6\\.3\\.0SP1, 6\\.3\\.0, 6\\.2\\.1b, 6\\.2\\.1, 6\\.2\\.1A, 6\\.2\\.0 || QNX Realtime Platform | 6\\.1\\.0a, 6\\.1\\.0, 6\\.0\\.0a, 6\\.0\\.0 || QNX Cross Development Kit | 6\\.0\\.0, 6\\.1\\.0 || QNX Development Kit (Self\\-hosted) | 6\\.0\\.0, 6\\.1\\.0 || QNX Neutrino RTOS Safe Kernel | 1\\.0 || QNX Neutrino RTOS Certified Plus | 1\\.0 || QNX Neutrino RTOS for Medical Devices | 1\\.0, 1\\.1 || QNX OS for Automotive Safety | 1\\.0 || QNX OS for Safety | 1\\.0, 1\\.0\\.1 || QNX Neutrino Secure Kernel | 6\\.4\\.0, 6\\.5\\.0 || QNX CAR Development Platform | 2\\.0RR |### Mitigations CISA strongly encourages critical infrastructure organizations and other organizations developing, maintaining, supporting, or using affected QNX\\-based systems to patch affected products as quickly as possible.* **Manufacturers**  of products that incorporate vulnerable versions should contact BlackBerry to obtain the patch.* **Manufacturers of products who develop unique versions of RTOS software**  should contact BlackBerry to obtain the patch code. **Note:**  in some cases, manufacturers may need to develop and test their own software patches.* **End users**  of safety\\-critical systems should contact the manufacturer of their product to obtain a patch. If a patch is available, users should apply the patch as soon as possible. If a patch is not available, users should apply the manufacturer's recommended\u00a0mitigation measures until the patch can be applied.\t+ **Note** \t : installation of software updates for RTOS frequently may require taking the device out of service or to an off\\-site location for physical replacement of integrated memory.**Critical infrastructure organizations**  are encouraged to review the following guidance for additional information:* U.S. Coast Guard Maritime Security Advisory: [Maritime Cyber Alert 02\\-21](https://www.dco.uscg.mil/Portals/9/Cyber/MaritimeCyberAlert%2002-21%20TLP_WHITE.pdf)* U.S. Nuclear Regulatory Commission Security Advisory: [Blackberry QNX Vulnerability](https://www.nrc.gov/docs/ML2121/ML21217A177.pdf)* Joint WaterISAC: [U.S. Environmental Protection Agency Advisory \\- BadAlloc Vulnerability Impacting BlackBerry QNX RTOS](https://www.waterisac.org/portal/joint-waterisac-%E2%80%93-us-environmental-protection-agency-advisory-badalloc-vulnerability)### Resources* CISA ICS Advisory: [ICSA\\-21\\-119\\-04: Multiple RTOS](https://us-cert.cisa.gov/ics/advisories/icsa-21-119-04)* BlackBerry: [QNX\\-2021\\-001 Vulnerability in the C Runtime Library Impacts BlackBerry QNX Software Development Platform (SDP), QNX OS for Medical, and QNX OS for Safety](https://support.blackberry.com/kb/articleDetail?articleNumber=000082334%20)### References[\\[1] BlackBerry: QNX\\-2021\\-001 Vulnerability in the C Runtime Library Impacts BlackBerry QNX Software Development Platform (SDP), QNX OS for Medical, and QNX OS for Safety](https://support.blackberry.com/kb/articleDetail?articleNumber=000082334) [\\[2] Ibid.](https://support.blackberry.com/kb/articleDetail?articleNumber=000082334) [\\[3] Ibid.](https://support.blackberry.com/kb/articleDetail?articleNumber=000082334) [\\[4] BlackBerry: QNX. Affected Product List](https://www.qnx.com/support/knowledgebase.html?id=5015Y000001SX2z) ### Revisions Initial version: August 17, 2021\\|August 18, 2021: Added links to U.S. Coast Guard and U.S. Nuclear Regulatory Commission advisories.\\|August 23, 2021: Added additional resource for critical infrastructure organizations This product is provided subject to this [Notification](/notification \"Follow link\")  and this [Privacy \\& Use](/privacy-policy \"Follow link\")  policy.-------------------------- [product survey](https://www.surveymonkey.com/r/CISA-cyber-survey?product=https://www.cisa.gov/news-events/cybersecurity-advisories/aa21-229a)  ; Related Advisories------------------ Jul 11, 2024 Cybersecurity Advisory \\| AA24\\-193A### [CISA Red Team\u2019s Operations Against a Federal Civilian Executive Branch Organization Highlights the Necessity of Defense\\-in\\-Depth](/news-events/cybersecurity-advisories/aa24-193a) Jul 08, 2024 Cybersecurity Advisory \\| AA24\\-190A### [People\u2019s Republic of China (PRC) Ministry of State Security APT40 Tradecraft in Action](/news-events/cybersecurity-advisories/aa24-190a) May 10, 2024 Cybersecurity Advisory \\| AA24\\-131A### [\\#StopRansomware: Black Basta](/news-events/cybersecurity-advisories/aa24-131a) Apr 18, 2024 Cybersecurity Advisory \\| AA24\\-109A### [\\#StopRansomware: Akira Ransomware](/news-events/cybersecurity-advisories/aa24-109a)* [Resources \\& Tools](/resources-tools)* [News \\& Events](/news-events)[Cybersecurity \\& Infrastructure Security Agency](/ \"Go to the Cybersecurity & Infrastructure Security Agency homepage\")[1\\-844\\-Say\\-CISA](tel:1-844-Say-CISA) * [Equal Opportunity \\& Accessibility](/oedia \"Equal Opportunity & Accessibility\")",
  "cves": [
    "CVE-2021-22156"
  ],
  "techniques": [],
  "advisory": "aa21-229a",
  "title": "BadAlloc Vulnerability Affecting BlackBerry QNX RTOS | CISA",
  "source": "cybersecurity-advisories",
  "id": "3b86cde2dff739404c21f42f3867c2d14ee88e808c4105129976a8189c16f952"
}