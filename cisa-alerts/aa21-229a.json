{"markdown": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n BadAlloc Vulnerability Affecting BlackBerry QNX RTOS \\| CISA\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[Skip to main content](#main) \n\n\n\n\n\n\n\n\n\n\n\n\n![U.S. flag](/profiles/cisad8_gov/themes/custom/gesso/dist/images/us_flag_small.png)\n\n\n\n An official website of the United States government\n \n\n\n\n Here\u2019s how you know\n \n\n\n\n\n\n Here\u2019s how you know\n \n\n\n\n\n\n\n![Dot gov](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-dot-gov.svg)\n\n\n**Official websites use .gov** \n  \n\n A\n **.gov** \n website belongs to an official government organization in the United States.\n \n\n\n\n\n\n![HTTPS](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-https.svg)\n\n\n**Secure .gov websites use HTTPS** \n  \n\n A\n **lock** \n (\n \n\n\n Lock\n \n\n A locked padlock\n \n\n\n\n\n ) or\n **https://** \n means you\u2019ve safely connected to the .gov website. Share sensitive information only on official, secure websites.\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools \"Free Cyber Services\") \n[\\#protect2024](/protect2024) \n[Secure Our World](/node/18883) \n[Shields Up](/node/8056) \n[Report A Cyber Issue](/node/16591) \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[![CISA Logo Americas Cyber Defense Agency](/sites/default/files/images/SVG/header_logo_tagline_update.svg)](/)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[![CISA Logo](/sites/default/files/images/SVG/mobile_logo_wordmark.svg)](/)\n\n\n\n\n\n\n\n\n\n\n Search\n \n\n\n\n\n\n\n\n\n\n Menu\n \n\n\n\n\n\n\n\n\n\n\n\n\n![America's Cyber Defense Agency](/sites/default/files/images/SVG/header_tagline_mobile_update.svg)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Close\n \n\n\n\n\n* Topics\n \n\n\n\n[Topics](/topics) \n\n\n\n\n[Cybersecurity Best Practices](/topics/cybersecurity-best-practices)\n\n\n\n\n[Cyber Threats and Advisories](/topics/cyber-threats-and-advisories)\n\n\n\n\n[Critical Infrastructure Security and Resilience](/topics/critical-infrastructure-security-and-resilience)\n\n\n\n\n[Election Security](/topics/election-security)\n\n\n\n\n[Emergency Communications](/topics/emergency-communications)\n\n\n\n\n[Industrial Control Systems](/topics/industrial-control-systems)\n\n\n\n\n[Information and Communications Technology Supply Chain Security](/topics/information-communications-technology-supply-chain-security)\n\n\n\n\n[Partnerships and Collaboration](/topics/partnerships-and-collaboration)\n\n\n\n\n[Physical Security](/topics/physical-security)\n\n\n\n\n[Risk Management](/topics/risk-management)\n\n\n\n\n\n[How can we help?](/audiences) \n\n\n[Government](/topics/government) \n[Educational Institutions](/topics/educational-institutions) \n[Industry](/topics/industry) \n[State, Local, Tribal, and Territorial](/topics/state-local-tribal-and-territorial) \n[Individuals and Families](/topics/individuals-and-families) \n[Small and Medium Businesses](/topics/small-and-medium-businesses) \n[Find Help Locally](/audiences/find-help-locally) \n[Faith\\-Based Community](/audiences/faith-based-community) \n[Executives](/audiences/executives) \n[High\\-Risk Communities](/audiences/high-risk-communities)\n* [Spotlight](/spotlight)\n* Resources \\& Tools\n \n\n\n\n[Resources \\& Tools](/resources-tools) \n\n\n\n\n[All Resources \\& Tools](/resources-tools/all-resources-tools)\n\n\n\n\n[Services](/resources-tools/services)\n\n\n\n\n[Programs](/resources-tools/programs)\n\n\n\n\n[Resources](/resources-tools/resources)\n\n\n\n\n[Training](/resources-tools/training)\n\n\n\n\n[Groups](/resources-tools/groups)\n* News \\& Events\n \n\n\n\n[News \\& Events](/news-events) \n\n\n\n\n[News](/news-events/news)\n\n\n\n\n[Events](/news-events/events)\n\n\n\n\n[Cybersecurity Alerts \\& Advisories](/news-events/cybersecurity-advisories)\n\n\n\n\n[Directives](/news-events/directives)\n\n\n\n\n[Request a CISA Speaker](/news-events/request-speaker)\n\n\n\n\n[Congressional Testimony](/news-events/congressional-testimony)\n\n\n\n\n[CISA Conferences](/cisa-conferences)\n\n\n\n\n[CISA Live!](/cisa-live)\n* Careers\n \n\n\n\n[Careers](/careers) \n\n\n\n\n[Benefits \\& Perks](/careers/benefits-perks)\n\n\n\n\n[HireVue Applicant Reasonable Accommodations Process](/careers/hirevue-applicant-reasonable-accommodations-process)\n\n\n\n\n[Hiring](/general-recruitment-and-hiring-faqs)\n\n\n\n\n[Resume \\& Application Tips](/careers/resume-application-tips)\n\n\n\n\n[Students \\& Recent Graduates](/students-recent-graduates-employment-opportunities)\n\n\n\n\n[Veteran and Military Spouses](/careers/veteran-and-military-spouse-employment-opportunities)\n\n\n\n\n[Work @ CISA](/careers/work-cisa)\n* About\n \n\n\n\n[About](/about) \n\n\n\n\n[Culture](/about/culture)\n\n\n\n\n[Divisions \\& Offices](/about/divisions-offices)\n\n\n\n\n[Regions](/about/regions)\n\n\n\n\n[Leadership](/about/leadership)\n\n\n\n\n[Doing Business with CISA](/doing-business-cisa)\n\n\n\n\n[Site Links](/site-links)\n\n\n\n\n[Reporting Employee and Contractor Misconduct](/reporting-employee-and-contractor-misconduct)\n\n\n\n\n[CISA GitHub](/cisa-github)\n\n\n\n\n[CISA Central](/cisa-central)\n\n\n\n\n[2023 Year In Review](/about/2023YIR)\n\n\n\n\n[Contact Us](/about/contact-us)\n\n\n\n\n\n\n\n\n\n[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools \"Free Cyber Services\") \n[\\#protect2024](/protect2024) \n[Secure Our World](/node/18883) \n[Shields Up](/node/8056) \n[Report A Cyber Issue](/node/16591) \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Breadcrumb\n \n1. [Home](/)\n2. [News \\& Events](/news-events)\n3. [Cybersecurity Advisories](/news-events/cybersecurity-advisories)\n4. [Cybersecurity Advisory](/news-events/cybersecurity-advisories?f%5B0%5D=advisory_type%3A94)\n\n\n\n\n\n\n\n\n Share:\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Cybersecurity Advisory\n \nBadAlloc Vulnerability Affecting BlackBerry QNX RTOS\n====================================================\n\n\n\n\n\n Last Revised\n \n\n\n August 23, 2021\n \n\n\n\n\n Alert Code\n \n\n AA21\\-229A\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n### Summary\n\n\n\n\n On August 17, 2021, BlackBerry publicly disclosed that its QNX Real Time Operating System (RTOS) is affected by a\n [BadAlloc](https://us-cert.cisa.gov/ics/advisories/icsa-21-119-04) \n vulnerability\u2014CVE\\-2021\\-22156\\. BadAlloc is a collection of vulnerabilities affecting multiple RTOSs and supporting libraries.\\[\n [1](https://support.blackberry.com/kb/articleDetail?articleNumber=000082334) \n ] A remote attacker could exploit CVE\\-2021\\-22156 to cause a denial\\-of\\-service condition or execute arbitrary code on affected devices.\\[\n [2](https://support.blackberry.com/kb/articleDetail?articleNumber=000082334) \n ] BlackBerry QNX RTOS is used in a\n [wide range of products](https://blackberry.qnx.com/en/company/about-qnx) \n whose compromise could result in a malicious actor gaining control of highly sensitive systems,\u00a0 increasing risk to the Nation\u2019s critical functions.\n **Note** \n : at this time, CISA is not aware of active exploitation of this vulnerability.\n \n\n\n\n CISA strongly encourages critical infrastructure organizations\u00a0and other organization developing, maintaining, supporting, or using affected QNX\\-based systems, to patch affected products as quickly as possible. Refer to the Mitigations section for more information about patching.\n \n\n\n\n[Click here](/sites/default/files/publications/AA21-229A_BadAlloc%20Vulnerability%20Affecting%20BlackBerry%20QNX%20RTOS_Final.pdf) \n for a PDF version of this report.\n \n\n\n\n### Technical Details\n\n\n\n\n CVE\\-2021\\-22156 is an integer overflow vulnerability affecting the\n `calloc()` \n function in the C runtime library of multiple BlackBerry QNX products. Exploitation of this vulnerability could lead to a denial\\-of\\-service condition or arbitrary code execution in affected devices. To exploit this vulnerability, an attacker must have control over the parameters to a\n `calloc()` \n function call and the ability to control what memory is accessed after the allocation. An attacker with network access\u00a0could remotely exploit this vulnerability if the vulnerable product is running and the affected device is exposed to the internet.\\[\n [3](https://support.blackberry.com/kb/articleDetail?articleNumber=000082334) \n ]\n \n\n\n\n CVE\\-2021\\-22156 is part of a collection of integer overflow vulnerabilities, known as BadAlloc, which affect a wide range of industries using Internet of Things (IoT), and operational technology (OT)/industrial control systems (ICS) devices. See CISA\n [ICS Advisory ICSA\\-21\\-119\\-04](https://us-cert.cisa.gov/ics/advisories/icsa-21-119-04) \n and Microsoft\u2019s\n [BadAlloc blog post](https://msrc-blog.microsoft.com/2021/04/29/badalloc-memory-allocation-vulnerabilities-could-affect-wide-range-of-iot-and-ot-devices-in-industrial-medical-and-enterprise-networks/) \n for more information.\n \n\n\n\n All BlackBerry programs with dependency on the C runtime library are affected by this vulnerability (see table 1 for a list of affected BlackBerry QNX products). Because many affected devices include safety\\-critical devices, exploitation of this vulnerability could result in a malicious actor gaining control of sensitive systems, possibly leading to increased risk of damage to infrastructure or critical functions.\n \n\n\n\n\n\n##### **Table 1: Affected BlackBerry QNX Products \\[\n [4](https://www.qnx.com/support/knowledgebase.html?id=5015Y000001SX2z) \n ]**\n\n\n\n| Product | Affected Version |\n| --- | --- |\n| QNX SDP | 6\\.5\\.0SP1, 6\\.5\\.0,\u00a0 6\\.4\\.1, 6\\.4\\.0 |\n| QNX Momentics Development Suite | 6\\.3\\.2 |\n| QNX Momentics | 6\\.3\\.0SP3, 6\\.3\\.0SP2, 6\\.3\\.0SP1, 6\\.3\\.0, 6\\.2\\.1b, 6\\.2\\.1, 6\\.2\\.1A, 6\\.2\\.0 |\n| QNX Realtime Platform | 6\\.1\\.0a, 6\\.1\\.0, 6\\.0\\.0a, 6\\.0\\.0 |\n| QNX Cross Development Kit | 6\\.0\\.0, 6\\.1\\.0 |\n| QNX Development Kit (Self\\-hosted) | 6\\.0\\.0, 6\\.1\\.0 |\n| QNX Neutrino RTOS Safe Kernel | 1\\.0 |\n| QNX Neutrino RTOS Certified Plus | 1\\.0 |\n| QNX Neutrino RTOS for Medical Devices | 1\\.0, 1\\.1 |\n| QNX OS for Automotive Safety | 1\\.0 |\n| QNX OS for Safety | 1\\.0, 1\\.0\\.1 |\n| QNX Neutrino Secure Kernel | 6\\.4\\.0, 6\\.5\\.0 |\n| QNX CAR Development Platform | 2\\.0RR |\n\n\n\n\n\n\n\n### Mitigations\n\n\n\n\n CISA strongly encourages critical infrastructure organizations and other organizations developing, maintaining, supporting, or using affected QNX\\-based systems to patch affected products as quickly as possible.\n \n\n\n* **Manufacturers** \n of products that incorporate vulnerable versions should contact BlackBerry to obtain the patch.\n* **Manufacturers of products who develop unique versions of RTOS software** \n should contact BlackBerry to obtain the patch code.\n **Note:** \n in some cases, manufacturers may need to develop and test their own software patches.\n* **End users** \n of safety\\-critical systems should contact the manufacturer of their product to obtain a patch. If a patch is available, users should apply the patch as soon as possible. If a patch is not available, users should apply the manufacturer's recommended\u00a0mitigation measures until the patch can be applied.\n\t+ **Note** \n\t : installation of software updates for RTOS frequently may require taking the device out of service or to an off\\-site location for physical replacement of integrated memory.\n\n\n\n**Critical infrastructure organizations** \n are encouraged to review the following guidance for additional information:\n \n\n\n* U.S. Coast Guard Maritime Security Advisory:\n [Maritime Cyber Alert 02\\-21](https://www.dco.uscg.mil/Portals/9/Cyber/MaritimeCyberAlert%2002-21%20TLP_WHITE.pdf)\n* U.S. Nuclear Regulatory Commission Security Advisory:\n [Blackberry QNX Vulnerability](https://www.nrc.gov/docs/ML2121/ML21217A177.pdf)\n* Joint WaterISAC:\n [U.S. Environmental Protection Agency Advisory \\- BadAlloc Vulnerability Impacting BlackBerry QNX RTOS](https://www.waterisac.org/portal/joint-waterisac-%E2%80%93-us-environmental-protection-agency-advisory-badalloc-vulnerability)\n\n\n### Resources\n\n\n* CISA ICS Advisory:\n [ICSA\\-21\\-119\\-04: Multiple RTOS](https://us-cert.cisa.gov/ics/advisories/icsa-21-119-04)\n* BlackBerry:\n [QNX\\-2021\\-001 Vulnerability in the C Runtime Library Impacts BlackBerry QNX Software Development Platform (SDP), QNX OS for Medical, and QNX OS for Safety](https://support.blackberry.com/kb/articleDetail?articleNumber=000082334%20)\n\n\n\n### References\n\n\n\n\n[\\[1] BlackBerry: QNX\\-2021\\-001 Vulnerability in the C Runtime Library Impacts BlackBerry QNX Software Development Platform (SDP), QNX OS for Medical, and QNX OS for Safety](https://support.blackberry.com/kb/articleDetail?articleNumber=000082334) \n\n\n[\\[2] Ibid.](https://support.blackberry.com/kb/articleDetail?articleNumber=000082334) \n\n\n[\\[3] Ibid.](https://support.blackberry.com/kb/articleDetail?articleNumber=000082334) \n\n\n[\\[4] BlackBerry: QNX. Affected Product List](https://www.qnx.com/support/knowledgebase.html?id=5015Y000001SX2z) \n\n\n### Revisions\n\n\n\n\n Initial version: August 17, 2021\\|August 18, 2021: Added links to U.S. Coast Guard and U.S. Nuclear Regulatory Commission advisories.\\|August 23, 2021: Added additional resource for critical infrastructure organizations\n \n\n\n\n\n\n\n\n\n\n\n This product is provided subject to this\n [Notification](/notification \"Follow link\") \n and this\n [Privacy \\& Use](/privacy-policy \"Follow link\") \n policy.\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPlease share your thoughts\n--------------------------\n\n\n\n We recently updated our anonymous\n [product survey](https://www.surveymonkey.com/r/CISA-cyber-survey?product=https://www.cisa.gov/news-events/cybersecurity-advisories/aa21-229a) \n ; we\u2019d welcome your feedback.\n \n\n\n\n\n\n\n\n\n\n\n\n\nRelated Advisories\n------------------\n\n\n\n\n\n\n\n\n\n\n Jul 11, 2024\n \n\n\n Cybersecurity Advisory \\| AA24\\-193A\n \n\n### [CISA Red Team\u2019s Operations Against a Federal Civilian Executive Branch Organization Highlights the Necessity of Defense\\-in\\-Depth](/news-events/cybersecurity-advisories/aa24-193a)\n\n\n\n\n\n\n\n\n\n\n\n Jul 08, 2024\n \n\n\n Cybersecurity Advisory \\| AA24\\-190A\n \n\n### [People\u2019s Republic of China (PRC) Ministry of State Security APT40 Tradecraft in Action](/news-events/cybersecurity-advisories/aa24-190a)\n\n\n\n\n\n\n\n\n\n\n\n May 10, 2024\n \n\n\n Cybersecurity Advisory \\| AA24\\-131A\n \n\n### [\\#StopRansomware: Black Basta](/news-events/cybersecurity-advisories/aa24-131a)\n\n\n\n\n\n\n\n\n\n\n\n Apr 18, 2024\n \n\n\n Cybersecurity Advisory \\| AA24\\-109A\n \n\n### [\\#StopRansomware: Akira Ransomware](/news-events/cybersecurity-advisories/aa24-109a)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[Return to top](#) \n\n\n\n\n* [Topics](/topics)\n* [Spotlight](/spotlight)\n* [Resources \\& Tools](/resources-tools)\n* [News \\& Events](/news-events)\n* [Careers](/careers)\n* [About](/about)\n\n\n\n\n\n\n\n\n[Cybersecurity \\& Infrastructure Security Agency](/ \"Go to the Cybersecurity & Infrastructure Security Agency homepage\")\n\n\n* [Facebook](https://www.facebook.com/CISA)\n* [Twitter](https://twitter.com/CISAgov)\n* [LinkedIn](https://www.linkedin.com/company/cybersecurity-and-infrastructure-security-agency)\n* [YouTube](https://www.youtube.com/@cisagov)\n* [Instagram](https://www.instagram.com/cisagov)\n* [RSS](/subscribe-updates-cisa)\n\n\n\n\n CISA Central\n \n[1\\-844\\-Say\\-CISA](tel:1-844-Say-CISA) \n[SayCISA@cisa.gov](mailto:SayCISA@cisa.gov) \n\n\n\n\n\n\n\n\n\n\n\n DHS Seal\n \n\n\n CISA.gov\n \n\n An official website of the U.S. Department of Homeland Security\n \n\n\n* [About CISA](/about \"About CISA\")\n* [Budget and Performance](https://www.dhs.gov/performance-financial-reports \"Budget and Performance\")\n* [DHS.gov](https://www.dhs.gov \"Department of Homeland Security\")\n* [Equal Opportunity \\& Accessibility](/oedia \"Equal Opportunity & Accessibility\")\n* [FOIA Requests](https://www.dhs.gov/foia \"FOIA Requests\")\n* [No FEAR Act](/no-fear-act \"No FEAR Act Reporting\")\n* [Office of Inspector General](https://www.oig.dhs.gov/ \"Office of Inspector General\")\n* [Privacy Policy](/privacy-policy \"Privacy Policy\")\n* [Subscribe](https://public.govdelivery.com/accounts/USDHSCISA/subscriber/new?topic_id=USDHSCISA_138 \"Subscribe to Email Updates\")\n* [The White House](https://www.whitehouse.gov/ \"The White House\")\n* [USA.gov](https://www.usa.gov/ \"USA.gov\")\n* [Website Feedback](/forms/feedback \"Website Feedback\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n", "cves": ["CVE-2021-22156"], "techniques": [], "advisory": "aa21-229a", "title": "BadAlloc Vulnerability Affecting BlackBerry QNX RTOS | CISA", "source": "cybersecurity-advisories", "id": "3b86cde2dff739404c21f42f3867c2d14ee88e808c4105129976a8189c16f952"}