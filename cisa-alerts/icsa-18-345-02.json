{
  "markdown": "\n1. EXECUTIVE SUMMARY\n\n\nCVSS v3 10.0\n\nATTENTION: Exploitable remotely/low skill level to exploit\nVendor: Siemens\nEquipment: SINUMERIK Controllers\nVulnerabilities: Heap-based Buffer Overflow, Integer Overflow or Wraparound, Protection Mechanism Failure, Permissions, Privileges, and Access Controls, Stack-based Buffer Overflow, Uncaught Exception\n\n2. UPDATE INFORMATION\nThis updated advisory is a follow-up to the original advisory titled ICSA-18-345-02 Siemens SINUMERIK Controllers that was published December 11, 2018, on the NCCIC/ICS-CERT website.\n3.\u00a0RISK EVALUATION\nSuccessful exploitation of these vulnerabilities could cause denial-of-service conditions, privilege escalation, or allow remote code execution.\n4. TECHNICAL DETAILS\n4.1 AFFECTED PRODUCTS\nSiemens reports the vulnerabilities affect the following versions of the SINUMERIK CNC controllers:\n--------- Begin Update A Part 1 of 2 ---------\n\nSINUMERIK 808D v4.7 all versions prior to v4.91,\nSINUMERIK 808D v4.8 all versions prior to v4.91,\n\n--------- End Update A Part 1 of 2 ---------\n\nSINUMERIK 828D v4.7 all versions prior to v4.7 SP6 HF1,\nSINUMERIK 840D sl v4.7 all versions prior to v4.7 SP6 HF5, and\nSINUMERIK 840D sl v4.8 all versions prior to v4.8 SP3\n\nSome products are not affected by all of the vulnerabilities. Please see Siemens advisory SSA-170881 for additional details.\n4.2 VULNERABILITY OVERVIEW\n4.2.1\u00a0\u00a0 \u00a0HEAP-BASED BUFFER OVERFLOW CWE-122\nSending specially crafted network requests to Port 4842/TCP of the integrated web server could allow a remote attacker to execute code with privileged permissions.\nThis vulnerability is only exploitable if Port 4842/TCP is manually opened in the firewall configuration of network Port X130.\nCVE-2018-11457 has been assigned to this vulnerability. A CVSS v3 base score of 9.8 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).\n4.2.2\u00a0\u00a0 \u00a0INTEGER OVERFLOW OR WRAPAROUND CWE-190\nSending specially crafted network requests to Port 5900/TCP of the integrated VNC server could allow a remote attacker to execute code with privileged permissions.\nThis vulnerability is only exploitable if Port 5900/TCP is manually opened in the firewall configuration of network Port X130.\nCVE-2018-11458 has been assigned to this vulnerability. A CVSS v3 base score of 9.8 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).\n4.2.3\u00a0\u00a0 \u00a0PROTECTION MECHANISM FAILURE CWE-693\nA local attacker could modify a user-writeable configuration file so that after reboot or manual initiation, the attacker-controlled code is executed with elevated privileges.\nCVE-2018-11459 has been assigned to this vulnerability. A CVSS v3 base score of 7.0 has been calculated; the CVSS vector string is (AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H).\n4.2.4\u00a0\u00a0 \u00a0PROTECTION MECHANISM FAILURE CWE-693\nA local attacker with elevated user privileges (manufact) could modify a CRAMFS archive so that after reboot, the system loads the modified CRAMFS file and attacker-controlled code is executed with root privileges.\nCVE-2018-11460 has been assigned to this vulnerability. A CVSS v3 base score of 6.7 has been calculated; the CVSS vector string is (AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H).\n4.2.5\u00a0\u00a0 \u00a0PERMISSIONS, PRIVILEGES, AND ACCESS CONTROLS CWE-264\nA local attacker with user privileges could use the service command application for privilege escalation to an elevated user, but not root.\nCVE-2018-11461 has been assigned to this vulnerability. A CVSS v3 base score of 6.6 has been calculated; the CVSS vector string is (AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:H/A:L).\n4.2.6\u00a0\u00a0 \u00a0PERMISSIONS, PRIVILEGES, AND ACCESS CONTROLS CWE-264\nBy sending a specially crafted authentication request to affected systems, a remote attacker could escalate privileges to an elevated user account, but not to root.\nCVE-2018-11462 has been assigned to this vulnerability. A CVSS v3 base score of 9.8 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).\n4.2.7\u00a0\u00a0 \u00a0STACK-BASED BUFFER OVERFLOW CWE-121\nA buffer overflow in the service command application could allow a local attacker to execute code with elevated privileges.\nCVE-2018-11463 has been assigned to this vulnerability. A CVSS v3 base score of 7.8 has been calculated; the CVSS vector string is (AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H).\n4.2.8\u00a0\u00a0 \u00a0UNCAUGHT EXCEPTION CWE-248\nThe integrated VNC server on Port 5900/TCP of the affected products could allow a remote attacker to cause a denial-of-service condition of the VNC server.\nThis vulnerability is only exploitable if Port 5900/TCP is manually opened in the firewall configuration of network Port X130.\u00a0\nCVE-2018-11464 has been assigned to this vulnerability. A CVSS v3 base score of 5.3 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L).\n4.2.9\u00a0\u00a0 \u00a0UNCAUGHT EXCEPTION CWE-248\nA local attacker could use ioctl calls to do out of bounds reads, arbitrary writes, or execute code in kernel mode.\nCVE-2018-11465 has been assigned to this vulnerability. A CVSS v3 base score of 7.8 has been calculated; the CVSS vector string is (AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H).\n4.2.10\u00a0\u00a0 \u00a0UNCAUGHT EXCEPTION CWE-248\nSpecially crafted network packets sent to Port 102/TCP (ISO-TSAP) could allow a remote attacker to cause a denial-of-service condition of the integrated software firewall, or allow to execute code in the context of the software firewall.\u00a0\nCVE-2018-11466 has been assigned to this vulnerability. A CVSS v3 base score of 10.0 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H).\n4.3 BACKGROUND\n\u2022\u00a0\u00a0 \u00a0CRITICAL INFRASTRUCTURE SECTORS: Critical Manufacturing\u2022\u00a0\u00a0 \u00a0COUNTRIES/AREAS DEPLOYED: Worldwide\u2022\u00a0\u00a0 \u00a0COMPANY HEADQUARTERS LOCATION: Germany\n4.4 RESEARCHER\nSiemens working with Anton Kalinin, Danila Parnishchev, Dmitry Sklyar, Gleb Gritsai, Kirill Nesterov, Radu Motspan, and Sergey Sidorov from Kaspersky Lab reported these vulnerabilities to NCCIC.\n5. MITIGATIONS\n--------- Begin Update A Part 2 of 2 ---------\nSiemens recommends updating affected devices as soon as possible. See below for details.\n\nSINUMERIK 808D v4.7 all versions prior to v4.91\nSINUMERIK 808D v4.8 all versions prior to v4.91\n\n--------- End Update A Part 2 of 2 ---------\n\nSINUMERIK 828D v4.7: Update to v4.7 SP6 HF1\nSINUMERIK 840D sl v4.7: Update to v4.7 SP6 HF5\nSINUMERIK 840D sl v4.8: Update to v4.8 SP3\n\nContact a Siemens account manager to obtain updates for SINUMERIK software.Siemens recommends affected users implement the following specific workarounds and mitigations to reduce risk:\n\nCheck and restore default settings (4842/TCP and 5900/TCP blocked) for firewall on network Port X130\nRestrict system access to authorized personnel and follow a least privilege approach\nApply cell protection concept\nUse VPN for protecting network communication between cells\nApply defense-in-depth\n\nFor additional information see Siemens\u2019 security advisory SSA-170881 at the following location:\nhttp://www.siemens.com/cert/en/cert-security-advisories.htm\nAs a general security measure, Siemens strongly recommends protecting network access to devices with appropriate mechanisms. In order to operate the devices in a protected IT environment, Siemens recommends configuring the environment according to Siemens\u2019 operational guidelines for industrial security, and following the recommendations in the product manuals.\nhttps://www.siemens.com/cert/operational-guidelines-industrial-security\nAdditional information on Industrial Security by Siemens can be found at:\u00a0\nhttps://www.siemens.com/Industrialsecurity\nNCCIC recommends users take defensive measures to minimize the risk of exploitation of these vulnerabilities. Specifically, users should:\n\nMinimize network exposure for all control system devices and/or systems, and ensure that they are not accessible from the Internet.\nLocate control system networks and remote devices behind firewalls, and isolate them from the business network.\n\nNCCIC reminds organizations to perform proper impact analysis and risk assessment prior to deploying defensive measures.\nNCCIC also provides a section for control systems security recommended practices on the ICS-CERT web page. Several recommended practices are available for reading and download, including Improving Industrial Control Systems Cybersecurity with Defense-in-Depth Strategies.\nAdditional mitigation guidance and recommended practices are publicly available on the ICS-CERT website in the technical information paper, ICS-TIP-12-146-01B--Targeted Cyber Intrusion Detection and Mitigation Strategies.\nOrganizations observing any suspected malicious activity should follow their established internal procedures and report their findings to NCCIC for tracking and correlation against other incidents.\nNCCIC also recommends that users take the following measures to protect themselves from social engineering attacks:\u00a0\n\nDo not click web links or open unsolicited attachments in email messages.\u00a0\nRefer to Recognizing and Avoiding Email Scams for more information on avoiding email scams.\u00a0\nRefer to Avoiding Social Engineering and Phishing Attacks for more information on social engineering attacks.\n\nNo known public exploits specifically target these vulnerabilities.\u00a0\n",
  "cves": [
    "CVE-2018-11464",
    "CVE-2018-11461",
    "CVE-2018-11459",
    "CVE-2018-11465",
    "CVE-2018-11460",
    "CVE-2018-11462",
    "CVE-2018-11457",
    "CVE-2018-11466",
    "CVE-2018-11463",
    "CVE-2018-11458"
  ],
  "techniques": [],
  "advisory": "icsa-18-345-02",
  "title": "Siemens SINUMERIK Controllers (Update A) | CISA",
  "source": "ics-advisories",
  "id": "ae95a24d0a7fd7d28b5c07485723b6740658beb0405abeeb4be5d71cc06e0ce2"
}