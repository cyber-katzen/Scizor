{
  "markdown": " Network Time Protocol Vulnerabilities (Update C) \\| CISA A A ( Lock ) or[\\#protect2024](/protect2024)  Search Menu Close[Faith\\-Based Community](/audiences/faith-based-community) [High\\-Risk Communities](/audiences/high-risk-communities)* Resources \\& Tools[Resources \\& Tools](/resources-tools) [All Resources \\& Tools](/resources-tools/all-resources-tools)* News \\& Events[News \\& Events](/news-events) [Cybersecurity Alerts \\& Advisories](/news-events/cybersecurity-advisories)[Benefits \\& Perks](/careers/benefits-perks)[Resume \\& Application Tips](/careers/resume-application-tips)[Students \\& Recent Graduates](/students-recent-graduates-employment-opportunities)[Divisions \\& Offices](/about/divisions-offices)[\\#protect2024](/protect2024) 2. [News \\& Events](/news-events) ICS AdvisoryNetwork Time Protocol Vulnerabilities (Update C)================================================ Last Revised August 29, 2018 Alert Code ICSA\\-14\\-353\\-01COVERVIEW-------- This updated advisory is a follow\\-up to the updated advisory titled ICSA\\-14\\-353\\-01B Network Time Protocol Vulnerabilities that was published February 4, 2015, on the NCCIC/ICS\\-CERT web site. Google Security Team researchers Neel Mehta and Stephen Roettger have coordinated multiple vulnerabilities with CERT/CC concerning the Network Time Protocol (NTP). As NTP is widely used within operational industrial control systems deployments, ICS\\-CERT is providing this information for US critical infrastructure asset owners and operators for awareness and to identify mitigations for affected devices. ICS\\-CERT may release updates as additional information becomes available. These vulnerabilities could be exploited remotely. Products using NTP service prior to ntp\\-4\\.2\\.8p1 are affected. This is an open source protocol.### **\\-\\-\\-\\-\\-\\-\\-\\-\\- Begin Update C Part 1 of 1 \\-\\-\\-\\-\\-\\-\\-\\-** ICS\\-CERT sent out a query to vendors we have collaborated with in the past to develop a list of known impacted products. Over 20 vendors have responded back with information regarding if their products are affected by this NTP vulnerability. ICS\\-CERT has created a supplement to this advisory that contains vendor\\-supplied affected product information, which will be updated as new information is received, without updating this advisory. This supplement can be found at the following web location: [https://ics\\-cert.us\\-cert.gov/advisories/ICSA\\-14\\-353\\-01\\-Supplement](/ics/advisories/ICSA-14-353-01-Supplement)  .### **\\-\\-\\-\\-\\-\\-\\-\\-\\- End Update C Part 1 of 1 \\-\\-\\-\\-\\-\\-\\-\\-\\-\\-**IMPACT------ Exploitation of these vulnerabilities could allow an attacker to execute arbitrary code with the privileges of the ntpd process. Impact to individual organizations depends on many factors that are unique to each organization. ICS\\-CERT recommends that organizations evaluate the impact of this vulnerability based on their operational environment, architecture, and product implementation.BACKGROUND---------- NTP is described in RFC 958,Network Time Protocol (NTP), http://tools.ietf.org/html/rfc958, web site last accessed February 04, 2015\\. 1305,Network Time Protocol (Version 3\\) Specification, Implementation and Analysis, http://tools.ietf.org/html/rfc1305, web site last accessed February 04, 2015\\. and 5905Network Time Protocol (Version 4\\) Protocol and Algorithms Specification, http://tools.ietf.org/html/rfc5905, web site last accessed February 04, 2015\\.; IETF Standards documents that describe the protocol and algorithms used to synchronize time over a network. The reference implementation of these Standards comes from the open source project via the University of Delaware and Network Time Foundation, and is in wide use.VULNERABILITY CHARACTERIZATION------------------------------### VULNERABILITY OVERVIEW### INSUFFICIENT ENTROPYCWE\\-331: Insufficient Entropy, http://cwe.mitre.org/data/definitions/331\\.html, web site last accessed December 19, 2014\\. If the authentication key is not set in the configuration file, ntpd will generate a weak random key with insufficient entropy. This vulnerability was resolved with NTP\\-dev4\\.2\\.7p11 on January 28, 2010\\. CVE\\-2014\\-9293NVD, http://web.nvd.nist.gov/view/vuln/detail?vulnId\\=CVE\\-2014\\-9293, web site last accessed February 04, 2015\\. has been assigned by CERT/CC to this vulnerability. A CVSS v2 base score of 7\\.3 has been assigned by CERT/CC; the CVSS vector string is (AV:N/AC:L/Au:M/C:P/I:P/A:C).CVSS Calculator, http://nvd.nist.gov/cvss.cfm?version\\=2\\&vector\\=AV:N/AC:L/Au:M/C:P/I:P/A:C, web site last accessed December 19, 2014\\.### USE OF CRYPTOGRAPHICALLY WEAK PRNGCWE\\-338: Use of Cryptographically Weak Pseudo\\-Random Number Generator (PRNG), http://cwe.mitre.org/data/definitions/338\\.html, web site last accessed December 19, 2014\\. Prior to NTP\\-4\\.2\\.7p230, ntp\\-keygen used a weak seed to prepare a random number generator. The random numbers produced were then used to generate symmetric keys. This vulnerability was resolved with NTP\\-dev4\\.2\\.7p230 on November 1, 2010\\. CVE\\-2014\\-9294NVD, http://web.nvd.nist.gov/view/vuln/detail?vulnId\\=CVE\\-2014\\-9294, web site last accessed February 04, 2015\\. has been assigned by CERT/CC to this vulnerability. A CVSS v2 base score of 7\\.3 has been assigned; the CVSS vector string is (AV:N/AC:L/Au:M/C:P/I:P/A:C).CVSS Calculator, http://nvd.nist.gov/cvss.cfm?version\\=2\\&vector\\=AV:N/AC:L/Au:M/C:P/I:P/A:C, web site last accessed February 04, 2015\\.### STACK\\-BASED BUFFER OVERFLOWSCWE\\-121: Stack\\-Based Buffer Overflow, http://cwe.mitre.org/data/definitions/121\\.html, web site last accessed February 04, 2015\\. A remote attacker can send a carefully crafted packet that can overflow a stack buffer and potentially allow malicious code to be executed with the privilege level of the ntpd process. All NTP4 releases before 4\\.2\\.8 are vulnerable. This vulnerability is resolved with NTP\\-stable4\\.2\\.8 on December 19, 2014\\. CVE\\-2014\\-9295NVD, http://web.nvd.nist.gov/view/vuln/detail?vulnId\\=CVE\\-2014\\-9295, web site last accessed February 04, 2015\\. has been assigned by CERT/CC to this vulnerability. A CVSS v2 base score of 7\\.5 has been assigned; the CVSS vector string is (AV:N/AC:L/Au:N/C:P/I:P/A:P).CVSS Calculator, http://nvd.nist.gov/cvss.cfm?version\\=2\\&vector\\=AV:N/AC:L/Au:N/C:P/I:P/A:P, web site last accessed February 04, 2015\\.### MISSING RETURN ON ERRORCWE\\-389: Error Conditions, Return Values, Status Codes, http://cwe.mitre.org/data/definitions/389\\.html, web site last accessed February 04, 2015\\. In the NTP code, a section of code is missing a return, and the resulting error indicates processing did not stop. This indicated a specific rare error occurred, which does not appear to affect system integrity. All NTP Version 4 releases before Version 4\\.2\\.8 are vulnerable. This vulnerability is resolved with NTP\\-stable4\\.2\\.8 on December 19, 2014\\. CVE\\-2014\\-9296NVD, http://web.nvd.nist.gov/view/vuln/detail?vulnId\\=CVE\\-2014\\-9296, web site last accessed February 04, 2015\\. has been assigned by CERT/CC to this vulnerability. A CVSS v2 base score of 5\\.0 has been assigned; the CVSS vector string is (AV:N/AC:L/Au:N/C:N/I:N/A:P).CVSS Calculator, http://nvd.nist.gov/cvss.cfm?version\\=2\\&vector\\=AV:N/AC:L/Au:N/C:N/I:N/A:P, web site last accessed February 04, 2015\\.### AUTHENTICATION BYPASS BY SPOOFINGCWE\\-290: Authentication Bypass by Spoofing, http://cwe.mitre.org/data/definitions/290\\.html, web site last accessed February 04, 2015\\. The IPv6 address ::1 can be spoofed, allowing an attacker to bypass access control lists (ACLs) based on ::1\\. All NTP4 releases before 4\\.2\\.8 are vulnerable. Linux and slightly older Mac OSX kernels are vulnerable, but other tested OSes are not vulnerable to the ::1 spoofing. Proper firewall rulings can mitigate this problem. As this issue may be a kernel issue, rather than NTPD, source\\-IP based ACLs may be vulnerable as well. This vulnerability is resolved with NTP\\-stable4\\.2\\.8p1 on February 04, 2014\\. CVE\\-2014\\-9297NVD, http://web.nvd.nist.gov/view/vuln/detail?vulnId\\=CVE\\-2014\\-9297, NIST uses this advisory to create the CVE web site report. This web site will be active sometime after publication of this advisory. has been assigned by CERT/CC to this vulnerability. A CVSS v2 base score of 9\\.0 has been assigned; the CVSS vector string is (AV:N/AC:L/Au:N/C:P/I:P/A:C).CVSS Calculator, http://nvd.nist.gov/cvss.cfm?version\\=2\\&vector\\=AV:N/AC:L/Au:N/C:P/I:P/A:C, web site last accessed February 04, 2015\\.### IMPROPER CHECK FOR UNUSUAL OR EXCEPTIONAL CONDITIONSCWE\\-754: Improper Check for Unusual or Exceptional Conditions, http://cwe.mitre.org/data/definitions/754\\.html, web site last accessed February 04, 2015\\. The length value in extension field pointers is not properly validated, allowing information leaks. All NTP Version 4 releases before Version 4\\.2\\.8 are vulnerable. This vulnerability is resolved with NTP\\-stable4\\.2\\.8p1 on February 04, 2015\\. CVE\\-2014\\-9298NVD, http://web.nvd.nist.gov/view/vuln/detail?vulnId\\=CVE\\-2014\\-9298, NIST uses this advisory to create the CVE web site report. This web site will be active sometime after publication of this advisory. has been assigned by CERT/CC to this vulnerability. A CVSS v2 base score of 7\\.5 has been assigned; the CVSS vector string is (AV:N/AC:L/Au:N/C:P/I:P/A:P).CVSS Calculator, http://nvd.nist.gov/cvss.cfm?version\\=2\\&vector\\=AV:N/AC:L/Au:N/C:P/I:P/A:P, web site last accessed February 04, 2015\\.### VULNERABILITY DETAILS#### EXPLOITABILITY These vulnerabilities could be exploited remotely.#### EXISTENCE OF EXPLOIT No known public exploits specifically target these vulnerabilities.#### DIFFICULTY An attacker with a low skill and an exploit script would be able to exploit these vulnerabilities. However, a higher\\-level of skill would be necessary to craft usable exploit scripts.MITIGATION---------- All NTP Version 4 releases, prior to Version 4\\.2\\.8p1, are vulnerable and need to be updated to Version 4\\.2\\.8p1\\. ICS\\-CERT strongly encourages CIKR users to backup current operational ICS configurations, and thoroughly test the updated software for system compatibility on a test system before attempting deployment on operational systems. CERT/CC has published a Vulnerability Note at the following URL:<http://www.kb.cert.org/vuls/id/852879> ICS\\-CERT would like to thank [Network Time Foundations](http://nwtime.org/)  \u2019 NTP Project for coordinating with the Google Security Team Researchers. The latest NTP security information and software releases can be accessed at:<http://support.ntp.org/Main/SecurityNotice><http://support.ntp.org/bin/view/Main/SoftwareDownloads> . The NTP project recommends updating firewall rules to disallow ::1 packets from incoming physical Ethernet ports (mitigation for CVE\\-2014\\-9297\\). ICS\\-CERT also encourages asset owners to take additional defensive measures to protect against this and other cybersecurity risks.* Minimize network exposure for all control system devices and/or systems, and ensure that they are not accessible from the Internet.* Locate control system networks and remote devices behind firewalls, and isolate them from the business network.* When remote access is required, use secure methods, such as Virtual Private Networks (VPNs), recognizing that VPNs may have vulnerabilities and should be updated to the most current version available. Also recognize that VPN is only as secure as the connected devices. Additional mitigation guidance and recommended practices are publicly available in the following two publications:* Best Practices for Improved Robustness of Time and Frequency Source in Fixed Locations, that is available for download from the ICS\\-CERT web site [https://ics\\-cert.us\\-cert.gov/Other\\-Reports](/ics/Other-Reports)  ).* ICS\u2011CERT Technical Information Paper, [ICS\\-TIP\\-12\\-146\\-01B\\-\\-Targeted Cyber Intrusion Detection and Mitigation Strategies](/ics/tips/ICS-TIP-12-146-01B)  , that is available for download from the ICS\\-CERT web site ( [http://ics\\-cert.us\\-cert.gov/](/ics/)  ). ICS\\-CERT also provides a section for control systems security recommended practices on the ICS\\-CERT web page at: [http://ics\\-cert.us\\-cert.gov/content/recommended\\-practices](/ics/content/recommended-practices)  . Several recommended practices are available for reading and download, including [Improving Industrial Control Systems Cybersecurity with Defense\\-in\\-Depth Strategies.](/sites/default/files/recommended_practices/NCCIC_ICS-CERT_Defense_in_Depth_2016_S508C.pdf)  ICS\\-CERT reminds organizations to perform proper impact analysis and risk assessment prior to deploying defensive measures. Organizations observing any suspected malicious activity should follow their established internal procedures and report their findings to ICS\\-CERT for tracking and correlation against other incidents. This product is provided subject to this [Notification](/notification \"Follow link\")  and this [Privacy \\& Use](/privacy-policy \"Follow link\")  policy.Vendor------* Other-------------------------- [product survey](https://www.surveymonkey.com/r/CISA-cyber-survey?product=https://www.cisa.gov/news-events/ics-advisories/icsa-14-353-01c)  ; Related Advisories------------------ Jul 18, 2024 ICS Advisory \\| ICSA\\-24\\-200\\-01### [Mitsubishi Electric MELSOFT MaiLab](/news-events/ics-advisories/icsa-24-200-01) Jul 18, 2024 ICS Advisory \\| ICSA\\-24\\-200\\-02### [Subnet Solutions PowerSYSTEM Center](/news-events/ics-advisories/icsa-24-200-02) Jul 16, 2024 ICS Advisory \\| ICSA\\-24\\-198\\-01### [Rockwell Automation Pavilion 8](/news-events/ics-advisories/icsa-24-198-01) Jul 11, 2024 ICS Advisory \\| ICSA\\-24\\-193\\-01### [Siemens Remote Connect Server](/news-events/ics-advisories/icsa-24-193-01)* [Resources \\& Tools](/resources-tools)* [News \\& Events](/news-events)[Cybersecurity \\& Infrastructure Security Agency](/ \"Go to the Cybersecurity & Infrastructure Security Agency homepage\")[1\\-844\\-Say\\-CISA](tel:1-844-Say-CISA) * [Equal Opportunity \\& Accessibility](/oedia \"Equal Opportunity & Accessibility\")",
  "cves": [
    "CVE-2014-9296",
    "CVE-2014-9293",
    "CVE-2014-9294",
    "CVE-2014-9297",
    "CVE-2014-9298",
    "CVE-2014-9295"
  ],
  "techniques": [],
  "advisory": "icsa-14-353-01c",
  "title": "Network Time Protocol Vulnerabilities (Update C) | CISA",
  "source": "ics-advisories",
  "id": "d57e7590a1aef3e73cf5ef71545bf1dff9b893004b19c7eead13353a24baf4e2"
}