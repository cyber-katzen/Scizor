{"markdown": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n People's Republic of China\\-Linked Cyber Actors Hide in Router Firmware \\| CISA\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[Skip to main content](#main) \n\n\n\n\n\n\n\n\n\n\n\n\n![U.S. flag](/profiles/cisad8_gov/themes/custom/gesso/dist/images/us_flag_small.png)\n\n\n\n An official website of the United States government\n \n\n\n\n Here\u2019s how you know\n \n\n\n\n\n\n Here\u2019s how you know\n \n\n\n\n\n\n\n![Dot gov](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-dot-gov.svg)\n\n\n**Official websites use .gov** \n  \n\n A\n **.gov** \n website belongs to an official government organization in the United States.\n \n\n\n\n\n\n![HTTPS](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-https.svg)\n\n\n**Secure .gov websites use HTTPS** \n  \n\n A\n **lock** \n (\n \n\n\n Lock\n \n\n A locked padlock\n \n\n\n\n\n ) or\n **https://** \n means you\u2019ve safely connected to the .gov website. Share sensitive information only on official, secure websites.\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools \"Free Cyber Services\") \n[\\#protect2024](/protect2024) \n[Secure Our World](/node/18883) \n[Shields Up](/node/8056) \n[Report A Cyber Issue](/node/16591) \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[![CISA Logo Americas Cyber Defense Agency](/sites/default/files/images/SVG/header_logo_tagline_update.svg)](/)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[![CISA Logo](/sites/default/files/images/SVG/mobile_logo_wordmark.svg)](/)\n\n\n\n\n\n\n\n\n\n\n Search\n \n\n\n\n\n\n\n\n\n\n Menu\n \n\n\n\n\n\n\n\n\n\n\n\n\n![America's Cyber Defense Agency](/sites/default/files/images/SVG/header_tagline_mobile_update.svg)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Close\n \n\n\n\n\n* Topics\n \n\n\n\n[Topics](/topics) \n\n\n\n\n[Cybersecurity Best Practices](/topics/cybersecurity-best-practices)\n\n\n\n\n[Cyber Threats and Advisories](/topics/cyber-threats-and-advisories)\n\n\n\n\n[Critical Infrastructure Security and Resilience](/topics/critical-infrastructure-security-and-resilience)\n\n\n\n\n[Election Security](/topics/election-security)\n\n\n\n\n[Emergency Communications](/topics/emergency-communications)\n\n\n\n\n[Industrial Control Systems](/topics/industrial-control-systems)\n\n\n\n\n[Information and Communications Technology Supply Chain Security](/topics/information-communications-technology-supply-chain-security)\n\n\n\n\n[Partnerships and Collaboration](/topics/partnerships-and-collaboration)\n\n\n\n\n[Physical Security](/topics/physical-security)\n\n\n\n\n[Risk Management](/topics/risk-management)\n\n\n\n\n\n[How can we help?](/audiences) \n\n\n[Government](/topics/government) \n[Educational Institutions](/topics/educational-institutions) \n[Industry](/topics/industry) \n[State, Local, Tribal, and Territorial](/topics/state-local-tribal-and-territorial) \n[Individuals and Families](/topics/individuals-and-families) \n[Small and Medium Businesses](/topics/small-and-medium-businesses) \n[Find Help Locally](/audiences/find-help-locally) \n[Faith\\-Based Community](/audiences/faith-based-community) \n[Executives](/audiences/executives) \n[High\\-Risk Communities](/audiences/high-risk-communities)\n* [Spotlight](/spotlight)\n* Resources \\& Tools\n \n\n\n\n[Resources \\& Tools](/resources-tools) \n\n\n\n\n[All Resources \\& Tools](/resources-tools/all-resources-tools)\n\n\n\n\n[Services](/resources-tools/services)\n\n\n\n\n[Programs](/resources-tools/programs)\n\n\n\n\n[Resources](/resources-tools/resources)\n\n\n\n\n[Training](/resources-tools/training)\n\n\n\n\n[Groups](/resources-tools/groups)\n* News \\& Events\n \n\n\n\n[News \\& Events](/news-events) \n\n\n\n\n[News](/news-events/news)\n\n\n\n\n[Events](/news-events/events)\n\n\n\n\n[Cybersecurity Alerts \\& Advisories](/news-events/cybersecurity-advisories)\n\n\n\n\n[Directives](/news-events/directives)\n\n\n\n\n[Request a CISA Speaker](/news-events/request-speaker)\n\n\n\n\n[Congressional Testimony](/news-events/congressional-testimony)\n\n\n\n\n[CISA Conferences](/cisa-conferences)\n\n\n\n\n[CISA Live!](/cisa-live)\n* Careers\n \n\n\n\n[Careers](/careers) \n\n\n\n\n[Benefits \\& Perks](/careers/benefits-perks)\n\n\n\n\n[HireVue Applicant Reasonable Accommodations Process](/careers/hirevue-applicant-reasonable-accommodations-process)\n\n\n\n\n[Hiring](/general-recruitment-and-hiring-faqs)\n\n\n\n\n[Resume \\& Application Tips](/careers/resume-application-tips)\n\n\n\n\n[Students \\& Recent Graduates](/students-recent-graduates-employment-opportunities)\n\n\n\n\n[Veteran and Military Spouses](/careers/veteran-and-military-spouse-employment-opportunities)\n\n\n\n\n[Work @ CISA](/careers/work-cisa)\n* About\n \n\n\n\n[About](/about) \n\n\n\n\n[Culture](/about/culture)\n\n\n\n\n[Divisions \\& Offices](/about/divisions-offices)\n\n\n\n\n[Regions](/about/regions)\n\n\n\n\n[Leadership](/about/leadership)\n\n\n\n\n[Doing Business with CISA](/doing-business-cisa)\n\n\n\n\n[Site Links](/site-links)\n\n\n\n\n[Reporting Employee and Contractor Misconduct](/reporting-employee-and-contractor-misconduct)\n\n\n\n\n[CISA GitHub](/cisa-github)\n\n\n\n\n[CISA Central](/cisa-central)\n\n\n\n\n[2023 Year In Review](/about/2023YIR)\n\n\n\n\n[Contact Us](/about/contact-us)\n\n\n\n\n\n\n\n\n\n[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools \"Free Cyber Services\") \n[\\#protect2024](/protect2024) \n[Secure Our World](/node/18883) \n[Shields Up](/node/8056) \n[Report A Cyber Issue](/node/16591) \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Breadcrumb\n \n1. [Home](/)\n2. [News \\& Events](/news-events)\n3. [Cybersecurity Advisories](/news-events/cybersecurity-advisories)\n4. [Cybersecurity Advisory](/news-events/cybersecurity-advisories?f%5B0%5D=advisory_type%3A94)\n\n\n\n\n\n\n\n\n Share:\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Cybersecurity Advisory\n \nPeople's Republic of China\\-Linked Cyber Actors Hide in Router Firmware\n=======================================================================\n\n\n\n\n\n Release Date\n \n\n\n September 27, 2023\n \n\n\n\n\n Alert Code\n \n\n AA23\\-270A\n \n\n\n\n\n Related topics:\n \n\n[Malware, Phishing, and Ransomware](/topics/cyber-threats-and-advisories/malware-phishing-and-ransomware) \n ,\n [Cyber Threats and Advisories](/topics/cyber-threats-and-advisories) \n ,\n [Securing Networks](/topics/cyber-threats-and-advisories/securing-networks) \n\n\n\n\n\n\n\n\n\n\n\n\n\n### **Executive Summary**\n\n\n\n The United States National Security Agency (NSA), the U.S. Federal Bureau of Investigation (FBI), the U.S. Cybersecurity and Infrastructure Security Agency (CISA), the Japan National Police Agency (NPA), and the Japan National Center of Incident Readiness and Strategy for Cybersecurity (NISC) (hereafter referred to as the \u201cauthoring agencies\u201d) are releasing this joint cybersecurity advisory (CSA) to detail activity of the People\u2019s Republic of China (PRC)\\-linked cyber actors known as BlackTech. BlackTech has demonstrated capabilities in modifying router firmware without detection and exploiting routers\u2019 domain\\-trust relationships for pivoting from international subsidiaries to headquarters in Japan and the U.S. \u2014 the primary targets. The authoring agencies recommend implementing the mitigations described to detect this activity and protect devices from the backdoors the BlackTech actors are leaving behind.\n \n\n\n\n BlackTech (a.k.a. Palmerworm, Temp.Overboard, Circuit Panda, and Radio Panda) actors have targeted government, industrial, technology, media, electronics, and telecommunication sectors, including entities that support the militaries of the U.S. and Japan. BlackTech actors use custom malware, dual\\-use tools, and living off the land tactics, such as disabling logging on routers, to conceal their operations. This CSA details BlackTech\u2019s tactics, techniques, and procedures (TTPs), which highlights the need for multinational corporations to review all subsidiary connections, verify access, and consider implementing Zero Trust models to limit the extent of a potential BlackTech compromise.\n \n\n\n\n For more information on the risks posed by this deep level of unauthorized access, see the CSA\n [People\u2019s Republic of China State\\-Sponsored Cyber Actors Exploit Network Providers and Devices](https://www.cisa.gov/news-events/cybersecurity-advisories/aa22-158a \"People\u2019s Republic of China State-Sponsored Cyber Actors Exploit Network Providers and Devices\") \n .\\[\n [1](https://media.defense.gov/2022/Jun/07/2003013376/-1/-1/0/CSA_PRC_SPONSORED_CYBER_ACTORS_EXPLOIT_NETWORK_PROVIDERS_DEVICES_TLPWHITE.PDF \"People\u2019s Republic of China State-Sponsored Cyber Actors Exploit Network Providers and Devices\") \n ]\n \n\n\n\n Download the PDF version of this report:\n [PDF, 808 KB](https://media.defense.gov/2023/Sep/27/2003309107/-1/-1/0/CSA_BLACKTECH_HIDE_IN_ROUTERS_TLP-CLEAR.PDF \"People's Republic of China-Linked Cyber Actors Hide in Router Firmware\") \n\n\n\n### **Technical Details**\n\n\n\n This advisory uses the\n [MITRE\n \u00ae \n ATT\\&CK\n \u00ae \n for Enterprise](https://attack.mitre.org/versions/v13/matrices/enterprise \"Enterprise Matrix\") \n framework, version 13\\.1\\. See the Appendix: MITRE ATT\\&CK Techniques for all referenced TTPs.\n \n\n\n#### ***Background***\n\n\n\n Active since 2010, BlackTech actors have historically targeted a wide range of U.S. and East Asia public organizations and private industries. BlackTech actors\u2019 TTPs include developing customized malware and tailored persistence mechanisms for compromising routers. These TTPs allow the actors to disable logging \\[\n [T1562](https://attack.mitre.org/versions/v13/techniques/T1562/ \"Impair Defenses\") \n ] and abuse trusted domain relationships \\[\n [T1199](https://attack.mitre.org/versions/v13/techniques/T1199/ \"Trusted Relationship\") \n ] to pivot between international subsidiaries and domestic headquarters\u2019 networks.\n \n\n\n#### ***Observable TTPs***\n\n\n\n BlackTech cyber actors use custom malware payloads and remote access tools (RATs) to target victims\u2019 operating systems. The actors have used a range of custom malware families targeting Windows\n \u00ae \n , Linux\n \u00ae \n , and FreeBSD\n \u00ae \n operating systems. Custom malware families employed by BlackTech include:\n \n\n\n* BendyBear \\[\n [S0574](https://attack.mitre.org/versions/v13/software/S0574/ \"BendyBear\") \n ]\n* Bifrose\n* BTSDoor\n* FakeDead (a.k.a. TSCookie) \\[\n [S0436](https://attack.mitre.org/versions/v13/software/S0436/ \"TSCookie\") \n ]\n* Flagpro \\[\n [S0696](https://attack.mitre.org/versions/v13/software/S0696/ \"Flagpro\") \n ]\n* FrontShell (FakeDead\u2019s downloader module)\n* IconDown\n* PLEAD \\[\n [S0435](https://attack.mitre.org/versions/v13/software/S0435/ \"PLEAD\") \n ]\n* SpiderPig\n* SpiderSpring\n* SpiderStack\n* WaterBear \\[\n [S0579](https://attack.mitre.org/versions/v13/software/S0579/ \"Waterbear\") \n ]\n\n\n\n BlackTech actors continuously update these tools to evade detection \\[\n [TA0005](https://attack.mitre.org/versions/v13/tactics/TA0005/ \"Defense Evasion\") \n ] by security software. The actors also use stolen code\\-signing certificates \\[\n [T1588\\.003](https://attack.mitre.org/versions/v13/techniques/T1588/003/ \"Obtain Capabilities: Code Signing Certificates\") \n ] to sign the malicious payloads, which make them appear legitimate and therefore more difficult for security software to detect \\[\n [T1553\\.002](https://attack.mitre.org/versions/v13/techniques/T1553/002/ \"Subvert Trust Controls: Code Signing\") \n ].\n \n\n\n\n BlackTech actors use living off the land TTPs to blend in with normal operating system and network activities, allowing them to evade detection by endpoint detection and response (EDR) products. Common methods of persistence on a host include NetCat shells, modifying the victim registry \\[\n [T1112](https://attack.mitre.org/versions/v13/techniques/T1112/ \"Modify Registry\") \n ] to enable the remote desktop protocol (RDP) \\[\n [T1021\\.001](https://attack.mitre.org/versions/v13/techniques/T1021/001/ \"Remote Services: Remote Desktop Protocol\") \n ], and secure shell (SSH) \\[\n [T1021\\.004](https://attack.mitre.org/versions/v13/techniques/T1021/004/ \"Remote Services: SSH\") \n ]. The actors have also used SNScan for enumeration \\[\n [TA0007](https://attack.mitre.org/versions/v13/tactics/TA0007/ \"Discovery\") \n ], and a local file transfer protocol (FTP) server \\[\n [T1071\\.002](https://attack.mitre.org/versions/v13/techniques/T1071/002/ \"Application Layer Protocol: File Transfer Protocols\") \n ] to move data through the victim network. For additional examples of malicious cyber actors living off the land, see\n [People's Republic of China State\\-Sponsored Cyber Actor Living off the Land to Evade Detection](https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-144a \"People's Republic of China State-Sponsored Cyber Actor Living off the Land to Evade Detection\") \n .\\[\n [2](https://media.defense.gov/2023/May/24/2003229517/-1/-1/0/CSA_PRC_State_Sponsored_Cyber_Living_off_the_Land_v1.1.PDF \"People's Republic of China State-Sponsored Cyber Actor Living off the Land to Evade Detection\") \n ]\n \n\n\n#### ***Pivoting from international subsidiaries***\n\n\n\n The PRC\\-linked BlackTech actors target international subsidiaries of U.S. and Japanese companies. After gaining access \\[\n [TA0001](https://attack.mitre.org/versions/v13/tactics/TA0001/ \"Initial Access\") \n ] to the subsidiaries\u2019 internal networks, BlackTech actors are able to pivot from the trusted internal routers to other subsidiaries of the companies and the headquarters\u2019 networks. BlackTech actors exploit trusted network relationships between an established victim and other entities to expand their access in target networks.\n \n\n\n\n Specifically, upon gaining an initial foothold into a target network and gaining administrator access to network edge devices, BlackTech cyber actors often modify the firmware to hide their activity across the edge devices to further maintain persistence in the network. To extend their foothold across an organization, BlackTech actors target branch routers\u2014typically smaller appliances used at remote branch offices to connect to a corporate headquarters\u2014and then abuse the trusted relationship \\[\n [T1199](https://attack.mitre.org/versions/v13/techniques/T1199/ \"Trusted Relationship\") \n ] of the branch routers within the corporate network being targeted. BlackTech actors then use the compromised public\\-facing branch routers as part of their infrastructure for proxying traffic \\[\n [TA0011](https://attack.mitre.org/versions/v13/tactics/TA0011/ \"Command and Control\") \n ], blending in with corporate network traffic, and pivoting to other victims on the same corporate network \\[\n [T1090\\.002](https://attack.mitre.org/versions/v13/techniques/T1090/002/ \"Proxy: External Proxy\") \n ].\n \n\n\n#### ***Maintaining access via stealthy router backdoors***\n\n\n\n BlackTech has targeted and exploited various brands and versions of router devices. TTPs against routers enable the actors to conceal configuration changes, hide commands, and disable logging while BlackTech actors conduct operations. BlackTech actors have compromised several Cisco\n \u00ae \n routers using variations of a customized firmware backdoor \\[\n [T1542\\.004](https://attack.mitre.org/versions/v13/techniques/T1542/004/ \"Pre-OS Boot: ROMMONkit\") \n ]. The backdoor functionality is enabled and disabled through specially crafted TCP or UDP packets \\[\n [T1205](https://attack.mitre.org/versions/v13/techniques/T1205/ \"Traffic Signaling\") \n ]. This TTP is not solely limited to Cisco routers, and similar techniques could be used to enable backdoors in other network equipment.\n \n\n\n\n In some cases, BlackTech actors replace the firmware for certain Cisco IOS\n \u00ae \n \\-based routers with malicious firmware. Although BlackTech actors already had elevated privileges \\[\n [TA0004](https://attack.mitre.org/versions/v13/tactics/TA0004/ \"Privilege Escalation\") \n ] on the router to replace the firmware via command\\-line execution, the malicious firmware is used to establish persistent backdoor access \\[\n [TA0003](https://attack.mitre.org/versions/v13/tactics/TA0003/ \"Persistence\") \n ] and obfuscate future malicious activity. The modified firmware uses a built\\-in SSH backdoor \\[\n [T1556\\.004](https://attack.mitre.org/versions/v13/techniques/T1556/004/ \"Modify Authentication Process: Network Device Authentication\") \n ], allowing BlackTech actors to maintain access to the compromised router without BlackTech connections being logged \\[\n [T1562\\.003](https://attack.mitre.org/versions/v13/techniques/T1562/003/ \"Impair Defenses: Impair Command History Logging\") \n ]. BlackTech actors bypass the router's built\\-in security features by first installing older legitimate firmware \\[\n [T1601\\.002](https://attack.mitre.org/versions/v13/techniques/T1601/002/ \"Modify System Image: Downgrade System Image\") \n ] that they then modify in memory to allow the installation of a modified, unsigned bootloader and modified, unsigned firmware \\[\n [T1601\\.001](https://attack.mitre.org/versions/v13/techniques/T1601/001/ \"Modify System Image: Patch System Image\") \n ]. The modified bootloader enables the modified firmware to continue evading detection \\[\n [T1553\\.006](https://attack.mitre.org/versions/v13/techniques/T1553/006/ \"Subvert Trust Controls: Code Signing Policy Modification\") \n ], however, it is not always necessary.\n \n\n\n\n BlackTech actors may also hide their presence and obfuscate changes made to compromised Cisco routers by hiding Embedded Event Manager (EEM) policies\u2014a feature usually used in Cisco IOS to automate tasks that execute upon specified events\u2014that manipulate Cisco IOS Command\\-Line Interface (CLI) command results. On a compromised router, the BlackTech\\-created EEM policy waits for specific commands to execute obfuscation measures or deny execution of specified legitimate commands. This policy has two functions: (1\\) to remove lines containing certain strings in the output of specified, legitimate Cisco IOS CLI commands \\[\n [T1562\\.006](https://attack.mitre.org/versions/v13/techniques/T1562/006/ \"Impair Defenses: Indicator Blocking\") \n ], and (2\\) prevent the execution of other legitimate CLI commands, such as hindering forensic analysis by blocking copy, rename, and move commands for the associated EEM policy \\[\n [T1562\\.001](https://attack.mitre.org/versions/v13/techniques/T1562/001/ \"Impair Defenses: Disable or Modify Tools\") \n ].\n \n\n\n##### **Firmware replacement process**\n\n\n\n BlackTech actors utilize the following file types to compromise the router. These files are downloaded to the router via FTP or SSH.\n \n\n\n\n\n\n*Table 1: File types to compromise the router* \n\n| **File Type** | **Description** |\n| --- | --- |\n| Old Legitimate Firmware | The IOS image firmware is modified in memory to allow installation of the Modified Firmware and Modified Bootloader. |\n| Modified Firmware | The firmware has a built\\-in SSH backdoor, allowing operators to have unlogged interaction with the router. |\n| Modified Bootloader | The bootloader allows Modified Firmware to continue evading the router's security features for persistence across reboots. In some cases, only modified firmware is used. |\n\n\n\n BlackTech actors use the Cisco router's CLI to replace the router\u2019s IOS image firmware. The process begins with the firmware being modified in memory\u2014also called hot patching\u2014to allow the installation of a modified bootloader and modified firmware capable of bypassing the router\u2019s security features. Then, a specifically constructed packet triggers the router to enable the backdoor that bypasses logging and the access control list (ACL). The steps are as follows:\n \n\n\n1. Download old legitimate firmware.\n2. Set the router to load the old legitimate firmware and reboot with the following command(s):\n \n\n\n\n| `config t`   `no boot system usbflash0 [filename]`   `boot system usbflash0 [filename]`   `end`   `write`   `reload` |\n| --- |\n3. Download the modified bootloader and modified firmware.\n4. Set the router to load the modified firmware with the following command(s):\n \n\n\n\n| `conf t`   `no boot system usbflash0 [filename]`   `boot system usbflash0 [filename]`   `end`   `write` |\n| --- |\n5. Load the modified bootloader (the router reboots automatically) with the following command:\n \n\n\n\n| `upgrade rom file bootloader` |\n| --- |\n6. Enable access by sending a trigger packet that has specific values within the UDP data or TCP Sequence Number field and the Maximum Segment Size (MSS) parameter within the TCP Options field.\n\n\n##### Modified bootloader\n\n\n\n To allow the modified bootloader and firmware to be installed on Cisco IOS without detection, the cyber actors install an old, legitimate firmware and then modify that running firmware in memory to bypass firmware signature checks in the Cisco ROM Monitor (ROMMON) signature validation functions. The modified version\u2019s instructions allow the actors to bypass functions of the IOS Image Load test and the Field Upgradeable ROMMON Integrity test.\n \n\n\n##### Modified firmware\n\n\n\n BlackTech actors install modified IOS image firmware that allows backdoor access via SSH to bypass the router\u2019s normal logging functions. The firmware consists of a Cisco IOS loader that will load an embedded IOS image.\n \n\n\n\n BlackTech actors hook several functions in the embedded Cisco IOS image to jump to their own code. They overwrite existing code to handle magic packet checking, implement an SSH backdoor, and bypass logging functionality on the compromised router. The modified instructions bypass command logging, IP address ACLs, and error logging.\n \n\n\n\n To enable the backdoor functions, the firmware checks for incoming trigger packets and enables or disables the backdoor functionality. When the backdoor is enabled, associated logging functions on the router are bypassed. The source IP address is stored and used to bypass ACL handling for matching packets. The SSH backdoor includes a special username that does not require additional authentication.\n \n\n\n#### **Detection and Mitigation Techniques**\n\n\n\n In order to detect and mitigate this BlackTech malicious activity, the authoring agencies strongly recommend the following detection and mitigation techniques. It would be trivial for the BlackTech actors to modify values in their backdoors that would render specific signatures of this router backdoor obsolete. For more robust detection, network defenders should monitor network devices for unauthorized downloads of bootloaders and firmware images and reboots. Network defenders should also monitor for unusual traffic destined to the router, including SSH.\n \n\n\n\n The following are the best mitigation practices to defend against this type of malicious activity:\n \n\n\n* Disable outbound connections by applying the \"transport output none\" configuration command to the virtual teletype (VTY) lines. This command will prevent some copy commands from successfully connecting to external systems.\n   \n\n**Note:** \n An adversary with unauthorized privileged level access to a network device could revert this configuration change.\\[\n [3](https://media.defense.gov/2022/Jun/15/2003018261/-1/-1/0/CTR_NSA_NETWORK_INFRASTRUCTURE_SECURITY_GUIDE_20220615.PDF \"Network Infrastructure Security Guide\") \n ]\n* Monitor both inbound and outbound connections from network devices to both external and internal systems. In general, network devices should only be connecting to nearby devices for exchanging routing or network topology information or with administrative systems for time synchronization, logging, authentication, monitoring, etc. If feasible, block unauthorized outbound connections from network devices by applying access lists or rule sets to other nearby network devices. Additionally, place administrative systems in separate virtual local area networks (VLANs) and block all unauthorized traffic from network devices destined for non\\-administrative VLANs.\\[\n [4](https://media.defense.gov/2020/Sep/17/2002499616/-1/-1/0/PERFORMING_OUT_OF_BAND_NETWORK_MANAGEMENT20200911.PDF \"Performing Out-of-Band Network Management\") \n ]\n* Limit access to administration services and only permit IP addresses used by network administrators by applying access lists to the VTY lines or specific services. Monitor logs for successful and unsuccessful login attempts with the \"login on\\-failure log\" and \"login on\\-success log\" configuration commands, or by reviewing centralized Authentication, Authorization, and Accounting (AAA) events.\\[\n [3](https://media.defense.gov/2022/Jun/15/2003018261/-1/-1/0/CTR_NSA_NETWORK_INFRASTRUCTURE_SECURITY_GUIDE_20220615.PDF \"Network Infrastructure Security Guide\") \n ]\n* Upgrade devices to ones that have secure boot capabilities with better integrity and authenticity checks for bootloaders and firmware. In particular, highly prioritize replacing all end\\-of\\-life and unsupported equipment as soon as possible.\\[\n [3](https://media.defense.gov/2022/Jun/15/2003018261/-1/-1/0/CTR_NSA_NETWORK_INFRASTRUCTURE_SECURITY_GUIDE_20220615.PDF \"Network Infrastructure Security Guide\") \n ],\\[\n [5](https://community.cisco.com/t5/security-blogs/attackers-continue-to-target-legacy-devices/ba-p/4169954 \"Attackers Continue to Target Legacy Devices\") \n ]\n* When there is a concern that a single password has been compromised, change all passwords and keys.\\[\n [3](https://media.defense.gov/2022/Jun/15/2003018261/-1/-1/0/CTR_NSA_NETWORK_INFRASTRUCTURE_SECURITY_GUIDE_20220615.PDF \"Network Infrastructure Security Guide\") \n ]\n* Review logs generated by network devices and monitor for unauthorized reboots, operating system version changes, changes to the configuration, or attempts to update the firmware. Compare against expected configuration changes and patching plans to verify that the changes are authorized.\\[\n [3](https://media.defense.gov/2022/Jun/15/2003018261/-1/-1/0/CTR_NSA_NETWORK_INFRASTRUCTURE_SECURITY_GUIDE_20220615.PDF \"Network Infrastructure Security Guide\") \n ]\n* Periodically perform both file and memory verification described in the Network Device Integrity (NDI) Methodology documents to detect unauthorized changes to the software stored and running on network devices.\\[\n [3](https://media.defense.gov/2022/Jun/15/2003018261/-1/-1/0/CTR_NSA_NETWORK_INFRASTRUCTURE_SECURITY_GUIDE_20220615.PDF \"Network Infrastructure Security Guide\") \n ]\n* Monitor for changes to firmware. Periodically take snapshots of boot records and firmware and compare against known good images.\\[\n [3](https://media.defense.gov/2022/Jun/15/2003018261/-1/-1/0/CTR_NSA_NETWORK_INFRASTRUCTURE_SECURITY_GUIDE_20220615.PDF \"Network Infrastructure Security Guide\") \n ]\n\n\n#### **Works Cited**\n\n\n\n \\[1]\u00a0\u00a0 \u00a0Joint CSA, People\u2019s Republic of China State\\-Sponsored Cyber Actors Exploit Network Providers and Devices,\n [https://media.defense.gov/2022/Jun/07/2003013376/\\-1/\\-1/0/CSA\\_PRC\\_SPONSORED\\_CYBER\\_ACTORS\\_EXPLOIT\\_NETWORK\\_PROVIDERS\\_DEVICES\\_TLPWHITE.PDF](https://media.defense.gov/2022/Jun/07/2003013376/-1/-1/0/CSA_PRC_SPONSORED_CYBER_ACTORS_EXPLOIT_NETWORK_PROVIDERS_DEVICES_TLPWHITE.PDF \"People\u2019s Republic of China State-Sponsored Cyber Actors Exploit Network Providers and Devices\") \n  \n\n \\[2]\u00a0\u00a0 \u00a0Joint CSA, People's Republic of China State\\-Sponsored Cyber Actor Living off the Land to Evade Detection,\n [https://media.defense.gov/2023/May/24/2003229517/\\-1/\\-1/0/CSA\\_PRC\\_State\\_Sponsored\\_Cyber\\_Living\\_off\\_the\\_Land\\_v1\\.1\\.PDF](https://media.defense.gov/2023/May/24/2003229517/-1/-1/0/CSA_PRC_State_Sponsored_Cyber_Living_off_the_Land_v1.1.PDF \"People's Republic of China State-Sponsored Cyber Actor Living off the Land to Evade Detection\") \n  \n\n \\[3]\u00a0\u00a0 \u00a0NSA, Network Infrastructure Security Guide,\n [https://media.defense.gov/2022/Jun/15/2003018261/\\-1/\\-1/0/CTR\\_NSA\\_NETWORK\\_INFRASTRUCTURE\\_SECURITY\\_GUIDE\\_20220615\\.PDF](https://media.defense.gov/2022/Jun/15/2003018261/-1/-1/0/CTR_NSA_NETWORK_INFRASTRUCTURE_SECURITY_GUIDE_20220615.PDF \"Network Infrastructure Security Guide\") \n  \n\n \\[4]\u00a0\u00a0 \u00a0NSA, Performing Out\\-of\\-Band Network Management,\n [https://media.defense.gov/2020/Sep/17/2002499616/\\-1/\\-1/0/PERFORMING\\_OUT\\_OF\\_BAND\\_NETWORK\\_MANAGEMENT20200911\\.PDF](https://media.defense.gov/2020/Sep/17/2002499616/-1/-1/0/PERFORMING_OUT_OF_BAND_NETWORK_MANAGEMENT20200911.PDF \"Performing Out-of-Band Network Management\") \n  \n\n \\[5]\u00a0\u00a0 \u00a0Cisco, Attackers Continue to Target Legacy Devices,\n [https://community.cisco.com/t5/security\\-blogs/attackers\\-continue\\-to\\-target\\-legacy\\-devices/ba\\-p/4169954](https://community.cisco.com/t5/security-blogs/attackers-continue-to-target-legacy-devices/ba-p/4169954 \"Attackers Continue to Target Legacy Devices\") \n\n\n\n##### **Disclaimer of endorsement**\n\n\n\n The information and opinions contained in this document are provided \"as is\" and without any warranties or guarantees. Reference herein to any specific commercial products, process, or service by trade name, trademark, manufacturer, or otherwise, does not constitute or imply its endorsement, recommendation, or favoring by the United States Government or Japan, and this guidance shall not be used for advertising or product endorsement purposes.\n \n\n\n##### **Trademark recognition**\n\n\n\n Cisco and Cisco IOS are registered trademarks of Cisco Technology, Inc.\n   \n\n FreeBSD is a registered trademark of The FreeBSD Foundation.\n   \n\n Linux is a registered trademark of Linus Torvalds.\n   \n\n MITRE and MITRE ATT\\&CK are registered trademarks of The MITRE Corporation.\n   \n\n Windows is a registered trademark of Microsoft Corporation.\n \n\n\n##### Purpose\n\n\n\n This document was developed in furtherance of the authoring agencies\u2019 cybersecurity missions, including their responsibilities to identify and disseminate cyber threats, and to develop and issue cybersecurity specifications and mitigations.\n \n\n\n##### **Contact**\n\n\n\n NSA Cybersecurity Report Questions and Feedback: CybersecurityReports@nsa.gov\n   \n\n NSA\u2019s Defense Industrial Base Inquiries and Cybersecurity Services: DIB\\_Defense@cyber.nsa.gov\n   \n\n NSA Media Inquiries / Press Desk: 443\\-634\\-0721, MediaRelations@nsa.gov\n \n\n\n\n**U.S. organizations:** \n Organizations can also report anomalous cyber activity and/or cyber incidents 24/7 to\n [report@cisa.gov](mailto:report@cisa.gov) \n or by calling 1\\-844\\-Say\\-CISA (1\\-844\\-729\\-2472\\) and/or to the FBI via your local FBI field office.\n \n\n\n### **Appendix: MITRE ATT\\&CK Techniques**\n\n\n\n See Tables 2\\-9 for all referenced BlackTech tactics and techniques in this advisory.\n \n\n\n\n\n\n*Table 2: BlackTech ATT\\&CK Techniques for Enterprise \u2013 Resource Development* \n\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| Obtain Capabilities: Code Signing Certificates | [T1588\\.003](https://attack.mitre.org/versions/v13/techniques/T1588/003/ \"Obtain Capabilities: Code Signing Certificates\") | BlackTech actors use stolen code\\-signing certificates to sign payloads and evade defenses. |\n\n\n\n\n\n*Table 3: BlackTech ATT\\&CK Techniques for Enterprise \u2013 Initial Access* \n\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| Initial Access | [TA0001](https://attack.mitre.org/versions/v13/tactics/TA0001/ \"Initial Access\") | BlackTech actors gain access to victim networks by exploiting routers. |\n| Trusted Relationship | [T1199](https://attack.mitre.org/versions/v13/techniques/T1199/ \"Trusted Relationship\") | BlackTech actors exploit trusted domain relationships of routers to gain access to victim networks. |\n\n\n\n\n\n*Table 4: BlackTech ATT\\&CK Techniques for Enterprise \u2013 Persistence* \n\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| Persistence | [TA0003](https://attack.mitre.org/versions/v13/tactics/TA0003/ \"Persistence\") | BlackTech actors gain persistent access to victims\u2019 networks. |\n| Traffic Signaling | [T1205](https://attack.mitre.org/versions/v13/techniques/T1205/ \"Traffic Signaling\") | BlackTech actors send specially crafted packets to enable or disable backdoor functionality on a compromised router. |\n| Pre\\-OS Boot: ROMMONkit | [T1542\\.004](https://attack.mitre.org/versions/v13/techniques/T1542/004/ \"Pre-OS Boot: ROMMONkit\") | BlackTech actors modify router firmware to maintain persistence. |\n\n\n\n\n\n*Table 5: BlackTech ATT\\&CK Techniques for Enterprise \u2013 Privilege Escalation* \n\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| Privilege Escalation | [TA0004](https://attack.mitre.org/versions/v13/tactics/TA0004/ \"Privilege Escalation\") | BlackTech actors gain elevated privileges on a victim\u2019s network. |\n\n\n\n\n\n*Table 6: BlackTech ATT\\&CK Techniques for Enterprise \u2013 Defense Evasion* \n\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| Defense Evasion | [TA0005](https://attack.mitre.org/versions/v13/tactics/TA0005/ \"Defense Evasion\") | BlackTech actors configure their tools to evade detection by security software and EDR. |\n| Modify Registry | [T1112](https://attack.mitre.org/versions/v13/techniques/T1112/ \"Modify Registry\") | BlackTech actors modify the victim\u2019s registry. |\n| Impair Defenses | [T1562](https://attack.mitre.org/versions/v13/techniques/T1562/ \"Impair Defenses\") | BlackTech actors disable logging on compromised routers to avoid detection and evade defenses. |\n| Impair Defenses: Impair Command History Logging | [T1562\\.003](https://attack.mitre.org/versions/v13/techniques/T1562/003/ \"Impair Defenses: Impair Command History Logging\") | BlackTech actors disable logging on the compromised routers to prevent logging of any commands issued. |\n| Modify System Image: Patch System Image | [T1601\\.001](https://attack.mitre.org/versions/v13/techniques/T1601/001/ \"Modify System Image: Patch System Image\") | BlackTech actors modify router firmware to evade detection. |\n\n\n\n\n\n*Table 7: BlackTech ATT\\&CK Techniques for Enterprise \u2013 Discovery* \n\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| Discovery | [TA0007](https://attack.mitre.org/versions/v13/tactics/TA0007/ \"Discovery\") | BlackTech actors use SNScan to enumerate victims\u2019 networks and obtain further network information. |\n\n\n\n\n\n*Table 8: BlackTech ATT\\&CK Techniques for Enterprise \u2013 Lateral Movement* \n\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| Remote Services: Remote Desktop Protocol | [T1021\\.001](https://attack.mitre.org/versions/v13/techniques/T1021/001/ \"Remote Services: Remote Desktop Protocol\") | BlackTech actors use RDP to move laterally across a victim\u2019s network. |\n| Remote Services: SSH | [T1021\\.004](https://attack.mitre.org/versions/v13/techniques/T1021/004/ \"Remote Services: SSH\") | BlackTech actors use SSH to move laterally across a victim\u2019s network. |\n\n\n\n\n\n*Table 9: BlackTech ATT\\&CK Techniques for Enterprise \u2013 Command and Control* \n\n| **Technique Title** | **ID** | **Use** |\n| --- | --- | --- |\n| Command and Control | [TA0011](https://attack.mitre.org/versions/v13/tactics/TA0011/ \"Command and Control\") | BlackTech actors compromise and control a victim\u2019s network infrastructure. |\n| Application Layer Protocol: File Transfer Protocols | [T1071\\.002](https://attack.mitre.org/versions/v13/techniques/T1071/002/ \"Application Layer Protocol: File Transfer Protocols\") | BlackTech actors use FTP to move data through a victim\u2019s network or to deliver scripts for compromising routers. |\n| Proxy | [T1090](https://attack.mitre.org/versions/v13/techniques/T1090/ \"Proxy\") | BlackTech actors use compromised routers to proxy traffic. |\n\n\n\n\n\n\n\n\n\n\n This product is provided subject to this\n [Notification](/notification \"Follow link\") \n and this\n [Privacy \\& Use](/privacy-policy \"Follow link\") \n policy.\n \n\n\n\n\n\n\n\n\n\n\n\n### Tags\n\n\n\n\n Topics\n \n\n[Malware, Phishing, and Ransomware](/topics/cyber-threats-and-advisories/malware-phishing-and-ransomware) \n ,\n [Cyber Threats and Advisories](/topics/cyber-threats-and-advisories) \n ,\n [Securing Networks](/topics/cyber-threats-and-advisories/securing-networks) \n\n\n\n\n Audience\n \n\n Federal Government, Industry\n \n\n\n\n Sector\n \n\n[Information Technology Sector](/topics/critical-infrastructure-security-and-resilience/critical-infrastructure-sectors/information-technology-sector) \n\n\n\n\n MITRE ATT\\&CK TTP\n \n\n Command and Control (TA0011\\), Defense Evasion (TA0005\\), Discovery (TA0007\\), Initial Access (TA0001\\), Lateral Movement (TA0008\\), Persistence (TA0003\\), Privilege Escalation (TA0004\\), Resource Development (TA0042\\)\n \n\n\n\n Co\\-Sealers and Partners\n \n\n Federal Bureau of Investigation, International\n \n\n\n\n Nation\\-State Actor\n \n\n China\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPlease share your thoughts\n--------------------------\n\n\n\n We recently updated our anonymous\n [product survey](https://www.surveymonkey.com/r/CISA-cyber-survey?product=https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-270a) \n ; we\u2019d welcome your feedback.\n \n\n\n\n\n\n\n\n\n\n\n\n\nRelated Advisories\n------------------\n\n\n\n\n\n\n\n\n\n\n Jul 11, 2024\n \n\n\n Cybersecurity Advisory \\| AA24\\-193A\n \n\n### [CISA Red Team\u2019s Operations Against a Federal Civilian Executive Branch Organization Highlights the Necessity of Defense\\-in\\-Depth](/news-events/cybersecurity-advisories/aa24-193a)\n\n\n\n\n\n\n\n\n\n\n\n Jul 08, 2024\n \n\n\n Cybersecurity Advisory \\| AA24\\-190A\n \n\n### [People\u2019s Republic of China (PRC) Ministry of State Security APT40 Tradecraft in Action](/news-events/cybersecurity-advisories/aa24-190a)\n\n\n\n\n\n\n\n\n\n\n\n May 10, 2024\n \n\n\n Cybersecurity Advisory \\| AA24\\-131A\n \n\n### [\\#StopRansomware: Black Basta](/news-events/cybersecurity-advisories/aa24-131a)\n\n\n\n\n\n\n\n\n\n\n\n Apr 18, 2024\n \n\n\n Cybersecurity Advisory \\| AA24\\-109A\n \n\n### [\\#StopRansomware: Akira Ransomware](/news-events/cybersecurity-advisories/aa24-109a)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[Return to top](#) \n\n\n\n\n* [Topics](/topics)\n* [Spotlight](/spotlight)\n* [Resources \\& Tools](/resources-tools)\n* [News \\& Events](/news-events)\n* [Careers](/careers)\n* [About](/about)\n\n\n\n\n\n\n\n\n[Cybersecurity \\& Infrastructure Security Agency](/ \"Go to the Cybersecurity & Infrastructure Security Agency homepage\")\n\n\n* [Facebook](https://www.facebook.com/CISA)\n* [Twitter](https://twitter.com/CISAgov)\n* [LinkedIn](https://www.linkedin.com/company/cybersecurity-and-infrastructure-security-agency)\n* [YouTube](https://www.youtube.com/@cisagov)\n* [Instagram](https://www.instagram.com/cisagov)\n* [RSS](/subscribe-updates-cisa)\n\n\n\n\n CISA Central\n \n[1\\-844\\-Say\\-CISA](tel:1-844-Say-CISA) \n[SayCISA@cisa.gov](mailto:SayCISA@cisa.gov) \n\n\n\n\n\n\n\n\n\n\n\n DHS Seal\n \n\n\n CISA.gov\n \n\n An official website of the U.S. Department of Homeland Security\n \n\n\n* [About CISA](/about \"About CISA\")\n* [Budget and Performance](https://www.dhs.gov/performance-financial-reports \"Budget and Performance\")\n* [DHS.gov](https://www.dhs.gov \"Department of Homeland Security\")\n* [Equal Opportunity \\& Accessibility](/oedia \"Equal Opportunity & Accessibility\")\n* [FOIA Requests](https://www.dhs.gov/foia \"FOIA Requests\")\n* [No FEAR Act](/no-fear-act \"No FEAR Act Reporting\")\n* [Office of Inspector General](https://www.oig.dhs.gov/ \"Office of Inspector General\")\n* [Privacy Policy](/privacy-policy \"Privacy Policy\")\n* [Subscribe](https://public.govdelivery.com/accounts/USDHSCISA/subscriber/new?topic_id=USDHSCISA_138 \"Subscribe to Email Updates\")\n* [The White House](https://www.whitehouse.gov/ \"The White House\")\n* [USA.gov](https://www.usa.gov/ \"USA.gov\")\n* [Website Feedback](/forms/feedback \"Website Feedback\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n", "cves": [], "techniques": ["T1562.003", "T1562.006", "T1090.002", "T1601.001", "T1553.006", "T1562.001", "T1553.002", "T1021.004", "T1556.004", "T1588.003", "T1021.001", "T1542.004", "T1601.002", "T1071.002"], "advisory": "aa23-270a", "title": "People's Republic of China-Linked Cyber Actors Hide in Router Firmware | CISA", "source": "cybersecurity-advisories", "id": "3c3d83fe195814e5b2af16afa007deea8088eec40ced4422ab9dc502291af6fd"}