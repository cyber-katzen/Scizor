{
  "markdown": " APT28 Exploits Known Vulnerability to Carry Out Reconnaissance and Deploy Malware on Cisco Routers \\| CISA A A ( Lock ) or[\\#protect2024](/protect2024)  Search Menu Close[Faith\\-Based Community](/audiences/faith-based-community) [High\\-Risk Communities](/audiences/high-risk-communities)* Resources \\& Tools[Resources \\& Tools](/resources-tools) [All Resources \\& Tools](/resources-tools/all-resources-tools)* News \\& Events[News \\& Events](/news-events) [Cybersecurity Alerts \\& Advisories](/news-events/cybersecurity-advisories)[Benefits \\& Perks](/careers/benefits-perks)[Resume \\& Application Tips](/careers/resume-application-tips)[Students \\& Recent Graduates](/students-recent-graduates-employment-opportunities)[Divisions \\& Offices](/about/divisions-offices)[\\#protect2024](/protect2024) 2. [News \\& Events](/news-events)4. [Cybersecurity Advisory](/news-events/cybersecurity-advisories?f%5B0%5D=advisory_type%3A94) Cybersecurity AdvisoryAPT28 Exploits Known Vulnerability to Carry Out Reconnaissance and Deploy Malware on Cisco Routers================================================================================================== Release Date April 18, 2023 Alert Code AA23\\-108 Related topics:### **APT28 accesses poorly maintained Cisco routers and deploys malware on unpatched devices using CVE\\-2017\\-6742\\.**#### **Overview and Context** The UK National Cyber Security Centre ( [NCSC](https://www.ncsc.gov.uk/ \"The National Cyber Security Centre\")  ), the US National Security Agency ( [NSA](https://www.nsa.gov/ \"National Security Agency/Central Security Service\")  ), US Cybersecurity and Infrastructure Security Agency ( [CISA](https://www.cisa.gov/ \"Cybersecurity & Infrastructure Security Agency\")  ) and US Federal Bureau of Investigation ( [FBI](https://www.fbi.gov/ \"Federal Bureau of Investigation\")  ) are releasing this joint advisory to provide details of tactics, techniques and procedures (TTPs) associated with APT28\u2019s exploitation of Cisco routers in 2021\\. We assess that [APT28 is almost certainly the Russian General Staff Main Intelligence Directorate (GRU) 85th special Service Centre (GTsSS) Military Intelligence Unit 26165](https://www.ncsc.gov.uk/news/reckless-campaign-cyber-attacks-russian-military-intelligence-service-exposed \"Reckless campaign of cyber attacks by Russian military intelligence service exposed\")  . APT28 (also known as Fancy Bear, STRONTIUM, Pawn Storm, the Sednit Gang and Sofacy) is a highly skilled threat actor. Download the UK PDF version of this report:[APT28 exploits known vulnerability to carry out reconnaissance and deploy malware on Cisco routers](/sites/default/files/2023-04/apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers-uk.pdf)  (PDF, 366\\.88 KB ) Download the US PDF version of this report:[APT28 Exploits Known Vulnerability to Carry Out Reconnaissance and Deploy Malware on Cisco Routers](/sites/default/files/2023-04/apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf)  (PDF, 366\\.25 KB )##### **Previous Activity** The NCSC has previously attributed the following activity to APT28:* [Cyber attacks against the German parliament in 2015](https://www.gov.uk/government/news/uk-enforces-new-sanctions-against-russia-for-cyber-attack-on-german-parliament \"UK enforces new sanctions against Russia for cyber attack on German Parliament\")  , including data theft and disrupting email accounts of German Members of Parliament (MPs) and the Vice Chancellor* [Attempted attack against the Organization for the Prohibition of Chemical Weapons (OPCW)](https://www.gov.uk/government/speeches/minister-for-europe-statement-attempted-hacking-of-the-opcw-by-russian-military-intelligence \"Minister for Europe statement: attempted hacking of the OPCW by Russian military intelligence\")  in April 2018, to disrupt independent analysis of chemicals weaponized by the GRU in the UK For more information on APT28 activity, see the advisory [Russian State\\-Sponsored and Criminal Cyber Threats to Critical Infrastructure](/news-events/cybersecurity-advisories/aa22-110a \"Russian State-Sponsored and Criminal Cyber Threats to Critical Infrastructure\")  and [Russian GRU Conducting Global Brute Force Campaign to Compromise Enterprise and Cloud Environments](https://media.defense.gov/2021/Jul/01/2002753896/-1/-1/1/CSA_GRU_GLOBAL_BRUTE_FORCE_CAMPAIGN_UOO158036-21.PDF \"Russian GRU Conducting Global Brute Force Campaign to Compromise Enterprise and Cloud Environments\")  . As of 2021, APT28 has been observed using commercially available code repositories, and post\\-exploit frameworks such as Empire. This included the use of PowerShell Empire, in addition to Python versions of Empire.#### **Reconnaissance**##### **Use of SNMP Protocol to Access Routers** In 2021, APT28 used infrastructure to masquerade Simple Network Management protocol (SNMP) access into Cisco routers worldwide. This included a small number based in Europe, US government institutions and approximately 250 Ukrainian victims. SNMP is designed to allow network administrators to monitor and configure network devices remotely, but it can also be misused to obtain sensitive network information and, if vulnerable, exploit devices to penetrate a network. A number of software tools can scan the entire network using SNMP, meaning that poor configuration such as using default or easy\\-to\\-guess community strings, can make a network susceptible to attacks. Weak SNMP community strings, including the default \"public,\" allowed APT28 to gain access to router information. APT28 sent additional SNMP commands to enumerate router interfaces. \\[ [T1078\\.001](https://attack.mitre.org/techniques/T1078/001/ \"Valid Accounts: Default Accounts\")  ] The compromised routers were configured to accept SNMP v2 requests. SNMP v2 doesn\u2019t support encryption and so all data, including community strings, is sent unencrypted. Exploitation of CVE\\-2017\\-6742 APT28 exploited the vulnerability [CVE\\-2017\\-6742 (Cisco Bug ID: CSCve54313\\)](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20170629-snmp \"SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software\")  \\[ [T1190](https://attack.mitre.org/techniques/T1190/ \"Exploit Public-Facing Application\")  ]. This vulnerability was first announced by Cisco on 29 June 2017, and patched software was made available. Cisco's published advisory provided workarounds, such as limiting access to SNMP from trusted hosts only, or by disabling a number of SNMP Management Information bases (MIBs).#### **Malware Deployment** For some of the targeted devices, APT28 actors used an SNMP exploit to deploy malware, as detailed in the NCSC\u2019s [**Jaguar Tooth Malware Analysis Report**](https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/jaguar-tooth/NCSC-MAR-Jaguar-Tooth.pdf \"Jaguar Tooth\") . This malware obtained further device information, which is exfiltrated over trivial file transfer protocol (TFTP), and enabled unauthenticated access via a backdoor. The actor obtained this device information by executing a number of Command Line Interface (CLI) commands via the malware. It includes discovery of other devices on the network by querying the Address Resolution Protocol (ARP) table to obtain MAC addresses. \\[ [T1590](https://attack.mitre.org/techniques/T1590/ \"Gather Victim Network Information\")  ]#### **Indicators of Compromise (IoCs)** Please refer to the accompanying [Malware Analysis Report](https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/jaguar-tooth/NCSC-MAR-Jaguar-Tooth.pdf \"Jaguar Tooth\")  for indicators of compromise which may help to detect this activity.#### **MITRE ATT\\&CK\u00ae** This advisory has been compiled with respect to the [MITRE ATT\\&CK\u00ae](https://attack.mitre.org/ \"MITRE ATT&CK\u00ae\")  framework, a globally accessible knowledge base of adversary tactics and techniques based on real\\-world observations. For detailed TTPs, see the [Malware Analysis Report](https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/jaguar-tooth/NCSC-MAR-Jaguar-Tooth.pdf \"Jaguar Tooth\")  .| **Tactic** | **ID** | **Technique** | **Procedure** || --- | --- | --- | --- || **Initial Access** | [T1190](https://attack.mitre.org/techniques/T1190/ \"Exploit Public-Facing Application\") | Exploit Public\\-facing Application. | APT28 exploited default/well\\-known community strings in SNMP as outlined in CVE\\-2017\\-6742 (Cisco Bug ID: CSCve54313\\). || **Initial Access** | [T1078\\.001](https://attack.mitre.org/techniques/T1078/001/ \"Valid Accounts: Default Accounts\") | Valid Accounts: Default Accounts. | Actors accessed victim routers by using default community strings such as \u201cpublic.\u201d || **Reconnaissance** | [T1590](https://attack.mitre.org/techniques/T1590/ \"Gather Victim Network Information\") | Gather Victim Network Information | Access was gained to perform reconnaissance on victim devices. Further detail of how this was achieved in available in the MITRE ATT\\&CK section of the Jaguar Tooth MAR. |#### **Conclusion** APT28 has been known to access vulnerable routers by using default and weak SNMP community strings, and by exploiting CVE\\-2017\\-6742 (Cisco Bug ID: CSCve54313\\) as published by Cisco. TTPs in this advisory may still be used against vulnerable Cisco devices. Organizations are advised to follow the mitigation advice in this advisory to defend against this activity.##### **Reporting** UK organizations should [report](https://www.gov.uk/guidance/where-to-report-a-cyber-incident \"Where to Report a Cyber Incident\")  any suspected compromises to the NCSC. US Organizations can also report anomalous cyber activity and/or cyber incidents 24/7 to [report@cisa.gov](mailto:report@cisa.gov)  or by calling 1\\-844\\-Say\\-CISA (1\\-844\\-729\\-2472\\).#### **Mitigation** Mitigation* [Patch devices as advised by Cisco](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20170629-snmp \"SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software\")  . The NCSC also has [general guidance on managing updates and keeping software up to date](https://www.ncsc.gov.uk/collection/device-security-guidance/managing-deployed-devices/keeping-devices-and-software-up-to-date \"Keeping devices and software up to date\")  .* Do not use SNMP if you are not required to configure or manage devices remotely to prevent unauthorized users from accessing your router.\t+ If you are required to manage routers remotely, establish allow and deny lists for SNMP messages to prevent unauthorized users from accessing your router.* Do not allow unencrypted (i.e., plaintext) management protocols, such as SNMP v2 and Telnet. Where encrypted protocols aren\u2019t possible, you should carry out any management activities from outside the organization through an encrypted virtual private network (VPN), where both ends are mutually authenticated.* [Enforce a strong password policy](https://www.ncsc.gov.uk/collection/passwords \"Password administration for system owners\")  . Don\u2019t reuse the same password for multiple devices. Each device should have a unique password. Where possible, avoid legacy password\\-based authentication and implement two\\-factor authentication based on public\\-private key.* Disable legacy unencrypted protocols such as Telnet and SNMP v1 or v2c. Where possible, use modern encrypted protocols such as SSH and SNMP v3\\. Harden the encryption protocols based on current best security practice. The NCSC strongly advises owners and operators to retire and replace legacy devices that can\u2019t be configured to use SNMP v3\\.* Use logging tools to record commands executed on your network devices, such as TACACS\\+ and Syslog. Use these logs to immediately highlight suspicious events and keep a record of events to support an investigation if the device\u2019s integrity is ever in question. See [NCSC guidance on monitoring and logging](https://www.ncsc.gov.uk/collection/device-security-guidance/managing-deployed-devices/logging-and-protective-monitoring \"Logging and protective monitoring\")  .* If you suspect your router has been compromised:\t+ Follow\t [Cisco\u2019s advice](https://sec.cloudapps.cisco.com/security/center/resources/integrity_assurance.html \"Cisco IOS Software Integrity Assurance\") \t for verifying the Cisco IOS image.\t+ Revoke all keys associated with that router. When replacing the router configuration be sure to create new keys rather than pasting from the old configuration.\t+ Replace both the ROMMON and Cisco IOS image with an image that has been sourced directly from the Cisco website, in case third party and internal repositories have been compromised.* [NSA\u2019s Network Infrastructure guide](https://media.defense.gov/2022/Jun/15/2003018261/-1/-1/0/CTR_NSA_NETWORK_INFRASTRUCTURE_SECURITY_GUIDE_20220615.PDF \"Network Infrastructure Security Guide\")  provides some best practices for SNMP.* See also the [Cisco IOS hardening guide](https://www.cisco.com/c/en/us/support/docs/ip/access-lists/13608-21.html \"Cisco Guide to Harden Cisco IOS Devices\")  and [Cisco\u2019s Jaguar Tooth blog](https://blogs.cisco.com/security/threat-actors-exploiting-snmp-vulnerabilities-in-cisco-routers)  . This product is provided subject to this [Notification](https://edit.us-cert.gov/privacy/notification)  and this [Privacy \\& Use](https://www.dhs.gov/privacy-policy)  policy. This product is provided subject to this [Notification](/notification \"Follow link\")  and this [Privacy \\& Use](/privacy-policy \"Follow link\")  policy.### Tags Topics Audience Federal Government MITRE ATT\\&CK TTP Defense Evasion (TA0005\\), Initial Access (TA0001\\), Persistence (TA0003\\), Privilege Escalation (TA0004\\), Reconnaissance (TA0043\\) Co\\-Sealers and Partners Federal Bureau of Investigation, International, National Security Agency Nation\\-State Actor Russia-------------------------- [product survey](https://www.surveymonkey.com/r/CISA-cyber-survey?product=https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-108)  ; Related Advisories------------------ Jul 11, 2024 Cybersecurity Advisory \\| AA24\\-193A### [CISA Red Team\u2019s Operations Against a Federal Civilian Executive Branch Organization Highlights the Necessity of Defense\\-in\\-Depth](/news-events/cybersecurity-advisories/aa24-193a) Jul 08, 2024 Cybersecurity Advisory \\| AA24\\-190A### [People\u2019s Republic of China (PRC) Ministry of State Security APT40 Tradecraft in Action](/news-events/cybersecurity-advisories/aa24-190a) May 10, 2024 Cybersecurity Advisory \\| AA24\\-131A### [\\#StopRansomware: Black Basta](/news-events/cybersecurity-advisories/aa24-131a) Apr 18, 2024 Cybersecurity Advisory \\| AA24\\-109A### [\\#StopRansomware: Akira Ransomware](/news-events/cybersecurity-advisories/aa24-109a)* [Resources \\& Tools](/resources-tools)* [News \\& Events](/news-events)[Cybersecurity \\& Infrastructure Security Agency](/ \"Go to the Cybersecurity & Infrastructure Security Agency homepage\")[1\\-844\\-Say\\-CISA](tel:1-844-Say-CISA) * [Equal Opportunity \\& Accessibility](/oedia \"Equal Opportunity & Accessibility\")",
  "cves": [
    "CVE-2017-6742"
  ],
  "techniques": [
    "T1078.001"
  ],
  "advisory": "aa23-108",
  "title": "APT28 Exploits Known Vulnerability to Carry Out Reconnaissance and Deploy Malware on Cisco Routers | CISA",
  "source": "cybersecurity-advisories",
  "id": "040a0c09c648576ef044c5717e9feb419d5d34ad81491ea76d3d7a2554a71fcb"
}