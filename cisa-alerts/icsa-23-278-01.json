{
  "markdown": " Hitachi Energy AFS65x, AFF66x, AFS67x, and AFR67x Series Products \\| CISA A A ( Lock ) or[\\#protect2024](/protect2024)  Search Menu Close[Faith\\-Based Community](/audiences/faith-based-community) [High\\-Risk Communities](/audiences/high-risk-communities)* Resources \\& Tools[Resources \\& Tools](/resources-tools) [All Resources \\& Tools](/resources-tools/all-resources-tools)* News \\& Events[News \\& Events](/news-events) [Cybersecurity Alerts \\& Advisories](/news-events/cybersecurity-advisories)[Benefits \\& Perks](/careers/benefits-perks)[Resume \\& Application Tips](/careers/resume-application-tips)[Students \\& Recent Graduates](/students-recent-graduates-employment-opportunities)[Divisions \\& Offices](/about/divisions-offices)[\\#protect2024](/protect2024) 2. [News \\& Events](/news-events) ICS AdvisoryHitachi Energy AFS65x, AFF66x, AFS67x, and AFR67x Series Products================================================================= Release Date October 05, 2023 Alert Code ICSA\\-23\\-278\\-01**[View CSAF](https://github.com/cisagov/CSAF)**1\\. EXECUTIVE SUMMARY---------------------* **CVSS v3 9\\.8*** **ATTENTION**  : Exploitable remotely/low attack complexity* **Vendor**  : Hitachi Energy* **Equipment**  : AFS65x, AFF66x, AFS67x, AFR67x Series* **Vulnerabilities**  : Incorrect Calculation, Integer Overflow or Wraparound, Improper Encoding or Escaping of Output, Exposure of Resource to Wrong Sphere2\\. RISK EVALUATION------------------- Successful exploitation of these vulnerabilities by an attacker could have a high impact on availability, integrity, and confidentiality of the targeted devices.3\\. TECHNICAL DETAILS---------------------### 3\\.1 AFFECTED PRODUCTS The following Hitachi Energy products and versions are affected:* AFF66X FW: 03\\.0\\.02 and prior* AFS66X\\-S: All versions* AFS660\\-C: All versions* AFS66X\\-B: All versions* AFS670\\-V20: All versions* AFS65X: All versions* AFS67X: All versions* AFR677: All versions### 3\\.2 Vulnerability Overview**3\\.2\\.1 [INCORRECT CALCULATION CWE\\-682](https://cwe.mitre.org/data/definitions/682.html)** In Expat (aka libexpat) before 2\\.4\\.3, a left shift by 29(or more) places in the storeAtts function in xmlparse.c can lead to realloc misbehavior (e.g., allocating too few bytes, or only freeing memory).[CVE\\-2021\\-45960](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2021-45960)  has been assigned to this vulnerability. A CVSS v3 base score of 8\\.8 has been calculated; the CVSS vector string is ( [AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)  ).**3\\.2\\.2 [INTEGER OVERFLOW OR WRAPAROUND CWE\\-190](https://cwe.mitre.org/data/definitions/190.html)** In doProlog in xmlparse.c in Expat (aka libexpat) before 2\\.4\\.3, an integer overflow exists for m\\_groupSize.[CVE\\-2021\\-46143](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2021-46143)  has been assigned to this vulnerability. A CVSS v3 base score of 7\\.8 has been calculated; the CVSS vector string is ( [AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)  ).**3\\.2\\.3 [INTEGER OVERFLOW OR WRAPAROUND CWE\\-190](https://cwe.mitre.org/data/definitions/190.html)** Vulnerable code using addBinding in xmlparse.c in Expat (aka libexpat) before 2\\.4\\.3 has an integer overflow.[CVE\\-2022\\-22822](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2022-22822)  has been assigned to this vulnerability. A CVSS v3 base score of 9\\.8 has been calculated; the CVSS vector string is ( [AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  ).**3\\.2\\.4 [INTEGER OVERFLOW OR WRAPAROUND CWE\\-190](https://cwe.mitre.org/data/definitions/190.html)** Vulnerable code using build\\_model in xmlparse.c in Expat (aka libexpat) before 2\\.4\\.3 has an integer overflow.[CVE\\-2022\\-22823](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2022-22823)  has been assigned to this vulnerability. A CVSS v3 base score of 9\\.8 has been calculated; the CVSS vector string is ( [AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  ).**3\\.2\\.5 [INTEGER OVERFLOW OR WRAPAROUND CWE\\-190](https://cwe.mitre.org/data/definitions/190.html)** Vulnerable code using defineAttribute in xmlparse.c in Expat (aka libexpat) before 2\\.4\\.3 has an integer overflow.[CVE\\-2022\\-22824](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2022-22824)  has been assigned to this vulnerability. A CVSS v3 base score of 9\\.8 has been calculated; the CVSS vector string is ( [AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  ).**3\\.2\\.6 [INTEGER OVERFLOW OR WRAPAROUND CWE\\-190](https://cwe.mitre.org/data/definitions/190.html)** The lookup in xmlparse.c in Expat (aka libexpat) before 2\\.4\\.3 has an integer overflow.[CVE\\-2022\\-22825](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2022-22825)  has been assigned to this vulnerability. A CVSS v3 base score of 8\\.8 has been calculated; the CVSS vector string is ( [AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)  ).**3\\.2\\.7 [INTEGER OVERFLOW OR WRAPAROUND CWE\\-190](https://cwe.mitre.org/data/definitions/190.html)** Vulnerable code using nextScaffoldPart in xmlparse.c in Expat (aka libexpat) before 2\\.4\\.3 has an integer overflow[CVE\\-2022\\-22826](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2022-22826)  has been assigned to this vulnerability. A CVSS v3 base score of 8\\.8 has been calculated; the CVSS vector string is ( [AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)  ).**3\\.2\\.8 [INTEGER OVERFLOW OR WRAPAROUND CWE\\-190](https://cwe.mitre.org/data/definitions/190.html)** An insecure direct object reference for the file\\-download URL in Synametrics SynaMan before 5\\.0 allows a remote attacker to access unshared files via a modified base64\\-encoded filename string.[CVE\\-2022\\-22827](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2022-22827)  has been assigned to this vulnerability. A CVSS v3 base score of 7\\.5 has been calculated; the CVSS vector string is ( [AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N)  ).**3\\.2\\.9 [INTEGER OVERFLOW OR WRAPAROUND CWE\\-190](https://cwe.mitre.org/data/definitions/190.html)** In Expat (aka libexpat) before 2\\.4\\.5, there is an integer overflow in copyString.[CVE\\-2022\\-25314](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2022-25314)  has been assigned to this vulnerability. A CVSS v3 base score of 7\\.5 has been calculated; the CVSS vector string is ( [AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H)  ).**3\\.2\\.10 [INTEGER OVERFLOW OR WRAPAROUND CWE\\-190](https://cwe.mitre.org/data/definitions/190.html)** In Expat (aka libexpat) before 2\\.4\\.5, there is an integer overflow in storeRawNames[CVE\\-2022\\-25315](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2022-25315)  has been assigned to this vulnerability. A CVSS v3 base score of 9\\.8 has been calculated; the CVSS vector string is ( [AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  ).**3\\.2\\.11 [IMPROPER ENCODING OR ESCAPING OF OUTPUT CWE\\-116](https://cwe.mitre.org/data/definitions/116.html)** Vulnerable code in xmltok\\_impl.c in Expat (aka libexpat) before 2\\.4\\.5 lacks certain validation of encoding, such as checks for whether a UTF\\-8 character is valid in a certain context.[CVE\\-2022\\-25235](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2022-25235)  has been assigned to this vulnerability. A CVSS v3 base score of 9\\.8 has been calculated; the CVSS vector string is ( [AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  ).**3\\.2\\.12 [EXPOSURE OF RESOURCE TO WRONG SPHERE CWE\\-668](https://cwe.mitre.org/data/definitions/668.html)** Vulnerable code in xmlparse.c in Expat (aka libexpat) before 2\\.4\\.5 allows attackers to insert namespace\\-separator characters into namespace URIs.[CVE\\-2022\\-25236](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2022-25236)  has been assigned to this vulnerability. A CVSS v3 base score of 9\\.8 has been calculated; the CVSS vector string is ( [AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  ).**3\\.2\\.13 [INTEGER OVERFLOW OR WRAPAROUND CWE\\-190](https://cwe.mitre.org/data/definitions/190.html)** Expat (aka libexpat) before 2\\.4\\.4 has a signed integer overflow in XML\\_GetBuffer, for configurations with a nonzero XML\\_CONTEXT\\_BYTES[CVE\\-2022\\-23852](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2022-23852)  has been assigned to this vulnerability. A CVSS v3 base score of 9\\.8 has been calculated; the CVSS vector string is ( [AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  ).**3\\.2\\.14 [INTEGER OVERFLOW OR WRAPAROUND CWE\\-190](https://cwe.mitre.org/data/definitions/190.html)** Expat (aka libexpat) before 2\\.4\\.4 has an integer overflow in the doProlog function.[CVE\\-2022\\-23990](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2022-23990)  has been assigned to this vulnerability. A CVSS v3 base score of 7\\.5 has been calculated; the CVSS vector string is ( [AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H)  ).### 3\\.3 BACKGROUND* **CRITICAL INFRASTRUCTURE SECTORS:**  Energy* **COUNTRIES/AREAS DEPLOYED:**  Worldwide* **COMPANY HEADQUARTERS LOCATION:**  Switzerland### 3\\.4 RESEARCHER Hitachi Energy reported these vulnerabilities to CISA.4\\. MITIGATIONS--------------- Hitachi energy recommends the following actions:* AFF66X FW 03\\.0\\.02 and earlier:\t+ For all vulnerabilities, apply mitigation strategy as described in Hitachi Energy's general mitigation factors below or update to upcoming AFF66X 04\\.x.xx FW when released.* AFS66X\\-S, AFS660\\-C, AFS66X\\-B, AFS670\\-V20 devices:\t+ For all vulnerabilities, apply mitigation strategy as described in Hitachi Energy's general mitigation factors below or update to upcoming AFS66X, AFS670\\-V20 7\\.1\\.08 FW when released.\t+ Disable HTTP/HTTPS server or restrict access to HTTP/HTTPS to trusted IP addresses.\t+ Disable IEC61850\\-MMS server or restrict access to IEC61850\\-MMS to trusted IP addresses.* AFS65X, AFS67X, AFR677 devices:\t+ For all vulnerabilities, apply mitigation strategy as described in Hitachi Energy's general mitigation factors below or update to AFS65X, AFS67X, AFR677 09\\.1\\.08 FW.\t+ Disable HTTP/HTTPS server or restrict access to HTTP/HTTPS to trusted IP addresses.\t+ Disable IEC61850\\-MMS server. Hitachi Energy's general mitigation factors: Security practices and firewall configurations can help protect a process control network from attacks that originate from outside the network. Such practices include that process control systems are physically protected from direct access by unauthorized personnel, have no direct connections to the Internet, and are separated from other networks by means of a firewall system that has a minimal number of ports exposed, and others that have to be evaluated case by case. Process control systems should not be used for Internet surfing, instant messaging, or receiving e\\-mails. Portable computers and removable storage media should be carefully scanned for viruses before they are connected to a control system. For more information, please visit Hitachi Energy's [Advisory](https://publisher.hitachienergy.com/preview?DocumentId=8DBD000165&DocumentRevisionId=B&languageCode=en&Preview=true)  . CISA recommends users take defensive measures to minimize the risk of exploitation of these vulnerabilities. CISA reminds organizations to perform proper impact analysis and risk assessment prior to deploying defensive measures. CISA also provides a section for [control systems security recommended practices](https://www.cisa.gov/resources-tools/resources/ics-recommended-practices)  on the ICS webpage on [cisa.gov/ics](https://www.cisa.gov/topics/industrial-control-systems)  . Several CISA products detailing cyber defense best practices are available for reading and download, including [Improving Industrial Control Systems Cybersecurity with Defense\\-in\\-Depth Strategies](https://us-cert.cisa.gov/sites/default/files/recommended_practices/NCCIC_ICS-CERT_Defense_in_Depth_2016_S508C.pdf)  . CISA encourages organizations to implement recommended cybersecurity strategies for [proactive defense of ICS assets](https://www.cisa.gov/sites/default/files/publications/Cybersecurity_Best_Practices_for_Industrial_Control_Systems.pdf)  . Additional mitigation guidance and recommended practices are publicly available on the ICS webpage at [cisa.gov/ics](https://www.cisa.gov/topics/industrial-control-systems)  in the technical information paper, [ICS\\-TIP\\-12\\-146\\-01B\\-\\-Targeted Cyber Intrusion Detection and Mitigation Strategies](https://www.cisa.gov/uscert/ics/tips/ICS-TIP-12-146-01B)  . Organizations observing suspected malicious activity should follow established internal procedures and report findings to CISA for tracking and correlation against other incidents. CISA also recommends users take the following measures to protect themselves from social engineering attacks:* Do not click web links or open attachments in unsolicited email messages.* Refer to [Recognizing and Avoiding Email Scams](https://www.cisa.gov/uscert/sites/default/files/publications/emailscams0905.pdf)  for more information on avoiding email scams.* Refer to [Avoiding Social Engineering and Phishing Attacks](https://www.cisa.gov/uscert/ncas/tips/ST04-014)  for more information on social engineering attacks. No known public exploitation specifically targeting these vulnerabilities has been reported to CISA at this time.5\\. UPDATE HISTORY------------------* October 5, 2023: Initial Publication This product is provided subject to this [Notification](/notification \"Follow link\")  and this [Privacy \\& Use](/privacy-policy \"Follow link\")  policy.Vendor------* Hitachi Energy-------------------------- [product survey](https://www.surveymonkey.com/r/CISA-cyber-survey?product=https://www.cisa.gov/news-events/ics-advisories/icsa-23-278-01)  ; Related Advisories------------------ Jul 18, 2024 ICS Advisory \\| ICSA\\-24\\-200\\-01### [Mitsubishi Electric MELSOFT MaiLab](/news-events/ics-advisories/icsa-24-200-01) Jul 18, 2024 ICS Advisory \\| ICSA\\-24\\-200\\-02### [Subnet Solutions PowerSYSTEM Center](/news-events/ics-advisories/icsa-24-200-02) Jul 16, 2024 ICS Advisory \\| ICSA\\-24\\-198\\-01### [Rockwell Automation Pavilion 8](/news-events/ics-advisories/icsa-24-198-01) Jul 11, 2024 ICS Advisory \\| ICSA\\-24\\-193\\-01### [Siemens Remote Connect Server](/news-events/ics-advisories/icsa-24-193-01)* [Resources \\& Tools](/resources-tools)* [News \\& Events](/news-events)[Cybersecurity \\& Infrastructure Security Agency](/ \"Go to the Cybersecurity & Infrastructure Security Agency homepage\")[1\\-844\\-Say\\-CISA](tel:1-844-Say-CISA) * [Equal Opportunity \\& Accessibility](/oedia \"Equal Opportunity & Accessibility\")",
  "cves": [
    "CVE-2022-22823",
    "CVE-2021-46143",
    "CVE-2022-22824",
    "CVE-2022-23852",
    "CVE-2022-25314",
    "CVE-2022-25235",
    "CVE-2022-22827",
    "CVE-2022-23990",
    "CVE-2022-22825",
    "CVE-2022-22826",
    "CVE-2022-22822",
    "CVE-2022-25315",
    "CVE-2021-45960",
    "CVE-2022-25236"
  ],
  "techniques": [],
  "advisory": "icsa-23-278-01",
  "title": "Hitachi Energy AFS65x, AFF66x, AFS67x, and AFR67x Series Products | CISA",
  "source": "ics-advisories",
  "id": "672c060acb24abd08d4ed0676322e8d555fd3005158d95a816c33190cf8cfa50"
}