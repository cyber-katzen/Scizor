{
  "markdown": "\nbody#cma-body { font-family: Franklin Gothic Medium, Franklin Gothic, ITC Franklin Gothic, Arial, sans-serif; font-size: 15px; } table#cma-table { width: 900px; margin: 2px; table-layout: fixed; border-collapse: collapse; } div#cma-exercise { width: 900px; height: 30px; text-align: center; line-height: 30px; font-weight: bold; font-size: 18px; } div.cma-header { text-align: center; margin-bottom: 40px; } div.cma-footer { text-align: center; margin-top: 20px; } h2.cma-tlp { background-color: #000; color: #ffffff; width: 180px; height: 30px; text-align: center; line-height: 30px; font-weight: bold; font-size: 18px; float: right; } span.cma-fouo { line-height: 30px; font-weight: bold; font-size: 16px; } h3.cma-section-title { font-size: 18px; font-weight: bold; padding: 0 10px; margin-top: 10px; } h4.cma-object-title { font-size: 16px; font-weight: bold; margin-left: 20px; } h5.cma-data-title { padding: 3px 0 3px 10px; margin: 10px 0 0 20px; background-color: #e7eef4; font-size: 15px; } p.cma-text { margin: 5px 0 0 25px !important; word-wrap: break-word !important; } div.cma-section { border-bottom: 5px solid #aaa; margin: 5px 0; padding-bottom: 10px; } div.cma-avoid-page-break { page-break-inside: avoid; } div#cma-summary { page-break-after: always; } div#cma-faq { page-break-after: always; } table.cma-content { border-collapse: collapse; margin-left: 20px; } table.cma-hashes { table-layout: fixed; width: 880px; } table.cma-hashes td{ width: 780px; word-wrap: break-word; } .cma-left th { text-align: right; vertical-align: top; padding: 3px 8px 3px 20px; background-color: #f0f0f0; border-right: 1px solid #aaa; } .cma-left td { padding-left: 8px; } .cma-color-title th, .cma-color-list th, .cma-color-title-only th { text-align: left; padding: 3px 0 3px 20px; background-color: #f0f0f0; } .cma-color-title td, .cma-color-list td, .cma-color-title-only td { padding: 3px 20px; } .cma-color-title tr:nth-child(odd) { background-color: #f0f0f0; } .cma-color-list tr:nth-child(even) { background-color: #f0f0f0; } td.cma-relationship { max-width: 310px; word-wrap: break-word; } ul.cma-ul { margin: 5px 0 10px 0; } ul.cma-ul li { line-height: 20px; margin-bottom: 5px; word-wrap: break-word; } #cma-survey { font-weight: bold; font-style: italic; } div.cma-banner-container { position: relative; text-align: center; color: white; } img.cma-banner { max-width: 900px; height: auto; } img.cma-nccic-logo { max-height: 60px; width: auto; float: left; margin-top: -15px; } div.cma-report-name { position: absolute; bottom: 32px; left: 12px; font-size: 20px; } div.cma-report-number { position: absolute; bottom: 70px; right: 100px; font-size: 18px; } div.cma-report-date { position: absolute; bottom: 32px; right: 100px; font-size: 18px; } img.cma-thumbnail { max-height: 100px; width: auto; vertical-align: top; } img.cma-screenshot { margin: 10px 0 0 25px; max-width: 800px; height: auto; vertical-align: top; border: 1px solid #000; } div.cma-screenshot-text { margin: 10px 0 0 25px; } .cma-break-word { word-wrap: break-word; } .cma-tag { border-radius: 5px; padding: 1px 10px; margin-right: 10px; } .cma-tag-info { background: #f0f0f0; } .cma-tag-warning { background: #ffdead; }\n\n\n\n\n\n\n\nMalware Analysis Report\n10322463.r3.v1\n2021-02-12\n\nNotification\n\nThis report is provided \"as is\" for informational purposes only. The Department of Homeland Security (DHS) does not provide any warranties of any kind regarding any information contained herein. The DHS does not endorse any commercial product or service referenced in this bulletin or otherwise.\nThis document is marked TLP:WHITE--Disclosure is not limited. Sources may use TLP:WHITE when information carries minimal or no foreseeable risk of misuse, in accordance with applicable rules and procedures for public release. Subject to standard copyright rules, TLP:WHITE information may be distributed without restriction. For more information on the Traffic Light Protocol (TLP), see http://www.us-cert.gov/tlp.\n\nSummary\n\nDescription\nThis Malware Analysis Report (MAR) is the result of analytic efforts among the Federal Bureau of Investigation (FBI), the Cybersecurity and Infrastructure Security Agency (CISA), and the Department of Treasury (Treasury) to highlight the cyber threat to cryptocurrency posed by North Korea, formally known as the Democratic People\u2019s Republic of Korea (DPRK), and provide mitigation recommendations. Working with U.S. government partners, FBI, CISA, and Treasury assess that Lazarus Group\u2014which these agencies attribute to North Korean state-sponsored advanced persistent threat (APT) actors\u2014is targeting individuals and companies, including cryptocurrency exchanges and financial service companies, through the dissemination of cryptocurrency trading applications that have been modified to include malware that facilitates theft of cryptocurrency.\n\n\t\t\tThis MAR highlights this cyber threat posed by North Korea and provides detailed indicators of compromise (IOCs) used by the North Korean government. The U.S. Government refers to malicious cyber activity by the North Korean government as HIDDEN COBRA. For more information on other versions of AppleJeus and recommended steps to mitigate this threat, see Joint Cybersecurity Advisory AA21-048A: AppleJeus: Analysis of\u00a0North Korea's Cryptocurrency Malware at https://www.us-cert.cisa.gov/ncas/alerts/AA21-048A.\n\n\t\t\tThere have been multiple versions of AppleJeus malware discovered since its initial discovery in August 2018. In most versions, the malware appears to be from a legitimate-looking cryptocurrency trading company and website, whereby an unsuspecting individual downloads a third-party application from a website that appears legitimate.\n\n\t\t\tThe U.S. Government has identified AppleJeus malware version\u2014Union Crypto\u2014and associated IOCs used by the North Korean government in AppleJeus operations.\n\n\t\t\tUnion Crypto, discovered by a cybersecurity company in December 2019, is a legitimate-looking cryptocurrency trading software that is marketed and distributed by a company and website\u2014Union Crypto and unioncrypto[.]vip, respectively\u2014that appear legitimate.\nFor a downloadable copy of IOCs, see: MAR-10322463-3.v1.stix.\nSubmitted Files (8)\n01c13f825ec6366ac2b6dd80e5589568fa5c8685cb4d924d1408e3d7c178902f (UnionCryptoUpdater.exe)\n0967d2f122a797661c90bc4fc00d23b4a29f66129611b4aa76f62d8a15854d36 (UnionCryptoTrader.exe)\n2ab58b7ce583402bf4cbc90bee643ba5f9503461f91574845264d4f7e3ccb390 (UnionCryptoTrader.dmg)\n631ac269925bb72b5ad8f469062309541e1edfec5610a21eecded75a35e65680 (unioncryptoupdater)\n6f45a004ad6bb087f733feb618e115fe88164f6db9562cb9b428372c9add75f0 (UnionCryptoTrader)\n755bd7a3765efceb8183ffade090ef2637a85c4505f8078dda116013dd5758f3 (NodeDLL.dll)\naf4144c1f0236e6b59f40d88635ec54c2ef8034f6a96a83f5dbfd6b8ea2c0d49 (UnionCryptoTrader.msi)\ne3623c2440b692f6b557a862719dc95f41d2e9ad7b560e837d3b59bfe4b8b774 (UnionCryptoSetup.exe)\nDomains (1)\nunioncrypto.vip\nIPs (1)\n216.189.150.185\n\nFindings\n\ne3623c2440b692f6b557a862719dc95f41d2e9ad7b560e837d3b59bfe4b8b774\nTags\ntrojan\nDetails\n\n\n\nName\nUnionCryptoSetup.exe\n\n\nSize\n30330443 bytes\n\n\nType\nPE32 executable (GUI) Intel 80386, for MS Windows\n\n\nMD5\n24b3614d5c5e53e40b42b4e057001770\n\n\nSHA1\nb040433fb50d679b2e287d7fcc1667a415fb60b0\n\n\nSHA256\ne3623c2440b692f6b557a862719dc95f41d2e9ad7b560e837d3b59bfe4b8b774\n\n\nSHA512\n55e9c7f59189e395b6b348d9fa8b4b907d0cedd790a33603a49ac857f5a07b205f8787fab0c7a9954e992852e6e5090f3cbf2243e86bb2546bd5628619648d87\n\n\nssdeep\n786432:Dj2fi5nBGPBMNekleUtOaZ13vcdkIXX0kfp:+65AP+QAeUtOKvc+c0kR\n\n\nEntropy\n7.984564\n\n\n\nAntivirus\n\n\n\nFilseclab\nW32.ELEX.L.erpg.mg\n\n\nMicrosoft Security Essentials\nTrojan:Win32/UnionCryptoTrader!ibt\n\n\n\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nPE Metadata\n\n\n\nCompile Date\n2018-09-20 09:08:01-04:00\n\n\nImport Hash\ncbc19a820310308f17b0a7c562d044e0\n\n\nCompany Name\nUnionCrypto Co.Ltd\n\n\nFile Description\nUnion Crypto Trader\n\n\nInternal Name\nUnionCryptoTraderSetup.exe\n\n\nLegal Copyright\n\u00a9 UnionCrypto Corporation. All Rights Reserved.\n\n\nOriginal Filename\nUnionCryptoTraderSetup.exe\n\n\nProduct Name\nUnion Crypto Trader\n\n\nProduct Version\n1.0.23.474\n\n\n\nPE Sections\n\n\n\nMD5\nName\nRaw Size\nEntropy\n\n\n566abfd43bde6dda239bf28ac9b087ae\nheader\n1024\n2.960546\n\n\n764b34cabee1111c9e11c8f836aebafb\n.text\n608256\n6.539792\n\n\n7989312225f01ce65374248a3e73a557\n.rdata\n189440\n4.588598\n\n\n1ac52732b5e747734a833e523cd8f27f\n.data\n10240\n4.418143\n\n\n3afae9bb129e782e05f70b3416946646\n.rsrc\n434688\n6.340500\n\n\nd11bf51446bb40b38f82ba6ce1f57dc4\n.reloc\n162816\n2.478756\n\n\n\nPackers/Compilers/Cryptors\n\n\n\nMicrosoft Visual C++ ?.?\n\n\n\nRelationships\n\n\n\ne3623c2440...\nContains\naf4144c1f0236e6b59f40d88635ec54c2ef8034f6a96a83f5dbfd6b8ea2c0d49\n\n\n\nDescription\nThis Windows program from the Union Crypto Trader site is a Windows executable. This executable is actually an installer, and will first extract a temporary MSI named UnionCryptoTrader.msi (af4144c1f0236e6b59f40d88635ec54c2ef8034f6a96a83f5dbfd6b8ea2c0d49) to the \u201cC:\\Users\\<username>\\AppData\\Local\\Temp\\{82E4B719-90F7-4BD1-9CF1-56CD777E0C42}\u201d folder, which will be executed by \"UnionCryptoTraderSetup.exe\" and deleted after it successfully completes the installation.\n\n\nunioncrypto.vip\nTags\ncommand-and-control\nURLs\n\nhxxps[:]//unioncrypto.vip/update\nhxxps[:]//www[.]unioncrypto.vip/download/W6c2dq8By7luMhCmya2v97YeN\n\nWhois\nWhois for unioncrypto.vip had the following information on December 8, 2019:\n\t\t\tRegistrar: NameCheap\n\t\t\tCreated: June 5, 2019\n\t\t\tExpires: June 5, 2020\n\t\t\tUpdated: June 5, 2019\nRelationships\n\n\n\nunioncrypto.vip\nDownloaded_To\n2ab58b7ce583402bf4cbc90bee643ba5f9503461f91574845264d4f7e3ccb390\n\n\nunioncrypto.vip\nDownloaded_To\n755bd7a3765efceb8183ffade090ef2637a85c4505f8078dda116013dd5758f3\n\n\n\nDescription\nWhile this site is no longer available, a download link of hxxps[:]//www[.]unioncrypto.vip/download/W6c2dq8By7luMhCmya2v97YeN was discovered by a cyber-security researcher and is recorded on VirusTotal for the OSX version of UnionCryptoTrader. In contrast, open source reporting disclosed the Windows version may have been downloaded via Telegram, as it was found in a \u201cTelegram Downloads\u201d folder on an unnamed victim. Union Crypto Trader has a legitimately signed Sectigo SSL certificate, which was \u201cDomain Control Validated\u201d just as the previous version certificates. .\n\n\t\t\tThe domain is registered with NameCheap at the IP address 104.168.167.16 with ASN 54290.\nScreenshots\n \n\nFigure 1 - Screenshot of the Union Crypto Trader website.\n\n\n\naf4144c1f0236e6b59f40d88635ec54c2ef8034f6a96a83f5dbfd6b8ea2c0d49\nTags\ndropper\nDetails\n\n\n\nName\nUnionCryptoTrader.msi\n\n\nSize\n14634496 bytes\n\n\nType\nComposite Document File V2 Document, Little Endian, Os: Windows, Version 10.0, MSI Installer, Number of Characters: 0, Last Saved By: InstallShield, Number of Words: 0, Title: Union Crypto Trader, Comments: Contact: Your local administrator, Keywords: Installer, Subject: Smart Cryptocurrency Arbitrage Trading Platform, Author: UnionCryptoTrader, Security: 1, Number of Pages: 200, Name of Creating Application: InstallShield 2018 - Premier Edition with Virtualization Pack 24, Last Saved Time/Date: Tue Aug 6 23:59:58 2019, Create Time/Date: Tue Aug 6 23:59:58 2019, Last Printed: Tue Aug 6 23:59:58 2019, Revision Number: {44311F94-C85D-4688-996A-4888F2D32062}, Code page: 1252, Template: x64;1033\n\n\nMD5\n0f03ec3487578cef2398b5b732631fec\n\n\nSHA1\n349fb7c922fba6da4bf5c2a3a9e0735f11068dac\n\n\nSHA256\naf4144c1f0236e6b59f40d88635ec54c2ef8034f6a96a83f5dbfd6b8ea2c0d49\n\n\nSHA512\nf2aa24d96daf090f3a29b5536f3ce0a9a59171b7fdb85887bc32ea6c5305e5ee03153b2c402399dd05a28d6fa90a3e979cc8153fd69686b5bbbb4ec199b8f2b3\n\n\nssdeep\n393216:zDea98QM1lKTmbHJdgXuUSCve2TN4ksIVVYlm6j8ziFS:XeanAKTuHbd9Ye2qpj8Og\n\n\nEntropy\n7.948615\n\n\n\nAntivirus\n\n\n\nTrendMicro\nTROJ_FR.DEFD7DB1\n\n\nTrendMicro House Call\nTROJ_FR.DEFD7DB1\n\n\n\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\naf4144c1f0...\nContained_Within\ne3623c2440b692f6b557a862719dc95f41d2e9ad7b560e837d3b59bfe4b8b774\n\n\naf4144c1f0...\nContains\n01c13f825ec6366ac2b6dd80e5589568fa5c8685cb4d924d1408e3d7c178902f\n\n\naf4144c1f0...\nContains\n0967d2f122a797661c90bc4fc00d23b4a29f66129611b4aa76f62d8a15854d36\n\n\n\nDescription\nThis Windows program is a Windows MSI Installer. The MSI installer will install \"UnionCryptoTrader.exe\"(0967d2f122a797661c90bc4fc00d23b4a29f66129611b4aa76f62d8a15854d36) in the \u201cC:\\Program Files\\UnionCryptoTrader\u201d folder and also install UnionCryptoUpdater.exe (01c13f825ec6366ac2b6dd80e5589568fa5c8685cb4d924d1408e3d7c178902f) in the \u201cC:\\Users\\<username>\\AppData\\Local\\UnionCryptoTrader\u201d folder. Immediately after installation, the installer launches \"UnionCryptoUpdater.exe.\"\nScreenshots\n \n\nFigure 2 - Screenshot of the UnionCryptoTrader Installation.\n\n\n\n0967d2f122a797661c90bc4fc00d23b4a29f66129611b4aa76f62d8a15854d36\nTags\ntrojan\nDetails\n\n\n\nName\nUnionCryptoTrader.exe\n\n\nSize\n1286144 bytes\n\n\nType\nPE32+ executable (GUI) x86-64, for MS Windows\n\n\nMD5\n46b3061fe981d0a5edfd8d55f75adf9f\n\n\nSHA1\n514263acf79aeb49d87192ae08f6c76854cdda12\n\n\nSHA256\n0967d2f122a797661c90bc4fc00d23b4a29f66129611b4aa76f62d8a15854d36\n\n\nSHA512\n38418a2f3a8870352d8a88d6fb48e2c93a35b48a559590beb12c7c507eadfd07bf087ea11e822fc3e7bc9d6710b17cb68c416ffcf87a787ed9428f2c6b56413e\n\n\nssdeep\n24576:fnrKym9OWCy0frP+1obeVbK8KW/TJ9+FCPjjcym8MUml:fnrKb9OWCy0q1obeVbPKW/TKcjlmhUml\n\n\nEntropy\n6.414530\n\n\n\nAntivirus\nNo matches found.\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nPE Metadata\n\n\n\nCompile Date\n2019-08-06 21:22:00-04:00\n\n\nImport Hash\ne0f869ddf0b356ab31c5676591e890ed\n\n\nCompany Name\nUnionCrypto Co.Ltd\n\n\nFile Description\nUnion Crypto Trader\n\n\nInternal Name\nUnionCryptoTrader.exe\n\n\nLegal Copyright\n\u00a9 UnionCrypto Corporation. All rights reserved.\n\n\nOriginal Filename\nUnionCryptoTrader.exe\n\n\nProduct Name\nUnion Crypto Trader\n\n\nProduct Version\n1.00.0000\n\n\n\nPE Sections\n\n\n\nMD5\nName\nRaw Size\nEntropy\n\n\n8a496cd41319fdb127a000e7a43bdfd4\nheader\n1024\n3.518197\n\n\n686f2fe8e51a4327d3e25e937c5eb1cc\n.text\n878080\n6.431878\n\n\n8f5b24579aaf7ecbc95b26614cf51e8c\n.rdata\n230912\n5.566823\n\n\n91b3d6678654de37caa94b211aae696e\n.data\n15360\n4.052861\n\n\naf667013369aea1785ada0e5442bcf07\n.pdata\n41472\n6.082142\n\n\naced93d352d733478dc51a779aef0c62\n.gfids\n512\n0.317810\n\n\n1f354d76203061bfdd5a53dae48d5435\n.tls\n512\n0.020393\n\n\n285d8a234d06cfb54adffe2eb077a2fe\n.rsrc\n113664\n3.831914\n\n\n241aeb18e88145608a8b273404896f72\n.reloc\n4608\n5.365584\n\n\n\nPackers/Compilers/Cryptors\n\n\n\nMicrosoft Visual C++ 8.0 (DLL)\n\n\n\nRelationships\n\n\n\n0967d2f122...\nContained_Within\naf4144c1f0236e6b59f40d88635ec54c2ef8034f6a96a83f5dbfd6b8ea2c0d49\n\n\n\nDescription\nThis file is a 64-bit Windows executable contained within the Windows MSI Installer \"UnionCryptoTrader.msi.\" When executed, \"UnionCryptoTrader.exe\" loads a legitimate cryptocurrency arbitrage application with no signs of malicious activity. (Note: arbitrage is defined as \u201cthe simultaneous buying and selling of securities, currency, or commodities in different markets or in derivative forms in order to take advantage of differing prices for the same asset\u201d).\n\n\t\t\tThis application does not appear to be a modification of the Windows QT Bitcoin Trader, but may be a modification of Blackbird Bitcoin Arbitrage.\n\n\t\t\tIn addition to the \"unioncrypto.vip\" site describing \"UnionCryptoTrader.exe\" as a \u201cSmart Cryptocurrency Arbitrage Trading Platform,\" many of the strings found in \"UnionCryptoTrader.exe\" have references to Blackbird Bitcoin Arbitrage including but not limited to:\n\n\t\t\t--Begin similarities--\n\t\t\tBlackbird Bitcoin Arbitrage\n\t\t\t| Blackbird Bitcoin Arbitrage Log File |\n\t\t\toutput/blackbird_result_\n\t\t\toutput\\blackbird_log_\n\t\t\tERROR: Blackbird needs at least two Bitcoin exchanges. Please edit the config.json file to add new exchanges\n\t\t\t--End similarities--\n\n\t\t\tThe strings also contain the links and references to all fourteen exchanges listed as implemented or potential on the Blackbird GitHub page. In addition, the \"config.txt\" file found in the \u201cC:\\Program Files\\UnionCryptoTrader\u201d folder with \"UnionCryptoTrader.exe\" also contains references to all fourteen exchanges, as well as sets the database file to \"blackbird.db.\" The file \"blackbird.db\" is also found in the same folder.\nScreenshots\n \n\nFigure 3 - Screenshot of the \"UnionCryptoTrader.exe\"application.\n\n\n\n01c13f825ec6366ac2b6dd80e5589568fa5c8685cb4d924d1408e3d7c178902f\nTags\ntrojan\nDetails\n\n\n\nName\nUnionCryptoUpdater.exe\n\n\nSize\n161280 bytes\n\n\nType\nPE32+ executable (console) x86-64, for MS Windows\n\n\nMD5\n629b9de3e4b84b4a0aa605a3e9471b31\n\n\nSHA1\n1ef0e1cabd344726b663cec8d9e68f147259da55\n\n\nSHA256\n01c13f825ec6366ac2b6dd80e5589568fa5c8685cb4d924d1408e3d7c178902f\n\n\nSHA512\nc70abbe52cbbed220fee218664d1c5f4313bd5387de11c275aa31115e90328dac032c6138954f3931c7d134e8613ad6c278ed29d78c0dc8199a1433b1a106132\n\n\nssdeep\n3072:Q/MdytyORF471FiHNkwBFTdpSI94e1ZVypzCG9n7r:Q/ftvF471AHNFjdYIZOt\n\n\nEntropy\n6.192246\n\n\n\nAntivirus\n\n\n\nAvira\nTR/Agent.pfpad\n\n\nBitDefender\nTrojan.GenericKD.33626108\n\n\nComodo\nMalware\n\n\nESET\na variant of Win64/Agent.UV trojan\n\n\nEmsisoft\nTrojan.GenericKD.33626108 (B)\n\n\nIkarus\nTrojan.Win64.Agent\n\n\nK7\nTrojan ( 0056425b1 )\n\n\nLavasoft\nTrojan.GenericKD.33626108\n\n\nMcAfee\nTrojan-Agent.c\n\n\nNANOAV\nTrojan.Win64.Mlw.icfhya\n\n\nSymantec\nTrojan.Gen.2\n\n\nTACHYON\nTrojan/W64.Agent.161280.C\n\n\nTrendMicro\nTROJ_FR.DEFD7DB1\n\n\nTrendMicro House Call\nTROJ_FR.DEFD7DB1\n\n\nVirusBlokAda\nTrojan.Win64.Agentb\n\n\nZillya!\nTrojan.Agent.Win64.5106\n\n\n\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nPE Metadata\n\n\n\nCompile Date\n2019-08-06 22:00:26-04:00\n\n\nImport Hash\ne217501515a13bba8aefe7dcf3b74f33\n\n\nCompany Name\nUnionCrypto Co.Ltd\n\n\nFile Description\nUnion Crypto Trading Updater\n\n\nInternal Name\nunioncryptoupdater.exe\n\n\nLegal Copyright\n\u00a9 UnionCrypto Corporation. All rights reserved.\n\n\nOriginal Filename\nunioncryptoupdater.exe\n\n\nProduct Name\nUnion Crypto Trading Updater\n\n\nProduct Version\n1.0.23.474\n\n\n\nPE Sections\n\n\n\nMD5\nName\nRaw Size\nEntropy\n\n\n9b73650178bdd95af246609c1b650253\nheader\n1024\n3.045187\n\n\nac3f61418ff1daa9142e2304a647c2aa\n.text\n98816\n6.452850\n\n\ncc2de13f05d38702ac9a560e450ab54a\n.rdata\n48128\n5.088494\n\n\n20ef8fb99461ca48fe9ed26ffb4cc26c\n.data\n3072\n2.234569\n\n\nabf07cda1f35bf5fe4a9ac21de63f903\n.pdata\n6144\n5.155358\n\n\n3eab486bdf211a98334f08a5145dbf94\n.gfids\n512\n1.857174\n\n\nc9ab77353b20e3b22c344b60c8859d56\n.rsrc\n1536\n3.943344\n\n\na9cd219d9ad71f6c2c60efc1308885c8\n.reloc\n2048\n4.924725\n\n\n\nPackers/Compilers/Cryptors\n\n\n\nMicrosoft Visual C++ 8.0 (DLL)\n\n\n\nRelationships\n\n\n\n01c13f825e...\nDownloaded\n755bd7a3765efceb8183ffade090ef2637a85c4505f8078dda116013dd5758f3\n\n\n01c13f825e...\nContained_Within\naf4144c1f0236e6b59f40d88635ec54c2ef8034f6a96a83f5dbfd6b8ea2c0d49\n\n\n\nDescription\nThis file is a 64-bit Windows executable contained within the Windows MSI Installer \"UnionCryptoTrader.msi.\" When executed, \"UnionCryptoUpdater.exe\" first installs itself as a service, which will automatically start when any user logs on. The service is installed with a description stating it \u201cAutomatically installs updates for Union Crypto Trader.\"\n\n\t\t\tAfter installing the service, \"UnionCryptoUpdater.exe\" collects different information about the system the malware is running on. Specifically, it uses Windows Management Instrumentation (WMI) Query Language (WQL) to collect this information. \"UnionCryptoUpdater.exe\" first finds the BIOS Serial Number by using the \u201cSELECT * FROM Win32_Bios\u201d WMI filter as a WQL Query String (Figure 4).\n\n\t\t\tThis returns SMBBIOSBIOSVersion, Manufacturer, Name, SerialNumber, and Version. The function later pulls the \u201cSerialNumber\u201d from this returned data (Figure 5).\n\n\t\t\tThe same process is followed to pull the operating system version and build number. The WQL Query String is \u201cSELECT * FROM Win32_OperatingSystem,\" and the fields pulled are \u201cCaption\u201d and \u201cBuildNumber.\" Note that the \u201cCaption\u201d field contains the OS version for the computer running the malware.\n\n\t\t\tAfter collecting the system data, \"UnionCryptoUpdater.exe\" then builds a string consisting of the current time and the hard-coded value \u201c12GWAPCT1F0I1S14.\" The current time is stored in the \"auth_timestamp\" variable.\n\n\t\t\tThis combined string is MD5 hashed and stored in the \"auth_signature\" variable. These variables are sent in the first communication to the command and control (C2) server, and are likely used to verify any connections to the server are actually originating from the \"UnionCryptoUpdater.exe\" malware.\n\n\t\t\tThese variables are sent via a POST the C2 hxxps[:]//unioncrypto.vip/update along with the collected system data. The system data is sent in this specific format:\n\n\t\t\t--Begin format--\n\t\t\trlz=[BIOS serial number]&ei=[OS Version] (BuildNumber)&act=check\n\t\t\t--End format--\n\n\t\t\tThese values, along with a hard-coded User Agent String of \u201cMozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.142 Safari/537.36\u201d can be found in the malware data section.\n\n\t\t\tIf the POST is successful (i.e. returns an HTTP response status code of 200), but returns a string of \u201c0\u201d, UnionCryptoUpdater.exe will sleep for ten minutes and then regenerate the \"auth_timestamp\" and \"auth_signature\" to contact the C2 again.\n\n\t\t\tIf the POST is successful and the C2 server does not return the string \u201c0\u201d, the malware will decode the base64 payload and decrypt it. It then uses built in C++ functions to allocate memory, write the payload to memory, and executes the payload. If this is successful, the malware will send another POST to the C2 with the value \u201cact=done\u201d replacing the \u201cact=check\u201d for the previously specified format (Figure 9).\nScreenshots\n \n\nFigure 4 - Screenshot of the \"UnionCryptoUpdater\" Service.\n\n \n\nFigure 5 - Screenshot of the \"SELECT * FROM Win32_Bios\" query string.\n\n \n\nFigure 6 - Screenshot of the \"SerialNumber\" selection.\n\n \n\nFigure 7 - Screenshot of the \"UnionCryptoUpdater.exe\" getting current time and combining with hard-coded value.\n\n \n\nFigure 8 - Screenshot of the hard-coded values and User Agent in \"UnionCryptoUpdater.exe.\"\n\n \n\nFigure 9 - Screenshot of the hard-coded \"&act=done\" value.\n\n\n\n755bd7a3765efceb8183ffade090ef2637a85c4505f8078dda116013dd5758f3\nTags\ntrojan\nDetails\n\n\n\nName\nNodeDLL.dll\n\n\nSize\n537616 bytes\n\n\nType\nPE32+ executable (DLL) (GUI) x86-64, for MS Windows\n\n\nMD5\n549db64ceaebbbdd9068d761cb5c616c\n\n\nSHA1\n6d91ce7b9f38e2316aa9fb50ececc02eadc4cd70\n\n\nSHA256\n755bd7a3765efceb8183ffade090ef2637a85c4505f8078dda116013dd5758f3\n\n\nSHA512\n0281257ad97e0765b57d29bb22fe9973f4ad5c42a93762eda1b12e71f78d02155fe32eda4ccd4acadbfccf61563175c28c520df5b631698573422048dce6a8c0\n\n\nssdeep\n12288:FOvSQSQs75paRGK9EovEfM9NosCz4jcauwVyZE19QLC:Mv0VpkGYvI6NAz4j5LV6+\n\n\nEntropy\n6.433002\n\n\n\nAntivirus\nNo matches found.\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nPE Metadata\n\n\n\nCompile Date\n2019-10-21 12:33:45-04:00\n\n\nImport Hash\nc24e1d44f912d970e41414c324d04158\n\n\n\nPE Sections\n\n\n\nMD5\nName\nRaw Size\nEntropy\n\n\n41f1664ee936eb5e9c5a402b9f791086\nheader\n1024\n3.215046\n\n\nd7c3e5262e243bfd078cc689c0dcc509\n.text\n393728\n6.418398\n\n\n0155d4e1f35b8f139d07993866f1e2f6\n.rdata\n115200\n5.560875\n\n\n67b68408aebc7de9f6019e94ab5cf2ce\n.data\n3584\n2.251912\n\n\n809c1804672ec420bb9f366f30b025fb\n.pdata\n20480\n5.768325\n\n\n7eb4b39b296be7f4de3339727d0f1eb0\n.gfids\n512\n1.995088\n\n\n28984c1ba2156023b894e0041ecd2479\n.rsrc\n512\n4.724729\n\n\n1c7de4ac5824c7b888e15c611cb69191\n.reloc\n2560\n5.180527\n\n\n\nRelationships\n\n\n\n755bd7a376...\nDownloaded_By\n01c13f825ec6366ac2b6dd80e5589568fa5c8685cb4d924d1408e3d7c178902f\n\n\n755bd7a376...\nDownloaded_From\nunioncrypto.vip\n\n\n755bd7a376...\nConnected_To\n216.189.150.185\n\n\n\nDescription\nThis file is a 64-bit dynamic-link library (DLL). This file was identified as a payload for the Windows malware. This stage 2 is not immediately downloaded by \"UnionCryptoUpdater.exe,\" but instead is downloaded after a period of time likely specified by the C2 server at \"hxxps[:]//unioncrypto.vip/update.\" This delay could be implemented to prevent researchers from immediately obtaining the stage 2 malware.\n\n\t\t\tThe C2 and build path are visible from the \"NodeDLL.dll\" strings. The C2 for the malware is hxxp[:]//216.189.150.185:8080/push.jsp.\n\n\t\t\tThe build path found in the strings is \u201cZ:\\Opal\\bin\\x64_Release\\NodeDll.pdb.\" This stage 2 is likely part of a project named \u201cOpal\u201d by the actors, due to the folder in the build path.\n\n\t\t\tNodeDLL.dll has multiple functionalities which can be verified by examining the program imports and strings. Functionalities with corresponding strings/imports include but are not limited to:\n\t\t\t1. Get/Update implant configuration\n\t\t\t\u00a0\u00a0\u00a0a. Imports: GetComputerNameA, GetCurrentDirectoryW, GetStartupInfoW, GetTimeZoneInformation\n\t\t\t\u00a0\u00a0\u00a0b. Strings: CurrentUser\n\t\t\t2. Get/Put a file or directory\n\t\t\t\u00a0\u00a0\u00a0a. Imports: WriteFile\n\t\t\t3. Execute a program\n\t\t\t\u00a0\u00a0\u00a0a. Imports: CreateProcessW\n\t\t\t4. Directory listing\n\t\t\t\u00a0\u00a0\u00a0a. Imports: GetCurrentDirectoryW\n\t\t\t5. Active Drive Listing (C:\\, D:\\, etc.)\n\t\t\t\u00a0\u00a0\u00a0a. Imports: GetLogicalDrives, GetDriveTypeW\n\t\t\t6. Move a file/directory\n\t\t\t\u00a0\u00a0\u00a0a. Imports: CreateDirectoryW, MoveFileExW\n\t\t\t7. Delete a file/directory\n\t\t\t\u00a0\u00a0\u00a0a. Imports: DeleteFileW\n\t\t\t8. Screenshot active desktop\n\t\t\t\u00a0\u00a0\u00a0a. Imports: GetDIBits, CreateCompatibleBitmap, BitBlt, etc from gdi32\n\t\t\t9. Execute a shell command through cmd.exe\n\t\t\t\u00a0\u00a0\u00a0a. Imports: GetCommandLineW, GetCommandLineA, CreateProcessAsUserW\n\t\t\t10. Check IPv4 TCP connectivity against specified target\n\t\t\t\u00a0\u00a0\u00a0a. Imports: connect, bind, send, socket, getaddrinfo, etc. from ws2_32\n\t\t\t\u00a0\u00a0\u00a0b. Strings: Network unreachable, HTTP/1.%d %d, httponly, Remote file not found\n\t\t\t11. Update configuration (beacon interval, AP address, etc.)\n\t\t\t\u00a0\u00a0\u00a0a. Strings: Host: %s%s%s:%d, Set-Cookie:\n\n\t\t\tThe \"NodeDLL.dll\" strings also show a hard-coded user agent string: \u201cMozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.140 Safari/537.36 Edge/17.17134\u201d. Finally, a format string which matches the HostUS C2 is found in the strings: \"%s://%s%s%s:%d%s%s%s,\" along with many references to proxies or proxy configurations.\n\n\n216.189.150.185\nTags\ncommand-and-control\nURLs\n\n216.189.150.185:8080/push.jsp\n\nPorts\n\n8080 TCP\n\nWhois\nQueried whois.arin.net with \"n 216.189.150.185\"...\n\n\t\t\tNetRange: \u00a0\u00a0\u00a0 216.189.144.0 - 216.189.159.255\n\t\t\tCIDR: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 216.189.144.0/20\n\t\t\tNetName: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0HOSTUS-IPV4-3\n\t\t\tNetHandle: \u00a0\u00a0\u00a0 NET-216-189-144-0-1\n\t\t\tParent: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 NET216 (NET-216-0-0-0-0)\n\t\t\tNetType: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Direct Allocation\n\t\t\tOriginAS: \u00a0\u00a0\u00a0 AS7489, AS25926\n\t\t\tOrganization: HostUS (HOSTU-4)\n\t\t\tRegDate: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a02014-08-29\n\t\t\tUpdated: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a02015-12-29\n\t\t\tComment: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Please send all abuse reports to abuse@hostus.us\n\t\t\tRef: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0https://rdap.arin.net/registry/ip/216.189.144.0\n\n\n\t\t\tOrgName: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0HostUS\n\t\t\tOrgId: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 HOSTU-4\n\t\t\tAddress: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0125 N Myers St\n\t\t\tCity: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 Charlotte\n\t\t\tStateProv: \u00a0\u00a0\u00a0 NC\n\t\t\tPostalCode: \u00a0\u00a0\u00a0 28202\n\t\t\tCountry: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0US\n\t\t\tRegDate: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a02013-07-26\n\t\t\tUpdated: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a02019-10-23\n\t\t\tComment: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0IP addresses from this network are further reallocated or assigned to customers.\n\t\t\tComment: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Please send all abuse reports to abuse@hostus.us.\n\t\t\tComment: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0Abuse reports must be submitted through email with the IP address in title.\n\t\t\tRef: \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0https://rdap.arin.net/registry/entity/HOSTU-4\n\n\n\t\t\tOrgNOCHandle: HOSTU2-ARIN\n\t\t\tOrgNOCName: HostUS Tech\n\t\t\tOrgNOCPhone: +1-302-300-1737\n\t\t\tOrgNOCEmail: noc@hostus.us\n\t\t\tOrgNOCRef: \u00a0\u00a0\u00a0https://rdap.arin.net/registry/entity/HOSTU2-ARIN\n\n\t\t\tOrgAbuseHandle: HAD18-ARIN\n\t\t\tOrgAbuseName: HostUS Abuse Desk\n\t\t\tOrgAbusePhone: +1-302-300-1737\n\t\t\tOrgAbuseEmail: abuse@hostus.us\n\t\t\tOrgAbuseRef: \u00a0\u00a0\u00a0https://rdap.arin.net/registry/entity/HAD18-ARIN\n\n\t\t\tOrgTechHandle: HOSTU2-ARIN\n\t\t\tOrgTechName: HostUS Tech\n\t\t\tOrgTechPhone: +1-302-300-1737\n\t\t\tOrgTechEmail: noc@hostus.us\n\t\t\tOrgTechRef: \u00a0\u00a0\u00a0https://rdap.arin.net/registry/entity/HOSTU2-ARIN\nRelationships\n\n\n\n216.189.150.185\nConnected_From\n755bd7a3765efceb8183ffade090ef2637a85c4505f8078dda116013dd5758f3\n\n\n\nDescription\nThe C2 identified for NodeDLL.dll. The IP address 216.189.150.185 has ASN 7489 and is owned by HostUS.\n\n\n2ab58b7ce583402bf4cbc90bee643ba5f9503461f91574845264d4f7e3ccb390\nTags\nbackdoordownloaderloadertrojan\nDetails\n\n\n\nName\nUnionCryptoTrader.dmg\n\n\nSize\n20911661 bytes\n\n\nType\nzlib compressed data\n\n\nMD5\n6588d262529dc372c400bef8478c2eec\n\n\nSHA1\n06d9f835efd1c05323f6a3abdf66e6be334e47c4\n\n\nSHA256\n2ab58b7ce583402bf4cbc90bee643ba5f9503461f91574845264d4f7e3ccb390\n\n\nSHA512\n4a90cd71e210662c3e21994a6af6d80f45c394b972d85ba725dc0e33721036c38b68829ca831113276cbea891fc075e1fa9911aad1fc647b0c2a2bb7a9d965cd\n\n\nssdeep\n393216:psbbiMqkRiP3p+/34QRDCLqKbNH40iBNTnz0xcECffBJrd8ur8dx3PAxC9lG:WbipIM3p+/TBvBN0xcRmur8dxIxC9l\n\n\nEntropy\n7.997189\n\n\n\nAntivirus\n\n\n\nAhnlab\nBackdoor/OSX.Nukesped.20911661\n\n\nAntiy\nTrojan/Mac.NukeSped\n\n\nAvira\nOSX/Dldr.NukeSped.rtyrb\n\n\nBitDefender\nTrojan.MAC.Lazarus.F\n\n\nCyren\nTrojan.PXZN-6\n\n\nESET\nOSX/TrojanDownloader.NukeSped.B trojan\n\n\nEmsisoft\nTrojan.MAC.Lazarus.F (B)\n\n\nIkarus\nTrojan-Downloader.OSX.Nukesped\n\n\nK7\nTrojan ( 0001140e1 )\n\n\nLavasoft\nTrojan.MAC.Lazarus.F\n\n\nMcAfee\nOSX/Nukesped.b\n\n\nMicrosoft Security Essentials\nTrojan:MacOS/NukeSped.C!MTB\n\n\nSophos\nOSX/NukeSped-AB\n\n\nSymantec\nOSX.Trojan.Gen\n\n\nTrendMicro\nTrojan.3657DE58\n\n\nTrendMicro House Call\nTrojan.3657DE58\n\n\nZillya!\nDownloader.Agent.OSX.68\n\n\n\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\n2ab58b7ce5...\nDownloaded_From\nunioncrypto.vip\n\n\n2ab58b7ce5...\nContains\n6f45a004ad6bb087f733feb618e115fe88164f6db9562cb9b428372c9add75f0\n\n\n2ab58b7ce5...\nContains\n631ac269925bb72b5ad8f469062309541e1edfec5610a21eecded75a35e65680\n\n\n\nDescription\nThis OSX program from the \"UnionCrypto\" download link is an Apple DMG installer.\n\n\t\t\tThe OSX program does not have a digital signature, and will warn the user of that before installation. Just as previous versions, the UnionCrypto installer appears to be legitimate and installs both \u201cUnionCryptoTrader\u201d (6f45a004ad6bb087f733feb618e115fe88164f6db9562cb9b428372c9add75f0) in the \u201c/Applications/UnionCryptoTrader.app/Contents/MacOS/\u201d folder and a hidden program named \u201c.unioncryptoupdater\u201d (631ac269925bb72b5ad8f469062309541e1edfec5610a21eecded75a35e65680) in the \u201c/Applications/UnionCryptoTrader.app/Contents/Resources/\u201d folder. The installer contains a postinstall script (see figure 10).\n\n\t\t\tThis postinstall script is identical in functionality to the postinstall script for the second version. It moves the hidden plist file (.vip.unioncrypto.plist) to the LaunchDaemons folder and changes the file permissions for the plist to be owned by root. Once in the LaunchDaemons folder, this program will be ran on system load as root for every user. This will launch the unioncryptoupdater program.\n\n\t\t\tThe postinstall script also moves the hidden \u201c.unioncryptoupdater\u201d binary to a new location \u201c/Library/UnionCrypto/unioncryptoupdater\u201d and makes the file executable. As the LaunchDaemon will not be run immediately after the plist file is moved, the postinstall script then launches the unioncryptoupdater program in the background (&). In contrast to the CelasTradePro \u201cUpdater\u201d binary and JMTTrader \u201cCrashReporter\u201d binary, the unioncryptoupdater binary is not launched with any parameters.\nScreenshots\n \n\nFigure 10 - Screenshot of the postinstall script included in UnionCryptoTrader installer.\n\n \n\nFigure 11 - Screenshot of the \"vip.unioncrypto.plist\" file.\n\n\n\n6f45a004ad6bb087f733feb618e115fe88164f6db9562cb9b428372c9add75f0\nTags\ntrojan\nDetails\n\n\n\nName\nUnionCryptoTrader\n\n\nSize\n1602900 bytes\n\n\nType\nMach-O 64-bit x86_64 executable, flags:<NOUNDEFS|DYLDLINK|TWOLEVEL|WEAK_DEFINES|BINDS_TO_WEAK|PIE>\n\n\nMD5\n41587b0dd5104a4ee6484ff8cf47fd21\n\n\nSHA1\nbd41cb308913c4964aef47edafd36faa1f673717\n\n\nSHA256\n6f45a004ad6bb087f733feb618e115fe88164f6db9562cb9b428372c9add75f0\n\n\nSHA512\nefaf37208ee17967df8c435e592b2029d8e56aabd92ca989704bf7908399bf9e84b6312b928fb89907d72518ef40ae95ac6feeb1a19044231bbc60fa14cf18ec\n\n\nssdeep\n49152:2ScN8VPSplcFjsmEWe7JEANYIwErVqpxPM0:M40ltBWeFuHbE0\n\n\nEntropy\n6.459336\n\n\n\nAntivirus\nNo matches found.\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\n6f45a004ad...\nContained_Within\n2ab58b7ce583402bf4cbc90bee643ba5f9503461f91574845264d4f7e3ccb390\n\n\n\nDescription\nThis OSX sample was contained within Apple DMG Installer \"UnionCryptoTrader.dmg.\" When executed, UnionCryptoTrader loads a legitimate cryptocurrency arbitrage application with no signs of malicious activity. (Note: arbitrage is defined as \u201cthe simultaneous buying and selling of securities, currency, or commodities in different markets or in derivative forms in order to take advantage of differing prices for the same asset\u201d). This application does not appear to be a modification of the OSX QT Bitcoin Trader, but may be a modification of Blackbird Bitcoin Arbitrage11.\n\t\t\tIn addition to the \"unioncrypto.vip\" site describing UnionCryptoTrader as a \u201cSmart Cryptocurrency Arbitrage Trading Platform,\" may of the strings found in UnionCryptoTrader have references to Blackbird Bitcoin Arbitrage including but not limited to:\n\n\t\t\t--Begin similarities--\n\t\t\tBlackbird Bitcoin Arbitrage\n\t\t\t| Blackbird Bitcoin Arbitrage Log File |\n\t\t\toutput/blackbird_result_\n\t\t\toutput/blackbird_log_\n\t\t\tERROR: Blackbird needs at least two Bitcoin exchanges. Please edit the config.json file to add new exchanges\n\t\t\t--End similarities--\n\n\t\t\tThe strings also contain the links and references to all fourteen exchanges listed as implemented or potential on the Blackbird GitHub page.\n\n\n631ac269925bb72b5ad8f469062309541e1edfec5610a21eecded75a35e65680\nTags\nbackdoordownloaderloadertrojan\nDetails\n\n\n\nName\nunioncryptoupdater\n\n\nSize\n79760 bytes\n\n\nType\nMach-O 64-bit x86_64 executable, flags:<NOUNDEFS|DYLDLINK|TWOLEVEL|BINDS_TO_WEAK|PIE>\n\n\nMD5\nda17802bc8d3eca26b7752e93f33034b\n\n\nSHA1\ne8f29f1e3f35a4f2c18be424551e280ed66b1dd7\n\n\nSHA256\n631ac269925bb72b5ad8f469062309541e1edfec5610a21eecded75a35e65680\n\n\nSHA512\na32672fa780675e767e37fa1b8d186951cb934279cb416766c518a7d6f76b6521176a5055045c0af7ec1ce5f9882a952ed8761b54f9cb12587b831d9c26ea529\n\n\nssdeep\n1536:4YGnCXIbO9KBQJELi6VA2l5+r1M6JBM4YQNVZ3MpJy5TU23MpJy5Tp:3eCYK5JEBXaM6Jq4p3MpJy5Tb3MpJy5T\n\n\nEntropy\n4.871481\n\n\n\nAntivirus\n\n\n\nAhnlab\nBackdoor/OSX.Nukesped.79760\n\n\nAntiy\nTrojan/Mac.NukeSped\n\n\nAvira\nOSX/Agent.hwuxh\n\n\nBitDefender\nTrojan.MAC.Lazarus.D\n\n\nClamAV\nOsx.Malware.Agent-7430998-0\n\n\nESET\nOSX/TrojanDownloader.NukeSped.B trojan\n\n\nEmsisoft\nTrojan.MAC.Lazarus.D (B)\n\n\nIkarus\nTrojan-Downloader.OSX.Nukesped\n\n\nK7\nTrojan ( 0001140e1 )\n\n\nLavasoft\nTrojan.MAC.Lazarus.D\n\n\nMcAfee\nOSX/Lazarus.b\n\n\nMicrosoft Security Essentials\nTrojan:MacOS/NukeSped.C!MTB\n\n\nNANOAV\nTrojan.Mac.Download.gknigf\n\n\nQuick Heal\nMacOS.Trojan.39995.GC\n\n\nSophos\nOSX/Lazarus-F\n\n\nSymantec\nOSX.Trojan.Gen\n\n\nTrendMicro\nTROJ_FR.ED65B0ED\n\n\nTrendMicro House Call\nTROJ_FR.ED65B0ED\n\n\nZillya!\nDownloader.NukeSped.OSX.6\n\n\n\nYARA Rules\nNo matches found.\nssdeep Matches\nNo matches found.\nRelationships\n\n\n\n631ac26992...\nContained_Within\n2ab58b7ce583402bf4cbc90bee643ba5f9503461f91574845264d4f7e3ccb390\n\n\n\nDescription\nThis OSX sample was contained within Apple DMG Installer \"UnionCryptoTrader.dmg.\" This malware is signed adhoc, meaning it is not signed with a valid code signing ID.\n\n\t\t\tWhen executed, unioncryptoupdater immediately calls the \u201conRun()\u201d function, which contains most of the logic and functionality for this malware. This function first collects different information about the system the malware is running on. It uses IOKit, which is an Apple framework designed to allow programs to gain user-access to hardware devices and drivers. IOKit is specifically used to retrieve the system serial number with IOPlatformSerialNumber global variable (Figure 12).\n\n\t\t\tThe function then collects the operating system version by reading the system file at \u201c/System/Library/CoreServices/SystemVersion.plist,\" and specifically extracting the ProductVersion and ProductBuildVersion from the system file (Figure 13).\n\n\t\t\tAfter collecting the system data, unioncryptoupdater then builds a string consisting of the current time and the hard-coded value \u201c12GWAPCT1F0I1S14\" (Figure 14).\n\n\t\t\tThis string is MD5 hashed and stored in the \"auth_signature\" variable and the current time (used to create string for \"auth_signature\") in the \"auth_timestamp\" variable. These variables are sent in the first communication to the C2 server and are likely used to verify any connections to the server are actually originating from the unioncryptoupdater malware.\n\n\t\t\tAll collected data and the \"auth_signature\" and \"auth_timestamp\" are sent to hxxps[:]//unioncrypto.vip/update using the Barbeque::post() method. The Barbeque class is custom made C++ class which has both a post() and a get() method, which utilize libcurl to perform network communications for the malware. Barbeque::post() sends the system data in this specific format:\n\n\t\t\t--Begin format--\n\t\t\trlz=[device serial number]&ei=[ProductVersion] (ProductBuildVersion)&act=check\n\t\t\t--End format--\n\n\t\t\tThese values are found as described above or are hard-coded into the malware data section (Figure 15).\n\n\t\t\tIf the C2 server returns the string \u201c0,\" unioncryptotrader will sleep for ten minutes and then regenerate the auth_timestamp and auth_signature to contact the C2 again via the same Barbeque::post() method.\n\n\t\t\tIf the C2 server does not return the string \u201c0,\" the malware will decode the base64 payload, and decrypt it using the C++ aes_decrypt_cbc function. After decryption, the malware uses the OSX function mmap to allocate memory with read, write, and execute permissions. This is specified by the 7 loaded into the edx register before mmap is called. (Note: the 7, or binary 111, comes from OR\u2019ing the read (100), write (010), and execute (001) binary values together, just as file permissions are often set). If mmap is successful in allocating the memory, the function then uses memcpy to copy the decrypted payload into the mmap\u2019d memory region (Figure 16).\n\n\t\t\tAfter the decrypted payload is copied into memory, unioncryptoupdater calls a function named memory_exec2, which utilizes Apple API NSCreateObjectFileImageFromMemory to create an \u201cobject file image\u201d from the memory, and Apple API NSLinkModule to link the \u201cobject file image\u201d. The API calls are necessary to allow the payload in memory to execute, as files in memory are not simply able to execute as files on disk are (Figure 17).\n\n\t\t\tOnce the malware has mapped and linked the payload in memory, it searches the mapped memory for \u201c0xfeedfacf,\" which is the magic number for 64-bit OSX executables. This check is likely included to verify the payload was properly decoded, decrypted, and memory mapped before attempting execution (Figure 18).\n\n\t\t\tAfter verifying the magic number, the malware searches for the address 0x80000028, which is the address of the LC_MAIN Load Command. Load Commands are similar to a table of contents for an OSX executable which contain commands and command positions in the binary. Offset 0x8 of the LC_MAIN load command contains the offset of the OSX executable entry point (Figure 19). This entry point is placed in register r8, and is called by the malware.\n\n\t\t\tThis process of allocating memory, copying the payload into memory, and calling the entry point achieves pure in-memory execution of the remotely downloaded payload. As such, if this is successful, the payload can be executed exclusively in memory and is never copied to disk.\n\t\t\tIf any part of the memory code execution process fails, unioncryptoupdater will write the received payload to \u201c/tmp/updater\u201d instead and execute it with a call to system (Figure 20).\n\n\t\t\tThe payload for this OSX malware could not be downloaded, as the C2 server \"unioncrypto.vip/update\" is no longer accessible. In addition, the payload was not identified in open source reporting.\nScreenshots\n \n\nFigure 12 - Screenshot of the IOPlatformSerialNumber reference in unioncryptoupdater.\n\n \n\nFigure 13 - Screenshot of the unioncryptoupdater collecting OS version.\n\n \n\nFigure 14 - Screenshot of unioncryptoupdater getting current time and combining with hard-coded value.\n\n \n\nFigure 15 - Screenshot of the various hard-coded values in unioncryptoupdater.\n\n \n\nFigure 16 - Screenshot of mmap and memcpy in unioncryptoupdater.\n\n \n\nFigure 17 - Screenshot of NSCreateObjectFileImageFromMemory.\n\n \n\nFigure 18 - Screenshot of 39FEEDFACF in unioncryptoupdater.\n\n \n\nFigure 19 - Screenshot of the load and call entry point of payload.\n\n \n\nFigure 20 - Screenshot of the write payload to disk and execute.\n\n\nRelationship Summary\n\n\n\n\ne3623c2440...\nContains\naf4144c1f0236e6b59f40d88635ec54c2ef8034f6a96a83f5dbfd6b8ea2c0d49\n\n\nunioncrypto.vip\nDownloaded_To\n2ab58b7ce583402bf4cbc90bee643ba5f9503461f91574845264d4f7e3ccb390\n\n\nunioncrypto.vip\nDownloaded_To\n755bd7a3765efceb8183ffade090ef2637a85c4505f8078dda116013dd5758f3\n\n\naf4144c1f0...\nContained_Within\ne3623c2440b692f6b557a862719dc95f41d2e9ad7b560e837d3b59bfe4b8b774\n\n\naf4144c1f0...\nContains\n01c13f825ec6366ac2b6dd80e5589568fa5c8685cb4d924d1408e3d7c178902f\n\n\naf4144c1f0...\nContains\n0967d2f122a797661c90bc4fc00d23b4a29f66129611b4aa76f62d8a15854d36\n\n\n0967d2f122...\nContained_Within\naf4144c1f0236e6b59f40d88635ec54c2ef8034f6a96a83f5dbfd6b8ea2c0d49\n\n\n01c13f825e...\nDownloaded\n755bd7a3765efceb8183ffade090ef2637a85c4505f8078dda116013dd5758f3\n\n\n01c13f825e...\nContained_Within\naf4144c1f0236e6b59f40d88635ec54c2ef8034f6a96a83f5dbfd6b8ea2c0d49\n\n\n755bd7a376...\nDownloaded_By\n01c13f825ec6366ac2b6dd80e5589568fa5c8685cb4d924d1408e3d7c178902f\n\n\n755bd7a376...\nDownloaded_From\nunioncrypto.vip\n\n\n755bd7a376...\nConnected_To\n216.189.150.185\n\n\n216.189.150.185\nConnected_From\n755bd7a3765efceb8183ffade090ef2637a85c4505f8078dda116013dd5758f3\n\n\n2ab58b7ce5...\nDownloaded_From\nunioncrypto.vip\n\n\n2ab58b7ce5...\nContains\n6f45a004ad6bb087f733feb618e115fe88164f6db9562cb9b428372c9add75f0\n\n\n2ab58b7ce5...\nContains\n631ac269925bb72b5ad8f469062309541e1edfec5610a21eecded75a35e65680\n\n\n6f45a004ad...\nContained_Within\n2ab58b7ce583402bf4cbc90bee643ba5f9503461f91574845264d4f7e3ccb390\n\n\n631ac26992...\nContained_Within\n2ab58b7ce583402bf4cbc90bee643ba5f9503461f91574845264d4f7e3ccb390\n\n\n\n\nRecommendations\n\nCISA recommends that users and administrators consider using the following best practices to strengthen the security posture of their organization's systems. Any configuration changes should be reviewed by system owners and administrators prior to implementation to avoid unwanted impacts.\n\nMaintain up-to-date antivirus signatures and engines.\nKeep operating system patches up-to-date.\nDisable File and Printer sharing services. If these services are required, use strong passwords or Active Directory authentication.\nRestrict users' ability (permissions) to install and run unwanted software applications. Do not add users to the local administrators group unless required.\nEnforce a strong password policy and implement regular password changes.\nExercise caution when opening e-mail attachments even if the attachment is expected and the sender appears to be known.\nEnable a personal firewall on agency workstations, configured to deny unsolicited connection requests.\nDisable unnecessary services on agency workstations and servers.\nScan for and remove suspicious e-mail attachments; ensure the scanned attachment is its \"true file type\" (i.e., the extension matches the file header).\nMonitor users' web browsing habits; restrict access to sites with unfavorable content.\nExercise caution when using removable media (e.g., USB thumb drives, external drives, CDs, etc.).\nScan all software downloaded from the Internet prior to executing.\nMaintain situational awareness of the latest threats and implement appropriate Access Control Lists (ACLs).\n\nAdditional information on malware incident prevention and handling can be found in National Institute of Standards and Technology (NIST) Special Publication 800-83, \"Guide to Malware Incident Prevention & Handling for Desktops and Laptops\".\n\nContact Information\n\n\n1-888-282-0870\nCISA Central\u00a0(UNCLASS)\nCISA SIPR (SIPRNET)\nCISA IC (JWICS)\n\nCISA continuously strives to improve its products and services. You can help by answering a very short series of questions about this product at the following URL: https://us-cert.cisa.gov/forms/feedback/\n\nDocument FAQ\n\nWhat is a MIFR? A Malware Initial Findings Report (MIFR) is intended to provide organizations with malware analysis in a timely manner. In most instances this report will provide initial indicators for computer and network defense. To request additional analysis, please contact CISA and provide information regarding the level of desired analysis.\nWhat is a MAR? A Malware Analysis Report (MAR) is intended to provide organizations with more detailed malware analysis acquired via manual reverse engineering. To request additional analysis, please contact CISA and provide information regarding the level of desired analysis.\nCan I edit this document? This document is not to be edited in any way by recipients. All comments or questions related to this document should be directed to the CISA at 1-888-282-0870 or CISA Central.\nCan I submit malware to CISA? Malware samples can be submitted via three methods:\n\nWeb: https://malware.us-cert.gov\nE-Mail: submit@malware.us-cert.gov\nFTP: ftp.malware.us-cert.gov (anonymous)\n\nCISA encourages you to report any suspicious activity, including cybersecurity incidents, possible malicious code, software vulnerabilities, and phishing-related scams. Reporting forms can be found on CISA's homepage at www.cisa.gov.\n\n\n\n\n\n\n\n\nRevisions\n\nFebruary 17, 2021: Initial Version\n",
  "cves": [
    "CVE-2022-42475",
    "CVE-2022-47966"
  ],
  "techniques": [],
  "advisory": "ar21-048c",
  "title": "MAR-10322463-3.v1 - AppleJeus: Union Crypto | CISA",
  "source": "analysis-reports",
  "id": "2cf032db22b39807bd1823445ed925c47c19aae1200dc0b733fdae00a2b4f166"
}