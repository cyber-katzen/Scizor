{
  "markdown": "\n1. EXECUTIVE SUMMARY\n\nCVSS v3 9.8\nATTENTION: Exploitable remotely/low skill level to exploit\nVendor: Multiple (open source)\nEquipment: uIP-Contiki-OS, uIP-Contiki-NG, uIP, open-iscsi, picoTCP-NG, picoTCP, FNET, Nut/Net\nVulnerabilities: Infinite Loop, Integer Wraparound, Out-of-bounds Read, Integer Overflow, Out-of-bounds Write, Improper Input Validation, Improper Null Termination\n\nCISA is aware of a public report, known as \u201cAMNESIA:33\u201d that details vulnerabilities found in multiple open-source TCP/IP stacks. CISA is issuing this advisory to provide early notice of the reported vulnerabilities and identify baseline mitigations for reducing risks to these and other cybersecurity attacks.\nThe various open-source stacks may be implemented in forked repositories.\n2. RISK EVALUATION\nSuccessful exploitation of these vulnerabilities could allow attackers to corrupt memory, put devices into infinite loops, access unauthorized data, and/or poison DNS cache.\n3. TECHNICAL DETAILS\n3.1 AFFECTED PRODUCTS\nThe following are affected:\n\nuIP-Contiki-OS (end-of-life [EOL]), Version 3.0 and prior\nuIP-Contiki-NG, Version 4.5 and prior\nuIP (EOL), Version 1.0 and prior\nopen-iscsi, Version 2.1.12 and prior\npicoTCP-NG, Version 1.7.0 and prior\npicoTCP (EOL), Version 1.7.0 and prior\nFNET, Version 4.6.3\nNut/Net, Version 5.1 and prior\n\n3.2 VULNERABILITY OVERVIEW\n3.2.1\u00a0\u00a0 \u00a0LOOP WITH UNREACHABLE EXIT CONDITION ('INFINITE LOOP') CWE-835\nThe function used in uIP-Contiki-OS to process IPv6 extension headers and extension header options can be forced into an infinite loop state due to unchecked header/option lengths.\nCVE-2020-13984 has been assigned to this vulnerability. A CVSS v3 base score of 7.5 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H).\n3.2.2\u00a0\u00a0 \u00a0INTEGER WRAPAROUND CWE-190\nThe function used in uIP-Contiki-OS to decapsulate RPL extension headers does not check for unsafe integer conversion when parsing the values provided in a header, allowing an attacker to corrupt memory.\u00a0\nCVE-2020-13985 has been assigned to this vulnerability. A CVSS v3 base score of 7.5 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H).\n3.2.3\u00a0\u00a0 \u00a0LOOP WITH UNREACHABLE EXIT CONDITION ('INFINITE LOOP') CWE-835\nThe function used in uIP-Contiki-OS to decapsulate RPL extension headers does not check the length value of an RPL extension header received, allowing an attacker to cause it to enter an infinite loop.\nCVE-2020-13986 has been assigned to this vulnerability. A CVSS v3 base score of 7.5 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H).\n3.2.4\u00a0\u00a0 \u00a0OUT-OF-BOUNDS READ CWE-125\nThe function in open-iscsi, uIP-Contiki-OS, and uIP that parses incoming transport layer packets (TCP/UDP) does not check the length fields of packet headers against the data available in the packets. Given arbitrary lengths, an out-of-bounds memory read may be performed during the checksum computation.\nCVE-2020-13987 has been assigned to this vulnerability. A CVSS v3 base score of 8.2 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H).\n3.2.5\u00a0\u00a0 \u00a0INTEGER OVERFLOW CWE-190\nThe function in open-iscsi, uIP-Contiki-OS, and uIP that parses the TCP MSS option does not check the validity of the length field of this option, allowing an attacker to force it into an infinite loop when arbitrary TCP MSS values are supplied.\nCVE-2020-13988 has been assigned to this vulnerability. A CVSS v3 base score of 7.5 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H).\n3.2.6\u00a0\u00a0 \u00a0OUT-OF-BOUNDS WRITE CWE-787\nWhen handling TCP urgent data in open-iscsi, uIP-Contiki-OS, and uIP, there are no sanity checks for the value of the urgent data pointer, allowing an attacker to corrupt memory by supplying arbitrary urgent data pointer offsets within TCP packets.\nCVE-2020-17437 has been assigned to this vulnerability. A CVSS v3 base score of 8.2 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:H).\n3.2.7\u00a0\u00a0 \u00a0OUT-OF-BOUNDS WRITE CWE-787\nThe function in open-iscsi and uIP that reassembles fragmented packets does not validate the total length of an incoming packet specified in its IP header, as well as the fragmentation offset value specified in the IP header. This could lead to memory corruption.\nCVE-2020-17438 has been assigned to this vulnerability. A CVSS v3 base score of 7.0 has been calculated; the CVSS vector string is (AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:H).\n3.2.8\u00a0\u00a0 \u00a0IMPROPER INPUT VALIDATION CWE-20\nIncoming DNS replies in uIP are parsed by the DNS client even if there were no outgoing queries. The DNS transaction ID is not sufficiently random. Provided that the DNS cache is quite small (four entries), this facilitates DNS cache poisoning attacks.\nCVE-2020-17439 has been assigned to this vulnerability. A CVSS v3 base score of 8.1 has been calculated; the CVSS vector string is (AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:L/A:L).\n3.2.9\u00a0\u00a0 \u00a0IMPROPER NULL TERMINATION CWE-170\nWhen parsing incoming DNS packets in uIP-Contiki-NG, uIP-Contiki-OS, and uIP, there are no checks whether domain names are null-terminated. This allows an attacker to achieve memory corruption with crafted DNS responses.\nCVE-2020-17440 has been assigned to this vulnerability. A CVSS v3 base score of 7.5 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H).\n3.2.10\u00a0\u00a0 \u00a0IMPROPER INPUT VALIDATION CWE-20\nIn picoTCP-NG and picoTCP the payload length field of IPv6 extension headers are not checked against the data available in incoming packets, allowing an attacker to corrupt memory.\nCVE-2020-17441 has been assigned to this vulnerability. A CVSS v3 base score of 7.5 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H).\n3.2.11\u00a0\u00a0 \u00a0INTEGER OVERFLOW CWE-190\nThe function in picoTCP-NG and picoTCP that processes the hop-by-hop extension header in IPv6 packets and its options lacks any checks against the length field of the header, allowing an attacker to cause the function to enter an infinite loop by supplying arbitrary length values.\nCVE-2020-17442 has been assigned to this vulnerability. A CVSS v3 base score of 7.5 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H).\n3.2.12\u00a0\u00a0 \u00a0INTEGER OVERFLOW CWE-190\nWhen processing ICMPv6 echo requests in picoTCP-NG and picoTCP, there are no checks for whether the ICMPv6 header consists of at least 8 bytes (set by RFC443). This leads to the function that creates ICMPv6 echo replies based on a received request with a smaller header to corrupt memory.\nCVE-2020-17443 has been assigned to this vulnerability. A CVSS v3 base score of 8.2 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H).\n3.2.13\u00a0\u00a0 \u00a0INTEGER OVERFLOW CWE-190\nThe function in picoTCP-NG and picoTCP that processes IPv6 headers does not check the lengths of extension header options, allowing an attacker to force this function into an infinite loop with crafted length values.\nCVE-2020-17444 has been assigned to this vulnerability. A CVSS v3 base score of 7.5 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H).\n3.2.14\u00a0\u00a0 \u00a0OUT-OF-BOUNDS READ CWE-125\nThe function in picoTCP-NG and picoTCP that processes the IPv6 destination options extension header does not check the validity of its options lengths, allowing an attacker to corrupt memory and/or put the function into an infinite loop with crafted length values.\nCVE-2020-17445 has been assigned to this vulnerability. A CVSS v3 base score of 7.5 has been calculated; the CVSS vector string is \u00a0(AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H).\n3.2.15\u00a0\u00a0 \u00a0OUT-OF-BOUNDS READ CWE-125\nThe function in FNET does not check whether domain names are null terminated when parsing Link-local Multicast Name Resolution (LLMNR) requests. This may allow an attacker to read out of bounds.\nCVE-2020-17467 has been assigned to this vulnerability. A CVSS v3 base score of 8.2 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H).\n3.2.16\u00a0\u00a0 \u00a0OUT-OF-BOUNDS READ CWE-125\nThe function in FNET that processes the IPv6 hop-by-hop extension header does not check the validity of its options lengths, allowing an attacker to corrupt memory.\nCVE-2020-17468 has been assigned to this vulnerability. A CVSS v3 base score of 7.5 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H).\n3.2.17\u00a0\u00a0 \u00a0OUT-OF-BOUNDS READ CWE-125\nThe IPv6 packet reassembly function in FNET does not check whether the received fragments are properly aligned in memory, allowing an attacker to perform memory corruption with crafted IPv6 fragmented packets.\nCVE-2020-17469 has been assigned to this vulnerability. A CVSS v3 base score of 5.9 has been calculated; the CVSS vector string is \u00a0(AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H).\n3.2.18\u00a0\u00a0 \u00a0IMPROPER INPUT VALIDATION CWE-20\nThe function in FNET that initializes the DNS client interface structure does not set sufficiently random transaction IDs (they will be always set to 1), facilitating DNS cache poisoning attacks.\nCVE-2020-17470 has been assigned to this vulnerability. A CVSS v3 base score of 4.0 has been calculated; the CVSS vector string is (AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:L/A:N).\n3.2.19\u00a0\u00a0 \u00a0OUT-OF-BOUNDS READ CWE-125\nThe function in uIP-Contiki-NG, uIP-Contiki-OS, and uIP that processes DNS responses does not check whether the number of responses specified in the DNS packet header correspond to the response data available in the DNS packet, which may allow an attacker to corrupt memory.\nCVE-2020-24334 has been assigned to this vulnerability. A CVSS v3 base score of 8.2 has been calculated; the CVSS vector string is \u00a0(AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H).\n3.2.20\u00a0\u00a0 \u00a0OUT-OF-BOUNDS READ CWE-125\nThe function in uIP-Contiki-NG, uIP-Contiki-OS, and uIP that parses domain names lacks bounds checks, allowing an attacker to corrupt memory with crafted DNS packets.\nCVE-2020-24335 has been assigned to this vulnerability. A CVSS v3 base score of 7.5 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H).\n3.2.21\u00a0\u00a0 \u00a0OUT-OF-BOUNDS READ CWE-125\nThe function in uIP-Contiki-NG and uIP-Contiki-OS for parsing DNS records in DNS response packets sent over NAT64 does not validate the length field of the response records, allowing an attacker to corrupt memory.\nCVE-2020-24336 has been assigned to this vulnerability. A CVSS v3 base score of 9.8 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).\n3.2.22\u00a0\u00a0 \u00a0LOOP WITH UNREACHABLE EXIT CONDITION ('INFINITE LOOP') CWE-835\nThe function in picoTCP-NG and picoTCP that processes TCP options does not validate their lengths, allowing an attacker to put the function into an infinite loop with uncommon/unsupported TCP options that have crafted length values.\nCVE-2020-24337 has been assigned to this vulnerability. A CVSS v3 base score of 7.5 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H).\n3.2.23\u00a0\u00a0 \u00a0OUT-OF-BOUNDS WRITE CWE-787\nThe function in picoTCP and picoTCP-NG that parses domain names lacks bounds checks, allowing an attacker to corrupt memory with crafted DNS packets.\nCVE-2020-24338 has been assigned to this vulnerability. A CVSS v3 base score of 9.8 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).\n3.2.24\u00a0\u00a0 \u00a0OUT-OF-BOUNDS READ CWE-125\nThe function in picoTCP and picoTCP-NG that processes DNS responses does not check whether the number of responses specified in the DNS packet header correspond to the response data available in the DNS packet, allowing an attacker to perform memory corruption.\nCVE-2020-24339 has been assigned to this vulnerability. A CVSS v3 base score of 7.5 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H).\n3.2.25\u00a0\u00a0 \u00a0OUT-OF-BOUNDS READ CWE-125\nThe function in picoTCP and picoTCP-NG that processes DNS responses does not check whether the number of responses specified in the DNS packet header correspond to the response data available in the DNS packet, allowing an attacker to perform memory corruption.\nCVE-2020-24340 has been assigned to this vulnerability. A CVSS v3 base score of 8.2 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H).\n3.2.26\u00a0\u00a0 \u00a0OUT-OF-BOUNDS READ CWE-125\nThe TCP input data processing function in picoTCP-NG and picoTCP does not validate the length of incoming TCP packets, allowing an attacker to read out of bounds and perform memory corruption.\nCVE-2020-24341 has been assigned to this vulnerability. A CVSS v3 base score of 8.2 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H).\n3.2.27\u00a0\u00a0 \u00a0IMPROPER NULL TERMINATION CWE-170\nWhen parsing incoming DNS packets in FNET,\u00a0there are no checks whether domain names are null-terminated. This may allow an attacker to achieve memory corruption and/or memory leak.\nCVE-2020-24383 has been assigned to this vulnerability. A CVSS v3 base score of 6.5 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:L).\n3.2.28\u00a0\u00a0 \u00a0OUT-OF-BOUNDS READ CWE-125\nThe function in Nut/Net that processes DNS questions/responses has several issues: there is no check on whether a domain name is NULL-terminated; the DNS response data length is not checked (can be set to arbitrary value from a packet); the number of DNS queries/responses (set in DNS header) is not checked against the data present; the length byte of a domain name in a DNS query/response is not checked and is used for internal memory operations.\nCVE-2020-25107 has been assigned to this vulnerability. A CVSS v3 base score of 7.5 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H).\n3.2.29\u00a0\u00a0 \u00a0OUT-OF-BOUNDS WRITE CWE-787\nThe function in Nut/Net that processes DNS questions/responses has several issues: there is no check on whether a domain name is NULL-terminated; the DNS response data length is not checked (can be set to arbitrary value from a packet); the number of DNS queries/responses (set in DNS header) is not checked against the data present; the length byte of a domain name in a DNS query/response is not checked and is used for internal memory operations.\nCVE-2020-25108 has been assigned to this vulnerability. A CVSS v3 base score of 7.5 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H).\n3.2.30\u00a0\u00a0 \u00a0OUT-OF-BOUNDS READ CWE-125\nThe function in Nut/Net that processes DNS questions/responses has several issues: there is no check on whether a domain name is NULL-terminated; the DNS response data length is not checked (can be set to arbitrary value from a packet); the number of DNS queries/responses (set in DNS header) is not checked against the data present; the length byte of a domain name in a DNS query/response is not checked and is used for internal memory operations.\nCVE-2020-25109 has been assigned to this vulnerability. A CVSS v3 base score of 8.2 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H).\n3.2.31\u00a0\u00a0 \u00a0OUT-OF-BOUNDS READ CWE-125\nThe function in Nut/Net that processes DNS questions/responses has several issues: there is no check on whether a domain name is NULL-terminated; the DNS response data length is not checked (can be set to arbitrary value from a packet); the number of DNS queries/responses (set in DNS header) is not checked against the data present; the length byte of a domain name in a DNS query/response is not checked and is used for internal memory operations.\nCVE-2020-25110 has been assigned to this vulnerability. A CVSS v3 base score of 8.2 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H).\n3.2.32\u00a0\u00a0 \u00a0OUT-OF-BOUNDS WRITE CWE-787\nThe function in Nut/Net that processes DNS questions/responses has several issues: there is no check on whether a domain name is NULL-terminated; the DNS response data length is not checked (can be set to arbitrary value from a packet); the number of DNS queries/responses (set in DNS header) is not checked against the data present; the length byte of a domain name in a DNS query/response is not checked and is used for internal memory operations.\nCVE-2020-25111 has been assigned to this vulnerability. A CVSS v3 base score of 9.8 has been calculated; the CVSS vector string is (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).\n3.2.33\u00a0\u00a0 \u00a0OUT-OF-BOUNDS WRITE CWE-787\nVulnerabilities in uIP-Contiki-OS (EOL) provide insufficient checks for the IPv4/IPv6 header length and inconsistent checks for the IPv6 header extension lengths, which may allow an attacker to corrupt memory.\nCVE-2020-25112 has been assigned to this vulnerability. A CVSS v3 base score of 8.1 has been calculated; the CVSS vector string is \u00a0(AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H).\n3.3 BACKGROUND\n\nCRITICAL INFRASTRUCTURE SECTORS: Multiple\nCOUNTRIES/AREAS DEPLOYED: Worldwide\nCOMPANY HEADQUARTERS LOCATION: Various\n\n3.4 RESEARCHER\nDaniel dos Santos, Stanislav Dashevskyi, Jos Wetzels, and Amine Amri of Forescout Research Labs reported these vulnerabilities to CISA.\n4. MITIGATIONS\n\nuIP is EOL (end-of-life). See general recommendations below.\u00a0\nuIP-Contiki-OS is EOL. See general recommendations below.\npicoTCP is EOL. See general recommendations below.\nThe maintainers of FNET recommend users update to Version 4.7.0 or later.\u00a0\nThe maintainers of uIP-Contiki-NG recommend users update to the latest version.\nThe maintainers of open-iscsi recommend users update to the latest version.\nContact the maintainers of picoTCP-NG for recommended updates.\nContact the maintainers of Nut/Net and find the latest version on their website.\n\nAdditional vendors affected by the reported vulnerabilities have also released security advisories related to their affected products. Those advisories are as follows:\n\nDevolo\nEMU Electronic AG\nFEIG\nGenetec\nHarting\nHensoldt\nMicrochip\nNanotec\nNT-Ware\nTagmaster\nSiemens\nUniflow\nYanzi Networks\n\nCISA recommends users take defensive measures to minimize the risk of exploitation of this vulnerability. Specifically, users should:\n\nMinimize network exposure for all control system devices and/or systems, and ensure that they are not accessible from the Internet.\nLocate control system networks and remote devices behind firewalls, and isolate them from the business network.\nWhen remote access is required, use secure methods, such as Virtual Private Networks (VPNs), recognizing that VPNs may have vulnerabilities and should be updated to the most current version available. Also recognize that VPN is only as secure as the connected devices.\nUse an internal DNS server that performs DNS-over-HTTPS for lookups.\n\nCISA reminds organizations to perform proper impact analysis and risk assessment prior to deploying defensive measures.\n\nCISA also provides a section for control systems security recommended practices on the ICS webpage on\u00a0us-cert.cisa.gov. Several recommended practices are available for reading and download, including Improving Industrial Control Systems Cybersecurity with Defense-in-Depth Strategies.\nAdditional mitigation guidance and recommended practices are publicly available on the ICS webpage on us-cert.cisa.gov in the Technical Information Paper, ICS-TIP-12-146-01B--Targeted Cyber Intrusion Detection and Mitigation Strategies.\n\nOrganizations observing any suspected malicious activity should follow their established internal procedures and report their findings to CISA for tracking and correlation against other incidents.\nNo known public exploits specifically target these vulnerabilities.\u00a0\n",
  "cves": [
    "CVE-2020-17470",
    "CVE-2020-24339",
    "CVE-2020-24340",
    "CVE-2020-17469",
    "CVE-2020-17438",
    "CVE-2020-13985",
    "CVE-2020-17440",
    "CVE-2020-17467",
    "CVE-2020-24338",
    "CVE-2020-25109",
    "CVE-2020-13986",
    "CVE-2020-24336",
    "CVE-2020-13988",
    "CVE-2020-24335",
    "CVE-2020-25108",
    "CVE-2020-25111",
    "CVE-2020-17444",
    "CVE-2020-13987",
    "CVE-2020-17439",
    "CVE-2020-24383",
    "CVE-2020-25110",
    "CVE-2020-13984",
    "CVE-2020-25112",
    "CVE-2020-24334",
    "CVE-2020-17443",
    "CVE-2020-25107",
    "CVE-2020-17441",
    "CVE-2020-24337",
    "CVE-2020-17445",
    "CVE-2020-24341",
    "CVE-2020-17437",
    "CVE-2020-17442",
    "CVE-2020-17468"
  ],
  "techniques": [],
  "advisory": "icsa-20-343-01",
  "title": "Multiple Embedded TCP/IP Stacks | CISA",
  "source": "ics-advisories",
  "id": "caae9f37a76e8a58279849c3c7cf3715da83fcbb0aec45335d219c3d6d35cae0"
}