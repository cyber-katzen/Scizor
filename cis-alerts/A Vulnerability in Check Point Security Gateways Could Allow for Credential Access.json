{
  "id": "af8dd21f277d5bfad6826eb5ea56adf18f5168f920e5043351529ec997b147b9",
  "markdown": "HomeCIS AdvisoriesA Vulnerability in Check Point Security Gateways Could Allow for Credential AccessA Vulnerability in Check Point Security Gateways Could Allow for Credential AccessMS-ISAC ADVISORY NUMBER:2024-065DATE(S) ISSUED:05/31/2024OVERVIEW:A vulnerability has been discovered in Check Point Security Gateway Products that could allow for credential access. A Check Point Security Gateway sits between an organization\u2019s environment and the Internet to enforce policy and block threats and malware. Successful exploitation of this vulnerability could allow for credential access to local accounts due to an arbitrary file read vulnerability. Other sensitive files such as SSH keys and certificates may also be read. Depending on the privileges associated with the accounts, an attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Local accounts that are configured to have fewer rights on the system could be less impacted than those that operate with administrative rights.THREAT INTELLIGENCE:Check Point is aware that an exploit for CVE-2024-24919 exists in the wild and is being actively exploited. Additionally, the cybersecurity organization mnemonic has reported observing threat actors extracting ntds.dit, a store of Active Directory hashes on a Domain Controller, from compromised customers within 2-3 hours after logging in with a local user.SYSTEMS AFFECTED:Quantum Security Gateway and CloudGuard Network Security prior to R81.20, R81.10, R81, R80.40Quantum Maestro and Quantum Scalable Chassis prior to R81.20, R81.10, R80.40, R80.30SP, R80.20SPQuantum Spark Gateways prior to R81.10.x, R80.20.x, R77.20.xRISK:Government:Large and medium government entitiesHIGHSmall governmentMEDIUMBusinesses:Large and medium business entitiesHIGHSmall business entitiesMEDIUMHome Users:LOWTECHNICAL SUMMARY:TECHNICAL SUMMARY:\nA vulnerability has been discovered in Check Point Security Gateway Products that could allow for credential access. The vulnerability affects Security Gateway products making use of the IPsec VPN or Mobile Access. Exploiting this vulnerability can result in accessing arbitrary files on the system including /etc/shadow which contains password hashes for local accounts on the Security Gateway. The hashes can be cracked and allow for the attacker to authenticate as those users, allowing for lateral movement and the potential to gain domain admin privileges. Details of the vulnerability are as follows:\nTactic: Credential Access (TA0006):\nTechnique: Exploitation for Credential Access (T1212):\n\nArbitrary file read vulnerability (CVE-2024-24919)\nSuccessful exploitation of this vulnerability could allow for credential access to local accounts due to an arbitrary file read vulnerability. Other sensitive files such as SSH keys and certificates may also be read. Depending on the privileges associated with the accounts, an attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Local accounts that are configured to have fewer rights on the system could be less impacted than those that operate with administrative rights.\nRECOMMENDATIONS:We recommend the following actions be taken:\n\nApply the updates provided by Check Point to vulnerable systems immediately after appropriate testing. (M1051: Update Software)\no   Safeguard 7.1 : Establish and Maintain a Vulnerability Management Process: Establish and maintain a documented vulnerability management process for enterprise assets. Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard.\no   Safeguard 7.2 : Establish and Maintain a Remediation Process: Establish and maintain a risk-based remediation strategy documented in a remediation process, with monthly, or more frequent, reviews.\no   Safeguard 7.6 : Perform Automated Vulnerability Scans of Externally-Exposed Enterprise Assets: Perform automated vulnerability scans of externally-exposed enterprise assets using a SCAP-compliant vulnerability scanning tool. Perform scans on a monthly, or more frequent, basis.\no   Safeguard 7.7 : Remediate Detected Vulnerabilities: Remediate detected vulnerabilities in software through processes and tooling on a monthly, or more frequent, basis, based on the remediation process.\no   Safeguard 16.13 Conduct Application Penetration Testing: Conduct application penetration testing. For critical applications, authenticated penetration testing is better suited to finding business logic vulnerabilities than code scanning and automated security testing. Penetration testing relies on the skill of the tester to manually manipulate an application as an authenticated and unauthenticated user.\no   Safeguard 18.1 : Establish and Maintain a Penetration Testing Program: Establish and maintain a penetration testing program appropriate to the size, complexity, and maturity of the enterprise. Penetration testing program characteristics include scope, such as network, web application, Application Programming Interface (API), hosted services, and physical premise controls; frequency; limitations, such as acceptable hours, and excluded attack types; point of contact information; remediation, such as how findings will be routed internally; and retrospective requirements.\no   Safeguard 18.2 : Perform Periodic External Penetration Tests: Perform periodic external penetration tests based on program requirements, no less than annually. External penetration testing must include enterprise and environmental reconnaissance to detect exploitable information. Penetration testing requires specialized skills and experience and must be conducted through a qualified party. The testing may be clear box or opaque box.\no   Safeguard 18.3 : Remediate Penetration Test Findings: Remediate penetration test findings based on the enterprise\u2019s policy for remediation scope and prioritization.\nApply the Principle of Least Privilege to all systems and services. Run all software as a non-privileged user (one without administrative privileges) to diminish the effects of a successful attack. (M1026: Privileged Account Management) \nSafeguard 4.7: Manage Default Accounts on Enterprise Assets and Software: Manage default accounts on enterprise assets and software, such as root, administrator, and other pre-configured vendor accounts. Example implementations can include: disabling default accounts or making them unusable.\nSafeguard 5.4: Restrict Administrator Privileges to Dedicated Administrator Accounts: Restrict administrator privileges to dedicated administrator accounts on enterprise assets. Conduct general computing activities, such as internet browsing, email, and productivity suite use, from the user\u2019s primary, non-privileged account.\nREFERENCES:CVEhttps://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-24919Check Pointhttps://support.checkpoint.com/results/sk/sk182336https://blog.checkpoint.com/security/enhance-your-vpn-security-posture/Get Email Updates When Cyber Threats Like This Arise Subscribe to Advisories Related ResourcesCheck Point FirewallInformation HubAdvisories See All Advisories Blog Post08.09.2024Top 10 Malware Q2 2024Read MoreAdvisory08.07.20242024-088: Multiple Vulnerabilities in Google Android OS Could Allow for Privilege EscalationRead MoreAdvisory08.07.20242024-087: Multiple Vulnerabilities in Google Chrome Could Allow for Arbitrary Code ExecutionRead MoreBlog Post07.26.2024CrowdStrike Falcon Outage Exploited for Social EngineeringRead More",
  "cves": [
    "CVE-2024-24919"
  ],
  "techniques": [
    "T1212"
  ],
  "title": "A Vulnerability in Check Point Security Gateways Could Allow for Credential Access",
  "source": "cis",
  "advisory": "cybersecurity-alerts"
}