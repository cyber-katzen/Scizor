{
  "markdown": " \nU/OO/ 126067 -24 | PP-24-0102  | March 2024 Ver. 1.0 \n| Cybersecurity Information  \nNational  \nSecurity  \nAgency  \nCybersecurity &  \nInfrastructure  \nSecurity  \nAgency  \nImplement Network Se gmentation and Encryption in \nCloud Environments  \nExecutive summary  \nNetwork security is a crucial component for cloud users to  configure  properly . \nHistorically , network security practices have focused on perimeter  securi ty, with few \nadditional restrictions once authenticated to an organizations internal network  and the \nacceptance of unauthenticated and vulnerable internal protocols . Over t he years , this \nhas cha nged with the push to adopt Zero Trust (ZT) security principles  such as:  \n Tying identity information into network requests  \n Implementing end-to-end encryption  \n Micro  segmenting the network  \nThis cybersecurity information sheet (CS I) makes  recommendations for implementing \nthese principles in a cloud environment , which can differ from on -prem ises (on -prem)  \nnetworks . While on -prem networks require specialized appliances to enable ZT, c loud \ntechnologies natively provide the necessary infrastru cture and services for \nimplementing these recommendations to varying degrees . This CSI focuses  on best \npractices using features commonly  available i n cloud environments.   \nNetwork  encryption  \nEncrypting data in transit is an integral part of cybersecurity. A well-positioned  malicious \ncyber actor ( MCA ) may be able  to observe  network traffic in an attempt to capture \nsensitive information (such as user credentials) passed over the network either \nunencrypted  or weakly encrypted .  \nATT&CK Tactic  Technique  \nCredential Access  Network Sniffing [ T1040 ] \nCredential Access, Collection  Adversary -in-the-Middle  [T1557 ] \nOne recommended mitigation to prevent this is to encrypt data in transit using NSA \nrecommended algorithms  in the Commercial National Security Algorithm (CNSA) Suite  \nor using National Institute of Standards and Technology (NIST) recommended \nalgorithms . [1], [2] \n\n \n \n \nU/OO/ 126067 -24 | PP-24-0102  | March 2024 Ver. 1.0  2 NSA & CISA  | Implement Network Segmentation and Encryption  in Cloud Environments  \nATT&CK Mitigation  \nEncrypt Sensitive Information [ M1041 ] \n \nD3FEND Tactic  Countermeasure  \nNetwork Isolation  Encrypted Tunnels [ D3-ET] \nCloud network traffic can be grouped into two general categories: client  connecti ons to \nthe cloud platform  and internal cloud traffic between services.  The f ollowing subsections \ndiscuss actions cloud users should take to ensure their data is secure  in transit.  \nConnecting to the cloud  \nClient  connections to the cloud environment must be securely encrypted. Users can \naccess c loud platform application programming  interfaces ( APIs ) through a web \nbrowser  or a command line interface (CLI). Cloud platforms generally require client \nconnections to be encrypted; however, they may allow clients to use weak algorithms  to \nmaintain support for connections from legacy clients.  All cloud u sers should ensure they \nare connecting to the cloud platform over protocols using C NSA Suite algorithms .  \nWhile CNSA Suite 1.0 is the current standard  for National Security Systems (NSS) , \norganizations should push to adopt CNSA Suite 2.0 requirements where possible to \nimprove their security posture . [1] NSA selected the algorithms from those chosen by \nNIST ; while use of CNSA algorithms are recomme nded, organizations that do not own \nor operate  national security systems may use NIST recommended algorithms \n(preferably those in the Federal Information Processing Standard (FIPS) 140 -3) to \nimprove their security posture. [2], [3] \nFor most application -specific protocols ( i.e., above TCP or UDP), NSA  and CISA  \nrecommend TLS 1.2 or later. This includes any c onnections from customer applications \nthat interact with the organizations cloud environment. Connections to cloud resources \nshould also always pass over a secure channel. Cloud resources like virtual machines \nand customer  applications deployed in PaaS offerings, are the customer s responsibility \nto secure. The cloud service providers ( CSPs) security policies will not protect a \ncustomer application deployed in the cloud that does not implement  encryption.  \nOrganizations c an use virtual private networks (VPNs) to connect to the cloud, ensuring \nthat users traffic to the cloud pass es through an encrypted channel. For tunneling \ngeneral IP traffic (i.e. , connecting through a VPN) using commercial components, NSA  \n\n \n \n \nU/OO/ 126067 -24 | PP-24-0102  | March 2024 Ver. 1.0  3 NSA & CISA  | Implement Network Segmentation and Encryption  in Cloud Environments  \nand CISA  recommend using IPsec  VPNs. In particular, IPsec VPN products that have \nbeen tested and validated and are on the  National  Information  Assurance  Partnership  \n(NIAP)  Product  Compliant  List. TLS-based  VPNs lack standardization to objectively \nmeasure their assurance, and are currently not recommend ed for tunneling of general  \npurpose IP traffic. Organizations  using this option can configure their cloud tenant to \nonly accept connections from the VPN . Then  they can use the VPN to centrally manage \naccess and log  and monitor the network traffic , providing an additional layer of security \nand visibility for the organization into the usage of their cloud tenant. For additional \nguidance on VPNs see NSAs reports : Selecting and Hardening Remote Access VPN \nSolutions , Network Infrastructure Security Guide , and Configuring IPsec Virtual Private \nNetworks . [4], [5], [6] Organizations can use VPNs to secure both client connections to \nthe tenant and connections to cloud resources. Wh ile they are not the only mechanism \nfor doing  this, VPNs are a good option for ensuring consistent enforcement of \nencryption requirements across the organization.   \nPrivate connectivity  \nCSPs frequently offer private connectivity options. These offerings provide \norganizations using cloud resources a way to connect to the cloud providers \ninfrastructure directly over a private network connection rather than over the Internet . \nThis greatly r educes the chances of an MCA  being able to sniff an organizations \nnetwork traffic  or target vulnerable protocols for exploitation . These options will vary by \nCSP, bu t may include offerings such as direct network connections. Direct network \nconnections all ow organizations to connect to the CSPs infrastructure directly or \nthrough a third party  (i.e., one of CSPs connection partners) , rather than connecting \nover the Internet .  \nTraffic mirroring  \nMany CSPs offer a traffic mirroring service, which allows users  to duplicate and forward \ntraffic. Defenders can use this service to collect incoming network traffic and perform \ndeep packet inspection to identify potential threats. However, this can also be leveraged \nby MCAs in their post -exploitation activities. MCAs with enough privileges in the tenant \nfrom initial exploitation activities can use these services to collect and exfiltrate data that \nhas been decrypted at the load balancer . [7] \n \n\n \n \n \nU/OO/ 126067 -24 | PP-24-0102  | March 2024 Ver. 1.0  4 NSA & CISA  | Implement Network Segmentation and Encryption  in Cloud Environments  \nATT&CK Tactic  Technique  \nExfiltration  Automated Exfiltration: Traffic Duplication [ T1020.001 ] \n \nUsers  deploying applications \nor running compute \ninstances in the cloud behind \na load balancer should  be \naware of whether the load \nbalancing service uses TLS \ntermination. Organizations \nshould closely monitor usage \nof traffic mirroring within a \ncloud tenant to id entify \nmalicious usage. NSA has \nfurther discussed risks and \ndeployment models for TLS \ninspection in Managing Risks \nfrom Transport Layer \nSecurity Inspection . [8]  \nFigure 1: Exfiltration using traffic mirroring example  \nBackend traffic  \nWhile  work ing in the cloud , data will necessarily traverse the C SPs network between \nservices. For example, if a user uploads data to be stored in a cloud storage bucket , \nencrypted with a customer -managed key, the key management service and the data \nstorage service must communicate to perform this function. Ideally , this traffic should be \nencrypted and isolated from traffic of other tenants. As these operations are a part of \nthe CSPs environment , cloud users  generally  do not have insight  or control over these \nprocesses. Organizations decid ing what cloud platform to use can review  the CSPs \ndocumentation and ask the provider  how they protect customer data in their backend, to \ndetermine if the CSPs practices fit the organizations needs.   \nOrganizations operating in the cloud  should  be aware that traffic between customer \nresources in the cloud do es not necessarily stay within the cloud. In some cases,  \ncustomer traffic may be routed over the Internet , opening it up for inspection or even \nmani pulation by a well -positioned MCA. To mitigate such risks , organizations must \n\n\n \n \n \nU/OO/ 126067 -24 | PP-24-0102  | March 2024 Ver. 1.0  5 NSA & CISA  | Implement Network Segmentation and Encryption  in Cloud Environments  \nsecure traffic between customer resources. Additionally, s ome CSPs offer private API \nendpoints that customers can use to ensure that traffic in the virtual enclave to a CSP \nAPI w ill stay within the cloud.  Developers writing applications to run  in the cloud can use \nthese APIs rather than the usual frontend APIs to allow their applications to connect \ndirectly to cloud services rather than be routed back out to the Internet .  \nIf external services need to interact with the application deployed in the cloud , \norgan izations can configure identity -based access policies to restrict access to the \napplication  to trusted parties  using a policy enforcement point . For more information on \nthis, see CISAs Trusted Internet  Connectio ns 3.0: Cloud Use Case  report . [9] \nNetwork segmentation  \nNIST defines network segmentation as splitting a network into subsections  where  \nfirewalls reject unnecessary traffic  for that section . [10] This is a foundational \ncybersecurity principle, which , when properly implemented, can isolate malicious \nactivities to a limited part of the network and minimize  the effect of a breach .  \nHisto rically, the focus of network security has been on the perimeter, setting up firewalls \nto secure an organizations network without  placing  any additional restrictions once \nusers are authenticated. When u sing this perimeter -focused approach to network \nsecur ity, MCA s who breach that first line of defense will have access to target  user \ntraffic and organization  resources , exploiting any vulnerable or unauthenticated network \nprotocols  and delivering malicious payloads . In modern cloud environments, there \nshould be more than only a perimeter -focused defense. CSPs should provide a level of \nisolation between customer tenants; h owever,  the customer  is responsib le for properly \nconfigur ing networking within their tenant . Many CSPs offer managed services to \nenforce  this segmentation , such as  traffic management, network gateway, and load \nbalancing solutions .  \nATT&CK Tactic  Technique  \nLateral Movement  Remote Services: Cloud Services [ T1021.007 ] \nLateral Movement  Remote Services: Direct Cloud VM Connections  [T1021.008 ] \nAt a minimum, resources from different teams should be separated from each other and \nfrom tenant administrator groups. This high -level separation is known as macro  \nsegmentation  and is the first step in this process. Any unnecessary network services, \n\n \n \n \nU/OO/ 126067 -24 | PP-24-0102  | March 2024 Ver. 1.0  6 NSA & CISA  | Implement Network Segmentation and Encryption  in Cloud Environments  \nprotocols , or ports should be disabled . For example, SSH should be disabled on all \ncloud compute instances that do not require it , and public IPs should only be configured \nfor production instances that require them . Ideally, only data flow paths necessary for \ncontinued normal operations within the environment should be allowed. For example, if \ntwo applications deployed in an organizations cloud environment do not need to \ncommunicate, no communication path between them should exist . Additionally,  if the \nonly co mmunication needed between them is for one to send telemetry data to the \nother, then that one -way data path should be the only path allowed. This granular \nsegmentation based around approved data ingress  and egress points is known as \nmicro  segmentation . This is what organizations should strive for , and it is achievable \nusing cloud native capabilities .  \nATT&CK Mitigation  \nNetwork Segmentation [ M1030 ] \n \nD3FEND Tactic  Countermeasure  \nNetwork Isolation  Network Traffic Filtering [D3-NTF] \n \nTypically , CSPs offer users  the ability  to configure firewall policies and  assign them to \ntheir virtual compute instances. Users should  be aware of what the default rules are \nand, if needed , set their own default policy to deny all external traffic to the instance. \nDifferent CSPs  offer different levels of granularity to which policies can be refine d. In \nsome cases, general policies can be created for groups of instances and then additional \naccess control policies can be added to individual instances to further refine. When \nusing compute instances in a cloud environment , users should review the CSP s \ndocumentation to ensure they understand how traffic is handled and can be restricted to \nconfigure this  properly.  \nWhen developing applications in the cloud , developers  can also use a service mesh to \nhelp manage and map traffic flows.  A service mesh is  essentially a web of lightweight \nproxies that run as sidecars to each micro -service component of an application and \nmanage service -to-service  communication. The control plane of the service mesh \nmanages, monitor s, and pushes policies out to the sidecar instances. Service mesh es \ntypically include monitoring functionality, which can provide developers insight into \n\n \n \n \nU/OO/ 126067 -24 | PP-24-0102  | March 2024 Ver. 1.0  7 NSA & CISA  | Implement Network Segmentation and Encryption  in Cloud Environments  \nnormal traffic patterns for a given distributed application. This information can inform \npolicies enforcing encryption between services, authorization policies, and more.  \nFigure 2: Example of a service mesh  \nWhen running large, distributed applications , it can be difficult to  keep track of all of the \ncommunication path s that are necessary, which can in turn , make it difficult to identify \nanomalies.  Service meshes are useful for such deployments as they simplify service -to-\nservice communications for the developers, facilitate service -to-service encryption for \nadded secur ity, and  monitor traffic . This enables developers to implement micro  \nsegmentation without breaking services, and it provides detailed metrics  that can be \npassed to anomaly  detection services.  \nVirtual networking  \nCSPs offer  a virtual networking option  that allows users to launch cloud resources in a \nlogically isolated virtual network  (sometimes referred to as a Virtual Private Cloud or \nVPC) . The specific functionality will vary by provider, but these offerings usually include  \ntraffic flow logging, firewalls, troubleshooting  and analyzer tools, and private IP \nsubnetting. These services can be leveraged to implement segmentation , as well as \nadditional security and monitoring functionality. Traffic flow logs should be enabled, as  \nthey provide  useful information for organizations performing threat hunting in their \nenvironment. Management privileges should be restricted according to the principle of \nleast privilege, and those with administrator privileges should use phishing -resista nt \n\n\n \n \n \nU/OO/ 126067 -24 | PP-24-0102  | March 2024 Ver. 1.0  8 NSA & CISA  | Implement Network Segmentation and Encryption  in Cloud Environments  \nMFA. For additional guidance  see the reports : Use Secure Cloud Identity and Access \nManagement  Practices  and Managing Risk from Software Defined Networking \nControllers . \nBest practices  \nSecure  networking practices adhering to ZT principles are vital to ensur e the security of \ncloud resources. Cloud customers should follow these best practices to help prevent, \ndetect, and respond to t hreats to the cloud environment:   \n Connect to the cloud environment and cloud resources through a secure \nencrypted channel . NSS mus t use CNSA -approved cipher suites for all client \nconnections. Other organizations should use CNSA or NIST recommended \ncipher suites.  \n If using the cloud for more sensitive workloads , consider  using  private \nconnectivity options .  \n Be aware that data passed be tween customer resources in the cloud may \ntraverse the Internet , and take precautions to encrypt such data.  \n Employ micro  segmentation practices, separating traffic between services that do \nnot require communication paths. Configure firewalls within the org anizations \ntenant to separate compute instances from each other, only allowing necessary \ndata flow path s. \n Monitor  use of traffic mirroring services  for potential malicious exfiltration \nattempts . \nFurther  guidance  \nAdditional cybersecurity guidance can be found at NSA Cybersecurity Advisories & \nGuidance . Some papers that build on the topics discussed in this CSI include:  \n Hybrid and Mult i-Cloud: When moving from a single cloud to a hybrid cloud or \nmulti -cloud environment there are additional complexities introduced. For more \ndetails on how to address these complexities , see Account for Complexities \nIntroduced by Hybrid Cloud and Multi -Cloud Environments .  \n Logging and Threat Hunting: It is vital for organizations  threat hunting and \nincident response professionals that network traf fic be thoroughly logged. For \nmore details on what to log in cloud environments , see Manage Cloud Logs for \nEffective Threat Huntin g.  \n\n \n \n \nU/OO/ 126067 -24 | PP-24-0102  | March 2024 Ver. 1.0  9 NSA & CISA  | Implement Network Segmentation and Encryption  in Cloud Environments  \n Embracing a Zero Trust Security Model   \n Selecting and Hardening Remote Access VPN Solutions   \n Network Infrastructure Security Guide  \n Configuring IPsec  Virtual Private Networks  \n Managing Risk from Software Defined Networking Controllers  \n Managing Risk from Transport Layer Security Inspection  \nAdditional cybersecurity guidance  from CI SA includes:  \n Trusted Internet  Connections 3.0 : Cloud Use Case   \nWorks c ited \n[1] National Security Agency . Announcing the Commercial National Security Algorithm Suite 2.0. \n2022.  https://media.defense.gov/2022/Sep/07/2003071834/ -1/-\n1/0/CSA_CNSA_2.0_ALGORITHMS_ .PDF   \n[2] National Institute of Standards and Technology.  Cryptographic Standards and Guidelines . 2023. \nhttps://csrc.nist.gov/projects/cryptographic -standards -and-guidelines   \n[3] National Institute of Standards and Technology.  FIPS 140 -3: Security Requirements for \nCryptographic Modules . 2019. https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.140 -3.pdf   \n[4] Natio nal Security Agency . Selecting and Hardening Remote Access VPN Solutions. 2021. \nhttps://media.defense.gov/2021/Sep/28/200286318 4/-1/-1/0/CSI_SELECTING -HARDENING -\nREMOTE -ACCESS -VPNS -20210928.PDF   \n[5] National Security Agency . Network Infrastructure Security Guide. 2023. \nhttps://media.defense.gov/2022/Jun/15/2003018261/ -1/-\n1/0/CTR_NSA_NETWORK_INFRASTRUCTURE_SECURITY_GUIDE_20220615.PDF  \n[6] National Security Agency . Configuring IPsec Virtual Private Networks. 2020. \nhttps://media.defense.gov/2021/Sep/16/2002855928/ -1/-\n1/0/CONFIGURING_IPSEC_VIRTUAL_PRIVATE_NETWORKS_2020_07_01_FINAL_RELEASE\n.PDF   \n[7] MITRE. Automated Exfiltration: Traffic Duplication. MITRE ATT&CK. 2023 . \nhttps://attack.mitre.org/techniques/T1020/001/   \n[8] National Security Agency . Managing Risk from Transport Layer Security Inspection. 2019. \nhttps://media.defense.gov/2019/Dec/16/2002225460/ -1/-\n1/0/INFO%20SHEET%20%20MANAGING%20RISK%20FRO M%20TRANSPORT%20LAYER%2\n0SECURITY%20INSPECTION.PDF   \n[9] CISA. Trusted Internet  Connections 3.0 . 2023.  https://www.cisa.gov/sites/default/files/2023 -\n05/tic_3.0_cloud _use_case_508c.pdf   \n[10] National Institute of Standards and Technology . Glossary. 2019. \nhttps://www.nist.gov/itl/smallbusinesscyber/cybersecurity -basics/glossary   \nDisclai mer of endorsement  \nThe information and opinions contained in this document are provided \"as is\" and without any warranties or \nguarantees. Reference herein to any specific commercial products, process, or service by trade name, trademark, \nmanufacturer, or o therwise, does not constitute or imply its endorsement, recommendation, or favoring by the United \nStates Government, and this guidance shall not be used for advertising or product endorsement purposes.  \nTrademarks  \nATT&CK and MITRE and are registered tradema rks of The MITRE Corporation. D3FEND is a trademark of The MITRE Corporation.  \n\n \n \n \nU/OO/ 126067 -24 | PP-24-0102  | March 2024 Ver. 1.0  10 NSA & CISA  | Implement Network Segmentation and Encryption  in Cloud Environments  \nPurpose  \nThis document was developed in furtherance of the authoring agencies  cybersecurity missions, including their \nresponsibilities to identify and disseminate threats to National Security Systems, Department of Defense, and \nDefense Industrial Base information systems, and to develop and issue cybersecurity specifications and mitigations. \nThis information may be share d broadly to reach all appropriate stakeholders.  \nContact  \nCybersecurity Report Feedback: CybersecurityReports@nsa.gov  \nGeneral Cybersecurity Inquiries or Customer Requests: Cybersecurity_Requests@nsa.gov  \nDefense Industrial Base Inquiries and Cybersecurity Services: DIB_Defense@cyber.nsa.gov  \nMedia Inquiries / Press Desk:  \nNSA Media Relations: 443 -634-0721, MediaRelations@nsa.gov  \nCISA Media Inquiries: 703 -235-2010, CISAMedia@cisa.dhs.gov   \n\n",
  "cves": [],
  "techniques": [
    "T1020.001",
    "T1021.008",
    "T1021.007"
  ],
  "advisory": "cybersecurity-alerts",
  "title": "csi-cloudtop10-network-segmentation",
  "source": "nsa",
  "id": "40301a6ce5ed59c2590ff265d8d5345427f2d4ec7c95a0502e0fa0d273e997a5"
}