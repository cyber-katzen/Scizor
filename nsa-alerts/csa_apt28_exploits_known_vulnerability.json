{
  "markdown": " \n \n   \n \n \n \nVersion 1  \nApril 2023 \n Crown Copyright 202 3  \nAdvisory . \n  \nAPT28 exploits known \nvulnerability to carry out  \nreconnaissance and deploy \nmalware on Cisco routers  \n \n \n\n\nAPT28 exploits known vulnerability to carry  out \nreconnaissance of routers and deploy malware  \nAPT28 accesses poorly maintained  Cisco routers and deploys \nmalware on unpatched devices using CVE-2017 -6742.   \n \nOverview  and context  \nThe UK National Cyber Security Centre ( NCSC ), the US National Security Agency  \n(NSA), US Cybersecurity and Infrastructure Security Agency ( CISA ) and US Federal \nBureau of Investigation ( FBI) are releasing this join t advisory to provide details of \ntactics, techniques and procedures (TTPs) associated with APT28 s exploitation of \nCisco routers in 2021.  \n \nWe assess that  APT28 is almost certainly the Russian General Staff Main \nIntelligence Directorate (GRU) 85th special Service Centre (GTsSS) Military \nIntelligence Unit 26165 . APT28  (also known as  Fancy Bear, STRONTIUM, Pawn \nStorm, the Sednit  Gang and Sofacy) is a highly skilled threat actor.  \n \nPrevious activity  \n \nThe NCSC has previously attributed the following activity to APT28:  \n cyber attacks against the German parliament in 2015 , including data theft and \ndisrupting email accounts of German Members of Parliament (MPs) and the \nVice Chancellor  \n attempted attack against  the Organisation for the Prohibition of Chemical \nWeapons (OPCW ) in April 2018, to disrupt independent analysis of chemicals  \nweaponised by the GRU in the UK  \n \nFor more information on APT28 activity, see the advisory  Russian State -Sponsored \nand Criminal Cyber Threats to Critical Infrastructure  and  Russian GRU Conducting \nGlobal Brute Force Campaign to Compromise Enterprise and Cloud Environments  \n \nAs of 2021, APT28 has been observed using commercially available code \nrepositories, and post -exploit frameworks such as Empire. This included the use of \nPowershell Empire, in addition to Python versions of Empire.  \n  \n\nReconnaissance  \nUse of SNMP protocol  to access routers  \n \nIn 2021, APT28 used infrastructure to masquerade Simple Network Management \nprotocol (SNMP) access into Cisco routers worldwide. This included a small number \nbased in Europe, US government institutions and approximately 250 Ukrainian \nvictims.  \n \nSNMP is designed to allow network administrators to monitor and configure network \ndevices remotely, but it can also be misused to obtain sensitive network information \nand, if vulnerable, exploit devices to penetrate a network.  \n \nA number of software  tools can scan the entire network using SNMP, meaning that \npoor configuration such as using default or easy -to-guess community strings, can \nmake a network susceptible to attacks.  \n \nWeak SNMP community strings, including the default public , allowed APT28 to gain \naccess to router information. APT28 sent additional SNMP commands to enumerate \nrouter interfaces. [ T1078.001 ] \n \nThe compromised routers were configured to accept SNMP v2 requests. SNMP v2 \ndoesnt support encryption and so all data, including community strings, is sent \nunencrypted.  \n \nExploit ation of  CVE-2017 -6742  \n \nAPT28 exploited the vulnerability CVE-2017 -6742 (Cisco Bug ID: CSCve54313)  \n[T1190 ]. This vulnerability was first announced by Cisco  on 29 June 2017, and \npatched software was made available.  \n \nCisco's published advisory provided workarounds , such as limiting access to SNMP \nfrom trusted hosts only, or by disabling a numb er of SNMP Management Information \nbases (MIBs).  \n \nMalware deployment  \nFor some of the targeted devices, APT28 actors used an SNMP exploit to deploy \nmalware, as detailed in the NCSCs Jaguar Tooth malware analysis report . This \nmalware obtained further device information, which is exfiltrated over triv ial file \ntransfer protocol (TFTP), and enabled unauthenticated access via a backdoor.  \n \n\nThe actor obtained this device information by executing a number of Command Line \nInterface (CLI) commands via the malware. It includes discovery of other devices on \nthe network by querying the Address Resolution Protocol (ARP) table to obtain MAC \naddresses [ T1590] \n \n \nIndicators of compromise  (IoCs)  \nPlease refer to the accompanying malware analysis report for indicators of \ncompromise which may help to detect this activity.  \nMITRE ATT&CK \nThis advisory has been compiled with respect to the MITRE ATT&CK  framework, a \nglobally accessible knowledge base of adversary tactics and techniques based on \nreal-world observations.  \nFor detailed TTPs , see the Jaguar Tooth malware analysis r eport .\nTactic  ID Technique  Procedure  \nInitial \nAccess  T1190  Exploit Public -\nfacing \nApplication.  APT28 exploited \ndefault/well -known \ncommunity strings in \nSNMP as outlined in \nCVE-2017-6742 (Cisco \nBug ID: CSCve54313 ) \nInitial \nAccess  \n T1078.001  Valid Accounts. \nDefault Accounts.  Actors accessed \nvictim routers by \nusing default \ncommunity strings \nsuch as public  \nReconnais\nsance  T1590  Gather victim \nnetwork \ninformation  Access was gained to \nperform \nreconnaissance on \nvictim devices. \nFurther detail of how \nthis was achieved in \navailable in the \nMITRE ATT&CK section \nof the Jaguar Tooth \nMAR  \n\nConclusion  \n \nAPT28 ha s been known to access vulnerable routers by using default and weak \nSNMP community strings, and by exploiting CVE -2017 -6742 (Cisco Bug ID: \nCSCve54313) as published by Cisco  and highlighted in their related blog . \n \nThreat Actors Exploiting SNMP Vulnerabilities in Cisco Routers  \n \nTTPs in this advisory may still be used against vulnerable Cisco devices. \nOrganisations are advised to follow the mitigation advice in this advisory to defend \nagainst this activity.  \n \nReporting  \nUK organisations should report  any suspected compromises to the NCSC.  \nUS organisations should cont act CISAs 24/7 Operations Centre at Report@cisa.gov  \nor (888) 282 -0870  \n \n\nMitigation   \no Patch devices as advised by Cisco . The NCSC also has general guidance on \nmanaging updates and keeping software up to date . \n \no Do not use SNMP if you are not required to configure or manage devices \nremotely to prevent unauthorised users from accessing your router.  \n If you are required to manage routers remotely, establish allow and \ndeny lists for SNMP messages to prevent unauthorised users from \naccessing your router.  \n \no Do not allow unencrypted (ie, plaintext) management protocols, such as \nSNMP v2 and Telnet. Where encrypted protocols arent possible, you should \ncarry out any management activities  from outside the or ganisation through \nan encrypted virtual private network (VPN) , where both ends are mutually \nauthenticated.  \n \no Enforce a strong password policy . Dont reuse the same password for \nmultiple devices. Each device should have a unique password. Where \npossible, avoid legacy password -based authentication and implement two -\nfactor authentication based on public -private key.  \n \no Disable legacy unencrypted protocols such as Telnet and SNMP v1 or v2c. \nWhere possib le, use modern encrypted protocols such as SSH and SNMP v3. \nHarden the encryption protocols based on current best security practice. The \nNCSC strongly advise s owners and operators to retire and replace legacy \ndevices that cant be configured to use SNMP v3 . \n \no Use logging tools to record commands executed on your network devices, \nsuch as TACACS+ and Syslog. Use these logs to immediately highlight \nsuspicious events and keep a record of events to support an investigation if \nthe devices integrity is ever in question.  See NCSC guidance on monitoring \nand logging . \n \no If you suspect your router has been compromised:  \n Follow Ciscos advice  for verifying the Cisco IOS image . \n Revoke all keys associated with that router. When replacing the router \nconfiguration be sure to create new ke ys rather than pasting from the \nold configuration . \n\n Replace both the ROMMON and Cisco IOS image with an image that \nhas been sourced directly from the Cisco website , in case third party \nand internal repositories have been compromised.  \n \no NSAs Network Infrastructure guide  provides some best practices for SNMP . \n \no See also the Cisco IOS hardening guide  \n\n Disclaimers  \nThis report draws on information derived from NCSC and industry sources. Any NCSC \nfindings and recommendations made have not be en provided with the intention of \navoiding all risks and following the recommendations will not remove all such risk. \nOwnership of information risks remains with the relevant system owner at all times.  \nAll material is UK Crown Copyright   \n \n\n",
  "cves": [
    "CVE-2017-6742"
  ],
  "techniques": [
    "T1590",
    "T1190",
    "T1078.001"
  ],
  "advisory": "cybersecurity-alerts",
  "title": "csa_apt28_exploits_known_vulnerability",
  "source": "nsa",
  "id": "01be68ac1f624b4bdc8f36b556af440b9a7a0d7b960fca27642e29fc0bbdf1fb"
}