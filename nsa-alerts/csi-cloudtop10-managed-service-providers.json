{
  "markdown": " \n \nU/OO/ 126084 -24 | PP-23-4631  | March  2024 Ver. 1.0 \n|   Cybersecurity Information  \nNational  \nSecurity  \nAgency  \nCybersecurity &  \nInfrastructure  \nSecurity  \nAgency  \nMitigate Risks from Managed Service Providers in \nCloud Environments  \nExecutive summary  \nManaged service providers (MSPs) are businesses that deliver, operate , or manage IT \nservices to  and for  customers under contract.  The growth of the public cloud has \nencouraged the development of numerous MSPs  that primarily  provide these services  \nwithin the cloud rather than in customer on -prem ises networks. Both cloud resellers and \nother IT vendors  offer such third -party services. These MSPs offer a divers e set  of \nservice s including : \n Backup and system recovery , \n Infrastructure management , and \n Security monitoring . \nBecause of their focus and scale , MSPs have the potential to provide services that are \nbetter tailored (e.g., higher availability or scalability, improved security, cheaper) than an \norganization could deliver for itself.  \nUsing the capabilities provided by MSPs , organizations  can accomplish their business \nobjectives , including their respons ibilities related to  increased remote work and other \nchanges to operating conditions . However, using an MSP can also increase an \nenterprises attack surface and introduce new factors when  managing risk. This \ncybersecurity information sheet outlines five important aspects to consider when \nchoosing and using MSP services.  \nExercise due diligence  \nSecurity in the cloud is a shared responsibility. This principle extends to the use of third -\nparty services and capabilities as offered by MSPs. Malicious cyber actors  (MCAs)  are \nknown to have  an interest in targeting MSPs and using compromised MSPs to target \ncustomers . [1] Incidents have involved both  MCAs  associated with natio n-states and \nothers with no known affiliation . [2], [3] \n\n \n \n \nU/OO/ 126084 -24 | PP-23-4631  | March 2024  Ver. 1.0 2 NSA & CISA  | Mitigate Risks from MSPs in Cloud Environments  \nMSPs, by their nature, must have access to their customers data and resources. In \nmany cases , MSPs  will have privileged access. An MCA who has compromised an \nMSP may be able to use the acces s to pivot into customer environments. Th e potential \nfor a successful pivot is increased  if privileged access has been granted. Such activities \nare less likely to be detected because they come through a trusted MSP . \nAs illustrated in  Figure 1 , the use of m anaged services can open new conduits for \npotential malicious activities . Applying the shared responsibility model to MSPs involves \nunderstanding how MSPs protect themselves, auditing  MSP  activity within  an \norganization's  tenants, and incorporating use of MSP  services into organizational \nsecurity plans and operations.  \n \nFigure 1: Impact of  an MSP on an organizations attack  surface  \nInclude security considerations when  choosing MSPs  \nWhen selecting an MSP , organizations should consider security and risk management \nas part of their criteria. Choose providers that provide visibility into their operations in \n\n\n \n \n \nU/OO/ 126084 -24 | PP-23-4631  | March 2024  Ver. 1.0 3 NSA & CISA  | Mitigate Risks from MSPs in Cloud Environments  \ncustomer environments  through cloud -native logging and audit mechanisms . Recognize \nthat some services may  not provide the level of visibility required. Consider what \nagreements, if any, related to notification and recovery if a suspected security breach  \noccurs  that different providers offer . Select providers that  fit the organization's security \nposture.  \nThe s ecurity posture taken by an MSP has an impact on their customers security, \nparticularly when the MSP has privileged access within customer tenants.  Organizations \noften require multifactor authentication for privileged accounts and  may impose \nadditional co nstraints  for logins by privileged users . For instance, they may restrict such \nlogins to specific,  trusted devices or from certain locations.  If a customer gives an MSP \nprivileged access , and that MSP employs less stringent access requirements , using  the \nMSP  can reintroduce risks that the customer previously  mitigated.  \nVarious organizations (including public cloud service providers, government entities, \nand non -profit organizations ) have published security baselines and standards that \nprovide guidance on securing cloud environments and resources . [4], [5], [6], [7] The \nDefense Information Systems Agency  (DISA ) has developed a guide that provid es \nsecurity controls and requirements for cloud -based solutions for use by the Department \nof Defense . [8] Organizations should consider which standards, policies , or practices \nare important to them and choose from MSPs that can attest to complying with them.  \nEstablish auditing mechanisms  \nTo review an MSPs activities in  an organization's  tenant o r tenants , organizations  must \nfirst understand their expected operatio ns and how the se operations  trace to specific, \nviewable artifacts. Identity  and access management (IAM) sy stems provide one key \nmechanism:  the ability to view and manage security princip als and their associated \nprivileges.  Consider using IAM services to au dit privileges between the MSP and  \norganizational  cloud environments.  See the joint  CSI: Use Secure  Cloud  Identity and \nAccess Management  Practices  for recommendations on IAM usage.  \nCloud log management and analytic systems supply a second tool for auditing and \nmonitoring MSP actions. Commercial cloud providers have services for : \n Centralizing logs from multiple sources , \n Managing storage  and aging off events , and  \n Querying across multiple logs . \n\n \n \n \nU/OO/ 126084 -24 | PP-23-4631  | March 2024  Ver. 1.0 4 NSA & CISA  | Mitigate Risks from MSPs in Cloud Environments  \nNSA and CISA recommend MSP c ustomers discover how the MSP's operations are \nreflected within cloud -native logs and audit those events. Organizations should \nunderstand the identities, accesses, and action s that an MSP  makes . \nOrganizations must consider multiple aspects  when setting up logs and analytics , \nincluding:  \n Deciding the desired retention period for different logs , \n Investigat ing whether specific  service levels impact log data availability and \nchoosi ng the best level for  organizational  needs , \n Complet ing any configuration or development needed to integrate log data into \nthe existing security infrastructure , and  \n Consider ing measures such as the use of immutable storage to protect the \nintegrity of critic al log data . \nThere may be cases where  security operation teams want  or require  data, but the MSP \nor cloud service provider does not provide it . Enterprises must consider operational \nrequirements, costs, and security together to determine the best trade -offs. See  the \nNSA CSI: Manage Cloud Logs for Effective Threat Hunting  for cloud log ging \nrecommended practices.  \nFailure to monitor MSP  accounts, privileges , or actions may leave an organization blind \nto their abuse by cyber adversaries.  The following table lists relevant MITRE ATT&CK \ntactics and techniques to consider . \nATT&CK Tactic (s) Technique  \nInitial Access  Trusted Relationship [ T1199 ] \nInitial Access , Privilege Escalation, \nPersistence  Valid Accounts [ T1078 ] \nIntegrate auditing into security operations  \nOnce an organization  establishe s the information and events to track MSP services , \nsecurity teams can incorporate this as part of standard security operations. For \nexample , events that trigger an alert should be prioritized, evaluated, a nd resolved \naccording to standard procedures. Hunt teams can develop baselines describing normal \nactivity  and develop analytics t hat trigger alerts when  suspicious activity  occurs . \n\n \n \n \nU/OO/ 126084 -24 | PP-23-4631  | March 2024  Ver. 1.0 5 NSA & CISA  | Mitigate Risks from MSPs in Cloud Environments  \nPrivileged accounts and actions associated with an MSP should be reviewed i n the \nsame manner as other privileged accounts.  \nOrganizations may choose to build much of their base security structure upon cloud -\nnative capabilities provided by their cloud service provider. Such services include log \naggregation and centralization, secur ity information and event management , threat \nintelligence information, and alerts. MSPs can also provide other security services that  \norganizations can consider . However,  organizations should consider alternatives in \ncase MCAs find ways to disrupt them  and not to depend solely on such services . \nAdjust planning to incorporate MSPs  \nOrganizations should consider how they will respond to unusual, high -impact events , \nsuch as security incidents, extended outages, or system failures. When using  services \nfrom an MS P, NSA and CISA  recommend consider ing how high-impact events  might  \naffect  incident response  or system recovery and adjust plan s as appropriate . \nIn contingency planning , organizations should  identify and understand the agreements \nprovided by MSPs. Areas to consider include the responsibility of an MSP regarding the \nnotification of  suspect ed security incidents , such as potential breaches , and service \nlevel agreements related to remediation or recovery from security incidents or outages. \nIncident planners should consider what incident responders might need from an MSP in \nterms of data or support and how to achieve this. System recovery planner s should \nconsider how to re spond if a capability fail ure occurs on  the part of an MSP.  \nRecommendations  \nWhen organizations choose MSPs, NSA and CISA  recommend the following:  \n Adhere to important security standards as part of selection criteria when \nchoosing MSP services . \n Choose services and service levels that  provide visibility into MSP actions via \nIAM and log analytic systems . \n Perform and test configurations to ensure that logs and IAM information related \nto MSP actions are integrated into the organizational security infrastructure . \n Regularly review MSP accou nts and privileges in IAM systems and investigate \nunusual or unexpected changes . \n\n \n \n \nU/OO/ 126084 -24 | PP-23-4631  | March 2024  Ver. 1.0 6 NSA & CISA  | Mitigate Risks from MSPs in Cloud Environments  \n Audit MSP actions via log analytics and prioritize  procedures for alerting on and \ninvestigating unusual activity . \n Consider the need for MSP  services  if an incident occurs, and choose service \nlevels that provide the necessary level of support . \n Perform tabletop exercises around incident response or system failures related to \nthe MSP and incorporate the findings into incident response and system recovery \nplans . \nWorks c ited \n[1] ACSC, CISA, CSE, FBI, GCSB, NCSC, NSA . Cybersecurity Advisory: Protecting Against Cyber \nThreats to Managed Service Providers and their Customers. 2022. \nhttps://media.defense.gov/2022/May/11/2002994383/ -1/-\n1/0/CSA_Protecting_Against_Cyber_Threats_to_MSPs_and_their_Customers_05112022.PDF  \n[2] Microsoft Threat Intelligence Center. NOBELIUM targeting delegated administra tive privileges to \nfacilitate broader attacks. 2021. https://www.microsoft.com/en -\nus/security/blog/2 021/10/25/nobelium -targeting -delegated -administrative -privileges -to-facilitate -\nbroader -attacks/   \n[3] N-able. White Paper: State of the Market: The New Threat Landscape.  2022.  https://n -\nable.com/resources/state -of-the-market -the-new-threat -landscape  \n[4] Center for Internet Security (C IS). CIS Benchmarks List. 2023. https://cisecurity.org/cis -\nbenchmarks  \n[5] Center for In ternet Security (CIS). CIS Critical Security Controls version 8. 2023. \nhttps://cisecurity.org/controls  \n[6] Cybersecurity and Infrastructure Security Agency ( CISA ). Secure Cloud Business Applications \n(SCuBA) Project. 2023. https://www.cisa.gov/resources -tools/services/secure -cloud -business -\napplications -scub a-project  \n[7] National Institute of Standards and Technology ( NIST ). Special Publication  800-53 revision 5. \n2020. https://csrc.nist.gov/publications/detail/sp/800 -53/rev -5/final  \n[8] Defense Information Systems Agency (D ISA). Cloud Computing Security Requirements Guide \n(CC SRG). 2023. https://public.cyber.mil/dccs/  \n  \n\n \n \n \nU/OO/ 126084 -24 | PP-23-4631  | March 2024  Ver. 1.0 7 NSA & CISA  | Mitigate Risks from MSPs in Cloud Environments  \nDisclaimer of endorsement  \nThe information and opinions contained in this  document are provided \"as is\" and without any warranties or \nguarantees. Reference herein to any specific commercial products, process, or service by trade name, trademark, \nmanufacturer, or otherwise, does not constitute or imply its endorsement, recommend ation, or favoring by the United \nStates Government, and this guidance shall not be used for advertising or product endorsement purposes.  \nTrademarks  \nATT&CK and MITRE and are registered trademarks of The MITRE Corporation.  \nPurpose  \nThis document was developed in furtherance of the authoring agencies  cybersecurity missions, including their \nresponsibilities to identify and disseminate threats to National Security Systems, Department of Defense, and \nDefense Industrial Base information systems, and to develop and issue cybersecurity specifications and mitigations. \nThis information may be shared broadly to reach all appropriate stakeholders.  \nContact  \nCybersecurity Report Feedback: Cyberse curityReports@nsa.gov  \nGeneral Cybersecurity Inquiries or Customer Requests: Cybersecurity_Requests@nsa.gov  \nDefense Industrial Base Inquiries and Cybersecurity Services: DIB_Defense@cyber.nsa.gov  \nMedia Inquiries / Press Desk:  \nNSA Media Relations: 443 -634-0721, MediaRelations@nsa.gov  \nCISA Media Inquiries: 703 -235-2010, CISAMedia@cisa.dhs.gov   \n\n",
  "cves": [],
  "techniques": [],
  "advisory": "cybersecurity-alerts",
  "title": "csi-cloudtop10-managed-service-providers",
  "source": "nsa",
  "id": "88fde268164d489db301d84bba15016b27f78e5fef45a5a5e4e8e8815d79eee9"
}