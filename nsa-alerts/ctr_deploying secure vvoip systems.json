{
  "markdown": " \n \n \n \n \nNational Security Agency  \nCybersecurity Technical Report  \n \n \n \n \n \nDeploying Secure U nified \nCommunications /Voice and Video \nover IP Systems  \n \n \n \n \n \n \n \nJune  2021  \n \n SN U/OO/153515 -21 \nPP-21-0827  \nVersion 1.0  \n \n\n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  1 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \nNotices and history  \nDocument change history  \nDate  Version  Description  \n15 June 2021  1.0 Initial release  \n   \nDisclaimer of warranties and endorsement  \nThe information and opinions contained in this document are provided \"as is\" and \nwithout any warranties or guarantees. Reference herein to any specific commercial \nproducts, process, or service by trade name, trademark, manufacturer, or otherwise, \ndoes not necessarily constitute or imply its endorsement, recommendation, or favoring \nby the United States Government, and this guidance shall not be used for advertising or \nproduct endorsement purposes.  \nTrademark recognition  \nBluetooth is a registered trademark of  Bluetooth Special Interest Group (SIG), Inc.  NIST \nis a trademark and brand of National Institute of Standards and Technology.  \nPublication information  \nContact information  \nClient Requirements / General Cybersecurity Inquiries:  \nCybersecurity Requirements Ce nter, 410 -854-4200, Cybersecurity_Requests@nsa.gov    \n \nMedia Inquiries :  \nMedia Relations, 443 -634-0721, MediaRelations@nsa.gov   \nPurpose  \nThis document was developed in furtherance of NSAs cybersecurity missions. This \nincludes its responsibilities to identify and disseminate threats to National Security \nSystems, Department of Defense information systems, and the Defense Industrial Base, \nand to develop and is sue cybersecurity specifications and mitigations. This information \nmay be shared broadly to reach all appropriate stakeholders.   \n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  2 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \nTable of contents  \nDeploying Secure Unified Communications/Voice and Video over IP Systems  ..i \nExecutive summary  ................................ ................................ ................................ ......................  4 \nPart I: Network security best practices and mitigations  ................................ ..........................  5 \nAccessibility and network separation  ................................ ................................ ................................ .................  6 \nMitigations  ................................ ................................ ................................ ................................ ................................  7 \nCall eavesdropping protections  ................................ ................................ ................................ ............................  8 \nMitigations  ................................ ................................ ................................ ................................ ................................  8 \nPhysical access protections  ................................ ................................ ................................ ................................ ... 8 \nMitigations  ................................ ................................ ................................ ................................ ................................  9 \nNetwork availability protections  ................................ ................................ ................................ ............................  9 \nMitigations  ................................ ................................ ................................ ................................ ................................  9 \nNetwork services and protocols protections  ................................ ................................ ................................ .. 10 \nDHCP  ................................ ................................ ................................ ................................ ................................ ....... 10 \nDNS ................................ ................................ ................................ ................................ ................................ ...........  11 \nNTP ................................ ................................ ................................ ................................ ................................ ...........  12 \nTrusted path and channel protections  ................................ ................................ ................................ .............  12 \nMitigations  ................................ ................................ ................................ ................................ ..............................  13 \nSummary of Part I  ................................ ................................ ................................ ................................ ....................  13 \nPart II: Perimeter security best practices and mitigations  ................................ ....................  14 \nPSTN gateway protections  ................................ ................................ ................................ ................................ ... 14 \nMitigations  ................................ ................................ ................................ ................................ ..............................  14 \nProtections for public IP networks functioning as voice carriers  ................................ ...........................  15 \nMitigations  ................................ ................................ ................................ ................................ ..............................  16 \nSignaling gateway protections  ................................ ................................ ................................ ............................  17 \nMitigations  ................................ ................................ ................................ ................................ ..............................  17 \nMedia gateway protections  ................................ ................................ ................................ ................................ .. 18 \nMitigations  ................................ ................................ ................................ ................................ ..............................  18 \nWide area network (WAN) link protections  ................................ ................................ ................................ .... 18 \nMitigations  ................................ ................................ ................................ ................................ ..............................  18 \nCloud connectivity protections  ................................ ................................ ................................ ............................  18 \nMitigations  ................................ ................................ ................................ ................................ ..............................  19 \nSummary of Part II  ................................ ................................ ................................ ................................ ...................  20 \nPart III: Enterprise session controller security best practices and mitigations  .................  21 \nSoftware and application protections  ................................ ................................ ................................ ...............  21 \nUser accounts and passwords  ................................ ................................ ................................ .......................  22 \nDefaul t UC/VVoIP server configuration settings  ................................ ................................ .....................  22 \nAudit and logging apparatus  ................................ ................................ ................................ ...........................  23 \nSoftware vulnerabilities  ................................ ................................ ................................ ................................ ..... 23 \nMalicious software ................................ ................................ ................................ ................................ ...............  23 \n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  3 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \nNetwork servic es ................................ ................................ ................................ ................................ .................  24 \nDatabase security ................................ ................................ ................................ ................................ ................  24 \nCryptographic key material  ................................ ................................ ................................ ..............................  25 \nPhysical security protections  ................................ ................................ ................................ ...............................  25 \nMitigations  ................................ ................................ ................................ ................................ ..............................  26 \nService availability protections  ................................ ................................ ................................ ............................  26 \nHardware and power failures  ................................ ................................ ................................ ..........................  26 \nData loss  ................................ ................................ ................................ ................................ ................................ . 27 \nEmergency Services  ................................ ................................ ................................ ................................ ..........  27 \nClient registration protections  ................................ ................................ ................................ ..............................  28 \nMitigations  ................................ ................................ ................................ ................................ ..............................  28 \nRemote management protections  ................................ ................................ ................................ .....................  28 \nWeb-based management interfaces  ................................ ................................ ................................ ............  28 \nProprietary management software  ................................ ................................ ................................ ...............  29 \nSummary of Part III ................................ ................................ ................................ ................................ ..................  30 \nPart IV: UC/VVoIP endpoint best practices and mitigations  ................................ .................  31 \nSoftware and hardware security  ................................ ................................ ................................ .........................  31 \nSoftware vulnerabilities  ................................ ................................ ................................ ................................ ..... 31 \nThird -party software  ................................ ................................ ................................ ................................ ...........  32 \nMalicious software ................................ ................................ ................................ ................................ ...............  33 \nEmbedded microphones ................................ ................................ ................................ ................................ ... 33 \nRemote manag ement of UC/VVoIP endpoints ................................ ................................ .............................  34 \nDownloading firmware and configuration files  ................................ ................................ .........................  34 \nWeb-based management interface  ................................ ................................ ................................ ..............  35 \nSimple Network Management Protocol (SNMP)  ................................ ................................ ....................  35 \nTelnet  ................................ ................................ ................................ ................................ ................................ ....... 36 \nNetwork connectivity  ................................ ................................ ................................ ................................ ...............  36 \nEthernet  ................................ ................................ ................................ ................................ ................................ ... 36 \nInfrared  ................................ ................................ ................................ ................................ ................................ .... 37 \nWireless personal area network (WPAN)  ................................ ................................ ................................ .. 38 \nWireless local area network (WLAN)  ................................ ................................ ................................ ...........  38 \nNetwork connectivity mitigation summary  ................................ ................................ ................................ . 39 \nConvergence features  ................................ ................................ ................................ ................................ ............  39 \nMitigations  ................................ ................................ ................................ ................................ ..............................  40 \nSoftphones  ................................ ................................ ................................ ................................ ................................ .. 41 \nMitigations  ................................ ................................ ................................ ................................ ..............................  41 \nSummary of Part IV  ................................ ................................ ................................ ................................ .................  42 \nEnd of guidelines  ................................ ................................ ................................ ........................  42 \n \nFigures  \nFigure 1: Logical view of a UC/VVoIP system following NSA guidelines  ................................ .................  6 \nFigure 2: Perimeter security device placement following NSA guidelines ................................ .............  15 \n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  4 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \nExecutive summary  \nUnified Communications (UC) and Voice and Video over IP (VVoIP) call -processing \nsystems provide rich collaboration tools and offer fl exible ways to communicate by \ncombining  voice, video conferencing, and instant messaging in the modern workplace. \nToday  these systems are integrated into an enterprises existing Internet Protocol (IP) \ninfrastructure, use commodity software, and are likely  to use open -source and standard \nprotocols.  \nHowever, the same  IP infrastructure that enables  UC/VVoIP systems also extends the \nattack surface into an enterprises network, introducing vulnerabilities and the potential \nfor unauthorized access to communicat ions. These vulnerabilities were harder to reach  \nin earlier telephony systems, but now v oice serv ices and infrastructure are accessible to \nmalicious actors who penetrate the IP network to eavesdrop on conversations, \nimpersonate users, commit toll fraud, or perpe trate a denial of service effects. \nCompromises can lead to high -definition room audio and/or video being covertly \ncollected and delivered using the IP infrastructure as a transport mechanism.  \nIf properly secured, a UC/VVoIP system limits the risk to data confidentiality and \ncommunication system availability. This security requires careful consideration, detailed \nplanning and deployment, and continuous testing and maintenance. Deploying Secure \nUnified Communications /Voice and Video over IP Systems  outlines best practices for \nthe secure deployment of UC/VVoIP systems and presents mitigations for vulnerabilities \ndue to inadequate network design, configurations, and connectivity.  This report  is \nseparated into four parts. Each part speaks to the system  administrators who will lead \nmitigation efforts in each area of the system. It describes the mitigations and best \npractices to use when:  \n Preparing  networks  \n Establishing perimeters  \n Using enterprise session controllers (ESCs)  \n Adding UC/VVoIP endpoints for d eployment of a UC/VVoIP system  \nUsing the mitigations and best practices explained here, organizations may embrace \nthe benefits of UC/VVoIP while minimizing the risk of disclosing sensitive information or \nlosing service.  \n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  5 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \nPart I: Network security best practices and mitigations  \nTo securely deploy Unified Communications  / Voice and Video over Internet  \nProtocol (UC/VVoIP) systems, the network is the first critical area to implement security  \nprotections . Part I of Deploying  Secure U nified Communications /Voice and Video over \nIP Systems  addresses how to secure the network of one of these systems.  \nUC/VVoIP call -processing security is dependent on a defense -in-depth approach. \nUC/VVoIP call -processing network elements are on the data network, requiring careful \ndeployment and configuration of the network infrastructure to address possible threats \nrelated to UC/VVoIP systems. The data -only network infrastructure including transport \ndevices such as switches and routers must mitigate known vulnerabilities of the \nInternet Protocol (IP) network to protect the call -processing devices.  \nDeploying across a data -only network infrastructure makes devices such as call \nservers, desktop video teleconferences (VTCs), and UC/VVoIP endpoints more \naccessible to malicious cyber acto rs. Compromises of  the call -processing network are \nperformed using the same tools used to compromise  data-only networks and related \nperipherals (e.g. , PCs, smartphones, printers, switches, routers). In addition, malicious \nactors can connect to the UC/VVoIP call -processing infrastructure using the data \nnetwork infrastructure. Separating the UC/VVoIP call -processing and data -only \ninfrastructures makes penetrating the UC/VVoIP systems harder. Virtual local area \nnetworks (VLANs) allow multiple networks to use the same physical layer 2/3 medium \n(e.g., switches, routers), but remain logically separated.  \nBecause UC/VVoIP endpoint calls in UC/VVoIP systems are carried over more \naccessible data networks than the traditional public swit ched telephone network \n(PSTN), eavesdropping is more of a risk. While it cannot eliminate the risk altogether, \nnetwork security can help make eavesdropping more difficult.  \nIn addition, the data -only network infrastructure must now meet the same reliability  and \nquality of service (QoS) requirements as the UC/VVoIP call -processing network. To \nensure a secure deployment of UC/VVoIP systems and devices  across the data \nnetwork  in a way that also ensures high availability requires the implementation of \nredundancy , data backups, power backups, and physical protection of the network.  \n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  6 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \n \nFigure 1: Logical view of a UC/ VVoIP system following NSA guidelines  \nAccessibility and network separation  \nPhysical convergence of voice/video technology across a data network is an advantage \nof UC/VVoIP call -processing systems. However, placing UC/VVoIP systems and data \nsystems on the same network means both technologies are now susceptible to the \nsame technique s and accessible by the same malicious actor s. Once an a ctor has \npenetrated the network, both data services and UC/VVoIP call processing will be \navailable for exploit. This violates the basic defense -in-depth principle, because \nvulnerabilities in one part of the network should not make another part o f the network \nvulnerable. The border between the voice/video network and the data network should \nbe treated as untrusted and secured accordingly. They should not be freely accessible \nto each other. Access from the data network to the UC/VVoIP network shoul d be denied \n\n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  7 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \nunless explicitly allowed. The converse from the UC/VVoIP to the data network should \nalso be enforced.  \nMitigations  \nBy using VLAN technology, lateral movement between the data network and the \nUC/VVoIP network can be limited, even though both net works share the same physical \nnetwork. While VLANs were not designed as security mechanisms, they can be used to \nenable security features, such as placing access controls on the type of traffic that is \nallowed on specific VLANs. VLANs allow UC/VVoIP traffi c to be isolated from data \ntraffic and vice versa, while enabling any interactions between them to be tightly \ncontrolled. This limits the reconnaissance a  malicious acto r can perform from one \nnetwork to the other and limits the protocols they can exploit.  \nPlace all network devices not specifically used to support UC/VVoIP such as PCs, file \nservers, and email servers on data VLANs. UC/VVoIP devices should be placed on \ndifferent VLANs according to their role in the network. Limiting each VLAN to groups of \nsimilar devices and protocols makes the development, implementation, and \nmanagement of security features much easier. UC/VVoIP servers should be placed in \ndifferent VLANs depending on the UC/VVoIP protocol they implement. As an example, \nall H.323 servers shou ld be placed in an H.323 -only VLAN, and all Session Initiation \nProtocol (SIP) servers should be placed in a SIP VLAN. If a single server implements \nmultiple protocols, the network interface card (NIC) should support virtual VLANS so the \nserver can particip ate in multiple VLANs. The UC/VVoIP network and the data network \nshould have their own servers for standard network support services like the Domain \nName System (DNS), Dynamic Host Configuration Protocol (DHCP), and Network Time \nProtocol (NTP). This is nec essary because traffic from these services should not have \nto cross the boundary between UC/VVoIP and data VLANs.  \nDividing the network into multiple VLANs does not provide any benefit if the traffic \nbetween the VLANs is not restricted. As traffic enters th e network through the border \nrouter, the border router only performs stateless packet filtering on the traffic due to \nrouting load . Starting at the session border c ontroller (SBC), c ontrol traffic between \nUC/VVoIP VLANs with stateful packet filtering devic es. Configure the acces s control \nlists (ACLs) on  the stateful packet filtering devices to allow UC/VVoIP endpoints to \nconnect only to the UC/VVoIP servers the endpoints need to function and vice versa. \nFilter based on IP address, port number, and transport  protocol instead of on port \n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  8 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \nnumber alone. Only allow protocols necessary for operation to be allowed by the filter. \nEverything else should be denied.  \nUse an application -layer firewall to separate the UC/VVoIP VLANs from the data \nVLANs. The application -layer firewall will function as a checkpoint for all traffic between \nthe UC/VVoIP and data networks. No traffic should be allowed directly between the \nUC/VVoIP VLAN segmented network and the data VLAN segmented network without \nbeing examined at the applicatio n layer by either the firewall or a proxy device in the \ndemilitarized zone (DMZ). Only necessary protocols should be allowed through the \nfirewall.  \nSome devices, such as unified messaging servers, fulfill roles on both networks, and \nthus need access to both  the data and UC/VVoIP VLANs. Place these devices in the \nDMZ managed by the application -layer firewall.  \nCall eavesdropping protections  \nUnencrypted voice and video communication is susceptible to eavesdropping when \nconversations travel over an IP network. C ommercial tools exist that allow media \nstreams to be reconstructed if packets can be captured, even when using proprietary \ncoder -decoders (codecs). Network -layer security protections may not be able to prevent \ncall eavesdropping completely, but they can ma ke it much more difficult.  \nMitigations  \nThe best mitigation against eavesdropping is encrypting all voice and video traffic end -\nto-end. Additionally, limiting access to the traffic can be achieved by enabling port \nsecurity on all switches. Port security res tricts access to the network at the layer 2 level. \nIf a rogue device physically tries to connect to a switch with port security enabled, the \nswitch disables the port and does not grant the rogue device access to the network.  \nPort security 802.1x device aut hentication should be enabled to force clients to \nauthenticate before they are allowed onto the network.  \nPhysical access protections  \nWith physical access to equipment, a malicious acto r can disable the network, \neavesdrop, and otherwise compromise  the UC/VV oIP call -processing system. Most  \ndigital safeguards on the network are meaningless if an intruder  gains physical access \nto the equipment being protected. With physical access to equipment, malicious actor s \n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  9 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \ncan often use a simple USB device to install malwa re. Backdoors can be installed or \nentire databases containing sensitive information can be downloaded. For these \nreasons, it is imperative to put physical protections for the equipment in place.  \nMitigations  \nGrant physical access to network hardware only t o authorized personnel. Place network \nhardware in a locked, restricted, and controlled area. A log with timestamps of \npersonnel accessing these areas should be kept , if possible. The hardware equipment \nshould be kept in cabinets that can be locked. The cab inets should remained locked \nunless there is a need for authorized personnel to physically access the equipment. \nVideo cameras should also be installed to provide video surveillance of the restricted \nareas if practicable.  \nNetwork availability protections  \nDenial of service (DoS) impact s take many forms and are difficult to prevent. DoS \neffect s can be triggered by software vulnerabilities to disable UC/VVoIP devices, \nconsume resources on a UC/VVoIP server, or consume excessive amounts of network \nbandwidth. Th e first two types are addressed by using trusted software and staying \ncurrent on patching. However, over -consumption of network bandwidth can often be \naddressed at the network level.  \nThere are also environmental factors that can disable or degrade availabi lity of the \nnetwork. Power outages are an example of such a factor. These events must also be \ntaken into account.  \nMitigations  \nDoS techniques  using  network bandwidth can directly target UC/VVoIP devices. \nLimiting the rate of traffic to UC/VVoIP  VLANs can reduce the effects of such DoS \nattempts  coming from outside the UC/VVoIP call -processing network. When designing \nthe UC/VVoIP call -processing network, determine the number of simultaneous incoming \nexternal calls that can be handled without detri mentally affecting the ability to place \ninternal calls. Use network perimeter devices such as firewal ls, SBCs , and filtering \nrouters to limit the bandwidth allocated to incoming external calls. These perimeter \ndevices typically have built -in features that detect and limit DoS attempt s. This reduces \nthe amount of network traffic allowed into UC/VVoIP call -processing VLANs.  \n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  10 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \nUC/VVoIP protocols are time sensitive protocols and vulnerable to jitter, latency, and \npacket loss. UC/VVoIP traffic should not be delaye d due to l ower  priority traffic. There \nare mechanisms available to score and prioritize traffic traversing the network. One of \nthese is QoS. Quality of service should be enabled on network hardware that route \nUC/VVoIP call -processing traffic and given a hi gher priority than less time -sensitive \ntraffic.  \nTo guard against power outages, a backup power source should be installed. UC/VVoIP \nendpoints receive power over the network cable using Power over Ethernet (PoE) \ntechnology. To ensure telephone service in t he event of a power outage, any network \nhardware device that provides PoE to any UC/VVoIP client should be attached to a \nbackup power source.  \nNetwork services  and protocols protections  \nMany network -based services are required to maintain secure, enterpris e-wide \nUC/VVoIP call -processing. This section covers three of them: DHCP, DNS, and NTP.  \nDHCP  \nDHCP is most often used to assign network settings such as IP addresses, DNS name \nservers, and gateway routers to UC/VVoIP  clients. DHCP is a good option for assigning \nIP addresses to UC/VVoIP endpoints and other peripheral IP devices. The other option \nis to statically assign IP addresses, but that comes with a higher administrative burden \nas each IP address must be manually assigned to each device . Implementation of \nDHCP requires careful consideration because DHCP is inherently vulnerable. It does \nnot possess security features such as authentication and encryption, which are \nprevalent in modern protocols. A rogue DHCP server can connect to the network and \nprovide network settings to a UC/VVoIP endpoint, which could result in a DoS effect or \nman-in-the-middle interception . In addition, a malicious DHCP client can also cause a \nDoS effect  by continuously requesting IP addresses u ntil the DHCP pool is exhausted. \nWithout an IP address, phone service is unavailable.  \nMitigations  \nSince UC/VVoIP deployments may contain hundreds or thousands of endpoint needing \nIP addresses, DHCP may be the only reasonable solution in assigning IP addres ses. \nManually assigning IP addresses does not scale well in larger environments. To guard \nagainst rogue DHCP servers on the network, DHCP snooping should be employed on \n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  11 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \nlocal area network (LAN) switches. DHCP snooping is a layer 2 technology that drops \nDHC P messages from DHCP servers that are not authorized . DHCP snooping also \nkeeps track of successful DHCP bindings and inspects DHCP traffic for malicious data.  \nTo combat malicious DHCP clients connecting to the network, port security should be \nenabled on th e LAN switches. If an unauthorized DHCP client is plugged into the switch, \nport security will disable the port and deny the unauthorized client access to the \nnetwork. Port security 802.1x device authentication should also be enabled to force \nclients to aut henticate before they are allowed onto the network.  \nThe UC/VVoIP network should have a separate DHCP server from the data network. \nOnly clients on the UC/VVoIP network should be allowed to request addresses from this \nDHCP server.  \nDNS  \nDNS is foundational to  all data and UC/VVoIP networks for translating domain names \ninto IP addresses where messages can be sent. In its inception, DNS was not designed \nwith security in mind, so malicious issues such as DNS cache -poisoning , compromised \nDNS servers, and malicious  DNS registrations have arisen.  These have led  to secure \nDNS -related proposals such as DNSSEC (DNS Security Extensions).  Malicious DNS \ntechniques could result in man -in-the-middle compromises or UC/VVoIP connections to \nmalicious devices.  \nMitigations  \nDNSSE C should be employ ed at your enterprise boundary, by enabling DNSSEC \nvalidation at the recursive resolvers . DNSSEC adds two important security features to \nDNS: authentication and integrity. DNSSEC assures that the data the DNS server \nreceives from other DN S servers has not been modified and that the data was received \nfrom the authoritative zone the data originated from. If an error occurs in validating the \nDNS data, the data is dropped.  \nThere are also techniques such as forward -confirmed -reverse -DNS that ca n make DNS \nmore secure. This is a networking parameter configuration in which an IP address has \nboth forward (name -to-address) and reverse (address -to-name) DNS entries that match \neach other.  \n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  12 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \nIn addition to DNSSEC and forward -confirmed -reverse -DNS, zone tr ansfers should be \ndisabled. With zone transfers enabled, a  malicious actor  could issue a DNS query that \nwould initiate a zone transfer of the internal DNS database. A DNS zone transfer \nreplicates DNS records across DNS servers, eliminating the need to manu ally update \nDNS servers. If a DN S server can be tricked into sending a DNS zone transfer to a  \nmalicious actor , the actor  could use that information to  easily  map and target specific \nservers on the network. DNS zone transfers should only be allowed to serve rs that have \na specific need for the information. All other zone transfer requests should be denied.  \nLastly, use a dedicated DNS server to service UC/VVoIP clients. The DNS server \nshould be separate from the DNS server that services the data network. The D NS \nserver should be behind a firewall and access to the DNS server should be restricted by \naccess control lists.  \nNTP \nNTP is intended to synchronize all connecting IP devices on the UC/VVoIP call -\nprocessing network. Special attention should be paid to secur ing these timing servers. \nAbuse of NTP could desynchronize devices causing a denial of service.  \nMitigations  \nThe NTP server providing time to the UC/VVoIP clients should be a dedicated NTP \nserver separate from the data networks NTP server. The UC/VVoIP ser ver should use \nthe latest available NTP version that supports authentication and integrity. Older \nversions of NTP have less robust security features.  \nTo limit the attack surface  of the UC/VVoIP NTP server, the server should be placed \nbehind a firewall and access to the NTP server limited. Only clients on the UC/VVoIP \nVLAN should have the ability to request time from the UC/VVoIP NTP server. All other \nrequests should be denied.  \nTrusted path and channel protections  \nWhen sensitive data is passed from client en dpoint to a UC/VVoIP call -processing \nserver, that data must be protected from modification and disclosure. Data must be \nprotected when administ ering UC/VVoIP servers and endpoints as well. This can be \nachieved through using protocols that provide encryptio n. In addition to modification and \ndisclosure protections, IP devices should also use protocols that provide two -way \nauthentication that is cryptographically secure. In the absence of en cryption, a malicious \n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  13 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \nactor could eavesdrop on a connection to steal c redentials  or sensitive information.  In \nthe absence of server authentication, a malicious actor could perform man -in-the-middle \ninterception  of a connection and masquerade as th e server to compromise a client . In \naddition, in the absence of client authenti cation and encryption, a  malicious actor  could \nperform a man -in-the-middle on a client endpoint and masquerade as an authorized \nclient endpoint.  \nMitigations  \nStandard protocols can be used to provide encryption and two -way authentication to \nsecure sensitive  data: Internet Protocol Security (IPsec), Secure Shell (SSH), Transport \nLayer Security (TLS), Datagram TLS (DTLS), and Hypertext Transport Protocol Secure \n(HTTPS) are such protocols. The NSA -approved Commercial National Security \nAlgorithm (CNSA) Suite provides cryptographic requirements for these protocols to be \nused securely and are list ed in Committee on National Security Systems Policy No. 15 \n(https://cnss.gov/CNSS/issuances/Policies.cfm ).  \nSummary of Part I  \nWhen securely deploying UC/VVoIP systems, the network is the first critical place to \nenact security. Leverage security features included in network equipment to enforce \naccess control and data/voice separation and to implement traffic prior itization, \nencryption, and authentication services. By configuring the network to adhere to the \nrecommendations in this guide, the network can provide essential security services to \nprotect data traversing the network as well as the devices connecting to i t. \nOnce an administrator has implemented these network security recommendations, the \nnext step is to move on to security at the perimeter.  \nBack to Table of contents  \n  \n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  14 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \nPart II: Perimeter security best pract ices and  \nmitigations  \nWhile the first part of this report addressed UC/VVoIP security on the network,  \nPart II addresses security at the perimeter.  \nThe perimeter is where all communications external to the organizations UC/VVoIP  \nsystem enter or leave the call -processing network. Session border controllers are \nessential and enforce call signaling protocol standards for traffic entering and exiting the \nlocal UC/VVoIP network. By enforcing call signaling protocol standards, a layer of \nprotection is provided to the servers residing on the internal network that process \nUC/VVoIP communication packets. In addition, SBCs support secure connectivity from \nlocal UC/VVoIP servers to remote service providers and other external UC/VVoIP \nsystems . Implementation of perimeter security should be done after implementing best \npractices for the network, as described in Part I.  \nThe perimeter, in this case, refers to the external method of communication for the \nUC/VVoIP call -processing system only. This includes PSTN gateways, SBCs, and \nvirtual private networks (VPNs). All devices that form the perimeter should be securely \nmanaged from a dedicated management network.  \nPSTN gateway protections  \nPSTN gateways connect a UC/VVoIP call -processing system to the P STN. The threat \npresented by gateway devices is that malicious users from outside of the network could \nconnect directly to the gateway device and make unauthorized calls. Unauthorized calls \ncould lead to toll fraud. Another problem with some PSTN gateways is that they can \ndirectly pass call -signaling messages to internal enterprise session controllers (ESCs). \nThis could allow a direct compromise of  the UC/VVoIP servers.  \nMitigations  \nThe best way to prevent unauthorized calls is to require authorized users or  peer \ngateways to authenticate before the gateway will complete a call. Some gateways query \na separate server to check if a call is authorized. In this case, a secure channel must be \nused between the gateway and the authorization server.  \nPlace PSTN gateway s on their own VLAN and in a DMZ off of a session border \ncontroller interface. Use packet filtering to allow signaling messages from authorized \n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  15 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \nservers only. Prevent UC/VVoIP endpoints from sending signaling messages directly to \nthe gateway. Instead, use t he UC/VVoIP server as an intermediary.  \nGateways must validate and terminate all PSTN signaling at the gateway. The gateway \nshould convert PSTN signaling messages to UC/VVoIP signaling messages. This \nreduces the likelihood of a successful compromise of  the UC/VVoIP servers through th e \ngateway. A malicious actor could still directly compromise  the gateway and use it as a \nplatform for lateral movement to  other UC/VVoIP devices, but this requires additional \nsteps.  \nRegularly apply security updates to the softwar e on gateways located at the perimeter.  \n \nFigure 2: Perimeter security device placement following NSA guidelines  \nProtections for public IP networks functioning as voice carriers  \nA benefit of UC/VVoIP  is the ability to use public IP networks to carry voice traffic \nbetween physically separate offices or between organizations. However, t his use of \n\n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  16 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \nUC/VVoIP requires special security considerations because the organization has little \ncontrol over its voice /video traffic once it enters other networks.  \nOnce on the public network, an organizations UC/VVoIP call -processing traffic will \ntraverse computers and networks owned by any number of third parties who could \nintercept and modify packets without the caller s or organizations knowledge. An \norganizations internal network policy may allow call -processing traffic to be sent in the \nclear; however, the accessibility of voice/video traffic on a public network necessitates \nthe use of encryption and authentication  to establish a secure channel between the \ncalling and answering parties.  \nMitigations  \nUsing UC/VVoIP over a public network to establish calls between different organizations \nrequires specific security steps. For confidentiality reasons, UC/VVoIP should us e \nencrypted trunks when communicating over public IP networks. An organization should \nnot trust the traffic originating from another organization. Decrypt and inspect any \nUC/VVoIP traffic before it is allowed into the internal network. Additionally, an \norganization should hide its internal network topology by using network address \ntranslation (NAT) and non -routable IP addresses on its internal UC/VVoIP network.  \nAn SBC deployed at the network perimeter can provide inspection of the UC/VVoIP \ntraffic as well as provide for NAT traversal. An SBC sits on the edge of the network and \nproxies the UC/VVoIP connection between the network and the service provider. The \nSBC rewrites signaling messages (control signals) and dynamically opens ports so \nmedia streams can tr averse the SBC. SBCs are back -to-back user agents (B2BUAs) . \nB2BUAs proxy connections between endpoints resulting in two separate connections for \nthe communication channel.  SBCs understand and inspect UC/VVoIP communication at \na level that traditional netwo rk firewalls cannot. Because they are B2BUAs, SBCs \nmaintain a separate connection between the internal network and the service provider. \nThis property allows the SBC to inspect and manipulate (i.e. , rewrite) portions of the \nUC/VVoIP packets traversing it. If the streams traversing the SBC are unencrypted, the \nSBC can rewrite the internal IP addresses buried within the UC/VVoIP packets with \nexternal IP addresses, allowing for NAT. The use of non -routable addresses prohibits a \nmalicious actor from directly ro uting a packet across the Internet to a device on the \ninternal network.  \n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  17 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \nInter-office communication can be established using encrypted VPNs. A VPN is likely \nalready established between offices for data -only traffic. However, since it is \nrecommended that UC/ VVoIP call -processing and data networks should be kept on \nseparate VLANs, a separate VPN must be established for call -processing traffic or the \nVPN must respect and maintain VLAN separation.  \nSignaling gateway protections  \nA signaling gateway is a translatio n device that is used to pass signaling (i.e. , call \ncontrol) information between two different network protocols or across a public IP \nnetwork. In the case of UC/VVoIP, this is between an IP -based call -processing system \nand an external legacy telephony net work (i.e. , central office SS7, T1, etc.).  A \ncompromise of a signaling gateway can lead to a disruption of voice and video services, \naccess to the topological information of the network, identifying the subscribers, or other \neffects. The gateway device can  be stand -alone or integrated with another signaling \ngateway.  \nMitigations  \nSignaling gateways are public facing servers. As with all public facing servers, the \nsignaling gateway should be placed in a demilitarized zone (DMZ). The DMZ in this \ncase should be an interface off of the SBC. In addition to being placed in a DMZ, the \nsignaling gateway should be placed in its own VLAN. UC/VVoIP devices should not be \nable to send call control signaling messages directly to the gateway, and instead should \nuse the UC/VV oIP server as an intermediary or protocol translation device. The \ngateway will send the signaling messages to the ESC server, which acts as an \nintermediary between the two UC/VVoIP endpoint devices. Signaling gateways must \nvalidate and terminate all PSTN s ignaling, then convert the terminated signaling \nmessages to UC/VVoIP call control signaling messages for communications to \nUC/VVoIP -based devices. This type of protocol translation enacted by the signaling \ngateway helps reduce the likelihood of a successfu l compromise of  the ESC server.  For \nall signaling protocols that can be encrypted, encryption should be utilized.  \nThe signaling gateway should be configured to log all calls. Because the signaling \ngateway is located at the perimeter, it is capable of keepi ng records of calls entering \nand exiting the network. Keeping call records that include call connection time, length of \ncall, and other data often proves useful when trying to identify  origin and identification of \na malicious actor . \n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  18 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \nMedia gateway protectio ns \nA media gateway is a translation device that converts media streams (voice, video) \nbetween different communications formats and protocols. For example, a media \ngateway device can convert voice media originating from a time-division multiplexing -\nbased (T DM) system to voice media destined for a UC/VVoIP system. The media \ngateway device can be stand -alone or integrated with another device (i.e. , signaling \ngateway). Also note that a signaling gateway can initiate and terminate communications \non the media gat eway. A successful compromise of the media gateway can lead to the \neavesdropping or disruption of all voice and video calls traversing the gateway.  \nMitigations  \nPlace media gateways in their own media VLAN and in a DMZ off of an SBC interface. \nWhen calls ar e routed over public networks, encryption of media protocols is essential  \nin the same way as with signaling protocols. Use a VPN for any inter -office \ncommunications across the public network.  \nWide area network (WAN) link protections  \nNetwork connections to remote offices are considered part of the internal network and \nthus should follow the same data and UC/VVoIP call -processing separation guidelines. \nIn this context, remote office WAN links refer to dedicated leased lines connecting the \nremote and primary n etworks where both ends of the link are managed by the same \norganization. Because the WAN link connects the internal network to the outside world, \nif it is not protected properly, it puts the internal network at risk.  \nMitigations  \nWAN protection methods inc lude VPN protocols such as IPsec and TLS. The VPN must \nsupport the separation of UC/VVoIP call -processing networks and data networks by \neither supporting VLANs or creating individual VPNs for each network.  \nCloud connectivity protections  \nSome organizations are currently migrating the Internet Protocol private branch \nexchange (PBX) to the cloud to accrue benefits the cloud offers (increased efficiency, \ngreater flexibility, reduced infrastructure costs, lower operational costs, and improved \ncommunications). Cl oud-based communications systems can include IP PBXs, SIP \nservers, UC/VVoIP teleconferencing, and other applications.  \n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  19 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \nWith the rise of cloud computing, security remains a top concern. Just as security \nconcerns expanded when PBXs migrated to IP PBXs and the n evolved to UC/VVoIP \nsystems, security is just as relevant now, as UC/VVoIP systems begin the migration to \nthe cloud. Threats to the cloud include denial of service effects, access \nmisconfigurations, and unsecured application programmable interfaces used by \nprogrammers. When migrating to a cloud -based solution, data security must be \nmaintained. Confidentiality of the call signaling must be maintained , the media channel \n(voice, video, and data) must prevent  eavesdropping , and all devices involved must be \nproperly authenticated .  \nMitigations  \nTo help mitigate risks around migrations to the cloud, employ cryptographic protocols to \nencrypt communications between UC/VVoIP devices. Whether moving a call server \nentirely into the cloud, or just providing trunk conne ctivity from an external call server to \nthe cloud, it is best to protect call server peripherals with encryption and authentication. \nThe encryption should be configured on UC/VVoIP signaling and media devices. To \nprotect call control signaling originating from local UC/VVoIP systems out to the cloud, \nuse SIP over TLS or H.235 (H.323 over TLS). To protect voice/video media originating \nfrom local UC/VVoIP systems out to the cloud, use Secure Real -Time Protocol (SRTP). \nSecure connections to the cloud must be e stablished by implementing trusted paths and \nchannels that support encryption and two -way authentication such as IPsec, TLS, \nDTLS, HTTPS, and SSH.  \nDMZ -like separation between logical external gateways and logical internal capabilities \nshould be maintained.  Access control mechanisms should be employed to restrict \naccess to the systems hosted in the cloud. Robust logging should be enabled and those \nlogs routinely reviewed to detect and trace any potential compromises.  \n  \n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  20 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \nSummary of Part II  \nPerimeter security is paramount when deploying UC/VVoIP systems. Protection from \nexternal intrusion s can be mitigated by employing the security features of devices \nlocated at the perimeter , as well as deploying special purpose UC/VVoIP security \ndevices such as an SBC. Access  control, data/voice separation, encryption, \nauthentication, logging, and secure management are all considerations. By \nimplementing these core security components in accordance with this document, the \nsecurity at the perimeter will be greatly enhanced.  \nOnce security at the network and perimeter is addressed, one can turn attention to \nESCs.  \nBack to Table of contents   \n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  21 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \nPart III: Enterprise s ession controller security best  \npractices and mitigations  \nParts I and II of Deploying Secure  Unified Communications/ Voice and Video over IP \nSystems lay out best practices for preparing the network infrastructure and perimeter in \npreparation for deployment of UC/VVoIP systems. Part III addresses th e third step of \nsecuring UC/VVoIP systems by readying enterprise session controllers, also known as \nUC/VVoIP ESCs. A UC/VVoIP ESC is also commonly called an Advanced IP PBX, SIP \nserver, SIP proxy, H.323 Gatekeeper, a call -processing server, or simply just an ESC.  \nThese servers are analogous to the central switches in a legacy PBX system and are \njust as essential. They are necessary for establishing calls and using many features \nsuch as call forwarding, voice mail, and conference calling. Unlike a PBX, an ESC can \nsecurely manage all UC/VVoIP endpoint devices  registered to it. They process calls \nbetween IP endpoints and/or trunk the calls to another ESC.  \nSeveral aspects of ESCs require security considerations to protect the UC/VVoIP  call-\nprocessing system from compromise  and misuse. The software installed on the ESCs \nsuch as operating systems, databases, and call -processing applications must be \nhardened by removing unnecessary applications , services , and default accounts . Most \nESCs u se remote management capabilities that make the server more vulnerable if not \nconfigured with appropriate security mechanisms. The ESCs must meet the stringent \nreliability and availability requirements of traditional (legacy) telephony systems.  \nESCs also p erform the critical function of authenticating and authorizing IP -phones and \ntheir users. In addition to discussing how to protect ESCs themselves, this section \naddresses what authentication and authorization features on the ESC should be used to \ncontrol a ccess to the UC/VVoIP call -processing network.  \nSoftware and application protections  \nESCs usually execute on general -purpose server hardware. Administ rators  of call \nprocessing systems must pay special attention when managing user accounts, \nexamining default  configuration settings for security weakness es, ensuring auditing and \nlogging are enabled, and configuring  any specialized services or features. This section \nwill address these problems as they pertain to ESC software.  \n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  22 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \nUser accounts and passwords  \nUser acc ounts grant access to the server with various rights and privileges. The more \nusers with access to the server, the more opportunity for it to be intentionally or \nunintentionally compromised . Limiting access to the server helps prevent this. Many \nsystems in clude a number of built -in default user accounts with default passwords, \nwhich are public knowledge or can be easily guessed. These accounts provide easy \nentry for malicious actors  and are often overlooked during the installation process. The \nlack of a pas sword or a bad password choice can allow easy access into the device and \ntherefore into the network.  \nMitigations  \nUser accounts must only be created for those individuals who manage the server. \nThese accounts should be granted the absolute minimum permissi ons necessary to \ncomplete the users task. User accounts and password s that are built -in or default \nshould be deleted or changed. To prevent password guessing, enforce complexity rules \nfor user account passwords and limit the number of consecutive failed l ogin attempts. \nFollow National Institute of Standards and Technology (NIST) Special Publication SP  \n800-63B Digital Identity Guidelines ( https://pages.nist.gov/800 -63-3/sp800 -63b.html#se c5). NSA \nrecommends using multi -factor authentication for managing critical IT components like \nESCs, when possible. However, not all ESCs currently support multi -factor \nauthentication.  \nDefault UC/VVoIP server configuration settings  \nThe software on call -processing servers is typically installed with default configuration \nsettings. The server may be configured by default for maximum functionality instead of  \nadequate security. Unknown to the administrator, features could be enabled that are not \nappropriate for  the installation environment.  \nMitigations  \nServers should be configured in accordance with the Security Technical Implementation \nGuides (STIGs) maintained at the DoD CYBER EXCHANGE ( https://public.cyber.mil/st igs). \nIf no STIGs are available for the deployed server, the vendor hardening guides should \nbe followed instead. Periodically check the configuration settings to verify unattended \nchanges to the configuration have not occurred. Settings that enable extra f eatures \nshould be carefully considered and evaluated before enabling.  \n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  23 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \nAudit and logging apparatus  \nWithout auditing and logging, unauthorized access or modification of the ESC will not be \nrecorded. System records should be kept for any and all accesses to the ESC, whether \nby a user or administrator. Even an authorized change to the ESCs configuration might \nresult in a server malfunction. Detecting and recovering from server actions may require \nreconstructing the events from the audit log messages. UC/VVoIP systems perform  call \nlogging for calling records. This is done using call detail records (CDRs). CDRs can also \nbe used for detecting toll fraud and other unauthorized usage of the UC/VVoIP call -\nprocessing system.  \nMitigations  \nEnable auditing and logging (in cluding CDRs) on the server and any critical devices \nsuch as conferencing systems, integrated voicemail systems, and gateway protocol \ntranslators. Review logs regularly for security and access violations. Store logs for a \nperiod of time in accordance with an organizations security policy. Securely transmit \nlogs to a separate logging server that has been hardened  and capable of encrypting the \nlogs at rest . Configure the logging server to accept entries only from authenticated \nmachines.  \nSoftware vulnerabilities  \nSoftware vulnerabilities will inevitably arise in the ESC operating system and server \napplications. Software vulnerabilities can leave an ESC open to denial of service and \nremote access techniques . \nMitigations  \nApplying software security pat ches to the ESC should be applied immediately once \navailable. Software updates should be cryptographically signed by the software vendor \nto ensure authenticity. To reduce the chances of updates causing unforeseen problems \non production servers, test the up dates on a test network that approximates the \nproduction network.  \nMalicious software  \nSince many ESCs run general -purpose operating systems, they are susceptible to the \nsame computer viruses. This includes Trojan horses, worms, and other malicious \nsoftware that affect these operating systems.  \n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  24 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \nMitigations  \nFor ESCs that run atop general -purpose operating systems, install anti -virus software \nand regularly update virus definitions. Do not use ESCs for general Internet activities, \nsuch as email and web applicatio ns. If available, use a host -based firewall to protect \nagainst malware and to limit the spread of any infection. Enforce signed software (see \nEnforce Signed Software Execution Polices, https://www.nsa.gov/What -We-\nDo/Cybersecurity/Advisories -Technical -Guidance ) to verify that the software is valid and to keep \nmalicious software off the device.  \nNetwork services  \nNetwork services running on production servers represent a threat because unknown \nvulnerabilities could  be exploited by a malicious acto r. Types of network service \nprotocols include DHCP, DNS, File Transfer Protocol (FTP), and Simple Mail Transfer \nProtocol (SMTP). Unnecessary network services running on an ESC pro vide additional \nattack surface and represent a drain on the resources needed to maintain calling  \nservices. If administrators are unaware of the services running on their ESCs, security \nupdates could go unapplied , and compromises  could go unnoticed . \nMitigat ions \nDisable all network services on the ESC that are not in use and not needed  for ESC \nfunctionality . Consult the server vendor to determine which services are required by the \nsystem. Carefully consider the security implications of maintaining a service a gainst the \nfeatures provided by the service.  \nDatabase security  \nUC/VVoIP call -processing systems may employ a separate database to store user, \ndevice, and call detail record information. Access to this database is typically managed \nvia the remote management  interface employed by the ESC, such as a web interface or \nvendor software. However, the database server may be directly accessible by other \nmeans that require protection. Compromising the database server compromises the \ncall-processing network.  \nMitigation s \nSecure the database by following all the guidelines for general software security \noutlined above.  \n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  25 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \nReference vendor documentation on securing the database. If the database is running \non hardware (virtual or physical) separate from the ESC, VLANs should be  used to \ncreate a dedicated communication channel between the database and the ESC. This \nchannel should be encrypted. Authentication to the database server should be enabled. \nIf possible, on the database server configure an allow list that only allows the ESC and \nmanagement hosts to communicate with it.  \nCryptographic key material  \nESCs that support encrypted communications also store cryptographic key material for \nencryption and authentication purposes. A  malicious actor  with access to these servers \nmay be a ble to extract the key material from the ESC. If successful, they may be able to \nimpersonate the server and more easily eavesdrop on or capture calls, including some \ntypes of encrypted calls.  \nMitigations  \nDifferent types of key material require different le vels of protection. At a minimum, \nprivate keys used to digitally sign configuration and firmware files, downloadable \napplications, and certificates should be stored encrypted on the ESC. When backing up \nkeys for recovery purposes, those keys should be stor ed on a computer or device that is \nnot connected to the network. If supported by the ESC, use a cryptographic hardware \ntoken to store keys and to perform all cryptographic operations requiring access to the \nkeys. Detailed information on key management, sto rage, and protection can be found  in \nNIST  Special Publication 800 -57 (https://csrc.nist.gov/projects/key -management/key -management -\nguidelines ). \nPhysical security protec tions  \nIn most cases, a server that can be physically reached can be compromised. An \nunauthorized person could easily disable the server by shutting it down or physically \ndamaging it.  \nAn unauthorized person could also use one of many common techniques to tr y to gain \nadministrative access to the servers. BIOS passwords can be reset using jumpers on \nthe motherboard, boot disks can be used to load alternate operating systems, \npasswords can be changed on servers, and many other techniques can be used  to \nbreak in to a server once physical access has been obtained. Server hardware can be \n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  26 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \nphysically damaged in a number of other ways, including intentional and unintentional \nfires, flooding from broken water pipes, and natural disasters.  \nMitigations  \nPhysical security p recautions must be taken to deny unauthorized access to the ESC. \nPut the ESC in a locked cabinet in a locked and controlled room. Place alarms on the \nentry points to the server room. Use a control for access to the room that logs personnel \nentering and exiting. Use surveillance cameras and human monitoring in high -value \ninstallations.  \nDisable booting from removable media and enable BIOS passwords to prevent BIOS \nmodification.  \nInstall fire suppression systems  to protect the ESC servers from fire damage. Use \nsuppression systems safe for electronic equipment in high value installations. To \nprevent accidental flooding, do not run water or sewage mains through the room \nhousing the ESC.  \nEnsure availability of servi ces so, if a disaster destroys one data center, the whole \norganization does not lose UC/VVoIP call -processing services. For example, provide \neach geographic location with its own ESC and a backup connection to the PS TN \nservice provider, or another remote E SC. \nService availability protections  \nAvailability of UC/VVoIP call -processing services is one of the most important \nconsiderations, because UC/VVoIP device users are accustomed to the 99.999% \ntelephone dial tone off -hook standard. To ensure ESCs meet this level of availability, \npotential power and hardware failures, data loss, and access to emergency services \nmust be addressed.  \nHardware and power failures  \nDisk drives, power supplies, motherboards, memory, and other equipment will \neventually fail along with power outages.  \nMitigations  \nAt a minimum, server hardware must have RAID ( redundant arrays of independent \ndisks) support to protect against disk drive failure. To protect against total hardware \n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  27 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \nfailure, configure ESCs in a high availability configuration th at automatically takes over \nthe duties of the primary server should it fail. Keep a spare duplicate server readily \navailable to replace the failed server. Have redundant power supplies on separate \ncircuits in case of a circuit failure. Provide short -term p ower backup using uninterruptible \npower supplies for all servers. When availability is critical, provide long -term backup \npower.  \nData loss  \nHigh-availability hardware cannot protect against all hardware failures, software errors, \nor intrusions corrupting da ta on ESCs. Such failures should require quick recovery of \nESCs to return to operational status.  \nMitigations  \nTo ensure a quick system recovery, regularly back up data from the UC/VVoIP systems. \nA backup and recovery policy that describes the recovery proc ess must be in place. \nTest backup and recovery processes.  \nStore backups in an environmentally controlled secure location that will ensure they are \nnot compromised. Encrypt any backups that leave the physical control of the \norganization (e.g., for shipping) . \nEmergency Services  \nOne of the advantages of UC/VVoIP call -processing systems is being able to physically \nmove a UC/VVoIP device from location to location and keep the same number. This \nphysical move could be to a different room, a different building, or even a different city. \nThe downside to having such flexibility is that it may be hard to pinpoint the exact \nphysical location of a caller in cases of emergencies.  The UC/VVoIP call processing \nsystem must maintain a reliable mechanism to connect to emergenc y services through \nthe network that provides the location of the caller . \nMitigations  \nSubscribe to an enhanced 911 (E911) service through the UC/VVoIP service provider \nand only route 911 calls that originate  within the network  to the 911 service . The E911 \nservice provides a callback number as well as the physical location of the caller to \nemergency personnel. The subscriber should keep location information updated with \nthe service provider. In large enterprises where there are multiple buildings or \ngeographi c locations, phone numbers should be grouped into direct inward dialing \n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  28 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \nnumbers (DIDs) denoting different physical locations. DIDs allow multiple phone \nnumbers to be mapped to one virtual phone number. Users making emergency calls \noriginating outside of th e internal network should use other means (hotel phone, cell \nphone, etc .) to make emergency calls.  \nClient registration protections  \nMany UC/VVoIP call -processing systems allow clients to register automatically with the \nsystem. The automatic registration ke eps the administrator from needing to individually \nprovision each device. Ease of deployment can lead to a  malicious actor  masquerading \nas a legitimate device registering with the ESC and subverting the system.  \nMitigations  \nConfigure the call -processing sys tems to use two -way authentication. The ESC should \nauthenticate the identity of the client, and the client should similarly authenticate the \nESC. Disable automatic registration to control registration to the ESC  and prevent \nunauthorized devices from regist ering .  \nRemote management protections  \nUC/VVoIP servers offer a variety of methods of remote management, such as web -\nbased interfaces, proprietary vendor software, open source software such as Simple \nNetwork Management Protocols (SNMP) and as part of a serv ice agreement remote \nmanagement by service providers. Remote management poses a security threat \nbecause unauthorized access can seriously damage or compromise UC/VVoIP \nnetworks, capabilities, and security features. The flexibility and timesaving benefits o f \nremote management can be safely used if appropriate security precautions are taken.  \nWeb -based man agement interfaces  \nMany systems offer web -based remote management interfaces because of their \nfamiliarity and  easy  ability to remotely manage the UC/VVoIP  system from anywhere on \nthe network. However, web servers and web applications commonly are susceptible to \na variety of vulnerabilities such as buffer overflows, cross -site scripting, authentication \nbypass, and injection. Additionally, some webservers all ow communication over the \nHTTP protocol that  is not encrypted. A  malicious actor  in the communication channel \nbetween the administrator and the web  server could compromise important information \nsuch as the administrators password. Many browsers also allow  users to cache login \n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  29 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \ninformation for authenticating to web sites. Unauthorized access to administrator \nworkstations could potentially compromise the login for the ESC.  \nMitigations  \nRemotely managing an ESC via a web interface should only be done over an en crypted \nchannel. TLS on the web server should be enabled and all non -TLS web access \ndisabled. This will ensure all management sessions protect sensitive information such \nas login information.  \nThe web -based interfaces should be only accessible via a managem ent network that is \nseparate from the general -purpose network. Additionally, access to the web -based \ninterface should be limited to IP addresses of administrative workstations. If remotely \nmanaging the ESC from a remote location outside of the networks pe rimeter, a trusted \nchannel  that connects  the administrator into the management network before they can \nadminister the ESC should be used.  \nFinally, all management hosts should have their web browsers configured to not cache \nlogin information.  \nProprietary m anagement software  \nSome vendors have written proprietary client and ESC software to manage their ESC. If \nthe proprietary software and connection between the ESC and client are not encrypted \nand authenticated, then control over the ESC can be obtained by a malicious actor . \nMitigations  \nTo protect the use of proprietary management software, take precautions similar to \nweb-based interfaces. Network traffic should be encrypted. If the software does not \nsupport encryption, route traffic through an encrypted tunne l. Limit access of the \nmanagement interface on the ESC to a separate administrative network and to specific \nIP addresses. Usernames and passwords must not be cached by the client software. \nApply security updates to the ESC in accordance with the guidelines  referenced in the \nSoftware Vulnerabilities, Malicious Software, and Network Services sections of this \nguide.  \n \n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  30 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \nSummary of Part III  \nThis part of the report covered UC/VVoIP ESC best practices and mitigations for a \nsecure system. Software updates (operating system  and applications) should be \ncryptographically signed to ensure authenticity. Only software needed by the server \nshould reside on the server. Management accounts and access to the server should be \nminimized and protected by good password policy. All settings (including default) should \nbe evaluated for their impact on ESC security and system security. Enable secure \nauditing and logging with regular review to identify security issues. All crypto graph ic \nkeys should be securely stored. Physically secure t he ESC machinery and limit physical \naccess. Authenticate, encrypt, and limit remote access as much as possible. A secure \nESC will produce a more secure UC/VVoIP system overall.  \nOnce security of the ESC is addressed, one can turn attention to the UC/VVoIP \nendpoints.  \nBack to Table of contents   \n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  31 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \nPart IV: UC/VV oIP endpoint best practices and  \nmitigations  \nThis fourth and final part to Deploying Secure U nified Communications /Voice and Video \nover IP Systems  deals with securing UC/VVoIP endpoints. With voice/video/data and \ncall-processing network infrastructures already securely in place, UC/VVoIP phones, \ndesktop VTCs, and other UC/VVoIP endpoint devices can be added to the network and \nsecured. Before adding UC/VVoIP endpoints to the call -processing network, \nadministrators have key decisions to make so the endpoints and network are both \nsecured against malicious actors : \n What elements of the hardware and software need to be locked down?  \n Do a dministrators need to be able to remotely administer the UC/VVoIP \nendpoints?  \n What convergence features are needed?   \n Do the UC/VVoIP endpoints connect to the network over Ethernet or Wireless?  \n Do UC/VVoIP endpoints running on general purpose operating syste ms need to \nbe supported?  \nSoftware and hardware security  \nTraditional phones contain limited functionality in the actual phone hardware because \ntelephony features are implemented in the central office switch  (CO)  or PBX. However, \nUC/VVoIP endpoints are more autonomous because many do not require a CO or PBX \nin order to take advantage of much of their functionality. This requires a more capable \nand complex endpoint. The additional functionality and complexity in UC/VVoIP \nendpoint software increases the chance of vulnerabilities. These vulnerabilities should \nbe mitigated similarly to general -purpose computers on the network. In addition, l ike \ncomputers , some UC/VVoIP endpoints allow users to install third -party software. These \napplications could also add vulnera bilities if not properly controlled  and managed . \nSoftware vulnerabilities  \nUC/VVoIP endpoints run on embedded operating systems or as a software application \n(softphone) on a general -purpose machine. When running on a general -purpose \nmachine , in addition to the UC/VVoIP software and OS potentially having vulnerabilities, \nother applications , such as web browsers , that are installed could contain vulnerabilities  \nas well . These vulnerabilities could allow denial of service impacts  against the endpoint, \n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  32 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \nmodify re mote manage ment functionality, or allow a malicious actor to gain complete \ncontrol of the endpoint and surreptitiously collect room audio.  \nMitigations  \nMethods to mitigate the software vulnerabilities in UC/VVoIP endpoints are similar to \nmethods used to pro tect other computer systems on the network. Disable unnecessary \napplications and services, particularly if they utilize remote connections or provide \nremote access . Any known vulnerabilities must be patched as soon as possible. This \ncan be automated by hav ing UC/VVoIP endpoints regularly and automatically download \nsigned firmware files from a trusted central server. Finally, network access to the \nUC/VVoIP endpoints can be limited by placing them on separate UC/VVoIP -only \nVLANs. VLANs are covered in the firs t module of the Deploying Secure U nified \nCommunications /Voice and Video over IP Systems  document that covered securing the \nUC/VVoIP network. These steps make it more difficult for a  malicious actor  to exploit \nvulnerabilities on a UC/VVoIP endpoint or an ap plication -laden video teleconferencing \ndevice.  \nThird -party software  \nSome UC/VVoIP endpoints have the capability to run third -party software downloaded \nfrom the network. For example, one Java -based endpoint allows the user to download \nJava applets from the vendors Internet site. There are risks to allowing such behavior:  \n Downloaded software that appears legitimate may contain malicious functionality.  \n The software may contain unknown vulnerabilities, which could be exploited to \ncompromise the endpoint.  \nMitig ations  \nEnforce a policy for downloading external software onto UC/VVoIP endpoints that is at \nleast as strict as that for downloading software to desktop computers. In many cases, \nthe need for higher reliability for the UC/VVoIP system will necessitate stri cter policies. \nWhere possible, disable the capability to download external software and only distribute \nnecessary software with firmware upgrades  via a controlled mechanism . If there is a \nneed to allow users to load applications on the UC/VVoIP endpoint , then set up a \nseparate server inside the organization to provide only cryptographically signed \napplications. Block access to vendor web sites offering application downloads for the \nUC/VVoIP endpoint. Block direct Internet access by the UC/VVoIP endpoints, i f \npossible. If that is not possible, use a DMZ proxy server for Internet web access. If \n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  33 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \nusers must connect back remotely with an UC/VVoIP endpoint, ensure the UC/VVoIP \nendpoint connect s back to the enterprise using a cryptographic VPN (e.g. , using IP sec).  \nMalicious software  \nMalicious software could exploit or introduce software vulnerabilities in the UC/VVoIP \nendpoint. Malicious software manifests in an organizations telephone network similarly \nto how it manifests on data -only networks. Malicious software  can install backdoors into \ndesktop VTC and UC/VVoIP endpoints, gather sensitive information, or use UC/VVoIP \nendpoints to compromise  other call -processing systems. The spread of worms on \nUC/VVoIP call -processing networks could disrupt or disable voice/vid eo capability.  \nMitigations  \nAntivirus solutions exist for some embedded platforms , but not all because the \nUC/VVoIP industry is still catching up with technology to protect UC/VVoIP endpoint \ndevices. Antivirus software does not completely mitigate malicious  software because \nsignature based virus scanners only detect known malware variants. Use \ncryptographically signed updates along with the antivirus software to minimize malware.  \nEmbedded microphones  \nAll UC/VVoIP endpoints contain at least a single microphon e in the handset, and  usually  \nthere is a  speakerphone that contains an additional microphone. This includes desktop \nVTCs and softphones on laptops and PCs , as they too have microphones and \nspeakerphones. The UC/VVoIP endpoints are software -controlled devic es, with the \nmicrophones controlled by software. A software vulnerability could enable a  malicious \nactor  to control the UC/VVoIP endpoint and thus the microphones without the users \nknowledge.  \nMitigations  \nIf a UC/VVoIP is placed in a sensitive area, its sp eakerphone microphone should be \nphysically removed or at least disabled on the device. The original handsets should be \nreplaced with push -to-talk handsets or headsets. This prevents the microphone from \nbeing activated except when a person is using the UC/V VoIP. Another possible \nmitigation is to use UC/VVoIP endpoints that have handsets and physically disconnect \nthe microphone when the handset is on the hook.  \n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  34 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \nRemote management of UC/VVoIP endpoints  \nThe majority of UC/VVoIP endpoints can be classified as netw ork-controlled devices. \nThere are many UC/VVoIP endpoint types. The various UC/VVoIP endpoint types \ninclude handset voice -only VoIP phones, handset voice/video VVoIP phones, \nsoftphones with headsets for laptops and PCs, floor model telepresence (voice/vide o), \nroom size telepresence (voice/video), desktop VTCs, and desktop USB phones. The \nsheer number of UC/VVoIP endpoints that an organization must deploy means that the \nUC/VVoIP endpoints are made to be easily configured and managed using remote tools \nover t he network. This capability means that each UC/VVoIP endpoint represents \nanother potential point of network infection and each must be secured. An exploit of this \nremote management functionality c ould have serious consequences including denial of \nunified c ommunications and call -processing services to an organization, and leakage of \ninformation to unauthorized parties inside and outside the organization. The common \nmethods for remotely managing UC/VVoIP endpoints are DHCP, firmware and \nconfiguration file dow nloads from a call server, web -based management consoles, \nnetwork management such as SNMP, or administrative login tools. All of these methods \nmust be addressed during the design of an UC/VVoIP  network.  \nDownloading firmware and configuration files  \nMany UC /VVoIP endpoints are similar to network -booted desktop computers. They \nconnect to the network, obtain an IP address using DHCP, and download operating \nsystem images and configuration files from a central server. This keeps the \nmanagement of software and co nfiguration versions centralized. It also allows for easy \nupdates of the UC/VVoIP endpoint's firmware. However, for a  malicious actor , it opens a \npathway to completely control an organizations UC/VVoIP endpoints and other \nvoice/video endpoint devices. By modifying the firmware or configuration file, a  \nmalicious actor  can insert malicious code into the UC/VVoIP endpoints operating \nsystem, use the endpoint device as a rogue agent, redirect calls to malicious servers, or \ndisable the UC/VVoIP endpoint.  \nA UC/V VoIP endpoints firmware or configuration file could be  modified in one of two \nways. A malicious  actor  could perform a man -in-the-middle technique to intercept and \nreplace the files as they are downloaded from the call server. This requires local \nnetwork a ccess or the ability to spoof DHCP messages. Or, a  malicious actor  could \ncompromise the ESC storing the firmware and configuration files. This is a more serious \n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  35 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \nproblem because control of an ESC e nables a malicious actor to easily compromise  all \nUC/VVoIP e ndpoints in an organization.  \nMitigations  \nChoose UC/VVoIP endpoints that will process cryptographically signed firmware and \nconfiguration files. Each UC/VVoIP endpoint must have the signature verification key \nloaded on the UC/VVoIP  endpoint in a secure manner such as on an isolated network \nor over a direct serial connection. Save the signing key in a secure place and do not \nstore it on the download server. The UC/VVoIP endpoint must verify the signature on \nevery file and reject any files with invalid signatures.  \nWeb -based management interface  \nMost hardware UC/VVoIP endpoints have embedded web servers, which allow the \nmodification of important settings on the endpoint device. Many times the same settings \ndownloaded in configuration f iles are modifiable in this manner. Having w eb servers \nrunning on UC/VVoIP endpoints raise concerns as each UC/VVoIP endpoint now \ncontains a web server that may be vulnerable.  \nMitigations  \nThe users should access necessary UC/VVoIP endpoint features through  the phones \ndisplay, and administrators should configure UC/VVoIP endpoint settings using \ndownloaded configuration files from a server. Deactivate the web interface. If there is a \nsetting that needs to be set through the web server in the UC/VVoIP endpoin t, the \nadministrator should enable the web server through a secure signed download. Change \nthe setting with web server, and disable the web server with another secure signed \ndownload.  \nSimple Network Management Protocol (SNMP)  \nSNMP is used to read and write  settings on many network devices, allowing them to be \nintegrated into comprehensive network management tools. Some UC/VVoIP endpoints \nmay offer SNMP access to their settings. Compromising SNMP access to UC/VVoIP \nendpoints has consequences similar to compr omising of configuration files or web \ninterfaces.  \nMitigations  \nDo not use SNMP to manage UC/VVoIP endpoints. Turn off all SNMP versions on the \nUC/VVoIP endpoint. If SNMP must be used to manage UC/VVoIP endpoints, then use \n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  36 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \nSNMP version -3 over TLS or DTLS ( SNMPv3, RFC 5953) with its authentication \nfeatures. Previous version s of SNMP do not offer the same protections. \nSNMPv3/TLSv1.3 (RFC 5953) allows per -user passwords and uses cryptographic \nfunctions to protect the password and message integrity. If SNMPv3/TLSv1.3 is not \navailable, then use signed configuration files that can  be downloaded from the call \nserver rather than using SNMPv1 (or v2) to manage the UC/VVoIP endpoints.  \nTelnet  \nTelnet is another remote management solution available on many UC/VVoIP endpoints. \nAnd like DHCP, HTTP, NTP, SNMP, and many earlier protocols, Tel net was not \ndesigned with security in mind. Telnet is a command line interface to the UC/VVoIP \nendpoint configuration. It is an antiquated and unsecured protocol: sensitive information, \nsuch as passwords, is transmitted in the clear over the network. Witho ut any analysis \ntools, a novice actor  can view an administrators Telnet login password and then use the \ninformation to create havoc on the system.  \nMitigations  \nDisable Telnet. Use other methods of remote management like SSH. Relative to Telnet, \nSSHv2 is a better option that provides a secure channel for remote management \nbecause of its encrypted communications.  \nNetwork connectivity  \nUC/VVoIP endpoints include a variety of network connectivity solutions such as \nEthernet, Infrared Data Association (IrDA) , Bluetooth, Console, and Wi-Fi access. \nSome UC/VVoIP endpoints offer all of these connectivity solutions, acting as a universal \nwireless access point. While some sort of network connectivity is required, too many \nconnectivity options will make an UC/VVoIP endp oint more difficult to secure. Each \nconnectivity solution adds configuration complexity and offers another potential path for \na malicious actor  to exploit.  \nEthernet  \nEthernet is a common means of connecting a wired UC/VVoIP endpoint to the \nUC/VVoIP network.  To make deploying UC/VVoIP endpoints easier and to avoid adding \nadditional Ethernet cabling, many UC/VVoIP endpoints feature an integrated Ethernet \nswitch in the UC/VVoIP endpoint to provide another device connection. As an example, \na PC can be plugged in to the UC/VVoIP endpoint, and the UC/VVoIP endpoint can be \n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  37 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \nconnected to the network. This effectively causes the UC/VVoIP endpoint to function \nlike a bridge between the PC and Ethernet switch. The bridge on the UC/VVoIP \nendpoint will enable both the PC and  UC/VVoIP endpoint to use the same network \naccess switch port. Because the UC/VVoIP endpoint and computer will be privy to \nnetwork traffic meant for each other, a  malicious actor  who compromises the PC may \nhave direct access to the UC/VVoIP endpoint and vi ce versa.  \nBest practices require UC/VVoIP call -processing require voice/video call -processing \nand data -only networks be kept separate using VLANs. If the UC/VVoIP endpoint does \nnot support VLANs on an integrated Ethernet switch, then a computer connected to the \nUC/VVoIP endpoints PC port has access to the UC/VVoIP call -processing VLAN.  \nMitigations  \nDo not use the PC port on the UC/VVoIP endpoint and disable it in the UC/VVoIP \nendpoints configuration. This prevents a device from connecting to the UC/VVoIP \nendpoint and prevents a device from violating VLAN separation. If the environment \nmandates the PC port be used, then the UC/VVoIP endpoints integrated Ethernet \nswitch must support VLANs and be configured.  \nInfrared  \nInfrared data ports utilizing the IrDA pr otocol (an infrared protocol for wireless infrared \nline-of-sight communications for the last meter between devices) are used to transmit \ndata between devices using invisible pulses of light. Example uses of infrared ports \ninclude synchronization of data be tween handheld devices and PCs and printing from \nhandheld devices directly to a printer. Devices that communicate using infrared must be \nwithin sight of each other. While some UC/VVoIP endpoints presently have infrared \nports, no UC/VVoIP endpoint is known to make use of this port, but its existence \nsuggests that features using the infrared port will be available in the future. For \nexample, a person could synchronize his mobile phone address book with the address \nbook on the UC/VVoIP endpoint.  \nInfrared ports  on UC/VVoIP endpoints raise several security concerns. First, there is no \nbuilt-in security mechanism other than range of transmission and the line -of-sight \nrequirement. Each application must implement its own confidentiality , authentication,  \nand integrit y mechanisms. Second, a  malicious actor  does not need to physically \ninteract with the UC/VVoIP endpoint to access it. An actor  with line -of-sight could \n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  38 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \npotentially compromise  the UC/VVoIP endpoint. Third, a compromised UC/VVoIP \nendpoint could use the infra red port to capture other infrared communications in the \nsame room as itself.  \nMitigations  \nCover the infrared port with metallic tape. This prevents any use of the port, including by \na malicious actor  who has compromised a UC/VVoIP endpoint. If use of the i nfrared \nport is necessary, then individually evaluate and configure each allowed application for \nsecurity.  \nWireless personal area network (WPAN)  \nBluetooth is a short -range WPAN protocol that connects personal area network devices \ncentered on an individual persons workspace. The primary differences between \nBluetooth and infrared are that Bluetooth does not require line -of-sight for successful \ndata transmission and Bluetooth features some security mechanisms that provide \nconfidentiality and integrity. The de signers of UC/VVoIP call -processing devices must \nbe aware of the many security issues associated with WPAN technologies  and \nimplement mitigations for them . \nMitigations  \nThe best solution is to use devices that do not support Bluetooth. If Bluetooth -enabled \nUC/VVoIP endpoints are used, then proper security measures must be taken. Disable \nBluetooth functionality on UC/VVoIP endpoints and desktop VTCs. Addressing all the \nsecurity issues related to Bluetooth is outside the scope of this document. NISTs \nSpecial Publication 800 -121, Guide to Bluetooth Security  \n(https://csrc.nist.gov/publications/detail/sp/800 -121/rev -2/final ) discusses the details of Bluetooth \nsecurity.  \nWireless local  area network (WLAN)  \nWLANs are increasingly common in organizations. This category of connectivity \nincludes technologies referred to as Wi-Fi or IEEE 802.11. Some UC/VVoIP endpoints \ncan use WLANs as the primary source of connectivity instead of a wired (Et hernet) link.  \nUC/VVoIP endpoints that use WLANs to connect to the network must mitigate both \nWLAN and UC/VVoIP call -processing vulnerabilities. They must address problems such \nas confidentiality, integrity, and reliability of the wireless link in addition to the UC/VVoIP \n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  39 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \ncall-processing vulnerabilities discussed elsewhere in this guide. This makes deploying \nWLAN UC/VVoIP endpoints more complex.  \nMitigations  \nWLAN UC/VVoIP endpoints must meet the same security policy as other WLAN devices \ndeployed by an organi zation. In addition, the WLAN UC/VVoIP endpoint and the WLAN \nnetwork must meet the requirements placed on the overall wired UC/VVoIP call -\nprocessing infrastructure such as separation of data and voice/video call -processing \ntraffic by using VLANs, different  WLAN Service Set Identifiers (SSIDs) or entirely \nseparate WLAN inf rastructure . \nNetwork connectivity mitigation summary  \nOf the various network connectivity solutions for UC/VVoIP endpoints, only connecting \nvia Ethernet is recommended. If voice/video call -processing and data networks are \nseparated onto different VLANs, the computer port on UC/VVoIP endpoints should not \nbe used unless the UC/VVoIP endpoint supports VLANs.  \nThe wireless network technologies discussed in this section could present significant \nvulnerabilities in the voice/video call -processing network. If the organization needs \nwireless access, it should be implemented using a separate and dedicated wireless \ninfrastructure, and not integrated with the  UC/VVoIP call -processing solution.  \nConvergence  features  \nConvergence features allow the communication and synchronization of data between \nmany different types of devices. UC/VVoIP endpoints and desktop VTCs may include \nfeatures that allow them to interact with applications on other IP devices. For inst ance, \nan address book application on the PC instructs the UC/VVoIP endpoint to dial a \nnumber when the user clicks on an entry in the address book, or a mobile device \nsynchronizes its address book with the address book on the UC/VVoIP endpoint. Each \nof thes e features requires another available service on the UC/VVoIP endpoint that \ncould contain vulnerabilities. Each application requires an authentication and \nauthorization mechanism to protect data stored on the UC/VVoIP endpoint and other \nconvergence devices . The data must also be protected while it is in transit between IP \ndevices. Since no standards exist, each application will likely have its own mechanisms \nfor implementing integrity and confidentiality. This makes consistently managing and \nprotecting the use of these applications difficult.  \n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  40 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \nA more serious problem is that synchronization with mobile devices could result in the \ntransfer of malicious code, such as viruses, from these devices to the UC/VVoIP call -\nprocessing network. Many UC/VVoIP endpoints are  embedded systems that run \nsoftware similar to that used on handheld devices and cell phones. If these devices are \ninfected with malicious code, that code could be transferred to the UC/VVoIP endpoint.  \nVoicemail services are another area where the UC/VVoIP  call-processing network \ninteracts with the data network. Voicemail systems may make voice messages available \nto users in email  messages . Similarly, u sers may be able to send email that can be \naccessed from the UC/VVoIP endpoint.  \nMitigations  \nUC/VVoIP conve rgence opens the voice/video call -processing network to many of the \nsame vulnerabilities that afflict the data -only network and also allow the UC/VVoIP \nnetwork to afflict the data -only network  as well . The safest mitigation is to block traffic \nbetween voic e/video call -processing and data -only networks. However, the advantages \nof convergence may outweigh the risk. In that case, enforce strong authentication for \nany such service and put authorization controls in place to prevent malicious actor s \nfrom abusing convergence solutions.  \nAuthorized users can still inadvertently spread malicious code. In this case, the points \nwhere data moves between networks should be tightly controlled. Data transfer should \nnot occur directly between the UC/VVoIP endpoint and other devices. Instead, a firewall \nor SBC should be set up to act as a gateway between the voice/video call -processing \nand data networks. At minimum, use a stateful layer 3 and 4 SBC. More appropriate is a \nstateful layer 3 -7 SBC and an application -layer firewall  that can check all data for \nmalicious code. Place any services that must be used on both networks in a DMZ \nbetween the networks. For example, consider synchronizing a mobile device and \nUC/VVoIP endpoint with the same address book. The mobile device should  not \nsynchronize directly with the UC/VVoIP endpoint. Instead, employ a messaging server \nin the DMZ between the voice/video call -processing and data networks. The UC/VVoIP \nendpoint, mobile device, and desktop PC would all access the address book from the \nmessaging server. The messaging server could then act as a gateway between \ndevices, providing authentication and authorization services and scanning data for \nmalicious code.  \n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  41 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \nSoftphones  \nA softphone is UC/VVoIP endpoint software that runs on a general -purpose  device. The \nuse of these phones poses several challenges when the voice/video call -processing \nand data networks are logically separated using VLANs. The softphones must operate \non a computer that is connected to both the data and telephony networks. The P C \nviolates the separation between the telephony and data networks because it must \ndirectly access both networks. Thus, compromise of the PC would allow access to both \nnetworks.  \nReplacing desktop UC/VVoIP endpoints with softphones also creates a single poin t of \nfailure for communications. A widespread problem that affects many PCs or the network \ninfrastructure will disable all communications. Users will not even have a means to \nreport the failure. A fast spreading worm or power outage could create such a sit uation.  \nSoftphones make management of the UC/VVoIP endpoint network more difficult \nbecause the UC/VVoIP call -processing server will not be able to reliably determine the \ntype of device connecting to it. Untrusted softphones can be loaded on PCs by end \nusers. Since the UC/VVoIP call -processing server does not know about these \nsoftphones, it will not be able to ensure they are configured securely.  \nMitigations  \nIf softphones are in use, create another VLAN and place all PCs with softphones on it. \nConfigure traf fic filtering rules to allow UC/VVoIP traffic between this VLAN and the \nUC/VVoIP call -processing VLANs, but do not allow UC/VVoIP traffic on the data VLAN. \nSimilarly, do not allow general data traffic to flow to the UC/VVoIP call -processing \nserver or on UC /VVoIP endpoint call -processing VLANs.  \nIf softphones are densely deployed throughout the network, it is not practical to have \nseparate data softphone VLAN s. Instead, place all PCs whether or not they have \nsoftphones installed in data VLANs and filter traff ic as described for the softphone \nVLAN in the previous paragraph.  \nWhen softphones are used as the primary voice communication mechanism, provide a \nbackup communication method, which does not depend on the UC/VVoIP network, and \nmake it available in every of fice to ensure some form of reliable communication . \n\n \n \n \nU/OO/153515 -21 PP-21-0827 | JUN 2021 Ver. 1.0  42 \n \nNational Security Agency | Cybersecurity Technical Report  \nDeploying Secure UC/ VVoIP Systems  \nPart One: Network Guidelines  \nSummary of Part IV  \nUC/VVoIP can be deployed securely in its environment following secure guidelines. An \nadministrator can secure a UC/VVoIP  endpoint by locking down the software and \nhardware. Update and patch the software as it becomes available using signed files \nfrom a trusted server. Limit network access of the UC/VVoIP endpoint. For UC/VVoIP \nendpoints that have handsets  and used in areas where sensitive conversations occur , \nuse an endpoint that physically disconnects the microphone when on hook, remove the \nspeakerphone microphone , or replace the handset with a push to-talk handset. Disable \nany unnecessary applications on the UC/VVoIP endpo int. Remote management should \nuse secure paths , secure protocols, authentication between devices , and strong \ncryptographic functions. For network con nectivity use wired Ethernet, and disable Wi -Fi, \ninfrared , and other non -wired protocols. Place the UC/ VVoIP endpoints in their own \nVLAN separating voice /video  traffic from all other traffic. Computers and handheld \ndevices may use softphones , but with t he same precaution s as in hardware UC/VVoIP \nendpoints. Using security guidelines with smart configuration s and management \ncontrols increases the UC/VVoIP endpoint security.  \nBack to Table of contents  \nEnd of guidelines  \nThis marks the end of the guidelines to deploy a secure UC/VVoIP solution. These \nguidelines address securi ty concerns in four areas (network, perimeter, enterprise \nsession controller, and UC/VVoIP endpoints) of a UC/VVoIP solution. Following the se \nguidelines, deploying UC/VVoIP features and services can be achieved in a secure \nmanner.  \n \n\n",
  "cves": [],
  "techniques": [],
  "advisory": "cybersecurity-alerts",
  "title": "ctr_deploying secure vvoip systems",
  "source": "nsa",
  "id": "7514755cd7f0f41074f5400f08bcfed1825b5986ff0dd4617be4da36c6ff6753"
}