{
  "markdown": "    \n \n  \n \n \n \n \n \n \n \nThis document is marked TLP: WHITE . Disclosure is not limited. Sources may use TLP: WHITE  when information \ncarries minimal or no foreseeable risk of misuse, in accordance with applicable rules and procedures for public \nrelease. Subject to standard copyright rules, TLP: WHITE  information may be distributed without restriction.  \nFor more informati on on the Traffic Light Protocol, see http://www.us -cert.gov/tlp/ . \n \nPage 1 of 7 |  Product ID: AA 22-137A \nTLP:WHITE    Product ID: AA22 -137A  \n \n May 17, 2022  TLP:WHITE  \n Coauthored by:  \nWeak Security Controls and Practices \nRoutinely Exploited for Initial Access  \nSUMMARY  \nCyber actors routinely exploit poor s ecurity configuration s (either \nmisconfigured or left unsecu red), weak controls , and other poor \ncyber hygiene practices to gain initial access or as part of other \ntactics to compromise a victims system. This joint Cybersecurity \nAdvisory identifies commonly exploited controls and practices \nand includes best practic es to mitigate the issues.  \nThis advisory was coauthored by the cybersecurity authorities of \nthe United States ,[1],[2],[3] Canada ,[4] New Zealand ,[5],[6] the \nNetherlands ,[7] and t he United Kingdom .[8]  \n[Download the  PDF version of this report  (pdf, ### kb). ] \nTECHNICAL DETAILS  \nMalicious actors commonly use the following techniques to gain \ninitial access to victim networks. [TA0001]  \n Exploit Public -Facing Application [T1190]   \n External Remote Services  [T1133]  \n Phishing  [T1566]  \n Trusted Relationship  [T1199]   \n Valid Accounts [T1078]  Best Practices to Protect \nYour Systems  \n Control access.  \n Harden credentials.  \n Establish centralized log \nmanagement.  \n Use antivirus.  \n Employ detection tools. \n Operate  services exposed \non internet -accessible hosts \nwith secure configurations.  \n Keep software updated.  \n\n \n \n \n Page 2 of 7  |  Product ID : AA22 -137A  \nTLP: WHITE    Product ID: AA22 -137A  \n \nMalici ous cyber actors often exploit the following common weak security controls, poor configurations, \nand poor security practices to employ the initial access techniques.  \n Multifactor authentication (MFA) is not enforced. MFA, particularly for remote desktop access, \ncan help prevent account takeovers. With Remote Desktop Protocol (RDP) as one of the most \ncommon infection vector for ransomware, MFA is a critical tool in mitigating malicious cyber \nattacks.  Do not exclude any user, including adminstrators, from this policy.  \n Incorrectly applied privileges or permissions and errors within access control lists. These \nmistakes  can prevent the enforcement of access control rules  and could allow unauthorized users \nor system processe s to be granted access to objects.   \n Software is not up to date.  Unpatched software may allow an attacker to exploit publicly known \nvulnerabilities to gain access to sensitive information, launch a denial -of-service attack, or take \ncontrol of a system.  This is one of the most commonly found poor security practices.  \n Use of v endor -supplied default configurations or default login usernames and passwords . \nMany software and hardware products come out of the box with overly permissive factory -\ndefault configurati ons intended to make the  products  user-friendly and reduce the troubleshooting \ntime for customer service.  However, l eaving the se factory default configurations  enabled after \ninstallation may provide avenues for an attacker to exploit. Network devices are also often pre-\nconfigured with default administrator usernames and passwords to simplify setup. These default \ncredentials are not secure they may be physically labeled on the device  or even readily available \non the internet. Leaving these credentials unchan ged creates opportunities for malicious activity, \nincluding  gaining unauthorized access to information  and install ing malicious software.  Network \ndefenders should also be aware that the same considerations apply for extra software options, \nwhich may come with preconfigured default settings.  \n Remote services, such as a virtual private network  (VPN) , lack sufficient controls to \nprevent unautho rized access. During recent years, malicious threat actors have been observed \ntargeting remote services. Network defenders can reduce the risk of remote service compromise \nby adding access control mechanisms, such as enforcing MFA, implementing a boundary firewall \nin front of a VPN, and leveraging intrusion detection system /intrusion prevention system  sensors \nto detect anomalous network activity.   \n Strong password polic ies are not implemented.  Malicious cyber actors  can use a myriad of \nmethods to exploit we ak, leaked, or compromised passwords and gain unauthorized access to a \nvictim system. Malicious cyber actors have used this technique in various nefarious acts and \nprominently in attacks targeting R DP.  \n Cloud  services  are unprotected. Misconfigured cloud s ervices are common targets for cyber \nactors. Poor configur ations can allow for sensitive data theft and even cryptojacking.  \n Open ports and misconfigured services are exposed  to the internet . This is one of the most \ncommon vulnerability findings. Cyber acto rs use scanning tools to detect open ports and often use \nthem as an initial attack vector. Successful compromise of a service on a host could enable \nmalicious cyber actors to gain initial access and use other tactics and procedures to compromise \nexposed an d vulnerable entities. RDP, Server Message Block (SMB) , Telnet, and NetBIOS are \nhigh-risk services.  \n\n \n \n \n Page 3 of 7  |  Product ID : AA22 -137A  \nTLP: WHITE    Product ID: AA22 -137A  \n \n Failure to detect or block phishing attempts. Cyber actors  send emails with malicious  \nmacros primarily  in Microsoft Word documents or Excel files to infect  computer systems.  Initial \ninfection can occur  in a variety of ways, such as  when a user opens or clicks a malicious \ndownload link, PDF, or macro -enabled Microsoft Word document  included in phishing emails.  \n Poor endpoint detection and response . Cyber acto rs use obfuscated malicious  scripts and \nPowerShell attacks to bypass endpoint security controls and launch attacks on target devices. \nThese techniques can be difficult to detect and protect against.  \nMITIGATION S  \nApplying the following practices can help o rganizations strengthen their network defenses against \ncommon exploited weak security controls and practices . \nControl  Access  \n Adopt a zero -trust security model  that eliminates implicit trust in any one element, node, or \nservice , and instead require s continu ous verification of the operational picture via real -time \ninformation from multiple sources to determine access and other system responses. [9],[10] Zero-\ntrust architecture enables granular privilege access management and can allow users to be \nassigned only the rights required to perform their assigned tasks.  \n Limit the ability of a local administrator account  to log in from a remote  session (e.g., deny \naccess to t his computer from the network) and prevent access via an RDP session.  Additionally, \nconsider using dedicated administrative workstations for privileged user sessions to help limit \nexposure to all the threats associated with device or user compromise. See, for instance, the \nMicrosoft Security Best Practices article,  Securing devices as part of the privileged access story , \nfor more information on privileged access de ployment.  \n Control who has access to your data and services.  Give personnel access only to the data, \nrights, and systems they need to perform their job. This role -based access control, also known as \nthe principle of least priviledge, should apply to both ac counts and physical access. If a malicious \ncyber actor gains access, access control can limit the actions malicious actors can take and can \nreduce the impact of misconfigurations and user errors. Network defenders should also use this \nrole-based access con trol to limit the access of service, machine, and functional accounts, as well \nas the use of management privileges, to what is necessary. Consider the following when \nimplementing access control models:  \no Ensure that access to data and services is specificall y tailored to each user , with \neach employee having their own user account.  \no Give employees access only to the resources needed  to perform their tasks.  \no Change default passwords of equipment and systems upon installation or \ncommissioning.  \no Ensure there are processes in place for the entry, exit, and internal movement of \nemployees. Delete unused accounts, and immediately remove access to data and \nsystems from accounts of exiting employees who no longer require access. Deactivate \nservice accou nts, and activate them only when maintenance is performed .[11] \n\n \n \n \n Page 4 of 7  |  Product ID : AA22 -137A  \nTLP: WHITE    Product ID: AA22 -137A  \n \n Harden conditional access policies.  Review and optimize  VPN and access control r ules to \nmanage how users connect to the network and cloud services.  \n Verify that all machines, including cloud -based virtual machine instances do not have open \nRDP ports.  Place any system with an open RDP port behind a firewall and require users to use a \nVPN to access it through the firewall .[12] \nImplement Credential Hardening  \n Implement MFA.  In particul ar, apply MFA  on all VPN connections, external -facing services, and \nprivileged account s. Require  phishing -resistant MFA  (such as security keys or PIV cards) for \ncritical services . Where MFA is not implemented, enforce a strong password policy  alongside \nother attribute -based information , such as device information, time of access, user history , and \ngeolocation data.  See NSAs Cybe rsecurity Information on Selecting Secure Multi -factor \nAuthentication Solutions , the National Institute for Standards and Technology  (NIST) Special \nPublication 800 -63B  Digital Identity Guidelines: Authentication and Lifecycle Management , and \nCCCSs Information Technology Security Guidance  User Authentication Guidance for \nInformation Technology Systems  for additional steps to take to enable in -depth authentication \nsecurity.  \n Change or disable vendor -supplied default usernames and passwords . Enforce the use of \nstrong passwords.  (See guidance from NIST .) \n Set up monitoring to detect the use of compromised credentials on your systems. \nImplement controls to prevent the use of compromised or weak passwords on your network.   \nEstabl ish Centralized Log Management  \n Ensure that each application and system generates sufficient log information . Log files play \na key role in detecting attacks and dealing with incidents. By i mplement ing robust log collection \nand retention, organizations are able to have sufficient information to investigate incidents and \ndetect threat actor behavior . Consider the following when implementing log collection and \nretention:   \no Determine which log files are required.  These files can pertain to system logging, \nnetwork  logging, application logging, and cloud logging.  \no Set up alerts where necessary.  These should include notifications of suspicious login \nattempts based on an analysis of log files.  \no Ensure that your systems store log files in a usable file format,  and that  the recorded \ntimestamps are accurate and set to the correct time zone.  \no Forward logs off local systems to a centralized repository or security information \nand event management (SIEM) tools . Robustly protect SIEM tools with strong account \nand architectural  safeguards.  \no Make a decision regarding the retention period of log files.  If you keep log files for a \nlong time, you can refer to them to determine facts long after incidents occur. On the other \nhand, log files may contain privacy -sensitive information and  take up storage space. Limit \naccess to log files and store them in a separate network segment. An incident \n\n \n \n \n Page 5 of 7  |  Product ID : AA22 -137A  \nTLP: WHITE    Product ID: AA22 -137A  \n \ninvestigation will be nearly impossible if attackers have been able to modify or delete the \nlogfiles .[13] \nEmploy Antivirus Programs  \n Deploy an anti -malware solution  on workstations to prevent spyware, adware, and malware as \npart of the operating sy stem  security baseline.  \n Monitor antivirus scan results on a routine  basis.  \nEmploy Detection Tools and Search for Vulnerabilities  \n Implement endpoint and detection response tools.  These  tools allow a high degree of visibility \ninto the security status of endp oints and can help effectively protect against malicious cyber \nactors.  \n Employ an intrusion detection system or intrusion prevention system to protect network and \non-premises devices from malicious activity. Use signatures  to help detect malicious network \nactivity associated with known threat activity.  \n Conduct penetration testing to identify misconfigurations.  See the Additional Resou rces \nsection below for more information about CISAs free cyber hy giene services, including remote \npenetration testing.  \n Conduc t vulnerability scanning to detect and address  application vulnerabilities.   \n Use cloud service provider tools to detect overshared cloud storage and monitor for \nabnormal accesses.  \nMaintain Rigorous Configuration Management Programs  \n Always operate services exposed on internet -accessible hosts with secure configurations. \nNever enable external access without compensating control s such a s boundary firewalls and \nsegmen tation from other more secure and internal hosts like domain controller s. Continuously \nassess the business and mission need  of internet -facing services . Follow best practices for \nsecurity configurations,  especially blocking macros in documents from the internet .[14] \nInitiate a Software and Patch Management Program   \n Implement asset and patch management processes  to keep software up to date. Identify and \nmitigate unsupported, end -of-life, and unpatched software and firmware by performing \nvulnerability scanning and patching activities.  Prioritize patching known exploited vulnerabilities . \nADDITIONAL RESOURCES  \n NCSC -UK Guidance  Phishing Attacks: Defending Your Organisation  \nOpen Web Application Security Project  Resources  \n Open Web Application Security Project (OWASP ) Proactive Controls: Enforce Access \nControls  \n\n \n \n \n Page 6 of 7  |  Product ID : AA22 -137A  \nTLP: WHITE    Product ID: AA22 -137A  \n \n OWASP Application Security Verification Standard: V4 Access Control  \n OWASP Testing Guide: Authorization Testing  \nREFERENCES  \n[1] United States Cybersecurity and Infrastructure Security Agency  \n[2] United States Federal Bureau of Investigation  \n[3] United States National Security Agency  \n[4] Canadian Centre for Cyber Security  \n[5] New Zealand National Cyber Security Centre  \n[6] New Zealand CERT NZ  \n[7] Netherlands Natio nal Cyber Security Centre  \n[8] United Kingdom National Cyber Security Centre  \n[9] White House Executive Order on Improving the Nations Cybersecurity  \n[10] NCSC -NL Factsheet: Prepare for Zero Trust  \n[11] N CSC -NL Gui de to Cyber Security Measures  \n[12] N-able Blog: Intrusion Detection System (IDS): Signature vs. Anomaly -Based  \n[13] NCSC -NL Guide to Cyber Security Measures  \n[14] National Institute of Standards and Technology SP 800 -123  Keeping Servers Secured  \n  \nCONTACT  \nU.S. organizations:  To report incidents and anomalous activity or to request incident response \nresources or technical assistance related to these threats, contact CISA at  report @cisa.gov . To report \ncriminal activity related to information found in this advisory, contact your local FBI field office at \nwww.fbi.gov/contact -us/field , or th e FBIs 24/7 Cyber Watch at 855 -292-3937 or by email at \nCyWatch@fbi.gov . For NSA client requirements or general cybersecurity inquiries, contact \nCybersecurity_Requ ests@nsa.gov .  \nCanadian organizations : report incidents by emailing CCCS at contact@cyber.gc.ca .  \nNew Zealand organizations:  report cyber security incidents to incidents@ncsc.govt.nz  or call 04 498 \n7654.  \nThe Netherlands organizations: report incidents to cert@ncsc.nl .  \nUnited Kingdom organizations:  report a significant cyber security incident: ncsc.gov.uk/report -an-\nincident  (monitored 24 hours) or, for urgent assistance, call 03000 200 973.  \n \n\n \n \n \n Page 7 of 7  |  Product ID : AA22 -137A  \nTLP: WHITE    Product ID: AA22 -137A  \n \nCAVEATS  \nThe information you have accessed or received is being provided as is for informational purposes \nonly. CISA, the FBI, NSA, CCCS, NCSC -NZ, CERT -NZ, NCSC -NL, and NCSC -UK do not endorse \nany commercial product or service, including any subjects of analysis. Any reference to specific \ncommercial products, processes, or services by service mark, trademark, manuf acturer, or otherwise, \ndoes not constitute or imply their endorsement, recommendation, or favoring by CISA, the FBI, NSA, \nCCCS, NCSC -NZ, CERT -NZ, NCSC -NL, or NCSC -UK.  \nPURPOSE  \nThis document was developed by CISA, the FBI, NSA, CCCS, NCSC -NZ, CERT -NZ, NCSC -NL, and \nNCSC -UK in furtherance of their respective cybersecurity missions, including their responsibilities to \ndevelop and issue cybersecurity specifications and mitigations. This information may be shared \nbroadly to reach all appropriate stakeholders. The  United States NSA agrees with this attribution and \nthe details provided in this report.  \n \n \n\n",
  "cves": [],
  "techniques": [
    "T1078",
    "T1566",
    "T1190",
    "T1133",
    "T1199"
  ],
  "advisory": "cybersecurity-alerts",
  "title": "csa_weak_security_controls_practices_exploited_for_initial_access",
  "source": "nsa",
  "id": "cba448118e4aba15efc7981b85ecc52966d2a4c15a088955b858385ac2828478"
}