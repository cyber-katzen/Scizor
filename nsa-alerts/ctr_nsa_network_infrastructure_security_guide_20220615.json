{
  "markdown": " \n \n \n \nNational Security Agency  \nCybersecurity  Technical Report  \n \n \n \n \n \nNetwork Infrastructure  \nSecurity Guide  \n \n \n \n \n \n \n \nOctober  2023 \n \nU/OO/118623 -22 \nPP-22-0293 \nVersion 1. 2 \n \n \n \n \n  \n\n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  ii \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nNotices and history   \nDocument change history  \nDate  Version  Description  \nOctober 2023  1.2 Updated lin ks to r eferences  \nJune 2022  1.1 Minor clarifications and additional vendor links  \nMarch  2022  1.0 Report  released  \n \nDisclaimer of warranties and endorsement  \nThe information and opinions containe d in this document are provided as is  and without any warranties \nor guarantees. Reference herein to any specific commercial products, process, or service by trade name, \ntrademark, manufacturer, or otherwise, does not necessarily constitute or imply its endorsement, \nrecommendation, or favoring by the United States Government, and this guide  shall not be used for \nadvertising or product endorsement purposes.  \nTrademark recognition  \nCisco and Cisco IOS are registered trademarks of Cisco Systems, Inc.  \nPublication information  \nAuthor(s)   \nNational Security Agency  \nCybersecurity Directorate  \nContact information  \nClient Requirements / General Cybersecurity Inquiries:  \nCybersecurity Requirements Center, 410 -854-4200, Cybersecurity_Requests@nsa.gov  \n \nMedia inquiries / Press Desk:  \nMedia Relations, 443-634-0721, MediaRelations@nsa.gov   \n \nDefense Industrial Base Inquiries for Cybersecurity Services:  \nDIB Cybersecurity Program , DIB_Defense@cyber.nsa.gov   \nPurpose  \nThis document was developed in furtherance of NSAs cybersecurity missions . This  includ es its \nresponsibilities to identify and disseminate threats to National Security System s, Department of Defense \ninformation systems, and the Defense Industrial Base, and to develop and issue cybersecurity \nspecifications and mitigations. This information may be shared broadly to reach all appropriate \nstakeholders.   \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  iii \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nContents  \nNetwork Infrastructure Security Guide ................................ ................................ .............. i \nContents  ................................ ................................ ................................ ................................ ......iii \n1. Introduction  ................................ ................................ ................................ ...............................  1 \n1.1 Re garding Zero Trust  ................................ ................................ ................................ ................................ ........ 1 \n2. Network architecture and design  ................................ ................................ ............................  2 \n2.1 Install perimeter and internal defense devices  ................................ ................................ .......................  2 \n2.2 Group similar network systems  ................................ ................................ ................................ .....................  3 \n2.3 Remove backdoor connections  ................................ ................................ ................................ ....................  4 \n2.4 Utilize strict perimeter access controls  ................................ ................................ ................................ ...... 4 \n2.5 Implement a network access control (NAC) solution  ................................ ................................ ...........  5 \n2.6 Limit virtual private networks (VPNs)  ................................ ................................ ................................ ......... 5 \n3. Security maintenance ................................ ................................ ................................ ...............  8 \n3.1 Verify software and configuration integrity  ................................ ................................ ...............................  8 \n3.2 Maintain proper file system and boot management  ................................ ................................ .............  9 \n3.3 Maintain up -to-date software and operating systems  ................................ ................................ ........ 10 \n3.4 Stay current with vendor -supported hardware  ................................ ................................ ......................  11 \n4. Authentication, authorization, and accounting (AAA)  ................................ .......................  12 \n4.1 Implement centralized servers  ................................ ................................ ................................ ....................  12 \n4.2 Configure authentication  ................................ ................................ ................................ ................................  13 \n4.3 Configure authorization  ................................ ................................ ................................ ................................ .. 14 \n4.4 Configure accounting  ................................ ................................ ................................ ................................ ...... 15 \n4.5 Apply principle of least privilege  ................................ ................................ ................................ .................  15 \n4.6 Limit authentication attempts  ................................ ................................ ................................ .......................  17 \n5. Local administrator accounts and passwords  ................................ ................................ .... 17 \n5.1 Use unique usernames and account settings  ................................ ................................ .......................  18 \n5.2 Change default passwords  ................................ ................................ ................................ ...........................  19 \n5.3 Remove unnecessary accounts  ................................ ................................ ................................ .................  19 \n5.4 Store passwords with secure algorithms  ................................ ................................ ................................  19 \n5.5 Create strong passwords  ................................ ................................ ................................ ..............................  21 \n5.6 Utilize unique passwords  ................................ ................................ ................................ ...............................  23 \n5.7 Change passwords as needed  ................................ ................................ ................................ ...................  23 \n6. Remote logging and monitoring  ................................ ................................ ...........................  24 \n6.1 Enable logging  ................................ ................................ ................................ ................................ ...................  25 \n6.2 Establ ish centralized remote log servers  ................................ ................................ ................................  25 \n6.3 Capture necessary log information  ................................ ................................ ................................ ............  26 \n6.4 Synchronize clocks  ................................ ................................ ................................ ................................ ..........  27 \n7. Rem ote administration and network services  ................................ ................................ .... 28 \n7.1 Disable clear text administration services  ................................ ................................ ..............................  28 \n7.2 Ensure adequate encryption strength  ................................ ................................ ................................ ...... 30 \n7.3 Utilize secure protocols  ................................ ................................ ................................ ................................ .. 31 \n7.4 Limit access to services  ................................ ................................ ................................ ................................ . 31 \n7.5 Set an acceptable timeout period  ................................ ................................ ................................ ..............  32 \n7.6 Enable Transmission Control Protocol (TCP) keep -alive ................................ ................................ . 33 \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  iv \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \n7.7 Disable outbound connections  ................................ ................................ ................................ ....................  33 \n7.8 Remove SNMP read -write community strings  ................................ ................................ ......................  34 \n7.9 Disable unnecessary network services  ................................ ................................ ................................ ... 35 \n7.10 Disable discovery protocols on specific interfaces  ................................ ................................ ...........  36 \n7.11 Configure remote network administration services  ................................ ................................ ..........  36 \n7.11.1 Configuring SSH for remote administ ration  ................................ ................................ ................  36 \n7.11.2 Configuring HTTP for remote administration  ................................ ................................ ..............  39 \n7.11.3 Configuring SNMP for remote administration  ................................ ................................ ............  40 \n8. Routing  ................................ ................................ ................................ ................................ ..... 40 \n8.1 Disable IP source routing  ................................ ................................ ................................ ..............................  41 \n8.2 Enable unicast reverse -path forwarding (uRPF) ................................ ................................ ..................  41 \n8.3 Enable routing authentication  ................................ ................................ ................................ ......................  42 \n9. Interface ports  ................................ ................................ ................................ .........................  43 \n9.1 Disable dynamic trunking  ................................ ................................ ................................ ..............................  43 \n9.2 Enable port security  ................................ ................................ ................................ ................................ ......... 44 \n9.3 Disable default VLAN  ................................ ................................ ................................ ................................ ...... 45 \n9.4 Disable unused ports  ................................ ................................ ................................ ................................ ...... 47 \n9.5 Disable port monitoring  ................................ ................................ ................................ ................................ .. 48 \n9.6 Disable proxy Address Resolution Protocol (ARP)  ................................ ................................ .............  49 \n10. Notification and consent banners  ................................ ................................ ......................  50 \n10.1 Present a notification banner  ................................ ................................ ................................ ....................  50 \n11. Conclusion  ................................ ................................ ................................ ............................  51 \nAbbreviations  ................................ ................................ ................................ ..............................  52 \nReferences  ................................ ................................ ................................ ................................ ... 54 \nWorks cited  ................................ ................................ ................................ ................................ ................................ . 54 \nRelated guidance  ................................ ................................ ................................ ................................ .....................  56 \n \n \nFigure 1: Network perimeter with firewalls and a DMZ ................................ ................................ ....................  3 \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  1 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \n1. Introduction  \nGuidance for securing networks continues to evolve as adversaries exploit new \nvulnerabilities , new security features are implemented, and new methods of securing \ndevices are identified. Improper configurations, \nincorrect handling of configurations, and weak \nencryption keys can expose vulnerabilities in the \nentire network. All networ ks are at risk of \ncompromise, especially if devices are not \nproperly configured and maintained. An \nadministrators role is critical to securing the \nnetw ork against adversarial techniques  and requires dedicated people to secure the \ndevices, applications, an d information on the network.  \nThis report presents  best practice s for overall network security and protection of \nindividual network devices . It will assist administrators in preventing an adversary from \nexploiting their network. While the  guidance presented here  can be applied to many  \ntypes of network devices, the National Security Agency ( NSA) has provided sample \ncommands for Cisco Internetwork Operating System (IOS) devices . These commands \ncan be executed to implement recommended mitigations.  \n1.1 Regarding Zero Trust \nZero Trust is a security model, a set of system design principles, and a coordinated \ncybersecurity and system management strategy based on an acknowledgement that \nthreats exist both inside and outside traditional network boundaries. NS A fully supports \nthe Zero Trust security model, and much of the guidance in this report can be applied at \ndifferent boundaries as recommended in Zero Trust guidance. However, this report \nprovides guidance to mitigate common vulnerabilities and weaknesses o n existing \nnetworks. As system owners introduce new network designs intended to achieve more \nmature Zero Trust principles, this guid e may need to be modified.  An administrators \nrole is critical in \nsecuring networks . \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  2 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \n2. Network architecture and d esign  \nA secure network design that implements \nmultiple defensive layers is critical to defend \nagainst threats and protect resources within \nthe network. The design should follow \nsecurity best practices and model Zero Trust \nprinciples, both for network perimeter and \ninternal devices.  \n2.1 Install p erimeter and i nternal defense devices  \nA network requires a substantial defensive strategy to protect individual components \nand the information they contain. Multiple layers of defense should be implemented at \nthe networks perimeter to protect against external threats, and to monitor and restrict \ninbound and outbound traffic.  \nNSA recommends configuring and installing security devices at the perimeter of the \nnetwork according to security best practices:  \n Install a border router to facilitate a connection to the external network, such as \nan Internet service provider (ISP).  \n Implement multiple layers of next -generation firewalls throughout  the network to \nrestrict inbound traffic, restrict outbound traffic, and examin e all internal activity  \nbetween disparate network regions . Each layer should utilize different vendors to \nprotect against an adversary exploiting the same unpatched vulnerability in an \nattempt to access the internal network.  \n Place publicly accessible syste ms and outbound proxies in between the firewall \nlayers in one or more demilitarized zone (DMZ) subnets, where access can be \nappropriately controlled between external  devices , DMZ devices, and internal \nsystems . \n Implement a network monitoring solution to log  and track inbound and outbound \ntraffic, such as a network intrusion detection system (NIDS), a traffic inspector, or \na full -packet capture device.  \n Deploy multiple dedicated remote log servers to enable activity correlation \namong devices and detection of l ateral movement.  \n Implement redundant devices in core areas to ensure availability, which can be \nload-balanced to increase network throughput and decrease latency.  Apply multiple layers \nof defense for a more \nsecure network design.  \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  3 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \n \n \nFigure 1: Network perimeter with firewalls and a DMZ  \n2.2 Group  similar n etwork systems  \nSimilar systems within a network should be logically grouped together to protect against \nadversarial lateral movement from other types of systems . Adversaries will target \nsystems that are easier to exploit , such as printers, and us e that initial access to further \npropagate to other systems on the network. Proper network segmentation  significantly \nreduces the ability for an adversary to reach and exploit these other systems  (see \nCybersecurity and Infrastructure Security Agencys ( CISAs) Layering Network Security \nThrough Segmentation  and NSAs Segment Networks and Deploy Application -aware \nDefenses ) [1], [2]. Additionally, access restrictions between different types of system s \nare easier to manage, control, and monitor if they are logically grouped together.  \nNSA recommends isolating similar systems into different subnets or virtual local area \nnetworks (VLANs), or physically separating the different subnets via firewalls  or filtering \nrouters . Workstations, servers, printers, telecommunication systems, and other network \nperipherals should be separate from each other. Operational technology , such as \nindustrial control systems , typically need to be isolated from other inform ation \ntechnology  and high -risk networks like the Internet.  This physical separation provides \nstronger protection because the intermediate device between subnets must be \ncompromised for an adversary to bypass access restrictions. Implement access \n\n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  4 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nrestrictio ns on the internal routers, switches, or firewalls to allow only those ports and \nprotocols that are required for network operations or valid mission need. Access control \nlists (ACLs) may need to be duplicated and applied directly to the switches to restric t \naccess between VLANs, or they can be applied to core routers where routing is \nperformed between internal subnets.  \n2.3 Remove backdoor c onnections  \nA backdoor network connection is between two or more devices located in different \nnetwork areas, generally w ith different types of data and security requirements . If one \ndevice is compromised, an adversary can use this connection to bypass access \nrestrictions and gain access to other areas of the network. An example of a backdoor \nnetwork connection is an externa l border router connected to an ISP that is also directly \nconnected to the internal or management subnets . An adversary that can compromise \nthis external border router would likely have access to the internal network, bypassing \nall firewalls.  \nNSA recommend s removing all backdoor network connections and using caution when \nconnecting devices with more than one network interface. Verify that all network \ninterfaces of a device are at similar security levels , or that an intermediate device \nprovides both logical and physical separation between different network areas.  \n2.4 Utilize s trict perimeter access c ontrols  \nNetwork perimeter devices are essential elements in a security model and should be \nconfigured to complement each other by implementing ACLs to regulate in gress and \negress of network traffic. These access control rulesets should be configured to \nexplicitly allow only services and systems that are required to support the mission of the \nnetwork.  \nNSA recommends a deny -by-default, permit -by-exception approach achieved by  \ncarefully considering which connections to allow, and then creating rulesets that focus \non permitting only the allowed  connections . This method allows a single  rule to deny \nseveral types of connections, instead of needing to create a separate rul e for each \nblocked connection. Failure to use a deny -by-default, permit -by-exception approach can \npermit unnecessary access and increase the risk of compromise  and information \ngathering.  If it is necessary to dynamically apply additional perimeter rulesets to prevent \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  5 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nan adversary from  completi ng or continu ing an exploit , NSA recommends the use of an \nintrusion prevention system (IPS).  \nNSA also recommends enabling logging, at a minimum, on all rulesets that de ny or drop \nnetwork traffic . Logging should also be enabled on successful and unsuccessful \nadministrator access to critical devices.  \n2.5 Implement a network access control  (NAC)  solution  \nAn adversary who wishes to gain internal access to a network must eith er find a way \nthrough the external perimeter of the network or obtain access from inside the network. \nA NAC  solution prevents unauthorized physical connections and monitors authorized \nphysical connections on a network.  \nNSA recommends implementing a NAC sol ution that identifies and authenticates unique \ndevices connected to the network. Port security is a mechanism that can be \nimplemented on switches to detect when unauthorized devices are connected  to the \nnetwork via a devices media access c ontrol (MAC) add ress.  \nHowever, port security can be difficult to manage . For example, it increases the number \nof support tickets due to valid blocked network ports (e.g., connected devices that \nchange often, such as conference rooms) . In addition, adversaries who can spoo f a \nMAC address can bypass it  as well.  A more robust  solution utilizes  802.1X, which \nauthenticates devices based on a trusted digital certificate installed on the device. While \nit is more complex  to implement, due to the use of certificates, it is easier t o manage \nthan port security  and offers a higher level of assurance . \n2.6 Limit virtual private n etworks (VPNs)  \nA VPN tunnel can be established between two endpoints to provide an encrypted \ncommunication channel over a network . It should only be used when the confidentiality \nand integrity of the traffic cannot be maintained through other methods . VPN gateways \nare typically accessible from the Internet and are prone to network scanning, brute force \nattempt s, and zero -day vulnerabilities. To mitigate many of these vulnerabilities, disable \nall unnecessary features on the VPN gateways and implement strict traffic filtering rules \n[2]. \nNSA recommends limiting VPN gateway acc ess to User Datagram Protocol (UDP) \nport 500, UDP port  4500, Encapsulating Security Payload (ESP), and other appropriate \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  6 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nports as needed. When possible, limit accepted traffic to known VPN peer Internet \nProtocol (IP) addresses. Remote access VPNs cannot be  added to a static filtering rule \nif the remote peer IP address is unknown. If traffic cannot be filtered to specific IP \naddresses, use an IPS in front of the VPN gateway to monitor for malformed IP Security \n(IPsec) traffic and inspect IPsec session negoti ations  [3]. \nAll IP sec VPN configurations require an IPsec policy and an Internet Key Exchange \n(IKE) policy. These policies determine how it will negotiate each phas e when \nestablishing the IPsec tunnel. If either phase is configured to allow weak cryptography, \nthe entire VPN may be at risk and data confidentiality will be lost. Each IKE policy \nincludes at least three key components:  \n1. Diffie -Hellman algorithm/group  \n2. Encryption algorithm  \n3. Hashing algorithm  \nThe following are the minimum recommended settings per Committee on National \nSecu rity Systems Policy (CNSSP) 15 : \n Diffie -Hellman Group: 16 with 4096 bit Modular Exponent (MODP)  \n Diffie -Hellman Group: 20 with 384 bit elliptic  curve group (ECP)  \n Encryption: Advanced Encryption Standard (AES)-256 \n Hash: S ecure Hash Algorithm (SHA) -384 \nDiffie -Hellman Group 15 is also acceptable  based on the minimum requirements of \nCNSS P 15, but Group 15 is not recommended due to interoperability issues that have \nbeen observed . \nWhen establishing a VPN proposal, policy, or transform -set, ensure it follows CNSSP  \n15 recommendations  [4]. The CNSSP  15 requirements are explained in the draft \nInternet Engineering Task Force (IETF)  document on Commercial National Security \nAlgorithm (CNSA) Suite Cryptography for Internet Protocol Security (IPsec)  [5]. \nTo ensure they are not inadvertently used, disable the default polices and  proposals for \nInternet Security Association and Ke y Management Protocol (ISAKMP) and IKEv2 with \nthe following configuration commands:  \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  7 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nno crypto isakmp default policy  \nno crypto ikev2 policy default  \nno crypto ikev2 proposal default  \nno crypto ipsec transform -set default  \nNote : If the default policies are disa bled, only the explicitly configured policies will be \nused . \nEstablish an IKEv2 proposal, policy, and profile with the following example configuration \ncommands:  \ncrypto ikev2 proposal <IKEV2_PROPOSAL_NAME>  \nencryption aes -gcm-256 \ngroup [16|20]  \ncrypto i kev2 policy <IKEV2_POLICY_NAME>  \nproposal <IKEV2_PROPOSAL_NAME>  \ncrypto ike v2 profile <IKEV2_PROFILE_NAME>  \nmatch identity remote ...  \nauthentication remote ...  \nauthentication local ...  \nThe configuration of the profile will depend on the network it is configured for, and must \nhave local and remote authentication methods and a match  statement. A separate \nkeyring can also be established and applied to the profil e for multiple pre -shared key s. \nEstablish an IPsec transform -set with the following example configuration commands:  \ncrypto ipsec transform -set <IPSEC_TRANSFORM_NAME>  esp-gcm 256 \nmode tunnel  \nEstablish an IPsec profile, which utilizes the IKEv2 profile and IPsec transform -set \ndefined ab ove, with the following example configuration commands:  \ncrypto ipsec profile <IPSEC_PROFILE_NAME>  \nset transform -set <IPSEC_TRANSFORM_NAME>  \nset pfs group16  \nset ikev2 -profile <IKEV2_PROFILE_NAME>  \nThe IPsec profile should be applied to the tunnel interface wi th the following \nconfiguration commands:  \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  8 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \ninterface <TUNNEL_INTERFACE_NAME>  \ntunnel protection ipsec profile <IPSEC_PROFILE_NAME>  \nno shutdown  \nFor more information , refer to  Configuring IPsec Virtual Private Networks , Mitigating \nRecent VPN Vulnerabilities , and Eliminating Obsolete Transport Layer Security (TLS) \nProtocol Configurations  [6], [7], [8]. \nReturn to Contents  \n3. Security maintenance  \nOutdated hardware and software may contain publicly known vulnerabilities and provide \nan easy mechanism for adversaries to exploit the network. These vulnerabilities are \nmitigated by regularly upgrading the hardware and software to newer versions that are \nsupported by the vendor. Additionally, the \nintegrity of downloaded software should be \nverified before and during use . Security  \nmaintenance should be performed on a \nregular basis to ensure devices continue to \noperate securely . \n3.1 Verify software and configuration i ntegrity  \nAn adversary can introduce malicious software into network devices by modifying \noperating system files, the executable code running in memory, or the firmware or \nbootloader that loads the operating system  of a n etwork device . Software that has been \nmaliciously modified on a network device can be used by an adversary to violate data \nintegrity, exfiltrate sensitive information, and cause a  denial of service (DoS).  \nNSA recommends verifying the integrity of operating  system files installed and running \non devices by comparing the cryptographic hash of the file with the known good hash \npublished by the vendor. When upgrading operating system files, perform the same \nintegrity verification on the files prior to and after installation to ensure no modifications \nwere made. A basic online hash can be computed on an operating system image file \nwith the following exec command:  \nverify / sha512 <PATH:filename>  Upgrade hardware and \nsoftware to ensur e \nefficiency and security.  \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  9 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nOlder devices may only support a  Message Digest 5 ( MD5 ) hash, which can  be \ncomputed with the following exec command:  \nverify /md5 <PATH:filename>  \nThe computed  hash can be compared with the information published for the file on the \nSupport page s of https ://www.cisco.com/  [12]. More information on network device \nverification is available in the Network Device Integrity (NDI) Methodology , Network \nDevice Integrity (NDI) on Cisco IOS Devices , and Validate Integrity of Hardware and \nSoftware  documents  [30], [31], [32]. \nRather than performing these more complex software modification s, an adversary may \nchoose to simply change the configuration. Configuration changes can be a sign that a \ndevice has been compromised.  \nNSA also recommends implementing a configuration change control process that \nsecurely creates device configuration backup s to detect unauthorized  modifications. \nWhen a configuration change is needed, document the change and include the \nauthorization, purpose, and mission justification. Periodically verify that modifications \nhave not been applied by comparing current device c onfigurations with the most recent \nbackups. If suspicious changes are observed, verify the change was authorized.  \n3.2 Maintain proper file system and boot m anagement  \nMany network devices have at least two different configurations, one or more saved in \npersistent storage and an active copy running in memory.  Permanent changes to the \nconfiguration should be saved or committed to prevent configuration inconsistencies if \nthe device is rebooted or loses power. Configuration changes can be saved on a device \nwith the following exec command:  \ncopy running -config startup -config \nIf changes are meant to be temporary, NSA recommends inserting comments before \nthe updated configuration lines to include why it was made and when it can be removed, \nand removing the comments a nd temporary changes at the appropriate time. If the \ndevice  does not support comments, insert comments in a backup  copy of the \nconfiguration to compare with the version on the device.   \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  10 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nUse an encrypted protocol when copying configurations  remotely , such as Secure File \nTransfer Protocol (SFTP) or Secure Copy Protocol (SCP).  The copy  mechanism used to \nbackup or archive configurations , and the backup  repository , must be protected from \nunauthorized access . \nNSA also recommends checking for unused or unn ecessary files on each device and \nremoving them with the following exec commands:  \ndir /recursive all-filesystems  \ndelete <PATH:filename>  \nOlder operating system files or outdated backup configuration files stored on the device \nare most likely unnecessary, and should be removed.  Storing multiple versions of \nsoftware provides an adversary the opportunity to reload outdated software and \nreintroduce vulnerabilities  patched  in newer versions of the operating system . \n3.3 Maintain up-to-date software  and operating  systems  \nMaintaining up -to-date operating systems and stable software protects against critical \nvulnerabilities and security issues that have been identified and fixed in newer releases. \nDevices running outdated operating systems or vulnerable software are  susceptible to a \nvariety of published vulnerabilities, and exploiting these devices is a common technique \nused by adversaries to compromise a network.  \nNSA recommends upgrading operating systems and software on all devices to the \nlatest stable version avai lable from the vendor. Upgrading the operating system may \nrequire additional hardware or memory upgrades, and obtaining a new software version \nmay require a maintenance or support contract with the vendor. Some network \ninfrastructure device s may not suppor t an auto-update feature , so it may be necessary \nto implement a requisition and installation process to obtain  the latest software from the \nvendor.  \nPlease see the support page for the corresponding vendor in  Table I: Vendor support \npages  to determine the latest operating system for a particular device.  \nTable I: Vendor support p ages  \nVendor  URL \nArista  Networks  https://www.arista.com/en/support/  [9] \nAruba  Networks  https://www.arubanetworks.com/support -services/  [10] \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  11 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nVendor  URL \nBroadcom  https://www.broadcom.com/support  [11] \nCisco  System s https://www.cisco.com/c/en/us/support/index.html  [12] \nDell https://www.dell.com/support/home/en -us/ [13] \nExtreme Networks  https://www.extremenetworks.com/support/  [14] \nF5 https://www.f5.com/services/support  [15] \nFortinet  https://www.fortinet.com/support  [16] \nHewlett Packard Enterprise (HPE)  https://www.hpe.com/us/en/services.html  [17] \nInternational Business Machines  (IBM)  https://www.ibm.com/mysupport/  [18] \nJuniper  Networks  https://support.juniper.net/support/  [19] \nLinksys  https://www.linksys.com/us/support/  [20] \nNETGEAR  https://www.netgear.com/support/  [21] \nPalo Alto  Networks  https://support.paloaltonetworks.com/support/  [22] \nRiverbed Technology  https://support.riverbed.com/  [23] \nRuckus  Networks  https://support.ruckuswireless.com/  [24] \nSonicWall  https://www.sonicwall.com/support/  [25] \nTRENDnet  https://www.trendnet.com/support/  [26] \nTripp Lite  https://www.tripplite.com/support/  [27] \nUbiquiti  https://help.ui.com/hc/en -us/ [28] \nWatchGuard  https://www.watchguard.com/wgrd -support/overview  [29] \n3.4 Stay current with vendor -supported h ardware  \nVendors eventually stop supporting specific hardware platforms and, if a failure occurs, \nthese end -of-life devices cannot be serviced. In addition to device instability and \nmemory requirement concerns, there is an increased risk of an adversary exploiting the \ndevice  due to a lack of software updates to fix known vulnerabilities . Newer, vendor -\nsupported hardware platforms have improved  security features, including protection \nfrom known vulnerabilities.  \nOnce a vendor publishes an end -of-life notice or announces that a device will no longer \nbe supported, NSA recommends constructing a plan to upgrade or replace affected \ndevices with newer equipment, according to vendor recommendati ons. Outdated or \nunsupported devices should be immediately upgraded or replaced to ensure the \navailability of network services and security support.  \nPlease see the support page for the corresponding vendor in  Table I: Vendor support \npages  to determine if a particular device is supported by the vendor.  \nReturn to Contents  \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  12 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \n4. Authentication, authorization , and accounting (AAA)  \nCentralized AAA servers provide a consolidated mechanism to manage administrative \naccess to devices, and the accounts created are more challenging for an adversary to \ncompromise since credentials ar e not stored directly on devices. Properly configuring \nthese servers provides an authoritative source for managing and monitoring access, \nimproves consistency of access control, \nreduces configuration maintenance, and \nreduces administrative costs. All devic es \nshould first be configured to use modern \nAAA services with the following \nconfiguration example command  for Cisco \nIOS devices : \naaa new-model \nApplying the above configuration ensures a device will not use legacy authentication \nand authorization methods.  \n4.1 Implement centralized s ervers  \nAll devices should be configured to use centralized AAA servers. NSA recommends \nimplementing at least two AAA servers to ensure availability, and assist with detecting  \nand preventing adversary activities. If one server bec omes unavailable due to \nscheduled maintenance or for other reasons, the remaining servers will continue \nproviding the centralized AAA services. The servers should be : \n Configured to authenticate devices with a unique and complex pre -shared key to \nensure onl y authorized devices can use the AAA services  (see 5.5 Create strong \npasswords ). \n Configured to use the same protocol (e.g., TACACS+, RADIUS, or LDAP) for \nconsistency , and use encrypted transport  when supported (e.g., R adSec, \nDiameter, LDAPS, or IPsec encapsulated) . \n Synchronized with each other to ensure consistency of user credentials and \naccess controls . \nA server group with multiple AAA servers can be configured with the following \nconfiguration commands:  Control access and \nreduce maintenance \nthrough use of AAA.  \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  13 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \naaa group serv er {tacacs+ | radius | ldap} <GROUP_NAME> \nserver-private <IP_ADDRESS_1> key <KEY_1> \nserver-private <IP_ADDRESS_ 2> key <KEY_2> \nSome older devices may utilize the keywords tacacs-server  and radius-server  in the \nconfiguration, which prevents assigning a unique key to each server.  \nNSA recommends replacing these lines with the above configuration format, and \nassigning a unique pre -shared key to each server. If an adversary obtains the pre -\nshared key to one s erver , the key needs to be revoked , but other servers with different \nkeys can continue to be used by the devices.  \n4.2 Configure authentication  \nAuthentication verifies the identity of a person or entity . All devices should be configured \nto use centralized s ervers for AAA services first, and local administrator accounts as a \nbackup method only if all the centralized servers are unavailable. The same applies to \nprivileged level authentication; devices shoul d only use the local privileged -level \npassword if all centralized servers are unavailable. This order of precedence will \nprevent an adversary, who obtains local administrator account credentials, from logging \ninto the devices since access will usually be controlled  by the AAA servers.  \nNSA recommends configuri ng centralized authentication for login  and enable  \n(privileged) access as the primary method, as shown in the following configuration \ncommands:  \naaa authentication login default group <GROUP_NAME> local \naaa authentication enable default group <GROUP_NAME> enable \nUsing the default  keyword ensures the configuration is applied  globally in all instances \nwhen an explicit authentication list is not specified . If a custom named list is used \ninstead, it would be necessary to explicitly apply this list to all instances where  AAA is \nused and potentially leave some management services incorrectly configured and open \nto compromise . The default  list is always applied when a custom named list is not \nexplicitly applied.  \nThe <GROUP_NAME>  should be the custom name of t he AAA server group (defined \npreviously) that includes the IP addresses of the centralized AAA servers and their \nassociated keys.  \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  14 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nThe line keyword should not be used as these passwords are not securely stored in \nthe configuration and do not provide account ability.  \nThe none keyword should never be used since it disables authentication.  \n4.3 Configure authorization  \nAuthorization validates that a person or entity  has permission to access a specific \nresource or perform a specific action. The organization, situat ion, and the device s \npurpose will dictate authorized administrator commands. At the least, authorization \nshould be applied to starting an exec session (shell) and execution of other shell \ncommands, including configuration commands.  Authorization should al so be explicitly \napplied to the console, as it may not be automatically applied  by default . \nNSA recommends adequately restricting what legitimate administrators are authorized \nto execute to prevent an adversary from performing unauthorized actions with a \ncompromised account. Most administrators use privilege level 1 for user level access \nand privilege level 15 for privileged level access.  \nAuthorization should be applied to both of these levels and any other privilege levels \nused by administrators with the following configuration commands:  \naaa authorization console  \naaa authorization exec default group <GROUP_NAME> local \naaa authorization commands 1 group <GROUP_NAME> local \naaa authorization commands 15 group <GROUP_NAME> local \naaa authorization config-commands  \nThe default  list should be used to ensure the configuration is applied everywhere.  \nThe <GROUP_NAME>  should be the custom name of the AAA server group (defined \npreviously) that includes the IP addresses of the centralized AAA servers and the ir \nassociated keys.  \nIf desired, the if-authenticated  keyword can be applied after the local  keyword. If an \nadministrator is successfully logged in and all the centralized AAA servers become \nunavailable, the administrator  will no longer be authorized to exe cute commands. The \nif-authenticated keyword ensures an authenticated user will continue to be \nauthorized to execute commands. However, be cautious with this keyword as it could \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  15 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \npotentially give an administrator access beyond what is configured on the centr alized \nAAA servers.  \nThe none keyword should never be used since it disables authorization.  \n4.4 Configure accounting  \nAccounting keeps records of all relevant resources accessed or actions performed, \nholding administrators accountable. Waiting until an event  is stopped to generate an \naccounting record is insufficient, as a particular action could take an unreasonable \namount of time to complete before the record is generated. Accounting records can be \ncollected for several other event types, but it depends on the organization and purpose \nof devices.  \nNSA recommends that system configuration changes be centrally recorded, and a \nprocess implemented to periodically review these records to detect potential malicious \nactivities. At a minimum, accounting records shoul d be collected when an exec session \n(shell) is started and stopped, and when shell commands are started and stopped. \nSimilar to authorization, accounting of commands  must be applied to all administrator  \nprivilege levels with the following configuration com mands:  \naaa accounting exec default start -stop group <GROUP_NAME> \naaa accounting commands 1 default start -stop group <GROUP_NAME> \naaa accounting commands 15 default start -stop group <GROUP_NAME> \nThe default  list should be used to ensure the configuration is applied everywhere.  \nThe <GROUP_NAME>  should be the custom name of the AAA server group (defined \npreviously) that includes the IP addresses of the centralized AAA servers and their \nassociated keys.  \n4.5 Apply principle of  least p rivilege \nLeast privilege is a security concept that authorizes access to a person or entity  at the \nlowest privilege level necessary to perform authorized tasks. Many common tasks do \nnot require privileged level access, such as vie wing status of network interfaces or \nreviewing routing tables. To implement least privilege, administrators should initially log  \nin with the lowest privilege level necessary. This provides an additional layer of security \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  16 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nthat an adversary must ci rcumvent t o fully compromise a device . It also  prevents \nadministrators from inadvertently making configuration changes to a device.  \nNSA recommends that all accounts be configured with privilege level 1 or 0, and require \nadministrators to enter additional credentials  to elevate to a higher privilege level to \nperform required tasks. Privilege levels should be periodically reviewed, and \nunnecessary accesses removed to prevent inadvertent use of privileged level \ncommands at lower privilege levels.  \nThe privilege level of individual local accounts can be changed with the privilege  \nkeyword. Assign local accounts to privilege level 1 with the following configuration \ncommand:  \nusername <USER_NAME> privilege 1  \nNote : This does not change the account password.  \nAll administrator ac counts logging in at privilege level 1 will be required to execute the \nenable  command and provide additional credentials to elevate to a higher privilege \nlevel. In addition to reviewing all local administrator accounts and ensuring they are \nassigned the least privilege level, it is also necessary to review all accounts configured \non the centralized AAA servers.  \nSimilarly, the same concept should be applied to the console (CON), auxiliary (AUX), \nand virtual teletype (VTY) lines. When AAA authorization is properly configured, it \nshould not be dependent on the configuration of the line s. However, it is a best practice \nto ensure the lines are configured to the least privilege level with the following \nconfiguration commands:  \nline con 0  \nprivilege level 1  \nline aux 0  \nprivilege level 1  \nline vty 0 4  \nprivilege level 1  \nline vty 5 15  \nprivilege le vel 1 \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  17 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nDepending on the device, it may be necessary to apply a similar configuration to other \nlines as well.  If VTY lines 5 through 15 do not exist on a particular device, it is not \nnecessary to execute those commands.  \n4.6 Limit authentication a ttempts  \nLimiting the number of authentication attempts and introducing a login delay preven ts \nan adversary from performing brute force password cracking  against a device in an \nattempt to obtain access.  \nNSA recommends restricting failed remote administration attempts t o a maximum of \nthree or less with the following configuration example command  for Cisco IOS devices : \naaa authentication attempts login 3  \nSimilarly, the same concept of three or less failed attempts should be applied to Secure \nShell (SSH) sessions with the following configuration command:  \nip ssh authentication -retries 3  \nNSA also recommends introducing a delay of at least one second between login \nattempts to significantly slow down brute force attempt s with the following configuration \ncommand:  \nlogin delay 1  \nReturn to Contents  \n5. Local a dministrator accounts  and passwords  \nLocal accounts are vital to the management of network devices. If centralized \nauthentication fails, the local accounts provide administrators with access to the network \ndevices to troubleshoot and diagnose network issues. Local accounts should be unique, \nauthenticated with a unique and complex \npassword, and provide accountability for \nindividual administrator s. If a password policy \ndoes not exist for the organization, establish \nand enforce a new policy. Periodically review \nand revise the policy, when necessary.  Create unique local \naccounts with complex \npasswords.  \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  18 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nThis section focuses primarily on local accounts  and passwords. Traditional network \ndevices use lega cy methods for managing local accounts , and they may not support the \nrecommended mechanisms for composing, changing, and verifying passwords. The \nsimplistic nature of these local accounts requires different recommendations to be \napplied . This is in contras t to the centralized AAA servers where multi -factor \nauthentication, password complexity, previous password comparison, and other \nconcepts can be properly implemented.  \n5.1 Use unique usernames and account s ettings  \nMost devices have default administrative cr edentials which are advertised to the public, \nand they often grant full administrative access  to a device. Maintaining these settings \noffers the adversary an easy entry into the network to connect and potentially gain \nprivileged level access to anonymously  monitor or reconfigure the device.  \nNSA recommends removing all default configurations and reconfiguring each device \nwith a unique and secure account for each administrator. Do not introduce any new \ndevices into the network without first changing the defau lt administrative settings and \naccounts.  \nNote : The default user account on some devices cannot be removed.  \nAccounts can be used by individual administrators or shared among a group. However, \nif multiple administrators use a group account to access the device, accountability \ncannot be enforced as configuration changes will not be associated to a specific \nindividual. For this reason, adversaries target group accounts to gain unauthorized \naccess to devices.  \nNSA further recommends disabling all shared or gr oup administrator accounts, and \nusing a unique account for each administrator to provide access for configuration \nchanges and to ensure accountability on each device. If group accounts are necessary , \nNSA recommends monitoring these accounts to detect any s uspicious activity. It may \nnot be feasible to create a backup local account for each administrator, but a single \ngroup account known to every administrator does not provide individual accountability.  \nNSA also recommends that local accounts only be used in emergency situations when \nthe centralized AAA servers are unavailable. Unique local emergency account \npasswords should be maintained by a trusted individual who does not have direct \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  19 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \naccess to the devices. During an event, a dministrators can request the loc al account \nand password and, once the emergency situation has ended, the trusted individual can \nthen change the password. This will prevent password reuse and ensure accountability. \nAll other authentication requests should occur via the centralized AAA ser vers.  \n5.2 Change default p asswords  \nMost devices are assigned a default password, or sometimes no password, to allow an \nadministrator easy access prior to initial configuration. Many of these passwords are \npublic knowledge and typically do not need to be ch anged for the device to work \nproperly. They are prime targets for malicious automated scanners (botnets) to exploit, \nas the default credentials provide privileged level access to the device.  \nNSA recommends removing all default passwords and assigning a uni que, complex, \nand secure password to all levels of access, including both user and privileged levels. \nAdditionally, when introducing new devices into the network, change the default user \nand privileged level passwords before attaching the device to the net work.  \n5.3 Rem ove unnecessary a ccounts  \nSome devices are configured with unnecessary accounts by default . Since they may be \nrarely used or not used at all, these accounts are  often overlooked.  If possible, rename \nor remove default accounts that are not assoc iated with a particular administrator.  \nNSA recommends that the number of accounts authorized to log onto devices should be \nlimited to what is necessary; all others should be removed. When an administrator \nleaves an organization or changes roles, the associ ated accounts should be disabled or \nremoved. On Cisco IOS devices, r emove a local account with the following configuration \ncommand:  \nno username <NAME> \n5.4 Store passwords with secure a lgorithms  \nPasswords are generally stored in the configuration of a device or in a local database, \nas clear text , encrypted, or a one -way hash. Clear text should never be used, and some \nencryption or hash functions are considered weak and could easily be broken using  \npublicly available tools. An adversary could accumulate passwords or hashes from the \nconfiguration or local database by using a network analyzer or by compromising a \ncentral management system that stores configuration files. The clear text and weak \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  20 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nalgori thm passwords could  be easily cracked and used to obtain user or privileged level \naccess to a device. Cisco IOS supports t he following  one-way hash and encrypted \ntypes:  \n Type 0  passwords should not be used because they are stored in clear text  \n Type 4  passwo rd hashes should not be used because they are eas y to crack  \n Type 5  (MD5) password hashes should be avoided except on older operating \nsystems that do not support Type s 6, 8, or 9  \n Type 6  passwords are AES -encrypted and should only be used for passwords \nthat need to be encrypted instead of hashed (such as for VPN keys) , or on \nsystems that do not support Type 8 (which typically implies that Type 9 is also \nunavailable)  \n Type 7  passwords should not be used because they are easily reversible, even \nthough they are e ncrypted  \n Type 8  (SHA -256 PBKDF2) password hashes are recommended  \n Type 9  (Scrypt) password hashes are not approved by the National Institute of \nStandards and Technology (NIST)  \nFor more information on the above password types, see Cisco Password Types : Best \nPractice s [33]. \nNSA recommends that all passwords on a device be stored using the most secure \nalgorithm available, and never stored as clear text . One -way hash algorithms are \nirreversible and generally should be used for storing passwords. However, if one -way \nhash algo rithms are unavailable, the passwords should be encrypted with a strong \nunique key. \nWhen creating a user account or assigning a password, some devices require the \nalgorithm to be specified. Special attention should be given to privileged level accounts, \nbut this guid e also applies to user accounts, management ports, authenticated routing \nprotocols, VPN keys, and any place where a password  may be specified in the device s \nconfiguration.  \nPrevent clear  text passwords with the following configuration command:  \nservice password -encryption  \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  21 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nStore a Type 8 password hash for a local account with the following configuration \ncommand:  \nusername <NAME> algorithm -type sha256 secret <PASSWORD>  \nNote : The algorithm -type keyword is not stored in the saved configuration in \nnvram:/startup -config ; instead the secret  keyword is replaced with secret 8  prior to \nthe hashed password.  \nIf reversible encrypted passwords  are needed  (such as for VPN keys) , use Type 6 AES \ninstead of Type 7 passwords with the following configuration comma nds: \npassword encryption aes  \nkey config -key password -encrypt <KEY> \nThe <KEY>  should be a unique and complex password that is used to generate the key \nto encrypt Type 6 passwords. It should not be a default, weak, or easily guessable \npassword, and should no t be reused elsewhere in the configuration. An adversary that \nguesses this key could use it to decrypt all Type 6 passwords stored in the \nconfiguration. Once this key is set, it generally does not need to be retained.  \nNote : The key config -key password -encrypt configuration command is not stored in \nthe saved configuration in nvram:/startup -config . \nSince it does not need to be retained, NSA recommends using a unique key for every \ndevice which will prevent an adversary from using the same key to decrypt the Ty pe 6 \npasswords on all of the devices.  \nNote : If the key is ever changed, the Type 6 encrypted passwords will need to be \nmanually set again.  \n5.5 Create strong p asswords  \nA device configured with a weak password increases an adversary s ability to \ncompromise that device. An adversary may be able to easily guess a weak password or \ncrack it using publicly  available password cracking tools (e.g., dictionary or brute  force \nattempt s). Once privileged level access is obtained, an adversary can make \nconfiguration cha nges that potentially compromise other devices on the network.  \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  22 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nNSA recommends assigning a unique and complex password to all levels of access, \nincluding both user and privileged level accesses. Unique and complex passwords \nshould also be used for routing a uthentication, time synchronization, VPN tunnels, \nSimple Network Management Protocol (SNMP) community strings, and anywhere else \npasswords are stored in the configuration. Passwords should meet the following \ncomplexity requirements:  \n Use all the different c haracter classes (uppercase, lowercase, numbers, and \nspecial characters)  \n Be at least 15 characters long  \n Not be based on unmodified words or acronyms  \n Not be a keyboard walk  \n Not be the same as a username  \n Not be related to the network, organization, location,  local sports team, or other \nfunction identifiers  \n Not be identical or similar to the last password  or passwords assigned elsewhere  \n Not be a default, blank, or publicly known password  \nAn organization s password policy may not require passwords managed throu gh the \ncentralized AAA server s to adhere to all of these recommendations, especially when \ncoupled with multi -factor authentication and other principals. The above guidance \nshould at least be applied to local accounts and other passwords that are stored in the \nconfiguration of a network device, where centralized security controls cannot be applied.  \nNSA highly discourage s using SNMP  version 1 or 2c. For more information, refer to 7.1 \nDisable clear text administration services  and 7.8 Remove SNMP read-write community \nstrings . \nAn adversary with knowledge of the network, location, programs, etc. could easily guess \n(or know) these terms, thus aiding them in cracking the pas swords.  \nNSA also recommends checking for weak passwords on a regular basis to enforce the \norganization s password policy.  Password complexity should be checked before setting \na new password . Network administrators should periodically review network device \nconfigurations to identify the use of weak password algorithms . \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  23 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \n5.6 Utilize unique p asswords  \nAssigning the same password to multiple accounts or multiple levels of access could \nimpact accountability and authorization. If an administrator accesses the devic e via an \nunencrypted protocol, an adversary could use a network analyzer to collect the \npassword from network traffic. If an adversary gains user level access, they could \npotentially reuse the same password to also gain privileged level access.  \nAssigning t he same password to multiple devices allows an adversary to compromise \nnumerous devices at the same time, without any extra effort. If the same password was \nassigned to a majority of the devices, an adversary would only need to compromise a \nsingle password  to obtain privileged level access to all of those devices.  \nNSA recommends assigning a unique, complex, and secure password for each account \nand privileged level on each device . \nNSA also recommends checking for password reuse across multiple accounts and \nlevels of access, and across multiple devices. Identical hashes can be an indication of \npassword reuse.  \n5.7 Change p asswords as needed  \nPeriodically changing passwords has historically led to the use of weaker passwords, \nand enforcing  this policy may not be necessary if users follow the guidance in 5.5 \nCreate strong passwords . The initial creation of strong passwords is a more effective \nmethod of reducing successful password compromises . \nNSA recomme nds changing a  password immediately if the password or password hash \nhas been compromised, and storing it securely as described in 5.4 Store passwords \nwith secure a lgorithms . Given enough time  and resources , every pa ssword can be \nguessed or brute  force cracked, which is an attempt at all possible character \ncombinations . Compromised p asswords that have not been changed give an adversary \neven more time to use these techniques . Additionally, if an adversary eventually cr acks \nan old password, they may continue attempting variations and guess the current \npassword if it was based on a previous password.  \nUnfortunately, it can be difficult to discern when a password has been compromised , \nespecially local passwords stored in the configuration. Traditional network devices are \nsignificantly more simplistic in how they store and transmit the configuration, which \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  24 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nincludes passwords and password hashes . Furthermore , emailing network device \nconfigurations or storing them in unprotec ted file shares could constitute a compromise, \nbecause the passwords and password hashes stored in the configurations are left \nunprotected. Additionally, passwords stored with a weak algorithm should be \nconsidered compromised, since they are significantly easier to crack . \nIf the confidentiality of passwords cannot be maintained  or the organization desires to  \nregularly  attempt to evict actors who may have compromised passwords without being \ndetected , NSA recommends establishing an aging policy that incorporates changing \npasswords on a regular basis. Changing local passwords can be significantly more \ncumbersome than centralized passwords, so it is necessary to choose a time frame that \nis reasonably practical for network administrator s to follow, while reducing the amount of \ntime an adversary can utilize a potentially compromised password . If the device does \nnot support long passwords, it is recommended that passwords be changed more \nfrequently to prevent an adversary from cracking a p assword that is still in use.  \nNote : If a password is stored using a convoluted Type 9 secret where the secret 9  \npassword hash begins with $14$, it indicates  that the password was not recently \nchanged. The password hash was converted from Type 5 during a pr evious operating \nsystem upgrade. The convoluted Type 9 secret should  be removed by changing the \npassword to a Type 8 secret with the algorithm -type sha256  keywords, as previously \ndescribed in 5.4 Store p asswords with  secure algorithms . \nReturn to Contents  \n6. Remote logging and m onitoring  \nLogging is an important mechanism for recording device activities and tracking network \nsecurity events . It provides administrators with the ability to review the logs for \nsuspicious activities and to investigate incidents. An incomplete logging configuration on \na device can lead to missing or inaccurate information and difficulty correlating  events \nthat occurred on a device or the network. Proper \nlogging includes sending logs to multiple remote \nlog servers , synchronizing the clock to multiple \nauthenticated time sources, and implementing log \nmanagement policies and procedures. A security \ninformation and event management (SIEM) Enable and configure \nlogging to identify \nmalicious activity.  \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  25 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nsystem can be used to aggregate and analyze logs received by the remote log servers . \nLogs should be retained as recommended by the Office of Management and  Budget \n(OMB) Memorandum M -21-31 [34]. \n6.1 Enable l ogging  \nLog messages will only be generated on network devices when logging is enabled. \nDevices should be configured to send log messages to a local log buffer and centralized \nlog servers simultaneously.  \nNSA recommends enabling syslog logging, setting the local log buffer to 16 megabytes \nor greater, and establishing a procedure to verify the logs are received and reviewed on \na regular basis. Most devices should be able to support th e larger buffer size, but it can \nbe decreased for a particular device if there is insufficient memory.  \nEnsure that syslog logging is enabled with the following configuration command:  \nlogging on  \nIncrease the maximum local log buffer with the following confi guration command:  \nlogging buffered 16777216 informational  \nNote : This will also change the logging level to informational, as both values must be \nset simultaneously.  \n6.2 Establish centralized remote log s ervers  \nLog messages sent to remote log servers are le ss vulnerable to compromise or erasure, \nensuring that the messages will not be impacted in the event a device is compromised , \nrebooted, or the local log buffer becomes full. Multiple log servers are critical when \ndefending against DoS effect s and reducing a single point -of-failure.  \nNSA recommends establishing at least two remote, centralized log servers to ensure \nmonitoring, redundancy, and availability of device log messages. If supported, ensure \nthe log messages are encrypted in transit to prevent unautho rized disclosure of \nsensitive information. Outbound syslog messages can only be encrypted on a Cisco \nIOS device by creating an IPsec tunnel between the device and the remote syslog \nservers , as described in 2.6 Limit and en crypt virtual private networks (VPNs) . \nConfigure at least two remote log servers with the following configuration commands:  \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  26 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nlogging host <IP_ADDRESS_ 1> \nlogging host <IP_ADDRESS_2> \n6.3 Capture necessary log i nformation  \nDevices configured with sufficient information in the logs provide administrators with the \ninformation they need to analyze events related to an incident, including correlating  \nmultiple events or events occurring on other devices.  \nNSA recommends setting th e trap and buffer logging levels on each d evice to at least \nsyslog level informational (code 6) to collect all necessary information.  Devices can be \nconfigured for debugging  (code 7), but the increased number of generated messages \nmay slow down the log  review process. Set both the trap and buffer logging levels to \ninformational with the following configuration commands:  \nlogging trap informational  \nlogging buffered 16777216 informational  \nNote : This will also set the maximum size of the local log buffer, a s both values must be \nset simultaneously.  \nLogging can also be enabled on the console and VTY lines with the console  and \nmonitor  keywords, respectively. These methods will immediately alert administrators \nthat are logged in, but the messages are not retaine d. It is not necessary to enable \nlogging for these methods unless it is desired by the administrators. These logging \nmechanisms  can be disabled with the following configuration commands:  \nno logging console  \nno logging monitor  \nNSA also recommends using Coord inated Universal Time (UTC) for the time zone, \nespecially if the network spans multiple time zones. All log messages should contain a \nproperly configured timestamp with the full date including the year, the time including \nseconds and milliseconds, and the time zone. Ensure the time zone is properly set and \nenable all the features listed above with the following configuration commands:  \nclock timezone UTC 0 0  \nservice timestamps log datetime msec localtime show -timezone year  \nservice timestamps debug datetime m sec localtime show -timezone year  \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  27 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nFinally, NSA also recommends enabling log messages to indicate when a user was \nsuccessful or unsuccessful at logging into the system. Even though these events are \nrecorded on the centralized AAA servers when accounting is p roperly configured, this \ninformation is not logged in the local buffer. Ensure these events are logged with the \nfollowing configuration commands:  \nlogin on -failure log  \nlogin on -success log  \n6.4 Synchroniz e clocks  \nThe Network Time Protocol (NTP) is used to sy nchronize device clocks worldwide  and \nto ensure  that the timestamps included with log messages are reasonably accurate. To \nprovide this reliability, each device should synchronize with at least two trusted time \nsources. This accuracy is critical to ensure log message timestamps can be easily \ncorrelated  across geographically dispersed time zones, and used to collectively trace a \nnetwork incident from one device to another.  \nNSA recommends that each device and the remote log servers use at least two \ntrustworthy and reliable time servers to ensure accuracy and availability of information. \nInternal time servers should be established as the primary source for all devices, which \nshould subsequently synchronize with authoritative external sources. This design \ndecreases the number of external requests and ensures  consistency of timestamps in \nthe event an external time server is unreachable. When deploying time servers on the \nnetwork, administrators should confirm that devices can access the time servers, and \nthat the clocks are synchronized after the configuration  has been applied.  \nNSA also recommends enabling NTP authentication on all devices to prevent clock \ntampering, and configuring strong, unique NTP authentication keys between the devices \nand their specified time source.  \nEstablish the trusted NTP keys and ena ble NTP authentication with the following \nconfiguration commands:  \nntp authentication -key <#1> md5 <KEY> \nntp trusted -key <#1> \nntp authentication -key <#2> md5 <KEY> \nntp trusted -key <#2> \nntp authenticate  \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  28 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nAny number of trusted keys can be established. Note that NTP authentication keys will \nbe stored in the configuration as Type 7 passwords. Type 6 AES -encrypted passwords \nare not supported for NTP authentication.  \nSynchronize the device with at least two different NTP servers with the following \nconfiguration c ommands:  \nntp server <IP_ADDRESS_1> key <#1> \nntp server <IP_ADDRESS_ 2> key <#2> \nNote:  The number at the end of each command is the trusted NTP key used to \nauthenticate that particular server.  \nAfter waiting for the clock to synchronize, verify synchronizatio n and status of the NTP \nservers with the following exec commands:  \nshow ntp status  \nshow ntp associations  \nNote : It is necessary to verify clock synchronization after every NTP configuration \nchange, and it may take several hours for proper synchronization.  \nReturn to Contents  \n7. Remote administration and network s ervices  \nNetwork devices can be managed remotely by \nadministrators through various services. Some \ncommon network services include SSH, \nHypertext Transfer Protocol (HTTP), SNMP, and \nFile Transfer Protocol (FTP). These services are \nuseful for administrators, but they  are also \ntargeted by  adversaries to exploit and gain privileged level access to a device. All of \nthem must be properly configured to reduce the probability of a compromise.  \n7.1 Disable clear  text administration s ervices  \nClear  text protocols pass traffic a cross the network in the clear  (i.e., unencrypted) and \nwere designed prior to widespread use of encryption. Therefore, using these protocols \nto remotely administer critical devices may lead to an information disclosure that could Protect your network \nmanagement tools \nfrom adversaries.  \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  29 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nadversely affect device and network security. An adversary could compromise a device \nor service by collecting usernames, passwords, configuration information, and other \nsensitive data through common information retrieval techniques (e.g., network analyzer \nor packet capture utilit y). \nNSA recommends using encrypted services to protect network communications and \ndisabling all clear  text administration services (e.g., Telnet, HTTP, FTP, SNMP 1/2c). \nThis ens ures that sensitive information  cannot be easily obtained by an adversary \ncaptu ring network traffic. For detailed information on how to enable encrypted services, \nrefer to 7.11 Configure remote network administration services.  \nIf a device does not support encrypted protocols, connect a management system \ndirectly to the console or management port, or establish a dedicated out -of-band \nmanagement network to reduce the ability of an adversary capturing the clear  text \nprotocols. Disable the Telnet service with the following configuration comm ands:  \nline vty 0 4  \ntransport input none  \nline vty 5 15  \ntransport input none  \nDepending on the device, it may be necessary to apply a similar configuration to other \nlines as well. If VTY lines 5 through 15 do not exist on a particular device, it is not \nnecessary to execute those commands.  \nNote : These commands may also disable other services that are enabled on the lines \nby default, including SSH. For detailed information on how to enable SSH, refer to \n7.11.1 Configuring SSH  for remote administration . \nDisable the HTTP service with the following configuration command:  \nno ip http server  \nFor detailed information on how to enable the secure HTTP service, refer to 7.11. 2 \nConfiguring  HTTP for remote administration . \nDisable versions 1 and 2c of the SNMP and SNMP trap services by removing any \nconfigured community strings with the following configuration commands:  \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  30 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nno snmp-server community <COMMUNITY_STRING>  \nno snmp-server host <HOSTNAME_OR_IP_ADDRESS> <C OMMUNITY_STRING>  \nFor detailed information on how to enable SNMP version 3, refer to 7.11.3 Configuring  \nSNMP for remote administration . \nDisable the Trivial File Transfer Protocol (TFTP) by removing any lines with the \nfollowin g configuration command:  \nno tftp-server <FILENAME>  \nThe FTP service is generally not enabled as a listening service, but the protocol can be \nused as a client. Remove FTP credentials with the following configuration commands:  \nno ip ftp username  \nno ip ftp pas sword \n7.2 Ensure adequate encryption s trength  \nSome encrypted services require that a public and private key pair be generated so \nclients can connect and authenticate to the server. Additionally, the client and server of \nan encrypted connection may collectively establish a private session key for each \nunique connection. Encrypted connections that use weak algorithms or a small number \nof bits make it easier for an adversary to crack  the private session key and decrypt all of \nthe data transferred during a unique connection.  \nFor guidance on which algorithm s and ciphers are NSA -approved for National Security \nSystems ( NSS), refer to CNSSP  15 [4]. The CNSSP 15 requirements are explained in \nthe draft IETF documents on Commercial National Security Algorithm (CNSA) Suite \nCryptography for Internet Protocol Security (IPsec) , Commercial National Security \nAlgorithm (CNSA) Suite Profile for TLS and DTLS 1.2 and 1.3 , and Commercial \nNational Security Algorithm (CNSA) Suite Cryptography for Secure Shell (SSH)  [5], [35], \n[36]. \nFor related requirements and guidance for non -NSS U.S. Government systems, refer  to \nNIST SP 800 -52 Revision 2  Appendix F  [37]. \nThese documents contain  the latest recommen ded encryption parameters.  \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  31 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nNSA recommends that 3072 bits or higher be used for asymmetric (public and private) \nkey generation, 384 bits for elliptic  curve cryptography (ECC) keys, and 256 bits for \nsymmetric encryption keys. Some systems may not support 307 2 bits, so it may be \nnecessary to use 4096 bits  instead . For any device that has a smaller key size, \nregenerate a new key pair and configure encrypted protocols to only use approved \nalgorithms. A larger key size may increase the time to connect to the serv ice (due to \nextra computations), but is negligible on most devices. For more information on \nconfiguring encrypted services, refer to 7.11 Configure remote n etwork administration  \nservices . \n7.3 Utilize secure p rotocols  \nSeveral common administration services implement protocols that contain flaws in the \nimplementation and exchange of information , which can be exploited by an adversary. \nSome protocols, such as SSH, can be configured to be backward  compatib le and \naccept older insecure protocols, along with the newer ones. Older protocols are subject \nto man -in-the-middle techniques that  can force clients and servers to negotiate weaker \nalgorithms, possibly without user awareness.  \nNSA recommends ensuring admin istration services are using the latest version of \nprotocols, with the proper security settings adequately enabled. SSH version 2 is the \npreferred method for remotely accessing devices. Encrypted HTTP servers should be \nconfigured to only accept Transport L ayer Security (TLS) version 1.2 or higher. For \nmore information on limiting services to specific versions of the protocol, refer to 7.11 \nConfigure remote n etwork administration  services . \n7.4 Limit access to services  \nIf a large number of  devices are permitted to connect to management services, they are \nmore vulnerable to exploitation . NSA recommends configuring ACLs to allow only  \nadministrat ive systems to connect to devices for remote management. Devices th at do \nnot have the capability to support ACLs should be placed on a separate network \nmanagement segment (e.g. VLAN).  \nOnce created, an ACL should  be applied to that VLAN or at the ingress router to restrict \naccess to this network segment. It may be necessar y to implement a separate firewall in \nfront of critical network segments to restrict what systems can connect to that VLAN.  \nConsider using Dynamic Host Configuration Protocol (DHCP)  with reserved IP \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  32 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \naddresses, or  assign ing administrat ive systems  with static IP addresses , to make it \neasier to define the ACL and limit administrative access to the management services.  \nMost management services only accept standard ACLs. More than one device or \nnetwork can be listed on additional lines with the permit  keyw ord. Even though every \nACL has an implied deny statement at the end, it is a best practice to explicitly include it \nso denied attempts are logged. Create a standard ACL to only permit IP addresses \nused by administrators with the following configuration com mands:  \naccess-list <ACL#> permit <NETWORK> <WILDCARD_MASK>  log \naccess-list <ACL#> deny any log  \nFor more information on how to apply ACLs to specific administrative services, refer to \n7.11 Configure remote  network administration  services.  \nNSA also recommends removing unused ACLs from the configuration to reduce \nconfus ion around whether or not they are properly applied. After verifying that a \nstandard ACL is not applied, remove it with the following configur ation command:  \nno access -list <ACL#> \n7.5 Set an acceptable timeout p eriod  \nSetting a timeout period for idle connections allows sessions to close after a prescribed \ntime of inactivity. When timeout periods are not set or set too long, it is possible for idle \nconnections  to continue indefinitely or even cause a DoS if limited simultaneous \nconnections have been set on the device. The DoS will persist until the idle timeout \nperiod has been reached, which could be indefinite if the  idle timeout has been \ndisab led. A longer timeout period provides an adversary with more time to hijack  a \nsession while it is idle.  \nNSA recommends setting the session timeout for administrative connections to five \nminutes or less on all remote devices (e.g., exec -timeout on VTY lines , SSH, console \nand auxiliary ports). Do not set the timeout period to zero, as most devices will disable \nthe time out function with this setting. For more information on limiting the session \ntimeout on specific administrative services, refer to 7.11 Configure remote n etwork \nadministration  services . \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  33 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \n7.6 Enable Transmission Control Protocol (TCP) keep -alive \nTCP keep -alive messages sent and received from a device allow it to assess the \nconnection status when n o activity has occurred in a given timeframe. These messages \ncan be used to detect an inadvertent loss in connection and mitigate against potential \nnetwork compromise s. On some devices, the lack of a TCP keep -alive service causes \nestablished TCP connection s to remain open after an inadvertent connection loss on \none end, leaving the session vulnerable to hijacking. Additionally, authentication may \nnot even be required, especially for unencrypted connections, and the adversary could \nsimply resume the session,  possibly gaining privileged level access.  \nNSA recommends enabling TCP keep -alive settings for both inbound and outbound \nmessages for all TCP connections with the following configuration commands:  \nservice tcp -keepalives -in \nservice tcp -keepalives -out \nNote t hat some devices do not support the configuration of TCP keep -alive messages.  \n7.7 Disable outbound c onnections  \nAfter authenticating to a device via a management port, a user generally has the ability \nto remotely connect to other systems on the network thro ugh supported protocols (e.g., \nTelnet and SSH). If an adversary was able to compromise the device or use an \nadministrator account to gain user level access, this outbound connection could \npotentially be used to advance through the network.  Properly reviewi ng device \nconfigurations and leveraging ACLs can prevent unauthorized systems from accessing \nnetwork resources.  \nNSA recommends disabling outbound connections to limit an adversary from moving \nthrough the network with the following configuration commands:  \nline con 0  \ntransport output none  \nline vty 0 4  \ntransport output none  \nline vty 5 15  \ntransport output none  \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  34 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nDepending on the device, it may be necessary to apply a similar configuration to other \nlines as well. If VTY lines 5 through 15 do not exist on a particular device, it is not \nnecessary to execute those commands. It is critical to note that this feature must be \nexplicitly disabled on the console line.  \nIf outbound connections are required for copying files t o or from the devices for \nmaintenance or integrity verification, restrict it to only SSH and limit the number of \ndevices that can be accessed via outbound ACLs; revert to the above configuration \nonce the task is complete.  \n7.8 Remove SNMP read -write communi ty strings  \nAn SNMP version 1 or 2c read -write community string is similar to a password, and can \nbe used to access or modify device configurations and operating system files. These \nactions generally cannot be done with a read -only community string. Because  SNMP \nread-write community strings are sent in clear  text, they can be exploited by an \nadversary to gain complete control of a network device.  \nNSA recommends removing all SNMP read -write community strings and upgrading to \nSNMP version 3 with encryption and  authentication. If a version 1 or 2c SNMP read -\nwrite community string is required for remote administration and cannot be removed, it \nis recommended that the read -write community string be significantly different from \nother community strings to prevent an  adversary from guessing the read -write \ncommunity string if a read -only community string is obtained.  \nAll version 1 and 2c SNMP community strings can be listed with the following exec \ncommand:  \nshow running -config | include snmp -server community  \nNote : A read-write community string will include the RW keyword, while a read -only \ncommunity string will include the RO keyword.  \nDisable an SNMP read -write community string with the following configuration \ncommand:  \nno snmp-server community <COMMUNITY_STRING>  \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  35 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \n7.9 Disa ble unnecessary network s ervices  \nDuring the initial installation of devices, several TCP and UDP services are enabled by \ndefault, even though the provided features are unnecessary for normal operations. \nThese services can degrade the security level of the network, offering an adversary \nadditional access points to exploit a device and leave it susceptible to unauthorized \nmonitoring, information gathering, and compromise . \nFor example, Cisco Smart Install is often unnecessary, but when left enabled , an \nunauthe nticated remote adversary could use this service to obtain a device s \nconfiguration file, upload a new configuration or operating system image file, or force a \nreboot. This has been documented in Cisco s security advisory cisco -sa-20170214 -smi \nas a misuse of the protocol, but the security community has observed and \nacknowledged this issue as a severe vulnerability exploited by adversaries to obtain \nconfiguration files across the Internet  [38], [39]. \nNSA recommends disabling every unnecessary service on each device. If the service is \nrequired and can support a password and ACLs , create a password based on NSA s \nstrong password guidance (s ee 5.5 Create strong passwords ) and apply an ACL to only \nallow required systems to connect to the service. If a device does not support ACLs, it \ncan be moved to a separate VLAN, and an ACL can be applied to the VLAN.  \nNSA also recommends immediately disabling the Cisco Smart Install service on all \ndevices with the following configuration command:  \nno vstack  \nEven though this service is designed for switches, routers can also be configured as a \nCisco Smart Install director;  therefore, it should be explicitly disabled on all devices, \nespecially when they are first configured.  \nDisable other unnecessary TCP and UDP services with the following configuration \ncommands:  \nno service tcp -small-servers \nno service udp -small-servers \nno service finger  \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  36 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \n7.10 Disabl e discovery protocols on specific i nterfaces  \nCisco Discovery Protocol (CDP) and Link Layer Discovery Protocol (LLDP) are \nbroadcast protocols that periodically advertise network topology and device information \nto neighboring device s that support  the protocol and are listening for packets. This \nfunctionality is enabled by default and can be useful for administrators to obtain \ninformation about the network, but it is also extremely useful to an adversary who can \npassively gather netwo rk configuration information. An adversary that is able to deploy a \nsniffer could collect device model numbers, operating system versions, VLAN \ninformation, and physical and logical addresses, gaining valuable information to exploit \nsystems on the network.  \nNSA recommends disabling CDP and LLDP on all devices capable of using th ese \nservice s. If a service is required for proper network communications (e.g., some Cisco \nVoice -over-IP (VoIP) phones), only enable it on point -to-point links between devices that \nrequire the protocol or on voice enabled ports.  \nCDP and LLDP can be globally disabled with the following configuration commands:  \nno cdp run  \nno lldp run  \nIf CDP is required on specific interfaces, it must be globally enabled but disabled on all \nother interface s, as shown in the following configuration commands for a single \ninterface:  \ninterface <INTERFACE>  \nno cdp enable  \n7.11 Configure remote network administration services  \nThis section describes how to properly enable common remote network administration \nservices.  \n7.11.1 Configuring SSH for remote administration  \nAllow inbound SSH connections with the following configuration commands:  \nline vty 0 4  \ntransport input ssh  \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  37 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nline vty 5 15  \ntransport input ssh  \nNote : This may disable other services enabled on the line s by default, such as Telnet. If \nVTY lines 5 through 15 do not exist on a particular device, it is not necessary to execute \nthose commands. Depending on the device, it may be necessary to apply a similar \nconfiguration to other lines as well.  \nAllowed input transports can be confirmed with the following exec command:  \nshow line <LINE> <LINE_NUMBER>  \nDisable SSH version 1 connections and only allow version 2 of the protocol with the \nfollowing configuration command:  \nip ssh version 2  \nGenerat e a new asymmetric Rive st-Shamir -Adleman (RSA) key pair for SSH with the \nfollowing configuration command:  \ncrypto key generate rsa modulus 3072  \nNote : This command will overwrite an existing RSA key pair.  \nGenerate a new asymmetric ECC  key pair for SSH with the following configuration \ncommand:  \ncrypto key generate ec keysize 384  \nNote : This command will overwrite an existing EC C key pair.  \nSet the minimum Diffie -Hellman key size to 4096 bits with the following configuration \ncommand:  \nip ssh dh min 4096  \nNote : Some devices do not support 3072 bits for the Diffie -Hellman key size, so 4096 \nbits is recommended.  \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  38 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nThe encryption, key exchange (KEX), and message authentication code algorithms \naccepted by the SSH protocol can be specified (to include the preferred order) with the \nfollowing configuration commands:  \nip ssh server algorithm encryption <ALGORITHM>  [<ALGORITHM>  ...] \nip ssh server algorithm kex <ALGORITHM>  [<ALGORITHM> ...] \nip ssh server algorithm mac <ALGORITHM>  [<ALGORITHM> ...] \nFor more in formation on acceptable  algorithms, refer  to CNSSP  15 [4]. The CNSSP 15 \nrequirements are explained in the draft IETF document on Commercial National \nSecurity Algorithm (CNSA) Suite Cryptography for Secure Shell (SSH)  [36]. \nThe configuration of the SSH service can be confirmed with the following exec \ncommand:  \nshow ip ssh  \nApply a standard ACL to only permit IP addresses used by administrators with the \nfollowing configuration commands:  \nline vty 0 4  \naccess-class <ACL#> in \nline vty 5 15  \naccess-class <ACL#> in \nIf VTY lines 5 through 15 do not exist on a particular device, it is not necessary to \nexecute those commands. Note that this ACL would also apply to Telnet if it was \nenabled on the lines. Depending on the device, it may be necessary to apply a similar \nconfiguration to other lines as well. Refer to 7.4 Limit access to services  for more \ninformation on creating a standard ACL.  \nSet the session expiration to 5 minutes or less with the f ollowing configuration \ncommands:  \nline con 0  \nexec-timeout 5 0  \nline vty 0 4  \nexec-timeout 5 0  \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  39 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nline vty 5 15 \nexec-timeout 5 0  \nIf VTY lines 5 through 15 do not exist on a particular device, it is not necessary to \nexecute those commands . \nNote : This would also apply to Telnet if it was enabled on the lines. Depending on the \ndevice, it may be necessary to apply a similar configuration to other lines as well.  \n7.11.2 Configuring HTTP  for remote administration  \nIf HTTP is used for management purposes, ena ble HTTP over TLS with the following \nconfiguration command:  \nip http secure -server \nOnly accept TLS version 1.2 with the following configuration command:  \nip http tls -version TLSv1.2  \nThe cipher suites accepted by the encrypted HTTP service can be specified (t o include \nthe preferred order) with the following configuration command:  \nip http secure -ciphersuite <CIPHERSUITE>  [<CIPHERSUITE>  ...] \nFor more information on acceptable  algorithms, refer to CNSSP  15 [4]. The CNSSP 15 \nrequirements are explained in the draft IETF document on Commercial National \nSecurity Algorithm (CNSA) Suite Profile fo r TLS and DTLS 1.2 and 1.3  [35]. \nApply a standard ACL to only permit IP addresses used by administrators with the \nfollowing configuration command:  \nip http access -class <ACL#> \nNote: This ACL would also apply to the clear  text HTTP service if it was enabled. For \nmore information on creating a standard ACL, refer to 7.4 Limit a ccess to services . \nThe default idle timeo ut of an HTTP server connection is 180 seconds (three minutes), \nso it is not necessary to change this value.  \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  40 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \n7.11.3 Configuring SNMP  for remote administration  \nIf SNMP is used for management, enable SNMP version 3 with both authentication and \nprivacy (encry ption) with the following configuration commands:  \nsnmp-server group <SNMPv3_GROUP>  v3 priv access <ACL#> \nsnmp-server user <USER> <SNMPv3_GROUP>  v3 auth sha <AUTH_PASSWORD>  priv aes \n256 <PRIV_PASSWORD>  access <ACL#> \nFirst a group must be defined, where the priv keyword is equivalent to authPriv (both \nauthentication and privacy). One or more users must be defined and assigned to a \ngroup. In addition to the authentication and encryption parameters, two different \npasswords must be supplied for each user, one fo r authentication and one for privacy. \nInteroperability issues have been observed with AES -192 and AES -256, so it may be \nnecessary to use AES -128 for encryption instead of AES -256 with the aes 128  \nkeywords. As shown above, an ACL can be applied to both the group and each \nindividual user by specifying it as a separate option at the end of each command with \nthe access  keyword.  \nThe above SNMP configuration can be tested from a Linux system with the following \nshell command:  \nsnmpget -v 3 -u <USER> -a sha -l authPriv -A '<AUTH_PASSWORD> ' -x AES \\ \n-X '<PRIV_PASSWORD> ' <IP_ADDRESS>  1.3.6.1.2.1.1.5.0  \nReturn to Contents  \n8. Routing  \nRouters forward data packets between computer networks. When a router receives a \npacket, it uses its routing table  and the packet s network address information to \ndetermine the next hop to reach its \ndestination. An improper configuration of the \nrouter itself or the dynamic routing protocols \nused to po pulate the routing table could allow \nan adversary to redirect packets to a different \ndestination, allowing sensitive data to be \ncollected, manipulated, or discarded, which would violate confidentiality, integrity, or \navailability.  Configure your routers \nfor network use vs. \nmalicious abuse.  \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  41 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \n8.1 Disable IP source r outing \nIP source routing is a rarely  used feature that enables the sender of a packet to specify \na pre -determined list of intermediate nod es where it should be forwarded rather than \nusing the internal routing table to make a decision. Leveraging this setting , an adversary \ncould transmit packets through a route of their choosing. Along with IP address \nspoofing, an adversary can use the IP source routing feature to successfully bypass \nACLs and other network restrictions, essentially choosing its own network pat h. \nAlthough this vulnerability is associated with routers and how packets are routed, the \nfunctionality can also be exploited on switches.  \nNSA recommends disabling IP source routing on all devices, not just routers, since this \nfeature is not required for n ormal network operations. Depending on the vendor of a \nproduct, it may be necessary to disable forwarding of each IP source route option \nindividually. A similar feature is available in IPv6, and needs to be disabled separately. \nDisable IP source routing wi th the following configuration commands:  \nno ip source -route \nno ipv6 source -route \n8.2 Enable unicast reverse -path forwarding (uRPF)  \nuRPF is a method of protection against IP spoofing that instructs a router to examine \nboth the source and destination address es in the packet. When a packet is received on \nan interface, the source address is compared to entries in the routing table and is \nforwarded if the return route matches where the packet was received. Otherwise, it is \ndiscarded due to concerns that the sour ce address in the packet may have been \nspoofed. If uRPF is not enabled, an adversary may be able to successfully spoof the \nsource address of IP packets sent into the network.  \nNSA recommends enabling uRPF on external interfaces of perimeter routers. On \nrouters, it is necessary for Cisco Express Forwarding (CEF) , which provides optimized \nlookups for efficient packet forwarding,  to be enabled before uRPF . Note that uRPF \nshould not be enabled on internal interfaces or routers that have asymmetrical routing \n(whe re two or more return routes may exist for a given source address), as this situation \ncould cause legitimate packets to be discarded.  Enable uRPF on a single interface with \nthe following configuration commands:  \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  42 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nip cef \ninterface <INTERFACE>  \nip verify unicas t reverse -path \n8.3 Enable routing a uthentication  \nDynamic routing protocols are used to distribute information to neighboring devices and \nprovide routes to reach other networks. Network devices will use this information to \npopulate their routing table s, which are then used to determine the next hop for \nforwarding a packet to the requested destination. To control the flow of traffic, an \nadversary may inject, modify, or corrupt the routing information sent and received by \nneighboring devices. Routing auth entication should be enabled to prevent route \nmanipulation and ensure the routing information received from neighboring devices has \nnot been manipulated by an unauthorized source.  \nNSA recommends enabling routing authentication on any dynamic routing protoc ols \nused that receive routing updates from other devices on the network. Enable Open \nShortest Path First (OSPF) routing authentication by enabling it on the OSPF process \nfor each area and applying the authentication key to each interface associated with th at \nprocess with the following configuration commands:  \nkey chain <KEY_CHAIN_NAME>  \nkey <KEY_NUMBER>  \nkey-string <KEY> \ncryptographic -algorithm hmac -sha-512 \ninterface <INTERFACE>  \nip ospf authentication key -chain <KEY_CHAIN_NAME>  \nNSA also recommends using a unique key between all neighbors, instead of using the \nsame authentication key for all interfaces on all devices. If the keys are different, an \nadversary would not be able to use a compromised key from one network to inject a \nmalicious route on another net work.  \nEnable Border Gateway Protocol (BGP) routing authentication by applying a unique \npassword key to each individual peer with the following configuration commands:  \nrouter bgp <AS_NUMBER> \npeer <IP_ADDRESS_ 1> password <KEY> \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  43 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nEnable Enhanced Interior Gatewa y Routing Protocol (EIGRP) authentication by creating \na key -chain and applying it to each interface with the following configuration commands:  \nkey chain <KEY_CHAIN_NAME> \nkey <KEY_NUMBER > \n key-string <KEY> \n cryptographic -algorithm hmac -sha-512 \ninterface <INTERFACE>  \nip authentication key -chain eigrp <AS_NUMBER> <KEY_CHAIN_NAME > \nNote : An arbitrary name and number can be chosen for each key.  The <KEY>  is the \nshared key assigned to neighboring devices. The cryptographic -algorithm  can also be \nset to hmac-sha-384 and still meet CNSSP  15 guidance  [4]. \nDo not use the Routing Information Protocol (RIP). It is slow to converge, does not \nscale, and RIP version 1 cannot be configured to authenticate nearby routers, making it \neasy for an adversary to exploit the protocol. Devices that only support RIP should use \nstatic or default routes to other devices that support modern routing protocols with \nauthentication.  \nReturn to Contents  \n9. Interface p orts \nThe interface ports of network switches physically connect workstations, servers, and \nother devices to the network, while the interconnections bet ween routers and switches \ndefine how systems communicate across the network. An adversary must first obtain \nphysical access to the network to connect \nan unauthorized system, or use a n \nauthorized  system already on the network to \nexploit an existing connecti on. Properly \nconfigured interface ports can prevent an \nadversary from performing exploitation \nattempt s against the network.  \n9.1 Disable dynamic t runking  \nA trunk is a point -to-point link between two devices that exchange VLAN encapsulated \nframes. Depending on the traffic being sent over the link, it is possible for an interface Prevent an adversary \nfrom connecting to \nyour network.  \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  44 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nport to dynamically configure itself to be either a trunk or an access port. An adversary \nthat is connected to a dynamic port could instruct it to become a trunk port and \npotentially gain access to network traffic without regard to VLAN separation.  \nNSA recommends disabling dynamic trunking as it is not necessary for an interface port \nto dynamically configure itself. When a device is added to the network, ensure that all \ninterface ports  are explicitly configured as either trunk ports or access ports. Systems \nthat do not handle VLAN encapsulated frames should be connected to a port that is \nconfigured for access only.  \nStrictly configure an interface port for static access only with the fol lowing configuration \ncommands:  \ninterface <INTERFACE>  \nswitchport mode access  \nStrictly configure an interface port to be a trunk with the following configuration \ncommands:  \ninterface <INTERFACE>  \nswitchport mode trunk  \n9.2 Enable port s ecurity  \nPhysical interface ports of devices are often the primary means of restricting physical \naccess to a network. Port security limits the number of valid MAC addresses  allowed to \nconnect to a switch port, restricting connectivity to only authorized  systems . A switch port \nnot configured to enforce port security could allow an adversary with physical access to \nconnect an unauthorized system. The adversary could bypass existing security \nrestrictions, gather network information, probe deeper into the network, or comp romise \ninternal systems . \nNSA recommends enabling port security on all active switchports on a device, and \nsetting the maximum number of allowed MAC addresses for each port to be exactly \none, or two if VoIP capabilities are in use. Port security is not a re placement for a NAC, \nsuch as 802.1X, but should be used when a NAC cannot be implemented. If possible, \nassign a f ixed MAC address to each switch port that is connected to a known system, \nand configure each switchport to either shutdown or send an SNMP trap message when \na port security violation occurs. Port security can be enabled on trunk interfaces; \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  45 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nhowever, it is not recommended as it requires knowing the number of devices that have \ntraffic traversing that s pecific trunk. A dynamic switch port cannot have port security \nenabled simultaneously, and must first be configured for static access before port \nsecurity can be enabled.  \nEnable port security on a static access port with a maximum of one MAC address with \nthe following configuration commands:  \ninterface <INTERFACE>  \nswitchport mode access  \nswitchport port -security  \nswitchport port -security maximum 1  \nswitchport port -security violation s hutdown \nswitchport port -security mac -address sticky  \nThe sticky  keyword will allow the device to insert the MAC address in the c onfiguration \nonce the first authorized system is connected to that port.  \nNote : The configuration will need to be saved to retain the information after a reboot. If \nshutting down a port is not an acceptable action because of availability concerns, the \nshutdown  keyword can be replaced with restrict  to prevent any additional MAC \naddresses from communicating on that port.  \n9.3 Disable d efault VLAN  \nMost switches utilize VLAN 1 as the default, including management ports, which may \nprovide direct access to the  switch for administration. Additionally, some layer 2 \nprotocols (e.g., discovery or trunking) need to be sent on a specific VLAN on trunk links, \nand VLAN 1 is generally selected as the default. If mitigation steps are not taken, the \ndefault VLAN may span the entire network, and place authorized systems  at a higher \nrisk of exploitation  by unauthorized systems  that gain access.  \nNSA recommends moving all management and operational traffic to different VLANs \n(not the default) that separate management traffic f rom user data and protocol traffic, \nand using multiple switches to separate different security levels of network traffic. The \ndefault VLAN should also be logically disallowed on all trunks and access ports that \ndont require it (including disconnected and shutdown ports) to ensure it does not \ntransmit unnecessary broadcast, multicast, and unknown destination traffic.  \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  46 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nFrames that are sent and received on trunk ports are usually tagged with the VLAN ID \nassociated with  the frame. Any frames received that are n ot tagged are automatically \nplaced in the native trunking VLAN associated with that port. The native trunking VLAN \nshould be assigned the same on both ends of a trunk link. Similarly, frames that are \nsent and received on access ports are assigned to the ac cess VLAN associated with \nthat port. All switchports are assigned to an access VLAN and a native trunking VLAN, \nregardless if they are trunk or access ports.  \nNSA recommends assigning all trunk ports to a unique native trunking VLAN that is only \nassigned to  trunk ports, and assigning the access VLAN to an unused and disabled \nVLAN. Similarly, NSA recommends assigning all access ports to the appropriate access \nVLAN, and assigning the native trunking VLAN to another unused and disabled VLAN, \ndifferent from the ones used by trunk ports. This configuration will prevent an adversary \nfrom jumping between active VLANs by intentionally tagging traffic that would otherwise \nbe untagged.  \nCreate a unique trunking VLAN (500) and an unused and disabled access VLAN (997), \nboth assigned to a trunk port, with the following example configuration commands:  \nvlan 500  \nname NATIVE -TRUNK \nvlan 997  \nname UNUSED -ACCESS \nshutdown  \ninterface <INTERFACE>  \nswitchport mode trunk  \nswitchport access vlan 997  \nswitchport trunk native vlan 500  \nswitchpo rt trunk allowed vlan 2 -4094 \nThis configuration also allows all VLANs, except for the default VLAN 1, to traverse the \ntrunk. If all configured VLANs are known, NSA recommends allowing only those specific \nVLANs, rather than just excluding VLAN 1.  \nCreate an unused and disabled VLAN (998), assigned to the native trunking VLAN of an \naccess port, with the following example configuration commands:  \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  47 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nvlan 998  \nname UNUSED -NATIVE \nshutdown  \ninterface <INTERFACE>  \nswitchport mode access  \nswitchport access vlan <ACCESS_VLAN#>  \nswitchport trunk native vlan 998  \nSwitchports can also be assigned a third VLAN, if VoIP capabilities are in use, with the \nfollowing configuration commands:  \ninterface <INTERFACE>  \nswitchport voice vlan <VOICE_VLAN#>  \nAll of the VLANs associated  with individual switchports can be confirmed with the \nfollowing exec command:  \nshow interfaces switchport  \n9.4 Disable unused p orts \nLeaving unused ports enabled on a device allows an adversary to attach a rogue device \nto the network and perform information gathering or compromise attempt s. All unused \nports should be disabled and placed in an unused  VLAN, which is not the default.  \nNSA recommends disabling all unused ports on a device by shutting down the \nassociated interfaces and, if supported by the device, assigning unused ports to an \nunused VLAN. This will continue to prevent access to the network, even if the ports \nbecome enabled. Prior to disabling a port, it is necessary to verify that it is truly unused \nand nothing is connected. If a device connected to  the port is powered off, it may \nappear that the switchport is unused.  \nShut down all unused interfaces and assign the access and native trunking VLANs to \nunused and disabled VLANs with the following example configuration commands:  \nvlan 999  \nname UNUSED -DISABLED \nshutdown  \ninterface <INTERFACE>  \nswitchport mode access  \nswitchport access vlan 999  \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  48 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nswitchport trunk native vlan 998 \nno switchport voice vlan  \nshutdown  \nNote : It is not necessary to assign the voice VLAN to an unused VLAN, as it will remain \nunassigned if V oIP capabilities are not in use.  \n9.5 Disable port m onitoring  \nPort monitoring is used on a network switch to send a copy of net work packets seen on \none switch port to a network monitori ng connection on another switch port. A device that \nhas one or more port monitoring sessions defined allows a set of source ports to be \nmonitored by a specified destination port, and all traffic being sent to or from the source \nports will also be sent to the destination port.  \nPort monit oring is typically used for connecting an NIDS, diagnosing a problem, or using \na network analyzer to monitor the network. Depending on the vendor, port monitoring is \nalso known as port mirroring  or port spanning.  An adversary connected to the \ndestinati on port of a port monitoring session will be able to collect network traffic sent \nthrough all the source ports specified by the session.  \nNSA recommends disabling all inactive port monitoring sessions on a device. Port \nmonitoring should only be enabled for those ports where it is necessary, and all \nsessions should be disabled once they are no longer needed.  \nNote : Some vendors do not allow traffic to be sent from the destination port of a port \nmonitoring session, effectively disabling network access from that  port. This type of \nbehavior is desired when a NIDS is connected to a port monitoring session.  \nList the monitoring sessions defined in the configuration with the following exec \ncommand:  \nshow monitor session [1|2|all]  \nNote : If the all keyword is supported, it will list all of the defined sessions; otherwise \neach individual session number will need to be specified in separate commands, \ngenerally 1 and 2. \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  49 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nRemove a monitoring session defined in the configuration with the following \nconfiguration command:  \nno monitor session <SESSION#>  \n9.6 Disable proxy Address Resolution Protocol (ARP)  \nProxy ARP is a technique in which a proxy server on a network answers ARP requests \nfor an IP address that is not on that network. It helps devices on a subnet reach remote \nsubnets, without configuring routing on a default gateway. It can be advantageous since \nit can be added to a router without disbursing routing tables from other networks, but \nthis feature  allows adversaries to spoof a system and intercept packets.  \nNSA recommends di sabling proxy ARP on all interfaces unless the device is being used \nas a LAN bridge or to allow inbound network address  translations (NAT) for multiple \ndestination IP addresses. It may be necessary to disable proxy ARP on each individual \ninterface, rather than disabling it globally.  \nFind interfaces that have proxy ARP enabled with the following exec command:  \nshow ip interface  \nDisable Proxy ARP on an individual interface with the following configuration \ncommands:  \ninterface <INTERFACE>  \nno ip proxy -arp \nReturn to Contents  \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  50 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \n10. Notification  and consent  banners  \nThe technical recommendations provided in this guide can significantly reduce the \nprobability of an adversary exploiting a vulnerability on the network. Unfortunately, an \nadversary or insider may still find a weakness to \ncompromise , circumvent, or disrupt the network. \nHaving a notification banner can make cl ear what \nis permissible to anyone who accesses the \nsystem, and add any necessary notices and \ndisclaimers.  \n10.1 Present a notification b anner  \nDepending on the organization s requirements, a  \nnotification banner  can provide notice to users that connecting to the network device is \nfor authorized use only and that any use of the system is  subject to monitoring  for any \nauthorized purpose. A legally sufficient banner ensures the network owner and others, \nincluding the Go vernment, can take necessary steps to monitor and secure the network. \nHowever, the precise requirements for such a banner will vary by organization and \njurisdiction.  \nFor example, DoD elements must use a banner that meets the requirements of DoD \nInstructio n 8500.01. Other U.S. Government entities should implement the requirements \nof NIST SP800 -53, AC -8. For private sector entities, the Cybersecurity and \nInfrastructure Security Agency has issued very helpful guidance on developing an \nappropriate banner  [40]. \nNSA recommends that each device be configured to present the full notification  banner  \nwhene ver a user  logs into an information system or  connects to any remote service.  \nCisco IOS devices have two types of banners; the login banner is displayed prior to a \nuser logging in, and then the message of the day  is displayed after the user \nsuccessfully authenticates. At a minimum, the notification banner should be displayed to \nboth authorized and unauthorized users attempting to login. The same or additional \ninformation could be provided to authenticated users after logging in, if desired.  \nAdd a notifica tion banner, with the organization s banner appropriately inserted, prior to \nusers logging in with the following configuration command:  Display notifications \nof authorized use \nand consent to \nmonitoring.  \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  51 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nbanner login ^  \nINSERT NOTIFICATION BANNER HERE  \n^ \nNote : The caret symbol ( ^) is used as a delimiter so the banner can s pan multiple \nlines, assuming the caret symbol is not used in the banner itself. After this command is \ninserted into the configuration, the delimiter will generally appear as ^C instead of ^. \nDo not type in ^C as part of the command, otherwise the ban ner will begin with a C. \nAdd the same notification banner or additional information for authorized users who \nhave successfully authenticated with the following configuration command:  \nbanner motd ^  \nINSERT NOTIFICATION BANNER HERE  \nADDITIONAL INFORMATION  \n^ \nReturn to Contents  \n11. Conclusion  \nThe guidance in this report was generated from a depth and breadth of experience in \nassisting NSA customers with evaluating their networks and providing \nrecommendations to immediately harden ne twork devices. Along with essential \nmaintenance functions, administrators play a critical role in defending networks against \nadversarial threats. Following this guid e will assist these network defenders with \nimplementing  cybersecurity best practices, lower ing the risk against compromise and \nensuring a more secure and better -protected network.  \n  \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  52 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nAbbreviations  \nAAA Authentication, authorization, and accounting  \nACL Access control list \nAES Advanced Encryption Standard  \nARP Address Resolution Protocol  \nAUX Auxiliary  \nBGP  Border Gateway Protocol  \nCDP  Cisco Discovery Protocol  \nCEF Cisco Express Forwarding  \nCISA  Cybersecurity and Infrastructure Security Agency  \nCNSA  Commercial National Security Algorithm Suite  \nCNSSP  Committee on National Security Systems Policy  \nCON  Console  \nDHCP  Dynamic Host Configuration Protocol  \nDMZ  Demilitarized zone  \nDoS Denial of service  \nECC  Elliptic  curve cryptography  \nECP Elliptic  curve group modulo a prime  \nEIGRP  Enhanced Interior Gateway Routing Protocol  \nESP Encapsulating Security Payload  \nFTP File Transfer Protocol  \nHTTP  Hypertext Transfer Protocol  \nIETF  Internet Engineering Task Force  \nIKE Internet Key Exchange  \nIOS Internetwork Operating System  \nIP Internet Protocol  \nIPS Intrusion prevention system  \nIPsec  Internet Protocol Security  \nISAKMP  Internet Security Association and Key Management Protocol  \nISP Internet service provider  \nKEX Key exchange  \nLAN Local area network  \nLLDP  Link Layer Discovery Protocol  \nMAC  Media access control  \nMD5  Message Digest 5  \nMODP  Modular Exponent  \nNAC  Network access control  \nNAT Network address translation  \nNDI Network Device Integrity  \nNIDS  Network intrusion detection system  \nNIST  National Institute of Standards and Technology  \nNSA National Security Agency  \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  53 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nNSS National Security System(s)  \nNTP Network Time Protocol  \nOMB  Office of Management and Budget  \nOSPF  Open Shortest Path First  \nRIP Routing Information Protocol  \nRSA Rivest -Shamir -Adleman  \nSCP Secure Copy  Protocol  \nSFTP  Secure File Transfer Protocol  \nSHA Secure Hash Algorithm  \nSIEM  Security information and event management  \nSNMP  Simple Network Management Protocol  \nSSH Secure Shell  \nTCP Transmission Control Protocol  \nTFTP  Trivial File Transfer Protocol  \nTLS Transport Layer Security  \nUDP  User Datagram Protocol  \nuRPF  Unicast reverse -path forwarding  \nUTC Coordinated Universal Time  \nVLAN  Virtual local area network  \nVoIP  Voice  over IP \nVPN Virtual private network  \nVTY Virtual teletype  \n \n  \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  54 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nReferences  \nWorks c ited \n[1] Cybersecurity and Infrastructure Security Agency (2022), Layering Network Security Through \nSegmentatio n. Available at: https://www.cisa.gov/sites/default/files/publications/layering -network -\nsecurity -segmentation_infographic_508_0.pdf  \n[2] National Security Agency (2019), Segment Networks and Deploy Application -aware Defenses. \nAvailable at : https://www.nsa.gov/cybersecurity -guidance  \n[3] National Securit y Agency (2021), Selecting and Hardening Remote Access VPN Solutions. \nAvailable at: https://www.nsa.gov/cybersecurity -guidance  \n[4] Committee on National Security Systems (2016), CNSS Policy 15. Available at: \nhttps://www.cnss.gov/CNSS/issuances/Policies.cfm  \n[5] Corcoran, Jenkins, NSA (2021), Commercial National Security Algor ithm (CNSA) Suite \nCryptography for Internet Protocol Security (IPsec). Available at: \nhttps://datatracker.ietf.org/doc/html/draft -corcoran -cnsa -ipsec -profile  \n[6] National Se curity Agency (2020), Configuring IPsec Virtual Private Networks. Available at: \nhttps://www.nsa.gov/cybersecurity -guidance  \n[7] National Security Agency (2019), Mitigating Recent VPN Vulnerabilities. Av ailable at: \nhttps://www.nsa.gov/cybersecurity -guidance  \n[8] National Security Agency (2021), Eliminating Obsolete Transport Layer Security (TLS) Protocol \nConfigurations. Available at: https://www.nsa.gov/cybersecurity -guidance  \n[9] Arista Networks , Inc. (2022), Support Overview. Available at: https://www.arista.com/en/support/  \n[10] Aruba Networks  (2022), Aruba Support Services. Available at: \nhttps://www.ar ubanetworks.com/support -services/  \n[11] Broadcom  Inc. (2022), Support and Services. Available at: https://www.broadcom.com/support/  \n[12] Cisco Systems, Inc. (2022), Support & Downloads. Available at:  \nhttps://www.cisco.com/c/en/us/support/index.html  \n[13] Dell (2022), Support. Available at: https://www.dell.com/support/home/en -us/ \n[14] Extreme Networks (2022) , Support. Available at: https://www.extremenetworks.com/support/  \n[15] F5, Inc. (2022), Support | Services. Available at: https://www.f5.com/services/support/  \n[16] Fortinet, Inc. (2022), FortiCare Technical Support and Services. Available at: \nhttps://www.fortinet.com/support  \n[17] Hewlett Packard Enterprise Development LP (2022), Services and Support. Available at: \nhttps:/ /www.hpe.com/us/en/services.html  \n[18] International Business Machines Corporation (2022), IBM Support. Available at: \nhttps://www.ibm.com/mysupport/  \n[19] Juniper Networks, Inc. (2022), Support. Available at: https://support.juniper.net/support/  \n[20] Linksys Holdings (2022 ), Official Linksys Support Site. Available at: \nhttps://www.linksys.com/us/support/  \n[21] NETGEAR (2022), Support. Available at: https://www.netgear.com/support/  \n[22] Palo Alto Networks (2022), Customer Support. Available at: \nhttps://support.paloaltonetworks.com/support/  \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  55 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \n[23] Riverbed Technology (2022), Riverbed Support. Available at: https://support.riverbed.com/  \n[24] CommScope, Inc. (2022), Ruckus Wireless Support. Available at: \nhttps://support.ruckuswireless.com/  \n[25] SonicWall (2022), Sup port Portal & Downloads. Available at: https://www.sonicwall.com/support/  \n[26] TRENDnet Inc. (2022), Customer Support. Available at: https://www.trendnet.com/support/  \n[27] Eaton (2022), Help Center | Tripp Lite. Available at: https://www.tripplite.com/support/  \n[28] Ubiqu iti Inc. (2022), Ubiquiti Support and Help Center. Available at: https://help.ui.com/hc/en -us/ \n[29] WatchGuard Technologies, Inc. (2022), WatchGuard Support. Available at: \nhttps://www.watchguard.com/wgrd -support/overview  \n[30] National Security Agency (2016), Network  Device Integrity (NDI) Methodology. Available at: \nhttps://media.defense.gov/2023/Oct/06/2003315573/ -1/-\n1/0/NETWORK%20DEVICE%20INTEGRITY%20NDI%20METHODOLOGY.PDF  \n[31] National Security Agency (2 016), Network Device Integrity (NDI) on Cisco IOS devices. \nAvailable at: https://media.defense.gov/2023/Oct/06/2003315572/ -1/-\n1/0/NETWORK%20DEVICE%20INTE GRITY%20ON%20CISCO%20IOS%20DEVICES.PDF  \n[32] National Security Agency (2016), Validate Integrity of Hardware and Software. Available at: \nhttps://media.defense.gov/2023/Oct/06/2003315571/ -1/-\n1/0/VALIDATE%20INTEGRITY%20OF%20HARDWARE%20AND%20SOFTWARE.PDF   \n[33] National Security Agency (2022), Cisco Password Types: Best Practices. Available at: \nhttps://www.nsa.gov/cybersecurity -guidance  \n[34] Office of Management and Budget (2021), Improving the Federal Government s Investigative \nand Remediation Capabilities Related to Cybersecurity Incidents. Available at: \nhttps://www.whitehouse.gov/wp -content/uploads/2021/08/M -21-31-Improving -the-Federal -\nGovernments -Investigative -and-Remediation -Capabilities -Related -to-Cybersecurity -Incidents.pdf  \n[35] Cooley, D, NSA (2021), Commercial National Security Algorithm (CNSA) Suite Profile for TLS \nand DTLS 1.2 and 1.3. Available at: https://datatracker.ietf.org/doc/html/draft -cooley -cnsa -dtls-\ntlsprofile  \n[36] Gajcowski, Jenkins, NSA (2021), Commercial National Security Algorithm (CNSA) Suite \nCryptography for Secure She ll (SSH). Available at: https://datatracker.ietf.org/doc/html/draft -\ngajcowski -cnsa -ssh-profile  \n[37] National Institute for Standards and Technology (2020), Special Publicatio n 800 -52 Rev. 2: \nGuidelines for the Selection, Configuration, and Use of Transport Layer Security (TLS) \nImplementations. Available at: https://csrc.nist.gov/publications/detail /sp/800 -52/rev -2/final  \n[38] Cisco Systems, Inc. (2017), Cisco Smart Install Protocol Misuse. Available at: \nhttps://tools.cisco.com/security/center/conten t/CiscoSecurityAdvisory/cisco -sa-20170214 -smi  \n[39] National Security Agency (2017), Cisco Smart Install Protocol Misuse. Available at: \nhttps://www.nsa.gov/cybersecurity -guidance  \n[40] Cybersecurity and Infra structure Security Agency (2022), Guidance on Consent Banners. \nAvailable at: https://www.cisa.gov/publication/guidance -consent -banners  \n\n \n \nU/OO/118623 -22 | PP-22-0293  | OCT  2023  Ver. 1.2  56 \nNational Security Agency | Cybersecurity Technical Report  \nNetwork Infrastructure Security Guid e \nRelated g uidance  \n Biden (2021), Executive Order 14028: Improving the Nation s Cybersecurity. Available at: \nhttps://www.federalregister.gov/documents/2021/05/17/2021 -10460/improving -the-nations -\ncybersecurity  \n National Institute of Standards and Technology (2020), Special Publication 800 -207: Zero Trust \nArchitecture. Available at: https://www.nist.gov/publications/zero -trust-architecture  \n Defense Information Systems Agency (DISA) and National Security Agency (NSA) Zero Trust \nEngineering Team (2021), Department of Defense (DOD) Zero Trust Refer ence Architecture. \nAvailable at: \nhttps://dodcio.defense.gov/Portals/0/Documents/Library/(U)ZT_RA_v1.1(U)_Mar21.pdf  \n National Institute for Standards and Technology (2020), Special Publication 800 -63B: Digital \nIdentity Guidelines - Authentication and Lifecycle Management. Available at: \nhttps://pages.nist.gov/ 800-63-3/sp800 -63b.html  \n National Security Agency (2019 ), Con tinuously Hunt for Network Intrusions . Available at: \nhttps://www.nsa.gov/cybersecurity -guidance  \n National Security Agency (2021), Embracin g a Zero Trust Security Model. Available at: \nhttps://www.nsa.gov/cybersecurity -guidance  \n National Security Agency (2020), Hardening Network Devices. Available at: \nhttps://www.nsa.gov/cybersecurity -guidance  \n\n",
  "cves": [],
  "techniques": [],
  "advisory": "cybersecurity-alerts",
  "title": "ctr_nsa_network_infrastructure_security_guide_20220615",
  "source": "nsa",
  "id": "80c96ac51b92bf3c812b989a0ab1a2c7fee495f303018ac456b9e9f81a77a511"
}