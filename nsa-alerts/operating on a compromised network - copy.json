{
  "markdown": "  \nU/OO/177285 -16 | MIT-002TB -2014  | JULY 2014  \nNational Security Agency  | Cybersecurity Information  \nOperating on a Compromised Network  \nThis paper provides guidance for operating a compromised network for some limited period of time until trust can be \nreestablished, while minimizing information loss and the damage a cyber -adversary can inflict. The guidance ranges from \nstandard network security best practices to actions t hat are focused specifically on reducing the risk of operating on the \ncompromised network. Although this paper is primarily written for system administrators and end users, information \nsecurity managers, network owners, and decision makers must be involved  in implementing this guidance to ensure the \nbest balance of mission and security.  \nNetworks are complex and diverse, as are the types and severity of threats and attacks against them. Therefore, the \nguidance below is more generic. Some of the mitigation a ctions will improve overall security with little to no cost and \nshould be implemented by default. Other mitigations may have major impact on operational usage and require careful \nthought.   \nStrike a balance between doing too little and doing too much. Over -reacting to an incident could reduce mission capability \nor result in a loss of functionality that endangers lives, operations and property; underreacting could expose missions to \nfurther compromise.  \nAssumptions  \nThe following are assumptions for this paper : \n Best effort has been undertaken to detect, prevent and clean any known infections from the network. However, the \nnetwork is still assumed to be compromised because of what is not known. Confidentiality, integrity, or availability \ncompromises are all assu med to be possible.  \n There are activities underway to rebuild and reestablish the necessary trust in the compromised network (e.g. re -\nimaging/replacement of computing platforms and network fabric) while it is being used.  \n There will be some reduction in func tionality available to network users, and using the network may be more \ninconvenient (e.g. use of specific types of removable media may be restricted, certain protocols may not be allowed, \nand some applications may not be available).  \nGeneral Guidance  \nDevel op an action plan for operating on the compromised network.  The plan should prioritize mitigation actions tailored for \nthe specific network and situation, assign responsibility for each action, and identify plans for overall reestablishment of \ntrust on the  network.  Do not universally apply all of the mitigation actions below without thorough consideration. Some \nmitigations may not be able to be implemented in certain situations because they would make the network/system \nunusable.  If possible, test the mitig ations on another network first.  The following table provides specific mitigation items. \nEach item is annotated with:  \n Importance of implementation categorized as high (H), medium (M), or low (L)  \n Whether the mitigation should be considered a standard securi ty practice (SSP) implemented at all times or just used \nwhen the network is considered compromised (CSP)  \n Whether the mitigation needs to be primarily implemented by an information assurance manager (M), system \nadministrator (SA), or user (U)  \n\n \n \n U/OO/177285 -16 | MIT-002TB -2014  | JULY 2014  2 \nNSA | Operating on a Compromised Network  \nItem \n# Mitigation Guidance  Implementation \nImportance  \n(High, M edium , \nor Low) Standard \nSecurity Practice \n(SSP) or \nCompromised \nSecurity Practice \n(CSP)  Implemented by \nIA Manager (M), \nSystem \nAdministrator \n(SA), and/or \nUser  \n1. Establish out of band communications, \nespecially when discussing any activity \nassociated with the compromise or other \nsensitive topics.  Consider using phones or \nfax on a separate network for the most \ncritical communications instead of e -mail or \nother communications services on the \ncompromised n etwork.  If e-mail \ncommunication is necessary, encrypt and \ndigitally sign e -mail if possible.  High CSP User  \n2. Establish and train dedicated network \nsecurity teams that are responsible for \nproactively monitoring, implementing, \nenforcing, and otherwise working security \nfor the compromised network.  Additional \nhelp desk staffing will also be necessary to \naddress increased user requests and \nproblems.  High CSP M \n3. Immediately inform users of the severity of \nthe threat, the restrictions under which they \nare operating, the reasons for the added \nsecurity measures, and the anticipated \neffect on their mission activities.  Clearly \nidentify actions they will be required to take \nto help reduce risk to mission activities.   High CSP M, SA  \n4. Follow organizational pro cedures for dealing \nwith any newly infected machines found on \nthe network.  If no procedures exist, \ndisconnect the machine from the network \nand leave it powered up to preserve \nmemory c ontents for forensics analysis.  High SSP SA \n5. Identify critical assets and remove them \nfrom the network (e.g. documentation, \nsource code).  These should only be re -\nintroduced after a thorough risk analysis has \nbeen performed after the compromise. \nStrongly consider keeping these critical \nassets on a physically separated network . \nAt a minimum, utilize a logically separated \nnetwork to protect the assets.  High CSP M, SA  \n\n \n \n U/OO/177285 -16 | MIT-002TB -2014  | JULY 2014  3 \nNSA | Operating on a Compromised Network  \nItem \n# Mitigation Guidance  Implementation \nImportance  \n(High, M edium , \nor Low) Standard \nSecurity Practice \n(SSP) or \nCompromised \nSecurity Practice \n(CSP)  Implemented by \nIA Manager (M), \nSystem \nAdministrator \n(SA), and/or \nUser  \n6. Ensure that anti -virus (AV) and anti -spyware \nsoftware capable of detecting, preventing, \nand cleaning known malicious code is \ndeployed to all servers and worksta tions.  \nUpdate AV signature files on a regular \nbasis.  Require that complete scans are \nregularly scheduled and successfully \ncompleted.  Consider using multiple vendor \nproducts to increase the chances of \ndetecting or preventing new infections.   High SSP SA \n7. Leverage threat intelligence clouds (e.g., AV \nfile reputation and DNS reputation services) \nto obtain protection from the most recent \nthreats before they become available in AV \nand security product updates.  High SSP SA \n8. Force a password change across all \nnetworks, preferably just after the detection \nof the compromise and again after other \nhigh importance mitigation actions are \nimplemented. This includes all computer \naccounts, databases, remote logons to \nnetwork components, etc. On Windows  \nsystems, acc ounts with smart cards actually \nhave an associated Windows password \nhash, which should be flushed and \nregenerated.  Consider implementing a \npolicy for more frequent password changes. \nPassword changes on accounts, such as \ndatabase accounts that are accessed via \napplications, must be coordinated with \napplication owners to avoid users of the \napplication being locked out.  High CSP SA, User  \n9. Apply and use all applicable security \nconfiguration guidance from Microsoft and \nother software vendors for servers and \nclient machines to the greatest extent \npossible.  Use the High security settings.  \nUse automated mechanisms (e.g. Microsoft \nGroup Policy or other security configuration \ntools) to control configurations where \npossible.  High SSP, CSP \n(highest setting)  SA \n\n \n \n U/OO/177285 -16 | MIT-002TB -2014  | JULY 2014  4 \nNSA | Operating on a Compromised Network  \nItem \n# Mitigation Guidance  Implementation \nImportance  \n(High, M edium , \nor Low) Standard \nSecurity Practice \n(SSP) or \nCompromised \nSecurity Practice \n(CSP)  Implemented by \nIA Manager (M), \nSystem \nAdministrator \n(SA), and/or \nUser  \n10. Lock down web browser security settings to \nHigh security, and di sable all JavaScript, \nActiveX  controls, and similar scripting \ncapabilities. Allow such scripts by exception \nonly when it is known that a critical mission \nfunction cannot be performed with out them. \nAssess user complaints to determine the \nneed to readjust exceptions  High SSP, CSP \n(highest setting)  SA \n11. Ensure all software used on the network is \nup-to-date on patches and at the most \ncurrent version as much as possible  High SSP SA \n12. Deploy an anti -exploitation tool, such as \nMicrosofts Enhanced Mitigation Experience \nToolkit (EMET), to protect against common \nclasses of exploitation.  High SSP SA \n13. Restrict the usage of and access to \nadministrative accounts on the network.  \nRemove standard users from privileged \nsecurity groups. Restrict systems that \nprivileged accounts can access.  Ensure \nadministrative accounts do not have e -mail \nor Internet access.  High SSP SA \n14. Minimize services and applications being \nused on the network.  Turn off most services \nunless necessary for mission critical \nactivities, remove \nunnecessary/unauthorized programs, and \ndisab le unneeded interfaces in BIOS . Use \ngroup policy where possible to enforce this  High SSP SA \n15. Mark system backups made between the \ntime of the infection and its discovery as \nhigh risk, and label with enough information \nthat administrators can recognize the \nreason for special treatment.  If data from \nthese backups is needed, it should be \nrestored using an isolated/standalone \nnetwork and e valuated and cleaned.  These \nbackups must not be destroyed.  A new, full \nset of backups should be performed and \nmarked accordingly for replaced, cleaned or \nrepaired machines.  High CSP SA \n\n \n \n U/OO/177285 -16 | MIT-002TB -2014  | JULY 2014  5 \nNSA | Operating on a Compromised Network  \nItem \n# Mitigation Guidance  Implementation \nImportance  \n(High, M edium , \nor Low) Standard \nSecurity Practice \n(SSP) or \nCompromised \nSecurity Practice \n(CSP)  Implemented by \nIA Manager (M), \nSystem \nAdministrator \n(SA), and/or \nUser  \n16. Maintain and actively monitor a centralized \nlogging solution that keeps track of all \nanomalous and potentially malicious \nactivities on their network. In addition to \nlogging, network packet capture can provide \ninvaluable information to incident \nresponders.  Ensure that all relevant devices \nhave logging enabled and aggregat ed to a \nSecurity Information and Event \nManagement (SIEM) system or other \ncentralized monitoring solution.  High SSP SA \n17. Implement an SSL/TLS inspection capability \nto gain full insight into the traffic passing \nthrough the network perimeter.  Enable the \nSSL/TLS inspection feature of the \norganizations web proxy devices. Ideally, \nall connections should be evaluated to \ndetermine whether or not they are permitted \nby policy and reveal evidence of malicious \ncontent.  At a minimum, a more fine -grained \nInternet a ccess policy should be defined to \nidentify which types of traffic would be \nallowed to pass, which types of traffic would \nbe inspected, and which types of traffic \nwould be blocked.  High CSP SA \n18. Implement integrity monitoring to detect \nchanges in files t hat should not normally \nchange (e.g. operating system files). When \npossible, use tools that create a trusted \nbaseline of cryptographic hashes that are \ncompared to periodic file snapshots to \nfind/detect changes.  The process should \nalso list new files and fi les which have been \ndeleted  High SSP SA \n19. Use secure, authenticated login for remote \naccess to servers, desktops, network \ndevices and other network equipment \ninstead of plain text services such as Telnet \nand FTP.  For devices that cannot support \nsecure l ogin, implement strict IP address \nrestrictions to permit remote access only \nfrom a small set of secure local servers.  High SSP SA \n\n \n \n U/OO/177285 -16 | MIT-002TB -2014  | JULY 2014  6 \nNSA | Operating on a Compromised Network  \nItem \n# Mitigation Guidance  Implementation \nImportance  \n(High, M edium , \nor Low) Standard \nSecurity Practice \n(SSP) or \nCompromised \nSecurity Practice \n(CSP)  Implemented by \nIA Manager (M), \nSystem \nAdministrator \n(SA), and/or \nUser  \n20. Limit workstation -to-workstation \ncommunication to thwart an adversarys \nability to move laterally within the network.  \nMicrosoft Windows systems can be \nconfigured to limit where workstations can \ncommunicate on the network via Windows \nFirewall or Group Policy security settings.  \nAlternately, logical segmentation (e.g. via \nvirtual LANs) can serve to limit \ncommunication.   High SSP SA \n21. Deploy a host intrusion prevention (HIPS) \ncapability on workstations and servers.  \nMore effective than standard signature -\nbased capabilities, HIPS technology \nfocuses on threat behaviors and can better \nscale to entire sets of intrusion activitie s. High SSP SA \n22. Implement application whitelisting to allow a \nlimited set of approved programs to run, \nwhile all other programs and most malware \nare blocked from running by default.  Use a \nthird-party application (e.g. a host base d \nsecurity application)  such as Microsofts \nAppLocker  on Windows operating \nsystems.  High SSP SA \n23. Restrict and/or limit the use of removable \nmedia and devices that connect to USB \nports.  Ensure that any media used is \npurchased or acquired only from authorized \nsources.  When possible, use third  party \nsoftware or, for Win dows systems, Active \nDirectory  Group Policy to control use of \nremovable media and USB access. \nConsider treating thumb  drives and similar \nremovable media as accountable property \nand registered to a specific own er for a \nspecific purpose.  Scan and clean these \ndevices on a trusted scanner system that \nimplements multiple anti -virus (AV) software \nafter each use.  Do not allow personal \nelectronic devices (e.g. phones, tablets) to \nconnect via USB, even to charge the \ndevices.  High SSP SA, User  \n\n \n \n U/OO/177285 -16 | MIT-002TB -2014  | JULY 2014  7 \nNSA | Operating on a Compromised Network  \nItem \n# Mitigation Guidance  Implementation \nImportance  \n(High, M edium , \nor Low) Standard \nSecurity Practice \n(SSP) or \nCompromised \nSecurity Practice \n(CSP)  Implemented by \nIA Manager (M), \nSystem \nAdministrator \n(SA), and/or \nUser  \n24. Revalidate all accounts, including those for \nusers, administrative roles, devices, and \nautomated services.  This includes accounts \non servers, computers, and routers and \nother network components, especially \nwhere remote login by those accounts is \npossible.  Disable all accounts that cannot \nbe validated.  High SSP SA \n25. Use encrypted file storage based on \nindividual user keys (e.g. Public Key \nInfrastructure - PKI) where possible to limit \nfuture loss of data.  Move all user data \nstorage from local storage (e.g. C drive) to \nnetwork storage to minimize storage \nlocations and to ease \nreimaging/replacement of infected \nmachines.  Ensure all such user data is \nscanned and cleaned  Medium  CSP SA, User  \n26. Ensure that all wireless capabilities are \ndisabled on laptops, routers, etc ., or that \ntheir need is validated and that they are \nproperly secured.  When possible, disable \nwireless in BIOS or in the operating system \ninstead of in an application.  Consider \nestablishing monitoring for unauthorized \nlocal wireless access activities.  Medium  CSP SA \n27. Consider segmenting the network to help \nisolate critical servers or other platforms.  \nFor example, critical mission servers could \nbe firewalled off and controlled to limit \naccess to them.  System administration \nworkstations could be isolated in a similar \nway. Medium  SSP SA \n28. Where already available in existing network \nfabric, use Network Access Control \ncapabilities to enforce configuration level of \ncomputer platforms and to detect and \npreven t connection of unauthorized network \ndevices.  Medium  SSP SA \n\n \n \n U/OO/177285 -16 | MIT-002TB -2014  | JULY 2014  8 \nNSA | Operating on a Compromised Network  \nItem \n# Mitigation Guidance  Implementation \nImportance  \n(High, M edium , \nor Low) Standard \nSecurity Practice \n(SSP) or \nCompromised \nSecurity Practice \n(CSP)  Implemented by \nIA Manager (M), \nSystem \nAdministrator \n(SA), and/or \nUser  \n29. Restrict remote activity.  Access to systems \nfrom outside of an enclave should only be \nallowed from organization owned devices \nwith two -factor authentication through a \nhardened VPN gateway with split -tunneling \nprohibited. Implement a Virtual Desktop \ntype system ( e.g. Citrix, Termina l Server, \nOutlook Web Access, etc.) on this VPN \ngateway to establish security enforcement \nand monitoring points.  If possible, restrict \nVPN usage to users that require it (e.g. \ntraveling users), and force other users to \ncome into the office to cut down on V PN \nconnection attempts.  This allows VPN \nconnections to be analyzed to look for \nanomalies, such as logins from IP \naddresses where organization personnel \nare not physically located.  Medium  SSP, CSP \n(discontinue use \nof VPN)  SA \n30. In Windows network environm ents, closely \nre-examine all trust relationships for the \nvarious Windows domains, particularly \nthose in a transitive trust relationship.  \nConsider severing the trust to prevent \nspread of the c ompromise to other \nnetworks . Medium  SSP, CSP \n(severing trust)  SA \n31. Consider creating a Virtual Private Network \n(VPN) on top of the compromised network \nfor use by the most critical users or \nmissions.  As the workstations of critical \nusers are repaired they could be added to \nthis VPN until such time as the entire \nnetwork has been repaired.  Low CSP SA \n32. Require users to power cycle their \ncomputers at least weekly, and require that \nthey select Restart when they logoff rather \nthan Logoff to reduce the persistence of \nmemory based attacks.  Low CSP User  \n33. Ident ify security critical registry  \nkeys/settings and set  Group Policy to audit \nchanges to them.  The policy would cause \nentries in the security event log which could \nthen be reviewed regularly to determine \nanomalous behavior.  This is in addition to \nAV and HIPS.  Perhaps limit this to the most \ncritical machines on the network (e.g. \nservers, critical users).  Low CSP SA \n\n \n \n U/OO/177285 -16 | MIT-002TB -2014  | JULY 2014  9 \nNSA | Operating on a Compromised Network  \nReestablishing t rust in Critical Network Components  \nNote that the trust re -establishment areas and activities suggested here are not all inclusive.  Activities needed to \ncompletely clean the network are b eyond the scope of this paper.  \nReestablish/regain positive control of network management and administration.   \nSystems used by system administrators for performing administrative functions must be repl aced or repaired. Other \nassets that must be considered for earl y replacement or repair are as follows:  \n Systems performing important network and security management activities such as domain controllers and \nworkstation s used for PKI administration  \n Workstati ons used by critical users such as an important senior officials who are more likely to b e targeted than \naverage users  \n Servers providing critical mission services such as command and control, strategic communications, Ac tive Directory, \ne-mail, etc.  \n Critica l network infrastructure components (e.g. certain routers, switches, firewalls)   \nReplace and/or repair devices  \nSome critical network assets must be trusted even on a compromised network. Such assets should be replaced or \nrepaired as soon as possible, even  if they are not suspected of having been compromised. T o replace or repair a device:  \n Re-flash the BIOS wi th a known good configuration. Configure BIOS secur ity/password when available.  \n Replace the hard drive fo r the most critical platforms. Overwriting ha rd drives using organization approved methods \nmay be acceptable for s ome less critical platforms.  \n Reimage the hard drive. Create a new secure baseline image that includes an operating system and approved \napplications that are hardened according to security  base practice con figurations mentioned above.  \n Use the latest versions of operating systems and applications. Windows client operating systems should be at \nleast Windows 7 (for workstations) or Windows Server 2008 R2 (for servers) with the latest service  pack. If \npossible, client machines should be upgraded to Windows 8.1 or later to take advantage of newer security \nfeatures.  \n Within the image, include best practice security capabilities such as application whitelisting, AV, and anti -\nexploitation features described above. Establish an automated process to measure and report the systems state \nof compliance to the established security baselines on a weekly basis.  \n Dont use backups to reimage as these may be infected. Re -imaging must be done off -line (i.e. in  a separate \nprovisioning lab, not on the operational network) to reduce the risk of re -infection.  Reestablish system backups as \nnecessary based  on the reimaged/new machines.  \nDisclaimer of Endorsement  \nThe information and opinions contained in this document are provided \"as is\" and without any warranties or guarantees. Reference herein to any specific \ncommercial products, process, or service by trade name, trademark, manufacturer, or otherwise, does not constitute or imply i ts endorsement, \nrecommendation, or favoring by the United States Government, and this guidance shall not be used for advertising or product endorsement purposes . \nWindows, Windows 7, Windows Server 2008 , JavaScript, ActiveX , AppLocker, and Active Directory  are registered trademarks of Micros oft Corp. BIOS  is \na registered trademark of BioSmart Sciences, Inc.  \nContact  \nClient Requirements / General Cybersecurity Inquiries: Cy bersecurity Requirements Center , 410 -854-4200,  Cybersecurity_Requests@nsa.gov   \nMedia inquiries / Press Desk: 443 -634-0721, MediaRelations@nsa.gov   \n\n",
  "cves": [],
  "techniques": [],
  "advisory": "cybersecurity-alerts",
  "title": "operating on a compromised network - copy",
  "source": "nsa",
  "id": "45541f55d31117dfe78108c749fac4bc61acb4e8117e8dac6001dcd1e8693d58"
}