{
  "markdown": " TLP: CLEAR  \n \n \n \n \nDisclaimer:  This document is marked TLP:CLEAR. Disclosure is not limited. Sources may use TLP:CLEAR when \ninformation carries minimal or no foreseeable risk of misuse, in accordance with applicable rules and procedures for \npublic release. Subject to standard copyright rules, TLP:CLEAR information may be distributed without restriction. For \nmore information on the Traffic Light Protocol, see cisa.gov/tlp/ . \n \n TLP: CLEAR  \n \nCHANGE RECORD  \nVersion  Date  Revision/Change \nDescription  Section/Page Affected  \n1.0 September  2020 Initial version   \n2.0 February  2023    \n  \nPublication: October  2023 #Stop Ransomware Guide  \n\n\nTLP: CLEAR  \nPage | 2 TLP: CLEAR  Change Record  \nVersion  Date  Revision/Change Des cription  Section/Page Affected  \n1.0 September  2020  Initial Version   \n2.0 May 2023  See Whats New on p.3  Updates throughout  \n3.0 October 2023   Initial Access Vector  bullet \nadded for inter net-facing \nvulnerabilities  \n Updated guidance on \nhardening SMB  \n Added information about threat \nactors impersonating \nemployees  \n Added guidance on hardening \nweb browsers  \n Added a bullet about abnormal \namounts of data outgoing over \nany ports.  \n Added Acknowledgements \nsection   Initial Access Vector: Internet -\nFacing Vulnerabilities and \nMitigations pg. 7  \n Part 1: Ransomware and Data \nExtortion Preparation, Prevention, \nand Mitigation Best Practices, \npages 8, and 9  \n Initial Access Vector: Advanced \nForms of Social Engineering pg. \n14 \n General Best Practices and \nHardening Guidance, page 20  \n Part 2: Ransomware and Da ta \nExtortion Response Checklist  pg. \n24 \n Acknowledgements, page 30  \n \n\nTLP: CLEAR  \nPage | 3 TLP: CLEAR  INTRODUCTION  \nRansomware is a form of malware designed to \nencrypt files on a device, rendering them  and the \nsystems  that rely on them unusable. Malicious \nactors then demand  ransom in exchange for \ndecryption.  Over time, malicious actors have \nadjusted their r ansomware tactics to be more \ndestructive and impactful  and have also exfiltrate d \nvictim data and pressur ed victims to pay  by \nthreatening to release  the stolen data . The \napplication of both tactics is known as double \nextortion . In some cases, malicious actors may \nexfiltrate data and threaten to release it as their \nsole form of extortion  without employing \nransomware . \nThese ransomware and associated data breach \nincidents can severely impact business processes \nby leaving organizati ons unable to access  \nnecessary  data to operate and deliver mission -\ncritical service s. The economic and reputational \nimpacts of ransomware and data extortion  have \nproven challenging and costly for organizations of \nall sizes  throughout the initial disruption  and, at \ntimes, extended recovery.  \nThis guide is an update to the Joint Cybersecurity \nand Infrastructure Security Agency (CISA)  and \nMulti -State Information Sharing & Analysis Center \n(MS-ISAC)  Ransomware Guide  released in \nSeptember 2020 (see Whats New ) and was \ndeveloped through the JRTF . This guide includes  \ntwo primary resources:  \n Part 1: Ransomware and Data Extortion \nPrevention Best Practices  \n Part 2: Ransomware and Data Extortion Response Checklist  \nPart 1 provides guidance for all organizations to reduce the impact and likelihood of ransomware  \nincidents  and data extortion , including best practices to  prepar e for, prevent,  and mitigate these \nincidents . Prevention best practices  are grouped by common initial access vectors . Part 2 includes a \nchecklist of best practices for responding to these incidents.  \nThese ransomware and data extortion  prevention and response  best practices and recommendations \nare based on operational insight from CISA, MS -ISAC, the  National Security Agency (NS A), and  the \nFederal Bureau of Investigation ( FBI), hereafter referred to as the authoring organizations.  The This guide was developed through  the U.S. \nJoint Ransomware Task Force (JRTF) . \nThe JRTF , co-chaired by CISA and FBI, is an \ninteragency , collaborative effort to combat the \ngrowing threat of ransomware attacks. The \nJRTF was launched in response to a series of \nhigh-profile ransomware attacks on U.S. critical \ninfrastructure and government agencies.  The \nJRTF :  \n1. Coordinate s and streamline s the U .S. \nGovernment's response to ransomware \nattacks and facilitate s information sharing \nand collaboration between government \nagencies and private sector partners.  \n2. Ensures operational coordination for \nactivities  such as  developing and sharing \nbest practices for preventing and \nresponding to ransomware attacks, \nconducting joint investigations and \noperations against ransomware threat \nactors, and providing guidance and \nresources to organizations that have been \nvictimized by ransomware.  \n3. Represents a significant step forward in \nenabli ng unity of effort across the U .S \nGovernment's efforts to address the \ngrowing threat of ransomware attacks.  \nFor more info on JRTF, see  cisa.gov/joint -\nransomware -task-force . \n\nTLP: CLEAR  \nPage | 4 TLP: CLEAR  audience for this guide includes information technology (IT) professionals as well as others within an \norganization involved in developing cyber incident response policies and procedures or coordinating \ncyber incident response.  \nThe authoring organizations recommend that organizations take the following initial steps  to prepare \nand protect their facilities, personnel , and customers from cyber and ph ysical security threats and other \nhazards : \n Join a sector -based information sharing and analysis center (ISAC) , where eligible , such as:  \no MS-ISAC  for U.S. State, Local, Tribal, & Territoria l (SLTT) Government Entities - \nlearn.cisecurity.org/ms -isac-registration . MS-ISAC membership is open to \nrepresentatives from all 50 states, the District of Columbia, U.S. Territories, local and \ntribal governments, public K -12 education entities, public instit utions of higher education, \nauthorities, and any other non -federal public entity in the United States.  \no Election s Infrastructure Information Sharing & Analysis Center (EI -ISAC ) for U.S. \nElections Organizations - learn.cisecurity.org/ei -isac-registration . \n \nSee the National Council of ISACs  for more information.  \n Contact CISA at CISA.JCDC@cisa. dhs.gov  to collaborate on information sharing, best \npractices, assessments, exercises, and more . \n Contact your local FBI field office  for a list of points of contact  (POC s) in the event of a cyber  \nincident.  \nEngaging with peer organizations and  CISA enables  your organization to receive critical  and timely  \ninformation and access to services for managing  ransomware and other cyber threats.  \nWhats New  \nSince the initial release of the Ransomware Guide  in September 2020, ransomware actors have \naccelerated  their tactics and techniques.  \nTo maintain relevancy, add perspective, and maximize the effectiveness of this guide, the follo wing \nchanges have been made:  \n Added  FBI and NSA as co -authors based on \ntheir contributions and operational insight.  \n Incorporate d the #StopRansomware  effort  into \nthe title . \n Added recommendations for  prevent ing \ncommon initial infection vectors , includ ing \ncompromised credentials  and advanced forms \nof social engineering.  \n Updated recommendations to address cloud backups and zero trust architecture (ZTA).  \n Expanded the ransomware response checklist with threat hunting tips for detection and \nanalysis.  \n Mapped recommendations to CISAs Cross -Sector Cybersecurity Performance Goals (CPGs) . #StopRansomware is CISA and FBI s effort \nto publish advisories for network defenders \nthat detail network defense information \nrelated to various ransomware variants and \nthreat actors. Visit stopransomware.gov  to \nlearn more and to read the joint advisories.  \n\nTLP: CLEAR  \nPage | 5 TLP: CLEAR  Part 1: Ransomware and Data Extortion  Preparation, Prevention , and \nMitigation  Best Practices  \nThese recommended best practices  align with the CPGs developed by CISA and the National Institute \nof Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections \nthat CIS A and NIST recommend all organizations implement. CISA and NIST based the CPGs on \nexisting cybersecurity frameworks and guidance to protect against the most common and impactful \nthreats, tactics, techniques, and procedures. For more information on the CPGs  and recommended \nbaseline protections , visit CISAs Cross -Sector Cybersecurity Performance Goals . \nPreparing for Ransomware  and Data Extortion Incidents  \nRefer to the best prac tices and references listed in this section  to help manage the risk s posed by \nransomware and  to drive a  coordinated and efficient response for your organization in the event of  an \nincident. Apply these practices to the greatest extent possible pending the  availability of organizational \nresources . \n Maintain offline, encrypted backups of critical data , \nand regularly test the availability and integrity of \nbackups in a disaster recovery scenario  [CPG 2.R ]. \nTest b ackup procedures on a regular basis. It is \nimportant that backups are maintained offline , as most  \nransomware actors attempt  to find and  subsequently  \ndelete  or encrypt  accessible backups  to make \nrestoration impossible unless the ransom is paid . \nRansomw are actors often hunt for and collect credentials stored in the targeted environment \nand use those credentials to attempt to access backup solutions ; they also use publicly \navailable exploits to target unpatched backup solutions.  \no Maintain and regularly upd ate gold en images of critical systems. This includes \nmaintaining image  templates that have a preconfigured operating system (OS) and \nassociated software applications that can be quickly deployed to rebuild a system, such \nas a virtual machine or server  [CPG 2.O ]. \n Use infrastructure as code (IaC) to deploy and update cloud resources and keep \nbackups of template files offline to quickly redeploy resources. IaC  code should  \nbe version controlled and changes to the templates should be audited.  \n Store applicable source code or executables with offline backups (as well as \nescrowed  and license agreement s). Rebuild ing from system images  is more \nefficient , but some imag es will not install on different hardware or platforms \ncorrectly; having separate access to software help s in these cases.  Automated c loud backups may not \nbe sufficient  because  if local files \nare encrypted by an attacker, these \nfiles will be synced to the cloud , \npossibly overwriting unaffected \ndata.  \n \n \n\nTLP: CLEAR  \nPage | 6 TLP: CLEAR  o Retain backup hardware to rebuild systems if rebuilding the primary system is not \npreferred.  \n Consider replacing  out-of-date h ardware that inhibits restoration  with up -to-date \nhardware , as older hardware can present installation or compatibility hurdles \nwhen rebuilding from images.  \no Consider using a multi -cloud solution to avoid vendor lock -in for cloud -to-cloud backups \nin case  all accoun ts under the same vendor are impacted.  \n Some cloud vendors offer immutable storage solutions that can prot ect stored \ndata without the need for a separate environment.  Use immutable storage with \ncaution as it does not meet compliance criteria for certain regulations and \nmisconfiguration can impose significant cost.  \n Create, maintain, and regularly exercise a basic cyber incident response plan  (IRP)  and \nassociated communications plan that includes response and notification procedures  for \nransomware and data extortion/ breach incident s [CPG 2.S ]. Ensure a hard copy of the plan  and \nan offline version is available . \no Provide data breach notifications to third parties and regulators consistent with law.  \no Ensure t he IRP  and communications plan are reviewed and approved by the CEO , or \nequivalent , in writing  and that both are  reviewed and understood across  the chain of \ncommand . \no Review available incident response guidance, s uch as  the Ransomware Response \nChecklist in this guide  and Public Power Cyber Incident Response Playbook  to: \n Help your organization better organize around cyber incident response . \n Draft cyber incident holding statements . \n Develop a cyber IRP. \no Include organizational communications procedures as well as templates for cyber \nincident holding statements in the communications plan. Reach a consensus  on what \nlevel of detail is appropriate to share within the organization and with the public and how \ninformation will flow.  \n Implement a zero trust architecture  to prevent unauthorized access to data and services . \nMake access control enforcement as granular as possible.  ZTA assumes a network is \ncompromised and provides a collection of concepts and ideas designed to minimize uncertainty \nin enforcing accurate, least p rivilege per  request access decisions in information systems and \nservices.  \nPreventing and Mitigating Ransomware and Data Extortion Incidents  \nRefer to the best practices and references listed in this section  to help  prevent and mitigate \nransomware and data extortion incidents. Prevention best practices are grouped by common initial \naccess vectors  of ransomware and data extortion actors . \nInitial Access  Vector: Internet -Facing Vulnerabilities and Misconfigurations  \n\nTLP: CLEAR  \nPage | 7 TLP: CLEAR   Do not expose services, such as remote desktop  protocol , on the web . If these services \nmust be exposed, apply appropriate compensating controls to prevent common forms of abuse \nand exploitation. All unnecessary OS applications and network protocols are disabled on \ninternet -facing assets. [ CPG 2.W ] \n Conduct regular vulnerability scanning to identify and address vulnerabilities , especially \nthose on internet -facing devices, to limit the attack surface  [CPG 1.E ]. \no CISA offers a no -cost Vulnerability Scanning service and other no -cost assessments: \ncisa.gov/cyber -resource -hub [CPG 1.F ]. \n Regularly patch and update software and operating systems  to the latest available \nversions . \no Prioritize timely patching of internet -facing servers that operate software for processing \ninternet data, such as web browsers, browser plugins, and document readers \nespecially for known exploited vulnerabi lities. \no The authoring organizations aware of difficulties small and medium business have \nkeeping internet -facing servers updated urge migrating systems to reputable \nmanaged cloud providers to reduce, not eliminate, system maintenance roles for \nidentity and email systems . For more information, v isit NSAs Cybersecurity Information \npage  Mitigating Cloud  Vulnerabilities . \n Ensure all on -premises, cloud services, mobile, and personal  (i.e., bring your own device \n[BYOD])  devices are properly configured and security features are enabled . For example, \ndisable ports and protocols that are not being used for business purpose s (e.g., Remote \nDeskt op Protocol [RDP] Transmission Control Protocol [TCP] Port 3389 ) [CPG 2.X ]. \no Reduce or e liminate manual deployments and codify cloud resource configuration \nthrough IaC. Test IaC templates before  deployment with static security  scanning tools to \nidentify misconfigurations and security gaps.  \no Check for configuration drift routinely to identify r esources that were changed or \nintroduced outside of template deployment, reducing the likelihood of new security gaps \nand misconfigurations being introduced.  Leverage cloud providers  services to automate \nor facilitate auditing resources to ensure a consis tent baseline.  \n Limit the  use of RDP and other remote desktop services . If RDP is necessary, apply best \npractices . Threat actors often gain initial access to a network through exposed and poorly \nsecured remote services, and later traverse the network using the native Windows RDP client . \nThreat actors also often gain access by exploiting virtual private networks ( VPNs ) or using \ncompromised credentials. Refer to  CISA  Advisory : Enterprise VPN Security . \no Audit the network for systems using RDP, close unused RDP ports, enforce account \nlockouts after a specified number of attempts, apply multifactor authentication (MFA), \nand log RDP login attempts.  \no Update VPNs, network infrastructure  devices, and devices being used to remote in  to \nwork environments with the latest software patches and security configurations. \n\nTLP: CLEAR  \nPage | 8 TLP: CLEAR  Implement MFA on all VPN connections to increase security. If MFA is not implemented, \nrequire teleworkers to use passwords  of 15 or more characters . \n Disable Server Message Block (SMB) protocol version 1 and upgrade to version 3 (SMBv3) \nafter mitigating existing dependencies (on existing systems or applications), as they may break \nwhen disabled. SMBv3 was first released as part of updates to Microsoft Windows 8 and \nWindows Server 2012, Apple OS X 10.10, and Linux kernel 3.12.  \n Harden SMBv3 by implementing the following guidance as malicious actors use SMB to \npropagate malware across organizations . \no Require the use of SMBv 3.1.1. This  version contains enhanced security protections, \nincluding pre -authentication integrity, enhanced AES encryption, and signing \ncryptography. SMBv 3.1.1 protocol is supported natively in Windows, Apple, and Linux \nkernel, as well as many other third -party sto rage systems. In Microsoft Windows 10 and \nWindows Server 2019 , Windows 11 Preview Build 25951 , and later , you can mandate \nSMBv 3.1.1 protections such as dialect client negotiation. For more information, see \nMicrosofts Protect SMB traffic from interception | Use SMB 3.1.1  and SMB dialect \nmanagement now supported in Windows Insider . \no Block unnecessary SMB communications:  \n Block external access of SMB to and from organization networks by blocking \nTCP port 445 inbound and outbound at internet perimeter firewalls. Block TCP \nports 137, 138, 139. Note:  SMBv2 and later does not use NetBIOS datagrams.  \nContinuing to us e SMBv2 does not have significant risks and can be used where \nneeded. It is recommended to update it to SMBv3 where feasible.  \n Block or limit internal SMB traffic so that communication s only occur between \nsystems requiring it. For instance, Windows devices need SMB communications \nwith domain controllers to get group policy , but most Windows workstations do \nnot need to  access othe r Windows workstations .  \n Configure Microsoft Windows and Windows Server systems to require Kerberos -\nbased IP Security (IPsec) for lateral SMB communications to prevent malicious \nactors from accessing communications over SMB by detecting systems that are \nnot members of an organizations Microsoft Active Directory domains.  \n Disable the SMB Server service (Server) on Microsoft Windows and Windows \nServer devices in instances where there is no need to remotely access files or to \nname pipe application programmin g interfaces (APIs).  \n For more information guidance, see Microsofts Secure SMB Traffic in Windows \nServer . \no Consid er requiring SMB encryption. To guarantee that  SMB 3.1.1 clients always use \nSMB Encryption, you must disable the SMB 1.0 server. For more information, refer to \nMicrosofts SMB securit y enhancements | Enable SMB Encryption  and Reduced \nperformance after SMB Encryption or SMB Signing is enabled  \no If SMB encryption is not enabled, r equire SMB signing for both SMB client and server on \nall systems. This will prevent certain adversary -in-the-middle and pass -the-hash attacks.   \n\nTLP: CLEAR  \nPage | 9 TLP: CLEAR  For more information on SMB signing, refer to Microsofts Overview of Server Message \nBlock Signing . \no Require Kerberos authentication by hardening Universal Naming Convention (UNC). \nOSs such as Microsoft Windows 10, Windo ws Server 2016, and later automatically \nharden UNC for connections to the Microsoft Active Directory domain via SYSVOL and \nNETLOGON shares. Additionally, network administrators can manually configure UNC \nhardening for servers and shares in any supported Mi crosoft Windows operating system. \nFor more information, refer to Microsofts  Vulnerability in Group Policy could allow \nremote code execution . Using IP addresses to connect to SMB servers will result in the \nuse of NTLM authentication unless you also configure the use of Kerberos SPNs with IP \naddresses, refer to Microsofts Configuring Kerberos for IP Address . \no Use SMB over QUIC. Microsoft Windows 11, Windows Server 2022 Datacenter: Azure \nEdition, and Android clients with a third-party SMB client support use of SMB over QUIC, \nan alternative for SMB over TCP. The QUIC protocol is always Transport Layer Security \n(TLS) 1.3 encrypted and uses certificate authentication to encapsulate all SMB traffic \nincluding SMBs own authentica tioninside a VPN -like transport. SMB over QUIC \nallows mobile users to safely connect over the public internet to edge SMB resources , \nsuch as  servers at the edge of organizational networks not completely behind a firewall,  \nbut also works on internal netwo rks that require the highest SMB transport security. For \nmore information, refer to Microsoft s SMB over QUIC . \no Log and monitor SMB traffic [ CPG 2.T] to help flag potentially abnormal, harmful \nbehaviors.  \nInitial Access Vector : Compromised Credentials  \n Implement phishing -resistant MFA  for all services , particularly for email,  VPNs, and \naccounts that access critical systems [CPG 2.H ]. Escalate to senior management upon \ndiscovery of  systems  that do not  allow MFA, systems that do not enforce MFA, and any users \nwho are not enrolled with MFA.  \no Consider employ ing password -less MFA  that replace passwords with two or more \nverification factors  (e.g.,  a fingerprint, facial recognition, device pin, or a cryptographic \nkey). \n Consider s ubscrib ing to credential  monitoring services  that monitor the dark web  for \ncompromised credentials . \n Implement identity and access management ( IAM) systems  to provide administrators with \nthe tools and technologies to monitor and manage roles and access privileges of individual \nnetwork entities for on -premises and cloud applic ations.  \n Implement zero trust access control  by creating strong access policies to restrict user  to \nresource access and resource -to-resource access. This is  important for key management \nresources in the cloud.  \n Change default admin usernames and passwords  [CPG 2.A ]. \n Do not use root access accounts for day-to-day operations . Create users, groups, and \nroles to carry out tasks.  \n\nTLP: CLEAR  \nPage | 10 TLP: CLEAR   Implement password policies that requi re unique passwords  of at least 15 characters . \n[CPG 2.B ] [CPG 2.C ]. \no Password managers can help you develop and manage secure passwords.  Secure and \nlimit access to any password managers in use  and enable all security features available \non the product in use, such as MFA . \n Enforce  account lockout policies after a cert ain number of failed login attempts . Log and \nmonitor login attempts for brute force password cracking and password spraying  [CPG 2.G ]. \n Store passwords in a secured database and use strong hashing algorithms . \n Disable  saving passwords to the browser in the  Group Policy  Management console . \n Implement Local Administrator Password Solution (LAPS)  where possible  if your OS is \nolder than Windows Server 2019 and Windo ws 10  as these versions do not have LAPS built in . \nNote: The authoring organizations recommend organizations  upgrade to Windows Server 2019 \nand Windows 10 or greater.  \n Protect against Local Security Authority Subsystem Service (LSASS)  dumping:  \no Implement the Attack Surface Reduction (ASR) rule for LSASS.  \no Implement Credential Guard for Windows 10 and Server 2016 . Refer to Microsoft  \nManage Windows Defender Credential Guard  for more information. For Windows Server \n2012R2, enable Protected Process Light  (PPL)  for Local Security Authority (LSA) . \n Educate  all employees on proper password security  in your annual security training  to \ninclude emphas izing not reusing passwords and not saving passwords in local files.  \n Use Windows PowerShell Remoting, Remote Credential Guard, or RDP  with restricted \nAdmin Mode as feasible when establishing a remote connection to avoid direct exposure of  \ncredentials.  \n Separate administrator accounts from user accounts [CPG 2.E ]. Only allow designated \nadmin accounts to be used for admin purposes. If an individu al user needs administrative rights \nover their workstation, use a separate account that does not have administrative access to other \nhosts, such as servers.  For some cloud environments, separat e duties when the account used \nto provision/manage keys does no t have permission to use the keys and vice versa. As this \nstrategy introduces additional management overhead, it is not appropriate in all environments . \nInitial Access  Vector: Phishing  \n Implement a cybersecurity user awareness and \ntraining program  that includes guidance on how to \nidentify and report suspicious activity (e.g., phishing) or \nincidents  [CPG 2.I ]. \n Implement  flagging external emails in email  clients . \n Implement filters at the email gateway to filter out \nemails with known malicious indicators, such as known malicious subject lines, and block \nsuspicious Internet Protocol (IP) addresses at the firewall  [CPG 2.M ]. CISA offers a no -cost Phishing \nCampaign Assessment and other \nno-cost assessments . Visit \ncisa.gov/cyber -resource -hub. \n. \n\nTLP: CLEAR  \nPage | 11 TLP: CLEAR   Enable common attachment filter s to restrict file types that commonly  contain malware  \nand should  not be sent by email . For more information , refer to  Microsoft s post  Anti-malware \nprotection in EOP . \no Review  file types in your filter list  at least semi -annually and add additional file types that \nhave become attack vectors . For example, OneNote attachments  with embedded \nmalware have recently been used in phishing campaigns.  \no Malware is often compressed in password pro tected archives  that evade antivirus \nscanning and email filters.  \n Implement Domain -based Message Authentication, Reporting and Conformance \n(DMARC) policy and verification  to lower \nthe chance of spoofed or modified emails \nfrom valid domains. DMARC protects your \ndomain from being spoofed but does not \nprote ct from incoming emails that have been \nspoofed  unless the sending domain also \nimplements DMARC . DMARC builds on the \nwidely deployed Sender Policy Framework \n(SPF)  and Domain Keys Identified Mail \n(DKIM)  protocols , adding a reporting function \nthat allows send ers and receivers to improve \nand monitor protection of the domain from \nfraudulent email.  For more information on \nDMARC, refer to CISA Insights Enhance \nEmail & Web Security  and the Center for \nInternet Securitys blog How DMARC \nAdvances Email Security . \n Ensure macro scripts are disabled for Microsoft Office files transmitted via email . These \nmacros can be used to deliver ransomware  [CPG 2.N ]. Note:  Recent versions of Office are \nconfigured  by defa ult to block files that contain Visual Basic for Applications ( VBA) macros and \ndisplay a Trust Bar with a warning that macros are present and have been disable d. For more \ninformation, refer to Microsofts Macros from the internet will be blocked by default in Office . \nSee Microsofts Block macros from running in Office files from the Internet  for configur ation \ninstructions  to disable macros in external files for earlier versions of Office . \n Disable Windows Script Host  (WSH) . Windows script hosting provides an environment in \nwhich users can execute scripts or perform tasks.  Malicious Domain Blocking and Reporting \n(MDBR) is a no -cost service for  SLTT \norganizations  that is funded by CISA, the \nMS-ISAC, and the EI-ISAC. This fully \nmanaged security service prevent s IT \nsystems from connecting to harmful web \ndomains and protects against cyber threats , \nincluding : \n Malware,  \n Ransomware, and  \n Phishing . \nTo sign up for MDBR, visit cisecurity.org/ms -\nisac/services/mdbr/ . \n\nTLP: CLEAR  \nPage | 12 TLP: CLEAR  Initial Access Vector : Precursor Malware Infection  \n Use automatic updates for your  antivirus \nand anti -malware software and \nsignatures . Ensure  tools are properly \nconfigured to  escalate warnings and \nindicators  to notify security personnel . The \nauthoring organizations recommend using a \ncentrally managed antivirus solution. This \nenables detection of both precursor \nmalware and ransomware.  \no A ransomware infection may be \nevidence of a previous, unresolved \nnetwork compromise. For example, many ra nsomware infections are the result of \nexisting malware infections, such as QakBot, Bumb lebee , and Emotet . \no In some cases, ransomware deployment is the last step in a network compromise and is \ndropped to ob scure  previous post -compromise activities , such as b usiness email \ncompromise (BEC) . \n Use application allowlisting  and/or endpoint detection and response ( EDR ) solutions  on \nall assets to ensure that only authorized software is executable  and all unauthorized software is \nblocked.  \no For Windows, e nable Windows Defender Application Control (WDAC) , AppLocker, or \nboth on all systems that support th ese feature s. \n WDAC is under  continuous development while AppLocker  will only receive \nsecurity fi xes. App Locker can be used as a complement to WDAC, whe n WDAC \nis set to the most restrictive level possible , and AppLocker is used to fine -tune \nrestrictions for your organization.  \no Use allowlisting rather than attempting to list  and deny  every possible permutation of \napplications in a network environment.  \no Consider implementing  EDR for cloud -based resources.  \n Consider implementing an intrusion detection system (IDS)  to detect command and control \nactivity and other potentially malicious network activity that occurs prior to ransomware \ndeployment.   \no Ensure that the IDS is centrally monitored and managed. Properly c onfigure the tools \nand route warnings and indicators to the appropriate personnel  for action.  \n Monitor indicators of activity  and block malware file  creation  with the Windows Sysmon  \nutility . As of  Sysmon 14, the FileBlockExe cutable option can be used to block the creation \nof malicious executables , Dynamic Link Library (DLL) files , and sys tem files that match specific \nhash  values . CISA and MS -ISAC encourage SLTT \norganizations to use Albert IDS to enhance a \ndefense -in-depth strateg y. Albert serves as \nan early warning capability for U.S. SLTT \ngovernments and supports nationwide \ncybersecurity situational awareness and \ndefense . For more information regarding \nAlbert, visit cisecurity.org/services/albert -\nnetwork -monitoring/ . \n\nTLP: CLEAR  \nPage | 13 TLP: CLEAR  Initial Access  Vector: Advanced  Forms of \nSocial Engineering  \n Create policies to include \ncybersecurity awarene ss training  \nabout advanced forms of social \nengineering for perso nnel that have \naccess to your network. Training should \ninclude tips on being able to recognize \nillegitimate websites and search results. It \nis also important to repeat security \nawareness train ing regularly to keep your \nstaff informed  and vigilant . \n Implement Protective Domain Name \nSystem  (DNS ). By blocking malicious \ninternet activity  at the source, Protective \nDNS services can provide high network \nsecurity for remote workers.  These \nsecurity service s analyze DNS queries \nand take action to mitigate threats such \nas malware, ransomware, phishing \nattacks, viruses, malicious sites, and \nspyware leveraging the existing DNS \nprotocol and architecture. SLTTs can \nimplement the no -cost MDBR  service . \nSee NSAs and CISA s Selecting a \nProtective DNS Service . \n Consider i mplement ing sandboxed \nbrows ers to protect systems from \nmalware originating from web browsing.  \nSandboxed browsers isolate the host \nmachine from malicious code.  Advanced  forms of social engineering include:  \n Search Engine Optimization (SEO) poisoning , \nalso known as search poisoning : When \nmalicious actors create malicious websites and \nuse SEO tactics to make them show up \nprominently in search results. SEO poisoning \nhijack s the search engine results of popular \nwebsites and inject s malicious links to boos t \ntheir placement in search results. These links \nthen lead unsuspecting users to phishing sites, \nmalware downloads, and other cyber threats.  \n Drive -by-downloads (imposter websites) : \nWhen a user unintentionally downloads \nmalicious code by visiting a seemingl y \nlegitimate website that is malicious. Malicious \nactors use drive -by downloads to steal and \ncollect personal information, inject trojans, or \nintroduce exploit kits or other malware to \nendpoints. Users may visit these sites by \nresponding to a phishing emai l or by clicking \non a deceptive pop -up window.  \n Malverti sing: Malicious advertising that \ncybercriminals use to inject malware to users \ncomputers when they visit malicious websites \nor click an online advertis ement . Malvertising \nmay also direct users to a corrupted website \nwhere their data can be stolen , or malware can \nbe downloaded onto their computer. \nMalvertising can appear anywhere , even at \nsites you visit as part of your everyday web \nbrowsing.  \n Impers onating employees:  Ransomware actors \nhave posed as company IT and/or helpdesk \nstaff in phone calls or SMS messages to obtain \ncredentials from employees and gain access to \nthe network . \n \n\nTLP: CLEAR  \nPage | 14 TLP: CLEAR  Initial Access  Vector: Third Parties and Managed Service Providers  \n Consider  the risk management \nand cyber hygiene practices of \nthird parties or managed service \nproviders (MSPs)  your \norganization relies on to meet its \nmission. MSPs have been an \ninfection vector for ransomware \nimpacting numerous client \norganizations  [CPG 1.I ]. \no If a third party or MSP is \nresponsible for maintaining \nand securing your \norganizations backups, \nensure they are following \nthe applicable best \npractices outlined above. \nUse contract language to formalize your security requirements as a best practice.  \n Ensure the use of least privilege and separation of duties when setting up the access of \nthird parties . Third parties and MSPs should only have  access to devices and servers that are \nwithin  their ro le or responsibilities.  \n Consider  creat ing service control policies (SCP) for cloud -based resources to prevent \nusers or roles, organization wide , from being able to access specific services or take \nspec ific actions within services.  For example, the SCP can be used to restrict users from \nbeing able to delete logs, updat e virtual private cloud (VPC) configurations, and chang e log \nconfigurations.  \nGeneral Best Practices and Hardening Guidance  \n Ensure your org anization has a comprehensive asset management  approach  [CPG 1.A ]. \no Understand and take inventory  of your \norganizations IT assets, logical (e.g., data, \nsoftware) and  physical (e.g., hardware).  \no Know which data or systems are most critical for \nhealth and safety, revenue generation, or other \ncritical services, and understand  any associated \ninterdependencies ( e.g., system list A used to perform X is stored in critica l asset \nB). This will aid your organization in determining restoration priorities should an \nincident occur. Apply more comprehensive security controls or safeguards to critical \nassets. This requires organization -wide coordination.  \no Ensure you store your IT asset documentation  securely  and keep offline backups and \nphysical hard copies on site.  Malicious actors may exploit the trust ed relationships \nyour organization has with third parties and MSPs.  \n Malicious actors may target MSPs with the goal of \ncompromising MSP client organizations; they may \nuse MSP network connections and access to \nclient organizations as a key vector to propagate \nmalware and ransomware.  \n Maliciou s actors may spoof the identity of or use \ncompromised email accounts associated with \nentities your organization has a trusted \nrelationship with to phish your users, enabling \nnetwork compromise and disclosure of \ninformation.  \n \nTip: To facilitate asset tracking, \nuse MS -ISAC s Hardware and \nSoftware Asset Tracking \nSpreadsheet . \n\nTLP: CLEAR  \nPage | 15 TLP: CLEAR   Apply the principle of least privilege to all systems and services  so that users only have \nthe access they need to perform their jobs  [CPG 2.E ]. Malicious actors often leverage  privileged \naccounts for network -wide ransomware attacks . \no Restrict user permissions to install and run software applications.  \no Restrict user/role permissions  to access or modify cloud -based resources.  \no Limit actions that can be taken on customer -managed keys by certain users/roles.  \no Block local account s from remote access  by using group policy to restrict network sign -in \nby local accounts . For guidanc e, refer to Microsofts Blocking Remote Use of Local \nAccounts  and Security identifiers . \no Use Windows Defender Remote Credential Guard  and restricted admin mode for RDP \nsessions.  \no Remove unnecessary accounts and groups and restrict root access.  \no Control and limit  local administration.  \no Audit Active Directory ( AD) for excessive privileges on accounts and group \nmemberships.  \no Make use of the Protected Users AD group in Windows domains to further secure \nprivileged user accounts against pass -the-hash attacks . \no Audit user and admin accounts for inactive or unauthorized accounts quarterly . Prioritize \nreview of remote monitoring and management accounts that are publicly accessible \nthis includes audits of third -party access given to MSPs.  \n Ensure that all hypervisors and associated IT infrastructure, including network and \nstorage components, are updated and hardened . Emerging ransomware strategies have \nbegun targeting VMware ESXi servers , hypervisors , and other centralized tools and systems, \nwhich enables fast encryption of the infrastructure at scale . For more information about \nransomware resilience and hardening of VMware and other virtualization infrastructure , see : \no NIST Special Publication ( SP 800-125A Rev.1 ): Security Recommendations for Server -\nbased Hypervisor Platforms  \no VMware: Cloud Infrastructure Security Configuration & Hardening  \n Leverage best practices and enable security settings in association with cloud \nenvironments , such as Microsoft Office 365 . \no Review the shared responsibil ity model for cloud and ensure you understand  what \nmakes up customer responsibility when it comes to asset protection.  \no Backup data often; offline or leverage cloud -to-cloud backups.  \no Enable logging on all resources and set alerts for abnormal usages.  \no Enable  delete protection or object lock on storage resources often targeted in \nransomware  attacks ( e.g., object storage, database storage, file storage, and block \nstorage) to prevent data from being deleted or overwritten, respectively.  \no Consider enabling version  control  to keep multiple variants of objects in storage. This \nallow s for easier recovery from unintended or malicious actions.  \n\nTLP: CLEAR  \nPage | 16 TLP: CLEAR  o Where supported, when using custom programmatic access to the cloud, use signed \napplication programming interface ( API) requests to verify the identity of the requester, \nprotect data in transit, and protect against other attacks such as replay attacks.  \no For more information , refer to  CISA Cybersecurity Advisory  Microsoft Office 365 Security \nRecommendations . \n Mitigate the malicious use of  remote access and remote m onitoring and management \n(RMM)  software : \no Audit remote access tools on your network to identify current or authorized RMM \nsoftware . \no Review logs for execution of RMM software to detect abnormal use , or RMM software  \nrunning as a portable executable.  \no Use security software to detect instances of RMM software only being loaded in \nmemory.  \no Requir e authorized RMM solutions only be used from wit hin your network over approved \nremote access solutions, such as VPNs or virtual desktop interfaces (VDIs).  \no Block both inbound and outbound connections on common RMM ports and protocols at \nthe network perimeter.  \n Employ logical or physical means of network segmentation by implementing  ZTA and \nseparating various business units or departmental IT resources within your organization  and \nmaintain separation between IT and operational technology [CPG 2.F ]. Network segmentation \ncan help contain the impact of any intrusion affecting your organization and prevent or limit \nlateral movement on the part of malicious actors. Organizations should use due diligence when \nsegment ing networks and ensure network security policies are in place and adhered to because \nsegmentation can be rendered ineffective if it is breached through user error or non -adherence \nto policies (e.g., connecting removable storage media or other devices to m ultiple segments).  \n Develop and regularly update comprehensive network diagram (s) that describes systems \nand data flows within your organizations network (s) (see Figure 1) [CPG 2.P ]. This is \nuseful in steady state  and can help incident responders understand where to focus their efforts . \nSee Figure 2 and Figure 3 for depictions of a flat (unsegmented) network and of a best practice \nsegmented network.  \no The diagram should include depictions of major networks,  any specific IP addressing \nschemes, and the g eneral network topology  including network connections, \ninterdependencies, and access granted to third parties , MSPs , and cloud connections \nfrom external and internal endpoints . \no Ensure you securely store network  documentation and keep offline backups and hard \ncopies on site.  \n\nTLP: CLEAR  \nPage | 17 TLP: CLEAR   \nFigure 1: Example Network Diagram  \n\n\nTLP: CLEAR  \nPage | 18 TLP: CLEAR   \nFigure 2: Flat (Unsegmented) Network   \nFigure 3: Segmented Network  \n Restrict usage of PowerShell to specific users on a case -by-case basis  by using Group \nPolicy . Typically, only users or administrators who manage a network or Windows OS are \npermitted to use PowerShell. PowerShell is a cross -platform, command -line, shell , and scripting \nlanguage that is a component of Microsoft Windows. Threat actors use PowerShell to deploy \nransomware and hide their malicious activities.  For more information, refer to  the joint \nCybersecurity Information Sheet Keeping PowerShell: Security Measure to Use and Embrace . \no Update Windows PowerShell  or PowerShell Core  to the latest  version  and uninstall all \nearlier PowerShell versions.  \no Ensure PowerShell instances , using the most current version , have module, script block, \nand transcription logging enabled (enhanced logging).  \n Logs from Windows PowerShell prior to version 5.0 are either non -existent or do \nnot record enough detail to aid in  enterprise monitoring and incident response \nactivities.  \n PowerShell logs contain valuable data, including historical OS and registry \ninteraction and possible tactics, techniques, and procedures of a threat actors \nPowerShell use.  \n Two logs that record Power Shell activity are the PowerShell Windows  Event  log \nand the PowerShell Operational log. The authoring organizations  recommend \nturning on these two Windows Event Logs with a retention period of at least 180 \ndays.  \n These logs should be checked on a regular basis to confirm whether the log data \nhas been deleted or logging has been turned off. Set the storage size permitted \nfor both logs to as large as possible.  \n\n\nTLP: CLEAR  \nPage | 19 TLP: CLEAR   Secure domain controllers (DCs) . Malicious actors often target and use DCs as a staging \npoint to spread ransomware network  wide.  To secure DCs:  \no Use the latest version of Windows Server supported by your organization on DCs.  \nNewer versions of Windows Server OS have more security features, including for Active \nDirectory,  integrated. For guidance o n configuring available security feature s refer to \nMicrosofts Best Practices for Securing Active Dire ctory . \n The authoring organiza tions recommend using Windows Server 2019 or greater \nand Windows 10 or greater  as they  have security features , such as LSASS \nprotections with Windows Credential Guard, Windows Defender, and \nAntimalware Scan Interface (AMSI),  not included in older operating system  \no Ensure that DCs are regularly patched. Apply patches for critical vulnerabilities  as soon \nas possible.  \no Use open -source penetration testing tools, such as  BloodHound  or PingCastle , to verify \ndomain controller security.  \no Ensure that minimal  software or agents are installed on DCs  because  these can be \nleveraged to run arbitrary code on the system.  \no Restrict a ccess to DCs to the Administrators group. Users within this group should be \nlimited and have separate accounts used for day -to-day operations with non -\nadministrative permissions.  For more information, r efer to  Microsofts Securing Active \nDirectory Administrative Groups and Accounts . \n The designated admin accounts should only be  used for admin purposes.  Ensure \nthat checking emails,  web browsing, or other high -risk activities are not \nperformed on DCs.  \no Configure DC host firewalls to prevent internet access. Usually, DCs do not need direct \ninternet access. Servers with internet connectivity can be used to pull necessary \nupdates in lieu  of allowing internet access for DCs.  \no Implement a privileged access management (PAM) solution  on DCs  to assist in \nmanaging and monitoring privileged access.  PAM solutions can also log and alert usage  \nto detect unusual activity . \no Consider disabling or limiti ng NTLM and WDigest Authentication , if possible . Includ e \ntheir use as criteria for prioritizing up grading  legacy systems or for segmenting the \nnetwork. Instead use modern federation protocols ( e.g., SAML , OIDC or Kerberos ) for \nauthentication with AES -256 b it \nencryption https://cisa.gov/sites/default/files/publications/2022_00092_CISA_CPG_Repo\nrt_508c.pdf . If NTLM must be enabled : \n Enable Extended Protection for Authentication (EPA)  to prevent some NTLM -\nrelay  attacks . For more information, r efer to  Microsoft  Mitigating NTLM Relay \nAttacks on Active Directory Certificate Services (AD CS) . \n Enable NT LM auditing to ensure that only NTLMv2 responses are sent across \nthe network. Measures should be taken to ensure that LM and NTLM responses \nare refused, if possible.  \n\nTLP: CLEAR  \nPage | 20 TLP: CLEAR  o Enable additional protections for LSA Authentication to prevent code injection capable of \nacquiring credentials from the system. Prior to enabling these protections, run audits \nagainst lsass.exe  to ensure an understanding of the programs that will be affected by \nthe enabling of this protection.  \n Retain and adequately secure logs from network dev ices, local hosts , and cloud \nservi ces. This supports triage and remediation of cybersecurity events. Logs can be analyzed \nto determine the impact of events and ascertain if an incident has occurred  [CPG 2.T ]. \no Set up centralized log management using a security information and event management \ntool [CPG 2.U ]. This enables an organization to correlate logs from both network and \nhost security devices. By reviewing logs from multiple sources, an organization can \ntriage an individual event and determine its impact to the organizatio n. \no Maintain and back  up logs for criti cal systems for a minimum of one year, if possible.  \n Establish a security baseline of normal network traffic and tune network appliances to \ndetect anomalous behavior . Tune host -based products to detect anomalous binaries, lateral \nmovement, and persistence t echniques.  \no Consider using b usiness t ransaction logging such as logging activity related to specific \nor critical applications for behavioral analytics . \n Conduct regular assessments  to ensure processes and procedures are up to date and can be \nfollowed by security staff and end users.  \n Enable tracking prevention  to limit the vectors that ad networks and trackers can use to track \nuser information.  \n Enable website typo protection  to limit the possibility of logging onto spoofed websites or \nother potential malic ious links that could compromise a browser.  \n Enable browser -based AV for active scanning while browsing as an added layer of defense.  \n Block website notifications by default  to limit sites ability to track user data that can be \nexploited.  \n\nTLP: CLEAR  \nPage | 21 TLP: CLEAR  Part 2: Ransomwar e and Data Extortion Response Checklist  \nShould your organization be a victim of \nransomware,  follow your approved IRP. The \nauthoring organizations  strongly recommend \nresponding by using the following checklist. \nBe sure to move through the first three \nsteps in sequence.  \nDetection and Analysis  \nRefer to the best practices and references \nbelow to help manage the ri sk posed by \nransomware and support your organizations \ncoordinated and efficient response to a \nransomware incident. Apply these practices \nto the greatest extent possible based on \navailability of organizational resources.  \n 1. Determine which systems were \nimpacted, and immediately isolate \nthem.  \n If several systems or subnets \nappear impacted, take the network offline at the switch level. It may not be feasible to \ndisconnect individual systems during an incident.  \n Prioritize isolating critical systems  that are essential to daily operations.  \n If taking the network temporarily offline is not immediately possible, locate the network \ncable  (e.g., ethernet)  and unplug affected devices from the network or remove them \nfrom Wi -Fi to contain the infection.  \n For cloud resources, take a snapshot of volumes to get a point in time copy for reviewing \nlater for forensic investigation.  \n After an initial compromise, malicious actors may monitor your organizations activity or \ncommunications to understand if their actions have b een detected. Isolate systems in a \ncoordinated manner and use out -of-band communication methods such as  phone calls \nto avoid tipping off actors that they have been discovered and that mitigation actions are \nbeing undertaken. Not doing so could cause actors  to move laterally to preserve their \naccess  or deploy ransomware widely prior to networks being taken offline.  \n \n 2. Power down device s if you are unable to disconnect them  from the network to avoid \nfurther spread of the ransomware infection.  \n \nNote:  This ste p will prevent you r organization  from maintaining ransomware infection artifacts \nand potential evidence stored in volatile memory. It should be carried out only if it is not \npossible to temporarily shut down the network or disconnect affected hosts from th e \nnetwork  using other means.  \n The authoring organizations do not recommend \npaying ransom . Paying  ransom will not ensure your \ndata is decrypted , that your systems or data will no \nlonger be compromised , or that your data will not be \nleaked .  \nAdditionally, paying ransoms may pose sanctions \nrisks. For information on potential sanctions risks , \nsee U.S. Department of the Treasury Office of \nForeign Assets Control (OFAC) memorandum from \nSeptember 2021 , Updated Advisory on Potential \nSanctions Risks for Facilitating Ransomware \nPayments . The updated advisory states that \nTreasurys Office of Foreign Assets Control (OFAC) \nwould consider 'mitigating factors' in related \nenforcement actio ns. Contact your local FBI field \noffice , in consultation with OFAC, for guidance on \nmitigating penalty factors after a n attack.  \n \n\nTLP: CLEAR  \nPage | 22 TLP: CLEAR   3. Triage impacted systems for restoration and recovery.  \n Identify and prioritize critical systems for restoration  on a clean network  and confirm the \nnature of data housed on impacted systems . \n Prioritize restoration and recovery based on a predefined critical asset list that \nincludes information systems critical for health and safety, revenue generation, or \nother critical services, as well as systems they depend on . \n Keep track of systems and devices that are not perceived  to be impacted so they can be \ndeprioritized for restoration and recovery. This enables your organization to get back to \nbusiness in a more efficient manner.  \n \n 4. Examine  existing organizational detection or prevention systems ( e.g., antivirus, EDR , \nIDS, In trusion Prevention System) and logs. Doing so can highlight evidence of additional \nsystems or malware involved in earlier stages of the attack.  \n Look for evidence of precursor dropper malware , such as Bumblebee , Dridex, Emotet , \nQakBot, or Anchor . A ransom ware event may be evidence of a previous, unresolved \nnetwork compromise.  \n Operators o f these advanced malware variants will often sell access to a \nnetwork. Malicious actors will sometimes use this access to exfiltrate data and \nthen threaten to release the d ata publicly before ransoming the network to further \nextort the victim and pressure them into paying.  \n Malicious actors often drop ransomware variants to obscure post-compromise \nactivity. Care must be taken to identify such dropper malware before rebuilding  \nfrom backups to prevent continuing compromise s. \n 5. Confer with your team to develop and document an initial understanding of what has \noccurred based on initial analysis . \n \n 6. Initiate t hreat h unting activities . \n For enterprise environments , check for:  \n Newly created AD accounts or accounts with escalated privileges  and recent \nactivity related to privilege d accounts such as Domain Admins.  \n Anomalous VPN device logins or other suspicious logins . \n Endpoint modifications that may impair backups, shadow copy, d isk journaling , \nor boot configurations. Look for anomalous usage of built -in Windows tools such \nas bcdedit.exe , fsutil.exe  (deletejournal), vssadmin.exe , wbadmin.exe , \nand wmic.exe  (shadowcopy or shadowstorage). Misuse of these tools is a \ncommon ransomware technique to inhibit system recovery.  \n Signs of the presence of Cobalt Strike beacon /client . Cobalt Strike  is a \ncommercial penetration testing software suite.  Malicious actors often name \nCobalt Strike Windows processes with the same names as legitimate Windows \nprocesses to obfuscate their presence and complicate investigation s. \n\nTLP: CLEAR  \nPage | 23 TLP: CLEAR   Signs of any unexpected usage of remote monitoring and management (RMM) \nsoftware (including por table executables that are not installed) . RMM software is  \ncommonly used  by malicious actors to maintain persistence . \n Any unexpected Power Shell execution or use of PsTools suite . \n Signs of enumeration of AD and/or LSASS credentials being dumped (e.g., \nMimikatz , Sysinternals  ProcDump , or NTDSutil.exe ). \n Signs of unexpected endpoint -to-endpoint (including servers) communications , \nfor example, Address Resolution Protocol ( ARP) poisoning of an endpoint or  \ncommand and control  traffic relayed between endpoints.  \n Potential signs of data being exfiltrated from the network , which may include:  \n Abnormal amount of data outgoing over any port. Open source software \ncan tunnel data over var ious ports and protocols. For example, \nransomware actors have used Chisel  to tunnel Secure Shell ( SSH) over \nHTTPS port 443. Ransomware a ctors have also used Cloudflared  to \nabuse Cloudflare tunnels to tunnel communications over HTTPS.  \n Presence of Rclone , Rsync , and various web -based file  storage  services , \nand FTP/SFTP, which are c ommon tools for data exfiltration  (and also \nused by threat actors  to implant  malware/tools on affected network s.) \n Newly created services, unexpected scheduled tasks, unexpected software \ninstalled, unusual files c reated, legitimate processes with unexpected child \nprocesses, etc. \n For c loud enviro nments:  \n Enable tools to detect and prevent modifications to IAM, network security, and \ndata protection resources.  \n Use automation to detect common issues (e. g., disabling features, introduction of \nnew firewall rules) and take automated actions as soon as they occur. For \nexample, if a new firewall rule is created that allows open traffic ( 0.0.0.0/0 ), an \nautomated action can be taken to disable or delete this rule and send \nnotifications to the user that created it as well as the security team for \nawareness. This will help avoid alert fatigue and allow security personnel to \nfocus on critical issues.  \n\nTLP: CLEAR  \nPage | 24 TLP: CLEAR  Reporting and Notification  \nNote:  Refer  to the Contact Information  \nsection at the end of this guide for details on \nhow to report and notify about ransomware \nincidents.  \n 7. Follow notification requirements as \noutlined in your cyber incident \nresponse and communication s plan \nto engage internal and external \nteams and stakeholders with an \nunderstanding of what they can \nprovide to help you mitigate, respond \nto, and recover from the incident.  \n Share the information you \nhave at your disposal to \nreceive timely and relevant \nassistance. Keep \nmanagement and senior \nleaders informed via regular \nupdates as the situation \ndevelops. Relevant \nstakeholders may include \nyour IT department, managed \nsecurity service providers, \ncyber insurance company, \nand departmental or elected \nleaders  [CPG 4.A ]. \n Report the incident to and \nconsider requesting \nassistance from CISA, your \nlocal FBI field office, the FBI \nInternet Crime  Complaint \nCenter  (IC3) , or your local \nU.S. Secret Service field \noffice.  \n As appropriate, coordinate \nwith communications and \npublic information personnel \nto ensure accurate \ninformation is shared \ninternally with your organization and externally with the public.  \n 8. If the incident resulted in  a data breach,  follow notification requirements as outlined in \nyour cyber incident response and communications plans.  If extended identification or analysis is needed, CISA, MS -\nISAC a nd local, state, or federal law enforcement may be \ninterested in any of the following information that your \norganization determines it can legally share:  \n Recovered executable file . \n Copies of the readme file  DO NOT REMOVE the \nfile or decryption may not be  possible . \n Live memory (RAM) capture from systems with \nadditional signs of compromise (use of exploit \ntoolkits, RDP activity, additional files found locally) . \n Images of infected systems with additional signs of \ncompromise (use of exploit toolkits, RDP activity, \nadditional files found locally) . \n Malware samples . \n Names of malware identified on your network . \n Encrypted file samples . \n Log files ( e.g., Windows event logs from \ncompromised systems, firewall logs) . \n PowerShell scripts found having executed on the \nnetwork . \n User accounts created in AD or machines added to \nthe network during the exploitation . \n Email addresses used by the attackers and any \nassociated phishing emails . \n Other communication accounts used by the \nattackers . \n A copy of the ransom note . \n Ransom am ount and if the ransom was paid . \n Bitcoin wallets used by the attackers . \n Bitcoin wallets used to pay the ransom , if applicable . \n Copies of any communications with attackers . \n\nTLP: CLEAR  \nPage | 25 TLP: CLEAR  Containment and Eradication  \nIf no initial mitigation actions appear possible:  \n 9. Take a system image and memory \ncapture of a sample of affected devices \n(e.g., workstations , servers , virtual \nservers, and cloud servers ). Collect any \nrelevant logs as well as samples of any \nprecursor malwar e binaries and associated \nobservables or indicators of compromise \n(e.g., suspected command and control IP \naddresses, suspicious registry entries, or \nother relevant files detected). The contacts \nbelow may be able to assist you in \nperforming these tasks.  \n Preserve evidence that is highly \nvolatile in nature or limited in \nretention to prevent loss or \ntampering (e.g., system memory, \nWindows Security logs, data in firewall log buffers) . \n \n 10. Consult federal law enforcement , even if mitigation ac tions are possible,  regarding \npossible decryptors available,  as security researchers may have discovered encryption flaws  \nfor some ransomware variants  and released decryption  or other types of  tools . \nTo continue taking steps to contain and mitigate the incident:  \n 11. Research  trusted guidance  (e.g., published by sources such as the U.S. G overnment, \nMS-ISAC,  or a reputable security vendor) for the particular ransomware variant and follow any \nadditional recommended steps to identify and contain systems or networks that are confi rmed to \nbe impacted.  \n Kill or disable the execution of known ransomware binaries; this will minimize damage \nand impact to your systems. Delete other known associated registry values and files.  \n \n 12. Identify the systems and accounts involved in the initial b reach.  This can include email \naccounts.  \n \n 13. Based on the breach or compromise details determined above,  contain associated \nsystems that may be used for further or continued unauthorized access.  Breaches often \ninvolve mass credential exfiltration. Securing  network s and other information sources from \ncontinued credential -based unauthorized access may include:  \n Disabl e virtual private networks, remote access servers, single sign -on resources, and \ncloud -based or other public -facing assets . \n Upon voluntary request, CISA and MS -ISAC \n(for SLTT organizations) can assist with \nanalysis  of phishing emails, storage media, \nlogs,  and/or  malware at no cost to help  \norganization s understand the root cause of \nan incident . \n CISA  Advanced Malware Analysis \nCenter: malware.us -cert.gov/  \n MS-ISAC  Malicious Code Analysis \nPlatform (SLTT organizations only): \ncisecurity.org/spotligh t/cybersecurity -\nspotlight -malware -analysis/   \n\nTLP: CLEAR  \nPage | 26 TLP: CLEAR   14. If server -side data is being encrypted  by an infected workstation , follow server -side data \nencryption quick identification steps . \n Review Computer Management > Sessions and Open Files lists on associated servers \nto determine the user or system accessing those  files. \n Review file properties of encrypted files or ransom notes to identify specific users that \nmay be associated with file ownership.  \n Review the TerminalServices -RemoteConnectionManager  event log to check for \nsuccessful RDP network connections.  \n Review t he Windows Security log, SMB event logs, and related logs that may identify \nsignificant authentication or access events.  \n Run packet capture software, such as  Wireshark , on the impacted server with a filter to \nidentify IP addresses involved in actively writ ing or renaming files (e.g.,  smb2.filename \ncontains cryptxxx ). \n \n 15. Conduct extended analysis to identify outside -in and inside -out persistence \nmechanisms.  \n Outside -in persistence may include authenticated access to external systems via rogue \naccounts, back doors on perimeter systems, exploitation of external vulnerabilities, etc . \n Inside -out persistence may include malware implants on the internal network or a variety \nof living -off-the-land style modifications (e.g., use of commercial penetration testing tool s \nlike Cobalt Strike; use of PsTools suite, including PsExec, to remotely install and control \nmalware and gather information regarding or perform remote management of \nWindows systems; use of PowerShell scripts) . \n Identification may involve deployment of EDR  solutions, audits of local and domain \naccounts, examination of data found in centralized logging systems, or deeper forensic \nanalysis of specific systems once movement within the environment has been mapped \nout. \n \n 16. Rebuild systems based on prioritizatio n of critical services  (e.g., health and safety or \nrevenue -generating services), using pre -configured standard images, if possible.  Use \ninfrastructure as code templates to rebuild cloud resources . \n \n 17. Issue password resets for all affected systems and address an y associated \nvulnerabilities and gaps in security or visibility  once the environment has been fully cleaned \nand rebuilt , including any associated impacted accounts and the removal or remediation of \nmalicious persistence mechanisms . This can inclu de applying patches, upgrading software, and \ntaking other security precautions not previously taken.  Update customer -managed encryption \nkeys as needed . \n \n 18. The designated IT or IT security authority declares the ransomware incident over \nbased on establish ed criteria, which may include taking the steps above or seeking outside \nassistance . \n\nTLP: CLEAR  \nPage | 27 TLP: CLEAR  Recovery and Post -Incident Activity  \n 19. Reconnect systems and restore data from offline, encrypted backups based on a \nprioritization of critical services.  \n Take care not to re -infect clean systems during recovery. For example, if a new Virtual \nLocal Area Network (VLAN ) has been created for recovery purposes, ensure only clean \nsystems are added . \n \n 20. Document lessons learned from the incident and associated re sponse activities to \ninform updates to and refine organizational policies, plans, and procedures and guide future \nexercises of the same.  \n \n 21. Consider sharing lessons learned and relevant indicators of compromise with CISA \nor your sector ISAC to benefit ot hers within the community.  \n\nTLP: CLEAR  \nPage | 28 TLP: CLEAR  Contact Information  \nIn responding to any cyber incident, Federal agencies will undertake threat response; asset response; \nand intelligence support and related activities.  \nWhat You Can Expect:  \n Specific guidance to help evaluate and remediate ransomware incidents.  \n Remote assistance to identify the extent of the compromise and recommendations for \nappropriate containment and mitigation strategies (dependent on specific ransomware variant).  \n Phishing email, storage media, log , and mal ware analysis based on voluntary submission . Full-\ndisk forensics can be performed on an as -needed basis.  \n Assistance in conducting a criminal investigation, which may involve collecting incident artifacts, \ninclud ing system images and malware samples.  \nFederal Asset Response Contacts  \nUpon voluntary request, federal asset response include s furnishing technical assistance to affected \nentities to protect their assets, mitigate vulnerabilities, and reduce impacts of cyber incidents; \nidentifying other entitie s that may be at risk and assessing their risk to the same or similar \nvulnerabilities; assessing potential risks to the sector or region, including potential cascading effects, \nand developing courses of action to mitigate these risks; facilitating informat ion sharing and operational \ncoordination with threat response; and providing guidance on how best to utilize Federal resources and \ncapabilities in a timely, effective manner to speed recovery.  \nCISA:  cisa.gov/report  \nCentral@cisa.gov  or call (888) 282 -0870  \nCybersecurity Advisor ( cisa.gov/cisa -regions ): [Enter your local CISA CSAs \nphone number and email address.]  \nMS-ISAC:  For SLTT s, email soc@msisac.org  or call (866) 787 -4722  \nFederal Threat  Response Contacts  \nUpon voluntary request, or u pon notification of partners, federal threat  response includes conducting \nappropriate law enforcement and  national security investigative activity at the affected entitys site; \ncollecting evidence and gathering intelligence; providing attribution; linking related incidents; \nidentifying additional affected entities; identifying threat pursuit and disruption o pportunities; \ndeveloping and executing courses of action to mitigate the immediate threat; and facilitating \ninformation sharing and operational coordination with asset response.  \nFBI:  fbi.gov/con tact-us/field -offices  [Enter your local FBI field office POC \nphone number and email address.]  \nFBI Internet Crime Complaint Center (IC3) at ic3.gov  \nUSSS:  secretservice.gov/contact/field -offices/  [Enter your USSS field office POC \nphone number and email address.]  \n\nTLP: CLEAR  \nPage | 29 TLP: CLEAR  Other Federal Response Contacts  \nNSA:  Cybersecurity Collaboration Center Services and Contact Information  \nOther Response Contacts  \nConsider filling out Table 1 for use should your organization become affected by  ransomware . Consider \ncontacting these organizations for mitigation and response assistance or for notification.  \nTable 1: Response Contacts  Information  \nResponse Contacts:  \nContact  24x7 \nContact \nInformation  Roles and Responsibilities  \nIT/IT Security Team  Centralized Cyber Incident \nReporting    \nDepartmental or Elected Leaders    \nState and Local Law Enforcement    \nFusion Center    \nManaged/Security Service Providers    \nCyber Insurance    \n\nTLP: CLEAR  \nPage | 30 TLP: CLEAR  RESOURCES  \nCISA No -Cost Resources  \n Information sharing with CISA and the MS-ISAC (for SLTT organizations) is bi-directional . This \nincludes  best practices and network defense information regarding ransomware trends and \nvariants as well as malware that is a precursor to ransomware.  \n Policy -oriented or technical assessments help or ganizations understand how they can improve \ntheir defenses to avoid ransomware infection: cisa.gov/cyber -resource -hub. \no Assessments include no-cost Vulnerability Scanning . \n Cyber exercises evaluate or h elp develop a cyber incident response plan in the context of a \nransomware incident scenario : cisa.gov/resources -tools/services/cisa -tabletop -exercise -\npackages . \n CISA cybersecurity advisors advise on best practices and connect you with CISA resources to \nmanage cyber risk.  \n Cyber Security Evaluation Tool  (CSET) guides asset owner s and operators through a \nsystematic process of evaluating operational technology  (OT) and IT. CSET includes the  \nRansomware Readiness Assessment  (RRA), a self -assessment based on a tiered set of \npractices to help organizations evaluate  how well they are equipped to defend and recover from \na ransomware incident . \nContacts:  \n SLTT and private sector organizations:  CISA.JCDC@cisa.dhs.gov  \nRansomware Quick References  \n StopRansomware.gov a whole -of-government website that gives ransomware resources and \nalerts.  \n Security Primer  Ransomware (MS -ISAC) outlines opportunistic and strategic ransomware \ncampaigns, common infection vectors, and best practice recommendations . \n Institute for Security + Technology (IST) Blueprint for Ransomware Defense an action plan for \nransomware mitigation, response, and recovery for small- and medium -sized enterprises . \nAdditional Resources  \n NIST : Zero Trust Architecture  \n CISA: Cloud Security Technical Reference Architecture  \n CISA: Secure Cloud Business Applications (SCuBA) Project  \n CISA: Mitigations and Hardening Guidance for MSPs and Small - and Mid -sized Businesses   \n CISA: Protecting Against Cyber Threats to Managed Service Providers and their Customers   \n NSA: Mitigating Cloud Vulnerabilities  (NSA)  \n\nTLP: CLEAR  \nPage | 31 TLP: CLEAR  DISCLAIMER OF ENDORS EMENT  \nThe information and opinions contained in this document are provided \"as is\" and without any \nwarranties or guarantees. Reference herein to any specific commercial products, process, or service by  \ntrade name, trademark, manufacturer, or otherwise, does not constitute or imply its endorsement, \nrecommendation, or favoring by the United States Government, and this guidance shall not be used for \nadvertising or product endorsement purposes.  \nPURPOSE  \nThis document was developed in furtherance of the authors cybersecurity missions, including their \nresponsibilities to identify and disseminate threats, and to develop and issue cybersecurity \nspecifications and mitigations. This information may be shared broad ly to reach all appropriate \nstakeholders.  \nACKNOWLEDGEMENTS  \nMicrosoft contributed to this joint guide.  \n\n",
  "cves": [],
  "techniques": [],
  "advisory": "cybersecurity-alerts",
  "title": "csi-stopransomware-guide",
  "source": "nsa",
  "id": "239cf1a14b10f775f8018b08e130d01489b56696d17f6495f16f5e4e219a2e88"
}