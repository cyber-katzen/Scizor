{
  "markdown": "TLP:WHITE  \nSECURITY GUIDANCE FOR 5G \nCLOUD INFRASTRUCTURES  \nPart I: \nPrevent and Detect Lateral Movemen t \n2021\n\nPart I: Prevent and Detect Lateral Movement  i \n \nTLP:WHITE  DISCLAIMER OF ENDORSEMENT  \nThe guidance in this document is provided as is. In no event shall the United States \nGovernment be liable for any damages arising in any way out of the use of or reliance on this \nguidance. Reference herein to any specific commercial product, process, or service by trade \nname, trademark, manufacturer, or otherwise, does not constitute or imply its endorsement, \nrecommendation , or favoring by the United States Government, and this guidance shall not \nbe used for advertising or product endorsement purposes. Al l trademarks are the property of \ntheir respective owners.  \nPURPOSE  \nNSA and CISA developed this document in furtherance of their respective cybersecurity \nmissions, including their responsibilities to develop and issue cybersecurity specifications \nand mitigat ions. This information may be shared broadly to reach all appropriate \nstakeholders.  \nCONTACT  \nClient Requirements / Inquiries : Enduring Security Framework nsaesf@cyber.nsa.gov   \nMedia Inquiries / Press Desk : \n NSA  Media Relations , 443 -634 -0721, MediaRelations@nsa.gov   \n CISA  Media Relations, 703 -235-2010, CISAMedia@cisa.dhs.gov   \n\nii Part I: Prevent and Detect Lateral Movement\nTLP:WHITE  TABLE OF CONTENTS  \nBackground  ................................ ................................ ................................ ................................ ................................ . 1 \nScope  ................................ ................................ ................................ ................................ ................................ ..........  1 \n5G Cloud Security Challenge Overview  ................................ ................................ ................................ ...... 1 \n5G Threat  ................................ ................................ ................................ ................................ ................................ . 2 \n5G Cloud Security Guidance  ................................ ................................ ................................ ............................  2 \nPrevent and Detect Lateral Movement in the 5G Cloud ................................ ................................ ...........  4 \nImplement Secure Identity and Access Management (IdAM) in the 5G Cloud  .........................  4 \nKeep 5G Cloud Software Up -to-Date and Free from Known Vulnerabilities  .............................  6 \nSecurely Configure Networking within the 5G Cloud  ................................ ................................ ..........  6 \nLock Down Communications Among Isolated Network Functions ................................ ................  7 \nMonitor for Indications of Adversarial Lateral Movement  ................................ ................................  8 \nDevelop and Deploy Analytics to Detect Sophisticated Adversarial Presence  ..........................  9 \nConclusion  ................................ ................................ ................................ ................................ ................................  10 \n\nPart I: Prevent and Detect Lateral Movement  1 \n \nTLP:WHITE  BACKGROUND  \nThe Enduring Security Framework (ESF) hosted a 5G study group comprised of government \nand industry experts over the course of eight weeks during the summer of 2020 to explore \npotential threat vectors and vulnerabilities inherent to 5G infrastructures. At the conclusion \nof the study the group recommended  a three -pronged approach t o explore this threat space1: \n1. Identify and assess threats posed to 5G;  \n2. Determine what standards and implementations can achieve a higher baseline of 5G \nsecurity;  and \n3. Identify risks inherent to the cloud that affect 5G security.  \nIn support of this task, t he ESF established a  5G Cloud Working Panel to engage with experts \nacross government and industry to document 5G cloud security challenges, threats , and \npotential mitigations, to include guidance, standards , and analytics. The result of this \ncollaboration is a four -part series of publications that addresses the third task identified by \nthe 5G study group : applying a threat -based  approach to identify and mitigate risks in 5G \nnetworks that derives from the use of cloud technologies , and providing mitigations that can \nbe applied to harden 5G cloud  infrastructures . \nSCOPE  \nThis four -part series builds on the ESF Potential Threat Vectors to 5G Infrastructure  white \npaper , released in May 202 1, which focused specifically on threat s, vulnera bilities , and \nmitigations  that apply to the deployment of 5G  cloud  infrastructures .2 \nAlthough all 5G network stakeholders can benefit from this guidance, the recommendations \nare intended for service providers  and system integrators  that build and configure 5G cloud \ninfrastructures . This includes core network equipment vendors, cloud service providers , \nintegrators, and mobile net work operators. The audience for each set of recommendation s \nwill be identified  throughout the series, providing a layered approach to building hardened \n5G cloud deployments.  \n5G CLOUD SECURITY CHALLENGE OVERVIEW  \n5G networks are being designed to handle the bandwidth, compute , and storage \nrequirements that will be required for a predicted massive increase in network capacity as \n \n1 The ESF is a cross -sector working group that operates under the auspices of Critical Infrastructure Partnership \nAdvisory Council (CIPAC) to address threats and risks to the security and stability of U.S. national security \nsystems. It is comprised of experts from the U.S. government as well as representatives from the Information \nTechnology, Communications, and the D efense Industrial Base sectors. The ESF is charged with bringing \ntogether representatives from private and public sectors to work on intelligence -driven, shared cybersecurity \nchallenges.  \n2 ESF, Potential Threat Vectors to 5G Infrastructure , 2021.  https://w ww.nsa.gov/news -features/press -\nroom/Article/2601078/nsa -odni -and-cisa-release -5g-analysis -paper  \n\n2  Part I: Prevent and Detect Lateral Movement  \n \nTLP:WHITE  well as connected devices. For scalability, resilience,  and agility, 5G networks leverage cloud \ninfrastructures , both in t he radio access network, core , and network edge. Cloud technologies \nunderpin the implementation of virtual networking in 5G, enabling the dynamic allocation \nand management of networks for specific use cases, mobile network operators , or customers.  \nA charac teristic of cloud infrastructure that presents a significant security challenge in 5G is \nmultitenancy, the use of a shared physical infrastructure by multiple cloud infrastructure \ncustomers, e.g., mobile network operators. Multitenancy highlights the need to harden and \nsecurely configure technologies that isolate the workloads (e.g., virtualization/  \ncontainerization) for each of those customers. In addition, cloud providers and mobile \nnetwork operators may share security responsibilities in a manner that re quires the \noperators to take responsibility to secure their tenancy in the cloud. An additional factor \ncreating security challenges is the increasing deployment of a multi -cloud deployment model \nin 5G with diverse and evolving architectures and design ap proaches used by wireless \ncarriers.  \n5G THREAT  \nAmong the threat vectors presented in the Potential Threat Vectors to 5G Infrastructur e \nanalysis paper , several pertain ed to 5G cloud infrastructure , including Software/  \nConfiguration , Network Security , Network Slicing , and Software Defined Networking .  \n5G networks , which are cloud -native,  will be a lucrative target for cyber threat actors who \nwish to deny or degrade network resources or otherwise compromise information. To \ncounter this threat, it is impe rative that 5G cloud  infrastructure s be built and configured \nsecurely , with capabilities in place to detect and respond to threat s, providing a hardened \nenvironment for deploying secure network functions. It is also  important that 5G network \nfunctions be i mplemented using security best practices. This  four -part  series will address the \nformer, providing guidance on hardening 5G cloud infrastructure deployments that are \ndriven by threat information.  This approach supports the May 2021 Presidential Executive \nOrder on Improving the Nations Cybersecurity , which called for secure  products and services  \nand enabling easier detection of unexpected behaviors and actions.3 \n5G CLOUD SECURITY GUIDANCE  \nBased on preliminary analysis and threat assessment, the Cloud Working Panel concluded \nthat the top 5G cloud infrastructure security challenges could be divided into a four -part \nseries that address ed different aspects of securing 5G clouds, facilitating the application of \nbroad sets of mitigations.  \n \n3 Executive Office of the President , Executive Order on Improving the Nations Cybersecurity , 2021 . \nhttps://www.whitehouse.gov/briefing -room/presidential -actions/2021/05/12/executive -order -on-\nimproving -the-nations -cybersecurity  \n\nPart I: Prevent and Detect Lateral Movement  3 \n \nTLP:WHITE   Part  I: Prevent and Detect Lateral Movement : Detect malicious cyber actor activity \nin 5G clouds and prevent actors from leveraging the compromise of a single cloud \nresource to compromise the entire network . \n Part  II: Securely Isolate Network Resources : Ensure that there is secure isolation \namong customer resources with emphasis on securing the container stack that \nsupports the running of virtual network functions.  \n Part  III: Protect Data in Transit , In-Use, and at Rest : Ensure that network and \ncustomer data is secure d during all phases of the data lifecycle (at -rest, in transit, while \nbeing processed, upon destruction).  \n Part  IV: Ensu re I ntegrity of  Infrastructure : Ensure that 5G cloud resources (e.g., \ncontainer images, templates, configuration) are not modified withou t authorization.  \nZero Trust is the concept that perimeter defenses are no longer sufficient to secure a network, \nand that there should always be an assumption that a threat actor has established a f oothold \nin the network4. This four -part series will document best practices that strive to bring a Zero \nTrust mindset into 5G cloud endpoints and growing multi -cloud  environments. All actions \nshould be explicitly verified and monitored . Although the best practices documented in th is \nseries do not constitute a complete Zero Trust template for securing 5G cloud infrastructures,  \nif the best practices are applied , a 5G cloud environment will have made  significant strides \ntoward the implementation  of Zero Trust principles.  \n \n4 NIST Special Publication 800 -207. Zero Trust Architectures . \nhttps://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800 -207.pdf  \n\n4  Part I: Prevent and Detect Lateral Movement  \n \nTLP:WHITE   \nPREVENT AND DETECT LATERAL MOVEMENT IN THE 5G CLOUD  \nEffective network cybersecurity practices involve defending the perimeter while recognizing \nthat attackers sometimes successfully penetrate perimeter defenses, requiring the \nimplementation of controls tha t detect and prevent  adversarial activities on the network. This \nZero Trust mindset places an emphasis on locking down internal resources along with an \nintensive logging and monitoring regime. Attackers commonly follow initial exploitation of a \nnetwork wit h attempts to pivot laterally, taking advantage of misconfigurations, \nvulnerabilities, or other weaknesses in a network to gain a more extensive presence. Zero \nTrust practices (e.g., explicit and continuous authorization, extensive logging) help  detect and  \nprevent  this category of adversarial activity.  \n5G cloud native deployments are susceptible to attacks at several points, including the \nexploitation of web vulnerabilities in the administration portals used by customers and \nnetwork operators, in the 5G cor e via malicious  or vulnerable  applications  and \nmisconfigurations in the virtual networking stack or in the core/RAN clouds. Whatever initial \nposition an attacker starts from, it is critical that controls be placed at all layers of  the cloud \nto detect the a dversarial presence and prevent the attacker from moving further.  \nPart I of this series presents guidance for mitigating lateral movement attempts by attackers \nwho have successfully exploited a vulnerability to gain initial access into a 5G cloud system. \nAlthough this  part  focuses on a few critical areas, from a Zero Trust perspective , following the \nguidance provided in the other three  parts  of this series  is equally important.  \nIMPLEMENT SECURE IDENTITY AND ACCESS MANAGEMENT (IDAM)  IN THE 5G CLOUD  \nAfter the initial compromise of a network, attackers commonly pivot laterally by exploiting \nthe availability of internal services, particularly looking for services that are unauthenticated.  \nFor example, an attacker might use an initial position on a comp romised virtual machine (VM) \n\nPart I: Prevent and Detect Lateral Movement  5 \n \nTLP:WHITE  or container to access an application programming  interface ( API) or service endpoint that is \nnot exposed externally.  5G cloud deployments will introduce more opportunities to move \nlaterally in this manner because they support  new implementations such as Service -Based \nArchitecture (SBA), containers, and VMs that result in more element -to-element \ncommunications than in previous networks that utilized physical appliances and point -to-\npoint interfaces.  Reducing the risk of these types of attacks, both at the network -function \nlayer as well as the underlying cloud infrastructure layer, is a critical activity for reducing the \noverall risk of lateral movement.  \nAudience: Cloud Providers, Mobile Network Operators  \nGuidance/Mitigations  \n 5G networks should assign unique identities to all elements (and preferably to each \ninterface) that will communicate to other elements in the 5G network.   \n Before allowing access to a resource (e.g., Application Prog ramming Interface  (API), \nCommand Line Interface  (CLI) ), each network element should authenticate and \nauthorize the entity requesting access.   \n Where possible, identities should be assigned using Public Key Infrastructure X.509 \ncertificates from a trusted certificate authority (CA) rather than username/password \ncombinations5.   \n If username/passwords must be used, multi -factor authentication (MFA) should be \nenabled to reduce the risk of compromise.   \n The 5G network should provide automated mechanisms for credential management, \nespecially as thes e features become more readily integrated in modern cloud \nenvironments (e.g., certificate rotation via a Service Mesh).  \n Where possible, use certificate pinning or public key pinning to provide additional \nidentity assurance when authentication is dependent upon multiple CAs. Certificate \npinning and public key pinning associate a host with an expected certificate reducing \nthe impact from a compromised CA.  \n All access to resources should be logged. Each log entry should contain the time, \nresource, requesting e ntity (name or service), information about the requesting \nentitys location (region, IP address) , and result of the access request (allow, deny).  \nLogs should be protected as described in Part II I: Protect Data in Transit, In -Use, and \nat Rest  of this series.  \n Analytics for detecting potentially malicious resource access attempts should be \ndeployed and run regularly.  \n \n5 Federal Public Key Infrastructure Guide Introduction. https://playbooks.idmanagement.gov/fpki/  \n\n6  Part I: Prevent and Detect Lateral Movement  \n \nTLP:WHITE  KEEP 5G CLOUD SOFTWARE UP-TO-DATE AND FREE FROM KNOWN VULNERABILITIES  \n5G cloud native deployments rely on the secure coordination of multiple services built from \nheterogeneous software sources. In addition to the basic services that make up a typical cloud, \n5G clouds may deploy open source or specialized services to support network slicing, \nincluding third party applications that imp lement virtual network functionality. \nVulnerabilities in any of this software could be exploited by an attacker to gain initial access \ninto the 5G cloud infrastructure or enable an attacker , who has established a foothold in the \ncloud , to move laterally.  \nSoftware vulnerabilities fall into three categories: publicly known with a patch available from \nthe software vendor; publicly known without a patch (n -day) ; and not publicly known (0 -\nday). Although measures should be taken to mitigate the risk of n -day and  0-day \nvulnerabilities, patching publicly known vulnerabilities as quickly as possible significantly \nreduces the risk of exploitation. Maintaining the security of software used within 5G cloud \nenvironments is critically important to preventing adversarial lateral movement.  \nThe guidance in this section applies to all software that runs in 5G cloud infrastructures, \nincluding the cloud/virtual networking software, as well the management and orchestration \ncode for deploying virtual networks and any other integr ated applications. All organizations \nthat deploy software to the cloud have a responsibility to maintain secure software \ndevelopment practices.  \nAudience : Cloud Providers, Mobile Network Operators, Customers  \nGuidance/Mitigations  \n Refer to NIST Special Public ation (SP) 800 -40, Guide to Enterprise Patch Management \nTechnologies.  \n Integrate source code scanning and patching into the software development  and \ndeployment  process:  \no Regularly scan software repositories for known vulnerabilities and out -of-date \nversions  using one or more software scanning tools or services;  \no Regularly monitor third party applications and libraries that are integrated \ninto the network slicing infrastructure for publicly reported vulnerabilities;  \no Patch critical vulnerabilities in the operational environment within [policy -\ndefined, suggested : < 15] days and other vulne rabilities within [policy -defined, \nsuggested : <60] days.  \nSECURELY CONFIGURE NETWORKING WITHIN THE 5G CLOUD  \nIn a 5G cloud native deployment, two network functions , or microservices , may be sitting in \nthe same logical network segment but may be members of two completely different security \n\nPart I: Prevent and Detect Lateral Movement  7 \n \nTLP:WHITE  groups based on their functions. A security group may be constructed using a Network Access \nControl List (ACL) or a stateful firewall that determine s which outbound or inbound \nconnections are permitted , or a network slice instantiation . The same principle should also \napply to underlying infrastructure. For example, a Kubernetes (K8s) cluster with Control \nPlane and Worker networks, should use  networkin g functions (subnetting and stateful \nfirewall/ACL) to control which nodes can communicate would add an additional layer of \nsecurity.  \nAudience : Cloud Providers, Mobile Network Operators  \nGuidance/Mitigations  \n Create security groups per K8s Pod. Security groups for Pods make it easy to achieve \nnetwork security compliance by running applications with varying network security \nrequirements on shared compute resources.  \n Use private networking for connecting microservices/network functions.  This cou ld \nbe facilitated by a container networking plugin that enables attaching multiple \nnetwork interfaces to Pods.  \n Configure default firewall rules or default ACLs to block inbound and outbound \nconnections at the Pod and worker node level.  This is commonly p rovided by \nKubernetes Network Policies.  Some container networking interfaces6 have enhanced \nfiltering to protect the host on which K8s is deployed from Pod- and cluster -external \ntraffic. 7  \n Use Service Meshes to protect node -to-node traffic.  Service Me shes, in the context of \nnetworking, can provide end -to-end authentication and service monitoring through \nthe use of side cars, which are containers injected into each Pod.  These side cars \nprovide a proxy through which all TCP traffic is forced to traver se via Netfilters \nREDIRECT rules.  This proxy can provide a mutual , TLS authenticated and encrypted \nconnection between Pods in a cloud -native deployment. This protects Pods from \nexternal and Pod-to-Pod attacks.  \nLOCK DOWN COMMUNICATIONS AMONG ISOLATED NETWORK FUNCTIONS  \n5G network implementations can have significantly more communication sessions between \nnetwork elements than in 4G  LTE .  A network function (NF) can communicate over the control \nplane, user plane, management plane , and through the  cloud infrastructure. The network \nelements may be isolated to meet the security requirements of the customer, network slice , \nor use case. Communications paths that rely on insecure authentication mechanisms , or that \nare not locked down sufficiently by pol icy, could be used as a lateral movement path by an \nattacker, allowing the attacker to change between planes or pivot to gain privileges on \n \n6 Container Network Interface (CNI) is a Cloud Native Computing Foundation project that provides networking \nfor Linux containers. https://github.com/co ntainernetworking  \n7 CIS Benchmarks Securing Kubernetes, 2021. https://www.cisecurity.org/benchmark/kubernetes/  \n\n8  Part I: Prevent and Detect Lateral Movement  \n \nTLP:WHITE  another set of isolated network resources. To effectively prevent and detect lateral \nmovement, the 5G network must p rovide mechanisms to ensure that all such communication \nsessions are authorized,  and policy is enforced over network resources in the same security \ngroup.  \nAudience:  Cloud Providers, Mobile Network Operators  \nGuidance/Mitigations  \n 5G networks should ensure that all communication sessions on an NFs control plane, \nuser plane, management plane , and through the cloud infrastructure are authenticated \nusing the identities provisioned from the Identity and Authorization session.  For \nexample, these sessions  could use mutually -authenticated TLS v1.2+ where the X.509 \ncertificates are the identities that are authenticated.  \n Policies should be created and deployed that enforce the separation of network \nresources in the same security group based on secure authenti cation and \nauthorization.  \nMONITOR FOR INDICATIONS OF ADVERSARIAL LATERAL MOVEMENT  \nAn attacker who has stolen legitimate, authorized user credentials or has exploited a \nvulnerability in the 5G cloud deployment and attempts to laterally move from within the \nmobile network operator s (MNO ) network equipment will likely leave evidence of this \nmovement. It is critical to  continuously  monitor for evidence of exploitation and adversarial \nlateral movement within 5G cloud deployments .8 \nAudience:  Cloud Providers, Mobile Network Operators  \nGuidance/Mitigations  \n Suppose that a threat actor has obtained the legitimate credentials of an employee \nwith access to the Operations, Administration, and Management (OA&M) section of a \nparticular node within the 5G network cloud ecosystem.  Most network equipments \nOA&M interfaces should be on the protected OA&M internal protected network, \nwhereby:  \no Users would have to gain access to an adjacent network that allows connection \ndirectly to the domain that the 5G netwo rk cloud OA&M equipment lives on ; \no Threat  actors  would have to gain access to the network first . \n \n8 FedRAMP Continuous Monitoring Strategy Guide  \nhttps://www.fedramp.gov/assets/resources/documents/CSP_Continuous_Monitoring_Strategy_Guide.pdf  \n\nPart I: Prevent and Detect Lateral Movement  9 \n \nTLP:WHITE   Most network equipment within the cloud is containerized ; again , without \ncredentialed access you cannot break from one container to another.  \n A threat  actor would then have to compromise several security protections in place, \nbut assuming they do, there are several indicators that can be monitored to help detect \nthis type of malicious activity : \no Scanning behaviors or the opening of unusual ports between one network \nnodes OA&M interfaces and another node s OA&M interfaces ; \no User  behavior abnormalities (time of day usage, type of activity usage) ; \n Network communication abnormalities .  \no To execute  exploits or extract information, the network may begin \ncommunic ating in unusual ways, not necessarily to known bad IPs , but to \ninternal systems with which the network does not normally communicate . \n Pod/container logging abnormalities, such as unexpected system calls.  \no Container breakouts often rely on execution that is atypical for the \ncontainerized application. This anomalous behavior can be identified through \ncomparison  against a baseline of Pod behav ior or through machine learning or \nAI-enabled security auditing.  \nDEVELOP AND DEPLOY ANALYTICS TO DETECT SOPHISTICATED ADVERSARIAL PRESENCE  \nDetecting the presence of attackers or other security incidents within 5G cloud native \ndeployments is challenging du e to the massive amounts of network traffic and IdAM events \noccurring regularly. Sophisticated analytics, based on machine learning and artificial \nintelligence, can help detect adversarial activity within the cloud and provide  the 5G \nstakeholder  with the m eans to detect malicious use of customer cloud resources (e.g., \nnetworks, accounts).  \nThe effectiveness of each analytic at detecting threat depends on the layer within the cloud as \nwell as the 5G stakeholder that is deploying the analytic. 5G cloud provid ers may deploy \nanalytics to detect low level attacks, such as hypervisor or container break -outs. MNOs may \ndeploy analytics to detect the malicious use of network credentials. Each stakeholder must \nunderstand its role in threat detection and incident respo nse.  \nBalancing data confidentiality requirements with the ability to inspect network traffic for \nthreat s is a challenging problem when developing analytics. The effectiveness of break and \ninspect and other techniques that require exposure to unencrypted network traffic must be \nweighed against privacy concerns and legal requirements. Analytics deployed at all layers \nmust make risk decisions regarding analytic data requirements.  \n\n10  Part I: Prevent and Detect Lateral Movement  \n \nTLP:WHITE  Audience:  Cloud Providers, Mobile Network Operators  \n \nGuidance/Mitigations  \n Stakeholders at all layers of the 5G cloud stack should leverage an analytic platform to \ndevelop and deploy analytics that process relevant data (cloud logs and other \ntelemetry) available at that layer. The analytics should be capable of detecting known \nand anticipated threat, but also be designed to identify anomalies in the data that could \nindicate unanticipated threat.  \nCONCLUSION  \nAn a ttacker can use cloud/virtual networking to move through a network after initial \ncompromise.  Configuration s to prevent and detect lateral movements is only one aspect of \nhardening a 5G cloud infrastructure.  The detection and mitigation of lateral movement \nattempts within a 5G cloud system is a shared responsibility among 5G cloud providers, \nnetwo rk operators, mobile network operators and customers.    \nIn Part II: Securely Isolat e Network Resources , the following topics  will be addressed : \n Enabling isolation of Kubernetes Pod resources, such as limiting capabilities and \npermissions on deployed containers . \n Cryptographically isolating critical containers from infrastructure/hosts using \ntrusted execution environments . \n Applying good container security hygiene to avoid resource con tention and Denial \nof Service attacks . \n Implementing real -time threat detection and incident response through \nminimizing noise, curating  baseline behavior, and aler ting on anomalous activity.  \n\n",
  "cves": [],
  "techniques": [],
  "advisory": "cybersecurity-alerts",
  "title": "security_guidance_for_5g_cloud_infrastructures_part_i_20211028",
  "source": "nsa",
  "id": "1c72910cd6da187294a670b944a8c35d8a50e293ced07322a3d6ca46f245066f"
}