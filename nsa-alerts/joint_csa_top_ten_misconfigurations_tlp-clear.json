{
  "markdown": " \n \n   \nTLP:CLEAR  \n \nThis information is marked TLP:CLEAR. Recipients may share this information without restriction. Information is \nsubject to standard copyright rules. For more information on the Traffic Light Protocol, see cisa.gov/ tlp/. \n \nU/OO/ 208840 -23 | PP-23-3322  | OCT  2023 Ver. 1.0 TLP:CLEAR  |  Joint Cybersecurity Advisory  \nCybersecurity and \nInfrastructure \nSecurity  \nAgency  \nNational  \nSecurity  \nAgency  \nNSA and C ISA Red and Blue Teams Share Top Ten  \nCybersecurity Misconfigurations  \nA plea for network defenders and software manufacturers to fix common problems . \nExecutive summary  \nThe National  Security Agency (NSA) and Cybersecurity  and Infrastructure Security \nAgency ( CISA) are releasing this joint c ybersecurity advisory (CSA) to highlight  the \nmost common cybersecurity misconfigurations  in large organizations , and detail the  \ntactics, te chniques, and procedures  (TTPs) actors use to  exploit these \nmisconfigurations . \nThrough NSA and CISA Red and Blue team assessments , as well as through the \nactivities of NSA and CISA Hunt and Incident R esponse team s, the agencies identified \nthe following 10 most common network misconfigurations : \n1. Default configurations of software  and applications  \n2. Improper separation of user/administrator privilege  \n3. Insufficient internal network monitoring  \n4. Lack of network segmentation  \n5. Poor patch management  \n6. Bypass of system access c ontrols  \n7. Weak or misconfigured multifactor authentication (MFA) methods  \n8. Insufficient access control lists (ACLs) on network shares  and services  \n9. Poor credential hygiene  \n10. Unrestricted code execution  \nThese misconfigurations illustrate (1) a trend of systemic weaknesses  in many  large \norganizations , including  those with mature cyber postures , and (2) the importance of  \nsoftware manufacturers embracing  secure -by-design principles to reduce the burden on \nnetwork defenders : \n Properly trained, staffed, and funded network security teams  can implement  the \nknown mitigations  for these weaknesses . \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  2 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \n Software manufacturers must reduce the prevalence of these \nmisconfigurations thus strengthening the security posture for customers by \nincorporating  secure -by-design and -default principles  and tactics into their \nsoftware developm ent practices .[1]  \nNSA and CISA encourage  network defenders to implement the recommendations found \nwithin the Mitigations  section of this advisory including the following to reduce the \nrisk of malicious actors exploiting the identified misconfigurations.  \n Remove  default credent ials and harden configurations . \n Disable unused services and implement access controls . \n Update regularly and a utomate patching , prioritiz ing patching of known exploited \nvulnerabilities .[2] \n Reduce, restrict, audit, and monitor administrative accounts and privileges . \nNSA and CISA urge software manufacturers to t ake ownership of improving security \noutcomes of their customers by e mbrac ing secure -by-design  and-default  tactics , \nincluding:  \n Embed ding security controls into product architecture from the start of \ndevelopment and throughout the entire softwa re development lifecycle (SDLC) . \n Eliminat ing default passwords . \n Provid ing high-quality audit logs to custom ers at no extra charge . \n Mandat ing MFA, ideally phishing -resistant , for privileged users and mak ing MFA \na default rather than opt -in feature .[3] \n  \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  3 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \nContents  \nNSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  . 1 \nExecutive summary  ................................ ................................ ................................ .........  1 \nTechnical details  ................................ ................................ ................................ .............  6 \nOverview  ................................ ................................ ................................ ......................  6 \n1. Default configura tions of software and applications  ................................ .................  7 \nDefault credentials  ................................ ................................ ................................ ... 7 \nDefault service permissions and configuration settings  ................................ ............  8 \n2. Improper sepa ration of user/administrator privilege  ................................ .................  9 \nExcessive account privileges  ................................ ................................ .................  10 \nElevated service account permissions  ................................ ................................ ... 10 \nNon-essential use of elevated accounts  ................................ ................................ . 11 \n3. Insufficient internal network monitoring ................................ ................................ .. 11 \n4. Lack of network segmentation  ................................ ................................ ...............  12 \n5. Poor patch management  ................................ ................................ .......................  12 \nLack of regular patching  ................................ ................................ .........................  12 \nUse of unsupported OSs and outdated firmware  ................................ ...................  13 \n6. Bypass of system access controls  ................................ ................................ .........  13 \n7. Weak or misconfigured MFA methods  ................................ ................................ ... 13 \nMisconfigured smart cards or tokens  ................................ ................................ ..... 13 \nLack of phishing -resistant MFA  ................................ ................................ ..............  14 \n8. Insufficient ACLs on network shares and services  ................................ ................  14 \n9. Poor credential hygiene  ................................ ................................ .........................  15 \nEasily crackable passwords  ................................ ................................ ...................  15 \nCleartext password disclosure  ................................ ................................ ...............  16 \n10. Unrestricted code execution  ................................ ................................ ................  16 \nMitigations  ................................ ................................ ................................ .....................  17 \nNetwork defenders  ................................ ................................ ................................ .... 17 \nMitigate default configurations of software and applications  ................................ .. 17 \nMitigate improper separation of user/administrator privilege  ................................ .. 19 \nMitigate insufficient internal network monitoring  ................................ .....................  20 \nMitigate lack of network segmentation  ................................ ................................ ... 21 \nMitigate poor patch management  ................................ ................................ ...........  22 \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  4 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \nMitigate bypass of system access controls  ................................ ............................  23 \nMitigate weak or misconfigured MFA methods  ................................ .......................  24 \nMitigate insufficient ACLs on network shares and services  ................................ .... 25 \nMitigate poor credential hygiene  ................................ ................................ ............  25 \nMitigate unrestricted code execution  ................................ ................................ ...... 27 \nSoftware manufacturers ................................ ................................ .............................  28 \nValidate security controls  ................................ ................................ ..............................  32 \nLearn from history  ................................ ................................ ................................ .........  32 \nWorks cite d ................................ ................................ ................................ ...................  33 \nAppendix: MITRE ATT&CK tactics and techniques  ................................ .......................  37 \n \nTables  \nTable 1: Recommendations for network defenders to mitigate default configurations of \nsoftware and applications  ................................ ................................ ..............................  17 \nTable 2: Recommendations for network defenders to mitigate improper separation of \nuser/administrator privilege  ................................ ................................ ...........................  19 \nTable 3: Recommendations for network defenders to mitigate insufficient internal \nnetwork monitoring  ................................ ................................ ................................ ........  20 \nTable 4: Recommendations for network defenders to mitigate lack of network \nsegmentation  ................................ ................................ ................................ .................  21 \nTable 5: Recommendations for network defenders to mitigate poor patch management\n ................................ ................................ ................................ ................................ ...... 22 \nTable 6: Recommendations for network defenders to mitigate bypass of system access \ncontrols  ................................ ................................ ................................ ..........................  23 \nTable 7: Recommendations for network defenders to mitigate weak or misconfigured \nMFA methods  ................................ ................................ ................................ ................  24 \nTable 8: Recomme ndations for network defenders to mitigate insufficient ACLs on \nnetwork shares and services  ................................ ................................ .........................  25 \nTable 9: Recommendations for network defenders to mitigate poor credential hygiene  25 \nTable 10: Recommendations for network defenders to mitigate unrestricted  code \nexecution  ................................ ................................ ................................ .......................  27 \nTable 11: Recommendations for software manufacturers to mitigate identified \nmisconfigurations  ................................ ................................ ................................ ..........  28 \nTable 12: ATT&CK Techniques for Enterprise  Reconnaissance  ................................  37 \nTable 13: ATT&CK Techniques for Enterprise  Initial Access  ................................ ..... 37 \nTable 14: ATT&CK Techniques for Enterprise  Execution  ................................ ...........  38 \nTable 15: ATT&CK Techniques for Enterprise  Persistence  ................................ ........  39 \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  5 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \nTable 16: ATT&CK Techniques for Enterprise  Privilege Escalation  ...........................  39 \nTable 17: ATT&CK Techniques for Enterprise  Defense Evasion  ...............................  40 \nTable 18: ATT&CK Techniques for Enterprise  Credential Access  .............................  40 \nTable 19: ATT&CK Techniques for Enterprise  Discovery  ................................ ...........  42 \nTable 20: ATT&CK Techniques for Enterprise  Lateral Movement  ..............................  43 \nTable 21: ATT&CK Techniques for Enterprise  Collection  ................................ ...........  43 \n  \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  6 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \nTechnical details  \nNote:  This advisory uses the MITRE ATT&CK for Enterprise  framework, version 13 , \nand the MITRE D3FEND  cybersecurity countermeasures framework .[4],[5] See the \nAppe ndix: MITRE ATT&CK tactics and techniques  section for  table s summarizing  the \nthreat actors activity mapped to MITRE ATT&CK tactics and techniques , and the \nMitigations  section for MITRE D3FEND countermeasures .  \nFor assistance with mapping  malicious cyber activity  to the MITRE ATT&CK framework, \nsee CISA  and MITRE ATT&CKs Best Practices for MITRE ATT&CK Mapping  and \nCISAs Decider Tool .[6],[7] \nOverview  \nOver the years, the following NSA and CISA teams have assessed the security posture \nof many network enclaves across the  Department of Defense  (DoD); Federal Civilian \nExecutive Branch ( FCEB ); state, local, tribal, and territorial  (SLTT ) governments ; and \nthe private secto r: \n Depending on the needs of the assessment, NSA Defensive Network Operations \n(DNO ) teams feature  capabilities from Red Team (adversary emulation), Blue \nTeam (strategic vulnerability assessment), Hunt (targeted hunt ), and/or Tailored \nMitigations (defensive countermeasure development ). \n CISA Vulnerability Management (VM) teams have assessed the security posture \nof over 1,000 network enclaves . CISA VM teams include Risk and Vulnerability \nAssessment (RVA)  and CISA Red Team Assessments  (RTA) .[8] The RVA team \nconducts remote and onsite assessment services, including penetration testing \nand configuration review. RTA emulates cyber threat actors  in coordination with \nan organization  to assess the organizations cyber detection and response \ncapabilities . \n CISA Hunt and Incident Response teams conduct proactive and reactive \nengagement s, respectively , on organization networks to identify and detect  cyber \nthreats to U.S. infrastructure.  \nDuring  these assessments, NSA and CISA identified the  10 most common network \nmisconfigurations , which are  detailed below.  These misconfigurations ( non-prioritized) \nare systemic weaknesses across many networks.  \nMany of the assessments were of Microsoft Windows and Active Directory \nenvironments . This advisory  provide s details about , and mitigations for , specific issues \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  7 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \nfound during these assessments, and so mostly focuses on these products . However, it \nshould be noted that many other environments contain  simila r misconfiguration s. \nNetwork owners and operators should examine their networks for similar \nmisconfigurations even when running other software not specifically mentioned below.  \n1. Default configurations of software and applications  \nDefault configurations o f systems, services, and applications can permit unauthorized \naccess  or other malicious activity . Comm on default configurations include : \n Default c redentials  \n Default  servic e permissions and configurations  settings  \nDefault credentials  \nMany software manufacturers release  commercial off -the-shelf (COTS) network devices  \nwhich provide  user access via applications or web portals containing  predefined \ndefault credentials for their built-in administrative accounts .[9] Malicious actors and \nassessment  teams regularly  abuse  default credentials by: \n Finding  credentials with a simple web search [ T1589.001 ] and using them \n[T1078.001 ] to gain authenticated access to a device.  \n Resetting built -in administrative accounts [ T1098 ] via predictable forgotten \npasswords questions.  \n Leveraging default virtual private network ( VPN) credentials  for internal network \naccess  [T1133 ]. \n Leveraging publicly available setup information to identify built-in administrative \ncredentials for web application s and gaining access to the application and its \nunderlying database.  \n Leveraging default credentials on software deployment tools [ T1072 ] for code \nexecution and lateral movement.  \nIn addition to devices that provide network access, printers, scanners, security cameras, \nconference room audiovisual (AV) equipment, voice over internet p rotocol  (VoIP) \nphones, and internet  of things  (IoT) devices commonly contain  default credentials  that \ncan be used for easy unauthorized access to these devices as well . Further \ncompounding this problem, p rinters and scanners may have privileged domain accounts \nloaded so that users can easily scan documents  and upload them to a share d drive  or \nemail them . Malicious actors who gain access to a printer or scanner using default \ncredentials can use the loaded privileged domain accounts to move laterally from the \ndevice and compromise the  domain  [T1078.002 ]. \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  8 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \nDefault  service permissions and configuration  settings  \nCertain services may have  overly permissive access controls or vulnerable \nconfigurations by default. Additionally, e ven if the  providers do not enable these  \nservices by default, malicious actors can  easily  abuse the se services  if users or \nadministrators enable  them . \nAssessment tea ms regularly find the following : \n Insecure Active Directory Certificate Services   \n Insecure legacy protocols/services   \n Insecure Server Message Block (SMB) service  \nInsecure Active Directory Certificate Services  \nActive Directory Certificate Services (ADCS) is a feature used to manage Public Key \nInfrastructure (PKI) certificates, keys , and encryption inside of Active Directory (AD) \nenvironments. ADCS templates are used to build  certificates for different types of \nservers and other entities on an organization s network.  \nMalicious actors can exploit ADCS and/or ADCS template misconfigurations to \nmanipulate  the certificate infrastructure into issuing  fraudulent certificate s and /or \nescalate user privileges  to domain administrato r privileges . These certificates and  \ndomain escalation paths  may grant actors unauthorized , persistent access to systems \nand critical data,  the ability to impersonate legitimate entities,  and the ability to bypass \nsecurity measures.  \nAssessment teams have  observed organizations with the  following  misconfigurations : \n ADCS servers running with web -enrollment enabled . If web -enrollment is \nenabled, unauthenticated actors can coerce  a server to authenticate to an actor -\ncontrolled computer, which can  relay the authentication to the ADCS web -\nenrollment service and obtain a certificate [ T1649 ] for the servers account. \nThese fraudulent, trusted certificates enable actors to use adversary -in-the-\nmiddle techniques [ T1557 ] to masquerade as trusted entities on the network. The \nactor s can also  use the certificate for AD authentication to obtain a Kerberos \nTicket Granting Ticket (TGT)  [T1558.001 ], which they can use to compromise the \nserver and usually the entire domain.  \n ADCS templates where low-privileged  users have enrollment rights,  and \nthe enrollee  supplies a subject  alternative name . Misconfiguring various \nelements of ADCS templates can result in domain escalation by unauthorized \nusers (e.g., granting low -privileged users certificate enrollment rights, allowing \nrequesters to specify a subjectAltName  in the certificat e signing request [CSR ], \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  9 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \nnot requiring authorized signatures for CSRs, granting FullControl  or \nWriteDacl  permissions to users).  Malicious actors can use a low-privilege d user \naccount to request a certificate with a particular  Subject  Alternative  Name (SAN) \nand gain a certificate where the SAN matches the User Principal Name (UPN) of \na privileged account.  \nNote:  For more information on known escalation paths, including PetitPotam NTLM \nrelay techniques , see: Doma in Escalation: PetitPotam NTLM Relay to ADCS Endpoints  \nand Certified Pre -Owned. Active Directory Certificate Services .[10],[11],[12] \nInsecure legacy protocols/s ervices  \nMany vulnerable network services are enabl ed by default, and a ssessment teams have \nobserved them enabled in production environments. Specifically , assessment teams  \nhave observed Link-Local Multicast Name Resolution (LLMNR)  and NetBIOS Name \nService (NBT -NS), which are Microsoft Windows components t hat serve as alternate \nmethods of host identification. If these services are enabled  in a network, actors  can \nuse spoofing, poisoning, and relay techniques [T1557.001 ] to obtain  domain hashes, \nsystem access, and potential administrative system sessions.  Malicious actors \nfrequently exploit these protocols to compromise entire Windows environments.  \nMalicious a ctors can  spoof an authoritative source for name resolution on a target \nnetwork by responding to passing traffic, effectively poisoning the service so that target  \ncomputer s will communicate with an actor-controlled system  instead of the intended \none. If the request ed system requires identification/authentication, the target computer \nwill send the users username and hash to the a ctor-controlled system. The actor s then \ncollect  the hash and crack it offline to obtain the plain text password  [T1110.002 ]. \nInsecure Server Message Block  (SMB) service  \nThe Server Message Block service  is a Windows component primarily for file sharing. \nIts default configuration , includ ing in the latest version  of Windows , does not require \nsigning network messages to ensure authenticity and integrity. If SMB servers  do not \nenforce SMB signing, malicious actors can use machine -in-the-middle techniques , such \nas NTLM relay . Further, malicious actor s can combine a lack of SMB signing with the \nname resolution  poisoning issue (see above ) to gain access to remote systems  \n[T1021.002 ] without need ing to capture and crack any hashes.  \n2. Improper separation of user/administrator privilege  \nAdministrators often assign multiple roles to one account. These accounts have access \nto a wide range of devices  and services , allow ing malicious actors  to move through a \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  10 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \nnetwork quickly  with one compromised accou nt without triggering  lateral movement \nand/or privilege escalation  detection measures . \nAssessment teams have observed  the following c ommon account separation \nmisconfigurations : \n Excessive a ccount privileges  \n Elevated service account permissions  \n Non-essential  use of elevated accounts  \nExcessive account privileges  \nAccount privileges are intended to control user access to host or application resources \nto limit access to sensitive information or enforce a least -privilege security model.  When \naccount privileges are overly permissive , users can see and/or do things they should \nnot be able to , which becom es a security issue as  it increases risk exposure and attack \nsurface . \nExpanding  organizations can undergo numerous changes in account management, \npersonnel, and acces s requirements . These changes  commonly lead to privilege \ncreep the granting of excessive access and unnecessary account privileges. Through \nthe analysis of topical and nested AD groups, a malicious  actor  can find a user account \n[T1078 ] that has been granted account privileges that exceed their need -to-know or \nleast -privilege function. Extraneous  access can lead to  easy  avenues for unauthorized \naccess to data and  resources  and escalation of privileges in the targeted domain.  \nElevated service account permissions  \nApplications often operate using  user accounts  to access resources . These use r \naccounts, which are known as service accounts,  often require elevated privil eges. When  \na malicious actor compromises  an application or service using a  service account, they \nwill have the same privileges and access as the service account.  \nMalicious actors can  exploit elevated service permissions within a domain to gain \nunauthorized access and control over critical systems. Service accounts are enticing \ntargets for malicious actors because such accounts are often granted elevated \npermissions within the domain d ue to the nature of the service , and because access to \nuse the service can be requested by any valid domain user.  Due to these factors, \nkerberoasting a form of credential access achieved  by cracking service account \ncredentials is a common  technique used to  gain control over service account targets  \n[T1558.003 ]. \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  11 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \nNon-essential use of elevated accounts  \nIT personnel use domain administrator  and other administrator accounts for system and \nnetwork management due to their inherent elevated privileges. When a n administrator \naccount is lo gged into a compromised host, a malicious  actor can steal and use  the \naccount's credentials  and an AD -generated authentication token [T1528 ] to move,  using \nthe elevated permissions , throughout the domain  [T1550.001 ]. Using an elevated \naccount f or normal day -to-day, non-administrative  tasks increases the accounts \nexposure and, therefore, its  risk of compromise and its risk to the network . \nMalicious a ctors  prioritize obtaining valid domain credentials upon gaining access to a \nnetwork. Authenticat ion using valid domain credentials allows the execution of \nsecondary enumeration techniques to gain visibility into the target domain  and AD \nstructure, including discovery of elevated accounts and where the elevated accounts  \nare used  [T1087 ].  \nTargeting elevated acc ounts (such as domain administrator  or system administrators) \nperforming day -to-day activities provides the most direct path to achieve domain \nescalation. Systems or applications accessed by the targeted elevated accounts \nsignificantly increase the attack surface available to adversaries, providing additional \npaths and  escalation  options . \nAfter obtaining initial access via an account with administrative permissions , an \nassessment  team  compromised  a domain in under a business day . The team first \ngained initial acc ess to the system through  phishing  [T1566 ], by which they  entice d the \nend user to download [ T1204 ] and execute malicious payloads. The targeted e nd-user \naccount had administrative permissions, enabling  the team to quickly compromise the \nentire domain.  \n3. Ins ufficient internal network monitoring  \nSome o rganization s do not optimally configure host and network sensor s for traffic \ncollection and end -host logging. These insufficient configurations could lead to \nundetected adversarial compromise. Additionally, impro per sensor configurations limit \nthe traffic collection capability needed for enhanced baseline development and detract \nfrom timely detection of anomalous activity.  \nAssessment  teams have  exploited insufficient monitoring to gain access to assessed \nnetworks.  For example:  \n An assessment team observed an organization  with host -based monitoring , but \nno network monitoring. Host-based monitoring informs defensive teams about \nadverse activities on singular hosts and network monitoring informs about \nadverse activities traversing hosts  [TA0008 ]. In th is example, the organization  \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  12 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \ncould identify infected hosts but could not identify where the infection was coming \nfrom, and thus could not stop future lateral movement  and infections . \n An assessment  team gained persistent  deep access to a large organization with \na mature cyber posture . The organization did not detect the assessment teams \nlateral movement, persistence, and command and control  (C2) activity , including \nwhen the team attempted noisy activities to trigger a security response . For more \ninformation on this activity, see CSA CISA Red Team Shares Key Findings to \nImprove Monitoring and Hardening of Networks .[13] \n4. Lack of network segmentation  \nNetwork segment ation separates portions of the ne twork with security boundaries.  Lack \nof network segment ation leaves no security boundaries between the user, production, \nand critical system networks. Insufficient network segment ation allows an actor  who has \ncompromised a resource on the  network to move later ally across  a variety of systems \nuncontested. Lack of network segregation additionally leaves organizations significantly \nmore vulnerable to potential ransomware attacks and post -exploitation techniques.  \nLack of segmentation between IT and operational tech nology (OT) environments places \nOT environments at risk. For example, assessment  teams have often gained access to \nOT networks despite prior assur ance that  the networks were fully air gapped , with no \npossible connection to the IT network by finding special purpose, forgotten, or even \naccidental network connections  [T1199 ]. \n5. Poor patch management  \nVendors release p atches and updates to address security vulnerabilities . Poor patc h \nmanagement and network hygiene pr actices  often enable adversaries to discover open \nattack vectors and exploit critical vulnerabilities.  Poor patch management includes:  \n Lack of regular patching  \n Use of unsupported operating systems (OSs) and outdated firmware  \nLack of regular patching  \nFailure to apply the latest patches can leave a system open to compromise  from \npublicly available exploits. Due to their ease of discovery via vulnerability scanning \n[T1595.002 ] and open source research [ T1592 ]and exploitation, t hese systems are \nimmediate targets for adversaries. Allowing critical vulnerabilitie s to remain  on \nproduction systems without applying their corresponding patches significantly increases \nthe attack surface.  Organizations should prioritize patching known exploited \nvulnerabilities  in their environments. [2] \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  13 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \nAssessment teams have  observed threat actors exploit ing many CVEs in public -facing \napplications [ T1190 ], including : \n CVE-2019 -18935 in an unpatched instance of Telerik UI for ASP.NET running \non a Microsoft IIS server .[14] \n CVE-2021 -44228 ( Log4Shell ) in an unpatched VMware Horizon server .[15] \n CVE-2022 -24682, CVE -2022 -27924, and CVE-2022 -27925 chained with CVE -\n2022 -37042, or CVE -2022 -30333 in an unpatched Zimbra Collaboration \nSuite. [16] \nUse of unsupported OSs and outdated firmware  \nUsing software or hardware that is no longer supported by the vendor poses a \nsignificant security risk because new and existing vulnerab ilities ar e no longer patched. \nMalicious a ctors can exploit vulnerabilities in these systems to gain unauthorized \naccess, compromise sensitive data, and disrupt operations  [T1210 ]. \nAssessment  teams frequently observe organizations using  unsupported Windows \noperating systems without updates MS17 -010 and MS08 -67. These updates , released \nyears ago , address critical remote code execution vulnerabilities. [17],[18] \n6. Bypass of system access controls  \nA malicious actor can bypass system acces s controls by compromising alternate \nauthentication methods in an environment. If a malicious actor  can collect hashes in a \nnetwork, they can use the hashes to authenticate using non -standard means, such as \npass-the-hash (PtH)  [T1550.002 ]. By mimicking accounts without the clear -text \npassword, an actor  can expand and fortify  their access without detection.  Kerberoasting  \nis also one of the most time-efficient ways to elevate privileges and move laterally \nthroughout an organization s network . \n7. Weak  or misconfigured  MFA  methods  \nMisconfigured smart cards  or tokens  \nSome  networks (generally government or DoD networks) require accounts to use smart \ncards or tokens. Multifactor requirement s can be misconfigured so the password hashes \nfor accounts  never change. Even though the password itself is no longer used \nbecause the smart card or token is required instead there is still a password hash for \nthe account that can be used  as an alternative credential for authentication.  If the \npassword hash never changes, o nce a  malicious actor  has an accounts password hash  \n[T1111 ], the actor  can use it indefinitely , via the PtH technique  for as long as that \naccount exists . \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  14 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \nLack of phishing -resistant MFA  \nSome forms of MFA are vulnerable to phishing, push bombing [T1621 ], exploitat ion of \nSignaling System 7 (SS7) protocol vulnerabilities, and/or SIM s wap technique s. These \nattempt s, if successful, may allow a threat actor to gain access to MFA authentication \ncredentials or bypass MFA and access the MFA -protected  systems. (See CISA s Fact \nSheet Implementing Phishing -Resistant MFA  for more information. )[3] \nFor example, assessment  teams have  used voice phishing  to convince  users to provide \nmissing MFA information  [T1598 ]. In one inst ance, an assessment team knew a users \nmain credentials , but their login attempts were blocked by MFA requirements. The team  \nthen masqueraded as IT staff  and convinced  the user to provide the MFA code over the \nphone , allowing the team to complete their login attempt and gain  access to the users \nemail and other organizational resources.  \n8. Insufficient ACLs on network shares and services  \nData shares and repositories are primary targets for malicious actors. Network \nadministrators may improperly configure  ACLs to allow for unauthorized users to access \nsensitive or administrative data  on shared drives . \nActors can use commands, open  source  tools , or cust om malware to look for shared \nfolders and drives [ T1135]. \n In one compromise, a team  observed actors use  the net share  command \nwhich display s information about shared resources on the local computer and \nthe ntfsinfo  command to search net work shares on compromised computers . \nIn the same compromise, the actors used a custom tool, CovalentStealer , which \nis designed to identify file shares on a system, categorize the files  [T1083 ], and \nupload the files to a remote server  [TA0010 ].[19],[20] \n Ransomware actors have used the SoftPerfec t Network Scanner , \nnetscan.exe which can ping computers  [T1018 ], scan ports  [T1046 ], and \ndiscover shared folders and SharpShares to enumerate accessible network \nshares  in a domain. [21],[22] \nMalicious actors can then collect and exfiltrate the data from the shared drives and \nfolders. The y can then use the dat a for a variety of purposes, such as extortion of the \norganization or as intelligence when formulating intrusion plans for further network \ncompromise.  Assessment  teams routinely find sensitive information on network shares \n[T1039 ] that could facilitate follow -on activity or provide opportunities for extortion . \nTeams regularly find  drives containing  clear text credentials  [T1552 ] for service \naccounts , web applications, and even domain administrators .  \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  15 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \nEven when further access is not directly obtained from credentials in file shares , there \ncan be a treasure trove  of information for improving situation al awareness of the target \nnetwork , includ ing the networks topology, service tickets, or vulnerability s can data.  In \naddition, teams  regularly identify sensitive data and PII on shared drives  (e.g., scanned \ndocuments, social security numbers, and tax returns ) that could be used for extortion or \nsocial engineering of the organization or individuals.  \n9. Poor credential hygiene  \nPoor credential hygiene facilit ates threat actors in obtaining credentials for initial access, \npersistence, lateral movement, and other follow -on activity , especially if phishing -\nresistant MFA is not enabled. Poor credential hygiene includes:  \n Easily crackable p assword s \n Cleartext password d isclosure  \nEasily crackable passwords  \nEasily crackable passwords are passwords that a malicious actor can guess within a \nshort time using relatively inexpensive computing resources.  The presence of  easily \ncrackable passwords on a network generally stem s from a lack of  password  length  (i.e., \nshorter than 15 characters)  and randomness  (i.e., is not unique  or can be guessed ). \nThis is  often  due to lax requirements for  passwords in organizational policies  and user \ntraining . A policy that only requires  short and simple password s leaves user passwords \nsusceptible to password cracking. Organizations should provide or allow employee  use \nof password managers to enable the generation  and easy use  of secure, random \npasswords for each account.  \nOften,  when a credential is obtained, it is a hash (one-way encryption) of the password \nand not the password itself. Although s ome hashes can be used directly with PtH \ntechniqu es, many hashes need  to be cracked to obtain  usable credential s. The cracking \nprocess take s the captu red hash of the users plaintext password and leverages  \ndictionary wordlists and rulesets , often using a database of billions of previously \ncompromised passwords , in an attempt to find the matching pl aintext password \n[T1110.002 ]. \nOne of the primary ways to crack passwords is with the open  source tool, Hashcat, \ncombined with password lists obtained from publicly  released passwor d breaches. Once \na malicious acto r has access to a plaintext password , they are usually limited only by \nthe account s permissions. In some cases, the actor may be restricted or detected by \nadvanced defense -in-depth and zero trust implementations  as well , but this ha s been a \nrare finding in assessments thus far . \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  16 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \nAssessment  teams have cracked password hashes for NTLM users, Kerberos service \naccount tickets, NetNTLMv2, and PFX stores [ T1555 ], enabling the  team to elevate \nprivileges and move laterally within networks. In 12 hours, one team cracked over 80% \nof all users' passwords in an Active Directory, resulting in hundreds of valid credentials.  \nCleartext password disclosure  \nStoring pass words in cleartext is a serious security risk. A malicious acto r with access to \nfiles containing cleartext passwords [T1552.001 ] could use these credentials to log into \nthe affected applications or systems under the guise of a legitimate user. Accountability \nis lost in this situation as any system logs would record valid user accounts accessing \napplications or systems.  \nMalicious a ctors search for text files, spreadsheets, doc uments, and configuration files \nin hopes of obtai ning cleartext passwords. Assessment  teams frequently discover  \ncleartext passwords , allowing the m to quickly escalate the emulated intrusion  from the \ncompromise of a regular domain user account to that of  a privileged account , such as  a \nDomain or Enterprise Administrator. A common tool used for locating cleartext \npasswords is the open  source tool, Snaffler .[23] \n10. Unrestricted code execution  \nIf unverified programs are allowed to execute on hosts , a threat actor can run arbitrary , \nmalicious payloads within a network.  \nMalicious a ctors  often execute c ode after gaining initial access to a system . For \nexample, after a user falls for a phishing scam, t he actor  usually convinces the victim to \nrun code on the ir workstation to gain remote access to the internal network. This code is \nusually an unverified pro gram that has no legitimate purpose or business reason for \nrunning  on the network . \nAssessment teams  and malicious actors  frequently leverage unrestricted code \nexecution in the form of executables, dynamic link libraries ( DLLs ), HTML applications, \nand m acros  (scripts used in office automation documents)  [T1059.005 ] to establish \ninitial access, persistence, and lateral movement . In addition, actors often use scripting \nlanguages [ T1059 ] to obscure their a ctions [T1027.010 ] and bypass allowlisting where \norganizations restrict applications  and other forms of code by default and only allow \nthose that are known  and trusted . Further, actors may load vulnerable drivers and then \nexploit the drivers  known vulnerabiliti es to execute code in the kernel  with the highest \nlevel of system privileges to completely compromise the device [ T1068 ]. \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  17 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \nMitigations  \nNetwork defenders  \nNSA and CISA recommend  network defenders implement the recommend ations that \nfollow  to mitigate the issues identified in this advisory . These mitigations align  with the \nCross -Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the \nNational Institute of Standards and Technology (NIST)  as well as with the  MITRE \nATT&CK Enterprise Mitigations  and MITRE D3FEND  frameworks .  \nThe CPGs provide a minimum set of practices and protections that CISA and NIST \nrecommend all organizations implement. CISA and NIST based the CPGs on existing \ncybersecurity frameworks and guidance to protect against the most common and \nimpactful threats, t actics, techniques, and procedures. Visit CISAs Cross -Sector \nCybersecurity Performance Goals  for more information on the CPGs, including \nadditional recommended baseline protections. [24] \nMitigate default configurations of software and applications  \nTable 1: Recommendations for network defenders to mitigate default configurations of softw are \nand applications  \nMisconfiguration  Recommendations for Network Defenders  \nDefault \nconfigurations of \nsoftware and \napplications   Modify the default configuration of applications and \nappliances before deployment  in a production \nenvironment [ M1013 ],[D3-ACH ]. Refer to hardening \nguidelines provided by the vendor  and related \ncyberse curity guidance (e.g., DISA's Security Technical \nImplementation Guides  (STIGs)  and configuration \nguides) .[25],[26],[27] \nDefault \nconfigurations of \nsoftware and \napplications : Default \nCredentials   Change or disable vendor -supplied default \nusernames and passwords of services, software, and \nequipment  when installing or commissioning [ CPG 2.A ]. \nWhen res etting passwords, enforce the use of strong  \npasswords  (i.e., passwords that are more than 15 \ncharacters and random [CPG 2.B ]) and follow hardening \nguidelines provided by the vendor, STIGs , NSA, and/or \nNIST  [M1027 ],[D3-SPP].[25],[26],[28],[29] \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  18 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \nDefault service \npermissions and \nconfiguration \nsettings:  Insecure \nActive  Directory \nCertificate Services   Ensure the secure configuration of ADCS \nimplementations . Regularly update and patch the \ncontrolling infrastructure ( e.g., for C VE-2021 -36942), \nemploy monitoring and auditing mechanisms, and \nimplement strong access controls to protect the \ninfrastructure.  \no If not needed, d isable web -enrollment in ADCS \nservers . See  Microsoft:  Uninstall -AdcsWebEnrollment \n(ADCSDeployment)  for guidance. [30] \no If web enrollment is needed o n ADCS servers : \n Enable Extended Protection for Authentication \n(EPA) for Client Authority Web Enrollment . This \nis done by choosing the Required option.  For \nguidance, see Microsoft: KB5021989: Extended \nProtection for Authentication .[31] \n Enable Require SSL  on the ADCS server.  \no Disable NTLM  on all ADCS servers.  For guidance, \nsee Microsoft: Network security Restrict NTLM in this \ndomain - Windows Security | Microsoft Learn  and \nNetwork security Restrict NTLM Incoming NTLM traffic \n- Windows Security .[32],[33] \no Disable SAN for UPN Mapping . For guidance see, \nMicrosoft: How to disable the SAN for UPN mapping - \nWindows Server . Instead, s mart card authentication \ncan use the altSecurityIdentities attribute for explicit \nmapping of certificates to accounts more securely. [34] \n Review all permissions on the ADCS templates on  \napplicable servers . Restrict enrollment rights to only \nthose users or groups that require it. Disable the \nCT_FLAG_ENROLLEE_SUPPLIES_SUBJECT  flag from \ntemplates to prevent users from supplying and editing \nsensitive security settings within these templates.  \nEnforce manager approval for requested certificates. \nRemove FullControl , WriteDacl , and Write  property \npermissions from low -privileged groups, such as domain \nusers, to certificate template objects.  \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  19 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \nDefault service \npermissions and \nconfiguration \nsettings: Insecure \nlegacy \nprotocols/services   Determine if LLMN R and NetBIOS are required for \nessential business operations . \no If not required, disable LLMNR and NetBIOS in local \ncomputer security settings or by group policy . \nDefault service \npermissions and \nconfiguration  \nsettings: Insecure \nSMB service   Require SMB signing  for both SMB client and server on \nall systems. [25] This should prevent certain adv ersary -in-\nthe-middle and pass -the-hash technique s. For more \ninformation on SMB signing, see Microsoft : Overview of \nServer Message Bl ock Signing . [35] Note : Beginning in \nMicrosoft Windows 11 Insider Preview Build 25381 , \nWindows requires SMB signing for all \ncommunications. [36] \nMitigate improper separation of user/administrator privilege  \nTable 2: Recommendations for network defenders to mitigate improper separat ion of \nuser/administrator privilege  \nMisconfiguration  Recommendations for Network Defenders  \nImproper separation \nof user/administrator \nprivilege:  \n Excessive \naccount \nprivileges,  \n Elevated \nservice account \npermissions, \nand \n Non-essential \nuse of elevated \naccounts   Implement authentication, authorization, and \naccounting (AAA) systems  [M1018 ] to limit actions \nusers can perform, and review logs of user actions to \ndetect unauthorized use and abu se. Apply least privilege \nprinciples to user accounts and groups allowing only the \nperformance of authorized actions.  \n Audit user accounts and remove those that are inactive \nor unnecessary on a routine basis [ CPG 2.D ]. Limit the \nability for user accounts to create additional accounts.  \n Restrict use of privileged accounts to perform general \ntasks , such as accessing emails and browsing the \nInternet [ CPG 2.E ],[D3-UAP]. See NSA Cyb ersecurity \nInformation Sheet (C SI) Defend Privileges and Accounts  \nfor more information. [37] \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  20 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \n Limit the number of users within the organization with \nan identity and access management (IAM) role  that \nhas administrator privileges. Strive to reduce all \npermanent privileged role assignments, and conduct \nperiodic entitlement reviews on IAM users, roles, and \npolicies.  \n Implement time -based access for privileged accounts . \nFor example, the just -in-time access method provisions \nprivileged access when needed and can support \nenforcement of the principle of least privilege (as well as \nthe Zero T rust model) by setting network -wide policy to \nautomatically disable admin accounts at the Active \nDirectory level. As needed, individual users can submit \nrequests through an automated process that enables \naccess to a system for a set timeframe. In cloud \nenvironments, just -in-time elevation is also appropriate \nand may be implemented using per -session federated \nclaims or privileged access management tools.  \n Restrict domain users from being in the local \nadministrator group  on multiple systems.  \n Run daemonized app lications (services) with non -\nadministrator accounts  when possible.  \n Only configure service accounts with the permissions \nnecessary for the services they control to operate . \n Disable unused services and implement ACLs  to \nprotect services.  \nMitigate insuffici ent internal network monitoring  \nTable 3: Recommendations for network defenders to mitigate insufficient internal network \nmonitoring  \nMisconfiguration  Recommendations for Network Defenders  \nInsufficient internal \nnetwork monitoring   Establish a baseline of applications and services , and \nroutinely audit their access and use, especially for \nadministrative activity  [D3-ANAA ]. For instance, \nadministrators should routinely audit the access lists and \npermissions for of all web applications and services [ CPG \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  21 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \n2.O],[M1047 ]. Look for suspicious accounts, investigate \nthem, and remove accounts and credentials , as \nappropriate , such as accounts of former staff. [39] \n Establish a baseline that represents an organizations \nnormal traffic activity , network performance, host \napplication activity, and user behavior; investigate any \ndeviations from that baseline [ D3-NTCD ],[D3-CSPP ],[D3-\nUBA].[40] \n Use auditing tools capable of detecting privilege and \nservice abuse opportunities on systems within an \nenterprise and correct them [ M1047 ]. \n Implement a security information and event \nmanagement (SIEM) system  to provide log aggregation, \ncorrelation, querying, visualization, and alerting from \nnetwork endpoints, logging systems, endpoint and \ndetection response (EDR) systems and intrusion \ndetection systems (IDS) [ CPG 2.T ],[D3-NTA]. \nMitigate l ack of network segmentation  \nTable 4: Recommendations for network defenders to mitigate lack of network segmentation  \nMisconfiguration  Recommendations for Network Defenders  \nLack of network \nsegmentation   Implement next-generation  firewalls  to perform deep \npacket filtering, stateful inspection, and  application -level \npacket inspection  [D3-NTF]. Deny or drop improperly \nformatted traffic that is incongruent with application -\nspecific traffic permitted on the network. This practice \nlimits an actor s ability to a buse allowed application \nprotocol s. The practice of allowlisting  network applications \ndoes not rely on generic ports as filtering criteria, \nenhancing filtering fidelity. For more information on \napplication -aware defenses, see NSA CSI Segment \nNetworks and Deploy Application -Aware Defenses .[41] \n Engineer network segments to isolate critical \nsystems, functions, and resources  [CPG 2.F ],[D3-NI]. \nEstablish physical and logical segmentation controls, such \nas virtual local area network (VLAN) configurations and \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  22 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \nproperly configured access control lists (ACLs) on \ninfrastructure device s [M1030 ]. These devices should be \nbaselined and audited to prevent access to potentially \nsensitive systems and information. Leverage properly \nconfigured Demilitarized Zones (DMZs)  to reduce service \nexposure to the Internet. [42],[43],[44] \n Implement separate Virtual Private Cloud (VPC) \ninstances  to isolate essential cloud systems. Where \npossible , implement Virtual Machines (VM) and Network \nFunction Virtualization (NFV) to enabl e micro -\nsegmentation of networks in virtualized environments and \ncloud data centers. Employ secure VM firewall \nconfigurations in tandem with macro segmentation.  \nMitigate p oor patch management  \nTable 5: Recommendations for network defenders to mitigate poor patch management  \nMisconfiguration  Recommendations for Network Defenders  \nPoor patch \nmanagement: Lack \nof regular patching   Ensure organizations implement and maintain an \nefficient patch management process  that enforces the \nuse of up -to-date, stable versions of OSs, browsers, and \nsoftware [ M1051 ],[D3-SU].[45] \n Update software regularly by employing patch \nmanagement  for externally exposed applications, internal \nenterprise endpoints, and servers. Prio ritize patching \nknown exploited vulnerabilities .[2] \n Automate the update process as much as possible  \nand use vendor -provided updates. Consider using \nautomated patch management tools and software update \ntools.  \n Where patching is not possible due to limitations, \nsegment networks to limit exposure of the vulnerable \nsystem or  host.  \nPoor patch \nmanagement: Use \nof unsupported OSs  Evaluate the use of unsupported hardware and \nsoftware and discontinue use  as soon as possible. If \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  23 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \nand outdated \nfirmware  discontinuing is not possible, implement additional \nnetwork protections to mitigate the risk. [45] \n Patch the Basic Input/Output System (BIOS)  and other \nfirmware to prevent exploitation of known vulnerabilities.  \nMitigate b ypass of system access controls  \nTable 6: Recommendations for network defenders to mitigate bypass of system access controls  \nMisconfiguration  Recommendations for Network Defenders  \nBypass of system \naccess controls   Limit credential overlap across systems  to prevent \ncredential compromise and reduce a malicious actor 's \nability to move laterally between systems [ M1026 ],[D3-\nCH]. Implement a method for monitoring non -standard \nlogon events through host log monitoring [ CPG 2.G ]. \n Implement an  effective and routine patch \nmanagement process . Mitigate PtH  techniques  by \napplying patch KB2871997  to Windows 7 and newer \nversions to limit default access of accounts in the local \nadministrator group [ M1051 ],[D3-SU].[46] \n Enable the PtH mitigations to apply User Account \nControl (UAC) restrictions  to local accounts upon \nnetwork logon [ M1052 ],[D3-UAP]. \n Deny domain users the ability to be in the local \nadministrator group on multiple systems [ M1018 ],[D3-\nUAP]. \n Limit workstation -to-workstation communications . All \nworkstation communications should occur through a \nserver to prevent lateral movement [ M1018 ],[D3-UAP]. \n Use privileged accounts only on systems requiring \nthose privileges  [M1018 ],[D3-UAP]. Consider using \ndedicated Privileged Access Workstations for privileged \naccounts to better isolate and protect them. [37] \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  24 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \nMitigate weak or misconfigured MFA  methods  \nTable 7: Recommendations for network defenders to mitigate weak or misconfigured MFA  \nmethods  \nMisconfiguration  Recommendations  for Network Defenders  \nWeak or \nmisconfigured MFA  \nmethods: \nMisconfigured s mart \ncards or tokens  \n  In Windows environments:  \no Disable the use of New Technology LAN Manager \n(NTLM) and other legacy authentication protocols  \nthat are susceptible to PtH  due to their use of \npassword hashes [ M1032 ],[D3-MFA ]. For guidance, \nsee Microsoft: Network security Restrict NTLM in this \ndomain - Windows Security | Microsoft Learn  and \nNetwork security Restrict NTLM Incoming NTLM traffic \n- Windows Security .[32],[33] \no Use built -in functionality via Windows Hello for \nBusiness or Group Policy Obj ects (GPOs) to \nregularly re -randomize password hashes  \nassociated with smartcard -required accounts.  Ensure \nthat the hashes are changed at least as often as \norganizational policy requires passwords to be \nchanged [ M1027 ],[D3-CRO ]. Prioritize upgrading any \nenvironments that cannot utilize this built -in \nfunctionality.  \n As a longer -term effort, implement cloud -prim ary \nauthentication solution using modern open \nstandards . See CISAs Secure Cloud Business \nApplications (SCuBA) Hybrid Identity Solutions \nArchitecture  for more information. [47] Note:  this \ndocument is part of CISAs  Secure Cloud Business \nApplications (SCuBA) project , which provides guidance \nfor FCEB agencies to secure their cloud business \napplication environments and to protect federal \ninformation that is created, accessed, shared, and stored \nin those environments . Although tailored to FCEB \nagencies, the projects guidance is applicable to all \norganizations. [48] \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  25 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \nWeak or \nmisconfigured MFA  \nmethods : Lack of \nphishing -resistant \nMFA   Enforce phishing -resistant MFA  universally  for access \nto sensitive data and on as many  other  resources and \nservices as possible  [CPG 2.H ].[3],[49] \nMitigate i nsufficient ACL s on network share s and servi ces \nTable 8: Recommendations for network defenders to mitigate insufficient ACL s on network share s \nand services  \nMisconfiguration  Recommendations for Network Defenders  \nInsufficient ACL s on \nnetwork share s and \nservices   Implement secure configurations for all storage \ndevices  and network shares that grant access to \nauthorized users only.  \n Apply the principal of least privilege  to important \ninformation resources to reduce risk of unauthorized data \naccess and manipulation.  \n Apply restrictive p ermissions to files and directories , \nand prevent adversaries from modifying ACLs \n[M1022 ],[D3-LFP]. \n Set restrictive permissions on files and folders \ncontaining sensitive private keys  to prevent unintended \naccess [ M1022 ],[D3-LFP]. \n Enable the Windows Group Policy security setting, \n\"Do Not Allow Anonymous Enumeration of Security \nAccount Manager (SAM) Accounts and Shares,\"  to \nlimit users who can enumerate network shares.  \nMitigate poor credential hygiene  \nTable 9: Recommendations for network defenders to mitigate poor credential hygiene  \nMisconfiguration  Recommendations for Network Defenders  \nPoor credential \nhygiene: easily  Follow National Institute of Standards and \nTechnologies (NIST) guidelines  when creating \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  26 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \ncrackable \npasswords  \n password policies  to enforce use of strong passwords  \nthat cannot be cracked [M1027 ],[D3-SPP].[29] Consider \nusing  password manager s to generate and store \npasswords.  \n Do not reuse local administrator account passwords \nacross systems . Ensure that passwords are strong  and \nunique  [CPG 2.B ],[M1027 ],[D3-SPP]. \n Use strong  passphrases for private keys  to make \ncracking resource  intensive. Do not store credentials \nwithin the registry in Windows systems. Establish an \norganizational policy that prohibits password storage in \nfiles. \n Ensure adequate password length (ideally 25+ \ncharacters) and complexity requirements for \nWindows service accounts  and implement passwords \nwith periodic expiration on these accounts [ CPG \n2.B],[M1027 ],[D3-SPP]. Use Managed Service Accounts , \nwhen possible , to manage service account passwords \nautomatically . \nPoor credential \nhygiene: cleartext \npassword disclosure  \n  Implement a review process for files and systems to \nlook for cleartext account credentials . When \ncredentials are found, remove,  change , or encrypt them \n[D3-FE]. Conduct periodic scans of server machines \nusing automated tools to determine whether sensitive \ndata (e.g., personally identifiable information, protected \nhealth information) or  credentials are stored. Weigh the \nrisk of storing credentials in password stores and web \nbrowsers. If system, software, or web browser credential \ndisclosure is of significant concern, technical controls, \npolicy, and user training may prevent storage of \ncredentials in improper locations.  \n Store hashed passwords using Committee on \nNational Security Systems Policy (CNSSP) -15 and \nCommercial National Security Algorithm Suite  (CNSA) \napproved algorithms .[50],[51] \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  27 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \n Consider using group Managed Service Accoun ts \n(gMSAs) or third -party software  to implement secure \npassword -storage applications.  \nMitigate u nrestricted code execution  \nTable 10: Recommendations for network defenders to mitigate unrestricted code execution  \nMisconfiguration  Recommendations for Network Defenders  \nUnrestricted code \nexecution   Enable system settings that prevent the ability to run \napplications downloaded from untrusted sources .[52] \n Use application control tools that restrict program \nexecution by default, also known as allowlisting  [D3-\nEAL]. Ensure that the tools examine digita l signatures and \nother key attributes, rather than just relying on filenames, \nespecially since malware often attempts to masquerade \nas common Operating System (OS) utilities [ M1038 ]. \nExplicitly allow certain .exe  files to run, while blocking all \nothers  by default . \n Block or prevent the execution of known vulnerable \ndrivers that adversaries may exploit to execute code \nin kernel mode . Validate driver block rules in audit mode \nto ensure  stability prior to production deployment [ D3-\nOSM ]. \n Constrain scripting languages to prevent malicious \nactivities, audit script logs, and restrict scripting \nlanguages  that are not used in the environment [ D3-\nSEA]. See  joint C ybersecurity Information Sheet : Keeping \nPowerShell: Security Measures to Use and Embrace .[53] \n Use read -only conta iners and minimal images , when \npossible, to prevent the running of commands.  \n Regularly analyze border and host -level protections, \nincluding spam -filtering capabilities , to ensure their \ncontinued effectiveness in blocking the delivery and \nexecution of malwa re [D3-MA]. Assess whether  HTML \nApplication  (HTA) files are used for business purposes in \nyour environment ; if HTAs are not used, remap the default \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  28 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \nprogram for opening them from mshta.exe  to \nnotepad.exe . \nSoftware m anufacturers  \nNSA and CISA recommend  software manufacturers implement the recommendations in \nTable 11 to reduce the prevalence of m isconfigurations  identified in this advisory. These \nmitigations  align with tactics provided in joint guide Shifting the Balance of \nCybersecurity Risk: Principles an d Approaches for Security -by-Design and -Default . \nNSA and CISA strongly encourage software manufacturers apply these \nrecommendations to ensure their products are secure out of the box and do not \nrequire customers to spend additiona l resources  making configuration changes , \nperform ing monitoring, and conducting routine updates  to keep their systems secure. [1] \nTable 11: Recommendations for s oftware manufacturers to m itigate identified m isconfigurations  \nMisconfiguration  Recommendations for Software Manufacturers  \nDefault configurations of \nsoftware and applications   Embed security controls into product \narchitecture from the start of development \nand throughout the entire SDLC by following \nbest practices in NISTs Secure Software \nDevelopment Framework (SSDF), SP 800 -\n218.[54] \n Provide software with security features \nenabled out of the box and accompanied \nwith loosening guides  instead of  hardening \nguides.  Loosening guides should explain the \nbusiness risk of decisions in plain, \nunderstandable language.  \nDefault configurations of \nsoftware and applications: \nDefault credentials   Eliminate default passwords : Do not provide \nsoftware with default passwords that are \nuniversally shared. To eliminate default \npasswords, require administrators to set a \nstrong  password [CPG 2.B ] during installat ion \nand configuration . \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  29 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \nDefault configurations of \nsoftware and applications: \nDefault service permissions \nand configuration settings   Consider the user experience consequences \nof security settings : Each new setting increases \nthe cognitive burden on end users  and should be \nassessed in conjunction with the business benefit \nit derives. Ideally, a setting should not exist; \ninstead, the most secure setting should be \nintegrated into the product by default. When \nconfiguration is necessary, the default option \nshould be broadly secure against common \nthreats . \nImproper separation of \nuser/administrator privilege:  \n Excessive account \nprivileges,  \n Elevated service \naccount permissions, \nand \n Non-essential use of \nelevated accounts   Design products so that the compromise of a \nsingle security control does not result in \ncompromise of the entire system . For \nexample, ensuring that user privileges are \nnarrowly provisioned by default and ACLs  are \nemployed can reduce the impact of a \ncompromised account. Also, software \nsandboxing techn iques can quarantine a \nvulnerability to limit compromise of an entire \napplication . \n Automatically generate reports for : \no Administrators of inactive accounts. \nPrompt administrators to set a maximum \ninactiv e time and automatically suspend  \naccounts that exceed that threshold.  \no Administrators of accounts with \nadministrator privileges  and suggest ways \nto reduce privilege sprawl.  \n Automatically alert administrators of \ninfrequently used services and provide \nrecommendations for disabling them or \nimplementing ACLs.  \nInsufficient internal network \nmonitoring  \n  Provide high -quality audit logs to customers \nat no extra charge . Audit logs are crucial for \ndetecting and escalating potential security \nincidents. They are also crucial during an \ninvestigation o f a suspected or confirmed security \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  30 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \nincident. Consider best practices such as \nproviding easy integration with a security \ninformation and event management (SIEM) \nsystem with application programming interface \n(API) access that uses coordinated universal time  \n(UTC), standard time zone formatting, and robust \ndocumentation techniques . \nLack of network \nsegmentation   Ensure products are compatible w ith and \ntested  in segmented network environments . \nPoor patch management: \nLack of regular patching   Take steps to elimi nate entire classes of \nvulnerabilities by e mbed ding  security \ncontrols into product architecture from the \nstart of development and throughout the \nSDLC by following best practices in NISTs \nSSDF , SP 800 -218.[54] Pay special attention to:  \no Following secure coding pract ices [SSDF \nPW 5.1 ]. Use memory -safe programming \nlanguages  where possible,  parametrized \nqueries, and web template languages . \no Conducting code reviews  [SSDF PW 7.2, \nRV 1.2 ] against peer coding standards, \nchecking for backdoors, malicious content, \nand logic flaws.  \no Testing code to identify vulnerabilities  and \nverify c ompliance with security requirements \n[SSDF PW 8.2 ]. \n Ensure that published CVEs include root \ncause or common weakness enumeration \n(CWE)  to enable industry -wide analysis of \nsoftware security design flaws.  \nPoor patch management: \nUse of unsupported \noperating OSs and outdated \nfirmware   Communicate the business risk of using \nunsupported OSs and firmware in plain , \nunderstandable language.  \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  31 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \nBypa ss of system access \ncontrols   Provide sufficient detail in audit records to \ndetect bypass of system controls  and queries \nto monitor audit logs for traces of such suspicious \nactivity (e.g., for when an essential step of an \nauthentication or authorization flo w is missing).  \nWeak or Misconfigured MFA  \nMethods: Misconfigured \nSmart Card s or Tokens  \n  Fully support MFA  for all users , making  MFA \nthe default rather than an opt-in feature.  Utilize \nthreat modeling for authentication assertions and \nalternate credentials to exami ne how they could \nbe abused to bypass MFA requirements.  \nWeak or Misconfigured MFA \nMethods: Lack of phishing -\nresistant MFA   Mandate MFA, ideally phishing -resistant , for \nprivileged users  and make MFA a default rather \nthan an opt-in feature. [3] \nInsufficient ACL on network \nshare s and services   Enforce use of ACLs  with default ACLs only \nallowing the minimum access needed, along with \neasy -to-use tools to regularly audit and  adjust \nACLs to the minimum access needed.  \nPoor credential hygiene: \neasily crackable passwords  \n  Allow administrators to configure a password \npolicy consistent with NISTs guidelines do \nnot require counterproductive restrictions such as \nenforcing character types or the periodic rotation \nof passwords. [29] \n Allow users to use password manager s to \neffortlessly generate and use secure, random \npasswords  within products . \nPoor credential hygiene: \ncleartext password \ndisclos ure   Salt and hash passwords using a secure \nhashing algorithm  with high computational cost \nto make brute  force cracking more difficult.  \nUnrestricted code execution   Support execution controls  within operating \nsystems and applications out of the box  by \ndefault at no extra charge for all customers , to \nlimit malicious actors ability to abuse functionality \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  32 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \nor launch unusual applications without \nadministrator or informed user approval.  \nValidate security controls  \nIn addition to applying mitigations, NSA and CISA recommend exercising, testing, and \nvalidating your organizations security program against the threat behaviors mapped to \nthe MITRE ATT&CK for Enterprise framework in this advisory. NSA and CISA  \nrecommend testing your existing security controls inventory to assess how they perform \nagainst the ATT&CK techniques described in this advisory.  \nTo get star ted: \n1. Select an ATT&CK technique described in this advisory (see  Table 12Table 21). \n2. Align your security technologies against the technique.  \n3. Test your technolog ies against the technique.  \n4. Analyze your detection and prevention technologies performance.  \n5. Repeat the process for all security technologies to obtain a set of comprehensive \nperformance data.  \n6. Tune your security program, including people, processes, and tec hnologies, \nbased on the data generated by this process.  \nCISA and NSA  recommend continually testing your security program, at scale, in a \nproduction environment to ensure optimal performance against the MITRE ATT&CK \ntechniques identified in this advisory.  \nLearn from history  \nThe misconfigurations described above are all too common in assessments and the \ntechniques listed are standard ones leveraged by multiple malicious actors, resulting in \nnumerous real network compromises. Learn from the weaknesses of other s and \nimplement the mitigations above properly to protect the network, its sensitive \ninformation, and critical missions.  \n \n  \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  33 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \nWorks cited  \n[1] Joint Guide:  Shifting the Balance of Cybersecurity Risk: Principles and Approaches for Security -\nby-Design and -Default ( 2023), https://www.cisa.gov/sites/default/files/2023 -\n06/principles_approaches_for_security -by-design -default_508c.pdf   \n[2] CISA , Know n Exploited Vulnerabilities Catalog , https://www.cisa.gov/known -exploited -\nvulnerabilities -catalog   \n[3] CISA , Implementing Phishing -Resistant MFA, \nhttps://www.cisa.gov/sites/default/files/publications/fact -sheet -implementing -phishing -resistant -\nmfa-508c.pdf   \n[4] MITRE , ATT&CK for Enterprise, https://attack.mitre.org/versions/v13/matrices/enterprise/   \n[5] MITRE , D3FEND, https://d3fend.mitre.org/   \n[6] CISA , Best Practices for MITRE ATT&CK Mapping , https://www.cisa.gov/news -\nevents/news/best -practices -mitre -attckr -mapping   \n[7] CISA , Decider Tool, https://github.com/cisagov/Decider/  \n[8] CISA , Cyber Assessment Fact Sheet, \nhttps://www.cisa.gov/sites/default/files/publications/VM_Assessments_Fact_Sh eet_RVA_508C.p\ndf  \n[9] Joint CSA : Weak Security Controls and Practices Routinely Exploited for Initial Access, \nhttps:/ /media.defense.gov/2022/May/17/2002998718/ -1/-\n1/0/CSA_WEAK_SECURITY_CONTROLS_PRACTICES_EXPLOITED_FOR_INITIAL_ACCESS\n.PDF   \n[10] Microsoft KB5005413: Mitigating NTLM Relay Attacks on Active Directory Certificate Services \n(AD CS) , https://support.microsoft.com/en -us/topic/kb5005413 -mitigating -ntlm-relay -attacks -on-\nactive -directory -certif icate -services -ad-cs-3612b773 -4043 -4aa9 -b23d -b87910cd3429   \n[11] Raj Chandel, Domain Escalation: PetitPotam NTLM Relay to ADCS Endpoints , \nhttps://www.hackin garticles.in/domain -escalation -petitpotam -ntlm-relay -to-adcs -endpoints/   \n[12] SpecterOps - Will Schroeder , Certified Pre -Owned , https://posts.specterops.io/certified -pre-\nowned -d9591096 5cd2   \n[13] CISA , CSA: CISA Red Team Shares Key Findings to Improve Monitoring and Hardening of \nNetworks , https://www.cisa.gov/news -events/cybersecurity -advisories/aa23 -059a   \n[14] Joint CSA : Threat Actors Exploit Progress Telerik Vulnerabilities in Multiple U.S. Government IIS \nServers . https://www.cisa.gov/news -events/cybersecurity -advisories/aa23 -074a  \n[15] Joint CSA : Iranian Government -Sponsored APT Actors Compromise Federal Network, Deploy \nCrypto Miner, Credential Harvester . https://www.cisa.gov/news -events/cybersecurity -\nadvisories/aa22 -320a  \n[16] Joint CSA : Threat Actors Exploiting Multiple CVEs Against Zimbra Collaboration Suite . \nhttps://www.cisa.gov/news -events/cybersecurity -advisories/aa22 -228a \n[17] Microsoft, How to verify that MS17 -010 is installed , https://support.microsoft.com/en -\nus/topic/how -to-verify -that-ms17-010-is-installed -f55d3f13 -7a9c -688c -260b -477d0ec9f2c8   \n[18] Microsoft, Microsoft Security Bulletin MS08 -067  Critical Vulnerability in Server Service Could \nAllow Remote Code Execution (958644), https://learn.microsoft.com/en -us/security -\nupdates/SecurityBulletins/2008/ms08 -067  \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  34 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \n[19] Joint CSA : Impacket and Exfiltration Tool Used to Steal Sensitive Information from Defense \nIndustrial Base Organization , https://www.cisa.gov/news -events/cybersecurity -advisories/aa22 -\n277a   \n[20] CISA, Malware Analysis Report : 10365227.r1.v1 , https://www.cisa.gov/sites/default/files/2023 -\n06/mar -10365227.r1.v1.clear_.pdf   \n[21] Joint CSA : #StopRansomware: BianLian Ransomware Group . https://www.cisa.gov/news -\nevents/cybersecurity -advisories/aa23 -136a  \n[22] CISA Analysis Report : FiveHands Ransomware . https://www.cisa.gov/news -events/analysis -\nreports/ar21 -126a   \n[23] Snaffle r, https://github.com/SnaffCon/Snaffler   \n[24] CISA, Cross -Sector Cybersecurity Performance Goals , https://www.cisa.gov/cross -sector -\ncybersecurity -performance -goals   \n[25] Defense Information Systems Agency (DISA), Security Technical Implementation Guides \n(STIGs) , https://public.cyber.mil/stigs/   \n[26] NSA, Network Infrastructure Security Guide, \nhttps://media.defense.gov/2022/Jun/15/2003018261/ -1/-\n1/0/CTR_NSA_NETWORK_INFRAST RUCTURE_SECURITY_GUIDE_20220615.PDF   \n[27] NSA, Actively Manage Systems and Configurations, \nhttps://media.defense.gov/ 2019/Sep/09/2002180326/ -1/-\n1/0/Actively%20Manage%20Systems%20and%20Configurations.docx%20 -%20Copy.pdf   \n[28] NSA, Cybersecurity Advisories & Guidance , https://www.nsa.gov/cybersecurity -guidance   \n[29] National  Institute of Standards and Technologies (NIST), NIST SP 800 -63B: Digital Identity \nGuidelines: Authentication and Lifecycle Management, \nhttps://csrc.nist.gov/pubs/sp/800/63/b/upd2/final   \n[30] Microsoft, Uninstall -AdcsWebEnrollment , https://learn.microsoft.com/en -\nus/powershell/module/adcsdeployment/uninstall -adcswebenrollment   \n[31] Microsoft, KB5021989: Extended Protection for Authentication , https://support.microsoft.com/en -\nau/topic/kb5021989 -extended -protection -for-authentication -1b6ea84d -377b -4677 -a0b8 -\naf74efbb243f   \n[32] Microsoft, Network security: Restrict NTLM: NTLM authentication in this domain , \nhttps://learn.microsoft.com/en -us/windows/security/threat -protection/security -policy -\nsettings/network -security -restrict -ntlm-ntlm-authentication -in-this-domain   \n[33] Microsoft, Network security:  Restrict NTLM: Incoming NTLM traffic , \nhttps://learn.microsoft.com/en -us/windows/security/thr eat-protection/security -policy -\nsettings/network -security -restrict -ntlm-incoming -ntlm-traffic   \n[34] Microsoft, How to disable the Subject Alternative Name for UPN mapping , \nhttps://learn.microsoft.com/en -us/troubleshoot/windows -server/windows -security/disable -subject -\nalternative -name -upn-mapping   \n[35] Microsoft, Overview of Server Message Block signing , https://learn.microsoft.com/en -\nus/troubleshoot/windows -server/networking/overview -server -message -block -signing  \n[36] Microsoft, SMB signing required by default in Windows Insider , \nhttps://aka.ms/SmbSigningRequire d  \n[37] NSA, Defend Privileges and Accounts, https://media.defense.gov/2019/Sep/09/2002180330/ -1/-\n1/0/Defend%20Privileges%20and%20Accoun ts%20 -%20Copy.pdf   \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  35 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \n[38] NSA, Advancing Zero Trust Maturity Throughout the User Pillar, \nhttps://media.defense.gov/2023/Mar/14/2003178390/ -1/-\n1/0/CSI_Zero _Trust_User_Pillar_v1.1.PDF   \n[39] NSA, Continuously Hunt for Network Intrusions, \nhttps://media.defense.gov/2019/Sep/09/20021 80360/ -1/-\n1/0/Continuously%20Hunt%20for%20Network%20Intrusions%20 -%20Copy.pdf   \n[40] Joint CSI: Detect and Prevent Web Shell Malware, \nhttps://media.defense.gov/2020/Jun/09/2002313081/ -1/-1/0/CSI -DETECT -AND -PREVENT -\nWEB -SHELL -MALWARE -20200422.PDF   \n[41] NSA, Segment Networks and Deploy Application -aware Defenses, \nhttps://media.defense.gov/2019/Sep/09/2002180325/ -1/-\n1/0/Segment%20Networks%20and%20Deploy%20Application%20Aware%20Defenses%20 -\n%20Copy.pdf  \n[42] Joint CSA: NSA and CISA Recommend Immediate Ac tions to Reduce Exposure Across all \nOperational Technologies and Control Systems, \nhttps://media.defense.gov/2020/Jul/23/2002462846/ -1/-1/0/OT_AD VISORY -DUAL -OFFICIAL -\n20200722.PDF   \n[43] NSA, Stop Malicious Cyber Activity Against Connected Operational Technology, \nhttps://media.defense.gov/2021/ Apr/29/2002630479/ -1/-1/0/CSA_STOP -MCA -AGAINST -\nOT_UOO13672321.PDF   \n[44] NSA, Performing Out -of-Band Network Management, \nhttps://media.defense.gov/2020/Sep/17/2002499616/ -1/-\n1/0/PERFORMING_OUT_OF_BAND_NETWORK_MANAGEMENT20200911.PDF   \n[45] NSA, Update and Upgrade Software Immediately, \nhttps://media.defense.gov/2019/Sep/09/2002180319/ -1/-\n1/0/Update%20and%20Upgrade%20Software%20Immediately.docx%20 -%20Copy.pdf   \n[46] Microsoft, Microsoft Security Advisory 2871997 : Update to Improve Credentials Protectio n and \nManagement , https://learn.microsoft.com/en -us/security -\nupdates/SecurityAdvisories/2016/2871997   \n[47] CISA, Secure Cloud Business Applications Hybrid Identit y Solutions Architecture, \nhttps://www.cisa.gov/sites/default/files/2023 -03/csso -scuba -guidance_documen t-\nhybrid_identity_solutions_architecture -2023.03.22 -final.pdf   \n[48] CISA, Secure Cloud Business Applications (SCuBA) Project , https://www.cisa.gov/res ources -\ntools/services/secure -cloud -business -applications -scuba -project   \n[49] NSA, Transition to Multi -factor Authentication, \nhttps://media.defense.gov/2019/Sep/09/2002180346/ -1/-1/0/Transition%20to%20Multi -\nfactor%20Authentication%20 -%20Copy.pdf   \n[50] Committee on National Security Systems (CNSS), CNSS Policy 15, \nhttps:/ /www.cnss.gov/CNSS/issuances/Policies.cfm   \n[51] NSA, NSA Releases Future Quantum -Resistant (QR) Algorithm Requirements for National \nSecurity Systems , https://www.nsa.gov/Press -Room/News -\nHighlights/Article/Article/3148990/nsa -releases -future -quantum -resistant -qr-algorithm -\nrequirements -for-national -se/  \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  36 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \n[52] NSA, Enforce Signed Software Execution Policie s, \nhttps://media.defense.gov/2019/Sep/09/2002180334/ -1/-\n1/0/Enforce%20Signed%20Software%20Execution%20Policies%20 -%20Copy.pdf   \n[53] Joint CSI : Keeping PowerShell: Security Measures to Use and Embrace, \nhttps://media.defense.gov/2022/Jun/22/2003021689/ -1/-\n1/0/CSI_KEEPING_POWERSHELL_SECURITY_MEASURES_TO_USE_AND_EMBRACE_202\n20622.PDF   \n[54] NIST, NIST SP 800 -218: Secure Software Development Framework (SSDF) Version 1.1: \nRecommendations for Mitigating the Risk of S oftware Vulnerabilities, \nhttps://csrc.nist.gov/publications/detail/sp/800 -218/final   \nDisclaimer of endorsement  \nThe information and opinions contained in this document are provided \" as is\" and without any warranties or \nguarantees. Reference herein to any specific commercial products, process, or service by trade name, trademark, \nmanufacturer, or otherwise, does not constitute or imply its endorsement, recommendation, or favoring by th e United \nStates Government, and this guidance shall not be used for advertising or product endorsement purposes.  \nTrademarks  \nActive Directory , Microsoft, and Windows  are registered trademark s of Microsoft Corporation.  \nMITRE ATT&CK is registered trademark  and MITRE D3FEND is a trademark  of The MITRE Corporation.  \nSoftPerfect is a registered trademark of SoftPerfect Proprietary Limited Company.  \nTelerik is a registered trademark of Progress Software Corporation.  \nVMware is a registered trademark of VMWare, Inc . \nZimbra is a registered trademark of Synacor, Inc.  \nPurpose  \nThis document was developed in furtherance of the authoring  cybersecurity organizations  missions, including their  \nresponsibilities to identify and disseminate threats, and to develop and issue cybersecurity specifications and \nmitigations. This information may be shared broadly to reach all appropriate stakeholders.  \nContact  \nCybersecurity Report Feedback: CybersecurityReports@nsa.gov  \nGeneral Cybersecurity Inquiries : Cybersecurity_Requests@nsa.gov   \nDefense Industrial Base Inquiries and Cybersecurity Services: DIB_Defense@cyber.nsa.gov  \nMedia Inquiries / Press Desk: 443 -634-0721, MediaRelations@nsa.gov   \nTo report suspicious activity contact CISAs 24/7 Operations Center at Report@cisa.gov  or (888) 282 -0870. When \navailable, please include the following information regarding the incident: date, time, and location of the incident; type \nof activity; number of people affected; type of equipmen t used for the activity; the name of the submitting company or \norganization; and a designated point of contact . \n  \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  37 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \nAppendix: MITRE ATT&CK tactics and techniques  \nSee Table 12Table 21 for all referenced threat actor tactics and techniques in this \nadvisory.  \nTable 12: ATT&CK Tech niques for Enterprise  Reconnaissance  \nTechnique Title  ID Use \nActive Scanning: \nVulnerability Scanning  T1595.002  Malicious actors scan victims for \nvulnerabilities that be exploited for initial \naccess.  \nGather Victim Host \nInformation  T1592  Malicious actors gather information on \nvictim  client configurations and/or \nvulnerabilities through vulnerabilities \nscans and searching the web.  \nGather Victim Identity \nInformation: \nCredentials  T1589.001  Malicious actors find default credentials  \nthrough searching the web.  \nPhishing for \nInformation  T1598  Malicious actors masquerade as IT staff \nand convince a target user to provide their \nMFA code over the phone to gain access \nto email and other organizational \nresources.  \nTable 13: ATT&CK Techniques for Enterprise  Initial Access  \nTechnique Title  ID Use \nExternal Remote \nServices  T1133  Malicious actors use default credentials for \nVPN access to internal networks.  \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  38 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \nTechnique Title  ID Use \nValid Accounts: \nDefault Accounts  T1078.001  Malicious actors  gain authenticated \naccess to devices by finding  default \ncredentials through searching the web.  \nMalicious actors  use default credentials for \nVPN access  to internal networks, and \ndefault administrative credentials to gain \naccess to web applications and \ndatabases . \nExploit Public -Facing \nApplication  T1190  Malicious actors exploit CVEs in Telerik \nUI, VM Horizon, Zimbra Co llaboration \nSuite, and other applications for initial \naccess to victim organizations.  \nPhishing  T1566  Malicious actors gain  initial access to  \nsystem s by phishing to entice end users to \ndownload and execute malicious \npayloads.  \nTrust Relationship  T1199  Malicious actors gain  access to OT \nnetworks despite prior assur ance that  the \nnetw orks were fully air gapped , with no \npossible connection to the IT network , by \nfinding special purpose, forgotten, or even \naccidental network connections . \nTable 14: ATT&CK Techniques for Enterprise  Execution  \nTechnique Title  ID Use \nSoftware Deployment \nTools  T1072  Malicious actors use default or captured \ncredentials on software deployment tools \nto execute code and move laterally.  \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  39 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \nTechnique Title  ID Use \nUser Execution  T1204  Malicious actors gain initial access to \nsystems by phishing to entice end users to \ndownload and execute malicious payloads \nor to run code on their workstation s. \nCommand and \nScript ing Interpreter  T1059  Malicious actors use scripting languages \nto obscure their actions and bypass \nallowlisting.  \nCommand and \nScripting Interpreter: \nVisual Basic  T1059.005  Malicious actors use macros  for initial \naccess, persistence, and lateral \nmovement.  \nTable 15: ATT&CK Techniques for Enterprise  Persistence  \nTechnique Title  ID Use \nAccount Manipulation  T1098  Malicious actors reset built -in \nadministrative accounts via predictable , \nforgotten password questions.  \nTable 16: ATT&CK Techniques for Enterprise  Privilege Escalation  \nTechnique Title  ID Use \nValid Accounts  T1078  Malicious actors analyze topical and \nnested Active Directory groups to find \nprivileged accounts to target.  \nValid Accounts: \nDomain Accounts  T1078.002  Malicious actors obtain loaded domain \ncredentials from printers and scanners \nand use them to move laterally from the \nnetwork device.  \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  40 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \nTable 17: ATT&CK Techniques for Enterprise  Defense Evasion  \nTable 18: ATT&CK Techniques for Enterprise  Credential Access  \nTechnique  Title ID Use \nAdversary -in-the-\nMiddle  T1557  Malicious actors force a device to \ncommunicate through actor -controlled \nsystems, so they can collect information or \nperform additional actions.  \nAdversary -in-the-\nMiddle: LLMNR/NBT -\nNS Poisoning and \nSMB Relay  T1557.001  Malicious actors execute spoofing, \npoisoning, and relay techniques if Link -Local \nMulticast Name Resolution (LLMNR), \nNetBIOS Name Service (NBT -NS), and \nServer Message Block (SMB) services are \nenabled in a network.  \nBrute Force: \nPassword Cracking  T1110.002  Malicious actors capt ure user hashes and \nleverage dictionary wordlists and rulesets to \nextract cleartext passwords.  Exploitation for \nPrivilege Escalation  T1068  Malicious actors load vulnerable drivers \nand then exploit their known vulnerabilities \nto execute code in  the kernel with the \nhighest level of system privileges to \ncompletely compromise the device.  \nTechnique Title  ID Use \nObfuscated Files or \nInformation: \nCommand \nObfuscation  T1027.010  Malicious actors often use scripting \nlanguages to obscure their actions.  \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  41 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \nTechnique  Title ID Use \nCredentials from \nPassword Stores  T1555  Malicious actors gain access to and crack \ncredentials from PFX stores, enabling  \nelevation of privileges and lateral movement  \nwithin networks.  \nMulti -Factor \nAuthentication \nInterception  T1111  Malicious actors can obtain password  \nhashes for accounts enabled for MFA with  \nsmart codes or tokens and use the hash via \nPtH techniques.  \nMulti -Factor \nAuthentication \nRequest Generation  T1621  Malicious actors use push bo mbing \nagainst non -phishing resistant MFA to \ninduce MFA fatigue in victims, gaining \naccess to MFA authentication credentials or \nbypassing MFA, and accessing the MFA -\nprotected system.  \nSteal Application \nAccess Token  T1528  Malicious actor s can steal administrator \naccount credentials and the authentication \ntoken generated by Active Directory  when \nthe account is logged into a compromised \nhost.  \nSteal o r Forge \nAuthentication \nCertificates  T1649  Unauthenticated malicious actors coerce an \nADCS server to authenticate to an actor -\ncontrolled server, and then relay that \nauthentication to th e web certificate \nenrollment application to obtain a trusted \nillegitimate certificate.  \nSteal or Forge \nKerberos Tickets: \nGolden Ticket  T1558.001  Malicious actors who have obtaine d \nauthentication certificates can u se the \ncertificate for Active Directory authentication \nto obtain a Kerberos TGT. \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  42 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \nTechnique  Title ID Use \nSteal or Forge \nKerberos Tickets: \nKerberoasting  T1558.003  Malicious actors obtain and abuse valid \nKerberos TGTs to elevate privileges and \nlaterally move throughout an organizations \nnetwork.  \nUnsecured \nCredentials: \nCredentials in Files  T1552.001  Malicious actors find cleartext credentials \nthat organizations or individual users store \nin spreadsheets, configuration files, and \nother documents.  \nTable 19: ATT&CK Techniques for Enterprise  Discovery  \nTechnique Title  ID Use \nAccount Discovery  T1087  Malicious actor s with valid domain \ncredentials enumerate the AD to discover \nelevate d accounts and where they are \nused.  \nFile and Directory \nDiscovery  T1083  Malicious actors use commands, such as \nnet share , open source tools, such as \nSoftPerfect Network Scanner, or custom \nmalware, such as CovalentStealer  to \ndiscover and categorize files.  \nMalicious actors search for text files, \nspreadsheets, documents, and \nconfiguration files in hopes of obtaining \ndesired information, such as cleartext \npasswords.  \nNetwork Share \nDiscovery  T1135  Malicious actors use commands , such as \nnet share , open source tools , such as \nSoftPerfect Network Scanner,  or custom \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  43 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \nTechnique Title  ID Use \nmalware, such as CovalentStealer , to look \nfor shared folders and drives.  \nTable 20: ATT&CK Techniques for Enterprise  Lateral  Movement  \nTechnique Title  ID Use \nExploitation of \nRemote Services  T1210  Malicious actors can exploit OS and \nfirmware vulnerabilities to gain \nunauthorized network access, \ncompromise sensitive data, and disrupt \noperations . \nRemote Services: \nSMB/Windows Admin \nShares  T1021.002  If SMB signing is not enforced, malicious \nactors can use name resolution poisoning \nto access remote systems.  \nUse Alternate \nAuthentication \nMaterial: Application \nAccess Token  T1550.001  Malicious actors with stolen  administrator \naccount credentials and AD authentication \ntoken s can use them to operate with \nelevated permissions throughout the \ndomain . \nUse Alternate \nAuthentication \nMaterial: Pass the \nHash  T1550.002  Malicious actors coll ect hashes in a \nnetwork and authenticate as a user \nwithout having access to the user's \ncleartext password.  \nTable 21: ATT&CK Techniques for Enterprise  Collection  \nTechnique Title  ID Use \nData from Network \nShared Drive  T1039  Malicious actors find sensitive information \non network shares that could facilitate \n\n \n \n \n  TLP:CLEAR  \n \n \n U/OO/208840 -23 | PP-23-3322 | OCT 2023 Ver. 1.0 TLP:CLEAR  44 NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations  \nTechnique Title  ID Use \nfollow -on activity or provide opportunities \nfor extortion.  \n \n\n",
  "cves": [],
  "techniques": [
    "T1078.001",
    "T1558.003",
    "T1557.001",
    "T1552.001",
    "T1595.002",
    "T1589.001",
    "T1059.005",
    "T1027.010",
    "T1110.002",
    "T1021.002",
    "T1558.001",
    "T1550.001",
    "T1078.002",
    "T1550.002"
  ],
  "advisory": "cybersecurity-alerts",
  "title": "joint_csa_top_ten_misconfigurations_tlp-clear",
  "source": "nsa",
  "id": "3a9ade963bb709083ca6d826b34f1c6629dfdd258b8ce84f8d7cbcab16013679"
}