{
  "markdown": "  \nU/OO/152726 -20 | PP-20-0603 | JUL 2020 Rev. 1.0 \nNational Security Agency  | Cybersecurity Advisory  \nPatch Critical Vulnerability in Windows Servers using DNS \nServer Role \nSummary  \nMicrosoft published a Windows1 Update for CVE -2020 -1350 on July 1 4, 2020 to patch a  Remote Code Execution (RCE) \nvulnerability on  all Windows Server  versions  utilizing the DNS server role [1][2] [3]. The RCE vulnerability targets the \nhandling of DNS Signature (SIG) Resource Records (RRs).  The vulnerability requires a  carefully crafted  SIG response \nwith a large SIG signature  block  [4]. Internet -facing Windows Servers with DNS  server  roles  will have significant \nvulnerability risk  and should patch or apply the workaround mitigation as soon as possible .  \nAffected Windows Server operating system s:  \n Windows Server version 2004  \n Windows Server version 1909  \n Windows Server version 1903  \n Windows Server version 1803  \n Windows Server 2019  \n Windows Server 2016  \n Windows Server 2012 R2  \n Windows Server 2012  \n Windows Server 2008 R2   \n Windows Server 2008  \n Windows Server 2003 R2 (no patch, server should be upgraded)  \n Windows Server 2003 (no patch, server should be upgraded)  \nMitigation Actions  \nApply the CVE -2020 -1350 patch immediately on Windows Servers with DNS Server roles . The patch is distributed as part \nof the Windows Update Monthly Rollup , which should be applied to all Windows Servers, even those not using the DNS \nServer role  [5]. Environments with Windows DNS servers that cannot apply the patch immediately  should apply the \nworkaround mitigation  instead as soo n as possible until the patch can be  installed , and then the w orkaround should be \nremoved after the patch is applied .  \nApply Update  \nEach Windows Server version with updates had unique Microsoft Knowledge Base articles published . Administrator s \nshould visit  the M icrosoft Security Response Center  portal for CVE -2020 -1350 to identify the appropriate Windows Update  \nand apply it promptly . Applying this patch requires a server reboot  [3]. \nApply Workaround Mitigation  \nIn the event that an update cannot be applied immediately, t he following workaround will prevent the vulnerability from \nbeing exploited per Microsofts recommendation. The workaround configure s Windows DNS servers to restrict the size of \nacceptable DNS message packets over TCP to 65,280 by tes (0xFF00) . Applying the work around requires a restart of the \nDNS service . Minimal side effects pertaining to  typical  DNS functionality  may occur, as  TCP-based DNS response  \npackets larger than the below value (0xFF00) will be dropped until the workaround is removed.  Apply the patch as soon \nas possible and r emove the workaround once the patch is applied  [2][3] . \n                                            \n1 Microsoft Windows is a registered trademark of Microsoft Corporation.  \n\n \n \nU/OO/152726 -20 | PP-20-0603 | JUL 2020 Rev. 1.0    2 \nNational Security Agency | Cybersecurity Advisory  \n \nRegistry Key  Registry Value  Value  \nHKEY_LOCAL_MACHINE \\SYSTEM \\CurrentControlSet \\Services \\DNS \\Parameters  TcpReceivePacketSize \n(REG_DWORD)  0xFF00  \n \nLaunch an elevated PowerShell prompt:  \nSet-ItemProperty -Path HKLM: \\SYSTEM\\CurrentControlSet \\Services \\DNS\\Parameters -Name \nTcpReceivePacketSize -Type DWord -Value 0xFF00  \nOr \nLaunch an elevated Command prompt:  \nreg.exe add HKLM \\SYSTEM\\CurrentControlSet \\Services\\DNS\\Parameters /v TcpReceivePacketSize \n/t REG_DWORD /d 0xFF00  \nRestart the DNS service or reboot the DNS server . \nReduc e Exposure  \nIn conjunction with  applying the Windows U pdate or the workaround to mitigate this vulnerability, follow best practices to \nlimit the exposure of DNS servers to exploitation. Ensure that internal DNS servers are not accessible from the Internet \nand ensure that Internet -facing DNS servers are not configured as open resolvers.  \nWorks Cited  \n[1] Microsoft Security Response Center (2020 ), Security Update: CVE -2020 -1350 Vulnerability in Windows Domain Name System \n(DNS) Server . [Online] Available at:  https://mrsc -blog.microsoft.com/2020/07/14/july -2020 -security -update -cve-2020 -1350 -\nvulnerability -in-windows -domain -name -system -dns-server/  [Accessed Jul 15, 2020 ] \n[2] Microsoft (2020), KB4569509: Guidance for DNS Serv er Vulnerability CVE -2020 -1350. [Online] Available at:  \nhttps://support.microsoft.com /en-us/help/4569509/windows -dns-server -remote -code -execution -vulnerability  [Accessed Jul 15, \n2020]  \n[3] Microsoft Security Response Center (2020), CVE-2020 -1350 Windows DNS Server Remote Code Execution Vulnerability . \n[Online] Available at:  https://portal.msrc.microsoft.com/en -US/security -guidance/advisory/CVE -2020 -1350  [Accessed Jul 15, \n2020]   \n[4] Check Point Research  (2020) , SIGRed   Resolving Your Way into Domain Admin: Exploiting a 17 Year -old Bug in Windows \nDNS Servers. [Online] https://resea rch.checkpoint.com/2020/resolving -your-way-into-domain -admin -exploiting -a-17-year-old-\nbug-windows -dns-servers/  [Accessed Jul 15, 2020]  \n[5] National Security Agency  (2019),  Cybersecurity Information  Update an d Upgrade Software Immediately. [Online] Available \nat: https://media.defense.gov/2019/Sep/09/2002180319/ -1/-1/0/Update/%20Upgrade%20Software%20Immediately.docx/%20 -\n%20Cop y.pdf  [Accessed Jul 15, 2020]  \nDisclaimer of Endorsement  \nThe information and opinions contained in this document are provided \"as is\" and without any warranties or guarantees. Refere nce herein to any specific \ncommercial products, process, or service by trade name, trademark, manufacturer, or otherwise, does not constitute or imply its endorsement, \nrecommendation, or favoring by the United States Government, and this guidance shall not be used for advertising or product e ndorsement purposes.  \nNotice  \nThis document was developed in furtherance  of NSAs cybersecurity missions including its responsibilities to identify and disseminate threats to National \nSecurity Systems and Department of Defense information technologies, and to develop and issue security  implementation specifications and \ncybersecurity mitigations. The information may be shared broadly to reach all appropriate stakeholders.  \nContact  \nClient Requirements / General Cybersecurity Inquiries: Cy bersecurity Requirements Center , 410 -854-4200,  Cybersecurity_Requests@nsa.gov   \nMedia inquiries / Press Desk: 443 -634-0721, MediaRelations@nsa.gov   \n\n",
  "cves": [],
  "techniques": [],
  "advisory": "cybersecurity-alerts",
  "title": "csa_cve20201350-v_1_0 - copy",
  "source": "nsa",
  "id": "3061d0141e4574679491a8407e6cd2def58cff57912e6fabb147be4de877e9c5"
}