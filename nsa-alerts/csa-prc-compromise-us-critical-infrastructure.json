{
  "markdown": "  \n \n \n \n \n  \n  \n  \n  \n \n \n \nThis document is marked TLP:CLEAR. Disclosure is not limited. Sources may use TLP:CLEAR  when information \ncarries minimal or no foreseeable risk of misuse, in accordance with applicable rules and procedures for public \nrelease. Subject to standard copyright rules, TLP:CLEAR information may be distributed without restriction.  For \nmore informati on on the Traffic Light Protocol, see cisa.gov/tlp. \n \nTLP: CLEAR  Product ID: AA24-038A \n February 7, 2024  Co-Authored by:  TLP:CLEAR  \n \n  \nPRC State -Sponsored Actors Compromise and \nMaintain Persistent Access to U.S. Critical \nInfrastructure  \n \n\n \n  TLP: CLEAR  \nPage 2 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  SUMMARY  \nThe Cybersecurity and Infrastructure Security \nAgency (CISA), National Security Agency (NSA),  \nand Federal Bureau of Investigation ( FBI) assess \nthat Peoples Republic of China ( PRC) state -\nsponsored cyber  actors  are seeking to pre -\nposition the mselves on IT networks  for disruptive \nor destructive cyberattacks against U.S. critical infrastructure in the event of a major cr isis or \nconflict with the United States.  \nCISA, NSA, FBI and the following partners are releasing this advisory to warn c ritical \ninfrastructure organizations about  this \nassessment , which is based on observations \nfrom the U.S. authoring agencies  incident \nresponse activities  at critical infrastructure organizations compromised by  the PRC st ate-sponsored \ncyber group known as Volt Typhoon (also known as Vanguard Panda, BRONZE SILHOUETTE, Dev -\n0391, UNC3236, Voltzite, and Insidious Taurus):  \n U.S. Depar tment of Energy  (DOE)  \n U.S. Environmental Protection Agency (EPA)  \n U.S. Transportation Security A dministration  (TSA)  \n Australian Signals Directorates (ASDs) Australian Cyber Security Centre (ACSC)  \n Canadian Centre for Cyber Security ( CCCS ), a part of the Communications Security \nEstablishment (CSE)  \n United Kingdom National Cyber Security Cent re (NCSC- UK) \n New Zealand National Cyber Security Centre (NCSC- NZ) \nThe U.S. authoring agencies  have confirmed that Volt Typhoon has compromised the IT \nenvironments of  multiple critical infrastructure organizations primarily in  Communications , Energy\n, \nTransportation Systems , and Water and Wastewater Systems  Sector sin the continental and non-\ncontinental United States and its territories, including Guam . Volt Typhoons  choice of targets and \npattern of behavior is  not consistent with traditional cyber espionage or intelligence gathering \noperations , and t he U.S. authoring agencies assess with high confidence that Volt Typhoon actors \nare pre- positioning themselves on IT net works  to enable lateral movement  to OT assets to disrupt  \nfunctions . The U.S. authoring agencies are  concerned about the potential for these actors to use their \nnetwork  access for disruptive effect s in the event of  potential geopolitical tensions and/or military \nconflicts. CCCS assesses that the direct threat to Canadas critical infrastructure from PRC state -\nsponsored actors is likely lower than that to U.S. infrastructure , but should U .S. infrastructure be \ndisrupt ed, Canada would likely be affected as well, due to cross -border integration.  ASDs ACSC and \nNCSC- NZ assess Australian and New Zealand critical  infrastructure , respectively,  could be vulnerable \nto similar activity from PRC state -sponsored actors.  Actions to take today to mitigate Volt \nTyphoon activity:  \n Apply patches for internet -facing \nsystems . Prioritize patching critical \nvulnerabilities in appliances known to be frequently exploited by Volt Typhoon.  \n Implement phishing -resistant MFA\n. \n Ensure logging is turned on for application, access, and security logs \nand store logs in a central system.  \n Plan end of life for technology beyond manufacturers supported lifecycle.  \n \n \n \n \n \n\n \n  TLP: CLEAR  \nPage 3 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  As the authoring agencies have previously highlighted , the use of living off the land (LOTL) \ntechniques is a hallmark of Volt Typhoon actor s malicious cyber activity when targeting critical \ninfrastructure . The group also rel ies on valid accounts and  leverage  strong operational security, which \ncombined, allows for long- term undiscovered persistence.  In fact, the U.S. authoring agencies have \nrecently observed indications of  Volt Typhoon actors maintaining access and footholds within some \nvictim IT environments for at least five  years. Volt Typhoon actors conduct extensive pre- exploitation \nreconnaissance to learn about the target organization and its environment ; tailor their tactics, \ntechniques, and procedures (TTPs) to the victims environment; and dedicate ongoing resources  to \nmaintaining persistence and understanding the target environment over tim e, even after initial \ncompromise.  \nThe authoring agencies urge critical infrastructure organizations to apply the mitigations in this \nadvisory  and to hunt for similar malicious activity using the guidance herein provided, along with  the \nrecommendations found  in joint guide Identifying and Mitigating Living Off the Land  Techniques . \nThese mitigations are primarily  intended for IT and OT administrators in critical infrastructure \norganizations . Following the mitigations for prevention of or in response to an incident will help disrupt \nVolt Typhoons  accesses and reduce the threat to critical infrastructure entities.  \nIf activity is identified, the authoring agencies strongly recommend that critical infrastructure \norganizations apply the incident response recommendations in this advisory and report the incident to \nthe relevant agency  (see Contact Information  section). \nFor additional information, see joint advisory People s Republic of China State- Sponsored Cy ber \nActor Living off the Land to Evade Detection  and U .S. Department of Justice (DOJ) press release \nU.S. Government Disrupts Botnet Peoples Republic of China Used to Conceal Hacking of Critical \nInfrastructure . For more information on PRC s tate-sponsored malicious cyber activity, see CISAs \nChina Cyber Threat Overview and Advisories  webpage.  \nFor a downloadable copy of indicators of compromise ( IOCs ), see:  \n MAR -10448362- 1.v1 (JSON , 60KB)  \n  \n\n \n  TLP: CLEAR  \nPage 4 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  TABLE OF CONTENTS  \nSummary  ............................................................................................................................................. 2 \nTable of Contents  ................................................................................................................................ 4 \nTechnical Details  .................................................................................................................................  6 \nOverview of Activity .......................................................................................................................... 6 \nObserved TTPs  ................................................................................................................................ 9 \nReconnaissance ........................................................................................................................... 9 \nResource Development  ................................................................................................................ 9 \nInitial Access  ................................................................................................................................ 9 \nExecution ..................................................................................................................................... 9 \nPersistence  ................................................................................................................................ 10 \nDefense Evasion  ........................................................................................................................ 10 \nCredential Access  ...................................................................................................................... 10 \nDiscovery  ................................................................................................................................... 11 \nLateral Movement  ....................................................................................................................... 13 \nCollection and Exfiltration  ........................................................................................................... 14 \nCommand and Control  ................................................................................................................... 15 \nDetection/Hunt Recommendations  .................................................................................................... 16 \nApply Living off the Land Detection Best Practices  ........................................................................ 16 \nReview Application, Security, and System Event Logs  ...................................................................  16 \nMonitor and Review OT System Logs  ............................................................................................  19 \nUse gait to Detect Possible Network Proxy Activities  ..................................................................... 20 \nReview Logins for Impossible Travel  .............................................................................................. 20 \nReview Standard Directories for Unusual Files  .............................................................................. 20 \nIncident Response  ............................................................................................................................. 20 \nMitigations  ......................................................................................................................................... 23 \nIT Network Admi nistrators and Defenders  ...................................................................................... 23 \nHarden the Attack Surface ......................................................................................................... 23 \nSecure Credentials  ..................................................................................................................... 24 \nSecure Accounts  ........................................................................................................................ 24 \nSecure Remote Access Services  ............................................................................................... 26 \nSecure Sensitive Data  ................................................................................................................ 26 \n\n \n  TLP: CLEAR  \nPage 5 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  Implement Network Segmentation .............................................................................................. 26 \nSecure Cloud Assets  .................................................................................................................. 26 \nBe Prepared  ............................................................................................................................... 27 \nOT Administrators and Defenders  .................................................................................................. 28 \nContact Information  ........................................................................................................................... 29 \nValidate Security Controls  ................................................................................................................. 30 \nReferences  ........................................................................................................................................ 30 \nResources  ......................................................................................................................................... 30 \nDisclaimer  ......................................................................................................................................... 31 \nAcknowledgements  ........................................................................................................................... 31 \nVersion History  .................................................................................................................................. 31 \nAppendix A: Volt Typhoon Observ ed Commands / LOTL Activity  ...................................................... 32 \nAppendix B: Indicators of Compromise  .............................................................................................. 36 \nAppendix C: MITRE ATT&CK Tactics and Techniques  ...................................................................... 37 \n  \n\n \n  TLP: CLEAR  \nPage 6 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  TECHNICAL DETAILS  \nNote:  This advisory uses the MITRE ATT&CK for Enterprise  framework, version 14. See Appendix C: \nMITRE ATT&CK Tactics and Techniques  s ection for tables of the Volt Typhoon cyber threat actors \nactivity mapped to MITRE ATT&CK tactics and techniques . For assistance with mapping malicious \ncyber activity  to the MITRE ATT&CK framework, see CISA  and MITRE ATT&CKs Best Practices for \nMITRE ATT&CK Mapping  and CISAs Decider Tool . \nOverview of Activity  \nIn May 2023,  the authoring agencies working  with industry partners disclosed information about \nactivity attributed to  Volt Typhoon (see joint advisory People s Republic of China State- Sponsored \nCyber Actor Living off the Land to Evade Detection ). Si nce then, CISA, NSA, and FBI  have \ndetermined that this activity is part of a broader campaign in which Volt Typhoon actors have \nsuccessfully infiltrated the networks of critical infrastructure organizations  in the continental and non -\ncontinental United States and its territories, including Guam.  \nThe U.S. autho ring agencies have primarily  observed compromises linked to Volt Typhoon in \nCommunications , Energy , Transportation Systems , and Water and Wastewater Systems  sector \norganizations  IT networks . Some victims are smaller organizations with limited cybersecurity \ncapabilities that provide critical services to larger organizations or key geographic locations.  \nVolt Typhoon actors tailor their TTPs to the victim environment; however, the U.S. authoring agenc ies \nhave observed the actors typically follow ing the same pattern of behavior  across identified intrusions . \nTheir  choice of targets and pattern of behavior is not consistent with traditional cyber espionage or \nintelligence gathering operations, and the U.S. authoring agencies assess with high confidence  that \nVolt Typhoon actors are pre-positioning themselves  on IT networks  to enable the disrupt ion of  OT \nfunctions  across multiple critical infrastructure sectors  (see Figure 1). \n1. Volt Typhoon conducts extensive pre -compromise reconnaissance to learn about the \ntarget organizations network architecture and operational protocols.  This \nreconnaissance includes identifying network topologies, security measures, typical user \nbehaviors, and key network and IT staff. The intelligence gathered by  Volt Typhoon actors is \nlikely leveraged to enhance their operational security. For example, i n some instances, Volt \nTyphoon actors  may have abstained from using compromised credentials outside of normal \nworking hours to avoid triggering security alerts on abnormal account activities.  \n2. Volt Typhoon typically  gains initial access to the IT network by exploiting known or \nzero- day vulnerabilities  in public- facing network appliances  (e.g., routers, virtual private \nnetwork s [VPNs], and firewalls)  and then connects to the victims  network via VPN for follow -\non activities.  \n3. Volt Typhoon  aims to obtain administrator credentials within the network, often by \nexploiting privilege escalation vulnerabilities in the operating system or network \nservices.  In some cases, Volt Typhoon has obtained credentials insecurely stored on a \npublic -facing network appliance. \n\n \n  TLP: CLEAR  \nPage 7 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  4. Volt Typhoon  uses valid administrator  credentials to move laterally to the domain \ncontroller  (DC)  and other devices  via remote access services such as Remote Desktop \nProtocol  (RDP) . \n5. Volt Typhoon conducts discovery  in the victim s network, leveraging LOTL binaries for \nstealth. A key tactic includes using PowerShell to perform targeted queries on Windows event \nlogs, focusing on specific users and periods. These queries facilitate the discreet extraction of \nsecurity event logs into .dat  files, allowing Volt Typhoon actors to gather critical information \nwhile minimizing detection. This strategy, blending in- depth pre -compromise reconnaissance \nwith meticulous post -exploitation intelligence collection, underscores their sophisticated and \nstrategic approach to cyber operations. \n6. V olt Typhoon  achieves full  domain compromise by extracting the  Active Directory \ndatabase ( NTDS.dit ) from the DC . Volt Typhoon frequently  employs the Volume Shadow \nCopy Service (VSS) using command -line utilities such as  vssadmin  to access  NTDS.dit . The \nNTDS.dit  file is a centralized repository  that contains critical Active Directory data, including \nuser accounts, passwords (in hashed form), and other sensitive data , which  can be leveraged \nfor further exploitation.  This method entails the creation of a shadow copy a point -in-time \nsnapshot of the volume hosting the  NTDS.dit  file. By leveraging this snapshot, Volt Typhoon \nactors effectively bypass the file locking mechanisms inherent in a live Windows environment, \nwhich typically prevent direct access  to the NTDS.dit  file while the d omain controller is \noperational.  \n7. V olt Typhoon likely uses offline password cracking techniques to decipher these \nhashes.  This process involves extracting the hashes from the NTDS.dit  file and then applying \nvarious password cracking methods, such as brute force attacks, dictionary attacks, or more sophisticated techniques like rainbow tables to uncover the plaintext passwords. The \nsuccessful decryption of these passwords allows  Volt Typhoon actors to obtain elevated \naccess and further infiltrate and manipulate the network.  \n8. V\nolt Typhoon uses elevated credentials for strategic network infiltration and additional \ndiscovery, often focusing on gaining capabilities to access OT assets. Volt Typhoon \nactors have been observed testing access to domain- joint OT assets using default OT vendor \ncredentials, and in certain instances, they have possessed the capability to access OT \nsystems wh ose credentials were compromised via NTDS .dit  theft. This access enables \npotential disruptions, such as manipulating heating, ventilation, and air conditioning (HVAC) systems in server rooms or disrupting critical energy and water controls, leading to significant \ninfrastructure failures (in some cases, Volt Typhoon actors had the capability to access \ncamera surveillance systems at critical infrastructure facilities). In one confirmed compromise, \nVolt Typhoon actors moved laterally to a control system and were positioned to move to a second control system . \n\n \n  TLP: CLEAR  \nPage 8 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  Figure 1: Typical Volt Typhoon Activity  \nAfter  successfully gaining access to legitimate accounts , Volt Typhoon actors exhibit minimal activity  \nwithin  the compromised  environment  (except discovery as noted above), suggesting their  object ive is \nto maintain persistence  rather than immediate exploitation. This assessment is supported by \nobserved patterns where Volt Typhoon methodically re- targets the same organizations over extended \nperiods, often spanning several years, to continuously validate and potentially enhance their \nunauthorized accesses. Evidence of their meticulous approach is seen in instances where they repeatedly exfiltrate domain credentials, ensuring access  to current and valid accounts.  For example, \nin one compromise, Volt Typhoon likely extracted NTDS.dit  from three domain controllers in a four -\nyear period. In another compromise, Volt Typhoon actors extracted NTDS.dit  two times from a victim \nin a nine- mont h period.  \nIndustry reportingi dent ifying that Volt Typhoon actors are silent on the network following credential \ndumping and perform  discovery to learn about the environment, but do not exfiltrate data is \nconsistent with the U.S. authoring agencies observations . This  indicat es their aim is to achieve and \nmaintain persistence on the network. In one confirmed compromise, an industry partner observed Volt Typhoon actors dumping  credentials at regular intervals . \nIn addition to leveraging stolen account  credentials , the actors use LOTL techniques and avoid \nleaving malware artifacts on systems that would cause alerts . Their  strong  focus on stealth and \noperational security  allows them to maintain long-term, undiscovered persistence. Further, Volt \nTyphoons operational security is enhanced by targeted log deletion to conceal their actions within the \ncompromised environment . \nSee the below sections for Volt Typhoon TTPs observed by the U.S. authoring agencies f rom multiple \nconfirmed Volt Typhoon compromises . \n\n\n \n  TLP: CLEAR  \nPage 9 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  Observed TTPs  \nReconnaissance \nVolt Typhoon actors conduct extensive pre- compromise reconnaissance  [TA0043 ] to learn about the \ntarget organization [ T1591], its network  [T1590] , and its staff  [T1589 ]. This includes web searches  \n[T1593]including victim -owned sites  [T1594 ]for victim host  [T1592 ], identity, and network \ninformation, especially for information on key network and IT administrator s. According to i ndustry \nreporting, Volt Typhoon actors use FOFA [1], Shodan, and Censys for  querying or searching for \nexposed infrastructure . In some  instances , the U.S. authoring agencies have observed Volt Typhoon \nactors target ing the personal emails of key net work and IT staff [T1589.002 ] post compromise.  \nResource Development  \nHistorically, Volt Typhoon actors use multi- hop prox ies for command and control  (C2) infrastructure \n[T1090.003 ]. The proxy is typically composed of virtual private servers  (VPSs) [T1583.003 ] or small \noffice/home office (SOHO) route rs. Recently, Volt Typhoon actors used Cisco and NETGEAR end-of-\nlife SOHO routers implanted with KV Botnet malware to support their operations  [T1584.005 ]. (See \nDOJ press release U.S. Government Disrupts Botnet Peoples Republic of China Used to C onceal \nHacking of Critical Infrastructure  f or more information).  \nInitial Access  \nTo obtain initial access  [TA0001 ], Volt Typhoon  actors commonly  exploit vulnerabilities in networking \nappliances such as  those from Fortinet, Ivanti  Connect Secure (formerly Pulse Secure) , NETGEAR, \nCitrix,  and Cisco  [T1190 ]. They often use publicly available exploit code for known vulnerabilities \n[T1588.005 ] but are also  adept at discovering and exploiting zero -day vulnerabilities [T1587.004 ]. \n In one confirmed compromise, Volt Typhoon actors likely obtained initial access by exploiting \nCVE-2022- 42475  in a network peri meter FortiGate 300D  firewall that was not patched. There \nis evidence of a buffer overflow attack identified within the Secure Sockets Layer ( SSL)-VPN \ncrash logs.  \nOnce initial access is achieved, Volt Typhoon actors  typically shift to establishing persistent access  \n[TA0003] . They often use  VPN sessions to securely connect to victim environments  [T1133 ], enabling \ndiscreet follow -on intrusion activities. This tactic not only provides a stable foothold in the network but \nalso allows them to blend in with regular traffic, significantly reducing their chances of detection.  \nExecution  \nVolt Typhoon actors rarely use malware for  post-compromise execution. Instead, once Volt Typhoon \nactors  gain access to target environment s, they use  hands -on-keyboard activity via the command -line \n[T1059] and other native tools and processes on system s [T1218 ] (often referred to as LOLBins), \nknown as LOTL, to maintain and expand access to the victim networks . According to industry \nreporting, some commands appear to be exploratory or experimental, as the operators [i.e., \nmalicious actors]  adjust and repeat them multiple times. [2] \n\n \n  TLP: CLEAR  \nPage 10 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  For more details  on LOTL activity , see the Credential Access and Discovery sections and Appendix  \nA: Volt Typhoon LOTL Activity . \nSimilar  to LO TL, Volt Typhoon actors also use legitimate but  outdated versions of  network admin \ntools. For example, in one confirmed compromise, actors downloaded [ T1105 ] an outdated version of  \ncomsvcs.dll  on the DC  in a non- standard folder . comsvcs.dll  is a legitimate Microsoft Dynamic \nLink Library ( DLL) file normally found in the System32  folder. The actors used this  DLL with MiniDump  \nand the process ID of the Local Security Authority Subsystem Service ( LSASS) to dump  the LSASS \nprocess memory  [T1003.001 ] and obtain credentials  (LSASS process memory space contains hashes \nfor the current users operating system ( OS) credentials) . \nThe actors also use legitimate non-native network admin and forensic  tools.  For example, Volt \nTyphoon actors hav e been observed using Magnet RAM Capture (MRC)  version 1.20 on domain \ncontrollers.  MRC is a free imaging tool that captures the physical memory of a computer, and Volt \nTyphoon actors likely used it to analyze i n-memory data for sensitive information ( such as credentials ) \nand in- transit data not typically accessible on disk.  Volt Typhoon actors have  also been observed \nimplanting Fast Reverse Proxy ( FRP) for command and control. [3] (See the Command and Control  \nsection). \nPersistence  \nVolt Typhoon primarily relies on valid credentials for persistence  [T1078 ]. \nDefense Evasion \nVolt Typhoon has strong  operational security. Their  actors  primarily  use LOTL for  defense evasion \n[TA0005 ], which allows them to camouflage their malicious activity with typical system and network \nbehavior, potentially circumventing simplistic endpoint security capabilities . For more information, see \njoint guide  Identifying and Mitigating Living off the Land Techniques . \nVolt Typhoon actors also obfuscate their malware. In one confirmed compromise, Volt Typhoon  \nobfuscated  FRP client files (BrightmetricAgent.exe and SMSvcService.exe) and the command-\nline port scanning utility ScanLine by packing  the files with Ultimate Packer for Executables (UPX)  \n[T1027.002 ]. FRP client  applications support encryption, compression, and easy token authentication \nand work across  multiple protocols including transmission control protocol ( TCP), user datagram \nprotocol (UDP ), hypert ext transfer protoc ol (HTTP ), and hypertext transfer protocol secure ( HTTPS ). \nThe FRP client applications use the Kuai connection protocol ( KCP) for error -checked and \nanonymous data stream delivery over UDP, with packet -level encryption support.  See Appendix C  \nand CISA  Malware Analysis Report (MAR )-10448362-1.v1  for more information.  \nIn addition to LOTL and obfuscation techniques, Volt Typhoon actors have  been observed  selectively \nclearing Windows Event Logs  [T1070.001 ], system logs, and other technical artifacts to remove \nevidence [T1070.009] of their intrusion activity  and masquerading file names  [T1036.005 ]. \nCredential Access  \nVolt Typhoon actors  first obtain credentials from public -facing appliances after gaining initial access \nby exploiting privilege escalation vulnerabilities [ T1068 ] in the operating system or network services . \n\n \n  TLP: CLEAR  \nPage 11 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  In some cases, they have obtained credentials insecurely stored on the appliance [ T1552 ]. In one \ninstance, where Volt Typhoon likely  exploited CVE-2022- 42475 in an unpatched Fortinet device, Volt \nTyphoon actors compromised a domain admin acc ount stored  inappropriately  on the  device. \nVolt Typhoon al so consistently obtains  valid credentials  by extracting the A ctive D irectory  database \nfile (NTDS.dit )in some cases multiple times from the same victim over long periods [ T1003.003 ]. \nNTDS.dit  contains usernames, hashed passwords, and group memberships for all domain accounts , \nessentially allowing for full domain compromise if the hashes can be cracked offline.  \nTo obtain NTDS.dit , the U.S. authoring agencies have observed Volt Typhoon: \n1. Move laterally [TA0008 ] to the domain controller  via an interactive RDP session using a \ncompromised account with domain administrator privileges  [T1021.001 ]; \n2. Execut e the Windows -native vssadmin  [T1006 ] command to create a volume shadow copy; \n3. Use Windows M anagement Instru mentation  Console ( WMIC ) commands  [T1047 ] to execute  \nntdsutil  (a LOTL utility ) to copy NTDS.dit  and SYSTEM  registry hive from the volume \nshadow copy; and  \n4. Exfiltrate [TA0010 ] NTDS.dit  and SYSTEM registry hive to crack passwords  offline) \n[T1110.002 ]. (For more details, including specific commands used, see Appendix A: Volt \nTyphoon LOTL Activity .) \nNote:  A volume shadow copy contains a copy of all the files and folders that exist on the \nspecified volume. Each volume shadow copy created on a DC include s its NTDS.dit and the \nSYSTEM  registry hive, which  provides keys to decrypt the NTDS.dit file. \nVolt Typhoon actors have  also been observed interacting with a PuTTY application by enumerating \nexisting stored sessions  [T1012 ]. Given this interaction and the exposure of cleartext -stored proxy \npasswords  used in remote administration, Volt Typhoon actors potentially had access to PuTTY \nprofiles that allow access to critical systems (see the Lateral Movement  section).  \nAccording to i ndustry reporting,  Volt Typhoon actors attempt ed to dump credentials through LSASS \n(see Appendix B for commands used). [2] \nThe U.S.  authoring agencies have observed Volt Typhoon actors leveraging Mimikatz  to harvest \ncredentials , and industry partners have  observed Volt Typhoon leveraging Impacket .[2] \n Mimik atz is a credential dumping tool  and Volt Typhoon actors use it to obtain credentials. In \none confirmed compromise, the Volt Typhoon  used RDP to connect to a server and run \nMimikatz  after leveraging a compromised administrator account to deploy it. \n Impacket is an open source Python toolkit for programmatically constructing and manipulating \nnetwork protocol s. It contains  tools for Kerberos manipulation, Windows credential dumping, \npacket sniffing, and relay attacks as well as remote service execution. \nDiscovery  \nVolt Typhoon actors have  been observed using commercial tools, LOTL utilities, and appliances \nalready present on the system for system information [ T1082 ], network service [ T1046 ], group \n[T1069] and user  [T1033 ] discovery. \n\n \n  TLP: CLEAR  \nPage 12 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  Volt Typhoon uses at least the following LOTL tools and commands for system information, network \nservice, group, and user discovery techniques : \n cmd \n certutil  \n dnscmd  \n ldifde  \n makecab  \n net user/group/use  \n netsh   nltest  \n netstat  \n ntdsutil  \n ping \n PowerShell  \n quser  \n reg query /reg save   systeminfo  \n tasklist \n wevtutil \n whoami  \n wmic  \n xcopy  \nSome observed specific examples of discovery include: \n Capturing successful logon events  [T1654 ]. \no Specifically, in one incident, analysis of the PowerShell console history of a domain \ncontroller indicated that security event logs were directed to a file named user.dat , as \nevidenced by the executed command Get -EventLog security -instanceid 4624 -\nafter [year -month-date] | fl * | Out -File \n'C:\\users\\public\\documents \\user.dat' . This indicates the group 's specific interest in \ncapturing successful logon events (event ID 4624 ) to analyze user authentication patterns \nwithin the network. Additionally, file system analysis, specifically of the Master File Table \n(MFT), uncovered evidence of a separate file, systeminfo.dat, which was created in \nC:\\Users\\Public\\Documents but subsequently deleted [ T1070.004 ]. The presence of \nthese activities suggests a methodical approach by Volt Typhoon actors in collecting and \nthen possibly removing traces of sensitive log information from the compromised system.  \n Executing tasklist /v  to gather  a detailed process listing [ T1057 ], followed by executing \ntaskkill /f /im rdpservice.exe (the function of this executable is not known) . \n Executing net user  and quser  for user account information [ T1087.001 ]. \n Creating and accessing a file named rult3uil.log  on a d omain controller in \nC:\\Windows\\System32 \\. The rult3uil.log  file contained user activities on a compromised \nsystem, showcasing a combination of window title information [ T1010 ] and focus shifts, \nkeypresses , and command executions across  Google Chrome  and Windows PowerShell, with \ncorresponding timestamps. \n Employing ping  with various IP addresses to check network connectivity  [T1016.001 ] and net \nstart  to list running services  [T1007 ]. \nSee Appendix A for additional LOTL examples.  \nIn one confirmed compromise, Volt Typhoon actors  attempted to use Advanced IP Scanner, which \nwas on the network for admin use, to scan the network . \nVolt Typhoon actors have  been observed strategically targeting network administrator web browser \ndatafocusing on both browsing history and stored credentials  [T1555.003 ]to facilitate targeting of \npersonal email addresses (see the Reconnaissance  section) for  further  discovery  and possible \nnetwork modifications that may impact the threat actors persistence within victim networks.  \n\n \n  TLP: CLEAR  \nPage 13 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  In one confirmed compromise: \n Volt Typhoon actors obtained the history file from the User Data  directory of a network \nadministrator users  Chrome browser. To obtain the history file, Volt Typhoon actors first \nexecuted an RDP session to the users  workstation where they initially attempted, and  failed , \nto obtain the C$ File Name: \nusers\\{redacted}\\appdata\\local\\Google\\Chrome\\UserData \\default\\History  file, as \nevidenced by the accompanying 1016  (reopen failed) SMB error listed in the application event \nlog. The threat  actors  then disconnected the RDP session to  the workstation  and accessed \nthe file C:\\Users\\{redacted} \\Downloads\\ History.zip. This file presumably  contained \ndata from the User  Data directory of  the users  Chrome browser, which the actors  likely \nsaved in the Downloads directory for exfiltration  [T1074 ]. Shortly after accessing the \nhistory.zip  file, the actors terminated RDP sessions.  \n About four months later , Volt Typhoon actors  access ed the same users Chrome data  C$ \nFile Name: Users \\{redacted} \\AppData\\Local\\Google\\Chrome\\User Data\\ Local \nState  and $ File Name: Users\\ {redacted} \\AppData\\Local\\Google\\Chrome\\User \nData\\Default\\Login Data  via SMB. Th e Local State file contains the Advanced Encryption \nStandard (AES) encryption key [ T1552.004 ] used to encrypt the passwords stored in the \nChrome browser, which would enable the actors to obtain plaintext passwords stored in the \nLogin Data file in the Chrome browser.  \nIn another confirmed compromise, Volt Typhoon  ac tors accessed directories  containing Chrome and \nEdge user data  on multiple systems . Directory interaction was observed over the network to paths \nsuch as C: \\Users\\{redacted} \\AppData\\Local\\Google\\Chrome\\User Data \\ and \nC:\\Users\\{redacted} \\AppData\\Local\\Microsoft \\Edge\\User Data \\. They also enumerated \nseveral directories, including directories containing vulnerability testing and cyber related content and facilities data, such as construction drawings  [\nT1083 ]. \nLateral Movement  \nFor lateral movement, Volt Typhoon actors have  been observed  predominantly employing RDP with \ncompromised valid administrator credentials.  Note:  With a full on -premises  Microsoft Active Directory \nidentity  compromise  (see the Credential Access  section) , the group may be capable of using other \nmethods such as Pass the Hash or Pass the Ticket for lateral movem ent [T1550 ]. \nIn one confirmed compromise of a Water and Wastew ater Systems  Sector entity , after obtaining initial \naccess, Volt Typhoon actors connected to the network via a VPN with administrator credentials they \nobtained and opened an RDP session with the same credentials to move laterally. Over a nine- month \nperiod, they moved laterally to a file server, a domain controller, an Oracle Management Server \n(OMS), and a VMware vCenter server. The actors obtained domain credentials from the domain controller and performed discovery, collection, and exfiltration on the file server (see the Discovery\n \nand Collection and Exfiltration  section s). \nVolt Typhoons  movement to the vCenter server was likely strategic  for pre -positioning to OT assets . \nThe vCenter server was adjacent to OT assets, and Volt Typhoon actors were observed interacting \nwith the PuTTY application on the server by enumerating existing stored sessions. With this \n\n \n  TLP: CLEAR  \nPage 14 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  information, Volt Typhoon potentially had access to a range of critical PuTTY profiles, including those \nfor water treatment plants, water wells, an electrical substation, OT systems, and network security \ndevices. This would enable them to access these critical systems  [T1563 ]. See Figure 2. \n \n \nFigure 2: Volt Typhoon Lateral Movement Path File Server , DC,  and OT -Adjacent Assets \nAdditionally, Volt Typhoon actors have  been observed using  PSExec  to execute remote processes , \nincluding  the automated acceptance of the end- user license agreement (EULA) through an \nadministrative account, signified by the accepteula  command flag.  \nVolt Typhoon actors may have attempted to move laterally to a cloud environment in one  victims \nnetwork but  direct attribution to the Volt Typhoon group was inconclusive. During the period of the \ntheir known network presence, there were anomalous login attempts to an Azure tenant  [T1021.007 ] \npotentially using credentials [ T1078.004 ] previously compromised from  theft of  NTDS.dit . These \nattempts, co upled with misconfigured virtual machines with open RDP ports, suggested a potential for \ncloud- based lateral movement. However, subsequent investigations, including password changes and \nmultifactor authentication ( MFA ) implementations, revealed authenticat ion failures from non -\nassociated IP addresses, with no definitive link to Volt Typhoon. \nCollection  and Exfiltration  \nThe U.S. authoring agencies assess Volt Typhoon primarily collects information that would facilitate \nfollow- on actions with physical impacts. For example, in one confirmed compromise,  they collected  \n[TA0009] sensitive information obtained from a file server in multiple zipped files  [T1560 ] and likely \nexfiltrated [TA0010] the files via Server Message Block (SMB)  [T1048 ] (see Figure 3) . Collected \ninformation included diagrams and document ation  related to OT equipment , including supervisory \n\n\n \n  TLP: CLEAR  \nPage 15 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  control and data acquisition (SCADA) systems, relays,  and switchgear . This data is crucial for \nunderstanding and potentially impacting critical infrastructure systems, indicating a focus on gathering \nintelligence that could be leveraged in actions targeting physical assets and systems.  \n \nFigure 3: Volt Typhoon Attack Path for Exfiltration of Data from File Server  \nIn another  compromise, Volt Typhoon actors  leveraged WMIC to create and use temporary \ndirectories ( C:\\Users\\Public\\pro, C:\\Windows\\Temp\\tmp, C:\\Windows\\Temp\\tmp\\Active \nDirectory and C:\\Windows\\Temp\\tmp\\registry ) to stage the extracted ntds.dit  and SYSTEM \nregistry hives from ntdsutil execution volume shadow copies ( see the Credential Access  section)  \nobtained from  two DCs. They then  compressed and archived the  extracted ntds.dit  and \naccompanying registry files  by executing ronf.exe , which was likely a renamed version of the \narchive utility rar.exe ) [T1560.001 ]. \nCommand and  Control  \nVolt Typhoon actors have  been observed leveraging compromised SOHO  routers and virtual private \nservers (VPS) to proxy C2 traffic . For more information, see  DOJ press release U.S. Government \nDisrupts Botnet Peoples Republic of China Used to Conceal Hacking of Critical Infrastructure ). \nThey have also been observed setting up FRP clients [T1090 ] on a victims corporate infrastructure  to \nestablish covert communications channels [ T1573 ] for command and control. In one instance, Volt \nTyphoon actors implanted the FRP client with filename SMSvcService.exe  on a Shortel Enterprise \nContact Center  (ECC) server and a  second  FRP client with filena me Brightmetricagent.exe  on \nanother  server. These clients, when executed via PowerShell  [T1059.001 ], open reverse proxies \nbetween the compromised system and Volt Typhoon C2 server s. Brightmetricagent.exe  has \n\n\n \n  TLP: CLEAR  \nPage 16 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  additional capabilities. The FRP  client  can locate servers behind a network firewall or obscured \nthrough Networ k Address Translation (NAT)  [T1016 ]. It also  contains multiplexer libraries that can bi -\ndirectionally stream data over NAT network s and contains a comm and-line interface (CLI) library that \ncan leverage command shells such as PowerShell, Windows Management  Instrumentation (WMI), \nand Z Shell (zsh)  [T1059.004]. See Appendix C  and MAR -10448362 -1.v1 for more information.  \nIn the same compromise , Volt Typhoon actors  exploited a Paessler Router Traffic Grapher (PRTG) \nserver as an intermediary for their FRP  operations. To facilitate this, they used the netsh  command, \na legitimate Windows command, to create a PortProxy registry modification [T1112 ] on the PRTG \nserver  [T1090.001 ]. This key alteration redirected specific port traffic to Volt Typhoons proxy \ninfrastructure, effectively converting the PRTG s server into a proxy for their C2 traffic [ T1584.004 ] \n(see Appendix B for details).  \nDETECTION/HUNT RECOMMENDATIONS  \nApply Living off the Land  Detection Best Practices  \nApply the prioritized detection and hardening best practice recommendations provided in joint \nguide Identifying and Mitigating  Living off the Land Techniques . Many organizations lack \nsecurity and network management best practices (such as established baselines) that support \ndetection of malicious LOTL activity this makes it difficult for network defenders to discern legitimat e \nbehavior from malicious behavior and conduct behavior analytics, anomaly detection, and proactive hunting. Conventional IOCs associated with the malicious activity  are general ly lacking , complicating \nnetwork defenders efforts to identify, track, and cat egorize this sort of malicious behavior. This \nadvisory provides guidance for a  multifaceted cybersecurity strategy that  enables behavior analytics, \nanomaly detection, and proactive hunting, which are part of a comprehensive approach to mitigating \ncyber thr eats that employ LOTL  techniques . \nReview Application, Security, and System  Event Logs  \nRoutinely review application , security , and system  event logs , focusing on Windows \nExtensible Storage Engine Technology ( ESENT ) Application Logs . Due to Volt Typhoons ability \nfor long- term undetected persistence, network defenders should assume significant dwell time and \nreview  specific application event log IDs , which  remain on endpoints for longer  periods compared  to \nsecurity event logs and other ephemeral artifacts. Focus on Windows ESENT logs because c ertain \nESENT  Application Log event IDs  (216, 325, 326, and 327 ) may indicate actors copying NTDS.dit . \nSee Table 1 for examples of  ESENT and other  key log indicators that should be investigated. Please \nnote that incidents may not always have exact matches listed in the Event Detail column due to variations in event logging and TTPs.  \n\n \n  TLP: CLEAR  \nPage 17 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  Table 1: Key Log Indicators for Detecting Volt Typhoon Activity  \nEvent ID  \n(Log)  Event  Detail  Description  \n216 \n(Windows ESENT Application \nLog) A database location change was detected from 'C:\\Windows \\NTDS \\ntds.dit' to \n'\\\\?\\GLOBALROOT \\Device\\ {redacted}VolumeShadowC\nopy1\\ Windows \\NTDS \\ntds.dit'  A change in the NTDS.dit  \ndatabase location is \ndetected. This could \nsuggest an initial step in \nNTDS credential dumping where the database is being prepared for extraction.  \n325 (Windows ESENT Application \nLog) The database engine created a new database (2, C:\\Windows \\Temp \\tmp\\Active Directory \\ntds.dit).  Indicates creation of a new \nNTDS.dit  file in a non -\nstandard directory. Often a \nsign of data staging for \nexfiltration. Monitor for \nunusual database operations in temp directories.  \n637 (Windows \nESENT \nApplication Log) C:\\Windows \\Temp \\tmp\\Active Directory \\ntds.jfm -++- (0) \nNew flush map file C:\\ Windows \\Temp\\ tmp\\Active \nDirectory \\ntds.jfm will be created to enable persisted \nlost flush detection.  A new flush map file is being created for \nNTDS.dit . This may \nsuggest ongoing operations \nrelated to NTDS credential dumping, potentially capturing uncommitted \nchanges to the NTDS.dit  \nfile. \n326 \n(Windows \nESENT  \nApplication Log) NTDS -++-12460,D,100 -++--++-1-++- \nC:\\$SNAP_ {redacted} _VOLUMEC$ \\Windows \\NTDS \\nt\nds.dit -++-0-++- [1] The database engine attached a \ndatabase. Began mounting of C:\\Windows \\NTDS \\ntds.dit file created from volume \nshadow copy process  Represents the mounting of \nan NTDS.dit  file from a \nvolume shadow copy. This is a cr itical step in NTDS \ncredential dumping, \nindicating active \nmanipulation of a domain controllers data.  \n\n \n  TLP: CLEAR  \nPage 18 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  Event ID  \n(Log)  Event  Detail  Description  \n327 \n(Windows ESENT  \nApplication Log) C:\\Windows \\Temp \\tmp\\Active Directory \\ntds.dit -++-1-\n++- [1] The database engine detached a database (2, \nC:\\Windows \\Temp \\tmp\\Active Directory \\ntds.dit). \nCompletion of mounting of ntds.dit file to C:\\Windows \\Temp \\tmp\\Active Director  The detachment of a \ndatabase, particularly in a \ntemp directory, could indicate the completion of a credential dumping process, potentially as part \nof exfiltration preparations.  \n21 (Windows \nTerminal Services \nLocal Session Manager Operational  \nLog) Remote Desktop Services: Session logon succeeded: User: {redacted} \\{redacted} Session ID: {redacted} \nSource Network Address: {redacted}  Successful authentication \nto a Remote Desktop \nServices session.  \n22 (Windows \nTerminal Services \nLocal Session Manager Operational  \nLog) Remote Desktop Services: Shell start notification received: User: {redacted} \\{redacted} Session ID: \n{redacted} Source Network Address: {redacted}  Successful start of  a new \nRemote Desktop session. This may imply lateral movement or unauthorized \nremote access, especially if \nthe user or session is unexpected.  \n23 (Windows \nTerminal \nServices \nLocal Session Manager Operational  \nLog) Remote Desktop Services: Session logoff succeeded: \nUser: {redacted} \\{redacted} Session ID: {redacted}  Successful logoff of Remote Desktop  session. \n24 (Windows \nTerminal \nServices \nLocal Remote Desktop Services: Session has been disconnected: User: {redacted} \\{redacted} Session ID: \n{redacted} Source Network Address: {redacted}  Remote Desktop session disconnected by user or \ndue to network connectivity \nissues. \n\n \n  TLP: CLEAR  \nPage 19 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  Event ID  \n(Log)  Event  Detail  Description  \nSession \nManager \nOperational  \nLog) \n25 (Windows  \nTerminal Services  \nLocal Session \nManager \nOperational Log) Remote Desktop Services: Session reconnection succeeded: User: {redacted} \\{redacted}  Session ID: \n{redacted} Source Network Address: {redacted}  Successful reconnection to \na Remote Desktop Services session. This may imply lateral movement or \nunauthorized remote \naccess, especially if the \nuser or session is unexpected.  \n1017 (Windows \nSystem Log)  Handle scavenged.  \nShare Name: C$  \nFile Name:  \nusers \\{redacted} \\downloads \\History.zip Durable: 1 \nResilient or Persistent: 0 Guidance: The server closed \na handle that was previously reserved for a client after 60 seconds.  Indicates the server closed \na handle for a client. While \ncommon in network operations, unusual patterns or locations (like \nHistory.zip  in a users \ndownloads) may suggest data collection from a local system. \n1102 (Windows Security Log) All All Event ID 1102  entries \nshould be investigated as logs are generally not cleared and this is a known Volt Typhoon \ntactic to cover \ntheir tracks.  \nMonitor and Review OT System Logs  \n Review access logs for communication paths between IT and OT networks, looking for \nanomalous accesses or protocols.  \n Measure the baseline of normal operations and network traffic for the industrial control system \n(ICS) and assess traffic anomalies for malicious activity.  \n Configure intrusion detection systems (IDS) to create alarms for any ICS network traffic \noutside normal operations.  \n Track and monitor audit trails on critical areas of ICS.  \n\n \n  TLP: CLEAR  \nPage 20 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR   Set up security incident and event monitoring (SIEM) to monitor, analyze, and correlate event \nlogs from across the ICS network to identify intrusion attempts. \nReview CISAs Recommended Cybersecurity Practices for Industrial Control Systems  and the joint \nadvisory, NSA and CISA Recommend Immediate Ac tions to Reduce Exposure Across all Operational \nTechnologies and Control Systems , for further OT system detection and mitigation guidance. \nUse gait to Detect Possible Network Proxy Activities  \nUse gait [4] to detect network proxy  activities. Developed by Sandia National Labs , gait is a \npublicly  available Zeek [5] extension. The gait extension can help enrich Zeeks network connection  \nmonitoring and SSL  logs by including additional metadata in the logs. Specifically, gait captures \nunique TCP options and timing data such as a TCP, transpo rt layer security ( TLS), and Secure Shell \n(SSH) layer inferred round trip times (RTT), aiding in the identification of the software used by both \nendpoints and intermediari es. \nWhile the gait extension for Zeek is an effective tool for enriching network monitoring logs with \ndetailed metadata, it is not specifically designed to  detect Volt Typhoon actor activities . The \nextensions  capabilities extend to general anomaly detection in network traffic, includingbut not \nlimited to proxying activities. Therefore, while gait can be helpful in identifying tactics similar to those \nused by Volt Typhoon, such as proxy networks and FRP client s for C2 communication, not all \nproxying activities detected by using this additional metadata are necessarily indicative of Volt \nTyphoon presence. It serves as a valuable augmentation to current security stacks for a broader \nspectrum of threat detection.  \nFor more information, see Sandia National Labs gait GitHub  page sandialabs/gait: Zeek Extension to \nCollect Metadata for Profiling of Endpoints and Proxies . \nReview Logins f or Impossible Travel  \nExamine VPN or other account logon times, frequency, duration, and locations . Logons from \ntwo geographically distant locations  within a short timeframe from a single user  may indicate an \naccount is being used maliciously. Logons of unusual frequency or duration  may indicate a threat \nactor attempting to access a system repeatedly or maintain prolonged sessions for the purpose of \ndata extraction.  \nReview Standard Directories for Unusual Files  \nReview directories, such as C:\\windows \\temp\\  and C:\\users \\public\\ , for unexpected or \nunusual files. Monitor these temporary file storage directories for files typically located in standard \nsystem paths, such as the System32  directory. For example, Volt Typhoon has been observed \ndownloading  comsvcs. dll to a non -standard folder (this file is  normally found in the System32  \nfolder ). \nINCIDENT RESPONSE  \nIf compromise, or potential compromise, is detected, organizations should assume full domain \ncompromise because of Volt Typhoons known behavioral pattern of extracting the NTDS.dit  from \n\n \n  TLP: CLEAR  \nPage 21 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  the DC s. Organizations should immediately implement the following immediate, defensive \ncountermeasures:  \n1. Sever the enterprise network from the internet.  Note:  this step requires the agency to \nunderstand its internal and external connections. When making the decision to sever internet \naccess, knowledge of connections must be combined with care to avoid disrupting critical \nfunctions.  \na. If you cannot sever from the inter net, shutdown all non- essential traffic between the \naffected enterprise network and the internet . \n2. Reset credentials of privileged and non -privileged accounts within the trust boundary \nof each compromised account . \na. Reset passwords for all domain users and all local accounts, such as  Guest , \nHelpAssistant , DefaultAccount , System, Administrator, and krbtgt . The krbtgt  \naccount is responsible for handling Kerberos ticket requests as well as encrypting and \nsigning them . The krbtgt  account should be reset twice because the account has a two-\npassword history. The first account reset for the krbtgt needs to be allowed to replicate \nprior to the second reset to avoid any issues. See CISAs Eviction Guidance for Networks \nAffected by the SolarWinds and Active Directory/M365 Compromise  f or more information. \nAlthough tailored to FCEB agencies compromised in the 2020 SolarWinds Orion supply \nchain compromise , the steps are applicable to organizations with Windows AD \ncompromise.  \ni) Review access policies to temporarily revoke privileges/access for affected \naccounts/devices. If it is necessary to not alert the attacker (e.g., for intelligence \npurposes), then privileges can be reduced for affected accounts/devices to contain \nthem.  \nb. Reset the relevant account credentials or access keys if the investigation finds the threat \nactors access is limited to non- elevated permissions.  \ni) Monitor related accounts, especially administrative accounts, for any further signs of unauthorized access. \n3. Audit all network appliance and edge device configurations with indicators of malicious activity for signs of unauthorized or malicious configuration changes. Organizations should ensure they audit the current network device running configuration and any local configurations that \ncould be loaded at boot time. If configuration changes are identified:  \na. Change all credentials being used to manage network devices, to include keys and strings \nused to secure network device functions (SNMP strings/user credentials, IPsec/IKE preshared keys, routing secrets, TACACS/RADIUS secrets, RSA keys/certificates, etc.).  \nb. Update all firmware and software to the latest version.  \n4. Report the compromise to an authoring agency (see the C ontact Information\n section).  \n5. For organizations with cloud or hybrid environments, apply best practices for identity and credential access management.  \na. Verify that all accounts with privileged role assignments are cloud nat ive, not synced from \nActive Directory. \n\n \n  TLP: CLEAR  \nPage 22 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  b. Audit conditional access policies to ensure Global Administrators and other highly \nprivileged service principals  and accounts are not exempted. \nc. A udit privileged role assignment s to ensure adherence to the  principle  of least privilege \nwhen assigning privileged roles . \nd. Leverage just -in-time and just -enough access mechanisms when administrators need to \nelevate to a privileged role.  \ne. In hybrid environments, ensure federated systems (such as AD FS ) are configured and \nmonitored properly.  \nf. Audit Enterprise Applications for recently added applications and examine the API \npermissions assigned to each.  \n6. Reconnect to the internet.  Note:  The decision to reconnect to the internet depends on \nsenior  leaderships confidence in the actions taken. It is possibledepending on the \nenvironment that new information discovered during pre -eviction and eviction steps could \nadd additional eviction tasks.  \n7. Minimize and control use of remote access tools and protocols by applying best practices \nfrom joint Guide to Securing Remote Access Software  and joint Cybersecurity Information \nSheet: Keeping PowerShell: Security Measures to Use and Embrace . \n8. Consider sharing technical information with an authoring agency and/or a sector -\nspecific information sharing and analysis center . \nFor more information on incident response and remediation, see:  \n Joint advisory Technical Approaches to Uncovering and Remediating Malicious Activity . This \nadvisory provides incident response best practices . \n CISAs Federal Government Cybersecurity Incident and Vulnerability Response Playbooks . \nAlthough tailored to U.S. Federal Civilian Executive Branch (FCEB) agencies, the playbooks \nare applicable to all organizations. The incident response playbook provides  procedures to \nidentify, coordinate, remediate, recover, and track successful mitigations from incidents . \n Joint  Water and Wastewater Sector - Incident Response Guide . This joint guide provides \nincident response best practices and information on federal resources  for Water and \nWastewater Systems Sector organizations.  \n  \n\n \n  TLP: CLEAR  \nPage 23 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  MITIGATIONS \nThe authoring agencies  recommend \norganizations implement the mitigati ons below \nto improve your organizations cybersecurity \nposture on the basis of Volt Typhoon activity. \nThese mitigations align with the Cross -Sector \nCybersecurity Performance Goals (CPGs) \ndeveloped by CISA and the National Institute of \nStandards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based \nthe CPGs on existing cybersecurity frameworks \nand guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISAs \nCross -Sector Cybersecurity Performance Goals\n \nfor more information on the CPGs, including \nadditional recommended baseline protections.  \nIT Network  Administrators and Defenders  \nHarden the Attack Surface  \n Apply patches for internet -facing systems within a risk -informed span of time  [CPG 1E ]. \nPrioritize patching critical assets, known exploited vulnerabilities , and vulnerabilities in \nappliances known to be frequently exploited by Volt Typhoon (e.g., Fortinet, Ivanti, NETGEAR, Citrix, and Cisco devices). \n Apply vendor -provided or industry standard hardening guidance  to strengthen software \nand system configurations . Note:  As part of CISAs Secure by Design campaign , CISA urges \nsoftware manufacturers to prioritize secure by default configurations to eliminate the need for customer implementation of hardening guidelines.  \n Mainta in and regularly update an inventory of all organizational IT assets [ CPG  1A]. \n Use third party assessment s to validate  current system and network security \ncompliance via security architecture reviews, penetration tests, bug bounties,  attack surface \nmanagement services,  incident simulatio ns, or table -top exercises (both announced and \nunannounced)  [CPG 1 F]. \n Limit internet exposure of systems when not necessary. An organizations primary attack \nsurface is the combination of the exposure of all its internet -facing systems. Decrease the \nattack surface by not exposing systems or management interfaces to the internet when not \nnecessary.  \n Plan  end of l ife for technology beyond manufacturer supported lifecycle. Inventories \nof organizational assets should be leveraged in patch and configuration management as noted These mitigations  are intended for IT \nadministrators in critical infrastructure organizations. The authoring agencies  recommend \nthat software manufactures incorporate secure by design and default principles and tactics into their software development practices to strengthen the \nsecur ity posture for their customers . \nFor information on secure by design practices that may protect customers against common Volt Typhoon techniques, see joint guide \nIdentifying \nand Mitigating Living off the Land Techniques  and  \njoint Secure by Design Alert  Security Design \nImprovements for SOHO Device Manufacturers . \nFor more  information on secure by d esign, see \nCISAs Secure by Design webpage and joint \nguide . \n\n \n  TLP: CLEAR  \nPage 24 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  above. I nventories will also enable identification of technology beyond the manufacturers \nsupported lifecycle. Where technology is beyond end of life or end of support, additional \ncybersecurity vigilance is necessary, and may warrant one or more of the follow ing: \no Supplemental support agreements ; \no Additional scanning and testing; \no Configuration changes ; \no Isolation; \no Segmentation; and  \no Development of forward- looking plans to facilitate replacement . \nSecure Credentials  \n Do not store credentials on edge appliances/devices . Ensure edge devices do not contain \naccounts that could provide domain admin access . \n Do not store plain text credentials on any system  [CPG 2L ]. Credentials should be stored \nsecurely such as with a credential/password manager or vault, or other privileged account \nmanagement solutions so they can only be accessed by authenticated and authorized users.  \n Change default passwords [ CPG 2A ] and ensure they meet the policy requirements for \ncomplexity.  \n Implement and enforce an organizational system -enforced policy that : \no Requires passwords  for all IT password- protected assets to be at least 15 \ncharacters ; \no Does not allow users to reuse passwords for accounts, applications, services , etc.,  \n[CPG 2C ]; and  \no Does not allow service accounts/machine accounts to reuse passwords from \nmember user accounts.  \n Configure Group Policy settings to prevent web browsers from saving passwords and \ndisable autofill functions.  \n Disable the storage of clear text passwords in LSASS memory . \nSecure Accounts  \n Implement phishing -resistant MFA  for access to assets  [CPG 2H ]. \n Separate user and privileged accounts. o User accounts should never have administrator or super -user privileges  [CPG 2E\n]. \no Administrators should never use administrator  accounts for actions and activities not \nassociated with the administrator role (e.g., checking email, web browsing).  \n Enforce the principle  of least privilege. \no Ensure admini strator accounts only have the minimum permissions  necessary to \ncomplete their tasks.  \no Review account permissions for default/accounts for edge appliances/devices  and \nremove domain administrator privileges , if identified. \n\n \n  TLP: CLEAR  \nPage 25 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  o Significantly limit the number of users with elevated privileges . Implement continuous \nmonitoring for changes in group membership, especially in privileged groups, to detect and \nrespond to unauthorized modifications.  \no Remove accounts from high -privilege groups like Enterprise Admins and Schema \nAdmins. Temporarily reinstate these privileges only when necessary and under strict \nauditing to reduce the risk of privilege abuse. \no Transition to Group Managed Service Accounts (gMSAs) where suitable for enhanced \nmanagement and security of service account credentials. gMSAs provide automated password management and simplified Service Principal Name ( SPN) management, \nenhancing security over traditional service accounts. See Microsofts \nGroup Managed \nService Accounts Overview . \n Enforce strict policies via Group Policy and User Rights Assignments to limit high -\nprivilege service ac counts.  \n Consider using a privileged access management (PAM) solution  to manage access to \nprivileged accounts and resources  [CPG 2L]. PAM  solutions can also log and alert usage to \ndetect any unusual activity . \n Complement the PAM solution with role -based access control (RBAC)  for tailored access \nbased on job requirements.  This ensures that elevated access is granted only when required \nand for a limited duration, minimizing the window of opportunity for abuse or exploitation of privileged credentials.  \n Implement an Active Directory t iering model  to segregate administrative accounts  \nbased on their access level and associated risk. This approach reduces the potential impact of a compromised account.  See Microsofts PAM environment tier model\n. \n Harden administrative workstations to only permit administrative activities from \nworkstations appropriately hardened based on the administrative tier. See Microsofts Why are \nprivileged access devices important - Privileged access . \n Disable all user accounts and access to organizational resources of employees on the day of their departure [ CPG 2G\n] \n Regularly audit all user, admin, and service accounts and remove or disable unused or \nunneeded accounts as applicable.  \n Regularly roll NTLM hashes of accounts that support token- based authentication . \n Improve management of hybrid (cloud and on -prem ises) identity federation by:  \no Using cloud  only administrators that are asynchronous with on -premises \nenvironmen ts and ensu ring on-premise s administrators are asynchron ous to the cloud. \no Using CISAs  SCuBAGear tool  to discover cloud misconfigurations in Microsoft \ncloud tenants . SCuBA gear is automation script for comparing Federal Civilian Executive \nBranch (FCEB) agency tenant configurations against CISA M365 baseline recommendations. SCuBAGear is part of CISAs Secure Cloud Business Applications (SCuBA) project, which provides guidance for FCEB agencies , securing their cloud \nbusiness application environments and protecting federal information created, accessed, shared, and stored in those environments. Although tailored to FCEB agencies, the project provides security guidance applicable to all organizations with cloud environments. For \n\n \n  TLP: CLEAR  \nPage 26 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  more information on SCuBAGear  see CISAs Secure Cloud Business Applications \n(SCuBA) Project . \no Using endpoint detection and response capabilities to actively defend on- prem ises \nfederation servers . \nSecure Remote Access Services  \n Limit the use of RDP and other remote desktop services . If RDP is necessary, apply best  \npractices , including auditing the network for systems using RDP, closing unused RDP ports, \nand logging RDP login attempts.  \n Disable Server Message Block (SMB) protocol version 1 and upgrade to version 3 \n(SMBv3) after mitigating existing dependencies (on exis ting systems or applications), as they \nmay break when disabled.  \n Harden SMBv3  by implementing guidance included in joint #StopRansomware Guide  (see \npage 8 of the guide). \n Apply mitigations from the joint Guide to Securing Remote Access Software . \nSecure Sensitive Data  \n Securely  store sensitive data  (including operational technology documentation, network \ndiagrams , etc.), ensuring that only authenticated and authorized users can access the data . \nImplement Network Segmentation  \n Ensure that sensitive accounts use their administrator credentials only on hardened, \nsecure computers . This practice can reduce lateral movement exposure within networks.  \n Conduct comprehensive trust assessments to identify business -critical trusts and \napply necessary controls to prevent unauthorized cross -forest/domain traversal.  \n Harden federated authentication by enabling Secure Identifier ( SID) Filtering and \nSelective Authentication on AD trust relationships to further restrict unauthorized access \nacross domain boundaries.  \n Implement network segmentation to isolate federation servers from other systems and \nlimit allowed traffic to systems and protocols that require access in accordance with Zero Trust \nprinciples . \nSecure Cloud Assets  \n Harden cloud assets  in accordance  with vendor -provided or industry standard hardening \nguidance.  \no Organizations with Microsoft cloud infrastructure, see CISAs Microsoft 365 Security \nConfiguration Baseline Guides , which provide minimum viable secure configuration \nbaselines for Microsoft Defender for Office 365, Azure Active Directory  (now known as \nMicrosoft Entra ID) , Exchange Online, OneDrive for Business, Power BI, Power Platform, \nSharePoint Online, and Teams. For additional guidance, see the Australian Signals Directorates \nBlueprint for Secure Cloud . \n\n \n  TLP: CLEAR  \nPage 27 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  o Organizations with Google cloud infrastructure, see CISAs  Google Workspace Security \nConfiguration Baseline Guides , which provide minimum viable secure configuration \nbaselines for Groups for Business, GMAIL, Google Calendar, Google Chat, Google \nCommon Controls, Google Classroom, Google Drive and Docs, Google Meet, and Google Sites.  \n Revoke unnecessary public access to cloud environment.  This involves reviewing and \nrestricting public endpoints and ensuring that services like storage accounts, databases, and virtual machines are not publicly accessible unless absolutely necessary. Disable legacy authentication protocols across all cloud services and platforms. Legacy protocols frequently \nlack support for advanced security mechanisms such as multifactor authentication, rendering \nthem susceptible to compromises. Instead, enforce the use of modern authentication protocols that support stronger security features like MFA, token- based authentication, and adaptive \nauthentication measures.  \no Enforce this practice through the use of Conditional Access Policies . These policies \ncan initially be run in report-only  mode to i dentify potential impacts and plan mitigations \nbefore fully enforcing them. This approach allows organizations to systematically control access to their cloud resources, significantly reducing the risk of unauthorized access and potential compromise.  \n Regul arly monitor and audit privileged cloud- based accounts , including  service accounts, \nwhich are frequently abused to enable broad cloud resource access and persistence . \nBe Prepared  \n Ensure logging is turned on for application, access, and security logs (e.g., intrusion \ndetection systems/intrusion prevention systems, firewall, data loss prevention, and VPNs ) \n[CPG 2T ]. Given Volt Typhoons  use of LOTL  techniques  and their significant dwell time, \napplication event logs may be a valuable resource to  hunt for Volt Typhoon activity because \nthese logs typically remain on endpoints for relatively long periods of time . \no For OT assets where logs are non- standard or not available, collect network traffic and \ncommunications between those assets and other assets . \no Implement file integrity monitoring (FIM) tools to detect unauthorized changes.  \n Store logs in a central system , such as a security information and event management \n(SIEM)  tool or central database. \no Ensure the logs can only be accessed or modified by authorized and authenticated \nusers [CPG 2U ]. \no Store logs for a period informed by risk or pertinent regulatory guidelines. \no Tune log alerting to reduce noise  while ensuring there are alerts for high-risk \nactivities. (For information on alert tuning, see joint guide Identifying and Mitigating Living \nOff the Land Techniques .) \n Establish and continuously maintain a baseline of installed tools and software, account \nbehavior, and network traffic . This way, network defenders can identify potential outliers, \nwhich may indicate malicious activity.  Note:  For information on establishing a baseline, see \njoint guide  Identifying and Mitigating Living off the Land Techniques . \n\n \n  TLP: CLEAR  \nPage 28 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR   Document a list of threats and cyber actor TTPs relevant to your  organization (e.g., \nbased on industry  or sectors), and maintain the ability (such as via rules, alerting, or \ncommercial prevention and detection systems) to detect instances of those key threats  [CPG \n3A]. \n Implement periodic training for all employees and contractors that cover s basic \nsecurity concepts  (such as phishing, business email compromise, basic operational security, \npassword security, etc. ), as well as foster ing an internal culture of security and cyber \nawareness  [CPG 2I ]. \no Tailor the training to network IT  personnel /admin istrators  and other key staff  based \non relevant organizational  cyber threats  and TTPs, such as Volt Typhoon. For \nexample, communicate that Volt Typhoon actors are known to target personal email \naccounts of IT staff, and encourage staff to protect their personal email accounts by using \nstrong passwords and implementing MFA.  \no In addition to basic cybersecurity training, ensure personnel who maintain or secure OT as part of their regular duties receive OT -specific cybersecurity training on at least \nan annual basis  [CPG 2J\n]. \no Educate users about the risks associated with storing unprotected passwords . \nOT Administrators and Defenders  \n Change default passwords [ CPG 2A ] and ensure they meet the policy requirement s for \ncomplexity. If the assets password cannot be changed, implement compensating controls for  \nthe device ; for example, segment  the device  into separate enclaves  and implement increased \nmonitoring and logging. \n Require that passwords for all OT password-p rotected assets be at least 15 characters, \nwhen technically feasible. In instances where minimum passwords lengths are not technically feasible (for example, assets in remote locations), apply compensating controls, record the \ncontrols, and log all login attempts. [ CPG 2B\n]. \n Enforce strict access policies for accessing OT networks . Develop strict operating \nprocedures for OT operators that details secure configuration and usage.  \n Segment OT assets from IT environments by [CPG 2F ]: \no Denying all connections to the OT network by default unless explicitly allowed (e.g., by \nIP address and port) for specific system functionality.  \no Requiring necessary communications paths between IT and OT networks to pass \nthrough an intermediary, such as a properly configured firewall, bastion host, jump box, \nor a demilitarized zone (DMZ) , which is closely monitored, captures network logs, and only \nallows connections from approved assets.  \n Closely monitor all connections into OT networks for misuse, anomalous activity, or OT \nprotocols . \n Monitor for unauthorized controller change attempts . Implement integrity checks of \ncontroller process logic against a known good baseline. Ensure process controllers are prevented from remaining in remote program mode while in operation if possible.  \n\n \n  TLP: CLEAR  \nPage 29 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR   Lock or limit set points in control processes to reduce the consequences of \nunauthorized controller access. \n Be prepared by : \no Determining  your critical operational processes reliance on key IT infrastructure : \n Maintain and regularly update an inventory of all organizational OT assets . \n Understand and evaluate cyber risk on as -operated  OT assets.  \n Create an accurate as -operated OT network map and identify OT and IT network \ninter-dependencies.  \no Identifying a resilience plan that addresses how to operate if you lose access to or control \nof the IT and/or OT environment . \n Plan for how to continue operations if a control system is malfunctioning, inoperative, \nor actively  acting contrary to the safe and reliable operation of the process.  \n Develop workarounds or manual controls to ensure ICS networks can be isolated if the \nconnection to a compromised IT environment creates risk to the safe and reliabl e \noperation of OT processes.  \no Create and regularly exercise an  incident response plan . \n Regularly test  manual controls so that critical functions can be kept running if OT \nnetworks need to be taken offline.  \no Implement regular data backup procedures on OT networks.  \n Regularly test backup procedures.  \n Follow risk -informed guidance in the joint advisory NSA and CISA Recommend Immediate \nActions to Reduce Exposure Across all Operational Technologies and Control Systems , the \nNSA advisory Stop Malicious Cyber Activity Against Connected Operational Technology . \nCONTACT INFORMA TION \nUS organizations:  To report suspicious or criminal activity related to information found in this joint \nCybersecurity Advisory, contact : \n CISAs 24/7 Operations Center at Report@cisa.gov  or (888) 282 -0870 or your local FBI field \noffice . W hen available, please include the following information regarding the incident: date, \ntime, and location of the incident; type of activity; number of people affected; type of \nequipment used for the activity; the name of the submitting company or organization; and a \ndesignated point of contact.  \n For NSA client requirements or general cybersecurity inquiries, c ontact \nCybersecurity_Requests@nsa.gov .  \n Water and Wastewater Systems Sector organizations, c ontact the EPA Water Infrastructure \nand Cyber Resilience Division at  watercyberta@epa.gov  to voluntarily provide situational \nawareness . \n Entities required to report incidents to DOE should follow established reporting requirements, as appropriate. For other energy sector inquiries, contact EnergySRMA@hq.doe.gov\n. \n For transportation entities regulated by TSA, report to CISA Central in accordance with the \nrequirements found in applicable Security Directives, Security Programs, or TSA Order.  \n\n \n  TLP: CLEAR  \nPage 30 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  Australian organizations:  Visit cyber.gov.au  or call 1300 292 371 (1300 CYBER 1) to report \ncybersecurity incidents and access alerts and advisories. \nCanadian organizations:  Report incidents by emailing CCCS at contact@cyber.gc.ca . \nNew Zealand organizations:  Report cyber security incidents to incidents@ncsc.govt.nz  or call 04 \n498 7654.  \nUnited Kingdom organizations : Report a significant cyber security incident: ncsc.gov.uk/report -an-\nincident  ( monitored 24 hours) or, for urgent assistance, call 03000 200 973. \nVALIDATE SECURITY CONTROLS  \nIn addition to applying mitigations, the authoring agencies recommend exercising, testing, and \nvalidating your organization's  security program against the threat behaviors mapped to the MITRE \nATT&CK for Enterprise framework in this advisory. The authoring agencies recommend testing your existing security controls inventory to assess how they perform against the ATT&CK techniques  \ndescribed in this advisory.  \nTo get started:  \n1. Select an ATT&CK technique described in this advisory (see \nTable 5  through Table 17 ). \n2. Align your security technologies against the technique.  \n3. Test your technologies against the technique.  \n4. Analyze your detection and prevention technologies  performance.  \n5. Repeat the process for all security technologies to obtain a set of comprehensive performance data.  \n6. Tune your security program, including people, processes, and technologies, based on the \ndata generated by this process.  \nThe authoring agencies recommend continually testing your security program, at scale, in a \nproduction environment to ensure optimal performance against the MITRE ATT&CK techniques \nidentified in this advisory.  \nREFERENCES  \n[1] fofa \n[2] Microsoft: Volt Typhoon targets US critical infrastructure w ith living -off-the-land techniques  \n[3] GitHub - fatedier/frp: A fast reverse proxy to help you expose a local server behind a NAT or \nfirewall to the internet  \n[4] GitHub - sandialabs/gait: Zeek Extension to Collect Metadata for Profiling of Endpoints and \nProxies  \n[5] The Zeek Network Security Monitor  \nRESOURCES  \nMicrosoft: Volt Typhoon targets US critical infrastructure with living -off-the-land techniques  \n\n \n  TLP: CLEAR  \nPage 31 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  Secureworks: Chinese Cyberespionage Group BRONZE SILHOUETTE Targets U.S. Government \nand Defense Organizations  \nDISCLAIMER  \nThe information in this report is being provided as is for informational purposes only. The authoring \nagencies  do not endorse any commercial entity, product, company, or service, including any entities, \nproducts, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not \nconstitute or imply endorsement, recommendation, or favoring by the authoring agenci es. \nACKNOWLEDGEMENTS \nFortinet and Microsoft contributed to this advisory.  \nVERSION HISTORY  \nFebruary 7, 2024:  Initial Version.  \nMarch 7, 2024:  Updated Mitigations section to add recommendation on end of life technology.  \n  \n\n \n  TLP: CLEAR  \nPage 32 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  APPENDIX  A: VOLT TYPHOON OBSERVED COMMAND S / LOTL ACTIVITY  \nSee Table 2 and Table 3  for Volt Typhoon commands and PowerShell scripts observed by the U.S. \nauthoring agencies during incident response activities.  For additional commands used by Volt \nTyphoon, see joint advisory People's Republic of China State- Sponsored Cyber Actor Living off the \nLand to Evade Detection . \nTable 2: Volt Typhoon Observed Com mands  in PowerShell Console History  \nCommand/Script  Description/Use  \nGet-EventLog security - instanceid 4624 - after \n{redacted date}  | fl * | Out- File \n'C:\\users \\public \\documents \\user.dat'   PowerShell command extracts security log \nentries with the Event ID 4624  after a specified \ndate. The output is formatted ( fl *) and saved \nto user.dat . Potentially used to analyze logon \npatterns and identify potential targets for lateral \nmovement.  \nGet-EventLog security - instanceid 4624 | Where -\nObject {$_.message.contains('{redacted user \naccount}')} | select - First 1 | fl *   PowerShell command extracts security log \nentries with the Event ID 4624  and filters them \nto include only those containing a specific user \naccount, selecting the first instance of such an \nevent.  \nwminc  process get name,processid  Appears to be an attempt  to use the wmic \ncommand but with a misspelling ( wminc  instead \nof wmic ). This command, as it stands, would \nnot execute successfully and would return an error in a typical Windows environment. This could i ndicate a mistake made during manual \ninput.  \nwmic process get name,processid   WMI command lists all running processes with process names and process IDs. Potentially used to find process IDs needed for other operations, like memory dumping. \ntasklist /v   Command displays detailed information about currently running processes, including the name, PID, session number, and memory \nusage.  \n\n \n  TLP: CLEAR  \nPage 33 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  Command/Script  Description/Use  \ntaskkill /f /im rdpservice.exe  Command forcibly terminates the process \nrdpservice.exe. Potentially used as a \ncleanup activity post -exploitation.  \nping -n 1 {redacted IP address}  Command sends one ICMP echo request to a \nspecified IP address.  \nping -n 1 -w 1 {redacted IP address}  Command sends one ICMP echo request to a \nspecified IP address with a timeout ( -w) of 1 \nmillisecond.  \nnet user  Lists all user accounts on the local machine or \ndomain, useful for quickly viewing existing user \naccounts.  \nquser  \n \nquery user  Displays information about user sessions on a \nsystem, aiding in identifying active users or \nsessions. \nnet start  Lists all active services.  \ncmd Opens a new instance of the command prompt . \ncd [Redacted Path]  Changes the current directory to a specified \npath, typically for navigating file systems.  \nRemove- Item .\\ Thumbs.db PowerShell command to delete the Thumbs.db  \nfile, possibly for cleanup or removing traces. \nmove . \\Thumbs.db ttt.dat  Relocates and renames the file Thumbs.db in \nthe current directory to ttt.dat  within the \nsame directory . \ndel .\\Thumbs.db /f /s /q  Force deletes Thumbs.db  files from the current \ndirectory and all subdirectories, part of cleanup operations to erase traces.  \ndel ??  Deletes files with two -character names, \npotentially a targeted cleanup command.  \n\n \n  TLP: CLEAR  \nPage 34 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  Command/Script  Description/Use  \ndel /?  Displays help information for the del \ncommand.  \nexit Terminates the command prompt session.  \nipconfig  Retrieves network configuration details, helpful \nfor discovery and mapping the victim's network.  \nnet time /dom  Queries or sets the network time for a dom ain, \npotentially used for reconnaissance or to manipulate system time.  \nnetstta -ano Intended as netstat -ano; a mistyped \ncommand indicating a potential operational error.  \nnetstat -ano Lists active network connections and processes, helpful for identifying communication channels and potential targets.  \ntype . \\Notes.txt  Displays the contents of Notes.txt, possibly \nused for extracting specific information or intelligence gathering. \nlogoff  Logs off the current user session. \nTable 3: Volt Typhoon Observed PowerShell Scripts  \nScript name and \nlocation  Contents  Description/Use  \nC:\\{redacted} \\ \nlogins.ps1 # Find DC list from Active Directory  \n$DCs = Get -ADDomainController -Filter *  \n  \n# Define time for report (default is 1 day)  \n$startDate = (get -date).AddDays( -1) \n  The script is designed for \nuser logon discovery in a \nWindows Active Directory \nenvironment. It retrieves a list of DCs and then queries security logs on \nthese DCs for successful \nlogon events (Event ID \n4624) within the last day. \nThe script differentiates \n\n \n  TLP: CLEAR  \nPage 35 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  Script name and \nlocation  Contents  Description/Use  \n# Store successful logon events from \nsecurity logs with the specified dates and \nworkstation/IP in an array  \nforeach ($DC in $DCs){  \n$slogonevents = Get -Eventlog -LogName \nSecurity -ComputerName $DC.Hostname -\nafter $startDate | where {$_.eventID -eq \n4624 }}  \n  \n# Crawl through events; print all logon \nhistory with type, date/time, status, account \nname, computer and IP address if user \nlogged on remotely  \n  \n foreach ($e in $slogonevents){  \n # Logon Successful Events  \n # Local (Logon Type 2)  \n if (($e.EventID - eq 4624 ) - and \n($e.ReplacementStrings[8] -eq 2)){  \n write -host \"Type: Local Logon`tDate: \n\"$e.TimeGenerated \"`tStatus: \nSuccess`tUser: \"$e.ReplacementStrings[5] \"`tWorkstation: \"$e.ReplacementStrings[11] \n } \n # Remote (Logon Type 10)  \n if (($e.EventID - eq 4624 ) - and \n($e.ReplacementStrings[8] -eq 10)){  \n write -host \"Type: Remote Logon`tDate: \n\"$e.TimeGenerated \"`tStatus: \nSuccess`tUser: \"$e.Replacement Strings[5] \n\"`tWorkstation: \"$e.ReplacementStrings[11] \"`tIP Address: \"$e.ReplacementStrings[18] \n }} between local (Logon Type \n2) and remote (Logon \nType 10) logon events. For each event, it extracts and displays details including the logon type, date/time of \nlogon, status, account \nname, and the workstation \nor IP address used for the logon. Volt Typhoon may \nbe leveraging this script to monitor user logon activities across the network, potentially to identify patterns, gather \ncredentials, or track the \nmovement of  users and \nadministrators within the network.  \n  \n\n \n  TLP: CLEAR  \nPage 36 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  APPENDIX B: INDICATORS OF COMPROMISE  \nSee Table 4 for Volt Typhoon IOCs obtained by the U.S. authoring agencies during incident response \nactivities. \nTable 4: Volt Typhoon Malicious Files and Associated Hashes  \nNote: See MAR -10448362- 1.v1 for more information on this malware.  \nFile Name  Description  MD5  Hashes (SHA256)  \nBrightmetricAgent.exe  The file is an FRP that \ncould be used to \nreveal servers situated \nbehind a network firewall or obscured through Network Address Translation \n(NAT).  \n fd41134e8ead1c18cca\nd27c62a260aa6 edc0c63065e88ec96197c8d7a40662a15a81\n2a9583dc6c82b18ecd\n7e43b13b70 \nSMSvcService.exe The file is a Windows \nexecutable \"FRPC  \ndesigned to open a reverse proxy between the compromised system \nand the threat actor(s) \nC2 server.  b1de37bf229890ac181bdef1ad8ee0c2  99b80c5ac352081a64129772ed5e1543d94c\nad708ba2adc46dc4ab\n7a0bd563f1  \n \n  \n\n \n  TLP: CLEAR  \nPage 37 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  APPENDIX C: MITRE ATT&CK TACTICS AND TECHNIQUES  \nSee Table 5 through Table 17  for all referenced threat actor tactics and techniques in this advisory. \nTable 5: Volt Typhoon actors ATT&CK Techniques for Enterprise  Reconnaissance  \nReconnaissance  \nTechnique Title  ID Use \nGather Victim Host \nInformation  T1592  Volt Typhoon conducts extensive pre -compromise \nreconnaissance. This includes web searches, including victim -\nowned sites, for victim host, identity, and network information, \nespecially for information on key network and I T \nadministrators.  \nGather Victim \nIdentity Information T1589  Volt Typhoon conducts extensive pre -compromise \nreconnaissance to learn about the target organizations  staff. \nGather Victim \nIdentity Information: Email Addresses  T1589.002  Volt Typhoon targets  the personal emails of key network and \nIT staff . \nGather Victim \nNetwork Information  T1590  Volt Typhoon conducts extensive pre -compromise \nreconnaissance to learn about the target organizations  \nnetwork . \nGather Victim Org \nInformation  T1591  Volt Typhoon conducts extensive pre -compromise \nreconnaissance to learn about the target organization. \nSearch Open \nWebsites/Domains  T1593  Volt Typhoon conducts extensive pre -compromise \nreconnaissance. This includes web searches, including victim -\nowned sites, for victim host, identity, and network information, especially for information on key network and IT administrators.  \nSearch Victim -\nOwned Websites  T1594  Volt Typhoon conducts extensive pre -compromise \nreconnaissance. This includes web searches, including victim -\nowned sites, for victim host, identity, and network information, \nespecially for information on key network and I T \nadministrators.  \n\n \n  TLP: CLEAR  \nPage 38 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  Table 6: Volt Typhoon actors ATT&CK Techniques for Enterprise  Resource Development  \nResource Development  \nTechnique Title  ID Use \nAcquire \nInfrastructure: \nBotnet  T1583.003  Volt Typhoon uses multi -hop proxies for command -and-control \ninfrastructure . The proxy is typically composed of Virtual \nPrivate Servers (VPSs) or small office/home office (SOHO) \nrouters.  \nCompromise \nInfrastructure: Botnet  T1584.005  Volt Typhoon used Cisco and NETGEAR end -of-life SOHO \nrouters implanted with KV Botnet malware to support their operations . \nCompromise \nInfrastructure: Server  T1584.004  Volt Typhoon has redirected specific port traffic to their proxy \ninfrastructure, effectively converting the PRTGs Detection Guidance server into a proxy for their C2 traffic . \nDevelop \nCapabilities:  Exploits  T1587.004  Volt Typhoon uses publicly available exploit code , but is also  \nadept at discovering and exploiting vulnerabilities as zero days . \nObtain Capabilities: \nExploits  T1588.005  Volt Typhoon uses publicly available e xploit code , but is also  \nadept at discovering and exploiting vulnerabilities as zero days .  \nTable 7: Volt Typhoon actors ATT&CK Techniques for Enterprise  Initial Access  \nInitial Access   \nTechnique Title  ID Use \nExploit Public -\nFacing Application T1190  Volt Typhoon commonly exploits vulnerabilities in networking \nappliances such as Fortinet, Ivanti (formerly  Pulse Secure), \nNETGEAR, Citrix,  and Cisco . \nExternal Remote \nServices  T1133  Volt Typhoon often use s VPN sessions to securely connect to \nvictim environments, enabling discreet follow -on intrusion \nactivities.  \n\n \n  TLP: CLEAR  \nPage 39 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  Table 8: Volt Typhoon actors ATT&CK Techniques for Enterprise  Execution  \nExecution  \nTechnique Title  ID Use \nCommand and \nScripting Interpreter  T1059  Volt Typhoon uses hands -on-keyboard execution for their \nmalicious activity via the command -line. \nCommand and \nScripting Interpreter: \nPowerShell  T1059.001  Volt Typhoon has executed  clients  via PowerShell . \nCommand and \nScripting Interpreter: \nUnix Shell  T1059.004  Volt Typhoon has used Brightmetricagent.exe , which  \ncontains multiplexer libraries that can bi -directionally stream \ndata over through NAT networks and contains a command -\nline interface (CLI) library that can leverage command shells such as PowerShell, Windows Management, Instrumentation \n(WMI), and Z Shell (zsh).  \nWindows \nManagement \nInstrumentation  T1047  Volt Typhoon has used  Windows Management \nInstrumentation Console (WMIC) commands . \nTable 9: Volt Typhoon actors ATT&CK Techniques for Enterprise  Persistence  \nPersistence  \nTechnique Title  ID Use \nValid Accounts  T1078  Volt Typhoon primarily relies on valid credentials for \npersistence.  \nTable 10: Volt Typhoon actors ATT&CK Techniques for Enterprise  Privilege Escalation \nPrivilege Escalation  \nTechnique Title ID Use \nExploitation for \nPrivilege Escalation T1068  Volt Typhoon first obtains credentials from public -facing \nappliances after gaining initial access by exploiting privilege \n\n \n  TLP: CLEAR  \nPage 40 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  escalation vulnerabilities in the operating system or network \nservices. \nTable 11: Volt Typhoon actors ATT&CK Techniques for Enterprise  Defense Evasion  \nDefense Evasion  \nTechnique Title  ID Use \nDirect Volume \nAccess T1006  Volt Typhoon has execut ed the Windows -native vssadmin  \ncommand to create a volume shadow copy . \nIndicator Removal: \nClear Persistence  T1070.009  Volt Typhoon has selectively cleared Windows Event Logs, \nsystem logs, and other technical artifacts to remove evidence \nof their intrusion activity and masquerading file names. \nIndicator Removal: \nClear Windows Event Logs  T1070.001  Volt Typhoon has selectively clear ed Windows Event Log s, \nsystem logs, and other technical artifacts to remove evidence of their intrusion activity and masquerading file names.  \nIndicator Removal: \nFile Deletion  T1070.004  Volt Typhoon created systeminfo.dat  in \nC:\\Users\\Public\\Documents, but subsequently deleted it.  \nMasquerading: \nMatch Legitimate Name or Location T1036.005  Volt Typhoon has selectively cleared Windows Event Logs, \nsystem logs, and other technical artifacts to remove evidence of their intrusion activity and masquerading file names. \nModify Registry  T1112  Volt Typhoon has  used the netsh  command, a legitimate \nWindows command, to create a PortProxy registry \nmodification on the PRTG server . \nObfuscated Files or \nInformation: \nSoftware Packing  T1027.002  Volt Typhoon has obfuscated FRP client files \n(BrightmetricAgent.exe  and SMSvcService.exe) and the \ncommand -line port scanning utility ScanLine by packing the \nfiles with Ultimate Packer for Executables (UPX) . \nSystem Binary \nProxy Execution  T1218  Volt Typhoon use s hands -on-keyboard activity via  the \ncommand -line and use other native tools and processes on \nsystems (often referred to as LOLBins), known as LOTL, to \nmaintain and expand access to the victim networks.  \n\n \n  TLP: CLEAR  \nPage 41 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  Table 12: Volt Typhoon actors ATT&CK Techniques for Enterp rise  Credential Access  \nCredential Access  \nTechnique Title  ID Use \nBrute Force: \nPassword Cracking T1110.002  Volt Typhoon has exfiltrated NTDS.dit  and SYSTEM  registry \nhive to crack passwords offline.  \nCredentials from \nPassword Stores  T1555  Volt Typhoon has i nstalled browsers saved passwords  history, \ncredit card details , and cookies .  \nCredentials from \nPassword Stores: \nCredentials from \nWeb Browsers  T1555.003  Volt Typhoon has strategically target ed network administrator \nweb browser data, focusing on both browsing history and \nstored credentials . \nOS Credential \nDumping: LSASS \nMemory  T1003.001  Volt Typhoon used a  DLL with MiniDump  and the process ID \nof Local Security Authority Subsystem Service (LSASS) to dump the LSASS process memory and obtain credentials . \nOS Credential \nDumping: NTDS  T1003.003  Volt Typhoon appears to prioritize obtaining valid credentials \nby extracting the Active Directory database file ( NTDS.dit ). \nUnsecured \nCredentials  T1552  Volt Typhoon has obtained credentials insecurely stored on an \nappliance. \nUnsecured \nCredentials: Private Keys  T1552.004  Volt Typhoon has accessed a  Local State  file that contains the \nAdvanced Encryption Standard (AES) encryption key used to encrypt the passwords stored in the Chrome browser, which \nenables the actors to obtain plaintext passwords stored in the \nLogin Data file in the Chrome browser.  \nTable 13: Volt Typhoon actors ATT&CK Techniques for Enterprise  Discovery  \nDiscovery  \nTechnique Title  ID Use \nAccount Discovery: \nLocal Account  T1087.001  Volt Typhoon executed  net user  and quser  for user account \ninformation. \n\n \n  TLP: CLEAR  \nPage 42 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  Application Window \nDiscovery T1010  Volt Typhoon created  and access ed a file named \nrult3uil.log  on a Domain Controller in \nC:\\Windows\\System32 \\. The rult3uil.log  file contained \nuser activities on a compromised system, showcasing a \ncombination of window title information and focus shifts, keypresses, and command executions across Google Chrome and Windows PowerShell, with corresponding timestamps.  \nBrowser Information \nDiscovery T1217  Volt Typhoon has installed browsers saved passwords history, \ncredit card details, and cookies.  \nFile and Directory \nDiscovery T1083  Volt Typhoon enumerate d several directories , including \ndirectories containing vulnerability testing and cyber related content and facilities data, such as construction drawings.  \nLog Enumeration  T1654  Volt Typhoon has captured  successful logon events.  \nNetwork Service \nDiscovery T1046  Volt Typhoon has used commercial tools, LOTL utilities, and \nappliances already present on the system for system information, network service, group, and user discovery. \nPeripheral Device \nDiscovery T1120  Volt Typhoon has obtained the victim's  system screen \ndimension and display devices information. \nPermission Groups \nDiscovery T1069  Volt Typhoon has used commercial tools, LOTL utilities, and \nappliances already present on the system for system \ninformation, network service, group, and user discovery. \nProcess Discovery  T1057  Volt Typhoon executed  tasklist /v  to gather a detailed \nprocess listing. \nQuery Registry  T1012  Volt Typhoon has interacted  with a PuTTY application by \nenumerating existing stored sessions.  \nSoftware Discovery  T1518  Volt Typhoon has obtained the victim's  list of applications \ninstalled on the victim's system.  \nSystem Information \nDiscovery T1082  Volt Typhoon has used  commercial tools, LOTL utilities, and \nappliances already present on the system for system \ninformation, network service, group, and user discovery. \n\n \n  TLP: CLEAR  \nPage 43 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  System Location \nDiscovery T1614  Volt Typhoon has obtained the victim's system current locale . \nSystem Network \nConfiguration \nDiscovery: Internet Connection Discovery T1016.001  Volt Typhoon e mploy s ping  with various IP addresses to \ncheck network connectivity  and net start to list running \nservices. \nSystem Owner/User \nDiscovery T1033  Volt Typhoon has used commercial tools, LOTL utilities, and \nappliances already present on the system for system \ninformation, network service, group, and user discovery.  \nSystem Service \nDiscovery T1007  Volt Typhoon e mploy s ping  with various IP addresses to \ncheck network connectivity  and net start to list running \nservices. \nSystem Time \nDiscovery T1124  Volt Typhoon has obtained the victim's system timezone . \nTable 14: Volt Typhoon actors ATT&CK Techniques for Enterprise  Lateral Movement  \nLateral Movement  \nTechnique Title  ID Use \nRemote Service \nSession Hijacking T1563  Volt Typhoon potentially had access to a range of critical \nPuTTY profiles, including those for water treatment plants, \nwater wells, an electrical substation, operational technology systems, and network security devices. This would enable \nthem to access these critical systems.  \nRemote Services: \nCloud Services  T1021.007  During the period of Volt Typhoons known network presence, \nthere were anomalous login attempts to an Azure tenant \npotentially using credentials previously compromised from \ntheft of NTDS.dit . \nRemote Services: \nRemote Des ktop \nProtocol  T1021.001  Volt Typhoon has moved laterally to the Domain Controller via \nan interactive RDP session using a compromised account with \ndomain administrator privileges . \n\n \n  TLP: CLEAR  \nPage 44 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  Use Alternate \nAuthentication \nMaterial  T1550  Volt Typhoon may be capable of using other methods such as \nPass the Hash or Pass the Ticket for lateral movement.  \nValid Accounts: \nCloud Accounts  T1078.004  During the period of Volt Typhoons known network presence, \nthere were anomalous login attempts to an Azure tenant potentially using credentials previously compromised from \ntheft of NTDS.dit . \nTable 15: Volt Typhoon actors ATT&CK Techniques for Enterprise  Collection  \nCollection  \nTechnique Title  ID Use \nArchive Collected \nData  T1560  Volt Typhoon  collected sensitive information obtained from a \nfile server in multiple zipped files . \nArchive Collected \nData: Archive via Utility  T1560.001  Volt Typhoon has compressed and archived the extracted \nntds.dit  and accompanying registry files (by executing \nronf.exe , which was likely a renamed version of rar.exe ). \nData Staged  T1074  Volt Typhoon accessed the file \nC:\\Users\\{redacted} \\Downloads\\ History.zip , which  \npresumably contained data from the User Data directory of the users Chrome browser, which the actors likely saved in the Downloads director y for exfiltration.  \nScreen Capture  T1113  Volt Typhoon has obtained a  screenshot of the victim's system \nusing two libraries ( gdi32.dll and gdiplus.dll) \nTable 16: Volt Typhoon actors ATT&CK Techniques for Enterprise  Command and Control  \nCommand and Control  \nTechnique Title  ID Use \nEncrypted Channel  T1573  Volt Typhoon has setup FRP clients on a victims corporate \ninfrastructure to establish covert communications channels for command and control.  \n\n \n  TLP: CLEAR  \nPage 45 of 45  |  Product ID : AA24 -038A  \nTLP: CLEAR  Ingress Tool \nTransfer  T1105  Volt Typhoon uses legitimate, but outdated versions of \nnetwork admin tools. For example, in one confirmed \ncompromise, actors downloaded an outdated version of \ncomsvcs.dll , on the DC in a non -standard folder.  \nProxy  T1090  Volt Typhoon has setup FRP clients on a victims corporate \ninfrastructure to establish covert communications channels for command and control.  \nProxy: Internal \nProxy  T1090.001  Volt Typhoon has used the netsh  command, a legitimate \nWindows command, to create a PortProxy registry modification on the PRTG server . \nProxy: Multi -hop \nProxy  T1090.003  Volt Typhoon uses multi -hop proxies for command -and-control \ninfrastructure.  \nTable 17: Volt Typhoon actors ATT&CK Techniques for Enterprise  Exfiltration  \nExfiltration  \nTechnique Title  ID Use \nExfiltration Over \nAlternative Protocol   T1048  Volt Typhoon exfiltrated files via Server Message Block \n(SMB) . \n \n\n",
  "cves": [],
  "techniques": [
    "T1059.004",
    "T1036.005",
    "T1090.001",
    "T1027.002",
    "T1078.004",
    "T1090.003",
    "T1003.001",
    "T1587.004",
    "T1555.003",
    "T1552.004",
    "T1589.002",
    "T1583.003",
    "T1021.007",
    "T1560.001",
    "T1059.001",
    "T1070.004",
    "T1584.005",
    "T1070.001",
    "T1003.003",
    "T1087.001",
    "T1021.001",
    "T1016.001",
    "T1584.004",
    "T1110.002",
    "T1588.005",
    "T1070.009"
  ],
  "advisory": "cybersecurity-alerts",
  "title": "csa-prc-compromise-us-critical-infrastructure",
  "source": "nsa",
  "id": "93ac01a91959f20d6f909a445690b761ee3eedc45b1a62fafbf7dbbbf5df1350"
}