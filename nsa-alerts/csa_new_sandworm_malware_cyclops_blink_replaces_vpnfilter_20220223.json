{
  "markdown": "\n\n \n \n \n \n  \nNew Sandworm malware Cyclops Blink \nreplaces VPNFilter  \nThe Sandworm actor, which the UK and US have previo usly attributed to \nthe Russian GRU, has replaced the exposed VPNFilter  malware with a new \nmore advanced framework. \n\u0003 \nBackground  \nThe UK National Cyber Security Centre (NCSC), the Cybersecurity and Infrastructure \nSecurity Agency (CISA), the National Security Agency (NSA) and the Federal B ureau \nof Investigation (FBI) in the US have identified that the actor known as S andworm or \nVoodoo Bear is using a new malware, referred to here as Cyclops Blink. Th e NCSC, \nCISA, NSA and FBI have SUHYLRXVO\\\u0003DWWULEXWHG\u0003WKH\u00036DQGZRUP\u0003DFWRU\u0003WR\u00035XVVLDQ\u0003*58V\u0003\nMain Centre for Special Technologies GTsST. The malicious cyber activity below has \npreviously been attributed to Sandworm: \n \nx The BlackEnergy disruption of Ukrainian electricity in 2015 \nx Industroyer in 2016 \nx NotPetya in 2017 \nx Attacks against the Winter Olympics and Paralympics in 20181 \nx A series of disruptive attacks against Georgia in 20192 \n \nCyclops Blink appears to be a replacement framework for the VPNFilter malware  \nexposed in 2018, which exploited network devices, primarily small office/home office  \n(SOHO) routers and network attached storage (NAS) devices. \n \n1https://www.ncsc.gov.uk/news/uk-and-partners-condemn -gru-cyber-attacks-against-olympic-an-paralympic-games \n2 https://www.gov.uk/government/news/uk-condemns-russias- gru-over-georgia-cyber-attacks  \n\nThis advisory summarises the VPNFilter malware it replaces, and provides more de tail \non Cyclops Blink, as well as the associated tactics, techniques and procedures (TTPs) \nused by Sandworm. An NCSC malware analysis report on Cyclops Blink is also  \navailable and can be read in parallel.  \nIt also provides mitigation measures to help organisations that may be  affected by this \nmalware. \n \nVPNFilter  \nThe malware was first exposed in 2018 \nA series of articles published by Cisco Talos in 20181 describes VPNFilter and its \nmodules in detail. VPNFilter was deployed in stages, with most functionality in the \nthird-stage modules. These modules enabled traffic manipulation, destruction of the \ninfected host device, and likely enabled downstream devices to be exploited. They  \nalso allowed monitoring of Modbus SCADA protocol which appears to be an ong oing \nrequirement for Sandworm, as also seen in their previous attacks against ICS \nnetworks. \nVPNFilter targeting was widespread and appeared indiscriminate, with some \nexceptions: Cisco Talos reported an increase of victims in Ukraine in May 201 8. \nSandworm also deployed VPNFilter against targets in the Republic of Korea before \nthe 2018 Winter Olympics.  \nIn May 2018 Cisco Talos published the blog that exposed VPNFilter, and the US \nDepartment of Justice linked the activity2 to Sandworm and announced its disruption \nof the botnet. \nActivity since its exposure  \nA Trendmicro3 blog in January 2021 detailed residual VPNFilter infections and \nprovided data showing a reduction in requests to a known C2 domain. Since the \ndisruption in May 2018, Sandworm has since shown limited interest in existing \nVPNFilter footholds, instead preferring to retool. \n \nCyclops Blink \nActive since 2019 \nThe NCSC, CISA, FBI and NSA, along with industry partners, have now  identified a \nlarge-scale modular malware framework which is affecting network devices. The new \n \n1 https://blog.talosintelligence.com/2018/05/VPNFilter.html \n2 https://www.justice.gov/opa/pr/justice-department-announc es-actions-disrupt-advanced-persistent-threat-28-botne t-infected \n3 https://www.trendmicro.com/en_gb/research/21/a/vpnfi lter-two-years-later-routers-still-compromised-.html  \n\nmalware is referred to here as Cyclops Blink  and has been deployed since at least \nJune 2019, fourteen months after VPNFilter was disrupted. In com mon with VPNFilter, \nCyclops Blink deployment also appears indiscriminate and widespread. \n \nThe actor has so far primarily deployed Cyclops Blink to WatchGuard devices,1 but it \nis likely that Sandworm would be capable of compiling the malware for other \narchitectures and firmware. \n \nMalware overview  \nThe malware itself is sophisticated and modular with basic core functionality to  beacon \n(T1132.002 ) device information back to a server and enable files to be downloaded \nand executed. There is also functionality to add new modules while the malware  is \nrunning, which allows Sandworm to implement additional capability as required. \n \nThe NCSC has published a malware analysis report  on Cyclops Blink which provides \nmore detail about the malware. \n \nPost exploitation  \n3RVW\u0003H[SORLWDWLRQ\u000f\u0003&\\FORSV\u0003%OLQN\u0003LV\u0003JHQHUDOO\\\u0003GHSOR\\HG\u0003DV\u0003SDUW\u0003RI\u0003D\u0003ILUPZDUH\u0003XSGDWH \u0003\n(T1542.001 ). This achieves persistence when the device is rebooted and makes \nremediation harder.  \n \n1 Note that only WatchGuard devices that were reconfigure d from the manufacture default settings to open remote \nmanagement interfaces to external access could be infected . \n\nVictim devices are organised into clusters and each deployment of Cyclops Blink has  \na list of command and control (C2) IP addresses and ports that it uses (T1008). All the \nknown C2 IP addresses to date have been used by compromised WatchGu ard firewall \ndevices. Communications between Cyclops Blink clients and servers are protected \nunder Transport Layer Security (TLS) ( T1071.001 ), using individually generated keys \nand certificates. Sandworm manages Cyclops Blink by connecting to the C 2 layer \nthrough the Tor network. \n \n \n \nMitigation \nCyclops Blink persists on reboot and throughout the legitimate firmware upda te \nprocess. Affected organisations should therefore take steps to remove the malware.  \n \nThe WatchGuard has worked closely with the FBI, CISA and the NCSC, and has  \nprovided tooling and guidance to enable detection and removal of Cyclops Blink on \nWatchGuard devices through a non-standard upgrade process.  Device owners \n\n\nshould follow each step in these instructions to ensure that devices are patched  to the \nlatest version and that any infection is removed. \nWatchGuard tooling and guidance is available at: https://detection .watchguard.com/ \n  \nIn addition: \nx If your device is identified as infected with Cyclops Blink, you should assume \nthat any passwords present on the device have been compromised and \nreplace them (see NCSC password guidance for organisations: \nhttps://www.ncsc.gov.uk/collection/passwords  ) \nx You should ensure that the management interface of network devices is not \nexposed to the internet. \n \nIndicators of compromise \nPlease refer to the accompanying Cyclops Blink malware analysis report  for indicators \nof compromise which may help detect this activity.  \n  \n\nMITRE ATT&CK \nThis advisory has been compiled with respect to the MITRE ATT&CK  framework, a \nglobally accessible knowledge base of adversary tactics and techniques based on \nreal-world observations.  \n \nTactic Technique Procedure \nInitial Access T1133 External Remote Services  \nThe actors most likely deploy modified device firmware \nimages by exploiting an externally available service \nExecution T1059.004 Command and Scripting Interpreter: Unix Shell \nCyclops Blink executes downloaded files using the \nLinux API \nPersistence T1542.001 Pre-OS Boot: System Firmware \nCyclops Blink is deployed within a modified device \nfirmware image \nT1037.004 Boot or Logon Initialisation Scripts: RC Scripts \nCyclops Blink is executed on device startup, using a \nmodified RC script \nDefence Evasion T1562.004 Impair Defenses: Disable or Modify System Firewall \nCyclops Blink modifies the Linux system firewall to \nenable C2 communication \nT1036.005 Masquerading: Match Legitimate Name or Location \nCyclops Blink masquerades as a Linux kernel thread \nprocess \nDiscovery T1082 System Information Discovery \nCyclops Blink regularly queries device information \nCommand and \nControl T1090 Proxy \nT1132.002 Data Encoding: Non-Standard Encoding \nCyclops Blink command messages use a custom \nbinary scheme to encode data \nT1008 Fallback Channels  \nCyclops Blink randomly selects a C2 server from \ncontained lists of IPv4 addresses and port numbers \nT1071.001 Application Layer Protocol: Web Protocols  \nCyclops Blink can download files via HTTP or HTTPS \nT1573.002 Encrypted Channel: Asymmetric Cryptography \nCyclops Blink C2 messages are individually encrypted \nusing AES-256-CBC and sent underneath TLS \nT1571 Non-Standard Port  \nThe list of port numbers used by Cyclops Blink \nincludes non-standard ports not typically associated \nwith HTTP or HTTPS traffic \nExfiltration T1041 Exfiltration Over C2 Channel \nCyclops Blink is able to upload files to a C2 server \n\n \nConclusion  \nA Cyclops Blink infection does not mean that an organisation is the primary target, \nbut it may be selected to be, or its machines could be used to conduct attacks.  \n \nOrganisations are advised to follow the mitigation advice  in this advisory and to refer \nto indicators of compromise (not exhaustive) in the Cyclops Blink malware analysis \nreport to detect possible activity on networks.  \n \nUK organisations affected by the activity outlined in this advisory should report any \ncompromises to the NCSC via our website. \n\n  Further guidance  \nA variety of mitigations will be of use in defending against the campaigns detailed in this \nreport: \nx Do not expose management interfaces of network devices to the internet : the \nmanagement interface is a significant attack surface, so not exposing them \nreduces the risk. See NCSC guidance: \nhttps://www.ncsc.gov.uk/guidance/acquiring-managing-and-disposing-network-\ndevices \nx Protect your devices and networks by keeping them up to date : use the latest \nsupported versions, apply security patches promptly, use anti-virus and scan \nregularly to guard against known malware threats. See NCSC \nguidance: https://www.ncsc.gov.uk/guidance/mitigating-malware  \nx Use multi-factor authentication to reduce the impact of password \ncompromises . See NCSC guidance: https://www.ncsc.gov.uk/guidance/multi-\nfactor-authentication-online-services  and https://www.ncsc.gov.uk/guidance/setting-\ntwo-factor-authentication-2fa   \nx Treat people as your first line of defence . Tell staff how to report suspected \nphishing emails, and ensure they feel confident to do so. Investigate their reports \npromptly and thoroughly. Never punish users for clicking phishing links or opening \nattachments. See NCSC guidance: https://www.ncsc.gov.uk/phishing   \nx Set up a security monitoring capability  so you are collecting the data that will be \nneeded to analyse network intrusions. See NCSC \nGuidance: https://www.ncsc.gov.uk/guidance/introduction-logging-security-\npurposes.  \nx Prevent and detect lateral movement in your RUJDQLVDWLRQV  networks . See \nNCSC guidance: https://www.ncsc.gov.uk/guidance/preventing-lateral-movement  \n \n\n \n \n \n \nDisclaimers \nThis report draws on information derived from NCSC and industry \nsources. Any NCSC findings and recommendations made have not been \nprovided with the intention of avoiding all risks and following the \nrecommendations will not remove all such risk. Ownership of information \nrisks remains with the relevant system owner at all times. \nAll material is UK Crown Copyright  \n \nDISCLAIMER OF ENDORSEMENT The information and opinions \ncontained in this document are provided \"as is\" and without any \nwarranties or guarantees. Reference herein to any specific commercial \nproducts, process, or service by trade name, trademark, manufacturer, \nor otherwise, does not constitute or imply its endorsement, \nrecommendation, or favoring by the United States Government, and this \nguidance shall not be used for advertising or product endorsement \npurposes.  \n  \nFor NSA client requirements or general cybersecurity inquiries, contact \nthe NSA Cybersecurity Requirements Center at 410-854-4200 or \nCybersecurity_Requests@nsa.gov. \n \n About this document \n7KLV\u0003DGYLVRU\\\u0003LV\u0003WKH\u0003UHVXOW\u0003RI\u0003D\u0003FROODERUDWLYH\u0003HIIRUW\u0003E\\\u00038QLWHG\u0003.LQJGRPV\u0003\nNational Cyber Security Centre (NCSC), the United States  \nCybersecurity and Infrastructure Security Agency (CISA), Federal \nBureau of Investigation (FBI) and National Security Agency (NSA) \nThe United States  Cybersecurity and Infrastructure Security Agency \n(CISA),  Federal Bureau of Investigation (FBI) and National Security \nAgency (NSA) agree with this attribution and the details provided in the \nreport. \nThis advisory has been compiled with respect to the MITRE ATT&CK  \nframework, a globally accessible knowledge base of adversary tactics \nand techniques based on real-world observations.  \n \n\n",
  "cves": [],
  "techniques": [
    "T1562.004",
    "T1082",
    "T1573.002",
    "T1008",
    "T1571",
    "T1090",
    "T1059.004",
    "T1041",
    "T1071.001",
    "T1037.004",
    "T1133",
    "T1036.005",
    "T1542.001",
    "T1132.002"
  ],
  "advisory": "cybersecurity-alerts",
  "title": "csa_new_sandworm_malware_cyclops_blink_replaces_vpnfilter_20220223",
  "source": "nsa",
  "id": "29b1604177284aaf477a770562b284d696c7954a63646aeae4e48434c5f55644"
}