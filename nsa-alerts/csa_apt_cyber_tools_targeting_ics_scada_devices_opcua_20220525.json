{
  "markdown": "  \n \n \n  \n  \n   \n \n \nAll organizations should report incidents and anomalous activity to CISA 24/7 Operations Center at \nreport@cisa.gov  or (888) 282 -0870 and/or to the FBI via your local FBI field office  or the FBIs 24/7 CyWatch at \n(855) 292 -3937 or CyWatch@fbi.gov . When available, please include the following information regarding the \nincident: date, time, and location of the incident; type of activity; number of people affected; type of equipment \nused for the activity; the name of the submitting company or organization; and a designated point of contact. For \nNSA client requirements or general cybersecurity inquiries, contact the Cybersecurity Requirements Center at \n410-854-4200 or Cybersecurity_Requests@nsa.gov .  \nThis document is marked TLP:WHITE. Disclosure is not limited. Sources m ay use TLP:WHITE when information \ncarries minimal or no foreseeable risk of misuse, in accordance with applicable rules and procedures for public \nrelease. Subject to standard copyright rules, TLP:WHITE information may be distributed without restriction.  \nFor more information on the Traffic Light Protocol, see http://www.us -cert.gov/tlp/ . \n Product ID: AA2 2103A \nTLP: WHITE    April 1 3, 2022  TLP:WHITE  \n Co-Authored by:  \nAPT Cyber Tools Targeting ICS/SCADA Devices  \nSUMMARY  \nThe Department of Energy (DOE), the Cybersecurity \nand Infrastructure Security Agency (CISA),  the National \nSecurity Agency (NSA) , and the Federal Bureau of \nInvestigation (FBI)  are releasing this joint Cybersecurity \nAdvisory (CSA) to warn that certain advanced \npersistent threat ( APT) actors have  exhibited  the \ncapability to gain full system access t o multiple \nindustrial control system (ICS)/supervisory control  and \ndata acquisition (SCADA) devices , including : \n Schneider Electric programmable logic \ncontrollers (PLCs) , \n OMRON  Sysmac NEX PLCs , and \n Open Platform Communications Unified \nArchitecture (OPC UA)  servers . \nThe APT actors have developed custom -made tool s for \ntarget ing ICS/SCADA de vices. The tools  enable them \nto scan for, compromise, and control affected devices  \nonce they have established initial access to the \noperational technology (OT) network . Additionally, the \nactors can compromise Windows -based engineering \nworkstations , which  may be present in information technology ( IT) or OT environments , using an \nexploit that compromises an ASRock motherboard driver with known vulnerabilities. By compromising Actions to Take Today to Protect \nICS/SCADA Devices : \n Enforce multifactor \nauthentication for all remote \naccess to ICS networks and \ndevices whenever possible.  \n Change all passwords to \nICS/SCADA devices and \nsystems on a consistent \nschedule, especially all default \npasswords, to device -unique \nstrong passwords to mitigate \npassword brute force attacks \nand to give defender monitoring \nsystems opportunities to detect \ncommon attacks.    \n Leverage a properly installed \ncontinuous OT monitoring \nsolution to log and alert on \nmalicious indicators and \nbehaviors.  \n\n \n  DOE |  CISA |  NSA |  FBI TLP:WHITE  \n \nPage 2 of 9  |  Product ID: AA2 2-103A \nTLP: WHITE    and maintaining full system access to ICS/SCADA devices , APT actors  could elevate privileges , \nmove laterally  within an OT environment , and disrupt critical  devices or functions.  \nDOE, CISA, NSA , and the FBI  urge critical infrastructure organizations, especially Energy Sector \norganizations, to implement the detection and mitigation recommendations provided in this CSA to \ndetect potential malicious APT activity and  harden their ICS/SCADA devices.  \nTECHNICAL DETA ILS \nAPT actors have developed  custom -made tool s that, once they have established initial access in an \nOT network,  enables them to scan for, compromise, and control certain ICS/SCADA devi ces, \nincluding the following : \n Schneider Electric MODICON and MODICON N ano PLCs , including (but may not be limited \nto) TM251 , TM241, M258, M238, LMC058,  and LMC078;  \n OMRON  Sysmac NJ and NX PLCs, including (but may not be  limited to ) NEX NX1P2, NX -\nSL3300, NX -ECC203, NJ501 -1300, S8VK , and R88D -1SN10F -ECT; and  \n OPC U nified Architecture ( OPC UA ) servers .   \nThe APT actors tools have a  modular architecture and enable cyber actors  to conduct highly \nautomated exploits against targeted devices. The tools have  a virtual console with a command \ninterface that mirror s the interface of the  targeted ICS/SCADA device. Modules interact with targeted \ndevices, enabling operations by lower -skilled cyber actors to emulate higher -skilled actor capabilities.  \nThe APT actor s can leverage  the modules to scan  for targeted device s, conduct reconnai ssance on \ndevice details , upload malicious configuration/code to the targeted device , back  up or restore  device \ncontents, and modify device parameters.   \nIn addition, the APT actors can use a tool that installs and exploits a known -vulnerable ASRock -\nsigned motherboard driver, AsrDrv103.sys , exploiting CVE-2020 -15368  to execute malicious code in \nthe Windows kernel . Successful deployment of this tool can al low APT actors to move laterally within \nan IT or OT environment  and disrupt critical  devices or functions . \nAPT Tool for Schneider Electric  Devices    \nThe APT actors tool for  Schneider Electric devices has module s that interact via normal management \nprotocols and Modbus  (TCP 502) . Modules may allow cyber actors to : \n Run a rapid scan that identifies all Schneider PLCs on the local network via User Datagram \nProtocol (UDP) multicast with a destination port of 27127  (Note: UDP 27127 is a standard \ndiscovery scan used by engineering workstation s to discover PLCs and may not be indicative \nof malicious activity ); \n Brute -force Schneider Electric PLC passwords using  CODESYS  and other available device \nprotocols  via UDP port 1740 again st defaults or a dictionary word list  (Note: this capability may \nwork against other CODESYS -based devices depending on individual  design and function, \nand this report will be updated as more information becomes available );  \n Conduct a denial -of-service attack to prevent network communications from reaching the PLC;  \n\n \n  DOE |  CISA |  NSA |  FBI TLP:WHITE  \n \nPage 3 of 9  |  Product ID: AA2 2-103A \nTLP: WHITE     Sever connections, requiring users to re -authenticate to the PLC, likely to facilitate capture of \ncredentials;  \n Conduct a packet of death attack to crash the PLC until a power cycle and conf iguration \nrecovery is conducted; and  \n Send custom Modbus  commands  (Note : this capability may work against Modbus  other than  \nin Schneider Electric PLCs) . \nRefer to the appendix  for tactics, techniques, and procedures ( TTPs)  associated with this tool . \nAPT Tool for OMRON   \nThe APT actors tool for OMRON  devices  has module s that can interact by: \n Scanning for OMRON using  (Factory Interface Network Service  (FINS ) protocol ; \n Parsing the Hypertext Transfer Protocol ( HTTP ) response from OMRON devices ; \n Retrieving the media access control ( MAC ) address of the device ; \n Polling for specific devices connected to the PLC ; \n Back ing up/restoring arbitrary files to/from the PLC ; and \n Loading a custom malicious agent on OMRON PLCs for additional  attacker -directed \ncapability . \nAdditionally, the OMRON  module s can upload an agent that allows a cyber actor  to connect and \ninitiate  commands such as file manipulation , packet captures,  and code execution via HTTP \nand/or Hypertext Transfer Protocol Secure ( HTTPS ).  \nRefer to the appendix  for TTPs  associated with this tool . \nAPT Tool for OPC UA   \nThe APT actors  tool for  OPC UA has module s with basic functionality to identify OPC UA servers  and \nto connect to an OPC UA server using default or previously compromised credentials. The client can \nread the OPC UA structure from the server and potentially write tag value s available via OPC  UA. \nThe threat from this tool can be significantly reduced by pr operly configuring OPC UA security. Refer \nto the Mitigations below for more information.  \nRefer to the appendix  for TTPs  associated with this tool . \nMITIGATION S \nNote : these mitigations are provided  to enable network d efenders to begin efforts to protect systems \nand devices from new capabilities. They have not been verified against every environment and should \nbe tested prior to implementing.  \nDOE, CISA, NSA , and the FBI  recommend all organizations with  ICS/SCADA  devices  implement the \nfollowing proactive mitigations:  \n Isolate ICS/SCADA systems and networks from corporate and internet networks using strong \nperimeter controls, and limit any communications entering or leaving ICS/SCADA perimeters.  \n\n \n  DOE |  CISA |  NSA |  FBI TLP:WHITE  \n \nPage 4 of 9  |  Product ID: AA2 2-103A \nTLP: WHITE     Enforce multifactor authent ication for all remote access to ICS networks and devices \nwhenever possible . \n Have a cyber incident response plan, and exercise it regularly with stakeholders in IT, \ncybersecurity, and operations.  \n Change all passwords to ICS/SCADA devices and systems on a consistent schedule, \nespecially all default passwords, to device -unique strong passwords to mitigate password \nbrute force attacks and to give defender monitoring systems opportunities to detect com mon \nattacks.    \n Ensure OPC UA security is correctly configured with application authentication enabled and \nexplicit trust lists.  \n Ensure the OPC UA certificate private keys and user passwords are stored securely.  \n Maintain known -good offline backups for faster recovery upon a disruptive attack, and conduct \nhashing and integrity checks on firmware and controller configuration files to ensure validity of \nthose backups.  \n Limit ICS/SCADA systems network connections to only specifically allowed management and \nengineering workstations . \n Robustly protect management systems by configuring Device Guard, Credential Guard, and \nHypervisor Code Integrity (HVCI). Install Endpoint Detection and Response (EDR) solutions \non these sub nets and ensure strong anti -virus file reputation settings are configured . \n Implement robust log collection and retention from ICS/SCADA systems and management \nsubnets . \n Leverage a continuous OT monitoring solution to alert on malicious indicators and behavi ors, \nwatching internal systems and communications for known hostile actions and lateral \nmovement.  For enhanced network visibility to potentially identify abnormal traffic, consider \nusing  CISA s open -source Industrial Control Systems Network Protocol Parsers (ICSNPP) . \n Ensure all applications  are only installed when necessary for operation.  \n Enforce principle of least privilege. Only use  admin  accounts when required for tasks , such as \ninstalling software updates .  \n Investigate symptoms of a denial of service or connection severing, which exhibit as delays in \ncommunications processing, loss of function requiring a reboot, and delayed actions to \noperator comments as signs of potential malicious activity . \n Moni tor systems for loading of unusual drivers, especially for ASRock driver if no ASRock \ndriver is normally used on the system . \nRESOURCES  \n \nFor additional guidance on securing OT devices , see:  \n Layering Network Security Through Segmentation ,  \n Stop Malicious Cyber Activity  Against Connected Operational Technology , and  \n NSA and CISA Recommend Immediate Actions to Reduce Exposure Across Operational \nTechnologies and Control Systems.    \n\n \n  DOE |  CISA |  NSA |  FBI TLP:WHITE  \n \nPage 5 of 9  |  Product ID: AA2 2-103A \nTLP: WHITE     \nFor additional guidance on securing OPC UA enabled devices, see:  \n https://opcfoundation.org/UA/Security/BestPractices.pdf  \n \nFor more information  on APT actors tools and TTPs , refer to :  \n Mandiant s Blog  INCONTROLLER: New State -Sponsored Cyber Attack Tools Target \nMultiple Industrial Control Systems  \n Dragos  Blog  CHERNOVITEs PIPEDREAM Malware Targeting Industrial Control Systems . \nDISCLAIMER  \nThe information in this report is being provided as is for informational purposes only. DOE, CISA, \nNSA, and the FBI  do not endorse any commercial product or service, including any subjects of \nanalysis. Any reference to specific commercial products, processes, or services by service mark, \ntrademark, manufacturer, or otherwise, does not constit ute or imply endorsement, recommendation , \nor favoring by the DOE, CISA,  NSA, or the FBI, and this guidance shall not be used for advertising or \nproduct endorsement purposes.  \nACKNOWLEDGEMENTS  \nThe DOE, CISA, NSA, and the FBI would like to thank Dragos , Mandi ant, Microsoft,  Palo Alto  \nNetworks , and Schneider Electric  for their contributions  to this joint CSA.   \n\n \n  DOE |  CISA |  NSA |  FBI TLP:WHITE  \n \nPage 6 of 9  |  Product ID: AA2 2-103A \nTLP: WHITE    APPENDIX: APT CYBER TOOLS TACT ICS, TECHNIQUES, AND  \nPROCEDURES  \nSee tables 1 through 3 for TTPs associated with the cyber actors  tools described in this C SA mapped \nto the MITRE ATT&CK for ICS framework. See the ATT&CK for ICS  framework for all referenced \nthreat actor tactics and techniques.  \nTable 1: APT Tool for Schneider Electric ICS TTPs  \nTactic  Technique  \nExecution  Command -Line Interface  [T0807 ] \nScripting  [T0853 ] \nPersistence  Modify Program  [T0889 ] \nSystem Firmware  [T0857 ] \nValid Accounts  [T0859 ] \nDiscovery  Remote System Discovery  [T0846 ] \nRemote System Information  Discovery  [T0888 ] \nLateral Movement  Default Credentials  [T0812 ] \nProgram Download  [T0843 ] \nValid Accounts  [T0859 ] \nCollection  Monitor Process State  [T0801 ] \nProgram Upload  [T0845 ] \nMonitor Process State  [T0801 ] \nCommand and Control  Commonly Used Port  [T0885 ] \nStandard Application Layer  Protocol  [T0869 ] \nInhibit Response \nFunction  Block Reporting Message  [T0804 ] \nBlock Command Message  [T0803 ] \nDenial of Service  [T0814 ] \nData Destruction  [T0809 ] \nDevice Restart/Shutdown  [T0816 ] \nSystem Firmware  [T0857 ] \nImpair Process Control  Modify Parameter  [T0836 ] \n\n \n  DOE |  CISA |  NSA |  FBI TLP:WHITE  \n \nPage 7 of 9  |  Product ID: AA2 2-103A \nTLP: WHITE    Tactic  Technique  \nUnauthorized Command  Message [ T0855 ] \nImpact  Denial of Control  [T0813 ] \nDenial of View  [T0815 ] \nLoss of Availability  [T0826 ] \nLoss of Control  [T0827 ] \nLoss of Productivity and  Revenue  [T0828 ] \nManipulation of Control  [T0831 ] \nTheft of Operational  Information  [T0882 ] \n \nTable 2: APT Tool for OMRON  ICS TTPs  \nTactic  Technique  \nInitial Access  Remote Services  [T0886 ] \nExecution  Command -Line Interface  [T0807 ] \nScripting  [T0853 ] \nChange Operating Mode  [T0858 ] \nModify Controller Tasking  [T0821 ] \nNative API  [T0834 ] \nPersistence  Modify Program  [T0889 ] \nValid Accounts  [T0859 ] \nEvasion  Change Operating Mode  [T0858 ] \nDiscovery  Network Sniffing  [T0842 ] \nRemote System Discovery  [T0846 ] \nRemote System Information  Discovery  [T0888 ] \nLateral Movement  Default Credentials  [T0812 ] \nLateral Tool Transfer  [T0867 ] \nProgram Download  [T0843 ] \nRemote Services  [T0886 ] \n\n \n  DOE |  CISA |  NSA |  FBI TLP:WHITE  \n \nPage 8 of 9  |  Product ID: AA2 2-103A \nTLP: WHITE    Tactic  Technique  \nValid Accounts  [T0859 ] \nCollection  Detect Operating Mode  [T0868 ] \nMonitor Process State  [T0801 ] \nProgram Upload  [T0845 ] \nCommand and Control  Commonly Used Port  [T0885 ] \nStandard Application Layer  Protocol  [T0869 ] \nInhibit Response \nFunction  Service Stop  [T0881 ] \nImpair Process Control  Modify Parameter  [T0836 ] \nUnauthorized Command  Message [ T0855 ] \nImpact  Damage to Property  [T0879 ] \nLoss of Safety  [T0837 ] \nManipulation of Control  [T0831 ] \nTheft of Operational  Information  [T0882 ] \n \nTable 3: APT Tool for OPC UA ICS TTPs  \nTactic  Technique  \nExecution  Command -Line Interface  [T0807 ] \nScripting  [T0853 ] \nPersistence  Valid Accounts  [T0859 ] \nDiscovery  Remote System Discovery  [T0846 ] \nRemote System Information  Discovery  [T0888 ] \nLateral Movement  Valid Accounts  [T0859 ] \nCollection  Monitor Process State  [T0801 ] \nPoint & Tag Identification  [T0861 ] \nCommand and Control  Commonly Used Port  [T0885 ] \nStandard Application Layer  Protocol  [T0869 ] \nImpact  Manipulation of View  [T0832 ] \n\n \n  DOE |  CISA |  NSA |  FBI TLP:WHITE  \n \nPage 9 of 9  |  Product ID: AA2 2-103A \nTLP: WHITE    Tactic  Technique  \nTheft of Operational  Information  [T0882 ] \n \n\n",
  "cves": [],
  "techniques": [],
  "advisory": "cybersecurity-alerts",
  "title": "csa_apt_cyber_tools_targeting_ics_scada_devices_opcua_20220525",
  "source": "nsa",
  "id": "8478c584cfaf8bc206564dcb194658d948fe50293678583a179011f746618ddd"
}